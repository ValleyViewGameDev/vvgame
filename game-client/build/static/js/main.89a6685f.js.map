{"version":3,"file":"static/js/main.89a6685f.js","mappings":"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","sources":["GameFeatures/NPCs/NPCUtils.js","GameFeatures/NPCs/NPCGrazeBehavior.js","GameFeatures/NPCs/NPCQuestBehavior.js","GameFeatures/NPCs/NPCEnemyBehavior.js","GameFeatures/NPCs/NPCHealBehavior.js","GameFeatures/NPCs/NPCSpawnerBehavior.js","GameFeatures/NPCs/NPCWorkerBehavior.js","GameFeatures/NPCs/NPCTraderBehavior.js","GameFeatures/NPCs/AllNPCsShared.js","UI/StringsContext.js","../node_modules/react/index.js","PlayerMovement.js","Utils/TuningManager.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/cjs/react.production.min.js","UI/StatusBar/CollectionFormatters.js","../node_modules/axios/lib/helpers/bind.js","../node_modules/axios/lib/utils.js","../node_modules/axios/lib/core/AxiosError.js","../node_modules/axios/lib/helpers/toFormData.js","../node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../node_modules/axios/lib/helpers/buildURL.js","../node_modules/axios/lib/core/InterceptorManager.js","../node_modules/axios/lib/defaults/transitional.js","../node_modules/axios/lib/platform/browser/index.js","../node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../node_modules/axios/lib/platform/browser/classes/FormData.js","../node_modules/axios/lib/platform/browser/classes/Blob.js","../node_modules/axios/lib/platform/common/utils.js","../node_modules/axios/lib/platform/index.js","../node_modules/axios/lib/helpers/formDataToJSON.js","../node_modules/axios/lib/defaults/index.js","../node_modules/axios/lib/helpers/toURLEncodedForm.js","../node_modules/axios/lib/helpers/parseHeaders.js","../node_modules/axios/lib/core/AxiosHeaders.js","../node_modules/axios/lib/core/transformData.js","../node_modules/axios/lib/cancel/isCancel.js","../node_modules/axios/lib/cancel/CanceledError.js","../node_modules/axios/lib/core/settle.js","../node_modules/axios/lib/helpers/speedometer.js","../node_modules/axios/lib/helpers/throttle.js","../node_modules/axios/lib/helpers/progressEventReducer.js","../node_modules/axios/lib/helpers/isURLSameOrigin.js","../node_modules/axios/lib/helpers/cookies.js","../node_modules/axios/lib/core/buildFullPath.js","../node_modules/axios/lib/helpers/isAbsoluteURL.js","../node_modules/axios/lib/helpers/combineURLs.js","../node_modules/axios/lib/core/mergeConfig.js","../node_modules/axios/lib/helpers/resolveConfig.js","../node_modules/axios/lib/adapters/xhr.js","../node_modules/axios/lib/helpers/parseProtocol.js","../node_modules/axios/lib/helpers/composeSignals.js","../node_modules/axios/lib/helpers/trackStream.js","../node_modules/axios/lib/adapters/fetch.js","../node_modules/axios/lib/adapters/adapters.js","../node_modules/axios/lib/helpers/null.js","../node_modules/axios/lib/core/dispatchRequest.js","../node_modules/axios/lib/env/data.js","../node_modules/axios/lib/helpers/validator.js","../node_modules/axios/lib/core/Axios.js","../node_modules/axios/lib/cancel/CancelToken.js","../node_modules/axios/lib/helpers/HttpStatusCode.js","../node_modules/axios/lib/axios.js","../node_modules/axios/lib/helpers/spread.js","../node_modules/axios/lib/helpers/isAxiosError.js","../node_modules/scheduler/cjs/scheduler.production.min.js","VFX/VFX.js","GameFeatures/Quests/QuestGoalTracker.js","GameFeatures/Combat/Combat.js","GameFeatures/Trophies/TrophyUtils.js","../node_modules/react-dom/client.js","GridState/PlayersInGrid.js","Utils/stringLookup.js","config.js","Render/RenderAnimatePosition.js","UI/Panel.js","../node_modules/react/jsx-runtime.js","Utils/LocationChangeManager.js","Utils/GridManagement.js","Utils/worldHelpers.js","../node_modules/engine.io-parser/build/esm/commons.js","../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../node_modules/engine.io-parser/build/esm/index.js","../node_modules/@socket.io/component-emitter/lib/esm/index.js","../node_modules/engine.io-client/build/esm/globals.js","../node_modules/engine.io-client/build/esm/util.js","../node_modules/engine.io-client/build/esm/transport.js","../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../node_modules/engine.io-client/build/esm/transports/polling.js","../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../node_modules/engine.io-client/build/esm/transports/websocket.js","../node_modules/engine.io-client/build/esm/transports/index.js","../node_modules/engine.io-client/build/esm/transports/webtransport.js","../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../node_modules/engine.io-client/build/esm/socket.js","../node_modules/socket.io-parser/build/esm/is-binary.js","../node_modules/socket.io-parser/build/esm/binary.js","../node_modules/socket.io-parser/build/esm/index.js","../node_modules/socket.io-client/build/esm/on.js","../node_modules/socket.io-client/build/esm/socket.js","../node_modules/socket.io-client/build/esm/contrib/backo2.js","../node_modules/socket.io-client/build/esm/manager.js","../node_modules/socket.io-client/build/esm/index.js","../node_modules/socket.io-client/build/esm/url.js","socketManager.js","GridState/GridStateNPCs.js","Utils/InventoryManagement.js","GameFeatures/Transit/transitConfig.js","GameFeatures/Transit/Transit.js","../node_modules/react-dom/cjs/react-dom.production.min.js","UI/TransactionButton.js","Utils/ResourceHelpers.js","GridState/GlobalGridStateTilesAndResources.js","GameFeatures/FTUE/FTUE.js","../node_modules/scheduler/index.js","FarmState.js","GameFeatures/FarmAnimals/FarmAnimals.js","UI/Notifications/Notifications.js","UI/FloatingText.js","UI/PanelContext.js","../node_modules/react-dom/index.js","AppInit.js","../webpack/bootstrap","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/load script","../webpack/runtime/make namespace object","../webpack/runtime/publicPath","../webpack/runtime/jsonp chunk loading","Utils/appUtils.js","GameFeatures/Chat/Chat.js","Render/RenderTilesCanvas.js","Render/RenderTilesDOM.js","Render/RenderTiles.js","Render/SVGAssetManager.js","Utils/ResourceOverlayUtils.js","Utils/CursorUtils.js","Render/RenderResourcesCanvas.js","Render/RenderResourcesDOM.js","Render/RenderResources.js","Render/RenderNPCsCanvas.js","GameFeatures/NPCs/NPCInteractionUtils.js","UI/NPCOverlayContext.js","GameFeatures/Relationships/ConversationManager.js","Render/RenderNPCsDOM.js","Render/RenderNPCs.js","Render/RenderPCsCanvas.js","Render/RenderPCsDOM.js","Render/RenderPCs.js","Render/RenderDynamicElementsCanvas.js","Render/RenderDynamicElementsDOM.js","Utils/QuestCache.js","Render/RenderDynamicElements.js","Utils/ResourceLockManager.js","Utils/WarehouseMaterials.js","Economy/DropRates.js","ResourceClicking.js","UI/UILockContext.js","GridState/GridStatePCContext.js","GridState/GridStateContext.js","GridState/NPCController.js","UI/StatusBar/StatusBar.js","UI/BulkOperationContext.js","ZoomedOut/ZoomedOut.js","ZoomedOut/SettlementView.js","Utils/Relocation.js","ZoomedOut/FrontierView.js","UI/Modal.js","UI/LanguagePickerModal.js","Authentication/ChangeIcon.js","../node_modules/@stripe/stripe-js/dist/index.mjs","Store/Store.js","UI/ChangeIconModal.js","settings.js","UI/ModalContext.js","Authentication/ProfilePanel.js","Utils/conversionTracking.js","Authentication/CreateAccount.js","Authentication/LoginPanel.js","Utils/GridStateDebug.js","Utils/debug.js","Utils/WorldGeneration.js","GameFeatures/Inventory/ManageContentsModal.js","GameFeatures/Inventory/InventoryPanel.js","Economy/GemCosts.js","UI/ResourceButton.js","GameFeatures/Inventory/WarehousePanel.js","GameFeatures/Trophies/TrophyPanel.js","UI/HowToPanel.js","UI/HowToMoneyPanel.js","UI/HowToGemsPanel.js","UI/QuestButton.js","GameFeatures/Quests/QuestPanel.js","GameFeatures/Relationships/RelationshipUtils.js","GameFeatures/Relationships/Conversation.js","GameFeatures/Relationships/RelationshipCard.js","GameFeatures/NPCs/HealerInteraction.js","GameFeatures/NPCs/NPCsPanel.js","Utils/playerManagement.js","GameFeatures/BuildAndBuy.js","GameFeatures/Government/GovUtils.js","GameFeatures/Build/BuildPanel.js","GameFeatures/Buy/BuyPanel.js","GameFeatures/Pets/PetsPanel.js","GameFeatures/Deco/BuyDecoPanel.js","UI/Timers.js","GameFeatures/Farming/FarmingPanel.js","GameFeatures/Farming/Farming.js","GameFeatures/Farming/ToolsPanel.js","Utils/ProtectedSelling.js","GameFeatures/Skills/SkillsPanel.js","Utils/PopulationUtils.js","GameFeatures/Government/GovPanel.js","GameFeatures/Trading/Bank.js","GameFeatures/Trading/KentOfferLogic.js","GameFeatures/Trading/Kent.js","GameFeatures/Trading/Train.js","GameFeatures/Trading/TrainOfferLogic.js","GameFeatures/Trading/NewTrain.js","GameFeatures/Carnival/Carnival.js","GameFeatures/Government/Courthouse.js","Economy/EconomyUtils.js","GameFeatures/Crafting/CraftingStation.js","GameFeatures/Crafting/FarmHouse.js","UI/ProgressModal.js","GameFeatures/FarmHands/BulkHarvest.js","GameFeatures/FarmHands/BulkHarvestUtils.js","GameFeatures/FarmHands/BulkHarvestResultsModal.js","GameFeatures/FarmHands/BulkAnimalCollect.js","GameFeatures/FarmHands/BulkCrafting.js","GameFeatures/FarmHands/FarmHand.js","GameFeatures/Crafting/ShopStation.js","GameFeatures/Crafting/ScrollStation.js","Utils/SkillPowerManagement.js","GameFeatures/Crafting/ScrollReveal.js","GameFeatures/Pets/PetPanel.js","GameFeatures/FarmAnimals/AnimalStall.js","GameFeatures/Farming/CropPanel.js","GameFeatures/Deco/DecoPanel.js","UI/TradingInventoryModal.js","GameFeatures/Trading/GlobalMarketModal.js","GameFeatures/Trading/TradeStall.js","GameFeatures/Trading/Outpost.js","GameFeatures/Mailbox/Mailbox.js","GameFeatures/Seasons/OffSeasonModal.js","UI/TownNews.js","GameFeatures/Seasons/SeasonPanel.js","GameFeatures/Social/SocialPanel.js","GameFeatures/Combat/CombatPanel.js","UI/GoldBenefitsPanel.js","Utils/share.js","UI/ShareModal.js","UI/CowboyAnimation.js","App.js","reportWebVitals.js","index.js"],"sourcesContent":["import API_BASE from \"../../config.js\";\nimport axios from \"axios\";    \nimport FloatingTextManager from \"../../UI/FloatingText.js\";\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs.js\";\nimport { handleAttackOnNPC } from \"../Combat/Combat.js\";\nimport { gainIngredients, hasRoomFor } from \"../../Utils/InventoryManagement.js\";\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker.js';\nimport AnimalPanel from '../FarmAnimals/FarmAnimals.js';\nimport { calculateDistance } from '../../Utils/worldHelpers.js';\nimport { getLocalizedString } from '../../Utils/stringLookup.js';\nimport { formatSingleCollection } from '../../UI/StatusBar/CollectionFormatters.js';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement.js';\n\n// Generate unique transaction ID\nfunction generateTransactionId() {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Protected farm animal collection function\nasync function handleProtectedFarmAnimalCollection(\n  npc,\n  row,\n  col,\n  setInventory,\n  setBackpack,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  currentGridId,\n  updateStatus,\n  strings = {},\n  globalTuning = null,\n  inventory = null,\n  backpack = null\n) {\n  console.log(` [PROTECTED FARM ANIMAL] Starting protected collection for NPC ${npc.id}`);\n  \n  // Generate transaction ID and key\n  const transactionId = generateTransactionId();\n  const transactionKey = `farm-animal-collect-${npc.id}-${currentGridId}`;\n  \n  try {\n    console.log(` Attempting to collect animal - ID: ${npc.id}, State: ${npc.state}, GrazeEnd: ${npc.grazeEnd}, Current Time: ${Date.now()}`);\n    \n    // Double-check the NPC state from the grid manager before making the request\n    const currentNPCState = NPCsInGridManager.getNPCsInGrid(currentGridId)?.[npc.id];\n    if (currentNPCState && currentNPCState.state !== 'processing') {\n      console.warn(` NPC ${npc.id} state changed to ${currentNPCState.state} before collection attempt`);\n      updateStatus(` Animal not ready - state: ${currentNPCState.state}`);\n      return { type: 'error', message: `Animal not in processing state (${currentNPCState.state})` };\n    }\n    \n    // Check if grazeEnd has expired while offline (indicates stale client state)\n    if (currentNPCState && currentNPCState.grazeEnd) {\n      const timeSinceGrazeEnd = Date.now() - currentNPCState.grazeEnd;\n      if (timeSinceGrazeEnd > 3600000) { // 1 hour past grazeEnd\n        console.warn(` NPC ${npc.id} has expired grazeEnd - ${Math.floor(timeSinceGrazeEnd / 60000)} minutes overdue`);\n        console.warn(` GrazeEnd was: ${new Date(currentNPCState.grazeEnd).toISOString()}, Now: ${new Date().toISOString()}`);\n        // Let the server validate the state - it's the source of truth\n        updateStatus(\"Checking animal state...\");\n      }\n    }\n    \n    // Skip pre-check for warehouse capacity - let server handle it with fresh data\n    // The pre-check was using potentially stale inventory data from currentPlayer\n    \n    const response = await axios.post(`${API_BASE}/api/farm-animal/collect`, {\n      playerId: currentPlayer.playerId,\n      gridId: currentGridId,\n      npcId: npc.id,\n      npcPosition: { x: col, y: row },\n      transactionId,\n      transactionKey\n    });\n\n    if (response.data.success) {\n      const { collectedQuantity, collectedItem, skillsApplied, updatedNPC } = response.data;\n      \n      // Don't use server inventory - use gainIngredients to properly handle capacity\n      // This ensures Gold Pass warehouse bonus is respected\n      \n      // Add to inventory using gainIngredients (respects Gold Pass capacity)\n      const gained = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: collectedItem,\n        quantity: collectedQuantity,\n        inventory: inventory || currentPlayer.inventory,\n        backpack: backpack || currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n      \n      // Check if gainIngredients succeeded - it returns true on success or an error object on failure\n      if (gained !== true && (!gained || gained.success === false)) {\n        console.error(' Failed to add animal product to inventory - warehouse may be full');\n        console.error(' gainIngredients result:', gained);\n        // The server already changed the NPC state, but we couldn't add the item\n        // This is a critical error - the item is lost\n        // Show the \"You're full\" floating text instead of success\n        FloatingTextManager.addFloatingText(strings[\"41\"] || \"You're full\", col, row, TILE_SIZE);\n        return { type: 'error', message: 'Warehouse full - item lost' };\n      }\n\n      // Only update NPC state and show success if we successfully added to inventory\n      if (updatedNPC) {\n        await NPCsInGridManager.updateNPC(currentGridId, npc.id, updatedNPC);\n        \n        // Check if there are other animals at the same position that might need state updates\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n        const animalsAtSamePosition = Object.values(npcsInGrid || {}).filter(otherNpc => \n          otherNpc.id !== npc.id &&\n          Math.floor(otherNpc.position?.x) === col &&\n          Math.floor(otherNpc.position?.y) === row &&\n          otherNpc.action === 'graze'\n        );\n        \n        if (animalsAtSamePosition.length > 0) {\n          console.log(` Found ${animalsAtSamePosition.length} other animals at same stall position after collection`);\n          console.log(` Other animals at position:`, animalsAtSamePosition.map(a => ({\n            id: a.id,\n            state: a.state,\n            grazeEnd: a.grazeEnd,\n            targetStall: a.targetStall\n          })));\n          \n          // For animals in processing state at the same stall, they can remain in processing\n          // The server should handle their collection independently\n          // Only log the situation for debugging\n          for (const otherAnimal of animalsAtSamePosition) {\n            if (otherAnimal.state === 'processing') {\n              console.log(` Animal ${otherAnimal.id} remains in processing state at same stall - ready for collection`);\n            } else if (otherAnimal.state === 'stall') {\n              console.log(` Animal ${otherAnimal.id} is still moving to stall`);\n            } else {\n              console.log(` Animal ${otherAnimal.id} in unexpected state '${otherAnimal.state}' at stall position`);\n            }\n          }\n        }\n      }\n\n      // Only show success feedback if item was added to inventory\n      if (gained === true) {\n        // Visual feedback\n        FloatingTextManager.addFloatingText(`+${collectedQuantity} ${getLocalizedString(collectedItem, strings)}`, col, row, TILE_SIZE);\n        \n        // Calculate skill info for formatting\n        const skillInfo = calculateSkillMultiplier(collectedItem, currentPlayer.skills || [], masterSkills);\n        \n        // Format status message using shared formatter\n        const statusMessage = formatSingleCollection('animal', collectedItem, collectedQuantity, \n          skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n        \n        // Update status with the formatted message\n        updateStatus(statusMessage);\n      }\n\n      //  Track quest progress for NPC graze collection\n      await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQuantity, setCurrentPlayer);\n\n      console.log(`Farm animal collection completed: ${collectedQuantity} ${collectedItem}`);\n      return { \n        type: 'success', \n        message: `Collected ${collectedQuantity} ${collectedItem}.`,\n        collectedItem,\n        collectedQuantity,\n        skillsApplied\n      };\n    }\n  } catch (error) {\n    console.error('Error in protected farm animal collection:', error);\n    \n    if (error.response?.status === 429) {\n      updateStatus(471);\n      return { type: 'error', message: 'Collection already in progress' };\n    } else if (error.response?.status === 400) {\n      const errorMessage = error.response?.data?.error || 'Animal not ready for collection';\n      const errorDetails = error.response?.data;\n      console.error(` 400 Error details:`, errorDetails);\n      \n      // Handle warehouse full error\n      if (errorMessage === 'Warehouse full' || errorMessage.includes('Warehouse full')) {\n        console.error(` Cannot collect: Warehouse is full (${errorDetails?.currentUsage}/${errorDetails?.capacity})`);\n        // Show \"You're full\" floating text\n        FloatingTextManager.addFloatingText(strings[\"41\"] || \"You're full\", col, row, TILE_SIZE);\n        // Don't show status message - floating text is enough\n        return { type: 'error', message: 'Warehouse is full' };\n      }\n      \n      console.error(` Animal state mismatch - Client state: ${npc.state}, Server error: ${errorMessage}`);\n      console.error(` Animal details - ID: ${npc.id}, GrazeEnd: ${npc.grazeEnd}, Current Time: ${Date.now()}`);\n      \n      // If server says NPC is in different state, sync with server state\n      if (errorMessage.includes('state:')) {\n        const serverStateMatch = errorMessage.match(/\\(state:\\s*(\\w+)\\)/);\n        if (serverStateMatch) {\n          const serverState = serverStateMatch[1];\n          console.error(` Server reports NPC ${npc.id} in state '${serverState}' but client has '${npc.state}'`);\n          \n          // Special handling for processing -> stall mismatch (animal was already collected)\n          if (npc.state === 'processing' && serverState === 'stall') {\n            console.log(` Animal ${npc.id} was already collected (now looking for stall)`);\n            updateStatus(strings[\"815\"] || \"This animal was already collected\");\n            \n            // Clear stale grazeEnd and update state\n            await NPCsInGridManager.updateNPC(currentGridId, npc.id, {\n              state: serverState,\n              grazeEnd: null,\n              targetStall: null\n            });\n            \n            // Don't try other animals - this was the expected animal\n            return { type: 'error', message: 'Animal already collected' };\n          }\n          \n          // Force refresh the NPC from server\n          console.log(` Attempting to resync NPC ${npc.id} state with server...`);\n          \n          // Update local state to match server\n          await NPCsInGridManager.updateNPC(currentGridId, npc.id, {\n            state: serverState\n          });\n          \n          // Check if there's another animal at this position that might be in processing state\n          const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n          const otherProcessingAnimal = Object.values(npcsInGrid || {}).find(otherNpc => \n            otherNpc.id !== npc.id &&\n            Math.floor(otherNpc.position?.x) === col &&\n            Math.floor(otherNpc.position?.y) === row &&\n            otherNpc.action === 'graze' &&\n            otherNpc.state === 'processing'\n          );\n          \n          if (otherProcessingAnimal) {\n            console.log(` Found another processing animal at same position after sync. Trying to collect from NPC ${otherProcessingAnimal.id}`);\n            updateStatus(`Trying another animal at this stall...`);\n            \n            // Try to collect from the other animal\n            return await handleProtectedFarmAnimalCollection(\n              otherProcessingAnimal,\n              row,\n              col,\n              setInventory,\n              setBackpack,\n              setResources,\n              currentPlayer,\n              setCurrentPlayer,\n              TILE_SIZE,\n              masterResources,\n              masterSkills,\n              currentGridId,\n              updateStatus,\n              strings,\n              globalTuning\n            );\n          }\n          \n          updateStatus(` Animal not ready - server state: ${serverState}`);\n        }\n      } else {\n        updateStatus(` ${errorMessage}`);\n      }\n      return { type: 'error', message: errorMessage };\n    } else {\n      updateStatus(' Failed to collect from animal');\n      return { type: 'error', message: 'Failed to collect from animal' };\n    }\n  }\n}\n\nexport function loadNPCDefinitions(resources) {\n    const npcDefinitions = {};\n    resources.forEach((resource) => {\n      if (resource.category === 'npc') {\n        npcDefinitions[resource.type] = resource;\n      }\n    });\n    return npcDefinitions;\n}\n  \nexport function extractXY(location) {\n  if (!location || location.x === undefined || location.y === undefined) {\n    console.error(\"Invalid location object\", location);\n    return null;\n  }\n  return { x: location.x, y: location.y };\n}\n\n// Re-export calculateDistance from worldHelpers to maintain backward compatibility\nexport { calculateDistance } from '../../Utils/worldHelpers.js';\n  \nexport async function handleNPCClick(\n  npc,\n  row,\n  col,\n  setInventory,\n  setBackpack,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  currentGridId,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  strings = {},\n  masterTrophies = null,\n  globalTuning = null\n) {\n  if (!npc) {\n    console.warn(\"handleNPCClick was called with an undefined NPC.\");\n    return;\n  }\n  console.log(`[ handleNPCClick] NPC ${npc.id} clicked with state=${npc.state}`);\n\n  switch (npc.action) {\n\n    case 'quest': \n    case 'heal':\n    case 'worker':\n      {\n        //handled directly in RenderDynamic  \n        break;\n      }\n \n    case 'graze': {\n\n      console.log(`Handling grazing logic for NPC ${npc.id}.`);\n\n      if (npc.state !== 'processing') {\n        console.log(` NPC ${npc.id} clicked but not in processing state: ${npc.state}`);\n        \n        // Get fresh state data to check for other animals\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n        \n        // Log all animals at this position for debugging\n        const allAnimalsAtPosition = Object.values(npcsInGrid || {}).filter(otherNpc =>\n          Math.floor(otherNpc.position?.x) === col &&\n          Math.floor(otherNpc.position?.y) === row &&\n          otherNpc.action === 'graze'\n        );\n        \n        if (allAnimalsAtPosition.length > 1) {\n          console.log(` Found ${allAnimalsAtPosition.length} animals at position (${col}, ${row}):`, \n            allAnimalsAtPosition.map(a => ({\n              id: a.id,\n              state: a.state,\n              grazeEnd: a.grazeEnd\n            }))\n          );\n        }\n        \n        // Find an animal in processing state at this position\n        const processingAnimalAtSamePosition = allAnimalsAtPosition.find(otherNpc => \n          otherNpc.id !== npc.id &&\n          otherNpc.state === 'processing'\n        );\n        \n        if (processingAnimalAtSamePosition) {\n          console.log(` Found another animal in processing state at same position. Switching to collect from NPC ${processingAnimalAtSamePosition.id} (state: ${processingAnimalAtSamePosition.state}) instead of ${npc.id} (state: ${npc.state})`);\n          // Recursively call handleNPCClick with the processing animal\n          return await handleNPCClick(\n            processingAnimalAtSamePosition,\n            row,\n            col,\n            setInventory,\n            setBackpack,\n            setResources,\n            currentPlayer,\n            setCurrentPlayer,\n            TILE_SIZE,\n            masterResources,\n            masterSkills,\n            currentGridId,\n            setModalContent,\n            setIsModalOpen,\n            updateStatus,\n            openPanel,\n            setActiveStation,\n            strings,\n            masterTrophies,\n            globalTuning\n          );\n        }\n\n        // Set the active station before opening the panel\n        setActiveStation({\n          type: npc.type,\n          position: { x: col, y: row },\n          gridId: currentGridId,\n          npcId: npc.id, // Include the NPC ID for reliable identification\n        });\n        openPanel('AnimalPanel');\n\n        return { type: 'info', message: 'NPC is not ready for collection.' };\n      }\n\n      //  Otherwise, handle Animals in stalls in \"procesing\" state\n\n      //  Use protected transaction system instead of UI lock hack\n      return await handleProtectedFarmAnimalCollection(\n        npc,\n        row,\n        col,\n        setInventory,\n        setBackpack,\n        setResources,\n        currentPlayer,\n        setCurrentPlayer,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        currentGridId,\n        updateStatus,\n        strings,\n        globalTuning\n      );\n    }\n\n    case 'attack': \n    case 'spawn':\n      handleAttackOnNPC(npc,currentPlayer,setCurrentPlayer,TILE_SIZE,setResources,masterResources,masterTrophies);\n      \n    break;\n  \n\n    default:\n      console.log(`Unhandled NPC action: ${npc.action}`);\n      break;\n  }\n}\n","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\n// Behavior handler for farm animals (e.g., cows)\nasync function handleFarmAnimalBehavior(gridId) {\n    // Helper for updating just this NPC\n    const updateThisNPC = async () => {\n        // console.log(`[SAVE] NPC ${this.id}: Updating state to '${this.state}' at position (${this.position.x}, ${this.position.y})`);\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            grazeEnd: this.grazeEnd,\n            position: this.position,\n      });\n    };\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleFarmAnimalBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n    \n    // IMPORTANT: If NPC is in processing state, don't allow any state transitions except to emptystall\n    if (this.state === 'processing') {\n        // Only log periodically to avoid spam\n        if (!this.lastProcessingLog || Date.now() - this.lastProcessingLog > 5000) {\n            //console.log(` NPC ${this.id} is in processing state, waiting for collection. GrazeEnd: ${this.grazeEnd}`);\n            this.lastProcessingLog = Date.now();\n        }\n        return; // Exit early, don't process any state transitions\n    }\n\n    switch (this.state) {\n        case 'idle': {\n//            console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            const idleCompleted = await this.handleIdleState(tiles, resources, npcs, 4, async () => {\n//              console.log(` Retrying after idle for NPC ${this.id}`);\n              // Check if we have grazeEnd to determine next state\n              if (this.grazeEnd && Date.now() >= this.grazeEnd) {\n                this.state = 'stall';\n              } else {\n                this.state = 'hungry';\n              }\n              await updateThisNPC();\n            });\n          \n            if (!idleCompleted) {\n              // Don't continue state processing if we're still idling\n              return;\n            }\n          \n            // If idle completed and `onTransition` fired, the state is now \"stall\"\n            break;\n          }\n\n        case 'hungry': {\n            //console.log(`NPC ${this.id} is in HUNGRY state.`);\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n\n            const currentTime = Date.now();\n            if (this.grazeEnd && currentTime >= this.grazeEnd) {\n                console.log(` Grazing already done  NPC ${this.id} skipping hungry.`);\n                this.state = 'stall';\n                await updateThisNPC();\n                break;\n            }\n\n            //console.log(\"this.targetGrassTile = \", this.targetGrassTile);\n\n            // Find the target grass tile if not already set\n            if (!this.targetGrassTile) {\n                //console.log(`NPC ${this.id} finding nearest grass tile.`);\n                \n                // Determine which tile type to look for based on NPC type\n                const targetTileType = this.type === 'Pig' ? 'd' : 'g'; // Pigs graze on dirt, others on grass\n                \n                // Find all grass/dirt tiles within range\n                const grassTiles = await this.findTileInRange(targetTileType, tiles, resources);\n        \n                if (!Array.isArray(grassTiles) || grassTiles.length === 0) {\n                    const tileTypeName = targetTileType === 'd' ? 'dirt' : 'grass';\n                    console.warn(`No ${tileTypeName} tiles found for NPC ${this.id}. Transitioning to idle.`);\n                    this.state = 'idle'; // Fallback to idle if no valid tiles\n                    break;\n                }\n        \n                // Filter out occupied grass tiles (by resources or other grazing animals)\n                const unoccupiedGrassTiles = grassTiles.filter((tile) => {\n                    // Check if occupied by a resource\n                    if (resources.some((res) => res.x === tile.x && res.y === tile.y)) {\n                        return false;\n                    }\n                    // Check if occupied by another grazing animal\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === tile.x &&\n                        Math.floor(npc.position?.y) === tile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        console.log(`Grass tile at (${tile.x}, ${tile.y}) is occupied by another animal, skipping`);\n                        return false;\n                    }\n                    return true;\n                });\n        \n                if (unoccupiedGrassTiles.length === 0) {\n                    const tileTypeName = targetTileType === 'd' ? 'dirt' : 'grass';\n                    console.warn(`No unoccupied ${tileTypeName} tiles found for NPC ${this.id}. Transitioning to idle.`);\n                    this.state = 'idle'; // Fallback to idle if no valid tiles\n                    break;\n                }\n        \n                // Sort tiles by distance and select the closest\n                unoccupiedGrassTiles.sort(\n                    (a, b) => calculateDistance(this.position, a) - calculateDistance(this.position, b)\n                );\n                this.targetGrassTile = unoccupiedGrassTiles[0];\n                //console.log(`NPC ${this.id} selected grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}).`);\n            }\n        \n            // Attempt to move toward the target grass tile\n            if (this.targetGrassTile && \n                typeof this.targetGrassTile.x === 'number' && \n                typeof this.targetGrassTile.y === 'number') \n            {\n                const dx = this.targetGrassTile.x - Math.floor(this.position.x);\n                const dy = this.targetGrassTile.y - Math.floor(this.position.y);\n                //console.log(`NPC ${this.id} movement vector: dx=${dx}, dy=${dy}, current position=(${this.position.x}, ${this.position.y}), target=(${this.targetGrassTile.x}, ${this.targetGrassTile.y})`);\n        \n                let direction = null;\n        \n                // Explicitly handle when dx and dy are both 0 (already at the target)\n                if (dx === 0 && dy === 0) {\n                    // Before transitioning to grazing, check if another animal has moved onto our target\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === this.targetGrassTile.x &&\n                        Math.floor(npc.position?.y) === this.targetGrassTile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        console.warn(`Another animal took our target grass tile! Finding new one.`);\n                        this.targetGrassTile = null;\n                        break; // Stay in hungry state and find new tile next update\n                    }\n                   // console.log(`NPC ${this.id} is already at the target grazing tile. Transitioning to grazing.`);\n                    this.state = 'grazing'; // Transition to grazing\n                    this.targetGrassTile = null; // Clear the target\n                    await updateThisNPC(); // Save after transition\n                    break;\n                }\n        \n                // Prioritize diagonal movement if dx and dy are both non-zero\n                if (dx > 0 && dy > 0) direction = 'SE';\n                else if (dx > 0 && dy < 0) direction = 'NE';\n                else if (dx < 0 && dy > 0) direction = 'SW';\n                else if (dx < 0 && dy < 0) direction = 'NW';\n                else if (dx > 0) direction = 'E';\n                else if (dx < 0) direction = 'W';\n                else if (dy > 0) direction = 'S';\n                else if (dy < 0) direction = 'N';\n        \n                //console.log(`NPC ${this.id} determined direction: ${direction}`);\n        \n                if (!direction) {\n                    console.warn(`NPC ${this.id} could not determine direction to grass tile.`);\n                    this.state = 'idle';\n                    this.targetGrassTile = null;\n                    break;\n                }\n        \n                if (!this.isMoving) {\n                    //console.log(`NPC ${this.id} moving one tile toward grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}).`);\n                    this.isMoving = true;\n                    const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n        \n                    // Ensure position snaps to integers after movement\n                    this.position.x = Math.floor(this.position.x);\n                    this.position.y = Math.floor(this.position.y);\n                    this.isMoving = false;\n                    if (!moved) {\n                        console.warn(`NPC ${this.id} is stuck and cannot move toward the grass. Switching to idle.`);\n                        this.targetGrassTile = null;\n                        this.state = 'idle';\n                        await updateThisNPC(); //  Save failure state\n                        break;\n                      }\n                }\n        \n                // Check if NPC has reached the grass tile\n                if (\n                    this.targetGrassTile &&\n                    Math.floor(this.position.x) === this.targetGrassTile.x &&\n                    Math.floor(this.position.y) === this.targetGrassTile.y\n                ) {\n                    // Before transitioning to grazing, check if another animal has moved onto our target\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === this.targetGrassTile.x &&\n                        Math.floor(npc.position?.y) === this.targetGrassTile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        console.warn(`Another animal took our target grass tile! Finding new one.`);\n                        this.targetGrassTile = null;\n                        // Don't transition to grazing, stay hungry and find new tile\n                    } else {\n                        //console.log(`NPC ${this.id} has reached the grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}). Transitioning to grazing.`);\n                        this.state = 'grazing'; // Transition to grazing\n                        this.targetGrassTile = null; // Clear the target\n                        await updateThisNPC(); // Save after transition\n                    }\n                }\n            }\n            else {\n                    console.warn(` [Hungry] NPC ${this.id} has invalid targetGrassTile. Roaming to unstuck.`);\n                    this.targetGrassTile = null;\n                    this.state = 'roam';\n                    await updateThisNPC();\n                    break;\n            }\n            break;\n        }\n \n          \n        case 'grazing': {\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n            const currentTime = Date.now();\n        \n            //console.log(`grazeEnd: ${this.grazeEnd}, growTime: ${this.growTime}, type: ${this.type}`);\n\n            if (!this.grazeEnd) {\n                this.grazeEnd = currentTime + (this.growTime * 1000); // Calculate grazing end time\n                //console.log('in state = grazing; setting grazeEnd: ',this.grazeEnd);\n                await updateThisNPC();\n            }\n            \n            //  Check if grazing is complete\n            if (currentTime >= this.grazeEnd) {\n                //console.log(` NPC ${this.id} finished grazing. Moving to stall.`);\n                //  Transition to stall\n                this.state = 'stall';\n                await updateThisNPC();\n            }\n            break;\n        }\n\n\n        case 'stall': {\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n            const fullGridState = NPCsInGridManager.getNPCsInGrid(gridId);\n            \n            // Initialize retry counter and failed stalls list\n            if (!this.stallRetries) this.stallRetries = 0;\n            if (!this.failedStalls) this.failedStalls = [];\n    \n            // Step 1: If no stall is currently assigned, find the nearest available stall\n            if (!this.targetStall) {\n                //console.log(`NPC ${this.id} finding nearest stall.`);\n                this.targetStall = this.findNearestResource('stall', tiles, resources, this.failedStalls);\n                if (!this.targetStall) {\n                    console.log('No availalbe stall, returning to idle.');\n                    this.state = 'idle';\n                    this.stallRetries = 0;\n                    this.failedStalls = [];\n                    break;\n                }\n            }\n        \n            // Step 5: Confirm the stall is still valid before proceeding\n            const stallResource = resources.find(\n                (res) => res.x === this.targetStall.x && res.y === this.targetStall.y\n            );\n            if (!stallResource) {\n                console.warn(`Target stall at (${this.targetStall.x}, ${this.targetStall.y}) is no longer valid. Transitioning to idle.`);\n                this.state = 'idle';\n                this.targetStall = null;\n                break;\n            }\n        \n            // Step 6: Calculate movement direction towards the stall\n            const dx = this.targetStall.x - Math.floor(this.position.x);\n            const dy = this.targetStall.y - Math.floor(this.position.y);\n            let direction = null;\n        \n            //  Prefer diagonals if both dx and dy are non-zero\n            if (dx !== 0 && dy !== 0) {\n                if (dx > 0 && dy > 0) direction = 'SE';\n                else if (dx > 0 && dy < 0) direction = 'NE';\n                else if (dx < 0 && dy > 0) direction = 'SW';\n                else if (dx < 0 && dy < 0) direction = 'NW';\n            } else if (dx !== 0) {\n                direction = dx > 0 ? 'E' : 'W';\n            } else if (dy !== 0) {\n                direction = dy > 0 ? 'S' : 'N';\n            }\n        \n            // Step 7: If a valid movement direction isn't determined, revert to idle state\n            if (!direction &&\n                (   Math.floor(this.position.x) !== this.targetStall.x &&\n                    Math.floor(this.position.y) !== this.targetStall.y )\n                ) {\n                    console.warn(`NPC ${this.id} could not determine direction to stall.`);\n                    this.state = 'idle';\n                    this.targetStall = null;\n                    break;\n                }\n        \n            // Step 8: Move the NPC one tile towards the stall\n            if (!this.isMoving) {\n                this.isMoving = true;\n                const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n                this.position.x = Math.floor(this.position.x);\n                this.position.y = Math.floor(this.position.y);\n                this.isMoving = false;\n                \n                if (!moved) {\n                    this.stallRetries++;\n                    \n                    if (this.stallRetries < 5) {\n                        // Try a different direction or wait\n                        //console.log(`NPC ${this.id} blocked, retry ${this.stallRetries}/5`);\n                    } else {\n                        // Add this stall to failed list and try another\n                        console.warn(`NPC ${this.id} cannot reach stall at (${this.targetStall.x}, ${this.targetStall.y}). Trying alternative.`);\n                        if (!this.failedStalls) this.failedStalls = [];\n                        this.failedStalls.push({ x: this.targetStall.x, y: this.targetStall.y });\n                        this.targetStall = null;\n                        this.stallRetries = 0;\n                        \n                        // Try to find another stall\n                        const alternativeStall = this.findNearestResource('stall', tiles, resources, this.failedStalls);\n                        if (!alternativeStall) {\n                            //console.log('No alternative stalls available, returning to idle.');\n                            this.state = 'idle';\n                            this.failedStalls = [];\n                            this.triedStall = true;\n                        }\n                    }\n                    await updateThisNPC(); //  Save state\n                    break;\n                }\n                \n                await updateThisNPC(); //  Save successful movement\n                }\n        \n            // Step 9: If NPC reaches the stall, transition to processing state\n            const atStall = Math.floor(this.position.x) === this.targetStall.x &&\n                           Math.floor(this.position.y) === this.targetStall.y;\n            const nearStall = Math.abs(Math.floor(this.position.x) - this.targetStall.x) <= 1 &&\n                             Math.abs(Math.floor(this.position.y) - this.targetStall.y) <= 1;\n            \n            // Accept being adjacent to stall if we've tried multiple times\n            if (atStall || (nearStall && this.stallRetries > 2)) {\n            \n                // Check if another animal is already at this position\n                const otherNPCsAtStall = Object.values(fullGridState || {}).filter(otherNpc => \n                    otherNpc.id !== this.id &&\n                    Math.floor(otherNpc.position?.x) === this.targetStall.x &&\n                    Math.floor(otherNpc.position?.y) === this.targetStall.y &&\n                    otherNpc.action === 'graze'\n                );\n                \n                console.log(` NPC ${this.id} reached stall at (${this.targetStall.x}, ${this.targetStall.y}). Other animals at same position: ${otherNPCsAtStall.length}`);\n                \n                if (otherNPCsAtStall.length > 0) {\n                    console.log(` Stall is occupied! Adding to failed list and trying another.`);\n                    if (!this.failedStalls) this.failedStalls = [];\n                    this.failedStalls.push({ x: this.targetStall.x, y: this.targetStall.y });\n                    this.targetStall = null;\n                    this.stallRetries = 0;\n                    // Don't transition to processing - stay in stall state to find another\n                    await updateThisNPC();\n                    break;\n                }\n                \n                //  Keep grazeEnd for server validation - it will be cleared after successful collection\n                // Allow multiple animals to be in processing state at the same stall\n                this.state = 'processing';\n                console.log(` NPC ${this.id} transitioning to processing state. GrazeEnd: ${this.grazeEnd}`);\n                \n                // Save the state change immediately and wait for confirmation\n                try {\n                    await updateThisNPC();\n                    console.log(` NPC ${this.id} state update to 'processing' sent to server`);\n                    \n                    // Wait longer for the update to propagate to the server\n                    await new Promise(resolve => setTimeout(resolve, 500));\n                    \n                    // Verify the update was successful\n                    const updatedNPC = NPCsInGridManager.getNPCsInGrid(gridId)?.[this.id];\n                    if (updatedNPC && updatedNPC.state !== 'processing') {\n                        console.error(` State update verification failed! NPC ${this.id} state is ${updatedNPC.state} instead of 'processing'`);\n                        // Try to update again with longer wait\n                        this.state = 'processing';\n                        await updateThisNPC();\n                        console.log(` Retried state update for NPC ${this.id}`);\n                        await new Promise(resolve => setTimeout(resolve, 500));\n                    } else {\n                        console.log(` Verified NPC ${this.id} is in processing state`);\n                    }\n                } catch (error) {\n                    console.error(` Failed to update NPC ${this.id} to processing state:`, error);\n                }\n                }\n\n            break;\n        }\n \n        case 'processing': {\n            // awaiting handleNPCClick\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            // console.log('Awaiting handleNPCClick');\n            // IMPORTANT: Don't transition out of processing state unless explicitly collected\n            if (this.grazeEnd && Date.now() >= this.grazeEnd) {\n                console.log(` NPC ${this.id} is in processing state and ready for collection. GrazeEnd: ${this.grazeEnd}`);\n                \n                // Check if the animal has been stuck in processing for too long (e.g., over 1 hour past grazeEnd)\n                const timeSinceGrazeEnd = Date.now() - this.grazeEnd;\n                if (timeSinceGrazeEnd > 3600000) { // 1 hour in milliseconds\n                    console.warn(` NPC ${this.id} has been in processing state for ${Math.floor(timeSinceGrazeEnd / 1000)} seconds. Resetting to emptystall.`);\n                    this.state = 'emptystall';\n                    await updateThisNPC();\n                }\n            }\n        break;\n        }\n\n        case 'emptystall': {\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            this.targetStall = null;\n            this.grazeEnd = null; // Clear grazeEnd so cow will go hungry after roaming\n            this.state = 'roam'; // Transition to roam state\n            await updateThisNPC(); // Save after transition\n            break;\n        }\n         \n        case 'roam': {\n\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            await this.handleRoamState(tiles, resources, npcs, async () => {\n                //  This is your onTransition logic\n                if (!this.grazeEnd) {\n                  console.log(` NPC ${this.id} has no grazeEnd, transitioning to hungry.`);\n                  this.state = 'hungry';\n                } else {\n                  console.log(` NPC ${this.id} completed roam but grazing NOT done. Going idle.`);\n                  this.state = 'idle';\n                }\n                await updateThisNPC();\n              });\n\n            break;\n          }\n\n        default:\n            console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`);\n            break;\n    }\n}\n\n// Export a function to attach the behavior to the NPC class\nexport function attachGrazingBehavior(NPC) {\n    NPC.prototype.handleFarmAnimalBehavior = handleFarmAnimalBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleQuestGiverBehavior(gridId) {\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleQuestGiverBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Force state to roam if it's not already (one-time update)\n    if (this.state !== 'roam') {\n        this.state = 'roam';\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    }\n\n    // Check if this NPC is within any PC's range\n    const pcsInRange = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}).some(pc => \n        calculateDistance(pc.position, this.position) <= (pc.range || 3) && pc.hp > 0\n    );\n    \n    if (pcsInRange) {\n        // If players are in range, don't move (but stay in roam state)\n        // This creates the effect of the NPC stopping when players approach\n        return;\n    }\n    \n    // Always handle roam state - no more switching\n    await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n    });\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachQuestBehavior(NPC) {\n    NPC.prototype.handleQuestGiverBehavior = handleQuestGiverBehavior;\n}","import GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport FloatingTextManager from \"../../UI/FloatingText\";\n\n/** Helper to get tiles in line of sight between two points using Bresenham's algorithm **/\nfunction getLineOfSightTiles(start, end) {\n    const tiles = [];\n    let x0 = Math.floor(start.x);\n    let y0 = Math.floor(start.y);\n    const x1 = Math.floor(end.x);\n    const y1 = Math.floor(end.y);\n    \n    const dx = Math.abs(x1 - x0);\n    const dy = Math.abs(y1 - y0);\n    const sx = x0 < x1 ? 1 : -1;\n    const sy = y0 < y1 ? 1 : -1;\n    let err = dx - dy;\n    \n    while (true) {\n        // Don't include the start or end positions\n        if ((x0 !== Math.floor(start.x) || y0 !== Math.floor(start.y)) && \n            (x0 !== x1 || y0 !== y1)) {\n            tiles.push({ x: x0, y: y0 });\n        }\n        \n        if (x0 === x1 && y0 === y1) break;\n        \n        const e2 = 2 * err;\n        if (e2 > -dy) {\n            err -= dy;\n            x0 += sx;\n        }\n        if (e2 < dx) {\n            err += dx;\n            y0 += sy;\n        }\n    }\n    \n    return tiles;\n}\n\n/** Helper to check if NPC can see the target (no walls blocking) **/\nfunction canSeeTarget(npcPosition, targetPosition) {\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const lineOfSightTiles = getLineOfSightTiles(npcPosition, targetPosition);\n    \n    // Check each tile in the line of sight for walls\n    for (const tile of lineOfSightTiles) {\n        const wall = resources.find(res => \n            res.x === tile.x && \n            res.y === tile.y && \n            res.action === 'wall'\n        );\n        if (wall) {\n            return false; // Wall found blocking the view\n        }\n    }\n    \n    return true; // Clear line of sight\n}\n\nconst updateThisNPC = async function(gridId) {\n  await NPCsInGridManager.updateNPC(gridId, this.id, {\n    state: this.state,\n    position: this.position,\n  });\n};\n\nasync function handleEnemyBehavior(gridId, TILE_SIZE) {\n  //console.log(` NPC ${this.id} handling enemy behavior on grid ${gridId}.`);\n  const tiles = GlobalGridStateTilesAndResources.getTiles();\n  const resources = GlobalGridStateTilesAndResources.getResources();\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const pcs = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}); // Get all PCs on the grid\n\n  // Force initial state to roam if not set\n  if (!this.state || this.state === 'idle') {\n    this.state = 'roam';\n    await updateThisNPC.call(this, gridId);\n  }\n \n  // Check for visible PCs at the start of any state (immediate reaction)\n  const visiblePCsInRange = pcs.filter(pc => {\n    if (pc.hp <= 0) return false;\n    const dist = getDistance(this.position, pc.position);\n    if (dist > this.range) return false;\n    return canSeeTarget(this.position, pc.position);\n  });\n  \n  // If we see a PC and we're not already pursuing/attacking, immediately react\n  if (visiblePCsInRange.length > 0 && this.state === 'roam') {\n    const targetPC = visiblePCsInRange[Math.floor(Math.random() * visiblePCsInRange.length)];\n    console.log(` NPC ${this.id} spotted PC ${targetPC.username}! Entering pursue state.`);\n    this.targetPC = targetPC;\n    this.state = 'pursue';\n    this.pursueTimerStart = null;\n    await updateThisNPC.call(this, gridId);\n    return; // Skip the rest of the state processing\n  }\n \n  switch (this.state) {\n\n    case 'idle': {\n      // Idle is ONLY used to get unstuck - always transitions to roam, never back to idle\n      this.pursueTimerStart = null; // Clear pursuit timer\n      await this.handleIdleState(tiles, resources, npcs, 2, async () => {\n        // After idle, always go to roam (never back to idle)\n        this.state = 'roam';\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n      });\n      break;\n    }\n\n    case 'pursue': {\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId); // Refresh position from latest state\n      if (!this.targetPC) {\n        //console.warn(`NPC ${this.id} lost its target. Returning to roam state.`);\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        await updateThisNPC.call(this, gridId); // Save after transition\n        break;\n      }\n      \n      // First check if we can still see the target at all\n      const canStillSeeTarget = canSeeTarget(this.position, this.targetPC.position);\n      if (!canStillSeeTarget) {\n        console.log(` NPC ${this.id} lost sight of ${this.targetPC?.username} during pursuit. Returning to roam.`);\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n      \n      // Check if already in attack range AND can see target before pursuing\n      const currentDistance = getDistance(this.position, this.targetPC.position);\n      if (currentDistance <= this.attackrange) {\n        console.log(`NPC ${this.id} is already in attack range (${currentDistance} <= ${this.attackrange}) and can see target. Switching to attack!`);\n        this.state = 'attack';\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n      if (!this.pursueTimerStart) this.pursueTimerStart = Date.now();\n      const timeSincePursueStart = Date.now() - this.pursueTimerStart;\n      const distance = getDistance(this.position, this.targetPC?.position);\n      // Check if there's a closer PC to switch to (that can be seen)\n      const closestVisiblePC = findClosestVisiblePC(this.position, pcs);\n      if (closestVisiblePC && closestVisiblePC.playerId !== this.targetPC.playerId) {\n        const distToCurrent = distance;\n        const distToClosest = getDistance(this.position, closestVisiblePC.position);\n        if (distToCurrent - distToClosest >= 2) {\n          console.log(` NPC ${this.id} switching target from ${this.targetPC.username} to much closer PC ${closestVisiblePC.username}.`);\n          this.targetPC = closestVisiblePC;\n        }\n      }\n      // Give up if: \n      // 1. Target is too far AND we've been chasing for a while, OR\n      // 2. We can't see the target anymore (behind wall)\n      const canSeeTargetNow = canSeeTarget(this.position, this.targetPC.position);\n      \n      if ((distance > this.range * 2 && timeSincePursueStart > 5000) || !canSeeTargetNow) {\n        if (!canSeeTargetNow) {\n          console.log(` NPC ${this.id} lost sight of ${this.targetPC?.username} (wall blocking). Giving up pursuit.`);\n        } else {\n          console.log(` NPC ${this.id} gave up chasing ${this.targetPC?.username} (too far).`);\n        }\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n      console.log(`NPC ${this.id} is pursuing PC ${this.targetPC.username}.`);\n      \n      // Use a custom pursue handler that checks line of sight\n      const handlePursueWithLineOfSight = async () => {\n        const dx = this.targetPC.position.x - this.position.x;\n        const dy = this.targetPC.position.y - this.position.y;\n\n        let direction = null;\n        if (Math.abs(dx) > Math.abs(dy)) {\n          direction = dx > 0 ? 'E' : 'W';\n        } else if (dy !== 0) {\n          direction = dy > 0 ? 'S' : 'N';\n        }\n        // Add diagonal movement if applicable\n        if (Math.abs(dx) === Math.abs(dy)) {\n          if (dx > 0 && dy > 0) direction = 'SE';\n          else if (dx > 0 && dy < 0) direction = 'NE';\n          else if (dx < 0 && dy > 0) direction = 'SW';\n          else if (dx < 0 && dy < 0) direction = 'NW';\n        } \n        \n        // Check if already in attack range AND can see target BEFORE attempting to move\n        const distanceToPlayer = getDistance(this.position, this.targetPC.position);\n        console.log(` NPC ${this.id} distance to player: ${distanceToPlayer} | range: ${this.attackrange}`);\n        \n        if (distanceToPlayer <= this.attackrange) {\n          if (canSeeTarget(this.position, this.targetPC.position)) {\n            console.log(`NPC ${this.id} can see and attack ${this.targetPC.username}. Transitioning to attack!`);\n            this.state = 'attack';\n            await updateThisNPC.call(this, gridId);\n            return;\n          } else {\n            console.log(`NPC ${this.id} is in range but can't see ${this.targetPC.username} due to walls. Continuing pursuit.`);\n          }\n        }\n        \n        if (!direction) return;\n\n        const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n        if (!moved) {\n          console.log(`NPC ${this.id} could not move in direction ${direction}.`);\n          \n          // If we're stuck, use idle state to pick a random direction\n          if (!this.stuckCounter) this.stuckCounter = 0;\n          this.stuckCounter++;\n          \n          if (this.stuckCounter >= 3) {\n            console.log(`NPC ${this.id} appears stuck after ${this.stuckCounter} failed moves. Using idle to unstick.`);\n            this.state = 'idle';\n            this.stuckCounter = 0;\n            await updateThisNPC.call(this, gridId);\n          }\n        } else {\n          // Reset stuck counter on successful move\n          this.stuckCounter = 0;\n        }\n      };\n      \n      await handlePursueWithLineOfSight();\n      break;\n    }\n\n    case 'attack': {\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId); // Refresh position from latest state\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId);\n\n      if (!this.targetPC) {\n        //console.warn(`NPC ${this.id} lost its target. Returning to roam state.`);\n        this.pursueTimerStart = null;\n        this.state = 'roam';\n        await updateThisNPC.call(gridId); // Save after transition\n        break;\n      }\n      if (this.targetPC.hp <= 0 || this.targetPC.iscamping) {\n        this.state = 'roam';\n        await updateThisNPC.call(this, gridId);\n        break; //  Skip PCs that are dead or camping\n      }\n      const distanceToTarget = getDistance(this.position, this.targetPC.position);\n      if (distanceToTarget > this.attackrange) {\n        //console.log(`PC ${this.targetPC.username} moved out of attack range. Returning to 'pursue' state.`);\n        this.state = 'pursue';\n        await updateThisNPC.call(this, gridId); // Save after transition\n        break;\n      }\n      \n      // Check line of sight before attacking\n      if (!canSeeTarget(this.position, this.targetPC.position)) {\n        console.log(`NPC ${this.id} lost sight of ${this.targetPC.username} due to walls. Returning to 'pursue' state.`);\n        this.state = 'pursue';\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n \n      // Perform the attack\n      const attackRoll = Math.floor(Math.random() * 20) + 1;\n      const hitRoll = attackRoll + this.attackbonus;\n      const isAHit = hitRoll >= this.targetPC.armorclass;\n\n      // console.log('attackRoll = ', attackRoll);\n      // console.log('this.attackBonus = ', this.attackbonus)\n      // console.log('this.targetPC = ',this.targetPC);\n      // console.log('this.targetPC.armorclass = ',this.targetPC.armorclass);\n      // console.log('hitRoll = ', hitRoll);\n      // console.log('isAHit = ', isAHit);\n\n      if (!isAHit) {\n        //console.log(`NPC ${this.id} missed the attack on ${this.targetPC.username}.`);\n        FloatingTextManager.addFloatingText(503, this.targetPC.position.x, this.targetPC.position.y, TILE_SIZE);\n        setTimeout(() => {\n          this.state = 'attack'; // Retry attack after waiting\n        }, this.speed);\n      } else {\n        // apply damage\n        const damage = Math.floor(Math.random() * 6) + 1 + this.damage;\n        // Define the stat and amount to modify before calling modifyPlayerStats\n        const amountToMod = -damage;  // Damage is negative\n        \n        try {\n          const newHP = Math.max(0, this.targetPC.hp + amountToMod);\n          FloatingTextManager.addFloatingText(`- ${damage}  HP`, this.targetPC.position.x, this.targetPC.position.y, TILE_SIZE );\n          playersInGridManager.updatePC(gridId, this.targetPC.playerId, {\n            hp: newHP,\n            lastUpdated: Date.now()\n          });\n        } catch (error) {\n          console.error(`Error applying damage to player ${this.targetPC.username}:`, error);\n        }\n      }\n      break;\n    }\n\n    case 'roam': {\n      this.pursueTimerStart = null;\n      await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n      });\n      break;\n    }\n\n    default: {\n      console.warn(`Unhandled state: ${this.state}`);\n      break;\n    }\n  }\n}\n\n/**\n * Finds the closest PC to the given position.\n */\nfunction findClosestPC(npcPosition, pcs) {\n  let closestPC = null;\n  let minDistance = Infinity;\n\n  pcs.forEach((pc) => {\n    if (pc.hp <= 0) return; //  Skip PCs that are dead\n    const distance = getDistance(npcPosition, pc.position);\n    if (distance < minDistance) {\n      minDistance = distance;\n      closestPC = pc;\n    }\n  });\n\n  return closestPC;\n}\n\n/**\n * Helper to find the closest VISIBLE PC to an NPC (no walls blocking)\n */\nfunction findClosestVisiblePC(npcPosition, pcs) {\n  let closestPC = null;\n  let minDistance = Infinity;\n\n  pcs.forEach((pc) => {\n    if (pc.hp <= 0) return; // Skip PCs that are dead\n    const distance = getDistance(npcPosition, pc.position);\n    if (distance < minDistance && canSeeTarget(npcPosition, pc.position)) {\n      minDistance = distance;\n      closestPC = pc;\n    }\n  });\n\n  return closestPC;\n}\n\n/**\n * Calculates the Euclidean distance between two points.\n */\nfunction getDistance(pos1, pos2) {\n  return Math.sqrt((pos1.x - pos2.x) ** 2 + (pos1.y - pos2.y) ** 2);\n}\n\n\nexport function attachEnemyBehavior(NPC) {\n  NPC.prototype.handleEnemyBehavior = handleEnemyBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleHealBehavior(gridId) {\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleHealerBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Force state to roam if it's not already (one-time update)\n    if (this.state !== 'roam') {\n        this.state = 'roam';\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    }\n\n    // Check if this NPC is within any PC's range\n    const pcsInRange = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}).some(pc => \n        calculateDistance(pc.position, this.position) <= (pc.range || 3) && pc.hp > 0\n    );\n    \n    if (pcsInRange) {\n        // If players are in range, don't move (but stay in roam state)\n        // This creates the effect of the NPC stopping when players approach\n        return;\n    }\n\n    // Always handle roam state - no more switching\n    await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n    });\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachHealBehavior(NPC) {\n    NPC.prototype.handleHealBehavior = handleHealBehavior;\n}","import { calculateDistance } from '../../Utils/worldHelpers';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\n\nasync function handleSpawnBehavior(gridId) {\n    const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (!NPCsInGrid) {\n        console.warn(`GridState unavailable for gridId ${gridId}.`);\n        return;\n    }\n\n    const npcsObject = NPCsInGridManager.getNPCsInGrid(gridId); // this *is* the npcs object\n    const npcs = Object.values(npcsObject || {});\n    \n    const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n    const pcs = Object.values(playersInGrid || {});\n\n    //console.log(`[Spawner] Handling spawn behavior for ${this.type} at (${this.position.x}, ${this.position.y}). State: ${this.state}`);\n\n    //  Track position changes\n    const oldPosition = { x: this.position.x, y: this.position.y };\n\n    switch (this.state) {\n        case 'idle': {\n            const pcsInRange = pcs.some(pc => calculateDistance(pc.position, this.position) < this.range);\n            if (pcsInRange) {\n                console.log(`[Spawner] ${this.type} detected PCs nearby. Transitioning to spawn state.`);\n                this.state = 'spawn';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            }\n            break;\n        }\n\n        case 'spawn': {\n            const existingNPCs = npcs.filter(npc => npc.type === this.requires);\n            if (existingNPCs.length >= this.qtycollected) {\n                console.log(`[Spawner] Max ${this.requires} reached (${this.qtycollected}). Returning to idle.`);\n                this.state = 'idle';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n                return;\n            }\n\n            if (!this.nextspawn || Date.now() >= this.nextspawn) {\n                console.log(`[Spawner] Spawning new ${this.requires} at (${this.position.x}, ${this.position.y}).`);\n                //  ENSURE THE SPAWNER AND NPC HAVE SEPARATE POSITION OBJECTS \n                const npcPosition = { x: this.position.x, y: this.position.y }; // NEW OBJECT, NOT A REFERENCE\n\n                await NPCsInGridManager.spawnNPC(gridId, { type: this.requires }, npcPosition);\n\n                this.nextspawn = Date.now() + this.speed * 1000;\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            } else {\n                console.log(`[Spawner] Waiting for next spawn cycle.`);\n            }\n\n            const pcsStillInRange = pcs.some(pc => calculateDistance(pc.position, this.position) < this.range);\n            if (!pcsStillInRange) {\n                console.log(`[Spawner] No PCs nearby. Returning to idle.`);\n                this.state = 'idle';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            }\n            break;\n        }\n\n        default:\n            console.warn(`Unhandled state for NPC ${this.id}: ${this.state}`);\n            break;\n    }\n\n    //  Detect movement\n    if (this.position.x !== oldPosition.x || this.position.y !== oldPosition.y) {\n        console.error(`[Spawner] ERROR: Spawner ${this.id} moved from (${oldPosition.x}, ${oldPosition.y}) to (${this.position.x}, ${this.position.y})!`);\n    }\n}\n\n// Attach behavior to the NPC class\nexport function attachSpawnBehavior(NPC) {\n    NPC.prototype.handleSpawnBehavior = handleSpawnBehavior;\n}\n\n","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleWorkerBehavior(gridId) {\n    const updateThisNPC = async () => {\n        // Check if this NPC exists in the grid before updating\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n        if (!npcsInGrid || !npcsInGrid[this.id]) {\n            console.warn(` NPC ${this.id} (${this.type}) attempting to update but not found in grid ${gridId}. This NPC may be orphaned.`);\n            // Stop this NPC from continuing to update\n            if (this.updateInterval) {\n                clearInterval(this.updateInterval);\n                this.updateInterval = null;\n            }\n            return;\n        }\n        \n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    };\n\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleHealerBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Worker NPCs don't need to update state - they stay idle\n    // This prevents unnecessary save-single-npc calls\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachFarmerBehavior(NPC) {\n    NPC.prototype.handleWorkerBehavior = handleWorkerBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleTraderBehavior(gridId) { \n    const updateThisNPC = async () => {\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    };\n\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleTraderBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    switch (this.state) {\n        case 'idle': {\n            // Traders stay in place, they don't roam\n            // Just stay idle and wait for players to interact\n            break;\n        }\n\n        default:\n            console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`);\n            break;\n    }\n}\n\n// Attach the trader behavior to the NPC class\nexport function attachTraderBehavior(NPC) {\n    NPC.prototype.handleTraderBehavior = handleTraderBehavior;\n}","import socket from '../../socketManager'; \nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\nimport { attachGrazingBehavior } from './NPCGrazeBehavior';\nimport { attachQuestBehavior } from './NPCQuestBehavior';\nimport { attachEnemyBehavior } from './NPCEnemyBehavior';\nimport { attachHealBehavior } from './NPCHealBehavior';\nimport { attachSpawnBehavior } from './NPCSpawnerBehavior';\nimport { attachFarmerBehavior } from './NPCWorkerBehavior';\nimport { attachTraderBehavior } from './NPCTraderBehavior';\n \nclass NPC {\n  constructor(id, type, position, properties, gridId) {\n    console.log('NPC constructor: properties:', properties);\n    console.log('NPC constructor: gridId:', gridId);\n    console.log(`NPC constructor: ID=${id}, type=${type}, grazeEnd=`, properties.grazeEnd);\n\n    if (!properties || typeof properties !== 'object') {\n      console.error(`Invalid properties passed to NPC constructor for type ${type}:`, properties);\n      throw new Error('NPC constructor requires valid properties.');\n    }\n\n    this.updateInterval = properties.updateInterval || 1000; // Default to 1 second updates\n    this.id = id;\n    this.type = type;\n    this.position = {\n      x: Math.floor(position.x),\n      y: Math.floor(position.y),\n    };\n    this.symbol = properties.symbol;\n    this.hp = properties.hp || 0; // Use hp as hunger\n    this.output = properties.output;\n    this.maxhp = properties.maxhp || 0;\n    this.range = properties.range;\n    this.action = properties.action; // High-level behavioral category (e.g., \"graze\")\n    this.state = properties.state || 'idle'; // Use stored state or default to idle\n    this.speed = properties.speed; // Keep speed for combat stats, but do not use for movement animation\n    this.growTime = properties.growtime || 0; // Time to fully graze\n    this.processingStartTime = undefined;\n    this.nextspawn = properties.nextspawn ?? (this.action === 'spawn' ? Date.now() + 5000 : null);\n    this.grazeEnd = properties.grazeEnd || null; // this is preserved from NPCsInGrid\n    this.lastUpdated = Date.now(); // Initialize lastUpdated\n    this.gridId = properties.gridId || gridId; // Use the passed gridId or default to the one in properties\n    // Assign additional properties\n    Object.assign(this, properties);\n    console.log(` NPC ${this.id} constructed at position (${this.position.x}, ${this.position.y}) with state: ${this.state}`);\n  }\n\n\n/////////////////\n// NPC CORE   ///\n/////////////////\n\nupdate(currentTime, NPCsInGrid, gridId, TILE_SIZE) {\n\n  //console.log(` update() for NPC ${this.id} | currentTime: ${currentTime} | lastUpdated: ${this.lastUpdated} | elapsed: ${currentTime - this.lastUpdated}`);\n  const timeElapsed = currentTime - this.lastUpdated;\n  if (timeElapsed < this.updateInterval) { return; }\n  \n  this.processState(NPCsInGrid, gridId, TILE_SIZE);\n  this.lastUpdated = currentTime;\n}\n\nasync processState(NPCsInGrid, gridId, TILE_SIZE) {\n  \n  //console.log(` processState | NPC ${this.id} | state=${this.state} | action=${this.action} | gridId=${gridId}`);\n  try {\n\n    switch (this.action) {\n\n      case 'graze':\n        await this.handleFarmAnimalBehavior(gridId);\n        break;\n    \n      case 'pet':\n        // Future implementation for Pets\n        // console.log('Pet behavior not implemented yet.');\n        break;\n    \n      case 'quest':\n        await this.handleQuestGiverBehavior(gridId);\n        break;\n    \n      case 'trade':\n        await this.handleTraderBehavior(gridId);\n        break;\n\n      case 'worker':\n        await this.handleWorkerBehavior(gridId);\n        break;\n    \n      case 'heal':\n        await this.handleHealBehavior(gridId);\n        break;\n    \n      case 'attack':\n        await this.handleEnemyBehavior(gridId, TILE_SIZE);\n        break;\n    \n      case 'spawn':\n        await this.handleSpawnBehavior(gridId);\n        break;\n\n      default:\n        console.warn(`Unhandled NPC action: ${this.action}`);\n        break;\n    }\n    } catch (error) {\n      console.error(`Error in NPC ${this.id} processState:`, error);\n    }\n}\n\n\n//////////////////////////////\n// NPC -- SHARED BEHAVIORS //\n/////////////////////////////\n\nasync handleIdleState(tiles, resources, npcs, idleDuration, onTransition = () => {}) {\n  if (!this.idleTimer) this.idleTimer = 0;\n  this.idleTimer++;\n\n  if (this.idleTimer >= idleDuration) {\n    this.idleTimer = 0;\n\n    const directions = ['N', 'S', 'E', 'W', 'NE', 'SE', 'SW', 'NW'];\n    const validDirections = directions.filter((dir) => {\n      const { x, y } = this.getAdjacentTile(dir);\n      return this.isValidTile(x, y, tiles, resources, npcs);\n    });\n\n    if (validDirections.length > 0) {\n      const randomDirection = validDirections[Math.floor(Math.random() * validDirections.length)];\n      const moved = await this.moveOneTile(randomDirection, tiles, resources, npcs);\n      // if (moved) console.log(` NPC ${this.id} moved in idle to (${this.position.x}, ${this.position.y})`);\n    }\n    onTransition(); // callback to re-evaluate state\n    return true; // idle completed\n  }\n  //console.log(` NPC ${this.id} is idling. Timer: ${this.idleTimer}/${idleDuration}`);\n  return false; // still idling\n}\n\n\nasync handleRoamState(tiles, resources, npcs, onTransition = () => {}) {  // Initialize roam step counter and range\n  this.roamSteps = this.roamSteps || 0;\n  const range = this.range || 4; // Default roam range\n\n  // If no initial direction is set, choose one at random\n  if (!this.currentDirection) {\n    const directions = ['N', 'S', 'E', 'W', 'NE', 'SE', 'SW', 'NW'];\n    this.currentDirection = directions[Math.floor(Math.random() * directions.length)];\n    //console.log(`NPC ${this.id} selected initial roam direction: ${this.currentDirection}`);\n  }\n  // Define preferred directions based on the initial direction\n  const preferredDirectionsMap = {\n    N: ['N', 'NE', 'NW'],\n    S: ['S', 'SE', 'SW'],\n    E: ['E', 'NE', 'SE'],\n    W: ['W', 'NW', 'SW'],\n    NE: ['NE', 'N', 'E'],\n    SE: ['SE', 'S', 'E'],\n    SW: ['SW', 'S', 'W'],\n    NW: ['NW', 'N', 'W'],\n  };\n\n  const preferredDirections = preferredDirectionsMap[this.currentDirection] || [this.currentDirection];\n  const validDirections = preferredDirections.filter((direction) => {\n    const { x, y } = this.getAdjacentTile(direction);\n    return this.isValidTile(x, y, tiles, resources, npcs);\n  })\n  if (validDirections.length > 0) {\n    const direction = validDirections[Math.floor(Math.random() * validDirections.length)];\n    await this.moveOneTile(direction, tiles, resources, npcs);\n    this.roamSteps++;\n  } else {\n    this.currentDirection = null;\n    // console.warn(` NPC ${this.id} found no valid roam directions this step.`);\n  }\n\n  // Check if the NPC has completed the roam range\n  if (this.roamSteps >= range || validDirections.length === 0) {\n    //console.log(`NPC ${this.id} completed ${range} roam steps. Transitioning to the next state.`);\n    this.roamSteps = 0; // Reset roam steps\n    this.currentDirection = null; // Reset direction for the next roam\n    onTransition();\n  }\n}\n\nasync handlePursueState(playerPosition, tiles, resources, npcs, pcs, onAttackTransition) {\n\n  const dx = playerPosition.x - this.position.x;\n  const dy = playerPosition.y - this.position.y;\n\n  let direction = null;\n  if (Math.abs(dx) > Math.abs(dy)) {\n    direction = dx > 0 ? 'E' : 'W';\n  } else if (dy !== 0) {\n    direction = dy > 0 ? 'S' : 'N';\n  }\n  // Add diagonal movement if applicable\n  if (Math.abs(dx) === Math.abs(dy)) {\n    if (dx > 0 && dy > 0) direction = 'SE';\n    else if (dx > 0 && dy < 0) direction = 'NE';\n    else if (dx < 0 && dy > 0) direction = 'SW';\n    else if (dx < 0 && dy < 0) direction = 'NW';\n  } \n  \n  // Check if already in attack range BEFORE attempting to move\n  const distanceToPlayer = calculateDistance(this.position, playerPosition);\n  console.log(` NPC ${this.id} distance to player: ${distanceToPlayer} | range: ${this.attackrange}`);\n  if (distanceToPlayer <= this.attackrange) {\n    this.state = 'attack';\n    await onAttackTransition();\n    return;\n  }\n  \n  if (!direction) return;\n\n  const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n  if (!moved) {\n    // If can't move but already in attack range, attack!\n    if (distanceToPlayer <= this.attackrange) {\n      console.log(` NPC ${this.id} blocked but in attack range! Transitioning to attack.`);\n      this.state = 'attack';\n      await onAttackTransition();\n    } else {\n      console.warn(` NPC ${this.id} couldn't move toward target. Stuck? Returning to idle.`);\n      this.state = 'idle';\n      this.pursueTimerStart = null;\n      this.targetPC = null;\n    }\n    return;\n  }\n\n  // Check again after moving\n  const newDistanceToPlayer = calculateDistance(this.position, playerPosition);\n  console.log(` NPC ${this.id} NEW distance to player: ${newDistanceToPlayer} | range: ${this.attackrange}`);\n  if (newDistanceToPlayer <= this.attackrange) {\n    this.state = 'attack';\n    await onAttackTransition();\n  }\n}\n\n/////////////////\n// NPC UTILITY //\n/////////////////\n\nasync moveOneTile(direction, tiles, resources, npcs) {\n\n  if (this.action === 'spawn') {\n    console.warn(`Spawner ${this.id} cannot move!`);\n    return false; //  Prevents spawners from moving at all\n  }\n  const directions = {\n      N: { x: 0, y: -1 },\n      S: { x: 0, y: 1 },\n      E: { x: 1, y: 0 },\n      W: { x: -1, y: 0 },\n      NE: { x: 1, y: -1 },\n      SE: { x: 1, y: 1 },\n      SW: { x: -1, y: 1 },\n      NW: { x: -1, y: -1 },\n  };\n\n  const delta = directions[direction];\n  if (!delta) {\n      console.error(`Invalid direction: ${direction}`);\n      return false;\n  }\n  const targetX = Math.floor(this.position.x + delta.x);\n  const targetY = Math.floor(this.position.y + delta.y);\n\n  // Validate the tile before moving\n  if (!this.isValidTile(targetX, targetY, tiles, resources, npcs)) {\n      console.warn(`NPC ${this.id} cannot move to invalid tile (${targetX}, ${targetY}).`);\n      return false;\n  }\n  //console.log('Tile was valid.');\n  const moveDuration = 1200; // Standard movement speed for all NPCs\n  \n  // Set the target position immediately - CSS transition will handle the animation\n  this.position.x = targetX;\n  this.position.y = targetY;\n  \n  // Use updateNPCPosition for movement-only updates (doesn't save to DB immediately)\n  NPCsInGridManager.updateNPCPosition(this.gridId, this.id, { x: targetX, y: targetY });\n  \n  return new Promise((resolve) => {\n      // Wait for CSS transition to complete before emitting socket event\n      setTimeout(() => {\n          if (socket && socket.connected) {\n            socket.emit('npc-moved', {\n              gridId: this.gridId,\n              npcId: this.id,\n              newPosition: { x: targetX, y: targetY },\n              emitterId: socket.id\n            });\n            //console.log(` Emitting npc-moved for NPC ${this.id} to (${targetX}, ${targetY}) from ${socket.id}`);\n          }\n          resolve(true);\n      }, moveDuration);\n  });\n}\n\ngetAdjacentTile(direction) {\n  const directions = {\n      N: { x: 0, y: -1 },\n      S: { x: 0, y: 1 },\n      E: { x: 1, y: 0 },\n      W: { x: -1, y: 0 },\n      NE: { x: 1, y: -1 },\n      SE: { x: 1, y: 1 },\n      SW: { x: -1, y: 1 },\n      NW: { x: -1, y: -1 },\n  };\n\n  const delta = directions[direction];\n  if (!delta) {\n      console.error(`Invalid direction: ${direction}`);\n      return { x: this.position.x, y: this.position.y };\n  }\n\n  //console.log('getAdjacentTile: x = ',this.position.x + delta.x,' y = ',this.position.y + delta.y);\n  return {\n      x: this.position.x + delta.x,\n      y: this.position.y + delta.y,\n  };\n}\n\nisValidTile(x, y, tiles, resources, npcs) {\n\n    // Round x and y to ensure valid integer indices\n    x = Math.floor(x);\n    y = Math.floor(y);\n\n  // Check if tiles data is valid\n  if (!tiles || !Array.isArray(tiles)) {\n    //console.error('isValidTile; Tiles data is invalid.');\n    return false;\n  }\n  if (!resources || !Array.isArray(resources)) {\n    //console.error('isValidTile; Resources data is invalid or missing.');\n    return false;\n}\n  // Check if tile is out of bounds\n  if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[0].length) {\n    //console.error(`Tile (${x}, ${y}) is out of bounds.`);\n    return false;\n  } else {\n    //console.log(`Tile (${x}, ${y}) is in bounds.`);\n  }\n\n    // **Step 1: Check if NPC is allowed to step on this tile type**\n    const tileType = tiles[y][x]; // Get the tile type at x, y\n    //console.log(`Checking tileType: ${tileType} for NPC ${this.id}`);\n  \n    // Dynamically check if NPC can walk on this tile type\n    // Property name is 'validon' + tileType (e.g., 'validong' for 'g')\n    const validPropertyName = `validon${tileType}`;\n    const canWalkOnTile = this[validPropertyName] === true;\n  \n    if (!canWalkOnTile) {\n    //   console.warn(`NPC ${this.id} cannot step on tile type \"${tileType}\".`);\n      return false;\n    }\n  \n    // **Step 2: Check if there's an impassable resource in this tile**\n    const resourceInTile = resources.find((res) => res.x === x && res.y === y);\n    if (resourceInTile) {\n  \n      if (!resourceInTile.passable) {\n        //console.warn(`Tile (${x}, ${y}) is occupied by an impassable resource.`);\n        return false;\n      }\n    }\n  \n  // Ensure npcs is an array before calling .some()\n  if (!Array.isArray(npcs)) {\n    console.warn(`NPC list is invalid or undefined. Skipping NPC collision check.`);\n    return true;\n  }\n\n  // Check if another NPC is occupying the tile\n  const npcInTile = npcs.find(npc => Math.floor(npc.position.x) === x && Math.floor(npc.position.y) === y && npc.id !== this.id);\n  if (npcInTile) {\n    // Allow farm animals to move through other farm animals\n    const bothGrazingAnimals = this.action === 'graze' && npcInTile.action === 'graze';\n    if (!bothGrazingAnimals) {\n      //console.warn(`Tile (${x}, ${y}) is already occupied by another NPC.`);\n      return false;\n    }\n  }\n\n  //console.log(`Tile (${x}, ${y}) is valid for movement.`);\n  return true;\n}\n\n\n\nasync findTileInRange(tileType, tiles, resources) {\n  const range = Math.floor(this.range || 3); // Ensure integer range\n  const startX = Math.floor(this.position.x);\n  const startY = Math.floor(this.position.y);\n\n  if (!tiles || tiles.length === 0 || !Array.isArray(tiles)) {\n    // console.error('Tiles array is invalid or empty.');\n    return [];\n  }\n\n  const potentialTiles = [];\n  for (let dx = -range; dx <= range; dx++) {\n    for (let dy = -range; dy <= range; dy++) {\n      const x = startX + dx;\n      const y = startY + dy;\n\n      if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[y]?.length) continue;\n\n      if (tiles[y][x] === tileType) {\n        potentialTiles.push({ x, y });\n      }\n    }\n  }\n\n  console.log(`Found ${potentialTiles.length} potential tiles for type \"${tileType}\".`);\n  return potentialTiles;\n}\n\n\nfindNearestResource(targetResource, tiles, resources, excludePositions = []) {\n  //console.log(`Finding nearest ${targetResource} for NPC ${this.id}.`);\n\n  if (!resources || !Array.isArray(resources) || resources.length === 0) {\n    //console.error(`Resources are invalid or empty for NPC ${this.id}.`);\n    return null;\n  }\n  const npcPosition = {\n    x: Math.floor(this.position.x),\n    y: Math.floor(this.position.y),\n  };\n  \n  // Get all NPCs for checking stall occupancy\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(this.gridId) || {});\n  \n  const availableResources = resources.filter((res) => {\n    if (res.category !== targetResource || typeof res.x !== 'number' || typeof res.y !== 'number') {\n      return false;\n    }\n    // Exclude positions that have been tried and failed\n    const isExcluded = excludePositions.some(pos => pos.x === res.x && pos.y === res.y);\n    if (isExcluded) return false;\n    \n    // For stalls, check if another grazing animal is already there\n    if (targetResource === 'stall') {\n      const otherAnimalAtStall = npcs.some(npc => \n        npc.id !== this.id &&\n        npc.action === 'graze' &&\n        Math.floor(npc.position?.x) === res.x &&\n        Math.floor(npc.position?.y) === res.y\n      );\n      if (otherAnimalAtStall) {\n        //console.log(`Stall at (${res.x}, ${res.y}) is occupied, skipping`);\n        return false;\n      }\n    }\n    \n    return true;\n  });\n  if (availableResources.length === 0) {\n    //console.warn(`No available ${targetResource} found for NPC ${this.id}.`);\n    return null;\n  }\n  availableResources.sort((a, b) => {\n    const aPos = { x: Math.floor(a.x), y: Math.floor(a.y) };\n    const bPos = { x: Math.floor(b.x), y: Math.floor(b.y) };\n    return calculateDistance(npcPosition, aPos) - calculateDistance(npcPosition, bPos);\n  });\n  const closestResource = availableResources[0];\n  //console.log(`NPC ${this.id} selected nearest ${targetResource}:`, closestResource);\n  return closestResource;\n}\n\n// Find all resources of a type sorted by distance\nfindAllResources(targetResource, tiles, resources) {\n  if (!resources || !Array.isArray(resources) || resources.length === 0) {\n    return [];\n  }\n  const npcPosition = {\n    x: Math.floor(this.position.x),\n    y: Math.floor(this.position.y),\n  };\n  const availableResources = resources.filter((res) => {\n    return res.category === targetResource && typeof res.x === 'number' && typeof res.y === 'number';\n  });\n  availableResources.sort((a, b) => {\n    const aPos = { x: Math.floor(a.x), y: Math.floor(a.y) };\n    const bPos = { x: Math.floor(b.x), y: Math.floor(b.y) };\n    return calculateDistance(npcPosition, aPos) - calculateDistance(npcPosition, bPos);\n  });\n  return availableResources;\n}\n\n\n}\n\n// Attach behaviors to the NPC prototype\nattachGrazingBehavior(NPC);\nattachQuestBehavior(NPC);\nattachEnemyBehavior(NPC);\nattachHealBehavior(NPC);\nattachSpawnBehavior(NPC);\nattachFarmerBehavior(NPC);\nattachTraderBehavior(NPC);\n\nexport default NPC;","import React, { createContext, useContext } from 'react';\nimport stringsEN from './Strings/stringsEN.json';\nimport stringsFR from './Strings/stringsFR.json';\nimport stringsES from './Strings/stringsES.json';\nimport stringsIT from './Strings/stringsIT.json';\nimport stringsDE from './Strings/stringsDE.json';\nimport stringsPT from './Strings/stringsPT.json';\nimport stringsRU from './Strings/stringsRU.json';\nimport stringsNO from './Strings/stringsNO.json';\nimport stringsSV from './Strings/stringsSV.json';\nimport stringsFI from './Strings/stringsFI.json';\n\nconst STRINGS_MAP = {\n  en: stringsEN,\n  fr: stringsFR,\n  es: stringsES,\n  de: stringsDE,\n  it: stringsIT,\n  pt: stringsPT,\n  ru: stringsRU,\n  no: stringsNO,\n  sv: stringsSV,\n  fi: stringsFI,\n  // Add more languages here as needed\n};\n\nconst StringsContext = createContext(stringsEN); // Default to English\n\nexport const StringsProvider = ({ language = 'en', children }) => {\n  const selectedStrings = STRINGS_MAP[language?.toLowerCase()] || stringsEN;\n\n  console.log(' StringsProvider:', {\n    rawLanguage: language,\n    normalized: language?.toLowerCase(),\n    resolvedFile: selectedStrings,\n  });\n\n  return (\n    <StringsContext.Provider value={selectedStrings}>\n      {children}\n    </StringsContext.Provider>\n  );\n};\n\nexport const useStrings = () => {\n  const ctx = useContext(StringsContext);\n  //console.log(\" useStrings hook called, returning:\", ctx);\n  return ctx;\n};","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","import axios from 'axios';\nimport { animateRemotePC } from './Render/RenderAnimatePosition';\nimport playersInGridManager from './GridState/PlayersInGrid'; // Correctly use NPCsInGridManager\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport FloatingTextManager from \"./UI/FloatingText\";\nimport { handleTransitSignpost } from './GameFeatures/Transit/Transit';\n// Temporary render-only animation state for interpolated player positions\nexport const renderPositions = {};\nlet currentAnimationFrame = null;\n\n// Track currently pressed keys for diagonal movement\nconst pressedKeys = new Set();\n\n// Define modifier keys that should be ignored for movement\nconst MODIFIER_KEYS = ['Shift', 'Control', 'Alt', 'Meta', 'CapsLock', 'NumLock', 'ScrollLock'];\n\n// Clear all pressed keys when window loses focus or visibility\nif (typeof window !== 'undefined') {\n  window.addEventListener('blur', () => {\n    pressedKeys.clear();\n  });\n  \n  document.addEventListener('visibilitychange', () => {\n    if (document.hidden) {\n      pressedKeys.clear();\n    }\n  });\n  \n  // Debug function to check stuck keys (accessible from console)\n  window.debugMovementKeys = () => {\n    console.log('Currently pressed keys:', Array.from(pressedKeys));\n    return Array.from(pressedKeys);\n  };\n  \n  // Emergency reset function (accessible from console)\n  window.resetMovementKeys = () => {\n    pressedKeys.clear();\n    console.log('Movement keys reset');\n  };\n}\n\n// Helper function to handle key press events\nexport function handleKeyDown(event, currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null) \n{\n  // Ignore modifier keys\n  if (MODIFIER_KEYS.includes(event.key)) {\n    return;\n  }\n  \n  // Add the key to our set of pressed keys\n  pressedKeys.add(event.key);\n  \n  // Process movement immediately\n  processMovement(currentPlayer, TILE_SIZE, masterResources, \n    setCurrentPlayer, setGridId, setGrid, setTileTypes, setResources, \n    updateStatus, closeAllPanels, localPlayerMoveTimestampRef, bulkOperationContext, strings);\n}\n\n// Helper function to handle key release events\nexport function handleKeyUp(event) {\n  // Remove the key from our set of pressed keys\n  pressedKeys.delete(event.key);\n  \n  // Also clear all keys if a modifier is released (failsafe)\n  if (MODIFIER_KEYS.includes(event.key)) {\n    pressedKeys.clear();\n  }\n}\n\n// Main movement handler that processes diagonal movement\nexport function handleKeyMovement(event, currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null) \n{\n  // For backward compatibility, treat this as a key press\n  handleKeyDown(event, currentPlayer, TILE_SIZE, masterResources, \n    setCurrentPlayer, setGridId, setGrid, setTileTypes, setResources, \n    updateStatus, closeAllPanels, localPlayerMoveTimestampRef, bulkOperationContext, strings);\n}\n\n// Process movement based on all currently pressed keys\nfunction processMovement(currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null)\n{\n  const directions = {\n    ArrowUp: { dx: 0, dy: -1 },\n    w: { dx: 0, dy: -1 },\n    W: { dx: 0, dy: -1 },\n    ArrowDown: { dx: 0, dy: 1 },\n    s: { dx: 0, dy: 1 },\n    S: { dx: 0, dy: 1 },\n    ArrowLeft: { dx: -1, dy: 0 },\n    a: { dx: -1, dy: 0 },\n    A: { dx: -1, dy: 0 },\n    ArrowRight: { dx: 1, dy: 0 },\n    d: { dx: 1, dy: 0 },\n    D: { dx: 1, dy: 0 },\n  };\n\n  // Calculate combined movement vector from all pressed keys\n  let totalDx = 0;\n  let totalDy = 0;\n  \n  for (const key of pressedKeys) {\n    const movement = directions[key];\n    if (movement) {\n      totalDx += movement.dx;\n      totalDy += movement.dy;\n    }\n  }\n  \n  // If no movement, return\n  if (totalDx === 0 && totalDy === 0) return;\n  \n  // Clamp diagonal movement to -1, 0, or 1\n  totalDx = Math.max(-1, Math.min(1, totalDx));\n  totalDy = Math.max(-1, Math.min(1, totalDy));\n\n  if (currentPlayer.iscamping) {\n    FloatingTextManager.addFloatingText(32, currentPlayer.location.x, currentPlayer.location.y, TILE_SIZE);\n    return;\n  }\n\n  const playerId = currentPlayer._id.toString();\n  const gridId = currentPlayer.location.g;\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  if (!playersInGrid || !playersInGrid[playerId]) return;\n\n  const currentPosition = playersInGrid[playerId].position;\n  const targetX = Math.round(currentPosition.x + totalDx);\n  const targetY = Math.round(currentPosition.y + totalDy);\n\n  // Normal movement validation for all players (boats use existing transit logic)\n  if (!Array.isArray(masterResources)) {\n    console.error('masterResources is not an array:', masterResources);\n    return;\n  }\n  if (!isValidMove(targetX, targetY, masterResources,\n    currentPlayer,\n    setCurrentPlayer,\n    setGridId,\n    setGrid,\n    setTileTypes,\n    setResources,\n    updateStatus,\n    TILE_SIZE,\n    closeAllPanels,\n    bulkOperationContext,\n    strings\n  )) {\n    console.warn(` Player blocked from moving to (${targetX}, ${targetY}).`);\n    return;\n  }\n\n  const finalPosition = { x: targetX, y: targetY };\n  const now = Date.now();\n  \n  // Update the local player movement timestamp to prevent our own broadcasts from overriding\n  if (localPlayerMoveTimestampRef) {\n    localPlayerMoveTimestampRef.current = now;\n  }\n\n  playersInGridManager.updatePC(gridId, playerId, {\n    position: finalPosition,\n    lastUpdated: now,\n  });\n\n  centerCameraOnPlayer(finalPosition, TILE_SIZE);\n}\n\nfunction isValidMove(targetX, targetY, masterResources,\n  currentPlayer,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  closeAllPanels,\n  bulkOperationContext,\n  strings = null\n ) {  // Function to check if movement is valid\n  const tiles = GlobalGridStateTilesAndResources.getTiles();\n  const resources = GlobalGridStateTilesAndResources.getResources();\n  \n\n  if (!Array.isArray(resources)) {\n    console.warn(' Movement blocked: resources is not an array yet.', resources);\n    return false;\n  }\n\n  // 1 **Check if the target is out of bounds**\n  if (targetX < 0 || targetY < 0 || targetX > 63 || targetY > 63) {\n//  console.warn(` Movement blocked: (${targetX}, ${targetY}) is out of bounds.`);\n    const direction =\n      targetX < 0 ? \"Signpost W\" :\n      targetX > 63 ? \"Signpost E\" :\n      targetY < 0 ? \"Signpost N\" :\n      targetY > 63 ? \"Signpost S\" :\n      null;\n    if (!direction) { console.warn(` Invalid movement direction from (${targetX}, ${targetY}).`); return false; }\n\n    console.log(` Attempting directional travel via: ${direction}`);\n    const skills = currentPlayer.skills;\n\n    handleTransitSignpost(\n      currentPlayer,\n      direction,\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      updateStatus,\n      TILE_SIZE,\n      skills,\n      closeAllPanels,\n      bulkOperationContext,\n      null, // masterResources not available\n      strings,\n      null  // masterTrophies not available in PlayerMovement\n    );\n    return false; // Prevent normal movement handling\n  };\n\n  // 2 **Check if tile is valid for movement (using existing isValidTile function)**\n  const canMove = isTileValidForPlayer(targetX, targetY, tiles, resources, masterResources, currentPlayer);\n  if (!canMove) {\n    console.warn(` Movement blocked: Tile (${targetX}, ${targetY}) is not passable.`);\n  }\n  return canMove;\n}\n\n\nexport function centerCameraOnPlayer(position, TILE_SIZE) {\n  const gameContainer = document.querySelector(\".homestead\");\n  if (!gameContainer) return;\n\n  const LEFT_PANEL_WIDTH = 300;  // Scaled with zoom level\n  const HEADER_HEIGHT = 200;     // Same\n\n  const centerX = position.x * TILE_SIZE - (window.innerWidth - LEFT_PANEL_WIDTH) / 2;\n  const centerY = position.y * TILE_SIZE - (window.innerHeight - HEADER_HEIGHT) / 2;\n\n  // Clamp scroll positions so we don't scroll beyond the container's bounds\n  const maxScrollLeft = gameContainer.scrollWidth - gameContainer.clientWidth;\n  const maxScrollTop = gameContainer.scrollHeight - gameContainer.clientHeight;\n\n  const clampedX = Math.max(0, Math.min(centerX, maxScrollLeft));\n  const clampedY = Math.max(0, Math.min(centerY, maxScrollTop));\n\n  gameContainer.scrollTo({\n    left: clampedX,\n    top: clampedY,\n    behavior: \"smooth\",\n  });\n\n  //console.log(` Camera centered on player at (${position.x}, ${position.y})`);\n}\n\n\nexport function centerCameraOnPlayerFast(position, TILE_SIZE) {\n  const gameContainer = document.querySelector(\".homestead\");\n  if (!gameContainer) return;\n\n  const LEFT_PANEL_WIDTH = 300;  // Scaled with zoom level\n  const HEADER_HEIGHT = 200;     // Same\n\n  const centerX = position.x * TILE_SIZE - (window.innerWidth - LEFT_PANEL_WIDTH) / 2;\n  const centerY = position.y * TILE_SIZE - (window.innerHeight - HEADER_HEIGHT) / 2;\n\n  // Clamp scroll positions so we don't scroll beyond the container's bounds\n  const maxScrollLeft = gameContainer.scrollWidth - gameContainer.clientWidth;\n  const maxScrollTop = gameContainer.scrollHeight - gameContainer.clientHeight;\n\n  const clampedX = Math.max(0, Math.min(centerX, maxScrollLeft));\n  const clampedY = Math.max(0, Math.min(centerY, maxScrollTop));\n\n  gameContainer.scrollTo({\n    left: clampedX,\n    top: clampedY,\n  });\n\n  console.log(` Camera centered on player at (${position.x}, ${position.y})`);\n}\n\nexport function isTileValidForPlayer(x, y, tiles, resources, masterResources, currentPlayer = null) {\n  x = Math.floor(x);\n  y = Math.floor(y);\n  // Check if tile is out of bounds\n  if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[0].length) {\n    console.warn(` Tile (${x}, ${y}) is out of bounds.`);\n    return false;\n  }\n  // Get the tile type\n  const tileType = tiles[y][x];\n  // Ensure the tile type exists\n  if (!tileType) { console.warn(` Invalid tile at (${x}, ${y}) - No tileType found.`); return false; }\n\n  // **Special case: If player is in boat, they can only move on water tiles**\n  if (currentPlayer?.isinboat) {\n    if (tileType === 'w') {\n      console.log(` Boat player can move to water tile (${x}, ${y})`);\n      return true;\n    } else {\n      console.warn(` Boat player cannot move to non-water tile (${x}, ${y}): ${tileType}`);\n      return false;\n    }\n  }\n\n  // **Step 1: Check if tile itself is passable using masterResources (normal players)**\n  const tileResource = masterResources.find(resource => resource.type === tileType);\n\n  if (!tileResource || !tileResource.passable) {\n    console.warn(` Tile (${x}, ${y}) is not passable according to masterResources.`);\n    return false;\n  }\n  // **Step 2: Check for an impassable resource in this tile**\n  \n  const resourceInTile = resources.find(res => res.x === x && res.y === y);\n  \n  \n  if (resourceInTile) {\n    // Check if passable is explicitly false (not just falsy)\n    if (resourceInTile.passable === false) {\n      console.warn(` Tile (${x}, ${y}) contains an impassable resource (${resourceInTile.type}).`);\n      return false;\n    }\n  }\n  //  If all checks pass, movement is allowed\n  return true;\n}","import API_BASE from '../config';\nimport axios from 'axios';\n\nlet masterSkills = null;\nlet masterResources = null;\nlet globalTuning = null;\nlet masterInteractions = null;\nlet masterTraders = null;\nlet masterTrophies = null;\nlet masterWarehouse = null;\n/**\n * Fetch and cache skillsTuning.json\n */\nexport async function loadMasterSkills() {\n  if (!masterSkills) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/skills-tuning`);\n      masterSkills = response.data;\n      console.log('Skills tuning loaded:', masterSkills);\n    } catch (error) {\n      console.error('Error fetching master skills:', error);\n      masterSkills = {};\n    }\n  }\n  return masterSkills;\n}\n\n/**\n * Fetch and cache resources.json\n */\nexport async function loadMasterResources() {\n  if (!masterResources) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/resources`);\n      masterResources = response.data;\n      console.log('Master resources loaded:', masterResources);\n    } catch (error) {\n      console.error('Error fetching master resources:', error);\n      masterResources = [];\n    }\n  }\n  return masterResources;\n}\n\n\n/**\n * Fetch and cache globalTuning.json\n */\nexport async function loadGlobalTuning() {\n  if (!globalTuning) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/global-tuning`);\n      globalTuning = response.data;\n      console.log('Global tuning loaded:', globalTuning);\n    } catch (error) {\n      console.error('Error fetching global tuning:', error);\n      globalTuning = {};\n    }\n  }\n  return globalTuning;\n}\n\n/**\n * Fetch and cache interactions.json\n */\nexport async function loadMasterInteractions() {\n  if (!masterInteractions) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/interactions`);\n      masterInteractions = response.data;\n      console.log('Master interactions loaded:', masterInteractions);\n    } catch (error) {\n      console.error('Error fetching master interactions:', error);\n      masterInteractions = [];\n    }\n  }\n  return masterInteractions;\n}\n\n/**\n * Fetch and cache traders.json\n */\nexport async function loadMasterTraders() {\n  if (!masterTraders) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/traders`);\n      masterTraders = response.data;\n      console.log('Master traders loaded:', masterTraders);\n    } catch (error) {\n      console.error('Error fetching master traders:', error);\n      masterTraders = [];\n    }\n  }\n  return masterTraders;\n}\n\n/**\n * Fetch and cache trophies.json\n */\nexport async function loadMasterTrophies() {\n  if (!masterTrophies) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/trophies`);\n      masterTrophies = response.data;\n      console.log('Master trophies loaded:', masterTrophies);\n    } catch (error) {\n      console.error('Error fetching master trophies:', error);\n      masterTrophies = [];\n    }\n  }\n  return masterTrophies;\n}\n\n/**\n * Fetch and cache warehouse.json\n */\nexport async function loadMasterWarehouse() {\n  if (!masterWarehouse) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/warehouse`);\n      masterWarehouse = response.data;\n      console.log('Master warehouse loaded:', masterWarehouse);\n    } catch (error) {\n      console.error('Error fetching master warehouse:', error);\n      masterWarehouse = [];\n    }\n  }\n  return masterWarehouse;\n}\n\n/**\n * Clear cached data (optional, for debugging or forced reloads).\n */\nexport function clearTuningCache() {\n  masterSkills = null;\n  masterResources = null;\n  masterTraders = null;\n  masterTrophies = null;\n  masterWarehouse = null;\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};function X(){throw Error(\"act(...) is not supported in production builds of React.\");}\nexports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;exports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;\nexports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;exports.act=X;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=X;exports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};\nexports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};exports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};\nexports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};exports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.3.1\";\n","/**\n * Shared formatters for collection status messages\n * Used by both single and bulk collection operations\n */\n\n/**\n * Format harvest/collection results for status bar\n * @param {String} operation - Type of operation ('harvest', 'craft', 'animal', 'logging')\n * @param {Object} results - Collection results with items and quantities\n * @param {Object} skillsInfo - Skills applied for each item type\n * @param {Object} replantInfo - Optional replanting information\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted status message\n */\nexport function formatCollectionResults(operation, results, skillsInfo, replantInfo, strings, getLocalizedString) {\n  const parts = [];\n  \n  // Format the main collection based on operation type\n  const operationLabels = {\n    'harvest': strings[469] || 'Harvest complete',\n    'craft': strings[480] || 'Crafting complete',\n    'animal': strings[469] || 'Animal Collect complete',\n    'logging': strings[479] || 'Logging complete'\n  };\n  \n  const label = operationLabels[operation] || strings[469] || 'Complete';\n  \n  // Format collected items\n  if (results && Object.keys(results).length > 0) {\n    const itemParts = Object.entries(results).map(([type, quantity]) => {\n      const skillInfo = skillsInfo?.[type];\n      const localizedName = getLocalizedString(type, strings);\n      \n      if (skillInfo && skillInfo.hasSkills) {\n        const skillsStr = skillInfo.skills.join(', ');\n        return `${quantity} ${localizedName}, ${strings[481]} ${skillsStr} ${strings[482]} (${skillInfo.multiplier}x)`;\n      } else {\n        return `${quantity} ${localizedName}`;\n      }\n    }).join(', ');\n    \n    parts.push(`${label} ${itemParts}`);\n  }\n  \n  // Add replanting info if provided\n  if (replantInfo && Object.keys(replantInfo).length > 0) {\n    const replantParts = Object.entries(replantInfo)\n      .map(([type, count]) => `${count} ${getLocalizedString(type, strings)}`)\n      .join(', ');\n    parts.push(`${replantParts} ${strings[483] || 'replanted'}`);\n  }\n  \n  return parts.join(' | ');\n}\n\n/**\n * Format single item collection for status bar\n * @param {String} operation - Type of operation\n * @param {String} itemType - Type of item collected\n * @param {Number} quantity - Quantity collected\n * @param {Object} skillInfo - Skills applied\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted status message\n */\nexport function formatSingleCollection(operation, itemType, quantity, skillInfo, strings, getLocalizedString) {\n  const results = { [itemType]: quantity };\n  const skillsInfo = skillInfo ? { [itemType]: skillInfo } : {};\n  return formatCollectionResults(operation, results, skillsInfo, null, strings, getLocalizedString);\n}\n\n/**\n * Format restart/replant results\n * @param {Object} restartInfo - Information about restarted operations\n * @param {String} operation - Type of operation ('craft' or 'harvest')\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted restart message\n */\nexport function formatRestartResults(restartInfo, operation, strings, getLocalizedString) {\n  if (!restartInfo || Object.keys(restartInfo).length === 0) {\n    return '';\n  }\n  \n  const restartParts = Object.entries(restartInfo)\n    .map(([type, count]) => `${count} ${getLocalizedString(type, strings)}`)\n    .join(', ');\n  \n  const labels = {\n    'craft': 'restarted',\n    'harvest': 'replanted'\n  };\n  \n  const label = labels[operation] || 'restarted';\n  return `${restartParts} ${label}`;\n}","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(Symbol.toStringTag in val) && !(Symbol.iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[Symbol.iterator];\n\n  const iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[Symbol.toStringTag] === 'FormData' && thing[Symbol.iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isHeaders(header)) {\n      for (const [key, value] of header.entries()) {\n        setHeader(value, key, rewrite);\n      }\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn.apply(null, args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure) {\n      const cookie = [name + '=' + encodeURIComponent(value)];\n\n      utils.isNumber(expires) && cookie.push('expires=' + new Date(expires).toGMTString());\n\n      utils.isString(path) && cookie.push('path=' + path);\n\n      utils.isString(domain) && cookie.push('domain=' + domain);\n\n      secure === true && cookie.push('secure');\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n      return (match ? decodeURIComponent(match[3]) : null);\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000);\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop , caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop , caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop , caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b , prop) => mergeDeepProperties(headersToObject(a), headersToObject(b),prop, true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let {data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth} = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  let contentType;\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // Let the browser set it\n    } else if ((contentType = headers.getContentType()) !== false) {\n      // fix semicolon duplication issue for ReactNative FormData implementation\n      const [type, ...tokens] = contentType ? contentType.split(';').map(token => token.trim()).filter(Boolean) : [];\n      headers.setContentType([type || 'multipart/form-data', ...tokens].join('; '));\n    }\n  }\n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst isFetchSupported = typeof fetch === 'function' && typeof Request === 'function' && typeof Response === 'function';\nconst isReadableStreamSupported = isFetchSupported && typeof ReadableStream === 'function';\n\n// used only inside the fetch adapter\nconst encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n    ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n    async (str) => new Uint8Array(await new Response(str).arrayBuffer())\n);\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst supportsRequestStream = isReadableStreamSupported && test(() => {\n  let duplexAccessed = false;\n\n  const hasContentType = new Request(platform.origin, {\n    body: new ReadableStream(),\n    method: 'POST',\n    get duplex() {\n      duplexAccessed = true;\n      return 'half';\n    },\n  }).headers.has('Content-Type');\n\n  return duplexAccessed && !hasContentType;\n});\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst supportsResponseStream = isReadableStreamSupported &&\n  test(() => utils.isReadableStream(new Response('').body));\n\n\nconst resolvers = {\n  stream: supportsResponseStream && ((res) => res.body)\n};\n\nisFetchSupported && (((res) => {\n  ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n    !resolvers[type] && (resolvers[type] = utils.isFunction(res[type]) ? (res) => res[type]() :\n      (_, config) => {\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n  });\n})(new Response));\n\nconst getBodyLength = async (body) => {\n  if (body == null) {\n    return 0;\n  }\n\n  if(utils.isBlob(body)) {\n    return body.size;\n  }\n\n  if(utils.isSpecCompliantForm(body)) {\n    const _request = new Request(platform.origin, {\n      method: 'POST',\n      body,\n    });\n    return (await _request.arrayBuffer()).byteLength;\n  }\n\n  if(utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n    return body.byteLength;\n  }\n\n  if(utils.isURLSearchParams(body)) {\n    body = body + '';\n  }\n\n  if(utils.isString(body)) {\n    return (await encodeText(body)).byteLength;\n  }\n}\n\nconst resolveBodyLength = async (headers, body) => {\n  const length = utils.toFiniteNumber(headers.getContentLength());\n\n  return length == null ? getBodyLength(body) : length;\n}\n\nexport default isFetchSupported && (async (config) => {\n  let {\n    url,\n    method,\n    data,\n    signal,\n    cancelToken,\n    timeout,\n    onDownloadProgress,\n    onUploadProgress,\n    responseType,\n    headers,\n    withCredentials = 'same-origin',\n    fetchOptions\n  } = resolveConfig(config);\n\n  responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n  let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n  let request;\n\n  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n  });\n\n  let requestContentLength;\n\n  try {\n    if (\n      onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n      (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n    ) {\n      let _request = new Request(url, {\n        method: 'POST',\n        body: data,\n        duplex: \"half\"\n      });\n\n      let contentTypeHeader;\n\n      if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n        headers.setContentType(contentTypeHeader)\n      }\n\n      if (_request.body) {\n        const [onProgress, flush] = progressEventDecorator(\n          requestContentLength,\n          progressEventReducer(asyncDecorator(onUploadProgress))\n        );\n\n        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n      }\n    }\n\n    if (!utils.isString(withCredentials)) {\n      withCredentials = withCredentials ? 'include' : 'omit';\n    }\n\n    // Cloudflare Workers throws when credentials are defined\n    // see https://github.com/cloudflare/workerd/issues/902\n    const isCredentialsSupported = \"credentials\" in Request.prototype;\n    request = new Request(url, {\n      ...fetchOptions,\n      signal: composedSignal,\n      method: method.toUpperCase(),\n      headers: headers.normalize().toJSON(),\n      body: data,\n      duplex: \"half\",\n      credentials: isCredentialsSupported ? withCredentials : undefined\n    });\n\n    let response = await fetch(request);\n\n    const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n    if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n      const options = {};\n\n      ['status', 'statusText', 'headers'].forEach(prop => {\n        options[prop] = response[prop];\n      });\n\n      const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n        responseContentLength,\n        progressEventReducer(asyncDecorator(onDownloadProgress), true)\n      ) || [];\n\n      response = new Response(\n        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n          flush && flush();\n          unsubscribe && unsubscribe();\n        }),\n        options\n      );\n    }\n\n    responseType = responseType || 'text';\n\n    let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n    !isStreamResponse && unsubscribe && unsubscribe();\n\n    return await new Promise((resolve, reject) => {\n      settle(resolve, reject, {\n        data: responseData,\n        headers: AxiosHeaders.from(response.headers),\n        status: response.status,\n        statusText: response.statusText,\n        config,\n        request\n      })\n    })\n  } catch (err) {\n    unsubscribe && unsubscribe();\n\n    if (err && err.name === 'TypeError' && /fetch/i.test(err.message)) {\n      throw Object.assign(\n        new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n        {\n          cause: err.cause || err\n        }\n      )\n    }\n\n    throw AxiosError.from(err, err && err.code, config, request);\n  }\n});\n\n\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: fetchAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nconst renderReason = (reason) => `- ${reason}`;\n\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    const rejectedReasons = {};\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      let id;\n\n      adapter = nameOrAdapter;\n\n      if (!isResolvedHandle(nameOrAdapter)) {\n        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n        if (adapter === undefined) {\n          throw new AxiosError(`Unknown adapter '${id}'`);\n        }\n      }\n\n      if (adapter) {\n        break;\n      }\n\n      rejectedReasons[id || '#' + i] = adapter;\n    }\n\n    if (!adapter) {\n\n      const reasons = Object.entries(rejectedReasons)\n        .map(([id, state]) => `adapter ${id} ` +\n          (state === false ? 'is not supported by the environment' : 'is not available in the build')\n        );\n\n      let s = length ?\n        (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n        'as no adapter specified';\n\n      throw new AxiosError(\n        `There is no suitable adapter to dispatch the request ` + s,\n        'ERR_NOT_SUPPORT'\n      );\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.8.4\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig;\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","// Configure animation durations (in milliseconds)\nconst VFX_TIMING = {\n    COLLECT_DURATION: 500,      // Doober collection poof animation\n    SWIPE_DURATION: 1000,        // Source conversion swipe animation (was 400)\n    FADE_DURATION: 400,         // How long fade-out takes\n};\n\n// Track recent effects to prevent duplicates\nconst recentEffects = new Map();\n\nconst createParticleElement = (char, x, y) => {\n    const particle = document.createElement('div');\n    particle.innerText = char;\n    particle.style.position = 'absolute';\n    particle.style.left = `${x}px`;\n    particle.style.top = `${y}px`;\n    particle.style.pointerEvents = 'none';\n    particle.style.zIndex = '1000';\n    particle.style.fontSize = '12px';\n    return particle;\n};\n\n// Add this utility function\nexport const calculateTileCenter = (x, y, TILE_SIZE) => {\n    const centerX = (x * TILE_SIZE) + (TILE_SIZE / 2) - 6;\n    const centerY = (y * TILE_SIZE) + (TILE_SIZE / 2) - 6;\n    return { centerX, centerY };\n};\n\nexport const createCollectEffect = (x, y, TILE_SIZE) => {\n    const gameContainer = document.querySelector('.homestead');\n    if (!gameContainer) return;\n    \n    // Debounce duplicate effects at the same location\n    const effectKey = `collect-${x}-${y}`;\n    const now = Date.now();\n    const lastEffectTime = recentEffects.get(effectKey);\n    \n    if (lastEffectTime && (now - lastEffectTime) < 100) {\n        console.log('Skipping duplicate collect effect at', x, y);\n        return;\n    }\n    \n    recentEffects.set(effectKey, now);\n    \n    // Clean up old entries after 1 second\n    setTimeout(() => {\n        recentEffects.delete(effectKey);\n    }, 1000);\n    \n    // Try to find the actual tile element to get its real position\n    const tiles = gameContainer.querySelectorAll('.tile');\n    let tileElement = null;\n    \n    // Find the tile at position (x, y) by checking computed positions\n    tiles.forEach(tile => {\n        const tileTop = parseInt(tile.style.top) / TILE_SIZE;\n        const tileLeft = parseInt(tile.style.left) / TILE_SIZE;\n        if (Math.round(tileLeft) === x && Math.round(tileTop) === y) {\n            tileElement = tile;\n        }\n    });\n    \n    let centerX, centerY;\n    \n    if (tileElement) {\n        // Use the actual tile's position for accurate placement\n        const rect = tileElement.getBoundingClientRect();\n        const containerRect = gameContainer.getBoundingClientRect();\n        centerX = rect.left - containerRect.left + (rect.width / 2) - 6;\n        centerY = rect.top - containerRect.top + (rect.height / 2) - 6;\n    } else {\n        // Fallback to calculated position\n        const { centerX: calcX, centerY: calcY } = calculateTileCenter(x, y, TILE_SIZE);\n        centerX = calcX;\n        centerY = calcY;\n    }\n    \n    console.log('createCollectEffect at grid(', x, ',', y, ') -> screen(', centerX, ',', centerY, ')');\n\n    const directions = [\n        { dx: -1, dy: -1, startX: -2, startY: -2 }, \n        { dx: 1, dy: -1, startX: 2, startY: -2 },  \n        { dx: -1, dy: 1, startX: -2, startY: 2 },   \n        { dx: 1, dy: 1, startX: 2, startY: 2 }     \n    ];\n\n    directions.forEach(dir => {\n        // Position particle at tile center + small initial offset\n        const particle = createParticleElement('', \n            centerX + dir.startX, \n            centerY + dir.startY\n        );\n        gameContainer.appendChild(particle);\n\n        // Animate outward from center\n        particle.style.transition = 'all 0.5s ease-out';\n        requestAnimationFrame(() => {\n            particle.style.transform = `translate(${dir.dx * 20}px, ${dir.dy * 20}px)`;\n            particle.style.opacity = '0';\n        });\n\n        setTimeout(() => {\n            gameContainer.removeChild(particle);\n        }, VFX_TIMING.COLLECT_DURATION);\n    });\n};\n \nexport const createSourceConversionEffect = (x, y, TILE_SIZE, requiredSkill) => {\n    const gameContainer = document.querySelector('.homestead');\n    if (!gameContainer) return;\n    console.log('createSourceConversionEffect called with x:', x, 'y:', y, 'requiredSkill:', requiredSkill);\n    // Determine emoji based on required skill\n    const emoji = requiredSkill?.includes('Axe') ? '' : \n                 requiredSkill?.includes('Pickaxe') ? '' : \n                 requiredSkill?.includes('Golden Key') ? '' : \n                  requiredSkill?.includes('Skeleton Key') ? '' : \n                '';\n\n    const { centerX, centerY } = calculateTileCenter(x, y, TILE_SIZE);\n    \n    const particle = document.createElement('div');\n    particle.innerText = emoji;\n    particle.style.position = 'absolute';\n    particle.style.left = `${centerX - TILE_SIZE/2 + 5}px`; // Added OFFSET\n    particle.style.top = `${centerY - TILE_SIZE/2 - 4}px`;\n    particle.style.pointerEvents = 'none';\n    particle.style.zIndex = '1000';\n    particle.style.fontSize = '28px';\n    gameContainer.appendChild(particle);\n\n    particle.style.transition = `all ${VFX_TIMING.SWIPE_DURATION}ms cubic-bezier(0.2, 0, 0, 1)`; // More forceful start, gentle end\n    requestAnimationFrame(() => {\n        particle.style.transform = `translate(-${TILE_SIZE}px, ${TILE_SIZE}px)`;\n        particle.style.opacity = '0';\n    });\n\n    setTimeout(() => {\n        gameContainer.removeChild(particle);\n    }, VFX_TIMING.SWIPE_DURATION); // Match the new animation duration\n};\n","import API_BASE from '../../config';\nimport axios from 'axios';\n\n/**\n * Updates quest progress for a given player.\n * @param {Object} player - Current player object.\n * @param {String} action - Action performed (e.g., \"Skill\", \"Craft\").\n * @param {String} item - Item associated with the action (e.g., \"Horse\", \"Axe\").\n * @param {Number} quantity - Quantity of the item affected.\n * @param {Function} setCurrentPlayer - State updater for the current player.\n */\nexport async function trackQuestProgress(player, action, item, quantity, setCurrentPlayer) {\n  if (!player?.activeQuests?.length) return;\n\n  console.log(\"At trackQuestProgress; action = \",action);\n\n  let questUpdated = false;\n\n  const updatedQuests = player.activeQuests.map((quest) => {\n    if (quest.completed || quest.rewardCollected) return quest; // Skip completed or rewarded quests\n\n    const progress = { ...quest.progress };\n    let goalsCompleted = 0; // Tracks how many goals are completed\n    let totalGoals = 0;     // Tracks total defined goals\n\n    for (let i = 1; i <= 3; i++) {\n      const goalAction = quest[`goal${i}action`];\n      const goalItem = quest[`goal${i}item`];\n      const goalQty = quest[`goal${i}qty`];\n\n      if (!goalAction || !goalItem || !goalQty) continue; // Skip undefined goals\n      totalGoals++; // Count this as a valid goal\n\n      if (goalAction === action && goalItem === item) {\n        progress[`goal${i}`] = Math.min((progress[`goal${i}`] || 0) + quantity, goalQty); // Increment progress\n      }\n\n      // Check if the goal is completed\n      if (progress[`goal${i}`] >= goalQty) goalsCompleted++;\n    }\n\n    // Mark quest as completed if all goals are done\n    if (goalsCompleted === totalGoals && totalGoals > 0) {\n      quest.completed = true;\n    }\n\n    quest.progress = progress;\n    questUpdated = true;\n\n    return quest;\n  });\n\n  if (questUpdated) {\n    try {\n      console.log(\"Saving updated player quests; updatedQuests = \", updatedQuests);\n      const response = await axios.post(`${API_BASE}/api/update-player-quests`, {\n        playerId: player.playerId,\n        activeQuests: updatedQuests,\n      });\n      if (typeof setCurrentPlayer === 'function') {\n        // Only update quest-related fields to avoid overwriting inventory changes\n        setCurrentPlayer(prev => ({\n          ...prev,\n          activeQuests: response.data.player.activeQuests || updatedQuests\n        }));\n      }    \n      } catch (error) {\n      console.error('Error updating quest progress:', error);\n    }\n  }\n}","import API_BASE from '../../config';\nimport axios from 'axios';\nimport FloatingTextManager from \"../../UI/FloatingText\";\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs\";\nimport playersInGridManager from \"../../GridState/PlayersInGrid\";\nimport { calculateDistance } from \"../../Utils/worldHelpers\";\nimport { extractXY } from \"../NPCs/NPCUtils\";\nimport { updateGridResource } from \"../../Utils/GridManagement\";\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { createCollectEffect } from \"../../VFX/VFX\";\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\n/** Helper to get tiles in line of sight between two points using Bresenham's algorithm **/\nfunction getLineOfSightTiles(start, end) {\n    const tiles = [];\n    let x0 = Math.floor(start.x);\n    let y0 = Math.floor(start.y);\n    const x1 = Math.floor(end.x);\n    const y1 = Math.floor(end.y);\n    \n    const dx = Math.abs(x1 - x0);\n    const dy = Math.abs(y1 - y0);\n    const sx = x0 < x1 ? 1 : -1;\n    const sy = y0 < y1 ? 1 : -1;\n    let err = dx - dy;\n    \n    while (true) {\n        // Don't include the start or end positions\n        if ((x0 !== Math.floor(start.x) || y0 !== Math.floor(start.y)) && \n            (x0 !== x1 || y0 !== y1)) {\n            tiles.push({ x: x0, y: y0 });\n        }\n        \n        if (x0 === x1 && y0 === y1) break;\n        \n        const e2 = 2 * err;\n        if (e2 > -dy) {\n            err -= dy;\n            x0 += sx;\n        }\n        if (e2 < dx) {\n            err += dx;\n            y0 += sy;\n        }\n    }\n    \n    return tiles;\n}\n\n/** Helper to check if there's a wall blocking line of sight **/\nfunction isWallBlocking(start, end) {\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const lineOfSightTiles = getLineOfSightTiles(start, end);\n    \n    // Check each tile in the line of sight for walls\n    for (const tile of lineOfSightTiles) {\n        const wall = resources.find(res => \n            res.x === tile.x && \n            res.y === tile.y && \n            res.action === 'wall'\n        );\n        if (wall) {\n            return true; // Wall found blocking the path\n        }\n    }\n    \n    return false; // No walls blocking\n}\n\n/** Helper to check if target is in range and validate positions **/\nfunction checkRange(player, target, TILE_SIZE) {\n\n    const playerPos = player.position;\n    const targetPos = extractXY(target.position);\n    \n    console.log('Fetched positions: playerPos =', playerPos, '; targetPos =', targetPos);\n    if (!targetPos) {\n        console.error(\"Invalid target position\", { targetPos });\n        FloatingTextManager.addFloatingText(505, 0, 0, TILE_SIZE);\n        return false;\n    }\n\n    const distance = calculateDistance(playerPos, targetPos);\n    const playerRange = player.attackrange || 1;\n    console.log('playerRange = ',playerRange);\n    console.log('playerPos = ',playerPos);\n\n    if (distance > playerRange) {\n        FloatingTextManager.addFloatingText(501, targetPos.x, targetPos.y, TILE_SIZE);\n        console.log('target out of range: targetPos.x = ',targetPos.x,' targetPos.y= ',targetPos.y);\n        return false;\n    }\n    \n    // Check for walls blocking line of sight\n    if (isWallBlocking(playerPos, targetPos)) {\n        FloatingTextManager.addFloatingText(40, targetPos.x, targetPos.y, TILE_SIZE); // string[40] for wall blocking\n        console.log('Wall blocking attack from player to target');\n        return false;\n    }\n    \n    return true;  // Target is in range and no walls blocking\n}\n\n/** Helper to determine if the attack hits **/\nfunction isAHit(player, target, TILE_SIZE) {\n\n    const attackRoll = Math.floor(Math.random() * 20) + 1;\n    const hitRoll = attackRoll + (player.attackbonus || 0);\n\n    console.log(`Attack roll: ${attackRoll}, Attack bonus: ${player.attackbonus}`);\n    console.log(`Total hit roll: ${hitRoll}, Target armor class: ${target.armorclass}`);\n\n    if (hitRoll >= target.armorclass) {\n        FloatingTextManager.addFloatingText(502, target.position.x, target.position.y-1, TILE_SIZE);\n        return true;\n    } else {\n        FloatingTextManager.addFloatingText(503, target.position.x, target.position.y, TILE_SIZE);\n        return false;\n    }\n}\n\n/** Helper to calculate damage **/\nfunction calculateDamage(player) {\n    const randomDamageModifier = Math.floor(Math.random() * 6) + 1;\n    const damage = (player.damage || 0) + randomDamageModifier;\n    console.log(`Damage roll: ${randomDamageModifier}, player damage: ${player.damage}, Damage dealt: ${damage}`);\n    return damage;\n}\n\n/** handle attack on NPC **/\nexport async function handleAttackOnNPC(npc, currentPlayer, setCurrentPlayer, TILE_SIZE, setResources, masterResources, masterTrophies = null) {\n    console.log(`Handling attack on NPC ${npc.id}.`);\n\n    // Translate currentPlayer to pc from playersInGridManager\n    const gridId = currentPlayer.location.g;\n    const playerId = currentPlayer._id.toString();  // Convert ObjectId to string for matching\n    console.log('playerId = ', playerId);\n    const player = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    console.log('player = ', player);\n    if (!player) {\n        console.error(`Player not found in playersInGrid for playerId: ${playerId}.`);\n        return;\n    }\n\n    const freshNPC = NPCsInGridManager.getNPCsInGrid(gridId)?.[npc.id] || npc;\n\n    if (player.iscamping) {\n        FloatingTextManager.addFloatingText(31, freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n        return;\n    }\n    if (!checkRange(player, freshNPC, TILE_SIZE)) return;\n    if (!isAHit(player, freshNPC, TILE_SIZE)) return;\n \n    const damage = calculateDamage(player);\n    FloatingTextManager.addFloatingText(`- ${damage}  HP`, freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n    createCollectEffect(freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n\n    freshNPC.hp -= damage;\n    await NPCsInGridManager.updateNPC(gridId, freshNPC.id, {\n      hp: freshNPC.hp,\n      position: freshNPC.position,\n      state: freshNPC.state,\n    });\n\n    if (freshNPC.hp <= 0) {\n        console.log(`NPC ${freshNPC.id} killed.`);\n        FloatingTextManager.addFloatingText(504, freshNPC.position.x, freshNPC.position.y-1, TILE_SIZE);\n\n        try {\n            await NPCsInGridManager.removeNPC(gridId, freshNPC.id);\n            console.log(`NPC ${freshNPC.id} successfully removed from grid.`);\n\n            // Add the Dead NPC \"output\" to the grid:\n            if (freshNPC.output) {\n                console.log(`Spawning resource: ${freshNPC.output} at NPC's death position.`);\n                const resourceDetails = masterResources.find((res) => res.type === freshNPC.output);\n\n                const enrichedResource = {\n                    ...resourceDetails,\n                    type: freshNPC.output,\n                    x: Math.floor(freshNPC.position.x),\n                    y: Math.floor(freshNPC.position.y),\n                    category: resourceDetails.category || 'doober',\n                    symbol: resourceDetails.symbol || '',\n                    qtycollected: resourceDetails.qtycollected || 1,\n                };\n\n                const updatedResources = [\n                    ...GlobalGridStateTilesAndResources.getResources(),\n                    enrichedResource\n                ];\n                GlobalGridStateTilesAndResources.setResources(updatedResources);\n                setResources((prevResources) => [...prevResources, enrichedResource]);\n\n                await updateGridResource(\n                    gridId, \n                    { \n                      type: freshNPC.output,\n                      x: Math.floor(freshNPC.position.x),\n                      y: Math.floor(freshNPC.position.y),\n                    },\n                    setResources,\n                    true\n                  );\n            } else {\n                console.warn(`NPC ${freshNPC.id} has no output resource defined.`);\n            }\n        } catch (error) {\n            console.error('Error removing NPC or spawning resource:', error);\n        }\n        \n        // Special case for Duke Angelo - auto-accept quest if not active\n        if (freshNPC.type === 'Duke Angelo') {\n            // Award \"Kill the Duke\" trophy when Duke Angelo is defeated\n            if (masterTrophies && currentPlayer?.playerId) {\n                try {\n                    console.log(' Awarding Kill the Duke trophy for defeating Duke Angelo');\n                    await earnTrophy(currentPlayer.playerId, \"Kill the Duke\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n                    console.log(' Successfully awarded Kill the Duke trophy');\n                } catch (error) {\n                    console.error(' Error awarding Kill the Duke trophy:', error);\n                }\n            }\n            \n            const bloodForJulietQuest = currentPlayer.activeQuests?.find(q => q.questId === 'Blood for Juliet');\n            \n            if (!bloodForJulietQuest) {\n                // Quest not active - auto-accept it with completed status\n                try {\n                    const response = await axios.post(`${API_BASE}/api/add-player-quest`, {\n                        playerId: currentPlayer.playerId,\n                        questId: 'Blood for Juliet',\n                        startTime: Date.now(),\n                        progress: { goal1: 1 }, // Mark as already completed\n                        completed: true, // Mark quest as completed\n                    });\n                    \n                    if (response.data.success) {\n                        setCurrentPlayer(response.data.player);\n                        FloatingTextManager.addFloatingText('Quest: Blood for Juliet completed!', freshNPC.position.x, freshNPC.position.y-2, TILE_SIZE);\n                        console.log('Auto-accepted and completed Blood for Juliet quest');\n                    }\n                } catch (error) {\n                    console.error('Error auto-accepting Blood for Juliet quest:', error);\n                }\n            } else {\n                // Quest is active - track progress normally\n                await trackQuestProgress(currentPlayer, 'Kill', freshNPC.type, 1, setCurrentPlayer);\n            }\n        } else {\n            // Normal quest progress tracking for other NPCs\n            await trackQuestProgress(currentPlayer, 'Kill', freshNPC.type, 1, setCurrentPlayer);\n        }\n    }\n}\n\n\nexport async function handleAttackOnPC(pc, currentPlayer, gridId, TILE_SIZE) {\n  const playerId = currentPlayer._id.toString();  // Convert ObjectId to string for matching\n  const player = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n  if (!player) {\n    console.error('Player not found in playersInGrid.');\n    return;\n  }\n\n  // Refresh the target PC from memory\n  pc = playersInGridManager.getPlayersInGrid(gridId)?.[pc.playerId] || pc;\n\n  if (!checkRange(player, pc, TILE_SIZE)) return;\n  if (!isAHit(player, pc, TILE_SIZE)) return;\n\n  const damage = calculateDamage(player, gridId);\n  FloatingTextManager.addFloatingText(`- ${damage} HP`, pc.position.x, pc.position.y, TILE_SIZE);\n  createCollectEffect(pc.position.x, pc.position.y, TILE_SIZE);\n\n  const newHP = Math.max(0, pc.hp - damage);\n  console.log(' Calling updatePC after reducing HP; current HP:', newHP);\n  await playersInGridManager.updatePC(gridId, pc.playerId, { hp: newHP });\n\n  if (newHP <= 0) {\n    console.log(`PC ${pc.playerId} defeated.`);\n    FloatingTextManager.addFloatingText(504, pc.position.x, pc.position.y+1, TILE_SIZE);\n  }\n}","import axios from 'axios';\nimport API_BASE from '../../config';\nimport { showNotification } from '../../UI/Notifications/Notifications';\n\n/**\n * Earns a trophy for the player\n * @param {string} playerId - The player's ID\n * @param {string} trophyName - The name of the trophy to earn (must match trophies.json)\n * @param {number} progressIncrement - For Progress trophies, the amount to increment (default 1)\n * @param {Object} currentPlayer - The current player object (optional, for Event trophy checking)\n * @param {Array} masterTrophies - The master trophies list (optional, for Event trophy checking)\n * @param {Function} setCurrentPlayer - Function to update local player state (optional)\n * @returns {Promise<Object>} The result of the API call\n */\nexport async function earnTrophy(playerId, trophyName, progressIncrement = 1, currentPlayer = null, masterTrophies = null, setCurrentPlayer = null) {\n    try {\n        // If we have currentPlayer and masterTrophies, check if this is an Event trophy that's already earned\n        if (currentPlayer && masterTrophies) {\n            const trophyDef = masterTrophies.find(t => t.name === trophyName);\n            if (trophyDef && trophyDef.type === 'Event') {\n                // Check if player already has this Event trophy\n                const hasEventTrophy = currentPlayer.trophies?.some(t => t.name === trophyName);\n                if (hasEventTrophy) {\n                    console.log(` Player already has Event trophy: ${trophyName}`);\n                    return { success: false, message: 'Trophy already earned' };\n                }\n            }\n        }\n        \n        const response = await axios.post(`${API_BASE}/api/earn-trophy`, {\n            playerId,\n            trophyName,\n            progressIncrement\n        });\n        \n        if (response.data.success) {\n            const { trophy, isNewMilestone } = response.data;\n            \n            // Update local player state with the new trophy\n            if (setCurrentPlayer && currentPlayer && isNewMilestone) {\n                setCurrentPlayer(prevPlayer => {\n                    const updatedTrophies = [...(prevPlayer.trophies || [])];\n                    \n                    // Check if trophy already exists (for Progress trophies)\n                    const existingTrophyIndex = updatedTrophies.findIndex(t => t.name === trophyName);\n                    \n                    if (existingTrophyIndex !== -1) {\n                        // Update existing trophy\n                        updatedTrophies[existingTrophyIndex] = {\n                            ...updatedTrophies[existingTrophyIndex],\n                            progress: trophy.progress,\n                            qty: trophy.qty,\n                            collected: false, // Reset collected status for new milestone\n                            timestamp: new Date()\n                        };\n                    } else {\n                        // Add new trophy\n                        updatedTrophies.push({\n                            name: trophyName,\n                            progress: trophy.progress,\n                            qty: trophy.qty,\n                            collected: false,\n                            timestamp: new Date()\n                        });\n                    }\n                    \n                    console.log(` Local player state updated with trophy: ${trophyName}`);\n                    return {\n                        ...prevPlayer,\n                        trophies: updatedTrophies\n                    };\n                });\n            }\n            \n            if (isNewMilestone) {\n                console.log(` Trophy milestone earned: ${trophyName}`, trophy);\n                \n                // Check if trophy is visible before showing notification\n                let shouldShowNotification = true;\n                if (masterTrophies) {\n                    const trophyDef = masterTrophies.find(t => t.name === trophyName);\n                    if (trophyDef && trophyDef.visible === false) {\n                        shouldShowNotification = false;\n                        console.log(` Trophy notification suppressed for hidden trophy: ${trophyName}`);\n                    }\n                }\n                \n                // Show trophy notification only for new milestones and visible trophies\n                if (shouldShowNotification) {\n                    showNotification('Trophy', trophy);\n                }\n            } else {\n                console.log(` Trophy progress: ${trophyName} - ${trophy.progress}/${trophy.nextMilestone}`);\n            }\n            \n            return response.data;\n        }\n        \n        return response.data;\n    } catch (error) {\n        console.error('Error earning trophy:', error);\n        return { success: false, error: error.message };\n    }\n}","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import API_BASE from '../config';\nimport socket from '../socketManager';\nimport axios from 'axios';\nimport { animateRemotePC } from '../Render/RenderAnimatePosition';\nimport { loadMasterResources } from '../Utils/TuningManager';\n\nclass GridStatePCManager {\n    constructor() {\n      this.playersInGrid = {}; // Store PC states in memory\n      this.pendingUpdates = {}; // Track pending position updates\n      this.batchInterval = null; // Interval for batch saving\n      this.BATCH_SAVE_INTERVAL = 5000; // Save positions every 5 seconds\n    }\n \n    registerSetPlayersInGrid(setter) {\n      this.setPlayersInGridReact = setter;\n    }\n    registerTileSize(tileSize) {\n      this.tileSize = tileSize;\n    }\n    \n    // Start the batch save interval\n    startBatchSaving() {\n      if (this.batchInterval) return; // Already running\n      \n      this.batchInterval = setInterval(() => {\n        this.processPendingUpdates();\n      }, this.BATCH_SAVE_INTERVAL);\n      console.log(' Started batch saving interval');\n    }\n    \n    // Stop the batch save interval\n    stopBatchSaving() {\n      if (this.batchInterval) {\n        clearInterval(this.batchInterval);\n        this.batchInterval = null;\n      }\n      // Save any remaining updates\n      this.processPendingUpdates();\n    }\n    \n    // Process all pending position updates\n    async processPendingUpdates() {\n      const updates = Object.entries(this.pendingUpdates);\n      if (updates.length === 0) return;\n      \n      console.log(` Processing ${updates.length} pending PC position updates`);\n      \n      // Group updates by gridId for batch processing\n      const updatesByGrid = {};\n      for (const [key, data] of updates) {\n        if (!updatesByGrid[data.gridId]) {\n          updatesByGrid[data.gridId] = {};\n        }\n        updatesByGrid[data.gridId][data.playerId] = data.pc;\n      }\n      \n      // Clear pending updates first\n      this.pendingUpdates = {};\n      \n      // Process batch updates for each grid\n      for (const [gridId, gridUpdates] of Object.entries(updatesByGrid)) {\n        try {\n          const response = await axios.post(`${API_BASE}/api/batch-update-pc-positions`, {\n            gridId: gridId,\n            updates: gridUpdates,\n            timestamp: Date.now()\n          });\n          \n          if (response.data.errors && response.data.errors.length > 0) {\n            console.warn(` Batch update had ${response.data.errors.length} errors:`, response.data.errors);\n          }\n          \n          console.log(` Batch updated ${response.data.updated} PC positions for grid ${gridId}`);\n        } catch (error) {\n          console.error(` Failed to batch save positions for grid ${gridId}:`, error);\n          // Re-add all failed updates back to pending\n          for (const [playerId, pc] of Object.entries(gridUpdates)) {\n            const key = `${gridId}-${playerId}`;\n            this.pendingUpdates[key] = {\n              gridId,\n              playerId,\n              pc,\n              lastUpdated: pc.lastUpdated\n            };\n          }\n        }\n      }\n      \n      if (Object.keys(this.pendingUpdates).length === 0) {\n        console.log(` All PC position updates saved successfully`);\n      }\n    }\n    \n    // Force save all pending updates immediately\n    async forceSavePendingUpdates() {\n      await this.processPendingUpdates();\n    }\n    \n    // Flush all position updates for a specific grid\n    async flushGridPositionUpdates(gridId) {\n      // Filter updates for the specific grid\n      const gridUpdates = Object.entries(this.pendingUpdates)\n        .filter(([key, data]) => data.gridId === gridId);\n      \n      if (gridUpdates.length === 0) return;\n      \n      console.log(` Flushing ${gridUpdates.length} PC position updates for grid ${gridId}`);\n      \n      // Remove these updates from pending\n      gridUpdates.forEach(([key]) => {\n        delete this.pendingUpdates[key];\n      });\n      \n      // Process just these updates\n      const updates = {};\n      gridUpdates.forEach(([key, data]) => {\n        updates[data.playerId] = data.pc;\n      });\n      \n      try {\n        const response = await axios.post(`${API_BASE}/api/batch-update-pc-positions`, {\n          gridId: gridId,\n          updates: updates,\n          timestamp: Date.now()\n        });\n        \n        console.log(` Flushed ${response.data.updated} PC positions for grid ${gridId}`);\n      } catch (error) {\n        console.error(` Failed to flush PC positions for grid ${gridId}:`, error);\n        // Re-add failed updates back to pending\n        gridUpdates.forEach(([key, data]) => {\n          this.pendingUpdates[key] = data;\n        });\n      }\n    }\n    /**\n     * Initialize the playersInGrid for a specific gridId.\n     */\n    async initializePlayersInGrid(gridId) {\n\n      console.log(' Fetching playersInGrid for gridId:', gridId);\n      if (!gridId) {\n        console.error('initializePlayersInGrid: gridId is undefined.');\n        return;\n      }\n    \n      try {\n        const response = await axios.get(`${API_BASE}/api/load-grid-state/${gridId}`);\n        const {\n          playersInGrid = { pcs: {}, lastUpdated: 0 },\n        } = response.data;\n    \n        // Build a consolidated local state with independent timestamps\n        const state = {\n          pcs: playersInGrid.pcs || {},\n          playersInGridLastUpdated: new Date(playersInGrid.lastUpdated || 0).getTime(),\n        };\n        const pcs = state.pcs || {};\n        console.log('Fetched PC NPCsInGrid:', state);\n    \n        // Normalize PC format\n        Object.keys(pcs).forEach((playerId) => {\n          const pcData = pcs[playerId];\n          pcs[playerId] = {\n            ...pcData,\n            position: pcData.position || { x: 0, y: 0 },\n          };\n        });\n    \n        this.playersInGrid[gridId] = state;\n    \n        this.setPlayersInGridReact((prev) => ({\n          ...prev,\n          [gridId]: {\n            pcs: pcs,\n            playersInGridLastUpdated: Date.now(),\n          },\n        }));\n\n        console.log(` Initialized playersInGrid for gridId ${gridId}:`, pcs);\n        \n        // Start batch saving for position updates\n        this.startBatchSaving();\n        \n        // Save positions before page unload\n        if (!this.unloadListenerAdded) {\n          window.addEventListener('beforeunload', () => {\n            console.log(' Page unloading, saving pending positions...');\n            // Use synchronous XMLHttpRequest for beforeunload\n            const updates = Object.entries(this.pendingUpdates);\n            if (updates.length > 0) {\n              // Group updates by gridId for batch processing\n              const updatesByGrid = {};\n              for (const [key, data] of updates) {\n                if (!updatesByGrid[data.gridId]) {\n                  updatesByGrid[data.gridId] = {};\n                }\n                updatesByGrid[data.gridId][data.playerId] = data.pc;\n              }\n              \n              // Send batch updates for each grid\n              for (const [gridId, gridUpdates] of Object.entries(updatesByGrid)) {\n                const xhr = new XMLHttpRequest();\n                xhr.open('POST', `${API_BASE}/api/batch-update-pc-positions`, false); // false = synchronous\n                xhr.setRequestHeader('Content-Type', 'application/json');\n                xhr.send(JSON.stringify({\n                  gridId: gridId,\n                  updates: gridUpdates,\n                  timestamp: Date.now()\n                }));\n              }\n            }\n          });\n          this.unloadListenerAdded = true;\n        }\n        \n        // Request fresh player list from server after loading DB state\n        // This will override any stale data with current server state\n        console.log(' Requesting current players from server for grid:', gridId);\n        if (socket && socket.emit) {\n          socket.emit('request-current-grid-players', { gridId });\n        }\n      } catch (error) {\n        console.error(' Error fetching playersInGrid:', error);\n      }\n    }\n    \n    getPlayersInGrid(gridId) {\n      const playersInGrid = this.playersInGrid[gridId];\n      if (!playersInGrid) {\n        console.warn(` No PC state found for gridId: ${gridId}`);\n        return {};\n      }\n      return playersInGrid.pcs;\n    }\n\n    getAllPCs(gridId) {\n      return this.playersInGrid?.[gridId]?.pcs || {};\n    }\n    getPlayerPosition(gridId, playerId) {\n      return this.playersInGrid?.[gridId]?.pcs?.[playerId]?.position || null;\n    }\n\n    setAllPCs(gridId, pcsObject) {\n      this.playersInGrid[gridId] = {\n        pcs: pcsObject || {},\n        playersInGridLastUpdated: Date.now(),\n      };\n    \n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: this.playersInGrid[gridId],\n        }));\n      }\n    }\n    \n    async addPlayer(gridId, playerId, pcData) {\n    // Add a new PC to the playersInGrid for a given gridId and playerId.\n    // This is only run on app initialization, IF the saved currentPlayer cannot be found in the playersInGrid.\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = {\n          pcs: {},\n          playersInGridLastUpdated: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n      const masterResources = await loadMasterResources();\n\n      // Compute modifiers from powers - support multiple attributes per power\n      // Only count equipped weapons/armor + all magic enhancements\n      const modifiers = {};\n      const equippedWeapon = pcData.settings?.equippedWeapon || null;\n      const equippedArmor = pcData.settings?.equippedArmor || null;\n      \n      // Helper functions to categorize powers\n      const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n      const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n      const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n      \n      (pcData.powers || []).forEach(power => {\n        const resource = masterResources.find(r => r.type === power.type);\n        if (resource && resource.category === 'power') {\n          const powerQty = power.quantity || 0;\n          \n          // Only count equipped weapons and armor, or all magic enhancements\n          const shouldCount = isMagicEnhancement(resource) || \n                             (isWeapon(resource) && power.type === equippedWeapon) ||\n                             (isArmor(resource) && power.type === equippedArmor);\n          \n          if (shouldCount) {\n            // Combat stat attributes to check for\n            const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n            \n            combatAttributes.forEach(attr => {\n              if (typeof resource[attr] === 'number') {\n                const value = powerQty * resource[attr];\n                modifiers[attr] = (modifiers[attr] || 0) + value;\n              }\n            });\n            \n          }\n        }\n      });\n\n      const getStat = (baseKey, modKey) => (pcData[baseKey] || 0) + (modifiers[modKey] || 0);\n\n      console.log(' [HP DEBUG] addPlayer - Base stat calculation:');\n      console.log('  pcData.baseHp:', pcData.baseHp);\n      console.log('  pcData.baseMaxhp:', pcData.baseMaxhp);\n      console.log('  modifiers.hp:', modifiers.hp);\n      console.log('  modifiers.maxhp:', modifiers.maxhp);\n      console.log('  getStat(\"baseHp\", \"hp\"):', getStat('baseHp', 'hp'));\n      console.log('  getStat(\"baseMaxhp\", \"maxhp\"):', getStat('baseMaxhp', 'maxhp'));\n\n      const newPC = {\n        playerId,\n        username: pcData.username,\n        type: 'pc',\n        icon: pcData.icon,\n        position: pcData.position || { x: 0, y: 0 },\n        hp: getStat('baseHp', 'hp'),\n        maxhp: getStat('baseMaxhp', 'maxhp'),\n        armorclass: getStat('baseArmorclass', 'armorclass'),\n        attackbonus: getStat('baseAttackbonus', 'attackbonus'),\n        damage: getStat('baseDamage', 'damage'),\n        attackrange: getStat('baseAttackrange', 'attackrange'),\n        speed: getStat('baseSpeed', 'speed'),\n        iscamping: pcData.iscamping || false,\n        isinboat: pcData.isinboat || false,\n        lastUpdated: now,\n      };\n\n      this.playersInGrid[gridId].pcs[playerId] = newPC;\n\n      // Save to server\n      try {\n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId,\n          playerId,\n          pc: newPC,\n          lastUpdated: now,\n        });\n        console.log(` Added and saved new PC ${playerId} to server.`);\n      } catch (error) {\n        console.error(` Failed to add PC ${playerId}:`, error);\n      }\n\n      // Emit to other clients\n      if (socket && socket.emit) {\n        socket.emit('update-NPCsInGrid-PCs', {\n          gridId,\n          pcs: { [playerId]: newPC },\n          playersInGridLastUpdated: now,\n        });\n      }\n\n      // Note: Caller should update React context using setPlayersInGrid if needed\n    }\n\n\n    // Add a new lightweight PC (from grid.playersInGrid schema) to the local in-memory playersInGrid\n    async addPC(gridId, playerId, pcData) {\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = {\n          pcs: {},\n          playersInGridLastUpdated: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n      \n      console.log(' [HP DEBUG] addPC - Incoming PC data:');\n      console.log('  pcData.hp:', pcData.hp);\n      console.log('  pcData.maxhp:', pcData.maxhp);\n      console.log('  playerId:', playerId);\n      \n      const newPC = {\n        playerId: pcData.playerId,\n        username: pcData.username,\n        type: pcData.type,\n        icon: pcData.icon,\n        position: pcData.position || { x: 0, y: 0 },\n        hp: pcData.hp,\n        maxhp: pcData.maxhp,\n        armorclass: pcData.armorclass,\n        attackbonus: pcData.attackbonus,\n        damage: pcData.damage,\n        attackrange: pcData.attackrange,\n        speed: pcData.speed,\n        iscamping: pcData.iscamping || false,\n        isinboat: pcData.isinboat || false,\n        lastUpdated: now,\n      };\n\n      this.playersInGrid[gridId].pcs[playerId] = newPC;\n\n      // Also update React state if setter is registered\n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: {\n              ...(prev[gridId]?.pcs || {}),\n              [playerId]: newPC,\n            },\n          },\n        }));\n      }\n\n      // Save to database immediately for location changes to prevent inconsistency\n      try {\n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId,\n          playerId,\n          pc: newPC,\n          lastUpdated: now,\n        });\n        console.log(` Added PC ${playerId} to grid ${gridId} and database`);\n      } catch (error) {\n        console.error(` Failed to save PC ${playerId} to database:`, error);\n        // Remove from local state if database save fails\n        delete this.playersInGrid[gridId].pcs[playerId];\n        if (this.setPlayersInGridReact) {\n          this.setPlayersInGridReact(prev => {\n            const updatedGrid = { ...(prev[gridId]?.pcs || {}) };\n            delete updatedGrid[playerId];\n            return {\n              ...prev,\n              [gridId]: {\n                ...(prev[gridId] || {}),\n                pcs: updatedGrid,\n              },\n            };\n          });\n        }\n        throw error; // Re-throw to let changePlayerLocation handle the error\n      }\n    }\n\n\n    // Update an existing PC in the playersInGrid for a given gridId and playerId.\n    async updatePC(gridId, playerId, newProperties) {\n      const gridPCs = this.playersInGrid[gridId]?.pcs;\n      if (!gridPCs || !gridPCs[playerId]) {\n        console.error(`Cannot update PC ${playerId}. No NPCsInGrid or PC found for gridId: ${gridId}`);\n        return;\n      }\n    \n      const currentData = gridPCs[playerId];\n      \n      const keysToCompare = Object.keys(newProperties).filter(key => key !== 'lastUpdated');\n      const isSame = keysToCompare.every(key => {\n        const a = currentData[key];\n        const b = newProperties[key];\n        return JSON.stringify(a) === JSON.stringify(b);\n      });\n\n      if (isSame) {\n        return; // Skip update if no changes\n      }\n    \n      const oldPosition = gridPCs[playerId]?.position;\n      const now = Date.now();\n      const updatedPC = {\n        ...gridPCs[playerId],\n        ...newProperties,\n        lastUpdated: now,\n      };\n      const newPosition = updatedPC.position; //  and derive newPosition from updatedPC\n\n      this.playersInGrid[gridId].pcs[playerId] = updatedPC;\n    \n      // Emit to other clients\n      if (socket && socket.emit) {\n        const payload = {\n          [gridId]: {\n            pcs: { [playerId]: updatedPC },\n            playersInGridLastUpdated: now,\n          },\n          emitterId: socket.id,\n        };\n    \n        socket.emit('update-NPCsInGrid-PCs', payload);\n      }\n    \n      if (\n        this.tileSize &&\n        oldPosition &&\n        newPosition &&\n        (oldPosition.x !== newPosition.x || oldPosition.y !== newPosition.y)\n      ) {\n        animateRemotePC(playerId, oldPosition, newPosition, this.tileSize);\n      }\n\n      //  Also update React state if setter is registered\n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: {\n              ...(prev[gridId]?.pcs || {}),\n              [playerId]: updatedPC,\n            },\n          },\n        }));\n      }\n\n        // Add to pending updates for batch saving instead of immediate save\n        const updateKey = `${gridId}-${playerId}`;\n        this.pendingUpdates[updateKey] = {\n          gridId,\n          playerId,\n          pc: updatedPC,\n          lastUpdated: now\n        };\n        \n        // Start batch saving if not already running\n        if (!this.batchInterval) {\n          this.startBatchSaving();\n        }\n    }\n\n\n  // Remove a PC from the playersInGrid for a given gridId and playerId.\n  async removePC(gridId, playerId) {\n    if (!this.playersInGrid[gridId]?.pcs?.[playerId]) {\n      console.warn(` Cannot remove PC ${playerId}; not found in grid ${gridId}.`);\n      return;\n    }\n\n    delete this.playersInGrid[gridId].pcs[playerId];\n\n    // Also update React state if setter is registered\n    if (this.setPlayersInGridReact) {\n      this.setPlayersInGridReact(prev => {\n        const updatedGrid = { ...(prev[gridId]?.pcs || {}) };\n        delete updatedGrid[playerId];\n\n        return {\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: updatedGrid,\n          },\n        };\n      });\n    }\n\n    // Remove from database immediately for location changes to prevent ghost PCs\n    try {\n      await axios.post(`${API_BASE}/api/remove-single-pc`, {\n        gridId,\n        playerId,\n      });\n      console.log(` Removed PC ${playerId} from grid ${gridId} and database`);\n    } catch (error) {\n      console.error(` Failed to remove PC ${playerId} from database:`, error);\n      // Re-add the player back to local state if database removal fails\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = { pcs: {}, playersInGridLastUpdated: Date.now() };\n      }\n      // Note: We would need the original player data to restore, which we don't have here\n      // This is an edge case that should be handled by proper error handling in changePlayerLocation\n    }\n  }\n\n  }\n    \n\n    const playersInGridManager = new GridStatePCManager();\n    export default playersInGridManager;\n    export const { initializePlayersInGrid } = playersInGridManager;","import stringsEN from '../UI/Strings/stringsEN.json';\n\n// Create a reverse lookup map: value -> key\nconst createReverseLookupMap = () => {\n  const reverseMap = {};\n  Object.entries(stringsEN).forEach(([key, value]) => {\n    reverseMap[value] = key;\n  });\n  return reverseMap;\n};\n\n// Cached reverse lookup map\nlet reverseLookupMap = null;\n\n/**\n * Looks up a string value in stringsEN.json and returns its key (ID)\n * This allows server-side strings to be mapped to localized client strings\n * @param {string} value - The string value to look up\n * @returns {string|null} - The string ID/key if found, null otherwise\n */\nexport const getStringIdByValue = (value) => {\n  if (!reverseLookupMap) {\n    reverseLookupMap = createReverseLookupMap();\n  }\n  \n  return reverseLookupMap[value] || null;\n};\n\n/**\n * Helper function for use in React components\n * Returns the localized string from the provided strings object\n * @param {string} value - The string value to look up\n * @param {object} strings - The localized strings object from useStrings()\n * @returns {string} - The localized string if found, original value otherwise\n */\nexport const getLocalizedString = (value, strings) => {\n  // Handle undefined strings object\n  if (!strings) {\n    console.warn('getLocalizedString: strings object is undefined, returning original value');\n    return value;\n  }\n  \n  const stringId = getStringIdByValue(value);\n  if (stringId && strings[stringId]) {\n    return strings[stringId];\n  }\n  // Fallback to original value if not found\n  return value;\n};","const API_BASE = process.env.REACT_APP_SERVER_URL || 'http://localhost:3001';\n\nexport default API_BASE;","import { renderPositions } from '../PlayerMovement';\n\nexport function animateRemotePC(playerId, from, to, TILE_SIZE, stepCount = 10) {\n  let step = 0;\n\n  console.log('animateRemotePC', playerId, from, to, 'steps:', stepCount);\n  \n  const currentX = from.x * TILE_SIZE;\n  const currentY = from.y * TILE_SIZE;\n  const targetX = to.x * TILE_SIZE;\n  const targetY = to.y * TILE_SIZE;\n\n  function animate() {\n    if (step >= stepCount) {\n      delete renderPositions[playerId];\n      return;\n    }\n\n    const interpolatedX = currentX + ((targetX - currentX) / stepCount) * step;\n    const interpolatedY = currentY + ((targetY - currentY) / stepCount) * step;\n\n    renderPositions[playerId] = {\n      x: interpolatedX / TILE_SIZE,\n      y: interpolatedY / TILE_SIZE,\n    };\n\n    step++;\n    requestAnimationFrame(animate);\n  }\n\n  animate();\n}","import React, { useEffect } from 'react';\nimport { usePanelContext } from './PanelContext'; // Import the context\nimport './Panel.css';\nimport { useStrings } from './StringsContext';\n\nconst Panel = ({ onClose, children, descriptionKey, panelName, titleKey, title }) => {\n  const strings = useStrings();\n  const { activePanel, openPanel, closePanel } = usePanelContext();\n\n  useEffect(() => {\n    if (activePanel === panelName) {\n      openPanel(panelName); // Set this panel as active\n    }\n  }, [activePanel, panelName, openPanel]);\n\n  if (activePanel !== panelName) {\n    return null; // Ensure only the active panel is displayed\n  }\n\n  return (\n    <div className=\"panel-container\">\n      {/* Fixed Header with Title and Close Button */}\n      <div className=\"panel-header\">\n        <h2 className=\"panel-title\">{title || strings[titleKey] || \"Panel\"}</h2>\n        <button\n          className=\"panel-close-btn\"\n          onClick={() => {\n            closePanel();\n            onClose();\n          }}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            width=\"24\"\n            height=\"24\"\n          >\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n          </svg>\n        </button>\n      </div>\n\n      {/* Scrollable Content Area */}\n      <div className=\"panel-content\">{children}</div>\n\n      {/* Panel Description */}\n      {descriptionKey && (\n        <div className=\"panel-description\">\n          <p>{strings[descriptionKey]}</p>\n        </div>\n      )}\n      \n      {/* Buffer space for Ko-fi widget */}\n      <div className=\"panel-buffer-space\"></div>\n    </div>\n  );\n};\n\nexport default Panel;","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * LocationChangeManager - Prevents concurrent location changes and HP data loss\n * \n * This manager ensures that only one location change can happen at a time,\n * preventing race conditions that cause HP to reset to 25 during rapid grid transitions.\n */\nclass LocationChangeManager {\n  constructor() {\n    this.isLocationChangeInProgress = false;\n    this.pendingLocationChange = null;\n    this.lastCompletedChange = null;\n  }\n\n  /**\n   * Check if a location change is currently in progress\n   */\n  isInProgress() {\n    return this.isLocationChangeInProgress;\n  }\n\n  /**\n   * Request permission to start a location change\n   * @param {Object} changeRequest - The location change request details\n   * @returns {Promise<boolean>} - True if permission granted, false if blocked\n   */\n  async requestLocationChange(changeRequest) {\n    // If already in progress, queue this request\n    if (this.isLocationChangeInProgress) {\n      console.log(' Location change blocked - operation already in progress');\n      \n      // Store the most recent request (overwrite any pending)\n      this.pendingLocationChange = {\n        ...changeRequest,\n        timestamp: Date.now()\n      };\n      \n      return false;\n    }\n\n    // Grant permission and mark as in progress\n    this.isLocationChangeInProgress = true;\n    this.pendingLocationChange = null;\n    \n    console.log(' Location change permission granted');\n    return true;\n  }\n\n  /**\n   * Mark location change as completed successfully\n   * @param {Object} completedChange - Details of the completed change\n   */\n  completeLocationChange(completedChange) {\n    this.isLocationChangeInProgress = false;\n    this.lastCompletedChange = {\n      ...completedChange,\n      completedAt: Date.now()\n    };\n    \n    console.log(' Location change completed successfully');\n    \n    // Process any pending change after a brief delay to ensure state is stable\n    if (this.pendingLocationChange) {\n      const pending = this.pendingLocationChange;\n      this.pendingLocationChange = null;\n      \n      console.log(' Processing queued location change after completion');\n      \n      // Use setTimeout to ensure current call stack completes before processing\n      setTimeout(() => {\n        if (pending.retryCallback) {\n          pending.retryCallback();\n        }\n      }, 100);\n    }\n  }\n\n  /**\n   * Mark location change as failed and allow retry\n   * @param {Error} error - The error that caused the failure\n   */\n  failLocationChange(error) {\n    console.error(' Location change failed:', error);\n    this.isLocationChangeInProgress = false;\n    \n    // Don't process pending changes on failure - let user retry manually\n    if (this.pendingLocationChange) {\n      console.log(' Discarding pending location change due to failure');\n      this.pendingLocationChange = null;\n    }\n  }\n\n  /**\n   * Get the status of location changes\n   */\n  getStatus() {\n    return {\n      inProgress: this.isLocationChangeInProgress,\n      hasPending: !!this.pendingLocationChange,\n      lastCompleted: this.lastCompletedChange,\n      pendingChange: this.pendingLocationChange\n    };\n  }\n\n  /**\n   * Clear any pending location changes (useful for cleanup)\n   */\n  clearPending() {\n    this.pendingLocationChange = null;\n    console.log(' Cleared pending location changes');\n  }\n\n  /**\n   * Force reset the manager state (emergency use only)\n   */\n  reset() {\n    this.isLocationChangeInProgress = false;\n    this.pendingLocationChange = null;\n    this.lastCompletedChange = null;\n    console.warn(' LocationChangeManager force reset');\n  }\n}\n\n// Create singleton instance\nconst locationChangeManager = new LocationChangeManager();\n\n// Development tools - make available in console for debugging\nif (typeof window !== 'undefined') {\n  window.locationChangeManager = locationChangeManager;\n  window.debugLocationChanges = () => {\n    console.log('Location Change Manager Status:', locationChangeManager.getStatus());\n    return locationChangeManager.getStatus();\n  };\n  window.resetLocationChangeManager = () => {\n    locationChangeManager.reset();\n    console.log('Location Change Manager reset');\n  };\n}\n\nexport default locationChangeManager;","import API_BASE from '../config';\nimport axios from 'axios';\nimport { initializeGrid } from '../AppInit';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport socket from '../socketManager'; //  At top of file if not already present\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { mergeResources, mergeTiles } from './ResourceHelpers';\nimport { centerCameraOnPlayer } from '../PlayerMovement';\nimport { closePanel } from '../UI/PanelContext';\nimport { fetchHomesteadOwner } from './worldHelpers';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\nimport { showNotification } from '../UI/Notifications/Notifications';\nimport locationChangeManager from './LocationChangeManager';\n\nexport const updateGridResource = async (\n  gridId,\n  resource,\n  broadcast = true\n) => {\n  //console.log('UPDATE GRID RESOURCE; resource = ', resource);\n\n  try {\n    const { x, y, growEnd, craftEnd, craftedItem, type } = resource;\n    \n    //  1. Flat payload  no \"newResource\" key\n    const payload = {\n      resource: {\n        type,\n        x,\n        y,\n        ...(growEnd !== undefined && { growEnd }),\n        ...(craftEnd !== undefined && { craftEnd }),\n        ...(craftedItem !== undefined && { craftedItem }),\n      },\n      broadcast, // optional - depending on your server usage\n    };\n    //console.log('UPDATE GRID RESOURCE; payload = ', payload);\n\n    //  2. Update the database\n    const response = await axios.patch(`${API_BASE}/api/update-grid/${gridId}`, payload);\n    if (!response.data.success) throw new Error('Failed DB update');\n\n    //  3. Emit to other clients\n    if (broadcast && socket && socket.emit) {\n      socket.emit('update-resource', {\n        gridId,\n        updatedResources: [resource?.type === null ? { x, y, type: null } : resource],\n      });\n    }\n\n    return { success: true };\n  } catch (error) {\n    console.error(' Error in updateGridResource:', error);\n    return { success: false };\n  }\n};\n\n\nexport const convertTileType = async (gridId, x, y, newType, setTileTypes = null) => {\n  try {\n    //console.log(`Converting tile at (${x}, ${y}) to type: ${newType}`);\n\n    // Update the tile in the database\n    const response = await axios.patch(`${API_BASE}/api/update-tile/${gridId}`, {\n      x,\n      y,\n      newType,\n    });\n\n    if (response.data.success) {\n      //console.log(` Tile at (${x}, ${y}) successfully updated to ${newType} in the database.`);\n\n      //  Immediately update local state optimistically\n      if (setTileTypes) {\n        setTileTypes((prevTiles) => {\n          const updated = mergeTiles(prevTiles, [{ x, y, type: newType }]);\n          console.log(\" Optimistically updated tileTypes (emitter):\", updated);\n          return updated;\n        });\n      }\n\n      //console.log('newType before emitter:', newType);\n      // Emit the change to all connected clients via the socket\n      socket.emit('update-tile', {\n        gridId,\n        updatedTiles: [{ x, y, type: newType }],\n      });\n    } else {\n      console.error(` Failed to update tile at (${x}, ${y}):`, response.data.message);\n    }\n  } catch (error) {\n    console.error(` Error converting tile at (${x}, ${y}):`, error);\n  }\n};\n\nexport const changePlayerLocation = async (\n  currentPlayer,\n  fromLocation,\n  toLocation,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  TILE_SIZE,\n  closeAllPanels, //  Add this prop\n  updateStatus,\n  bulkOperationContext, //  Add bulk operation context\n  masterResources = null, //  Add masterResources for combat stat calculations\n  strings = null, //  Add strings for notifications\n  masterTrophies = null //  Add masterTrophies for trophy visibility checks\n) => {\n\n  // console.log(\" changePlayerLocation invoked. closeAllPanels =\", !!closeAllPanels);\n  // console.log(\"bulkOperationContext in changePlayerLocation:\", bulkOperationContext);\n  // console.log(\"isAnyBulkOperationActive:\", bulkOperationContext?.isAnyBulkOperationActive?.());\n  \n  // Check if any bulk operation is active\n  if (bulkOperationContext?.isAnyBulkOperationActive?.()) {\n    // const activeOps = bulkOperationContext.getActiveBulkOperations();\n    // console.log(' Travel blocked: Bulk operation in progress', activeOps);\n    if (updateStatus) {\n      updateStatus(470); // \"Bulk operation in progress\"\n    }\n    return false;\n  }\n\n  //  NEW: Check if location change is already in progress\n  // Use consistent player ID format\n  const playerId = currentPlayer._id?.toString() || currentPlayer.playerId;\n  \n  const changeRequest = {\n    from: fromLocation,\n    to: toLocation,\n    playerId: playerId,\n    timestamp: Date.now()\n  };\n\n  const canProceed = await locationChangeManager.requestLocationChange(changeRequest);\n  if (!canProceed) {\n    console.log(' Location change blocked - another change in progress');\n    if (updateStatus) {\n      updateStatus('Location change in progress, please wait...');\n    }\n    return false;\n  }\n  \n  // DEBUG: Log input parameters for changePlayerLocation\n  // console.log('changePlayerLocation called with:', {\n  //   currentPlayer,\n  //   fromLocation,\n  //   toLocation,\n  //   TILE_SIZE,\n  //   // ...other setters omitted for brevity...\n  // });\n\n\n  //console.log(' changePlayerLocation called');\n  //console.log('FROM:', { grid: fromLocation.g, type: fromLocation.gtype });\n  //console.log('TO:', { grid: toLocation.g, type: toLocation.gtype });\n  if (!fromLocation || !toLocation) {\n    console.error(' Invalid fromLocation or toLocation');\n    return;\n  }\n\n  try {\n\n    // STEP 1: Close any open panels before grid transition\n    if (closeAllPanels) {\n      closeAllPanels();\n      //console.log(\" Closed all panels before location change.\");\n    }\n\n    //  STEP 2: Update FROM grid's state (remove player using batch system)\n    //console.log(`1 Removing player from grid ${fromLocation.g}`);\n\n    //console.log('loading PCS gridstates from memory...');\n    const inMemoryFromPlayerState = playersInGridManager.getPlayersInGrid(fromLocation.g)?.[playerId];\n    //console.log('loading NPCS and PCS gridstates from db...');\n    const fromGridResponse = await axios.get(`${API_BASE}/api/load-grid-state/${fromLocation.g}`);\n    //console.log('fromGridResponse.data: ', fromGridResponse.data);\n    const fromPCs = fromGridResponse.data?.playersInGrid?.pcs || {};\n    //console.log('Extracted fromPCs from what we just loaded; fromPCs = ', fromPCs);\n    const fromPlayerState = inMemoryFromPlayerState || fromPCs[playerId] || {};\n    //console.log('fromPlayerState (prioritize what was in memory) = ', fromPlayerState);\n    \n    // Use robust removal system with immediate DB persistence to prevent ghost PCs\n    await playersInGridManager.removePC(fromLocation.g, playerId);\n\n    //  STEP 3: Flush pending position updates before leaving grid\n    if (fromLocation && fromLocation.g) {\n      // Flush NPC position updates\n      await NPCsInGridManager.flushGridPositionUpdates(fromLocation.g);\n      console.log(` Flushed pending NPC position updates for grid ${fromLocation.g}`);\n      \n      // Flush PC position updates\n      await playersInGridManager.flushGridPositionUpdates(fromLocation.g);\n      console.log(` Flushed pending PC position updates for grid ${fromLocation.g}`);\n    }\n\n    //  STEP 4: Emit AFTER saving to DB\n    socket.emit('player-left-grid', {\n      gridId: fromLocation.g,\n      playerId: playerId,\n      username: currentPlayer.username,\n    });\n    //console.log(` Emitted [player-left-grid] for ${fromLocation.g}`);\n  \n    socket.emit('leave-grid', fromLocation.g);\n    //console.log(` Emitted [leave-grid] for grid: ${fromLocation.g}`);\n      \n    //  STEP 5: Update TO grid's state (add player)\n\n    //console.log(`2 Adding player to grid ${toLocation.g}`);\n    //console.log('loading NPCsInGrid from db...');\n    const toGridResponse = await axios.get(`${API_BASE}/api/load-grid-state/${toLocation.g}`);\n    //console.log('toGridResponse.data: ', toGridResponse.data);\n    const toPCs = toGridResponse.data?.playersInGrid?.pcs || {};\n    //console.log('Extracted toPCs from what we just loaded; toPCs = ', toPCs);\n\n    const now = Date.now();\n\n    //  STEP 6: Add the player to the `pcs` object`\n    //console.log('IN CHANGE PLAYER LOCATION:  Adding player to the toPCs object')\n    // Use combat stats from the fromGrid state if available, fallback to currentPlayer\n    //console.log('fromPlayerState = ', fromPlayerState);\n    //console.log('currentPlayer = ', currentPlayer);\n\n    // REVERT: The issue is in how data is stored/loaded, not in changePlayerLocation\n    console.log(' [HP DEBUG] changePlayerLocation - HP calculation sources:');\n    console.log('  fromPlayerState.hp:', fromPlayerState.hp);\n    console.log('  currentPlayer.hp:', currentPlayer.hp);\n    console.log('  fromPlayerState.maxhp:', fromPlayerState.maxhp);\n    console.log('  currentPlayer.maxhp:', currentPlayer.maxhp);\n    \n    const finalHp = fromPlayerState.hp ?? currentPlayer.hp ?? 25;\n    const finalMaxHp = fromPlayerState.maxhp ?? currentPlayer.maxhp ?? 25;\n    \n    console.log(' [HP DEBUG] changePlayerLocation - Final HP values:');\n    console.log('  Final HP:', finalHp, '(fallback triggered:', finalHp === 25, ')');\n    console.log('  Final MaxHP:', finalMaxHp, '(fallback triggered:', finalMaxHp === 25, ')');\n    \n    const playerData = {\n      playerId: playerId,\n      type: 'pc',\n      username: currentPlayer.username,\n      position: { x: toLocation.x, y: toLocation.y },\n      icon: currentPlayer.icon || '',\n      hp: finalHp,\n      maxhp: finalMaxHp,\n      armorclass: fromPlayerState.armorclass ?? currentPlayer.armorclass ?? 10,\n      attackbonus: fromPlayerState.attackbonus ?? currentPlayer.attackbonus ?? 0,\n      damage: fromPlayerState.damage ?? currentPlayer.damage ?? 1,\n      speed: fromPlayerState.speed ?? currentPlayer.speed ?? 1,\n      attackrange: fromPlayerState.attackrange ?? currentPlayer.attackrange ?? 1,\n      iscamping: fromPlayerState.iscamping ?? currentPlayer.iscamping ?? false,\n      isinboat: fromPlayerState.isinboat ?? currentPlayer.isinboat ?? false,\n      lastUpdated: now,\n    };\n\n    //console.log(' Constructed player data for adding:', playerData);\n\n    //  STEP 7: Join the socket room FIRST before any grid operations\n    socket.emit('join-grid', { gridId: toLocation.g, playerId: playerId });\n    //console.log(` Emitted join-grid for grid: ${toLocation.g}`);\n    \n    //  STEP 8: Add player to new grid with immediate DB persistence\n    //console.log(' Adding player to new grid with immediate DB persistence...');\n    await playersInGridManager.addPC(toLocation.g, playerId, playerData);\n\n    socket.emit('player-joined-grid', {\n      gridId: toLocation.g,\n      playerId: playerId,\n      username: currentPlayer.username,\n      playerData,\n    });\n    //console.log(` Emitted player-joined-grid for ${toLocation.g}`);\n  \n\n    //  STEP 9: Update player location in player record on the DB\n    //console.log('3 Updating player location...');\n    const locationResponse = await axios.post(`${API_BASE}/api/update-player-location`, {\n      playerId: playerId,\n      location: toLocation,\n    });\n\n    if (!locationResponse.data.success) {\n      throw new Error(locationResponse.data.error);\n    }\n    //console.log(' Player location updated in DB');\n\n    //  CHECK: First time visiting valley - award trophy and show notification\n    if (toLocation.gtype && toLocation.gtype.startsWith('valley') && strings) {\n      // Check if player has \"Explore the Valley\" trophy\n      const hasValleyTrophy = currentPlayer.trophies?.some(trophy => trophy.name === \"Explore the Valley\");\n      \n      if (!hasValleyTrophy) {\n        console.log(' First time visiting valley - awarding \"Explore the Valley\" trophy');\n        \n        try {\n          // Award the trophy\n          const trophyResult = await earnTrophy(playerId, \"Explore the Valley\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          \n          if (trophyResult.success) {\n            // Show notification\n            showNotification('Message', {\n              title: strings[7002],\n              message: strings[7021]\n            });\n            \n            console.log(' Valley trophy awarded and notification shown');\n          } else {\n            console.warn(' Failed to award valley trophy:', trophyResult.error);\n          }\n        } catch (error) {\n          console.error(' Error awarding valley trophy:', error);\n        }\n      }\n    }\n\n    //  STEP 10: Update local state\n    //console.log('4 Updating local Player Document...');\n    const updatedPlayer = {\n      ...currentPlayer,\n      location: toLocation,\n    };\n\n    setCurrentPlayer(updatedPlayer);\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n\n    // 5. Change grid context & fetch new grid data\n    //console.log('5 Calling setGridId...');\n    setGridId(toLocation.g);\n    // WHAT does this ^^ do?\n\n    //  STEP 10.5: Final cleanup verification - ensure dead player is removed from old grid\n    if (currentPlayer.hp <= 0) {\n      console.log(' Player was dead - verifying cleanup from old grid');\n      try {\n        // Double-check removal with another API call to ensure cleanup\n        await axios.post(`${API_BASE}/api/remove-single-pc`, {\n          gridId: fromLocation.g,\n          playerId: playerId,\n        });\n        console.log(' Dead player cleanup verified');\n      } catch (cleanupError) {\n        console.warn(' Cleanup verification failed, but continuing:', cleanupError);\n      }\n    }\n\n    //  STEP 11: Initialize the new grid, PCs and NPCs\n    //console.log('!! Running initializeGridState and setGridState');\n    await Promise.all([\n      initializeGrid(TILE_SIZE, toLocation.g, setGrid, setResources, setTileTypes, updateStatus, currentPlayer),\n      (async () => {\n        try {\n          await NPCsInGridManager.initializeGridState(toLocation.g);\n          await playersInGridManager.initializePlayersInGrid(toLocation.g);  \n          const freshGridState = NPCsInGridManager.getNPCsInGrid(toLocation.g);\n          const freshPCState = playersInGridManager.getPlayersInGrid(toLocation.g);\n\n          NPCsInGridManager.setGridStateReact({ [toLocation.g]: {\n            npcs: freshGridState,\n            NPCsInGridLastUpdated: Date.now(),\n          }});\n          playersInGridManager.setPlayersInGridReact({ [toLocation.g]: {\n            pcs: freshPCState,\n            playersInGridLastUpdated: Date.now(),\n          }});     \n\n        } catch (err) {\n          console.error(' Error initializing playersInGrid:', err);\n        }\n      })(),\n    ]);\n    //console.log(' New grid fully initialized');\n\n    //  STEP 12: Set username for the socket\n    socket.emit('set-username', { username: currentPlayer.username });\n    \n    // Request current NPCController status to clear any stale controller data\n    //console.log(` Requesting current NPCController for grid: ${toLocation.g}`);\n    socket.emit('request-npc-controller', { gridId: toLocation.g });\n    \n    //  STEP 13: Check if we need to find a signpost location\n    let finalX = toLocation.x;\n    let finalY = toLocation.y;\n    \n    if (toLocation.findSignpost) {\n      console.log(` Looking for ${toLocation.findSignpost} on the destination grid...`);\n      \n      // Get the resources that were just loaded\n      const currentResources = GlobalGridStateTilesAndResources.getResources();\n      //console.log(` Total resources loaded: ${currentResources.length}`);\n      //console.log(` Resources types: ${currentResources.map(r => r.type).join(', ')}`);\n      \n      const signpost = currentResources.find(res => res.type === toLocation.findSignpost);\n      \n      if (signpost) {\n        //console.log(` Found ${toLocation.findSignpost} at (${signpost.x}, ${signpost.y})`);\n        finalX = signpost.x;\n        finalY = signpost.y;\n        \n        // Update the player's position to the signpost location\n        const updatedPlayerData = {\n          ...playerData,\n          position: { x: finalX, y: finalY }\n        };\n        \n        // Update local state\n        playersInGridManager.updatePC(toLocation.g, playerId, updatedPlayerData);\n        \n        // Update database\n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId: toLocation.g,\n          playerId: playerId,\n          pc: updatedPlayerData,\n          lastUpdated: Date.now(),\n        });\n        \n        // Emit updated position\n        socket.emit('player-moved', {\n          gridId: toLocation.g,\n          playerId: playerId,\n          position: { x: finalX, y: finalY },\n          username: currentPlayer.username,\n        });\n      } else {\n        console.log(` ${toLocation.findSignpost} not found on destination grid, using default position (0, 0)`);\n      }\n    }\n    \n    //  STEP 14: Center view on player\n\n    centerCameraOnPlayer({ x: finalX, y: finalY }, TILE_SIZE);\n\n    //  STEP 15: Update status bar with new grid info\n    if (updateStatus && toLocation.gtype) {\n      await updateGridStatus(toLocation.gtype, null, updateStatus, currentPlayer, toLocation.g);\n    }\n\n    console.log(' Location change complete');\n    \n    //  NEW: Mark location change as completed\n    locationChangeManager.completeLocationChange({\n      from: fromLocation,\n      to: toLocation,\n      playerId: playerId,\n      success: true\n    });\n    \n    return true;\n  } catch (error) {\n    console.error(' Location change error:', error);\n    \n    //  NEW: Mark location change as failed\n    locationChangeManager.failLocationChange(error);\n    \n    throw error;\n  } \n};\n\n\n\n\nexport async function fetchGridData(gridId, updateStatus, DBPlayerData) {\n  try {\n    //console.log(`Fetching grid data for gridId: ${gridId}`);\n\n    // 1) Fetch the grid data (which now has separate playersInGrid and NPCsInGrid)\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data || {};\n    const { gridType, _id: fetchedGridId, ownerId, playersInGrid, NPCsInGrid } = gridData;\n\n    console.log('Fetched grid data:', gridData);\n\n    // 2) Combine playersInGrid and NPCsInGrid into a single NPCsInGrid\n    const combinedGridState = {\n      pcs: playersInGrid?.pcs || {},\n      npcs: NPCsInGrid?.npcs || {},\n    };\n\n    return { ...gridData, NPCsInGrid: combinedGridState }; // Return the full grid data with combined NPCsInGrid\n  } catch (error) {\n    console.error('Error fetching grid data:', error);\n    if (updateStatus) updateStatus('Failed to load grid data');\n    return {};\n  }\n}\n\n\n\n\n// Separate function for status updates\nexport async function updateGridStatus(gridType, ownerUsername, updateStatus, currentPlayer = null, gridId = null) {\n  if (!updateStatus) return;\n\n  console.log(\" UPDATING GRID STATUS message\");\n  switch (gridType) {\n    case 'homestead':\n      // If we have currentPlayer and gridId, check if it's their homestead\n      if (currentPlayer && gridId) {\n        const { username } = await fetchHomesteadOwner(gridId);\n        if (username === currentPlayer.username) {\n          updateStatus(112); // \"You're home.\"\n          return;\n        }\n        ownerUsername = username;\n      }\n      updateStatus(`Welcome to ${ownerUsername || 'Unknown'}'s homestead.`);\n      break;\n    case 'town':\n      updateStatus(14); // Town view\n      break;\n    case 'valley0':\n    case 'valley1':\n    case 'valley2':\n    case 'valley3':\n      updateStatus(16); // Valley view\n      break;\n    case 'settlement':\n      updateStatus(12); // Settlement view\n      break;\n    case 'frontier':\n      updateStatus(13); // Frontier view\n      break;\n    default:\n      //updateStatus(0); // Default status\n      break;\n  }\n}\n","import API_BASE from '../config';\nimport axios from 'axios';\nimport { loadMasterResources } from './TuningManager';\n\n/**\n * Fetches the Signpost Town position from a homestead grid\n * @param {string} gridId - The homestead grid ID\n * @returns {Promise<{x: number, y: number}>} The x,y coordinates of Signpost Town, or default {x: 1, y: 1}\n */\nexport const fetchHomesteadSignpostPosition = async (gridId) => {\n  try {\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data;\n    \n    if (gridData.resources && Array.isArray(gridData.resources)) {\n      const signpostTown = gridData.resources.find(res => res.type === \"Signpost Town\");\n      if (signpostTown) {\n        console.log(` Found Signpost Town at (${signpostTown.x}, ${signpostTown.y}) on homestead grid ${gridId}`);\n        return { x: signpostTown.x, y: signpostTown.y };\n      } else {\n        console.log(` Signpost Town not found on homestead grid ${gridId}, using default (1, 1)`);\n      }\n    }\n  } catch (error) {\n    console.error(` Error fetching homestead grid data for grid ${gridId}:`, error);\n  }\n  \n  // Return default position if not found or error\n  return { x: 1, y: 1 };\n};\n\n/**\n * Fetches the Train position from a town grid (for arrival via signpost)\n * @param {string} gridId - The town grid ID\n * @returns {Promise<{x: number, y: number}>} The x,y coordinates of Train, or default {x: 0, y: 0}\n */\nexport const fetchTownSignpostPosition = async (gridId) => {\n  try {\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data;\n    \n    if (gridData.resources && Array.isArray(gridData.resources)) {\n      const train = gridData.resources.find(res => res.type === \"Train\");\n      if (train) {\n        console.log(` Found Train at (${train.x}, ${train.y}) on town grid ${gridId}`);\n        return { x: train.x, y: train.y };\n      } else {\n        console.log(` Train not found on town grid ${gridId}, using default (0, 0)`);\n      }\n    }\n  } catch (error) {\n    console.error(` Error fetching town grid data for grid ${gridId}:`, error);\n  }\n  \n  // Return default position if not found or error\n  return { x: 0, y: 0 };\n};\n \nexport const fetchHomesteadOwner = async (gridId) => {\n  try {\n    console.log(`Fetching homestead owner for gridId: ${gridId}`);\n\n    //  Step 1: Fetch grid details (to get `ownerId`)\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const { ownerId = null, gridType = null } = gridResponse.data;\n\n    console.log(\"ownerId =\",ownerId);\n\n    if (!ownerId) {\n      console.log(\" This homestead is unoccupied.\");\n      return { username: null, gridType };\n    }\n\n    //  Step 2: Fetch player document using `ownerId`\n    const playerResponse = await axios.get(`${API_BASE}/api/player/${ownerId._id}`);\n    const { username = null } = playerResponse.data;\n \n    if (username) {\n      console.log(` Homestead belongs to: ${username}`);\n      return { username, gridType };\n    } else {\n      console.warn(\" Owner's player document not found!\");\n      return { username: null, gridType };\n    }\n\n  } catch (error) {\n    console.error(' Error fetching homestead owner:', error);\n    return { username: null, gridType: null }; // Return defaults in case of an error\n  }\n};\n\n \nexport const addResourceToGrid = async (resources, newResource) => {\n  try {\n    const masterResources = await loadMasterResources();\n    console.log('masterResources:', masterResources);\n    console.log('current resources:', resources);\n    console.log('newResource:', newResource);\n\n    if (!Array.isArray(masterResources)) {\n      console.error('Failed to load masterResources or incorrect format:', masterResources);\n      return resources;\n    }\n\n    // Extract `type` from `newResource` payload\n    const resourceType = newResource?.type || newResource?.newResource;\n    if (!resourceType) {\n      console.error('[addResourceToGrid] Invalid resource payload:', newResource);\n      return resources;\n    }\n\n    // Find the resource template to get the symbol\n    const resourceTemplate = masterResources.find((template) => template.type === resourceType);\n\n    // Enrich only with the basics\n    const enrichedResource = {\n      ...resourceTemplate, // Use the full template from masterResources\n      type: resourceType, // Keep type\n      x: newResource.x,   // Keep x\n      y: newResource.y,   // Keep y\n      growEnd: newResource.growEnd, // Keep growEnd\n    };\n\n    console.log('Enriched resource:', enrichedResource);\n\n    // Ensure no duplicates exist at the same x, y position\n    return [\n      ...resources.filter((res) => !(res.x === newResource.x && res.y === newResource.y)),\n      enrichedResource, // Add the enriched resource\n    ];\n  } catch (error) {\n    console.error('Error enriching resource:', error);\n    return resources; // Return unmodified resources on error\n  }\n};\n\n\n// Inline function to calculate Euclidean distance safely\nexport const calculateDistance = (pos1, pos2) => {\n  if (!pos1 || !pos2 || typeof pos1.x === 'undefined' || typeof pos1.y === 'undefined' || typeof pos2.x === 'undefined' || typeof pos2.y === 'undefined') {\n    console.warn(\"Skipping distance calculation due to invalid position:\", { pos1, pos2 });\n    return Infinity;\n  }\n  return Math.sqrt(Math.pow(pos1.x - pos2.x, 2) + Math.pow(pos1.y - pos2.y, 2));\n};\n\n\n// Calculates the derived range based on base range + bonus from skill metadata\nexport const getDerivedRange = (currentPlayer, masterResources) => {\n  if (!currentPlayer || !Array.isArray(masterResources)) return 1;\n\n  const baseRange = currentPlayer.range || 1;\n\n  const bonusRangeFromSkills = currentPlayer.skills?.reduce((sum, skill) => {\n    const master = masterResources.find(r => r.type === skill.type);\n    if (master?.output === 'range' && typeof master.qtycollected === 'number') {\n      return sum + master.qtycollected;\n    }\n    return sum;\n  }, 0) || 0;\n\n  const gridType = currentPlayer?.location?.gtype;\n  const totalRange = gridType === 'homestead'\n    ? baseRange + bonusRangeFromSkills + 5\n    : baseRange + bonusRangeFromSkills;\n\n  return totalRange;\n};","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","import NPC from './GameFeatures/NPCs/AllNPCsShared';\nimport FloatingTextManager from './UI/FloatingText';\nimport NPCsInGridManager from './GridState/GridStateNPCs';\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport { io } from 'socket.io-client';\nimport { animateRemotePC } from './Render/RenderAnimatePosition';\nimport { createCollectEffect } from './VFX/VFX';\n\nconst socket = io('https://vvgame-server.onrender.com', {\n  transports: ['websocket'],\n  autoConnect: false, // Don't connect until explicitly told to\n});\n\nexport function socketListenForPCJoinAndLeave(gridId, currentPlayer, isMasterResourcesReady, setPlayersInGrid, controllerUsername, setControllerUsername) {\n\n  console.log(\" useEffect for PC join & leave running. gridId:\", gridId, \"socket:\", !!socket);\n  console.log(\"   isMasterResourcesReady = \", isMasterResourcesReady);\n\n  if (!gridId || !currentPlayer || !isMasterResourcesReady) return;\n\nconst handlePlayerJoinedGrid = ({ gridId: joinedGridId, playerId, username, playerData, emitterId }) => {\n  if (emitterId === socket.id) {\n    console.log(' Ignoring player-joined event from self.');\n    return; // Ignore updates emitted by this client\n  }\n  \n  // Handle case where server sends undefined gridId\n  if (!joinedGridId) {\n    console.warn(` Received player-joined event with undefined gridId for ${username}. Assuming they joined current grid.`);\n    // If gridId is undefined, assume they joined the current grid\n    joinedGridId = gridId;\n  }\n  \n  // Only process if the player joined the current grid\n  if (joinedGridId !== gridId) {\n    console.log(` Player ${username} joined grid ${joinedGridId} (not current grid ${gridId})`);\n    return;\n  }\n  \n  console.log(` Player ${username} joined current grid ${gridId} with data:`, playerData);\n  setPlayersInGrid(prevState => {\n    const existing = prevState[joinedGridId]?.pcs?.[playerId];\n    const incomingTime = new Date(playerData?.lastUpdated).getTime() || 0;\n    const localTime = new Date(existing?.lastUpdated).getTime() || 0;\n\n    if (!existing || incomingTime > localTime) {\n      console.log(` Inserting or updating PC ${playerId} from player-joined-sync.`);\n\n      //  Update memory manager too\n      if (playersInGridManager.addPC) {\n        playersInGridManager.addPC(joinedGridId, playerId, playerData);\n      } else {\n        console.warn(' playersInGridManager.addPC is not defined.');\n      }\n\n      return {\n        ...prevState,\n        [joinedGridId]: {\n          ...prevState[joinedGridId],\n          pcs: {\n            ...(prevState[joinedGridId]?.pcs || {}),\n            [playerId]: playerData,\n          },\n        },\n      };\n    }\n\n    console.log(` Skipping player-joined-sync for ${playerId}; local is newer.`);\n    return prevState;\n  });\n};\n\n  const handlePlayerLeftGrid = ({ gridId: leftGridId, playerId, username, emitterId }) => {\n    if (emitterId === socket.id) {\n      console.log(' Ignoring player-left event from self.');\n      return; // Ignore updates emitted by this client\n    }\n    \n    // Handle case where server sends undefined gridId\n    if (!leftGridId) {\n      console.warn(` Received player-left event with undefined gridId for ${username}. Checking if they're in current grid.`);\n      // If gridId is undefined, check if the player is actually in our current grid and remove them\n      leftGridId = gridId; // Assume they left the current grid\n    }\n    \n    // Only process if the player left the current grid\n    if (leftGridId !== gridId) {\n      console.log(` Player ${username} left grid ${leftGridId} (not current grid ${gridId})`);\n      return;\n    }\n    \n    console.log(` Player ${username} left current grid ${gridId}`);\n    //  Remove from memory manager\n    if (playersInGridManager.removePC) {\n      playersInGridManager.removePC(leftGridId, playerId);\n    } else {\n      console.warn(' playersInGridManager.removePC is not defined.');\n    }\n\n    setPlayersInGrid(prevState => {\n      if (!prevState[leftGridId]?.pcs) {\n        console.warn(` No players found in grid ${leftGridId} when trying to remove ${username}`);\n        return prevState;\n      }\n      \n      if (!prevState[leftGridId].pcs[playerId]) {\n        console.warn(` Player ${username} (${playerId}) not found in grid ${leftGridId} when trying to remove`);\n        return prevState;\n      }\n      \n      console.log(` Removing player ${username} (${playerId}) from grid ${leftGridId}`);\n      const updatedGrid = { ...prevState[leftGridId]?.pcs };\n      delete updatedGrid[playerId];\n      \n      // Check if removed player was the controller\n      if (controllerUsername === username && setControllerUsername) {\n        console.log(` Removed player ${username} was the NPCController, clearing controller`);\n        setControllerUsername(null);\n      }\n      \n      return {\n        ...prevState,\n        [leftGridId]: {\n          ...prevState[leftGridId],\n          pcs: updatedGrid,\n        },\n      };\n    });\n  };\n\n  const handleCurrentGridPlayers = ({ gridId: receivedGridId, pcs }) => {\n    console.log(` Received current PCs for grid ${receivedGridId}:`, pcs);\n    \n    // HP Debug logging for server data\n    Object.entries(pcs || {}).forEach(([playerId, pcData]) => {\n      console.log(` [HP DEBUG] handleCurrentGridPlayers - Server data for ${playerId}:`);\n      console.log('  pcData.hp:', pcData.hp);\n      console.log('  pcData.maxhp:', pcData.maxhp);\n    });\n    \n    // Always process PC updates during transitions\n    // The state management will handle which grid is current\n    console.log(` Processing PC list for grid ${receivedGridId} (current grid: ${gridId})`);\n    \n    // If this update is for a different grid, it might be a transition in progress\n    const targetGridId = receivedGridId;\n    \n    // Replace the entire pcs object with server's authoritative list\n    setPlayersInGrid(prev => ({\n      ...prev,\n      [targetGridId]: {\n        ...prev[targetGridId],\n        pcs: pcs || {}, // Complete replacement, not a merge\n      },\n    }));\n    \n    // Also update the memory manager with the complete list\n    if (playersInGridManager.setAllPCs) {\n      playersInGridManager.setAllPCs(targetGridId, pcs || {});\n    }\n    \n    // Check if the current controller is in the player list\n    if (controllerUsername && setControllerUsername) {\n      const controllerStillInGrid = Object.values(pcs || {}).some(pc => pc.username === controllerUsername);\n      if (!controllerStillInGrid) {\n        console.log(` NPCController ${controllerUsername} is not in the current player list, clearing controller`);\n        setControllerUsername(null);\n      }\n    }\n  };\n\n  console.log(\" [NPCsInGrid join/leave] Subscribing to PC and NPC join/leave sync events for grid:\", gridId);\n  socket.on('player-joined-sync', handlePlayerJoinedGrid);\n  socket.on('player-left-sync', handlePlayerLeftGrid);\n  socket.on('current-grid-players', handleCurrentGridPlayers);\n\n  return () => {\n    socket.off('player-joined-sync', handlePlayerJoinedGrid);\n    socket.off('player-left-sync', handlePlayerLeftGrid);\n    socket.off('current-grid-players', handleCurrentGridPlayers);\n  };\n\n};\n\n//  SOCKET LISTENER: PCs: Real-time updates for GridState (PC sync)\nexport function socketListenForPCstateChanges(TILE_SIZE, gridId, currentPlayer, setPlayersInGrid, localPlayerMoveTimestampRef) {\n\n  console.log(\" useEffect for PC & NPC grid-state-sync running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!gridId) return;\n\n  // Updated handlePCSync to fully overwrite local PC with incoming PC if newer\n  const handlePCSync = (payload) => {\n    //console.log(\" Received sync-PCs payload:\", JSON.stringify(payload, null, 2));\n  \n    // Extract gridId and gridData first to check player ID\n    const gridEntries = Object.entries(payload).filter(([key]) => key !== 'emitterId');\n    if (gridEntries.length === 0) {\n      console.warn(\" No grid data found in sync-PCs payload:\", payload);\n      return;\n    }\n  \n    const [gridId, gridData] = gridEntries[0];\n    const { pcs, playersInGridLastUpdated } = gridData || {};\n    if (!pcs || typeof pcs !== 'object') {\n      console.warn(\" Invalid sync-PCs payload (missing pcs):\", payload);\n      return;\n    }\n  \n    const [playerId, incomingPC] = Object.entries(pcs)[0];\n    \n    // CRITICAL: Check if this is the local player FIRST, before any other checks\n    const currentPlayerId = currentPlayer?._id || currentPlayer?.playerId;\n    if (currentPlayer && playerId === String(currentPlayerId)) {\n      console.log(` Blocking socket sync for own player (${playerId}) - should never update local player from socket`);\n      return;\n    }\n    \n    // Then check emitterId to avoid processing our own emissions\n    const { emitterId } = payload;\n    const mySocketId = socket.id;\n    if (emitterId === mySocketId) {\n      console.log(` Skipping sync-PCs from self (emitterId = socket.id)`);\n      return;\n    }\n    const incomingTime = new Date(incomingPC?.lastUpdated).getTime();\n  \n    setPlayersInGrid((prevState) => {\n      const localPC = prevState[gridId]?.pcs?.[playerId];\n      const localTime = new Date(localPC?.lastUpdated).getTime() || 0;\n\n      // --- Begin changed fields logging and floating text (like NPCs) ---\n      const changedFields = Object.keys(incomingPC).filter(key => {\n        if (key === 'lastUpdated') return false;\n        return JSON.stringify(incomingPC[key]) !== JSON.stringify(localPC?.[key]);\n      });\n\n      if (changedFields.length > 0) {\n        console.log(` PC ${playerId} changed fields: ${changedFields.join(', ')}`);\n        // Show floating damage text if HP was reduced\n        if (changedFields.includes('hp') && localPC?.hp && incomingPC?.hp < localPC.hp) {\n          const damageTaken = localPC.hp - incomingPC.hp;\n          FloatingTextManager.addFloatingText(`- ${damageTaken}  HP`, incomingPC.position.x, incomingPC.position.y, TILE_SIZE);\n        }\n      }\n      // --- End changed fields logging and floating text ---\n\n      if (incomingTime <= localTime) {\n        console.log(` Skipping stale update for PC ${playerId}.`);\n        return prevState;\n      }\n\n      // Safety check: Make sure the grid and player still exist locally before updating\n      if (!prevState[gridId]?.pcs?.[playerId]) {\n        console.log(` Skipping update for PC ${playerId} - no longer in local grid ${gridId}`);\n        return prevState;\n      }\n\n      console.log(` Updating PC ${playerId} from socket event.`);\n      \n      // Update React state directly (primary source of truth)\n      const updatedState = {\n        ...prevState,\n        [gridId]: {\n          ...prevState[gridId],\n          pcs: {\n            ...prevState[gridId].pcs,\n            [playerId]: {\n              ...prevState[gridId].pcs[playerId],\n              ...incomingPC\n            }\n          }\n        }\n      };\n      \n      // Also update memory manager for consistency (but don't rely on it)\n      try {\n        playersInGridManager.updatePC(gridId, playerId, incomingPC);\n      } catch (error) {\n        console.warn(` Memory manager update failed for PC ${playerId}:`, error.message);\n      }\n\n      const prevPosition = localPC?.position;\n      const newPosition = incomingPC?.position;\n      if (\n        prevPosition &&\n        newPosition &&\n        (prevPosition.x !== newPosition.x || prevPosition.y !== newPosition.y)\n      ) {\n        animateRemotePC(playerId, prevPosition, newPosition, TILE_SIZE);\n      }\n\n      // Add playersInGridLastUpdated to our updatedState\n      updatedState[gridId].playersInGridLastUpdated = playersInGridLastUpdated || prevState[gridId]?.playersInGridLastUpdated;\n\n      // console.log(\" Pre-state before merge:\", JSON.stringify(prevState, null, 2));\n      // console.log(\" Incoming update for:\", playerId, \"with data:\", incomingPC);\n      // console.log(\" setPlayersInGrid payload:\", JSON.stringify(updatedState, null, 2));\n\n      return updatedState;\n    });\n  };\n\n  console.log(\" Subscribing to PC sync events for grid:\", gridId);\n  socket.on(\"sync-PCs\", handlePCSync);\n\n  return () => {\n    console.log(\" Unsubscribing from PC sync events for grid:\", gridId);\n    socket.off(\"sync-PCs\", handlePCSync);\n  };\n};\n\n\n//  SOCKET LISTENER: NPCs:  Real-time updates for GridStateNPC snc\nexport function socketListenForNPCStateChanges(TILE_SIZE, gridId, setGridState, npcController) {\n  //console.log(\" useEffect for NPC grid-state-sync running. gridId:\", gridId, \"socket:\", !!socket);\n  if (!gridId) return;\n\n  const handleNPCSync = (payload) => {\n    //console.log(' Received sync-NPCs payload:');\n  \n    const { emitterId } = payload;\n    const mySocketId = socket.id;\n    if (emitterId === mySocketId) {\n      console.log(` Skipping sync-NPCs from self (emitterId = socket.id)`);\n      return;\n    }\n  \n    // Extract gridId and gridData (we only expect one grid per payload)\n    const gridEntries = Object.entries(payload).filter(([key]) => key !== 'emitterId');\n    if (gridEntries.length === 0) {\n      console.warn(\" No grid data found in sync-NPCs payload:\", payload);\n      return;\n    }\n  \n    const [gridId, gridData] = gridEntries[0];\n    const { npcs, NPCsInGridLastUpdated } = gridData || {};\n    if (!npcs || typeof npcs !== 'object') {\n      console.warn(\" Invalid sync-NPCs payload (missing npcs):\", payload);\n      return;\n    }\n  \n    const isController = npcController.isControllingGrid(gridId);\n    console.log('IsNPCController:', isController);\n  \n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      const liveGrid = NPCsInGridManager.NPCsInGrid?.[gridId];\n  \n      Object.entries(npcs).forEach(([npcId, incomingNPC]) => {\n        if (!incomingNPC) {\n          //console.log(`   Received null NPC ${npcId}; removing from local state.`);\n          delete updatedNPCs[npcId];\n          if (liveGrid?.npcs) {\n            delete liveGrid.npcs[npcId];\n            //console.log(` Removed NPC ${npcId} from live NPCsInGrid`);\n          } else {\n            console.warn(` liveGrid.npcs missing for gridId ${gridId}`);\n          }\n          return;\n        }\n\n        const localNPC = updatedNPCs[npcId];\n        const incomingTime = new Date(incomingNPC.lastUpdated).getTime();\n        const localTime = localNPC?.lastUpdated ? new Date(localNPC.lastUpdated).getTime() : 0;\n\n        if (incomingTime > localTime) {\n          // Broadly log which attributes changed\n          const changedFields = Object.keys(incomingNPC).filter(key => {\n            if (key === 'lastUpdated') return false;\n            return JSON.stringify(incomingNPC[key]) !== JSON.stringify(localNPC?.[key]);\n          });\n          if (changedFields.length > 0) {\n            console.log(` NPC ${npcId} changed fields: ${changedFields.join(', ')}`);\n            // Show floating damage text if HP was reduced\n            if (changedFields.includes('hp') && localNPC?.hp && incomingNPC?.hp < localNPC.hp) {\n              const damageTaken = localNPC.hp - incomingNPC.hp;\n              FloatingTextManager.addFloatingText(`- ${damageTaken}  HP`, incomingNPC.position.x, incomingNPC.position.y, TILE_SIZE);\n            }\n          }\n\n          //console.log(`   Updating NPC ${npcId} from emitter ${emitterId}: ${incomingNPC.state}`);\n\n          const rehydrated = new NPC(\n            incomingNPC.id,\n            incomingNPC.type,\n            incomingNPC.position,\n            incomingNPC,\n            incomingNPC.gridId || gridId\n          );\n\n          updatedNPCs[npcId] = rehydrated;\n\n          if (liveGrid?.npcs) {\n            liveGrid.npcs[npcId] = rehydrated;\n            //console.log(` Rehydrated NPC ${npcId} into live NPCsInGrid`);\n          } else {\n            console.warn(` liveGrid.npcs missing for gridId ${gridId}`);\n          }\n        } else {\n          console.log(`   Skipped NPC ${npcId}, newer or same version already present.`);\n        }\n      });\n  \n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n  // Add handler for npc-moved-sync\n  const handleNPCMoveSync = ({ npcId, newPosition, emitterId }) => {\n    //console.log(' handleNPCMoveSync invoked.');\n    //console.log(' Received npc-moved-sync event:', { npcId, newPosition, emitterId });\n\n    if (!npcId || !newPosition) return;\n    \n    // Skip if this is the controller receiving their own broadcast\n    if (emitterId && emitterId === socket.id) {\n      console.log(` Skipping NPC animation for own broadcast (NPC ${npcId})`);\n      return;\n    }\n\n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      const existing = updatedNPCs[npcId];\n      //console.log(' SETTING GridState for existing:', existing);\n      if (existing) {\n        // Cache previous position BEFORE rehydration\n        const prevPosition = existing?.position;\n        //  Rehydrate if needed\n        const rehydrated = existing instanceof NPC\n          ? existing\n          : new NPC(\n              existing.id,\n              existing.type,\n              existing.position,\n              existing,\n              existing.gridId || gridId\n            );\n        //console.log(' Rehydrated NPC:', rehydrated);\n        // Animate movement if position changed\n        if (\n          prevPosition &&\n          newPosition &&\n          (prevPosition.x !== newPosition.x || prevPosition.y !== newPosition.y)\n        ) {\n          console.log('Calling animateRemotePC for NPC', npcId, prevPosition, newPosition);\n          animateRemotePC(npcId, prevPosition, newPosition, TILE_SIZE, 30); // More steps for smoother NPC movement\n        }\n        // Assign new position AFTER animation call\n        rehydrated.position = newPosition;\n        updatedNPCs[npcId] = rehydrated;\n        //  Also patch live memory state for controller\n        if (rehydrated instanceof NPC) {\n          NPCsInGridManager.NPCsInGrid[gridId].npcs[npcId] = rehydrated;\n        } else {\n          console.warn(` Tried to inject non-NPC instance into live NPCsInGrid for ${npcId}`);\n        }\n      }\n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n    // Add handler for npc-removal-sync\n  const handleNPCRemoval = ({ gridId, npcId }) => {\n    //console.log(` Received remove-NPC for ${npcId} in grid ${gridId}`);\n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      delete updatedNPCs[npcId];\n      const liveGrid = NPCsInGridManager.NPCsInGrid?.[gridId];\n      if (liveGrid?.npcs) {\n        delete liveGrid.npcs[npcId];\n        console.log(` Removed NPC ${npcId} from live NPCsInGrid (remove-NPC event)`);\n      }\n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n  //console.log(\" Subscribing to NPC sync events for grid:\", gridId);\n  socket.on(\"sync-NPCs\", handleNPCSync);\n  socket.on(\"npc-moved-sync\", handleNPCMoveSync); // main handler\n  socket.on(\"remove-NPC\", handleNPCRemoval);\n\n  return () => {\n    //console.log(\" Unsubscribing from NPC sync events for grid:\", gridId);\n    socket.off(\"sync-NPCs\", handleNPCSync);\n    socket.off(\"npc-moved-sync\", handleNPCMoveSync);\n    socket.off(\"remove-NPC\", handleNPCRemoval);\n  };\n}\n\n\n//  SOCKET LISTENER: Real-time updates for resources\nexport function socketListenForResourceChanges(TILE_SIZE, gridId, isMasterResourcesReady, setResources, masterResources, enrichResourceFromMaster) {\n\n  //console.log(\" useEffect for resource-sync running. gridId:\", gridId, \"socket:\", !!socket);\n  \n  // Wait until masterResources is ready\n  if (!gridId || !socket || !isMasterResourcesReady) {\n    console.warn('Master Resources not ready or missing gridId/socket.');\n    return; //  Don't process until ready\n  }\n  const handleResourceSync = ({ updatedResources }) => {\n    //console.log(\" Real-time tile/resource update received!\", updatedResources);\n\n    if (updatedResources?.length) {\n      setResources((prevResources) => {\n        if (!masterResources?.length) {\n          console.warn(` Skipping resource enrichment; masterResources not yet ready`);\n          return prevResources; // Do nothing until master data is populated\n        }\n        const updated = [...prevResources];\n        updatedResources.forEach((newRes) => {\n          if (!newRes || typeof newRes.x !== 'number' || typeof newRes.y !== 'number') {\n            console.warn(\" Skipping invalid socket resource:\", newRes);\n            return;\n          }\n\n          //  HANDLE RESOURCE REMOVAL\n          if (newRes.type === null) {\n            //console.log(` Removing resource at (${newRes.x}, ${newRes.y})`);\n            const indexToRemove = updated.findIndex(\n              (res) => res.x === newRes.x && res.y === newRes.y\n            );\n            //console.log('TILE_SIZE:', TILE_SIZE);\n            createCollectEffect(newRes.x, newRes.y, TILE_SIZE);\n\n            if (indexToRemove !== -1) {\n              updated.splice(indexToRemove, 1);\n            }\n            return; // Skip enrichment\n          }\n  \n          //  NORMAL ENRICHMENT PATH\n          const resourceTemplate = masterResources.find(r => r.type === newRes.type);\n          if (!resourceTemplate) {\n            console.warn(` No matching resource template found for ${newRes.type}`);\n          }\n          const enriched = enrichResourceFromMaster(newRes, masterResources);\n          //console.log(' LISTENER: enriched resource = ', enriched);\n          const filtered = updated.filter(r => !(r.x === newRes.x && r.y === newRes.y));\n          filtered.push(enriched);\n          updated.splice(0, updated.length, ...filtered);\n        });\n\n        // Now recreate shadow tiles for all multi-tile resources\n        // This also handles removal - any old shadow tiles not recreated will be gone\n        const finalResources = [...updated];\n        updated.forEach((resource) => {\n          if (resource.range && resource.range > 1) {\n            const anchorKey = resource.anchorKey || `${resource.type}-${resource.x}-${resource.y}`;\n            for (let dx = 0; dx < resource.range; dx++) {\n              for (let dy = 0; dy < resource.range; dy++) {\n                if (dx === 0 && dy === 0) continue; // Skip anchor\n                \n                const shadowX = resource.x + dx;\n                const shadowY = resource.y - dy;\n                const shadowResource = {\n                  type: 'shadow',\n                  x: shadowX,\n                  y: shadowY,\n                  parentAnchorKey: anchorKey,\n                  passable: resource.passable // Inherit from anchor\n                };\n                finalResources.push(shadowResource);\n              }\n            }\n          }\n        });\n        \n        return finalResources;\n      });\n    }\n  };\n\n  console.log(\" [resources] Subscribing to real-time updates for grid:\", gridId);\n  socket.on(\"resource-sync\", handleResourceSync);\n\n  return () => {\n    socket.off(\"resource-sync\", handleResourceSync);\n  };\n};\n\n//  SOCKET LISTENER: Real-time updates for tiles\nexport function socketListenForTileChanges(gridId, setTileTypes, mergeTiles) {\n\n  //console.log(\" useEffect for tile-sync running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!gridId || !socket) {\n    console.warn('Missing gridId or socket.');\n    return;\n  }\n\n  const handleTileSync = ({ updatedTiles }) => {\n    //console.log(\" Real-time tile update received!\", updatedTiles);\n\n    updatedTiles.forEach(tile => {\n      //console.log(\" Tile type in update:\", tile.type); // Add this\n    });\n\n    if (updatedTiles?.length) {\n      setTileTypes((prev) => {\n        const merged = mergeTiles(prev, updatedTiles); // Merge updated tiles into the current state\n        return merged;\n      });\n    }\n  };\n\n  console.log(\" [tiles] Subscribing to real-time tile updates for grid:\", gridId);\n  socket.on(\"tile-sync\", handleTileSync);\n\n  return () => {\n    console.log(\" Unsubscribing from tile-sync for grid:\", gridId);\n    socket.off(\"tile-sync\", handleTileSync);\n  };\n};\n\n// Add socket event listeners for NPC controller status\nexport function socketListenForNPCControllerStatus(gridId, currentPlayer, setControllerUsername) {\n\n  console.log(\" useEffect for npc-controller running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!socket || !currentPlayer) return;\n\n  // Send username to server when joining grid\n  if (gridId) {\n    socket.emit('set-username', { username: currentPlayer.username });\n  }\n\n  socket.on('npc-controller-update', ({ controllerUsername }) => {\n    setControllerUsername(controllerUsername);\n  });\n\n  socket.on('npc-controller-assigned', ({ gridId: controlledGridId }) => {\n    console.log(` Assigned as NPC controller for grid ${controlledGridId}`);\n  });\n\n  socket.on('npc-controller-revoked', ({ gridId: revokedGridId }) => {\n    console.log(` Revoked as NPC controller for grid ${revokedGridId}`);\n  });\n\n  return () => {\n    socket.off('npc-controller-update');\n    socket.off('npc-controller-assigned');\n    socket.off('npc-controller-revoked');\n  };\n\n};\n\n\n//  SOCKET LISTENER: Force refresh on season reset\nexport function socketListenForSeasonReset() {\n\n  if (!socket) return;\n\n  socket.on(\"force-refresh\", ({ reason }) => {\n    console.warn(` Server requested refresh: ${reason}`);\n    window.location.reload();\n  });\n\n  return () => {\n    socket.off(\"force-refresh\");\n  };\n};\n\n//  SOCKET LISTENER: Player Connect and Disconnect\nexport function socketListenForConnectAndDisconnect(gridId, currentPlayer, setIsSocketConnected) {\n  const handleConnect = () => {\n    console.log(' Socket connected!');\n    setIsSocketConnected(true);\n    // Emit presence info\n    socket.emit('player-connected', { playerId: currentPlayer._id, gridId });\n  };\n\n  const handleDisconnect = () => {\n    console.warn(' Socket disconnected.');\n    setIsSocketConnected(false);\n    // Notify others of disconnect\n    socket.emit('player-disconnected', { playerId: currentPlayer._id, gridId });\n  };\n\n  socket.on('connect', handleConnect);\n  socket.on('disconnect', handleDisconnect);\n\n  return () => {\n    socket.off('connect', handleConnect);\n    socket.off('disconnect', handleDisconnect);\n  };\n};\n\n//  SOCKET LISTENER: Listen for announcement that a player is connected/disconnected (I THINK ??)\nexport function socketListenForPlayerConnectedAndDisconnected(gridId, setConnectedPlayers) {\n  if (!socket || !gridId) return;\n\n  console.log(\" useEffect for player-connected/disconnected running. gridId:\", gridId);\n\n  //  Request current connection state on init\n  console.log(\" Requesting connected players list on startup.\");\n  socket.emit('request-connected-players', { gridId });\n\n  const handlePlayerConnected = ({ playerId }) => {\n    console.log(` Player connected: ${playerId}`);\n    setConnectedPlayers(prev => new Set(prev).add(playerId));\n  };\n\n  const handlePlayerDisconnected = ({ playerId }) => {\n    console.log(` Player disconnected: ${playerId}`);\n    setConnectedPlayers(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(playerId);\n      return newSet;\n    });\n  };\n\n  const handleCurrentConnectedPlayers = ({ connectedPlayerIds }) => {\n    console.log(\" Received full list of currently connected players:\", connectedPlayerIds);\n    setConnectedPlayers(new Set(connectedPlayerIds));\n  };\n\n  socket.on('player-connected', handlePlayerConnected);\n  socket.on('player-disconnected', handlePlayerDisconnected);\n  // Listen for the correct event name as emitted by the server\n  socket.on('connected-players', handleCurrentConnectedPlayers);\n\n  return () => {\n    socket.off('player-connected', handlePlayerConnected);\n    socket.off('player-disconnected', handlePlayerDisconnected);\n    socket.off('connected-players', handleCurrentConnectedPlayers);\n  };\n}\n\n\nexport function socketListenForChatMessages(setMessagesByScope) {\n  if (!socket) return;\n\n  const handleIncomingChatMessage = (msg) => {\n    console.log(\" Incoming chat message:\", msg);\n    const { scope, scopeId } = msg;\n    setMessagesByScope(prev => {\n      const prevMessages = prev[scopeId] || [];\n      return {\n        ...prev,\n        [scopeId]: [...prevMessages, msg],\n      };\n    });\n    //  Emit badge update for chat to all players in this scope\n    const badgePayload = {\n      playerId: null, // null means broadcast to all clients\n      username: null,\n      hasUpdate: true,\n    };\n    socket.emit('chat-badge-update', badgePayload);\n  };\n  socket.on('receive-chat-message', handleIncomingChatMessage);\n  return () => {\n    socket.off('receive-chat-message', handleIncomingChatMessage);\n  };\n}\n\nexport function emitChatMessage({ playerId, username, message, scope, scopeId }) {\n  if (!socket) return;\n  socket.emit('send-chat-message', {\n    playerId,\n    username,\n    message,\n    scope,\n    scopeId,\n    emitterId: socket.id //  Add this\n  });\n}\n\n\n\n//  SOCKET LISTENER: Consolidated badge updates (mailbox, store, chat, etc)\nexport function socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge) {\n  console.log(\" socketListenForBadgeUpdates called with player:\", currentPlayer?.username);\n\n  if (!socket || !currentPlayer) return;\n\n  const handleBadge = ({ type, playerId, username, hasUpdate }) => {\n    console.log(\" handleBadge invoked with:\", { type, playerId, username, hasUpdate });\n    console.log(\" SOCKET LISTENER: Received badge update:\", { type, playerId, username, hasUpdate });\n    console.log(\" Comparing currentPlayer._id:\", currentPlayer._id, \"to incoming:\", playerId);\n    \n    const isMatch =\n      type === 'chat' ? true :\n      (playerId && String(currentPlayer._id) === String(playerId)) ||\n      (username && currentPlayer.username === username);\n\n    console.log(\" isMatch:\", isMatch, \"for currentPlayer:\", currentPlayer.username);\n    if (!isMatch) return;\n\n    console.log(` Badge update received for ${type}.`);\n    updateBadge(currentPlayer, setBadgeState, type, hasUpdate);\n  };\n\n  socket.on('mailbox-badge-update', (data) => handleBadge({ ...data, type: 'mailbox' }));\n  socket.on('store-badge-update', (data) => handleBadge({ ...data, type: 'store' }));\n  socket.on('chat-badge-update', (data) => handleBadge({ ...data, type: 'chat' }));\n\n  return () => {\n    socket.off('mailbox-badge-update');\n    socket.off('store-badge-update');\n    socket.off('chat-badge-update');\n  };\n}\n\n// Utility to clear the chat badge for the current player\nexport function clearChatBadge(currentPlayer, setBadgeState, updateBadge) {\n  if (!currentPlayer) return;\n  updateBadge(currentPlayer, setBadgeState, 'chat', false);\n}\n\nexport default socket;\n","import API_BASE from '../config';\nimport socket from '../socketManager'; \nimport axios from 'axios';\nimport NPC from '../GameFeatures/NPCs/AllNPCsShared';\nimport { loadMasterResources } from '../Utils/TuningManager';\n\nlet gridTimer = null; // For periodic grid updates\nlet externalSetGridState = null;\n\nlet lastGridStateTimestamp = 0;\nexport const updateLastGridStateTimestamp = (timestamp) => {\n  if (timestamp > lastGridStateTimestamp) {\n    lastGridStateTimestamp = timestamp;\n  }\n};\nexport const getLastGridStateTimestamp = () => lastGridStateTimestamp;\n\nclass GridStateManager {\n  constructor() {\n    this.NPCsInGrid = {}; // Store grid states in memory\n    this.pendingPositionUpdates = new Map(); // Map<gridId, Map<npcId, {position, timestamp}>>\n    this.batchSaveInterval = null;\n    this.BATCH_SAVE_DELAY = 10000; // 10 seconds\n    console.log('GridStateManager instance created.');\n    \n    // Start batch save timer\n    this.startBatchSaveTimer();\n  }\n\n  /**\n   * Start the batch save timer\n   */\n  startBatchSaveTimer() {\n    if (this.batchSaveInterval) return; // Already running\n    \n    this.batchSaveInterval = setInterval(() => {\n      this.flushPendingPositionUpdates();\n    }, this.BATCH_SAVE_DELAY);\n    \n    console.log(' Batch save timer started (10s interval)');\n  }\n\n  /**\n   * Stop the batch save timer\n   */\n  stopBatchSaveTimer() {\n    if (this.batchSaveInterval) {\n      clearInterval(this.batchSaveInterval);\n      this.batchSaveInterval = null;\n      console.log(' Batch save timer stopped');\n    }\n  }\n\n  /**\n   * Queue a position update for batch saving\n   */\n  queuePositionUpdate(gridId, npcId, position) {\n    if (!this.pendingPositionUpdates.has(gridId)) {\n      this.pendingPositionUpdates.set(gridId, new Map());\n    }\n    \n    const gridUpdates = this.pendingPositionUpdates.get(gridId);\n    gridUpdates.set(npcId, {\n      position: { x: position.x, y: position.y },\n      timestamp: Date.now()\n    });\n    \n    //console.log(` Queued position update for NPC ${npcId} at (${position.x}, ${position.y})`);\n  }\n\n  /**\n   * Flush all pending position updates to the database\n   */\n  async flushPendingPositionUpdates() {\n    if (this.pendingPositionUpdates.size === 0) return;\n    \n    console.log(` Flushing batch position updates for ${this.pendingPositionUpdates.size} grids`);\n    \n    // Process each grid's updates\n    for (const [gridId, npcUpdates] of this.pendingPositionUpdates) {\n      if (npcUpdates.size === 0) continue;\n      \n      try {\n        // Convert Map to object for API\n        const updates = {};\n        for (const [npcId, update] of npcUpdates) {\n          updates[npcId] = update.position;\n        }\n        \n        // Send batch update to server\n        await axios.post(`${API_BASE}/api/batch-update-npc-positions`, {\n          gridId,\n          updates,\n          timestamp: Date.now()\n        });\n        \n        console.log(` Batch saved ${npcUpdates.size} NPC positions for grid ${gridId}`);\n        \n        // Clear the updates for this grid\n        npcUpdates.clear();\n      } catch (error) {\n        console.error(` Failed to batch save positions for grid ${gridId}:`, error);\n        // Keep the updates to retry next time\n      }\n    }\n    \n    // Clean up empty grid entries\n    for (const [gridId, npcUpdates] of this.pendingPositionUpdates) {\n      if (npcUpdates.size === 0) {\n        this.pendingPositionUpdates.delete(gridId);\n      }\n    }\n  }\n\n  /**\n   * Force flush position updates for a specific grid\n   * Used when player leaves a grid to ensure all updates are saved\n   */\n  async flushGridPositionUpdates(gridId) {\n    const npcUpdates = this.pendingPositionUpdates.get(gridId);\n    if (!npcUpdates || npcUpdates.size === 0) return;\n    \n    try {\n      // Convert Map to object for API\n      const updates = {};\n      for (const [npcId, update] of npcUpdates) {\n        updates[npcId] = update.position;\n      }\n      \n      // Send batch update to server\n      await axios.post(`${API_BASE}/api/batch-update-npc-positions`, {\n        gridId,\n        updates,\n        timestamp: Date.now()\n      });\n      \n      console.log(` Force batch saved ${npcUpdates.size} NPC positions for grid ${gridId}`);\n      \n      // Clear the updates for this grid\n      npcUpdates.clear();\n      this.pendingPositionUpdates.delete(gridId);\n    } catch (error) {\n      console.error(` Failed to force batch save positions for grid ${gridId}:`, error);\n    }\n  }\n\n  /**\n   * Update ONLY the position of an NPC without saving to database\n   * Used for movement to reduce server load\n   */\n  async updateNPCPosition(gridId, npcId, position) {\n    //console.log(` Updating position for NPC ${npcId} to (${position.x}, ${position.y})`);\n    \n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid || !NPCsInGrid.npcs?.[npcId]) {\n      console.error(`Cannot update position for NPC ${npcId}. Not found in grid ${gridId}`);\n      return;\n    }\n    \n    const npc = NPCsInGrid.npcs[npcId];\n    const now = Date.now();\n    \n    // Update position in memory\n    npc.position = { x: position.x, y: position.y };\n    npc.lastUpdated = now;\n    \n    // Queue for batch save instead of immediate save\n    this.queuePositionUpdate(gridId, npcId, position);\n    \n    // Still emit socket for real-time sync with other players\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npcId]: { ...npc, position } },\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n    \n    // Update React state - force timestamp update\n    NPCsInGrid.NPCsInGridLastUpdated = now;\n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          ...NPCsInGrid,\n          NPCsInGridLastUpdated: now,\n        },\n      }));\n    }\n  }\n\n  registerSetGridState(setterFunction) {\n    externalSetGridState = setterFunction;\n  }\n\n  /**\n   * Initialize the NPCsInGrid for a specific gridId.\n   */\n  async initializeGridState(gridId) {\n\n    console.log(' Initialize NPCsInGrid for gridId:', gridId);\n    if (!gridId) {\n      console.error('initializeGridState: gridId is undefined.');\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/load-grid-state/${gridId}`);\n      const {\n        NPCsInGrid = { npcs: {}, lastUpdated: 0 },\n      } = response.data;\n\n      // Build a consolidated local state with independent timestamps\n      const hydratedState = {\n        npcs: NPCsInGrid.npcs || {},\n        NPCsInGridLastUpdated: new Date(NPCsInGrid.lastUpdated || 0).getTime(),\n      };\n      const npcs = hydratedState.npcs || {};\n      console.log('Fetched NPCsInGrid:', hydratedState);\n\n      // Load master resources\n      const masterResources = await loadMasterResources();\n\n      // Rehydrate NPCs\n      if (npcs) {\n        Object.keys(npcs).forEach((npcId) => {\n          const lightweightNPC = npcs[npcId];\n          const npcTemplate = masterResources.find((res) => res.type === lightweightNPC.type);\n          if (!npcTemplate) {\n            console.warn(` Missing template for NPC type: ${lightweightNPC.type}`);\n            console.log('Master resources:', masterResources.map(res => res.type));\n          }\n          const hydrated = new NPC(\n            npcId,\n            lightweightNPC.type,\n            lightweightNPC.position,\n            { ...npcTemplate, ...lightweightNPC },\n            gridId\n          );\n\n          console.log('   Hydrated NPC instance:', hydrated);\n\n          NPCsInGrid.npcs[npcId] = hydrated;\n        });\n      }\n\n      this.NPCsInGrid[gridId] = NPCsInGrid;\n\n      if (this.setGridStateReact) {\n        console.log(' Syncing initialized NPCs to React state for gridId:', gridId);\n        this.setGridStateReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            ...NPCsInGrid,\n          },\n        }));\n      }\n\n      console.log(` Initialized and enriched NPCsInGrid for gridId ${gridId}:`, NPCsInGrid);\n    } catch (error) {\n      console.error('Error fetching NPCsInGrid:', error);\n    }\n  }\n\n  /**\n   * Get the NPCsInGrid for a specific gridId.\n   */\n  getNPCsInGrid(gridId) {\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid) {\n      console.warn(` No NPCsInGrid found for gridId: ${gridId}`);\n      return { npcs: {} }; // Only return NPCs\n    }\n    return NPCsInGrid.npcs;\n  }\n\n  /**\n   * Spawn a new NPC and immediately save the updated NPCsInGrid to the DB.\n   */\n  async spawnNPC(gridId, npcType, position) {\n    // DEBUG: Log input parameters for spawnNPC\n    console.log('spawnNPC called with:', { gridId, npcType, position });\n    if (typeof npcType === 'object' && npcType?.type) {\n      npcType = npcType.type; // Extract the type string\n    }\n    if (typeof npcType !== 'string') {\n      console.error('Invalid npcType. Expected a string but got:', npcType);\n      return;\n    }\n    const masterResources = await axios.get(`${API_BASE}/api/resources`);\n    const npcTemplate = masterResources.data.find((res) => res.type === npcType && res.category === 'npc');\n    if (!npcTemplate) {\n      console.error(`NPC template not found for type: ${npcType}`);\n      return;\n    }\n\n    const npcId = `${Date.now()}`;\n\n    let lightweightNPC;\n\n    if (npcTemplate.action === 'graze') {\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'idle',\n        position,\n        hp: 0,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n      };\n    } else if (npcTemplate.action === 'spawn') {  // Ensure spawners track nextspawn\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'hungry',\n        position,\n        hp: npcTemplate.maxhp,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n        nextspawn: Date.now() + npcTemplate.speed * 1000, // Ensure nextspawn is explicitly set\n      };\n    } else {\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'idle',\n        position,\n        hp: npcTemplate.maxhp,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n      };\n    }\n    console.log('Creating lightweightNPC:', lightweightNPC);\n\n    // Ensure NPC is properly instantiated as an `NPC` class object before adding\n    const npc = new NPC(\n      npcId,\n      npcType,\n      position,\n      { ...npcTemplate, ...lightweightNPC },\n      gridId // Include gridId\n    );\n    this.addNPC(gridId, npc);\n\n    console.log(`Successfully added NPC to NPCsInGrid. NPC ID: ${npcId}`);\n\n    const updatedGridState = this.getNPCsInGrid(gridId);\n    this.setAllNPCs(gridId, updatedGridState);\n  }\n\n  /**\n   * Add an NPC to the NPCsInGrid using per-NPC save model.\n   */\n  async addNPC(gridId, npc) {\n    console.log(`Adding NPC to NPCsInGrid for gridId: ${gridId}. NPC:`, npc);\n    let NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid) {\n      console.warn(` No NPCsInGrid found for gridId: ${gridId}. Initializing new entry.`);\n      NPCsInGrid = { npcs: {}, NPCsInGridLastUpdated: Date.now() };\n      this.NPCsInGrid[gridId] = NPCsInGrid;\n    }\n    if (!NPCsInGrid.npcs) NPCsInGrid.npcs = {};\n\n    const now = Date.now();\n    npc.lastUpdated = now;\n\n    NPCsInGrid.npcs[npc.id] = npc;\n\n    try {\n      await axios.post(`${API_BASE}/api/save-single-npc`, {\n        gridId,\n        npcId: npc.id,\n        npc,\n        lastUpdated: now,\n      });\n      console.log(` Saved single NPC ${npc.id} to server.`);\n    } catch (error) {\n      console.error(` Failed to save single NPC ${npc.id}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npc.id]: npc }, // or [npc.id]: npc in addNPC\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      console.log(\" Emitting update-NPCsInGrid-NPCs with payload:\", JSON.stringify(payload, null, 2));\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n  }\n\n  /**\n   * Update an NPC in the NPCsInGrid using the per-NPC save model.\n   */\n  async updateNPC(gridId, npcId, newProperties) {\n    //console.log(`++ Updating NPC ${npcId} for gridId: ${gridId}`);\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    const existing = NPCsInGrid?.npcs?.[npcId];\n\n    if (!NPCsInGrid || !NPCsInGrid.npcs?.[npcId]) {\n      console.error(`Cannot update NPC ${npcId}. No NPCsInGrid or NPC found for gridId: ${gridId}`);\n      return;\n    }\n\n    if (!(existing instanceof NPC)) {\n      console.error(` Skipping updateNPC for ${npcId}  not an instance of NPC:`, existing);\n      return;\n    }\n  \n    const now = Date.now();\n    const npc = NPCsInGrid.npcs[npcId]; // already an instance of NPC\n    Object.assign(npc, newProperties);\n    npc.lastUpdated = now;\n\n    //console.log(`[ NPCsInGridManager.updateNPC] NPC ${npcId} updated with:`, newProperties);\n\n    try {\n      // Send only the essential properties to the server\n      const npcData = {\n        id: npc.id,\n        type: npc.type,\n        position: npc.position,\n        state: npc.state,\n        hp: npc.hp,\n        maxhp: npc.maxhp,\n        grazeEnd: npc.grazeEnd,\n        lastUpdated: npc.lastUpdated,\n        action: npc.action,\n        gridId: npc.gridId\n      };\n      \n      //console.log(` Saving NPC ${npcId} to server with state: ${npcData.state}`);\n      \n      await axios.post(`${API_BASE}/api/save-single-npc`, {\n        gridId,\n        npcId,\n        npc: npcData,\n        lastUpdated: now,\n      });\n      //console.log(` Saved single NPC ${npcId} to server with state: ${npcData.state}`);\n    } catch (error) {\n      console.error(` Failed to save single NPC ${npcId}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npcId]: npc }, // or [npc.id]: npc in addNPC\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      //console.log(\" Emitting update-NPCsInGrid-NPCs with payload:\", JSON.stringify(payload, null, 2));\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n    \n    // Update React state to trigger re-renders - force timestamp update\n    NPCsInGrid.NPCsInGridLastUpdated = now;\n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          ...NPCsInGrid,\n          NPCsInGridLastUpdated: now,\n        },\n      }));\n    }\n  }\n\n\n  /**\n   * Remove an NPC from the NPCsInGrid using the per-NPC save model.\n   */\n  async removeNPC(gridId, npcId) {\n    console.log(`Removing NPC ${npcId} from gridId: ${gridId}`);\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid || !NPCsInGrid.npcs) {\n      console.error(`Cannot remove NPC. No NPCsInGrid or NPCs found for gridId: ${gridId}`);\n      return;\n    }\n\n    delete NPCsInGrid.npcs[npcId];\n    this.setAllNPCs(gridId, NPCsInGrid.npcs); //  Update React state after deletion\n\n    try {\n      await axios.post(`${API_BASE}/api/remove-single-npc`, {\n        gridId,\n        npcId,\n      });\n      console.log(` Removed single NPC ${npcId} from server.`);\n    } catch (error) {\n      console.error(` Failed to remove single NPC ${npcId}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      socket.emit('remove-NPC', {\n        gridId,\n        npcId,\n        emitterId: socket.id,\n      });\n      console.log(` Emitted NPC removal for ${npcId}`);\n    }\n  }\n\n  /**\n   * Save only NPCs in the NPCsInGrid to the database.\n   * This version dehydrates live NPC instances into plain objects and matches the PC saving structure.\n   */\n  async saveGridStateNPCs(gridId) {\n    //console.log(' saveGridStateNPCs called with gridId:', gridId);\n    try {\n      const NPCsInGrid = this.NPCsInGrid[gridId];\n      if (!NPCsInGrid || !NPCsInGrid.npcs) {\n        console.warn(` No NPCs to save for grid ${gridId}`);\n        return;\n      }\n\n      // Update local NPC timestamp\n      const now = Date.now();\n      NPCsInGrid.NPCsInGridLastUpdated = now;\n\n      // Dehydrate the NPCs to simple objects\n      const dehydratedNPCs = {};\n      Object.entries(NPCsInGrid.npcs).forEach(([id, npc]) => {\n        dehydratedNPCs[id] = {\n          id: npc.id,\n          type: npc.type,\n          position: npc.position,\n          state: npc.state,\n          hp: npc.hp,\n          maxhp: npc.maxhp,\n          grazeEnd: npc.grazeEnd,\n          lastUpdated: npc.lastUpdated,\n        };\n      });\n\n      const payload = {\n        gridId,\n        npcs: dehydratedNPCs,\n        NPCsInGridLastUpdated: now,\n      };\n\n      //console.log(' Payload for saving NPCs:', payload);\n\n      // Save to server\n      await axios.post(`${API_BASE}/api/save-grid-state-npcs`, payload);\n      //console.log(`  Saved NPCs for grid ${gridId}`);\n\n      // Emit updated NPCs to other clients\n      if (socket && socket.emit) {\n        console.log(` Emitting NPC grid-state for grid ${gridId}`);\n        socket.emit('update-NPCsInGrid-NPCs', {\n          gridId,\n          npcs: dehydratedNPCs,\n          NPCsInGridLastUpdated: now,\n        });\n      }\n    } catch (error) {\n      console.error(` Error saving NPCs for grid ${gridId}:`, error);\n    }\n  }\n\n  /**\n   * Start periodic updates for NPCs in the NPCsInGrid.\n   */\n  startGridTimer(gridId) {\n    if (gridTimer) clearInterval(gridTimer);\n\n    gridTimer = setInterval(() => {\n      const NPCsInGrid = this.NPCsInGrid[gridId];\n      if (!NPCsInGrid) return;\n\n      const { npcs } = NPCsInGrid;\n      const now = Date.now();\n\n      Object.values(npcs || {}).forEach((npc) => {\n        if (npc instanceof NPC && typeof npc.update === 'function') {\n          //console.log(`Calling update() for NPC ID: ${npc.id}`);\n          npc.update(now, NPCsInGrid); // Let each NPC handle its own updates\n        } else {\n          console.error(`NPC ID: ${npc.id} is not a valid NPC instance or missing update method. NPC:`, npc);\n        }\n      });\n\n      console.log(`Processed NPC updates for gridId ${gridId}.`);\n    }, 1000);\n  }\n\n  /**\n   * Stop periodic updates for NPCs.\n   */\n  stopGridTimer() {\n    if (gridTimer) clearInterval(gridTimer);\n    gridTimer = null;\n  }\n\n  // Stop updates or clear grid state\n  stopGridStateUpdates() {\n    if (this.updateInterval) {\n      clearInterval(this.updateInterval); // Clear periodic updates\n      this.updateInterval = null;\n      //console.log('Grid state updates stopped.');\n    }\n    \n    // Flush any pending position updates before clearing\n    this.flushPendingPositionUpdates();\n    \n    // Stop the batch save timer\n    this.stopBatchSaveTimer();\n    \n    this.NPCsInGrid = {}; // Clear in-memory grid states\n    this.pendingPositionUpdates.clear(); // Clear pending updates\n  }\n\n  registerSetGridState(setter) {\n    this.setGridStateReact = setter;\n  }\n\n  setAllNPCs(gridId, npcsObject) {\n    //console.log('Setting all NPCs for gridId:', gridId, '; NPCs object:', npcsObject);\n  \n    // Safely get or create the current state\n    const existingState = this.NPCsInGrid[gridId] || {};\n    const lastUpdated = existingState.NPCsInGridLastUpdated || Date.now();\n  \n    this.NPCsInGrid[gridId] = {\n      ...existingState,\n      npcs: npcsObject || {},\n      NPCsInGridLastUpdated: lastUpdated,\n    };\n  \n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          npcs: npcsObject || {},\n          NPCsInGridLastUpdated: Date.now(), // Force update timestamp\n        },\n      }));\n    }\n  }\n\n}\n\nconst NPCsInGridManager = new GridStateManager();\n\n// Export individual methods for direct use\nexport const {\n  initializeGridState,\n  getNPCsInGrid,\n  addNPC,\n  updateNPC,\n  updateNPCPosition,\n  removeNPC, \n  registerSetGridState,\n  setAllNPCs,\n  flushPendingPositionUpdates,\n  flushGridPositionUpdates,\n} = NPCsInGridManager;\n\n// Default export for the entire manager\nexport default NPCsInGridManager;","import API_BASE from '../config';\nimport axios from 'axios';\nimport playersInGridManager from '../GridState/PlayersInGrid';\n\n// Helper function to check if an item is a currency (doesn't count against inventory)\nexport const isCurrency = (resourceType) => {\n  return resourceType === 'Money' || \n         resourceType === 'Gem' || \n         resourceType === 'Yellow Heart' ||\n         resourceType === 'Green Heart' ||\n         resourceType === 'Purple Heart';\n};\n\n/**\n * Calculate skill multiplier for a specific resource type\n * @param {String} resourceType - The resource type to check skills for\n * @param {Array} playerSkills - Player's skills array\n * @param {Object} masterSkills - Master skills definitions\n * @returns {Object} Object containing multiplier, applicable skills, and whether skills apply\n */\nexport function calculateSkillMultiplier(resourceType, playerSkills, masterSkills) {\n  const applicableSkills = [];\n  let multiplier = 1;\n  \n  // Find all skills that buff this resource type\n  playerSkills.forEach(skill => {\n    const buffValue = masterSkills?.[skill.type]?.[resourceType];\n    if (buffValue && buffValue > 1) {\n      applicableSkills.push(skill.type);\n      multiplier *= buffValue;\n    }\n  });\n  \n  return {\n    multiplier,\n    skills: applicableSkills,\n    hasSkills: applicableSkills.length > 0\n  };\n}\n\n/**\n * Apply skill multiplier to a base quantity\n * @param {Number} baseQuantity - Base quantity before skills\n * @param {Number} multiplier - Skill multiplier\n * @returns {Number} Final quantity after applying skills\n */\nexport function applySkillMultiplier(baseQuantity, multiplier) {\n  return Math.floor(baseQuantity * multiplier);\n}\n\n/**\n * Derives the total warehouse and backpack capacity based on player skills and master resources.\n * @param {object} currentPlayer - The player object including skills and base capacities.\n * @param {Array} masterResources - Array of all master resource definitions.\n * @param {object} globalTuning - Global tuning configuration object.\n * @returns {object} - { warehouse: number, backpack: number }\n */\n\nexport function deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning) {\n  const baseWarehouse = currentPlayer?.warehouseCapacity || 0;\n  const baseBackpack = currentPlayer?.backpackCapacity || 0;\n  const isGold = currentPlayer?.accountStatus === \"Gold\";\n  \n  // Get Gold bonuses from globalTuning parameter\n  const warehouseBonus = isGold ? (globalTuning?.warehouseCapacityGold || 100000) : 0;\n  const backpackBonus = isGold ? (globalTuning?.backpackCapacityGold || 5000) : 0;\n\n  return (currentPlayer?.skills || []).reduce(\n    (acc, skill) => {\n      const skillDetails = masterResources?.find(res => res.type === skill.type);\n      if (skillDetails) {\n        const bonus = skillDetails.qtycollected || 0;\n        if (skillDetails.output === 'warehouseCapacity') {\n          acc.warehouse += bonus;\n        } else if (skillDetails.output === 'backpackCapacity') {\n          acc.backpack += bonus;\n        }\n      }\n      return acc;\n    },\n    { warehouse: baseWarehouse + warehouseBonus, backpack: baseBackpack + backpackBonus }\n  );\n}\n\n\n\nexport const canAfford = (recipe, inventory = [], backpack = [], amount = 1) => {\n  if (!recipe) return false;\n  const inv = Array.isArray(inventory) ? inventory : [];\n  const bp = Array.isArray(backpack) ? backpack : [];\n  // Check up to 10 ingredients to support all recipes\n  for (let i = 1; i <= 10; i++) {\n    const ingredientType = recipe[`ingredient${i}`];\n    const ingredientQty = recipe[`ingredient${i}qty`] * amount;\n    if (ingredientType && ingredientQty >= 0) {\n      const backpackItem = bp.find((item) => item.type === ingredientType);\n      const inventoryItem = inv.find((item) => item.type === ingredientType);\n      const totalQty = (backpackItem?.quantity || 0) + (inventoryItem?.quantity || 0);\n      if (totalQty < ingredientQty) { return false; }\n    }\n  }\n  return true;\n};\n\n/**\n * Checks if there's room to store a resource without actually adding it\n * @param {object} params - Parameters for checking capacity\n * @returns {boolean} - True if there's room, false otherwise\n */\nexport const hasRoomFor = ({\n  resource,\n  quantity,\n  currentPlayer,\n  inventory,\n  backpack,\n  masterResources,\n  globalTuning\n}) => {\n  const isCurrencyItem = isCurrency(resource);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n  \n  \n  // Currencies always have room\n  if (isCurrencyItem) return true;\n  \n  // Check backpack skill if storing in backpack\n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      return false;\n    }\n  }\n  \n  // Check capacity\n  const target = isHomestead ? inventory : backpack;\n  \n  const { warehouse, backpack: maxBackpack } = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources || [], globalTuning);\n  const capacity = isHomestead ? warehouse : maxBackpack;\n  \n  const totalItems = target\n    .filter(item => item && !isCurrency(item.type) && typeof item.quantity === 'number')\n    .reduce((acc, item) => acc + item.quantity, 0);\n    \n  return totalItems + quantity <= capacity;\n};\n\n\nexport async function fetchInventoryAndBackpack(playerId) {\n  if (!playerId) {\n    console.error('No playerId provided for fetching inventory and backpack');\n    return { inventory: [], backpack: [] };\n  }\n  try {\n    const response = await axios.get(`${API_BASE}/api/inventory/${playerId}`);\n    return {\n      inventory: response.data?.inventory || [],\n      backpack: response.data?.backpack || [],\n      warehouseCapacity: response.data?.warehouseCapacity || 0,\n      backpackCapacity: response.data?.backpackCapacity || 0,\n    };\n  } catch (error) {\n    console.error('Error fetching inventory and backpack:', error);\n    return { inventory: [], backpack: [] };\n  }\n}\n\nexport async function fetchInventory(playerId) {\n  if (!playerId) {\n    console.error('No playerId provided for fetching inventory');\n    return [];\n  }\n  try {\n    const response = await axios.get(`${API_BASE}/api/inventory/${playerId}`);\n    return response.data?.inventory || [];\n  } catch (error) {\n    console.error('Error fetching inventory:', error);\n    return [];\n  }\n}\n\n \n/**\n * Refreshes the player's state after an inventory update.\n * Ensures that the latest inventory and other properties are reflected in the UI.\n * @param {string} playerId - The player's ID.\n * @param {Function} setCurrentPlayer - Function to update the currentPlayer state.\n * @param {boolean} preserveInventory - If true, preserves local inventory/backpack state\n */\nexport async function refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, preserveInventory = true) {\n  try {\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const updatedPlayerData = response.data;\n    \n    console.log(' [HP DEBUG] refreshPlayerAfterInventoryUpdate - Server player data:');\n    console.log('  updatedPlayerData.hp:', updatedPlayerData.hp);\n    console.log('  updatedPlayerData.maxhp:', updatedPlayerData.maxhp);\n    console.log('  updatedPlayerData.baseHp:', updatedPlayerData.baseHp);\n    console.log('  updatedPlayerData.baseMaxhp:', updatedPlayerData.baseMaxhp);\n    \n    // If preserveInventory is true, keep the current inventory and backpack\n    if (preserveInventory) {\n      setCurrentPlayer(currentPlayer => {\n        const merged = {\n          ...updatedPlayerData,\n          inventory: currentPlayer.inventory,\n          backpack: currentPlayer.backpack\n        };\n        \n        // Pull latest location from playersInGridManager if available\n        const gridPlayer = playersInGridManager.getPlayersInGrid(merged.location?.g)?.[playerId];\n        if (gridPlayer) {\n          merged.location = {\n            ...merged.location,\n            x: gridPlayer.position.x,\n            y: gridPlayer.position.y,\n          };\n        }\n        \n        return merged;\n      });\n    } else {\n      // Original behavior - full replacement\n      // Pull latest location from playersInGridManager if available\n      const gridPlayer = playersInGridManager.getPlayersInGrid(updatedPlayerData.location?.g)?.[playerId];\n      if (gridPlayer) {\n        updatedPlayerData.location = {\n          ...updatedPlayerData.location,\n          x: gridPlayer.position.x,\n          y: gridPlayer.position.y,\n        };\n      }\n      setCurrentPlayer(updatedPlayerData);\n    }\n  } catch (error) {\n    console.error('Error refreshing player:', error);\n  }\n}\n\n\n\n////////////////////////////////////////\nexport async function gainIngredients({\n  playerId,\n  currentPlayer,\n  resource,\n  quantity,\n  inventory,\n  backpack,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) {\n  const isCurrencyItem = isCurrency(resource);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n\n  const target = isCurrencyItem || isHomestead ? [...inventory] : [...backpack];\n\n  //  Backpack skill check if storing in backpack\n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      if (updateStatus) updateStatus(19); // Missing backpack\n      return {\n        success: false,\n        isCapacityError: true, // Treat missing backpack as a capacity issue for rollback purposes\n        isMissingBackpack: true, // Specific flag for missing backpack\n        isNetworkError: false,\n        error: new Error('Missing backpack skill')\n      };\n    }\n  }\n    \n  //  Capacity check\n  if (!isCurrencyItem) {\n    const { warehouse, backpack: maxBackpack } = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources || [], globalTuning);\n    const capacity = isHomestead ? warehouse : maxBackpack;\n    const totalItems = target\n      .filter(item => item && !isCurrency(item.type) && typeof item.quantity === 'number')\n      .reduce((acc, item) => acc + item.quantity, 0);\n    if (totalItems + quantity > capacity) {\n      if (updateStatus) updateStatus(isHomestead ? 20 : 21); // 20 = warehouse full, 21 = backpack full\n      return {\n        success: false,\n        isCapacityError: true,\n        isNetworkError: false,\n        error: new Error(isHomestead ? 'Warehouse full' : 'Backpack full')\n      };\n    }\n  }\n\n  //  Apply gain\n  const index = target.findIndex((item) => item.type === resource);\n  if (index >= 0) {\n    target[index].quantity += quantity;\n  } else {\n    target.push({ type: resource, quantity });\n  }\n\n  // Prepare delta payload for update-inventory-delta endpoint, including explicit target\n  const deltaPayload = {\n    playerId,\n    delta: [{\n      type: resource,\n      quantity: quantity,\n      target: storingInBackpack ? 'backpack' : 'inventory'\n    }]\n  };\n\n  try {\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, deltaPayload);\n    \n    setInventory(isCurrencyItem || isHomestead ? target : inventory);\n    setBackpack(!isCurrencyItem && !isHomestead ? target : backpack);\n    \n    // Update currentPlayer with new inventory to ensure UI updates properly\n    setCurrentPlayer(prev => ({\n      ...prev,\n      inventory: isCurrencyItem || isHomestead ? target : inventory,\n      backpack: !isCurrencyItem && !isHomestead ? target : backpack\n    }));\n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n    return true;\n  } catch (err) {\n    console.error(\" Error gaining ingredient:\", err);\n    console.error(\"Error details:\", {\n      status: err.response?.status,\n      data: err.response?.data,\n      message: err.message,\n      resource,\n      quantity,\n      target: storingInBackpack ? 'backpack' : 'inventory'\n    });\n    \n    // Check if this is a real conflict vs a temporary error\n    const isCapacityError = err.response?.status === 400 && \n      (err.response?.data?.error?.includes('capacity') || \n       err.response?.data?.error?.includes('full'));\n    \n    const isNetworkError = !err.response || err.response?.status >= 500;\n    \n    // Return error details so caller can decide whether to rollback\n    return {\n      success: false,\n      isCapacityError,\n      isNetworkError,\n      error: err\n    };\n  }\n}\n\n\n////////////////////////////////////////\nexport async function spendIngredients({\n  playerId,\n  recipe,\n  inventory,\n  backpack,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  updateStatus,\n}) {\n  let updatedInventory = [...inventory];\n  let updatedBackpack = [...backpack];\n\n  if (!canAfford(recipe, inventory, backpack, 1)) { updateStatus(4); return false; }\n\n  // Build delta changes array\n  const deltaChanges = [];\n  \n  // Deduct ingredients with new logic (support up to 10 ingredients)\n  for (let i = 1; i <= 10; i++) {\n    const type = recipe?.[`ingredient${i}`];\n    const qty = recipe?.[`ingredient${i}qty`];\n    if (type && qty) {\n      let remaining = qty;\n      \n      // First deduct from backpack\n      const backpackItem = updatedBackpack.find((item) => item.type === type);\n      if (backpackItem) {\n        const used = Math.min(remaining, backpackItem.quantity);\n        backpackItem.quantity -= used;\n        remaining -= used;\n        deltaChanges.push({ type, quantity: -used, target: 'backpack' });\n        if (backpackItem.quantity <= 0) {\n          updatedBackpack.splice(updatedBackpack.indexOf(backpackItem), 1);\n        }\n      }\n      \n      // Then deduct from inventory if needed\n      if (remaining > 0) {\n        const inventoryItem = updatedInventory.find((item) => item.type === type);\n        if (inventoryItem) {\n          const used = Math.min(remaining, inventoryItem.quantity);\n          inventoryItem.quantity -= used;\n          deltaChanges.push({ type, quantity: -used, target: 'inventory' });\n          if (inventoryItem.quantity <= 0) {\n            updatedInventory.splice(updatedInventory.indexOf(inventoryItem), 1);\n          }\n        }\n      }\n      \n    }\n  }\n\n  try {\n    // Use delta update endpoint to avoid race conditions\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n      playerId,\n      delta: deltaChanges\n    });\n    \n    setInventory(updatedInventory);\n    setBackpack(updatedBackpack);\n    \n    // Update currentPlayer with new inventory to ensure UI updates properly\n    setCurrentPlayer(prev => ({\n      ...prev,\n      inventory: updatedInventory,\n      backpack: updatedBackpack\n    }));\n    \n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n    \n    // Return object that's backward compatible (truthy) but also includes updated arrays\n    const result = { success: true, updatedInventory, updatedBackpack };\n    // Make the object truthy for backward compatibility\n    result.valueOf = () => true;\n    return result;\n\n  } catch (err) {\n    console.error(\" Error spending ingredients:\", err);\n    return false;\n  }\n}","// Mapping of signpost directions to entrance positions on the destination grid\nconst TRANSIT_POSITIONS = {\n  N: { x: 31, y: 63 },   // Enter from south edge, middle\n  NE: { x: 0, y: 63 },   // Enter from southwest corner\n  E: { x: 0, y: 31 },    // Enter from west edge, middle\n  SE: { x: 0, y: 0 },    // Enter from northwest corner\n  S: { x: 31, y: 0 },    // Enter from north edge, middle\n  SW: { x: 63, y: 0 },   // Enter from northeast corner\n  W: { x: 63, y: 30 },   // Enter from east edge, middle\n  NW: { x: 63, y: 63 },  // Enter from southeast corner\n};\n\n// Get the opposite direction for entrance position\nconst OPPOSITE_DIRECTION = {\n  N: \"S\",\n  NE: \"SW\",\n  E: \"W\",\n  SE: \"NW\",\n  S: \"N\",\n  SW: \"NE\",\n  W: \"E\",\n  NW: \"SE\"\n};\n\nexport function getEntryPosition(direction) {\n  return TRANSIT_POSITIONS[direction] || { x: 0, y: 0 }; // Default to center if unknown\n}\n\nexport function getOppositeEntryPosition(direction) {\n  const oppositeDir = OPPOSITE_DIRECTION[direction];\n  return TRANSIT_POSITIONS[oppositeDir] || { x: 0, y: 0 };\n}\n","import API_BASE from \"../../config\";\nimport axios from \"axios\";\nimport { changePlayerLocation } from \"../../Utils/GridManagement\";\nimport { getEntryPosition } from './transitConfig';\nimport playersInGridManager from \"../../GridState/PlayersInGrid\";\nimport { fetchHomesteadOwner, fetchHomesteadSignpostPosition, fetchTownSignpostPosition } from \"../../Utils/worldHelpers\";\nimport { updateGridStatus } from \"../../Utils/GridManagement\";\nimport { incrementFTUEStep } from \"../FTUE/FTUE\";\nimport FloatingTextManager from \"../../UI/FloatingText\";\n\nexport async function handleTransitSignpost(\n  currentPlayer,\n  resourceType,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  skills,\n  closeAllPanels,\n  bulkOperationContext,\n  masterResources,\n  strings = null,\n  masterTrophies = null\n) {\n  try {\n    if (typeof updateStatus !== \"function\") {\n      console.warn(\" updateStatus is not a function:\", updateStatus);\n    }\n    console.log(\"Handling transit for resource:\", resourceType);\n    console.log(\" currentPlayer before checking skills:\", currentPlayer);\n    console.log(\" currentPlayer.skills:\", currentPlayer.skills);\n\n    // 1) Handle special signposts (no Horse skill required for Town/Home)\n    const { g: currentGridId, s: settlementId, f: frontierId } = currentPlayer.location;\n    \n    // Check if this is Signpost Town or Signpost Home (no Horse required)\n    const isSpecialSignpost = resourceType === \"Signpost Town\" || resourceType === \"Signpost Home\";\n    \n    // 2) For non-special signposts, ensure the player has the Horse skill\n    if (!isSpecialSignpost) {\n        skills = currentPlayer.skills.length ? currentPlayer.skills : await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`).then(res => res.data.skills || []);\n\n        console.log('skillResponse.data: ', skills);\n        console.log('currentPlayer = ',currentPlayer.username);\n        \n        const hasHorse = skills.some((item) => item.type === \"Horse\" && item.quantity > 0);\n        console.log('hasHorse: ', hasHorse);\n        if (!hasHorse) { \n            updateStatus(15);\n            // Add floating text at player's current position using PlayersInGrid\n            const playersInGrid = playersInGridManager.getPlayersInGrid(currentGridId);\n            if (playersInGrid && playersInGrid[currentPlayer.playerId]) {\n                const position = playersInGrid[currentPlayer.playerId].position;\n                FloatingTextManager.addFloatingText(91, position.x, position.y, TILE_SIZE);\n            }\n            return; \n        }\n    }\n\n    // Signpost Home\n    if (resourceType === \"Signpost Home\") {\n      console.log(\" Traveling to homestead:\", {\n        gridId: currentPlayer.gridId,\n        settlementId: currentPlayer.settlementId,\n        gridCoord: currentPlayer.gridCoord,\n      });\n      \n      // Fetch the homestead grid data to find Signpost Town location\n      try {\n        const signpostPosition = await fetchHomesteadSignpostPosition(currentPlayer.gridId);\n        \n        const newPlayerPosition = {\n          x: signpostPosition.x,\n          y: signpostPosition.y,\n          g: currentPlayer.gridId,      // The player's homestead grid\n          s: currentPlayer.settlementId,\n          f: currentPlayer.location.f,\n          gtype: \"homestead\",\n          gridCoord: currentPlayer.location?.gridCoord || currentPlayer.gridCoord || 0,\n        };\n        \n        updateStatus(101);\n        await changePlayerLocation(\n          currentPlayer,\n          currentPlayer.location,   // fromLocation\n          newPlayerPosition,        // toLocation\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          TILE_SIZE,\n          closeAllPanels,\n          updateStatus,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies\n        );\n        \n      } catch (error) {\n        console.error(\" Error traveling home:\", error);\n        if (error.message && error.message.includes('Failed to remove player from previous grid')) {\n          updateStatus(\"Failed to leave current location. Please try again.\");\n        } else {\n          updateStatus(\"Error traveling home\");\n        }\n      }\n      \n      return;\n    }\n\n    // Signpost Town\n    if (resourceType === \"Signpost Town\") {\n      console.log(\"Signpost Town clicked. Finding the first town grid in the settlement.\");\n\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n      const settlement = settlementResponse.data;\n      if (!settlement || !settlement.grids) { updateStatus(104); return; }\n\n      // Find any sub-grid with gridType = town\n      const townGrid = settlement.grids.flat().find((grid) => grid.gridType === \"town\" && grid.gridId);\n      if (!townGrid) { updateStatus(104); return; }\n\n      console.log(\"Found town grid:\", townGrid);\n      \n      // Fetch the town grid data to find Train location\n      try {\n        const signpostPosition = await fetchTownSignpostPosition(townGrid.gridId);\n        \n        const newPlayerPosition = {\n          x: signpostPosition.x,\n          y: signpostPosition.y,\n          g: townGrid.gridId,\n          s: settlementId,\n          f: frontierId,\n          gtype: \"town\",\n          gridCoord: townGrid.gridCoord,\n        };\n        \n        updateStatus(102);\n        \n        // Check if first-time user is using Signpost Town\n        if (currentPlayer.firsttimeuser === true) {\n          console.log(' First-time user used Signpost Town, incrementing FTUE step');\n          \n          // Increment the FTUE step and wait for it to fully complete\n          const newFtueStep = await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n          \n          // Add a small delay to ensure the server has processed the update\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n          // Update the currentPlayer object with the new ftuestep to pass through location change\n          currentPlayer = { ...currentPlayer, ftuestep: newFtueStep };\n        }\n        \n        await changePlayerLocation(\n          currentPlayer,\n          currentPlayer.location,   // fromLocation\n          newPlayerPosition,        // toLocation\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          TILE_SIZE,\n          closeAllPanels,\n          updateStatus,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies\n        );\n        \n      } catch (error) {\n        console.error(\" Error traveling to town:\", error);\n        if (error.message && error.message.includes('Failed to remove player from previous grid')) {\n          updateStatus(\"Failed to leave current location. Please try again.\");\n        } else {\n          updateStatus(\"Error traveling to town\");\n        }\n      }\n      \n      return;\n    }\n\n    // 3) Regular signpost => Move directionally\n    console.log(\"Regular Signpost clicked. Calculating transit options dynamically.\");\n    const direction = resourceType.replace(\"Signpost \", \"\");\n    const offsets = {\n      N:  [-1,  0],\n      S:  [ 1,  0],\n      E:  [ 0,  1],\n      W:  [ 0, -1],\n      NE: [-1,  1],\n      SE: [ 1,  1],\n      SW: [ 1, -1],\n      NW: [-1, -1],\n    };\n\n    // 4) Fetch the current Settlement\n    const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n    const settlement = settlementResponse.data;\n    if (!settlement || !settlement.grids) {\n      console.error(\"Settlement data is invalid or missing grids.\"); updateStatus(105); return; }\n\n      // Find the sub-grid doc matching currentGridId\n    const currentGrid = settlement.grids.flat().find((grid) => grid.gridId === currentGridId);\n    if (!currentGrid) {\n      console.error(\"Current grid not found in settlement.\"); updateStatus(105); return; }\n\n      // 5) Decode the current gridCoord to get gRow/gCol\n    if (!currentGrid.gridCoord) {\n      console.error(\"No gridCoord found on current grid.\"); updateStatus(105); return; }\n\n    updateStatus(103); // \"Travelling ...\"\n\n    const { \n      frontierTier, frontierIndex, \n      setRow, setCol, gRow, gCol\n    } = decodeCoord(currentGrid.gridCoord); // Implement decodeCoord to match your system\n\n    // 6) Apply signpost offsets to sub-grid row/col\n    const [rowOffset, colOffset] = offsets[direction] || [0, 0];\n\n    let newGRow = gRow + rowOffset;\n    let newGCol = gCol + colOffset;\n    let newSetRow = setRow;\n    let newSetCol = setCol;\n\n    // 7) Check if crossing the local 8x8 sub-grid boundary\n    if (newGRow < 0) {\n      newGRow = 7;\n      newSetRow -= 1;\n    } else if (newGRow > 7) {\n      newGRow = 0;\n      newSetRow += 1;\n    }\n\n    if (newGCol < 0) {\n      newGCol = 7;\n      newSetCol -= 1;\n    } else if (newGCol > 7) {\n      newGCol = 0;\n      newSetCol += 1;\n    }\n\n    // 8) Verify we can still stay in bounds of the settlement array (0..7 for setRow/setCol)\n    if (newSetRow < 0 || newSetRow > 7 || newSetCol < 0 || newSetCol > 7) {\n      updateStatus(106); // \"Can't travel beyond frontier\"\n      return;\n    }\n\n    // 9) Fetch the new settlement if setRow/setCol changed\n    //    If your server has an endpoint like get-settlement-by-coords/:row/:col, do that:\n    const targetSettlementResponse = await axios.get(\n      `${API_BASE}/api/get-settlement-by-coords/${newSetRow}/${newSetCol}`\n    );\n    const targetSettlement = targetSettlementResponse.data;\n    if (!targetSettlement || !targetSettlement.grids) {\n      console.warn(\"Target settlement not found or invalid.\");\n      updateStatus(105);\n      return;\n    }\n \n    // 10) Find the sub-grid at newGRow/newGCol\n    const targetGrid = targetSettlement.grids[newGRow][newGCol];\n    console.log('targetGrid = ',targetGrid);\n    if (!targetGrid?.gridId) {\n      updateStatus(18);\n      return;\n    }\n\n    // 11) Get the entry position based on the direction traveled\n    let entryPosition;\n    const playerId = currentPlayer._id?.toString();\n    const gridId = currentPlayer.location?.g;\n    const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    const fromX = playerData?.position?.x ?? 0;\n    const fromY = playerData?.position?.y ?? 0;\n    console.log(\"Current player position:\", { x: fromX, y: fromY });\n    console.log(\"Direction:\", direction);\n\n    if ([\"E\", \"W\"].includes(direction)) {\n      // Preserve row (Y) when moving left/right\n      entryPosition = {\n        x: direction === \"E\" ? 0 : 63,\n        y: fromY\n      };\n      console.log(\"Preserving row (Y) for E/W direction:\", entryPosition);\n    } else if ([\"N\", \"S\"].includes(direction)) {\n      // Preserve column (X) when moving up/down\n      entryPosition = {\n        x: fromX,\n        y: direction === \"N\" ? 63 : 0\n      };\n      console.log(\"Preserving column (X) for N/S direction:\", entryPosition);\n    } else {\n      // Fallback to existing logic for diagonals and non-cardinal directions\n      entryPosition = getEntryPosition(direction);\n    }\n\n    // 12) Finally, update the player location\n    const newPlayerPosition = {\n      x: entryPosition.x,\n      y: entryPosition.y,\n      g: targetGrid.gridId,\n      s: targetSettlement._id,\n      f: frontierId,\n      gtype: targetGrid.gridType,\n      gridCoord: targetGrid.gridCoord,\n    };\n \n    await changePlayerLocation(\n      currentPlayer,\n      currentPlayer.location,   // fromLocation\n      newPlayerPosition,        // toLocation\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      TILE_SIZE,\n      closeAllPanels,\n      updateStatus,\n      bulkOperationContext,\n      masterResources,\n      strings,\n      masterTrophies\n    );\n\n    console.log(`Player moved to grid ID: ${targetGrid.gridId}`);\n  } catch (error) {\n    console.error(\"Error handling transit:\", error.message || error);\n    updateStatus(\"Error during travel.\");\n  }\n}\n\n// Example decode function (adjust to match your chosen gridCoord structure)\nfunction decodeCoord(coord) {\n  const str = coord.toString().padStart(8, '0');\n  return {\n    frontierTier:  parseInt(str.slice(0, 2), 10), // first 2 digits\n    frontierIndex: parseInt(str.slice(2, 4), 10), // next 2 digits\n    setRow:        parseInt(str.slice(4, 5), 10), // next 1 digit\n    setCol:        parseInt(str.slice(5, 6), 10), // next 1 digit\n    gRow:          parseInt(str.slice(6, 7), 10), // next 1 digit\n    gCol:          parseInt(str.slice(7, 8), 10), // last 1 digit\n  };\n}\n","/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),ca=require(\"scheduler\");function p(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var da=new Set,ea={};function fa(a,b){ha(a,b);ha(a+\"Capture\",b)}\nfunction ha(a,b){ea[a]=b;for(a=0;a<b.length;a++)da.add(b[a])}\nvar ia=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,la=\n{},ma={};function oa(a){if(ja.call(ma,a))return!0;if(ja.call(la,a))return!1;if(ka.test(a))return ma[a]=!0;la[a]=!0;return!1}function pa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction qa(a,b,c,d){if(null===b||\"undefined\"===typeof b||pa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var z={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){z[a]=new v(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];z[b]=new v(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){z[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){z[a]=new v(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){z[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){z[a]=new v(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){z[a]=new v(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){z[a]=new v(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){z[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(ra,\nsa);z[b]=new v(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)});\nz.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction ta(a,b,c,d){var e=z.hasOwnProperty(b)?z[b]:null;if(null!==e?0!==e.type:d||!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1])qa(b,c,e,d)&&(c=null),d||null===e?oa(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c)))}\nvar ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for(\"react.element\"),wa=Symbol.for(\"react.portal\"),ya=Symbol.for(\"react.fragment\"),za=Symbol.for(\"react.strict_mode\"),Aa=Symbol.for(\"react.profiler\"),Ba=Symbol.for(\"react.provider\"),Ca=Symbol.for(\"react.context\"),Da=Symbol.for(\"react.forward_ref\"),Ea=Symbol.for(\"react.suspense\"),Fa=Symbol.for(\"react.suspense_list\"),Ga=Symbol.for(\"react.memo\"),Ha=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");Symbol.for(\"react.debug_trace_mode\");\nvar Ia=Symbol.for(\"react.offscreen\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.cache\");Symbol.for(\"react.tracing_marker\");var Ja=Symbol.iterator;function Ka(a){if(null===a||\"object\"!==typeof a)return null;a=Ja&&a[Ja]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var A=Object.assign,La;function Ma(a){if(void 0===La)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);La=b&&b[1]||\"\"}return\"\\n\"+La+a}var Na=!1;\nfunction Oa(a,b){if(!a||Na)return\"\";Na=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(l){var d=l}Reflect.construct(a,[],b)}else{try{b.call()}catch(l){d=l}a.call(b.prototype)}else{try{throw Error();}catch(l){d=l}a()}}catch(l){if(l&&d&&\"string\"===typeof l.stack){for(var e=l.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h]){var k=\"\\n\"+e[g].replace(\" at new \",\" at \");a.displayName&&k.includes(\"<anonymous>\")&&(k=k.replace(\"<anonymous>\",a.displayName));return k}while(1<=g&&0<=h)}break}}}finally{Na=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Ma(a):\"\"}\nfunction Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma(\"Lazy\");case 13:return Ma(\"Suspense\");case 19:return Ma(\"SuspenseList\");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return\"\"}}\nfunction Qa(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ya:return\"Fragment\";case wa:return\"Portal\";case Aa:return\"Profiler\";case za:return\"StrictMode\";case Ea:return\"Suspense\";case Fa:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case Ca:return(a.displayName||\"Context\")+\".Consumer\";case Ba:return(a._context.displayName||\"Context\")+\".Provider\";case Da:var b=a.render;a=a.displayName;a||(a=b.displayName||\nb.name||\"\",a=\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");return a;case Ga:return b=a.displayName||null,null!==b?b:Qa(a.type)||\"Memo\";case Ha:b=a._payload;a=a._init;try{return Qa(a(b))}catch(c){}}return null}\nfunction Ra(a){var b=a.type;switch(a.tag){case 24:return\"Cache\";case 9:return(b.displayName||\"Context\")+\".Consumer\";case 10:return(b._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return a=b.render,a=a.displayName||a.name||\"\",b.displayName||(\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return b;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Qa(b);case 8:return b===za?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";\ncase 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(\"function\"===typeof b)return b.displayName||b.name||null;if(\"string\"===typeof b)return b}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"string\":case \"undefined\":return a;case \"object\":return a;default:return\"\"}}\nfunction Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function ab(a,b){b=b.checked;null!=b&&ta(a,\"checked\",b,!1)}\nfunction bb(a,b){ab(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?cb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&cb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction db(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction cb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var eb=Array.isArray;\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(p(91));return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(p(92));if(eb(c)){if(1<c.length)throw Error(p(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}function kb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}\nfunction lb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?kb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar mb,nb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(\"http://www.w3.org/2000/svg\"!==a.namespaceURI||\"innerHTML\"in a)a.innerHTML=b;else{mb=mb||document.createElement(\"div\");mb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction ob(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,\nzoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(pb).forEach(function(a){qb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);pb[b]=pb[a]})});function rb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||pb.hasOwnProperty(a)&&pb[a]?(\"\"+b).trim():b+\"px\"}\nfunction sb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=rb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ub(a,b){if(b){if(tb[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(p(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(p(60));if(\"object\"!==typeof b.dangerouslySetInnerHTML||!(\"__html\"in b.dangerouslySetInnerHTML))throw Error(p(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(p(62));}}\nfunction vb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var wb=null;function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(p(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(){}var Ib=!1;function Jb(a,b,c){if(Ib)return a(b,c);Ib=!0;try{return Gb(a,b,c)}finally{if(Ib=!1,null!==zb||null!==Ab)Hb(),Fb()}}\nfunction Kb(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(p(231,b,typeof c));return c}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,\"passive\",{get:function(){Lb=!0}});window.addEventListener(\"test\",Mb,Mb);window.removeEventListener(\"test\",Mb,Mb)}catch(a){Lb=!1}function Nb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0;Pb=a}};function Tb(a,b,c,d,e,f,g,h,k){Ob=!1;Pb=null;Nb.apply(Sb,arguments)}\nfunction Ub(a,b,c,d,e,f,g,h,k){Tb.apply(this,arguments);if(Ob){if(Ob){var l=Pb;Ob=!1;Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=l)}}function Vb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&4098)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Wb(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p(188));}\nfunction Yb(a){var b=a.alternate;if(!b){b=Vb(a);if(null===b)throw Error(p(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Xb(e),a;if(f===d)return Xb(e),b;f=f.sibling}throw Error(p(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(p(189));}}if(c.alternate!==d)throw Error(p(190));}if(3!==c.tag)throw Error(p(188));return c.stateNode.current===c?a:b}function Zb(a){a=Yb(a);return null!==a?$b(a):null}function $b(a){if(5===a.tag||6===a.tag)return a;for(a=a.child;null!==a;){var b=$b(a);if(null!==b)return b;a=a.sibling}return null}\nvar ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&\"function\"===typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,a,void 0,128===(a.current.flags&128))}catch(b){}}\nvar oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){a>>>=0;return 0===a?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;\nfunction tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;\ndefault:return a}}function uc(a,b){var c=a.pendingLanes;if(0===c)return 0;var d=0,e=a.suspendedLanes,f=a.pingedLanes,g=c&268435455;if(0!==g){var h=g&~e;0!==h?d=tc(h):(f&=g,0!==f&&(d=tc(f)))}else g=c&~e,0!==g?d=tc(g):0!==f&&(d=tc(f));if(0===d)return 0;if(0!==b&&b!==d&&0===(b&e)&&(e=d&-d,f=b&-b,e>=f||16===e&&0!==(f&4194240)))return b;0!==(d&4)&&(d|=c&16);b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-oc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction vc(a,b){switch(a){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}\nfunction wc(a,b){for(var c=a.suspendedLanes,d=a.pingedLanes,e=a.expirationTimes,f=a.pendingLanes;0<f;){var g=31-oc(f),h=1<<g,k=e[g];if(-1===k){if(0===(h&c)||0!==(h&d))e[g]=vc(h,b)}else k<=b&&(a.expiredLanes|=h);f&=~h}}function xc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function yc(){var a=rc;rc<<=1;0===(rc&4194240)&&(rc=64);return a}function zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction Ac(a,b,c){a.pendingLanes|=b;536870912!==b&&(a.suspendedLanes=0,a.pingedLanes=0);a=a.eventTimes;b=31-oc(b);a[b]=c}function Bc(a,b){var c=a.pendingLanes&~b;a.pendingLanes=b;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=b;a.mutableReadLanes&=b;a.entangledLanes&=b;b=a.entanglements;var d=a.eventTimes;for(a=a.expirationTimes;0<c;){var e=31-oc(c),f=1<<e;b[e]=0;d[e]=-1;a[e]=-1;c&=~f}}\nfunction Cc(a,b){var c=a.entangledLanes|=b;for(a=a.entanglements;c;){var d=31-oc(c),e=1<<d;e&b|a[d]&b&&(a[d]|=b);c&=~e}}var C=0;function Dc(a){a&=-a;return 1<a?4<a?0!==(a&268435455)?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction Sc(a,b){switch(a){case \"focusin\":case \"focusout\":Lc=null;break;case \"dragenter\":case \"dragleave\":Mc=null;break;case \"mouseover\":case \"mouseout\":Nc=null;break;case \"pointerover\":case \"pointerout\":Oc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Pc.delete(b.pointerId)}}\nfunction Tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a={blockedOn:b,domEventName:c,eventSystemFlags:d,nativeEvent:f,targetContainers:[e]},null!==b&&(b=Cb(b),null!==b&&Fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction Uc(a,b,c,d,e){switch(b){case \"focusin\":return Lc=Tc(Lc,a,b,c,d,e),!0;case \"dragenter\":return Mc=Tc(Mc,a,b,c,d,e),!0;case \"mouseover\":return Nc=Tc(Nc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Oc.set(f,Tc(Oc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Pc.set(f,Tc(Pc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Vc(a){var b=Wc(a.target);if(null!==b){var c=Vb(b);if(null!==c)if(b=c.tag,13===b){if(b=Wb(c),null!==b){a.blockedOn=b;Ic(a.priority,function(){Gc(c)});return}}else if(3===b&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction Xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=Yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null===c){c=a.nativeEvent;var d=new c.constructor(c.type,c);wb=d;c.target.dispatchEvent(d);wb=null}else return b=Cb(c),null!==b&&Fc(b),a.blockedOn=c,!1;b.shift()}return!0}function Zc(a,b,c){Xc(a)&&c.delete(b)}function $c(){Jc=!1;null!==Lc&&Xc(Lc)&&(Lc=null);null!==Mc&&Xc(Mc)&&(Mc=null);null!==Nc&&Xc(Nc)&&(Nc=null);Oc.forEach(Zc);Pc.forEach(Zc)}\nfunction ad(a,b){a.blockedOn===b&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}\nfunction bd(a){function b(b){return ad(b,a)}if(0<Kc.length){ad(Kc[0],a);for(var c=1;c<Kc.length;c++){var d=Kc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Lc&&ad(Lc,a);null!==Mc&&ad(Mc,a);null!==Nc&&ad(Nc,a);Oc.forEach(b);Pc.forEach(b);for(c=0;c<Qc.length;c++)d=Qc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Qc.length&&(c=Qc[0],null===c.blockedOn);)Vc(c),null===c.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;\nfunction ed(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=1,fd(a,b,c,d)}finally{C=e,cd.transition=f}}function gd(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=4,fd(a,b,c,d)}finally{C=e,cd.transition=f}}\nfunction fd(a,b,c,d){if(dd){var e=Yc(a,b,c,d);if(null===e)hd(a,b,d,id,c),Sc(a,d);else if(Uc(e,a,b,c,d))d.stopPropagation();else if(Sc(a,d),b&4&&-1<Rc.indexOf(a)){for(;null!==e;){var f=Cb(e);null!==f&&Ec(f);f=Yc(a,b,c,d);null===f&&hd(a,b,d,id,c);if(f===e)break;e=f}null!==e&&d.stopPropagation()}else hd(a,b,d,null,c)}}var id=null;\nfunction Yc(a,b,c,d){id=null;a=xb(d);a=Wc(a);if(null!==a)if(b=Vb(a),null===b)a=null;else if(c=b.tag,13===c){a=Wb(b);if(null!==a)return a;a=null}else if(3===c){if(b.stateNode.current.memoizedState.isDehydrated)return 3===b.tag?b.stateNode.containerInfo:null;a=null}else b!==a&&(a=null);id=a;return null}\nfunction jd(a){switch(a){case \"cancel\":case \"click\":case \"close\":case \"contextmenu\":case \"copy\":case \"cut\":case \"auxclick\":case \"dblclick\":case \"dragend\":case \"dragstart\":case \"drop\":case \"focusin\":case \"focusout\":case \"input\":case \"invalid\":case \"keydown\":case \"keypress\":case \"keyup\":case \"mousedown\":case \"mouseup\":case \"paste\":case \"pause\":case \"play\":case \"pointercancel\":case \"pointerdown\":case \"pointerup\":case \"ratechange\":case \"reset\":case \"resize\":case \"seeked\":case \"submit\":case \"touchcancel\":case \"touchend\":case \"touchstart\":case \"volumechange\":case \"change\":case \"selectionchange\":case \"textInput\":case \"compositionstart\":case \"compositionend\":case \"compositionupdate\":case \"beforeblur\":case \"afterblur\":case \"beforeinput\":case \"blur\":case \"fullscreenchange\":case \"focus\":case \"hashchange\":case \"popstate\":case \"select\":case \"selectstart\":return 1;case \"drag\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"mousemove\":case \"mouseout\":case \"mouseover\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"scroll\":case \"toggle\":case \"touchmove\":case \"wheel\":case \"mouseenter\":case \"mouseleave\":case \"pointerenter\":case \"pointerleave\":return 4;\ncase \"message\":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}\nfunction od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}A(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=A({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&\"CompositionEvent\"in window,be=null;ia&&\"documentMode\"in document&&(be=document.documentMode);var ce=ia&&\"TextEvent\"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(ia){var xe;if(ia){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));Jb(re,b)}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge;\nfunction Ie(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var e=c[d];if(!ja.call(b,e)||!He(a[e],b[e]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Ke(a,b){var c=Je(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Je(c)}}function Le(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Le(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Me(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nfunction Oe(a){var b=Me(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&c&&c.ownerDocument&&Le(c.ownerDocument.documentElement,c)){if(null!==d&&Ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(a=(b=c.ownerDocument||document)&&b.defaultView||window,a.getSelection){a=a.getSelection();var e=c.textContent.length,f=Math.min(d.start,e);d=void 0===d.end?f:Math.min(d.end,e);!a.extend&&f>d&&(e=d,d=f,f=e);e=Ke(c,f);var g=Ke(c,\nd);e&&g&&(1!==a.rangeCount||a.anchorNode!==e.node||a.anchorOffset!==e.offset||a.focusNode!==g.node||a.focusOffset!==g.offset)&&(b=b.createRange(),b.setStart(e.node,e.offset),a.removeAllRanges(),f>d?(a.addRange(b),a.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),a.addRange(b)))}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});\"function\"===typeof c.focus&&c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}\nvar Pe=ia&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nfunction Ve(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var We={animationend:Ve(\"Animation\",\"AnimationEnd\"),animationiteration:Ve(\"Animation\",\"AnimationIteration\"),animationstart:Ve(\"Animation\",\"AnimationStart\"),transitionend:Ve(\"Transition\",\"TransitionEnd\")},Xe={},Ye={};\nia&&(Ye=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),\"TransitionEvent\"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var b=We[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Ye)return Xe[a]=b[c];return a}var $e=Ze(\"animationend\"),af=Ze(\"animationiteration\"),bf=Ze(\"animationstart\"),cf=Ze(\"transitionend\"),df=new Map,ef=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");\nfunction ff(a,b){df.set(a,b);fa(b,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,\"on\"+kf)}ff($e,\"onAnimationEnd\");ff(af,\"onAnimationIteration\");ff(bf,\"onAnimationStart\");ff(\"dblclick\",\"onDoubleClick\");ff(\"focusin\",\"onFocus\");ff(\"focusout\",\"onBlur\");ff(cf,\"onTransitionEnd\");ha(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);ha(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ha(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);\nha(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);fa(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));fa(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));fa(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);fa(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));fa(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));\nfa(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var lf=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),mf=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(lf));\nfunction nf(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Ub(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a;}\nfunction D(a,b){var c=b[of];void 0===c&&(c=b[of]=new Set);var d=a+\"__bubble\";c.has(d)||(pf(b,a,2,!1),c.add(d))}function qf(a,b,c){var d=0;b&&(d|=4);pf(c,a,d,b)}var rf=\"_reactListening\"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0;da.forEach(function(b){\"selectionchange\"!==b&&(mf.has(b)||qf(b,!1,a),qf(b,!0,a))});var b=9===a.nodeType?a:a.ownerDocument;null===b||b[rf]||(b[rf]=!0,qf(\"selectionchange\",!1,b))}}\nfunction pf(a,b,c,d){switch(jd(b)){case 1:var e=ed;break;case 4:e=gd;break;default:e=fd}c=e.bind(null,b,c,a);e=void 0;!Lb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction hd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=Wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Jb(function(){var d=f,e=xb(c),g=[];\na:{var h=df.get(a);if(void 0!==h){var k=td,n=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":n=\"focus\";k=Fd;break;case \"focusout\":n=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case $e:case af:case bf:k=Hd;break;case cf:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var t=0!==(b&4),J=!t&&\"scroll\"===a,x=t?null!==h?h+\"Capture\":null:h;t=[];for(var w=d,u;null!==\nw;){u=w;var F=u.stateNode;5===u.tag&&null!==F&&(u=F,null!==x&&(F=Kb(w,x),null!=F&&t.push(tf(w,F,u))));if(J)break;w=w.return}0<t.length&&(h=new k(h,n,null,c,e),g.push({event:h,listeners:t}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&c!==wb&&(n=c.relatedTarget||c.fromElement)&&(Wc(n)||n[uf]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(n=c.relatedTarget||c.toElement,k=d,n=n?Wc(n):null,null!==\nn&&(J=Vb(n),n!==J||5!==n.tag&&6!==n.tag))n=null}else k=null,n=d;if(k!==n){t=Bd;F=\"onMouseLeave\";x=\"onMouseEnter\";w=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)t=Td,F=\"onPointerLeave\",x=\"onPointerEnter\",w=\"pointer\";J=null==k?h:ue(k);u=null==n?h:ue(n);h=new t(F,w+\"leave\",k,c,e);h.target=J;h.relatedTarget=u;F=null;Wc(e)===d&&(t=new t(x,w+\"enter\",n,c,e),t.target=u,t.relatedTarget=J,F=t);J=F;if(k&&n)b:{t=k;x=n;w=0;for(u=t;u;u=vf(u))w++;u=0;for(F=x;F;F=vf(F))u++;for(;0<w-u;)t=vf(t),w--;for(;0<u-w;)x=\nvf(x),u--;for(;w--;){if(t===x||null!==x&&t===x.alternate)break b;t=vf(t);x=vf(x)}t=null}else t=null;null!==k&&wf(g,h,k,t,!1);null!==n&&null!==J&&wf(g,J,n,t,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var na=ve;else if(me(h))if(we)na=Fe;else{na=De;var xa=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(na=Ee);if(na&&(na=na(a,d))){ne(g,na,c,e);break a}xa&&xa(a,h,d);\"focusout\"===a&&(xa=h._wrapperState)&&\nxa.controlled&&\"number\"===h.type&&cb(h,\"number\",h.value)}xa=d?ue(d):window;switch(a){case \"focusin\":if(me(xa)||\"true\"===xa.contentEditable)Qe=xa,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var $a;if(ae)b:{switch(a){case \"compositionstart\":var ba=\"onCompositionStart\";break b;case \"compositionend\":ba=\"onCompositionEnd\";\nbreak b;case \"compositionupdate\":ba=\"onCompositionUpdate\";break b}ba=void 0}else ie?ge(a,c)&&(ba=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(ba=\"onCompositionStart\");ba&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==ba?\"onCompositionEnd\"===ba&&ie&&($a=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),xa=oe(d,ba),0<xa.length&&(ba=new Ld(ba,a,null,c,e),g.push({event:ba,listeners:xa}),$a?ba.data=$a:($a=he(c),null!==$a&&(ba.data=$a))));if($a=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),\n0<d.length&&(e=new Ld(\"onBeforeInput\",\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=$a)}se(g,b)})}function tf(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Kb(a,c),null!=f&&d.unshift(tf(a,f,e)),f=Kb(a,b),null!=f&&d.push(tf(a,f,e)));a=a.return}return d}function vf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction wf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Kb(c,f),null!=k&&g.unshift(tf(c,k,h))):e||(k=Kb(c,f),null!=k&&g.push(tf(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}var xf=/\\r\\n?/g,yf=/\\u0000|\\uFFFD/g;function zf(a){return(\"string\"===typeof a?a:\"\"+a).replace(xf,\"\\n\").replace(yf,\"\")}function Af(a,b,c){b=zf(b);if(zf(a)!==b&&c)throw Error(p(425));}function Bf(){}\nvar Cf=null,Df=null;function Ef(a,b){return\"textarea\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}\nvar Ff=\"function\"===typeof setTimeout?setTimeout:void 0,Gf=\"function\"===typeof clearTimeout?clearTimeout:void 0,Hf=\"function\"===typeof Promise?Promise:void 0,Jf=\"function\"===typeof queueMicrotask?queueMicrotask:\"undefined\"!==typeof Hf?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a;})}\nfunction Kf(a,b){var c=b,d=0;do{var e=c.nextSibling;a.removeChild(c);if(e&&8===e.nodeType)if(c=e.data,\"/$\"===c){if(0===d){a.removeChild(e);bd(b);return}d--}else\"$\"!==c&&\"$?\"!==c&&\"$!\"!==c||d++;c=e}while(c);bd(b)}function Lf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break;if(8===b){b=a.data;if(\"$\"===b||\"$!\"===b||\"$?\"===b)break;if(\"/$\"===b)return null}}return a}\nfunction Mf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of=\"__reactFiber$\"+Nf,Pf=\"__reactProps$\"+Nf,uf=\"__reactContainer$\"+Nf,of=\"__reactEvents$\"+Nf,Qf=\"__reactListeners$\"+Nf,Rf=\"__reactHandles$\"+Nf;\nfunction Wc(a){var b=a[Of];if(b)return b;for(var c=a.parentNode;c;){if(b=c[uf]||c[Of]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Mf(a);null!==a;){if(c=a[Of])return c;a=Mf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[Of]||a[uf];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(p(33));}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}\nfunction E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,b){Tf++;Sf[Tf]=a.current;a.current=b}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,b){var c=a.type.contextTypes;if(!c)return Vf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}\nfunction Zf(a){a=a.childContextTypes;return null!==a&&void 0!==a}function $f(){E(Wf);E(H)}function ag(a,b,c){if(H.current!==Vf)throw Error(p(168));G(H,b);G(Wf,c)}function bg(a,b,c){var d=a.stateNode;b=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in b))throw Error(p(108,Ra(a)||\"Unknown\",e));return A({},c,d)}\nfunction cg(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf;Xf=H.current;G(H,a);G(Wf,Wf.current);return!0}function dg(a,b,c){var d=a.stateNode;if(!d)throw Error(p(169));c?(a=bg(a,b,Xf),d.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf);G(Wf,c)}var eg=null,fg=!1,gg=!1;function hg(a){null===eg?eg=[a]:eg.push(a)}function ig(a){fg=!0;hg(a)}\nfunction jg(){if(!gg&&null!==eg){gg=!0;var a=0,b=C;try{var c=eg;for(C=1;a<c.length;a++){var d=c[a];do d=d(!0);while(null!==d)}eg=null;fg=!1}catch(e){throw null!==eg&&(eg=eg.slice(a+1)),ac(fc,jg),e;}finally{C=b,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg=\"\";function tg(a,b){kg[lg++]=ng;kg[lg++]=mg;mg=a;ng=b}\nfunction ug(a,b,c){og[pg++]=rg;og[pg++]=sg;og[pg++]=qg;qg=a;var d=rg;a=sg;var e=32-oc(d)-1;d&=~(1<<e);c+=1;var f=32-oc(b)+e;if(30<f){var g=e-e%5;f=(d&(1<<g)-1).toString(32);d>>=g;e-=g;rg=1<<32-oc(b)+e|c<<e|d;sg=f+a}else rg=1<<f|c<<e|d,sg=a}function vg(a){null!==a.return&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;\nfunction Ag(a,b){var c=Bg(5,null,null,0);c.elementType=\"DELETED\";c.stateNode=b;c.return=a;b=a.deletions;null===b?(a.deletions=[c],a.flags|=16):b.push(c)}\nfunction Cg(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,xg=a,yg=Lf(b.firstChild),!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,xg=a,yg=null,!0):!1;case 13:return b=8!==b.nodeType?null:b,null!==b?(c=null!==qg?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:b,treeContext:c,retryLane:1073741824},c=Bg(18,null,null,0),c.stateNode=b,c.return=a,a.child=c,xg=a,yg=\nnull,!0):!1;default:return!1}}function Dg(a){return 0!==(a.mode&1)&&0===(a.flags&128)}function Eg(a){if(I){var b=yg;if(b){var c=b;if(!Cg(a,b)){if(Dg(a))throw Error(p(418));b=Lf(c.nextSibling);var d=xg;b&&Cg(a,b)?Ag(d,c):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p(418));a.flags=a.flags&-4097|2;I=!1;xg=a}}}function Fg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;xg=a}\nfunction Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var b;(b=3!==a.tag)&&!(b=5!==a.tag)&&(b=a.type,b=\"head\"!==b&&\"body\"!==b&&!Ef(a.type,a.memoizedProps));if(b&&(b=yg)){if(Dg(a))throw Hg(),Error(p(418));for(;b;)Ag(a,b),b=Lf(b.nextSibling)}Fg(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(p(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){yg=Lf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}yg=\nnull}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null;I=!1}function Jg(a){null===zg?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;\nfunction Lg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(p(309));var d=c.stateNode}if(!d)throw Error(p(147,a));var e=d,f=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===f)return b.ref;b=function(a){var b=e.refs;null===a?delete b[f]:b[f]=a};b._stringRef=f;return b}if(\"string\"!==typeof a)throw Error(p(284));if(!c._owner)throw Error(p(290,a));}return a}\nfunction Mg(a,b){a=Object.prototype.toString.call(b);throw Error(p(31,\"[object Object]\"===a?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":a));}function Ng(a){var b=a._init;return b(a._payload)}\nfunction Og(a){function b(b,c){if(a){var d=b.deletions;null===d?(b.deletions=[c],b.flags|=16):d.push(c)}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Pg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return b.flags|=1048576,c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags|=2,c):d;b.flags|=2;return c}function g(b){a&&\nnull===b.alternate&&(b.flags|=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Qg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){var f=c.type;if(f===ya)return m(a,b,c.props.children,d,c.key);if(null!==b&&(b.elementType===f||\"object\"===typeof f&&null!==f&&f.$$typeof===Ha&&Ng(f)===b.type))return d=e(b,c.props),d.ref=Lg(a,b,c),d.return=a,d;d=Rg(c.type,c.key,c.props,null,a.mode,d);d.ref=Lg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||\nb.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=Sg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Tg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b&&\"\"!==b||\"number\"===typeof b)return b=Qg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case va:return c=Rg(b.type,b.key,b.props,null,a.mode,c),\nc.ref=Lg(a,null,b),c.return=a,c;case wa:return b=Sg(b,a.mode,c),b.return=a,b;case Ha:var d=b._init;return q(a,d(b._payload),c)}if(eb(b)||Ka(b))return b=Tg(b,a.mode,c,null),b.return=a,b;Mg(a,b)}return null}function r(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c&&\"\"!==c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case va:return c.key===e?k(a,b,c,d):null;case wa:return c.key===e?l(a,b,c,d):null;case Ha:return e=c._init,r(a,\nb,e(c._payload),d)}if(eb(c)||Ka(c))return null!==e?null:m(a,b,c,d,null);Mg(a,c)}return null}function y(a,b,c,d,e){if(\"string\"===typeof d&&\"\"!==d||\"number\"===typeof d)return a=a.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case va:return a=a.get(null===d.key?c:d.key)||null,k(b,a,d,e);case wa:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e);case Ha:var f=d._init;return y(a,b,c,f(d._payload),e)}if(eb(d)||Ka(d))return a=a.get(c)||null,m(b,a,d,e,null);Mg(b,d)}return null}\nfunction n(e,g,h,k){for(var l=null,m=null,u=g,w=g=0,x=null;null!==u&&w<h.length;w++){u.index>w?(x=u,u=null):x=u.sibling;var n=r(e,u,h[w],k);if(null===n){null===u&&(u=x);break}a&&u&&null===n.alternate&&b(e,u);g=f(n,g,w);null===m?l=n:m.sibling=n;m=n;u=x}if(w===h.length)return c(e,u),I&&tg(e,w),l;if(null===u){for(;w<h.length;w++)u=q(e,h[w],k),null!==u&&(g=f(u,g,w),null===m?l=u:m.sibling=u,m=u);I&&tg(e,w);return l}for(u=d(e,u);w<h.length;w++)x=y(u,e,w,h[w],k),null!==x&&(a&&null!==x.alternate&&u.delete(null===\nx.key?w:x.key),g=f(x,g,w),null===m?l=x:m.sibling=x,m=x);a&&u.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function t(e,g,h,k){var l=Ka(h);if(\"function\"!==typeof l)throw Error(p(150));h=l.call(h);if(null==h)throw Error(p(151));for(var u=l=null,m=g,w=g=0,x=null,n=h.next();null!==m&&!n.done;w++,n=h.next()){m.index>w?(x=m,m=null):x=m.sibling;var t=r(e,m,n.value,k);if(null===t){null===m&&(m=x);break}a&&m&&null===t.alternate&&b(e,m);g=f(t,g,w);null===u?l=t:u.sibling=t;u=t;m=x}if(n.done)return c(e,\nm),I&&tg(e,w),l;if(null===m){for(;!n.done;w++,n=h.next())n=q(e,n.value,k),null!==n&&(g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);I&&tg(e,w);return l}for(m=d(e,m);!n.done;w++,n=h.next())n=y(m,e,w,n.value,k),null!==n&&(a&&null!==n.alternate&&m.delete(null===n.key?w:n.key),g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);a&&m.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function J(a,d,f,h){\"object\"===typeof f&&null!==f&&f.type===ya&&null===f.key&&(f=f.props.children);if(\"object\"===typeof f&&null!==f){switch(f.$$typeof){case va:a:{for(var k=\nf.key,l=d;null!==l;){if(l.key===k){k=f.type;if(k===ya){if(7===l.tag){c(a,l.sibling);d=e(l,f.props.children);d.return=a;a=d;break a}}else if(l.elementType===k||\"object\"===typeof k&&null!==k&&k.$$typeof===Ha&&Ng(k)===l.type){c(a,l.sibling);d=e(l,f.props);d.ref=Lg(a,l,f);d.return=a;a=d;break a}c(a,l);break}else b(a,l);l=l.sibling}f.type===ya?(d=Tg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Rg(f.type,f.key,f.props,null,a.mode,h),h.ref=Lg(a,d,f),h.return=a,a=h)}return g(a);case wa:a:{for(l=f.key;null!==\nd;){if(d.key===l)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=Sg(f,a.mode,h);d.return=a;a=d}return g(a);case Ha:return l=f._init,J(a,d,l(f._payload),h)}if(eb(f))return n(a,d,f,h);if(Ka(f))return t(a,d,f,h);Mg(a,f)}return\"string\"===typeof f&&\"\"!==f||\"number\"===typeof f?(f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):\n(c(a,d),d=Qg(f,a.mode,h),d.return=a,a=d),g(a)):c(a,d)}return J}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(a){var b=Wg.current;E(Wg);a._currentValue=b}function bh(a,b,c){for(;null!==a;){var d=a.alternate;(a.childLanes&b)!==b?(a.childLanes|=b,null!==d&&(d.childLanes|=b)):null!==d&&(d.childLanes&b)!==b&&(d.childLanes|=b);if(a===c)break;a=a.return}}\nfunction ch(a,b){Xg=a;Zg=Yg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(dh=!0),a.firstContext=null)}function eh(a){var b=a._currentValue;if(Zg!==a)if(a={context:a,memoizedValue:b,next:null},null===Yg){if(null===Xg)throw Error(p(308));Yg=a;Xg.dependencies={lanes:0,firstContext:a}}else Yg=Yg.next=a;return b}var fh=null;function gh(a){null===fh?fh=[a]:fh.push(a)}\nfunction hh(a,b,c,d){var e=b.interleaved;null===e?(c.next=c,gh(b)):(c.next=e.next,e.next=c);b.interleaved=c;return ih(a,d)}function ih(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}var jh=!1;function kh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}\nfunction lh(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mh(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}\nfunction nh(a,b,c){var d=a.updateQueue;if(null===d)return null;d=d.shared;if(0!==(K&2)){var e=d.pending;null===e?b.next=b:(b.next=e.next,e.next=b);d.pending=b;return ih(a,c)}e=d.interleaved;null===e?(b.next=b,gh(d)):(b.next=e.next,e.next=b);d.interleaved=b;return ih(a,c)}function oh(a,b,c){b=b.updateQueue;if(null!==b&&(b=b.shared,0!==(c&4194240))){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nfunction ph(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction qh(a,b,c,d){var e=a.updateQueue;jh=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var m=a.alternate;null!==m&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==g&&(null===h?m.firstBaseUpdate=l:h.next=l,m.lastBaseUpdate=k))}if(null!==f){var q=e.baseState;g=0;m=l=k=null;h=f;do{var r=h.lane,y=h.eventTime;if((d&r)===r){null!==m&&(m=m.next={eventTime:y,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,\nnext:null});a:{var n=a,t=h;r=b;y=c;switch(t.tag){case 1:n=t.payload;if(\"function\"===typeof n){q=n.call(y,q,r);break a}q=n;break a;case 3:n.flags=n.flags&-65537|128;case 0:n=t.payload;r=\"function\"===typeof n?n.call(y,q,r):n;if(null===r||void 0===r)break a;q=A({},q,r);break a;case 2:jh=!0}}null!==h.callback&&0!==h.lane&&(a.flags|=64,r=e.effects,null===r?e.effects=[h]:r.push(h))}else y={eventTime:y,lane:r,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===m?(l=m=y,k=q):m=m.next=y,g|=r;\nh=h.next;if(null===h)if(h=e.shared.pending,null===h)break;else r=h,h=r.next,r.next=null,e.lastBaseUpdate=r,e.shared.pending=null}while(1);null===m&&(k=q);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=m;b=e.shared.interleaved;if(null!==b){e=b;do g|=e.lane,e=e.next;while(e!==b)}else null===f&&(e.shared.lanes=0);rh|=g;a.lanes=g;a.memoizedState=q}}\nfunction sh(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(p(191,e));e.call(d)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(a){if(a===th)throw Error(p(174));return a}\nfunction yh(a,b){G(wh,b);G(vh,a);G(uh,th);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:lb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=lb(b,a)}E(uh);G(uh,b)}function zh(){E(uh);E(vh);E(wh)}function Ah(a){xh(wh.current);var b=xh(uh.current);var c=lb(b,a.type);b!==c&&(G(vh,a),G(uh,c))}function Bh(a){vh.current===a&&(E(uh),E(vh))}var L=Uf(0);\nfunction Ch(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&128))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var Dh=[];\nfunction Eh(){for(var a=0;a<Dh.length;a++)Dh[a]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321));}function Mh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Nh(a,b,c,d,e,f){Hh=f;M=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;Fh.current=null===a||null===a.memoizedState?Oh:Ph;a=c(d,e);if(Jh){f=0;do{Jh=!1;Kh=0;if(25<=f)throw Error(p(301));f+=1;O=N=null;b.updateQueue=null;Fh.current=Qh;a=c(d,e)}while(Jh)}Fh.current=Rh;b=null!==N&&null!==N.next;Hh=0;O=N=M=null;Ih=!1;if(b)throw Error(p(300));return a}function Sh(){var a=0!==Kh;Kh=0;return a}\nfunction Th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===O?M.memoizedState=O=a:O=O.next=a;return O}function Uh(){if(null===N){var a=M.alternate;a=null!==a?a.memoizedState:null}else a=N.next;var b=null===O?M.memoizedState:O.next;if(null!==b)O=b,N=a;else{if(null===a)throw Error(p(310));N=a;a={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null};null===O?M.memoizedState=O=a:O=O.next=a}return O}\nfunction Vh(a,b){return\"function\"===typeof b?b(a):b}\nfunction Wh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=N,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){f=e.next;d=d.baseState;var h=g=null,k=null,l=f;do{var m=l.lane;if((Hh&m)===m)null!==k&&(k=k.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),d=l.hasEagerState?l.eagerState:a(d,l.action);else{var q={lane:m,action:l.action,hasEagerState:l.hasEagerState,\neagerState:l.eagerState,next:null};null===k?(h=k=q,g=d):k=k.next=q;M.lanes|=m;rh|=m}l=l.next}while(null!==l&&l!==f);null===k?g=d:k.next=h;He(d,b.memoizedState)||(dh=!0);b.memoizedState=d;b.baseState=g;b.baseQueue=k;c.lastRenderedState=d}a=c.interleaved;if(null!==a){e=a;do f=e.lane,M.lanes|=f,rh|=f,e=e.next;while(e!==a)}else null===e&&(c.lanes=0);return[b.memoizedState,c.dispatch]}\nfunction Xh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(dh=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function Yh(){}\nfunction Zh(a,b){var c=M,d=Uh(),e=b(),f=!He(d.memoizedState,e);f&&(d.memoizedState=e,dh=!0);d=d.queue;$h(ai.bind(null,c,d,a),[a]);if(d.getSnapshot!==b||f||null!==O&&O.memoizedState.tag&1){c.flags|=2048;bi(9,ci.bind(null,c,d,e,b),void 0,null);if(null===Q)throw Error(p(349));0!==(Hh&30)||di(c,b,e)}return e}function di(a,b,c){a.flags|=16384;a={getSnapshot:b,value:c};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.stores=[a]):(c=b.stores,null===c?b.stores=[a]:c.push(a))}\nfunction ci(a,b,c,d){b.value=c;b.getSnapshot=d;ei(b)&&fi(a)}function ai(a,b,c){return c(function(){ei(b)&&fi(a)})}function ei(a){var b=a.getSnapshot;a=a.value;try{var c=b();return!He(a,c)}catch(d){return!0}}function fi(a){var b=ih(a,1);null!==b&&gi(b,a,1,-1)}\nfunction hi(a){var b=Th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:a};b.queue=a;a=a.dispatch=ii.bind(null,M,a);return[b.memoizedState,a]}\nfunction bi(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function ji(){return Uh().memoizedState}function ki(a,b,c,d){var e=Th();M.flags|=a;e.memoizedState=bi(1|b,c,void 0,void 0===d?null:d)}\nfunction li(a,b,c,d){var e=Uh();d=void 0===d?null:d;var f=void 0;if(null!==N){var g=N.memoizedState;f=g.destroy;if(null!==d&&Mh(d,g.deps)){e.memoizedState=bi(b,c,f,d);return}}M.flags|=a;e.memoizedState=bi(1|b,c,f,d)}function mi(a,b){return ki(8390656,8,a,b)}function $h(a,b){return li(2048,8,a,b)}function ni(a,b){return li(4,2,a,b)}function oi(a,b){return li(4,4,a,b)}\nfunction pi(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function qi(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return li(4,4,pi.bind(null,b,a),c)}function ri(){}function si(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction ti(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function ui(a,b,c){if(0===(Hh&21))return a.baseState&&(a.baseState=!1,dh=!0),a.memoizedState=c;He(c,b)||(c=yc(),M.lanes|=c,rh|=c,a.baseState=!0);return b}function vi(a,b){var c=C;C=0!==c&&4>c?c:4;a(!0);var d=Gh.transition;Gh.transition={};try{a(!1),b()}finally{C=c,Gh.transition=d}}function wi(){return Uh().memoizedState}\nfunction xi(a,b,c){var d=yi(a);c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,c);else if(c=hh(a,b,c,d),null!==c){var e=R();gi(c,a,d,e);Bi(c,b,d)}}\nfunction ii(a,b,c){var d=yi(a),e={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,e);else{var f=a.alternate;if(0===a.lanes&&(null===f||0===f.lanes)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.hasEagerState=!0;e.eagerState=h;if(He(h,g)){var k=b.interleaved;null===k?(e.next=e,gh(b)):(e.next=k.next,k.next=e);b.interleaved=e;return}}catch(l){}finally{}c=hh(a,b,e,d);null!==c&&(e=R(),gi(c,a,d,e),Bi(c,b,d))}}\nfunction zi(a){var b=a.alternate;return a===M||null!==b&&b===M}function Ai(a,b){Jh=Ih=!0;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}function Bi(a,b,c){if(0!==(c&4194240)){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nvar Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(a,b){Th().memoizedState=[a,void 0===b?null:b];return a},useContext:eh,useEffect:mi,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ki(4194308,\n4,pi.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ki(4194308,4,a,b)},useInsertionEffect:function(a,b){return ki(4,2,a,b)},useMemo:function(a,b){var c=Th();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=Th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};d.queue=a;a=a.dispatch=xi.bind(null,M,a);return[d.memoizedState,a]},useRef:function(a){var b=\nTh();a={current:a};return b.memoizedState=a},useState:hi,useDebugValue:ri,useDeferredValue:function(a){return Th().memoizedState=a},useTransition:function(){var a=hi(!1),b=a[0];a=vi.bind(null,a[1]);Th().memoizedState=a;return[b,a]},useMutableSource:function(){},useSyncExternalStore:function(a,b,c){var d=M,e=Th();if(I){if(void 0===c)throw Error(p(407));c=c()}else{c=b();if(null===Q)throw Error(p(349));0!==(Hh&30)||di(d,b,c)}e.memoizedState=c;var f={value:c,getSnapshot:b};e.queue=f;mi(ai.bind(null,d,\nf,a),[a]);d.flags|=2048;bi(9,ci.bind(null,d,f,c,b),void 0,null);return c},useId:function(){var a=Th(),b=Q.identifierPrefix;if(I){var c=sg;var d=rg;c=(d&~(1<<32-oc(d)-1)).toString(32)+c;b=\":\"+b+\"R\"+c;c=Kh++;0<c&&(b+=\"H\"+c.toString(32));b+=\":\"}else c=Lh++,b=\":\"+b+\"r\"+c.toString(32)+\":\";return a.memoizedState=b},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},\nuseDebugValue:ri,useDeferredValue:function(a){var b=Uh();return ui(b,N.memoizedState,a)},useTransition:function(){var a=Wh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(a){var b=Uh();return null===\nN?b.memoizedState=a:ui(b,N.memoizedState,a)},useTransition:function(){var a=Xh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(a,b){if(a&&a.defaultProps){b=A({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}function Di(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:A({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar Ei={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=R(),d=\nyi(a),e=mh(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=b);b=nh(a,e,d);null!==b&&(gi(b,a,d,c),oh(b,a,d))}};function Fi(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ie(c,d)||!Ie(e,f):!0}\nfunction Gi(a,b,c){var d=!1,e=Vf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=eh(f):(e=Zf(b)?Xf:H.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Yf(a,e):Vf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Ei;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Hi(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Ei.enqueueReplaceState(b,b.state,null)}\nfunction Ii(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs={};kh(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=eh(f):(f=Zf(b)?Xf:H.current,e.context=Yf(a,f));e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Di(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(b=e.state,\n\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Ei.enqueueReplaceState(e,e.state,null),qh(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4194308)}function Ji(a,b){try{var c=\"\",d=b;do c+=Pa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e,digest:null}}\nfunction Ki(a,b,c){return{value:a,source:null,stack:null!=c?c:null,digest:null!=b?b:null}}function Li(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Mi=\"function\"===typeof WeakMap?WeakMap:Map;function Ni(a,b,c){c=mh(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Oi||(Oi=!0,Pi=d);Li(a,b)};return c}\nfunction Qi(a,b,c){c=mh(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)};c.callback=function(){Li(a,b)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){Li(a,b);\"function\"!==typeof d&&(null===Ri?Ri=new Set([this]):Ri.add(this));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nfunction Si(a,b,c){var d=a.pingCache;if(null===d){d=a.pingCache=new Mi;var e=new Set;d.set(b,e)}else e=d.get(b),void 0===e&&(e=new Set,d.set(b,e));e.has(c)||(e.add(c),a=Ti.bind(null,a,b,c),b.then(a,a))}function Ui(a){do{var b;if(b=13===a.tag)b=a.memoizedState,b=null!==b?null!==b.dehydrated?!0:!1:!0;if(b)return a;a=a.return}while(null!==a);return null}\nfunction Vi(a,b,c,d,e){if(0===(a.mode&1))return a===b?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,1===c.tag&&(null===c.alternate?c.tag=17:(b=mh(-1,1),b.tag=2,nh(c,b,1))),c.lanes|=1),a;a.flags|=65536;a.lanes=e;return a}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(a,b,c,d){b.child=null===a?Vg(b,null,c,d):Ug(b,a.child,c,d)}\nfunction Yi(a,b,c,d,e){c=c.render;var f=b.ref;ch(b,e);d=Nh(a,b,c,d,f,e);c=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&c&&vg(b);b.flags|=1;Xi(a,b,d,e);return b.child}\nfunction $i(a,b,c,d,e){if(null===a){var f=c.type;if(\"function\"===typeof f&&!aj(f)&&void 0===f.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=f,bj(a,b,f,d,e);a=Rg(c.type,null,d,b,b.mode,e);a.ref=b.ref;a.return=b;return b.child=a}f=a.child;if(0===(a.lanes&e)){var g=f.memoizedProps;c=c.compare;c=null!==c?c:Ie;if(c(g,d)&&a.ref===b.ref)return Zi(a,b,e)}b.flags|=1;a=Pg(f,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction bj(a,b,c,d,e){if(null!==a){var f=a.memoizedProps;if(Ie(f,d)&&a.ref===b.ref)if(dh=!1,b.pendingProps=d=f,0!==(a.lanes&e))0!==(a.flags&131072)&&(dh=!0);else return b.lanes=a.lanes,Zi(a,b,e)}return cj(a,b,c,d,e)}\nfunction dj(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode)if(0===(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=c;else{if(0===(c&1073741824))return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a,cachePool:null,transitions:null},b.updateQueue=null,G(ej,fj),fj|=a,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null};d=null!==f?f.baseLanes:c;G(ej,fj);fj|=d}else null!==\nf?(d=f.baseLanes|c,b.memoizedState=null):d=c,G(ej,fj),fj|=d;Xi(a,b,e,c);return b.child}function gj(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=512,b.flags|=2097152}function cj(a,b,c,d,e){var f=Zf(c)?Xf:H.current;f=Yf(b,f);ch(b,e);c=Nh(a,b,c,d,f,e);d=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&d&&vg(b);b.flags|=1;Xi(a,b,c,e);return b.child}\nfunction hj(a,b,c,d,e){if(Zf(c)){var f=!0;cg(b)}else f=!1;ch(b,e);if(null===b.stateNode)ij(a,b),Gi(b,c,d),Ii(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=eh(l):(l=Zf(c)?Xf:H.current,l=Yf(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||\n(h!==d||k!==l)&&Hi(b,g,d,l);jh=!1;var r=b.memoizedState;g.state=r;qh(b,d,g,e);k=b.memoizedState;h!==d||r!==k||Wf.current||jh?(\"function\"===typeof m&&(Di(b,c,m,d),k=b.memoizedState),(h=jh||Fi(b,c,h,d,r,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.flags|=4194308)):\n(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),d=!1)}else{g=b.stateNode;lh(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:Ci(b.type,h);g.props=l;q=b.pendingProps;r=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=eh(k):(k=Zf(c)?Xf:H.current,k=Yf(b,k));var y=c.getDerivedStateFromProps;(m=\"function\"===typeof y||\"function\"===typeof g.getSnapshotBeforeUpdate)||\n\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==q||r!==k)&&Hi(b,g,d,k);jh=!1;r=b.memoizedState;g.state=r;qh(b,d,g,e);var n=b.memoizedState;h!==q||r!==n||Wf.current||jh?(\"function\"===typeof y&&(Di(b,c,y,d),n=b.memoizedState),(l=jh||Fi(b,c,l,d,r,n,k)||!1)?(m||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,n,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&\ng.UNSAFE_componentWillUpdate(d,n,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=1024)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),b.memoizedProps=d,b.memoizedState=n),g.props=d,g.state=n,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===\na.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),d=!1)}return jj(a,b,c,d,f,e)}\nfunction jj(a,b,c,d,e,f){gj(a,b);var g=0!==(b.flags&128);if(!d&&!g)return e&&dg(b,c,!1),Zi(a,b,f);d=b.stateNode;Wi.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Ug(b,a.child,null,f),b.child=Ug(b,null,h,f)):Xi(a,b,h,f);b.memoizedState=d.state;e&&dg(b,c,!0);return b.child}function kj(a){var b=a.stateNode;b.pendingContext?ag(a,b.pendingContext,b.pendingContext!==b.context):b.context&&ag(a,b.context,!1);yh(a,b.containerInfo)}\nfunction lj(a,b,c,d,e){Ig();Jg(e);b.flags|=256;Xi(a,b,c,d);return b.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(a){return{baseLanes:a,cachePool:null,transitions:null}}\nfunction oj(a,b,c){var d=b.pendingProps,e=L.current,f=!1,g=0!==(b.flags&128),h;(h=g)||(h=null!==a&&null===a.memoizedState?!1:0!==(e&2));if(h)f=!0,b.flags&=-129;else if(null===a||null!==a.memoizedState)e|=1;G(L,e&1);if(null===a){Eg(b);a=b.memoizedState;if(null!==a&&(a=a.dehydrated,null!==a))return 0===(b.mode&1)?b.lanes=1:\"$!\"===a.data?b.lanes=8:b.lanes=1073741824,null;g=d.children;a=d.fallback;return f?(d=b.mode,f=b.child,g={mode:\"hidden\",children:g},0===(d&1)&&null!==f?(f.childLanes=0,f.pendingProps=\ng):f=pj(g,d,0,null),a=Tg(a,d,c,null),f.return=b,a.return=b,f.sibling=a,b.child=f,b.child.memoizedState=nj(c),b.memoizedState=mj,a):qj(b,g)}e=a.memoizedState;if(null!==e&&(h=e.dehydrated,null!==h))return rj(a,b,g,d,h,e,c);if(f){f=d.fallback;g=b.mode;e=a.child;h=e.sibling;var k={mode:\"hidden\",children:d.children};0===(g&1)&&b.child!==e?(d=b.child,d.childLanes=0,d.pendingProps=k,b.deletions=null):(d=Pg(e,k),d.subtreeFlags=e.subtreeFlags&14680064);null!==h?f=Pg(h,f):(f=Tg(f,g,c,null),f.flags|=2);f.return=\nb;d.return=b;d.sibling=f;b.child=d;d=f;f=b.child;g=a.child.memoizedState;g=null===g?nj(c):{baseLanes:g.baseLanes|c,cachePool:null,transitions:g.transitions};f.memoizedState=g;f.childLanes=a.childLanes&~c;b.memoizedState=mj;return d}f=a.child;a=f.sibling;d=Pg(f,{mode:\"visible\",children:d.children});0===(b.mode&1)&&(d.lanes=c);d.return=b;d.sibling=null;null!==a&&(c=b.deletions,null===c?(b.deletions=[a],b.flags|=16):c.push(a));b.child=d;b.memoizedState=null;return d}\nfunction qj(a,b){b=pj({mode:\"visible\",children:b},a.mode,0,null);b.return=a;return a.child=b}function sj(a,b,c,d){null!==d&&Jg(d);Ug(b,a.child,null,c);a=qj(b,b.pendingProps.children);a.flags|=2;b.memoizedState=null;return a}\nfunction rj(a,b,c,d,e,f,g){if(c){if(b.flags&256)return b.flags&=-257,d=Ki(Error(p(422))),sj(a,b,g,d);if(null!==b.memoizedState)return b.child=a.child,b.flags|=128,null;f=d.fallback;e=b.mode;d=pj({mode:\"visible\",children:d.children},e,0,null);f=Tg(f,e,g,null);f.flags|=2;d.return=b;f.return=b;d.sibling=f;b.child=d;0!==(b.mode&1)&&Ug(b,a.child,null,g);b.child.memoizedState=nj(g);b.memoizedState=mj;return f}if(0===(b.mode&1))return sj(a,b,g,null);if(\"$!\"===e.data){d=e.nextSibling&&e.nextSibling.dataset;\nif(d)var h=d.dgst;d=h;f=Error(p(419));d=Ki(f,d,void 0);return sj(a,b,g,d)}h=0!==(g&a.childLanes);if(dh||h){d=Q;if(null!==d){switch(g&-g){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=0!==(e&(d.suspendedLanes|g))?0:e;\n0!==e&&e!==f.retryLane&&(f.retryLane=e,ih(a,e),gi(d,a,e,-1))}tj();d=Ki(Error(p(421)));return sj(a,b,g,d)}if(\"$?\"===e.data)return b.flags|=128,b.child=a.child,b=uj.bind(null,a),e._reactRetry=b,null;a=f.treeContext;yg=Lf(e.nextSibling);xg=b;I=!0;zg=null;null!==a&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=b);b=qj(b,d.children);b.flags|=4096;return b}function vj(a,b,c){a.lanes|=b;var d=a.alternate;null!==d&&(d.lanes|=b);bh(a.return,b,c)}\nfunction wj(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e}:(f.isBackwards=b,f.rendering=null,f.renderingStartTime=0,f.last=d,f.tail=c,f.tailMode=e)}\nfunction xj(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;Xi(a,b,d.children,c);d=L.current;if(0!==(d&2))d=d&1|2,b.flags|=128;else{if(null!==a&&0!==(a.flags&128))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&vj(a,c,b);else if(19===a.tag)vj(a,c,b);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}G(L,d);if(0===(b.mode&1))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Ch(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);wj(b,!1,e,c,f);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Ch(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}wj(b,!0,c,null,f);break;case \"together\":wj(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}\nfunction ij(a,b){0===(b.mode&1)&&null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2)}function Zi(a,b,c){null!==a&&(b.dependencies=a.dependencies);rh|=b.lanes;if(0===(c&b.childLanes))return null;if(null!==a&&b.child!==a.child)throw Error(p(153));if(null!==b.child){a=b.child;c=Pg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Pg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}\nfunction yj(a,b,c){switch(b.tag){case 3:kj(b);Ig();break;case 5:Ah(b);break;case 1:Zf(b.type)&&cg(b);break;case 4:yh(b,b.stateNode.containerInfo);break;case 10:var d=b.type._context,e=b.memoizedProps.value;G(Wg,d._currentValue);d._currentValue=e;break;case 13:d=b.memoizedState;if(null!==d){if(null!==d.dehydrated)return G(L,L.current&1),b.flags|=128,null;if(0!==(c&b.child.childLanes))return oj(a,b,c);G(L,L.current&1);a=Zi(a,b,c);return null!==a?a.sibling:null}G(L,L.current&1);break;case 19:d=0!==(c&\nb.childLanes);if(0!==(a.flags&128)){if(d)return xj(a,b,c);b.flags|=128}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);G(L,L.current);if(d)break;else return null;case 22:case 23:return b.lanes=0,dj(a,b,c)}return Zi(a,b,c)}var zj,Aj,Bj,Cj;\nzj=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Aj=function(){};\nBj=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;xh(uh.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"select\":e=A({},e,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=Bf)}ub(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===l){var h=e[l];for(g in h)h.hasOwnProperty(g)&&\n(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ea.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,\nc)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ea.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&D(\"scroll\",a),f||h===k||(f=[])):(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",c);var l=f;if(b.updateQueue=l)b.flags|=4}};Cj=function(a,b,c,d){c!==d&&(b.flags|=4)};\nfunction Dj(a,b){if(!I)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction S(a){var b=null!==a.alternate&&a.alternate.child===a.child,c=0,d=0;if(b)for(var e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags&14680064,d|=e.flags&14680064,e.return=a,e=e.sibling;else for(e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags,d|=e.flags,e.return=a,e=e.sibling;a.subtreeFlags|=d;a.childLanes=c;return b}\nfunction Ej(a,b,c){var d=b.pendingProps;wg(b);switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(b),null;case 1:return Zf(b.type)&&$f(),S(b),null;case 3:d=b.stateNode;zh();E(Wf);E(H);Eh();d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)Gg(b)?b.flags|=4:null===a||a.memoizedState.isDehydrated&&0===(b.flags&256)||(b.flags|=1024,null!==zg&&(Fj(zg),zg=null));Aj(a,b);S(b);return null;case 5:Bh(b);var e=xh(wh.current);\nc=b.type;if(null!==a&&null!=b.stateNode)Bj(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!d){if(null===b.stateNode)throw Error(p(166));S(b);return null}a=xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[Of]=b;d[Pf]=f;a=0!==(b.mode&1);switch(c){case \"dialog\":D(\"cancel\",d);D(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",d);break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],d);break;case \"source\":D(\"error\",d);break;case \"img\":case \"image\":case \"link\":D(\"error\",\nd);D(\"load\",d);break;case \"details\":D(\"toggle\",d);break;case \"input\":Za(d,f);D(\"invalid\",d);break;case \"select\":d._wrapperState={wasMultiple:!!f.multiple};D(\"invalid\",d);break;case \"textarea\":hb(d,f),D(\"invalid\",d)}ub(c,f);e=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,h,a),e=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,\nh,a),e=[\"children\",\"\"+h]):ea.hasOwnProperty(g)&&null!=h&&\"onScroll\"===g&&D(\"scroll\",d)}switch(c){case \"input\":Va(d);db(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=Bf)}d=e;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;\"http://www.w3.org/1999/xhtml\"===a&&(a=kb(c));\"http://www.w3.org/1999/xhtml\"===a?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\n\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[Of]=b;a[Pf]=d;zj(a,b,!1,!1);b.stateNode=a;a:{g=vb(c,d);switch(c){case \"dialog\":D(\"cancel\",a);D(\"close\",a);e=d;break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],a);e=d;break;case \"source\":D(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":D(\"error\",\na);D(\"load\",a);e=d;break;case \"details\":D(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);D(\"invalid\",a);break;case \"option\":e=d;break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=A({},d,{value:void 0});D(\"invalid\",a);break;case \"textarea\":hb(a,d);e=gb(a,d);D(\"invalid\",a);break;default:e=d}ub(c,e);h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?sb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&nb(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==\nc||\"\"!==k)&&ob(a,k):\"number\"===typeof k&&ob(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ea.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&D(\"scroll\",a):null!=k&&ta(a,f,k,g))}switch(c){case \"input\":Va(a);db(a,d,!1);break;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,\n!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=Bf)}switch(c){case \"button\":case \"input\":case \"select\":case \"textarea\":d=!!d.autoFocus;break a;case \"img\":d=!0;break a;default:d=!1}}d&&(b.flags|=4)}null!==b.ref&&(b.flags|=512,b.flags|=2097152)}S(b);return null;case 6:if(a&&null!=b.stateNode)Cj(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(p(166));c=xh(wh.current);xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.memoizedProps;d[Of]=b;if(f=d.nodeValue!==c)if(a=\nxg,null!==a)switch(a.tag){case 3:Af(d.nodeValue,c,0!==(a.mode&1));break;case 5:!0!==a.memoizedProps.suppressHydrationWarning&&Af(d.nodeValue,c,0!==(a.mode&1))}f&&(b.flags|=4)}else d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[Of]=b,b.stateNode=d}S(b);return null;case 13:E(L);d=b.memoizedState;if(null===a||null!==a.memoizedState&&null!==a.memoizedState.dehydrated){if(I&&null!==yg&&0!==(b.mode&1)&&0===(b.flags&128))Hg(),Ig(),b.flags|=98560,f=!1;else if(f=Gg(b),null!==d&&null!==d.dehydrated){if(null===\na){if(!f)throw Error(p(318));f=b.memoizedState;f=null!==f?f.dehydrated:null;if(!f)throw Error(p(317));f[Of]=b}else Ig(),0===(b.flags&128)&&(b.memoizedState=null),b.flags|=4;S(b);f=!1}else null!==zg&&(Fj(zg),zg=null),f=!0;if(!f)return b.flags&65536?b:null}if(0!==(b.flags&128))return b.lanes=c,b;d=null!==d;d!==(null!==a&&null!==a.memoizedState)&&d&&(b.child.flags|=8192,0!==(b.mode&1)&&(null===a||0!==(L.current&1)?0===T&&(T=3):tj()));null!==b.updateQueue&&(b.flags|=4);S(b);return null;case 4:return zh(),\nAj(a,b),null===a&&sf(b.stateNode.containerInfo),S(b),null;case 10:return ah(b.type._context),S(b),null;case 17:return Zf(b.type)&&$f(),S(b),null;case 19:E(L);f=b.memoizedState;if(null===f)return S(b),null;d=0!==(b.flags&128);g=f.rendering;if(null===g)if(d)Dj(f,!1);else{if(0!==T||null!==a&&0!==(a.flags&128))for(a=b.child;null!==a;){g=Ch(a);if(null!==g){b.flags|=128;Dj(f,!1);d=g.updateQueue;null!==d&&(b.updateQueue=d,b.flags|=4);b.subtreeFlags=0;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=14680066,\ng=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,f.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;G(L,L.current&1|2);return b.child}a=\na.sibling}null!==f.tail&&B()>Gj&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304)}else{if(!d)if(a=Ch(g),null!==a){if(b.flags|=128,d=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Dj(f,!0),null===f.tail&&\"hidden\"===f.tailMode&&!g.alternate&&!I)return S(b),null}else 2*B()-f.renderingStartTime>Gj&&1073741824!==c&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304);f.isBackwards?(g.sibling=b.child,b.child=g):(c=f.last,null!==c?c.sibling=g:b.child=g,f.last=g)}if(null!==f.tail)return b=f.tail,f.rendering=\nb,f.tail=b.sibling,f.renderingStartTime=B(),b.sibling=null,c=L.current,G(L,d?c&1|2:c&1),b;S(b);return null;case 22:case 23:return Hj(),d=null!==b.memoizedState,null!==a&&null!==a.memoizedState!==d&&(b.flags|=8192),d&&0!==(b.mode&1)?0!==(fj&1073741824)&&(S(b),b.subtreeFlags&6&&(b.flags|=8192)):S(b),null;case 24:return null;case 25:return null}throw Error(p(156,b.tag));}\nfunction Ij(a,b){wg(b);switch(b.tag){case 1:return Zf(b.type)&&$f(),a=b.flags,a&65536?(b.flags=a&-65537|128,b):null;case 3:return zh(),E(Wf),E(H),Eh(),a=b.flags,0!==(a&65536)&&0===(a&128)?(b.flags=a&-65537|128,b):null;case 5:return Bh(b),null;case 13:E(L);a=b.memoizedState;if(null!==a&&null!==a.dehydrated){if(null===b.alternate)throw Error(p(340));Ig()}a=b.flags;return a&65536?(b.flags=a&-65537|128,b):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(b.type._context),null;case 22:case 23:return Hj(),\nnull;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=\"function\"===typeof WeakSet?WeakSet:Set,V=null;function Lj(a,b){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(d){W(a,b,d)}else c.current=null}function Mj(a,b,c){try{c()}catch(d){W(a,b,d)}}var Nj=!1;\nfunction Oj(a,b){Cf=dd;a=Me();if(Ne(a)){if(\"selectionStart\"in a)var c={start:a.selectionStart,end:a.selectionEnd};else a:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&0!==d.rangeCount){c=d.anchorNode;var e=d.anchorOffset,f=d.focusNode;d=d.focusOffset;try{c.nodeType,f.nodeType}catch(F){c=null;break a}var g=0,h=-1,k=-1,l=0,m=0,q=a,r=null;b:for(;;){for(var y;;){q!==c||0!==e&&3!==q.nodeType||(h=g+e);q!==f||0!==d&&3!==q.nodeType||(k=g+d);3===q.nodeType&&(g+=\nq.nodeValue.length);if(null===(y=q.firstChild))break;r=q;q=y}for(;;){if(q===a)break b;r===c&&++l===e&&(h=g);r===f&&++m===d&&(k=g);if(null!==(y=q.nextSibling))break;q=r;r=q.parentNode}q=y}c=-1===h||-1===k?null:{start:h,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;Df={focusedElem:a,selectionRange:c};dd=!1;for(V=b;null!==V;)if(b=V,a=b.child,0!==(b.subtreeFlags&1028)&&null!==a)a.return=b,V=a;else for(;null!==V;){b=V;try{var n=b.alternate;if(0!==(b.flags&1024))switch(b.tag){case 0:case 11:case 15:break;\ncase 1:if(null!==n){var t=n.memoizedProps,J=n.memoizedState,x=b.stateNode,w=x.getSnapshotBeforeUpdate(b.elementType===b.type?t:Ci(b.type,t),J);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var u=b.stateNode.containerInfo;1===u.nodeType?u.textContent=\"\":9===u.nodeType&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163));}}catch(F){W(b,b.return,F)}a=b.sibling;if(null!==a){a.return=b.return;V=a;break}V=b.return}n=Nj;Nj=!1;return n}\nfunction Pj(a,b,c){var d=b.updateQueue;d=null!==d?d.lastEffect:null;if(null!==d){var e=d=d.next;do{if((e.tag&a)===a){var f=e.destroy;e.destroy=void 0;void 0!==f&&Mj(b,c,f)}e=e.next}while(e!==d)}}function Qj(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function Rj(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=c;break;default:a=c}\"function\"===typeof b?b(a):b.current=a}}\nfunction Sj(a){var b=a.alternate;null!==b&&(a.alternate=null,Sj(b));a.child=null;a.deletions=null;a.sibling=null;5===a.tag&&(b=a.stateNode,null!==b&&(delete b[Of],delete b[Pf],delete b[of],delete b[Qf],delete b[Rf]));a.stateNode=null;a.return=null;a.dependencies=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.stateNode=null;a.updateQueue=null}function Tj(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Uj(a){a:for(;;){for(;null===a.sibling;){if(null===a.return||Tj(a.return))return null;a=a.return}a.sibling.return=a.return;for(a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(a.flags&2)continue a;if(null===a.child||4===a.tag)continue a;else a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}\nfunction Vj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=Bf));else if(4!==d&&(a=a.child,null!==a))for(Vj(a,b,c),a=a.sibling;null!==a;)Vj(a,b,c),a=a.sibling}\nfunction Wj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Wj(a,b,c),a=a.sibling;null!==a;)Wj(a,b,c),a=a.sibling}var X=null,Xj=!1;function Yj(a,b,c){for(c=c.child;null!==c;)Zj(a,b,c),c=c.sibling}\nfunction Zj(a,b,c){if(lc&&\"function\"===typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,c)}catch(h){}switch(c.tag){case 5:U||Lj(c,b);case 6:var d=X,e=Xj;X=null;Yj(a,b,c);X=d;Xj=e;null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):X.removeChild(c.stateNode));break;case 18:null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?Kf(a.parentNode,c):1===a.nodeType&&Kf(a,c),bd(a)):Kf(X,c.stateNode));break;case 4:d=X;e=Xj;X=c.stateNode.containerInfo;Xj=!0;\nYj(a,b,c);X=d;Xj=e;break;case 0:case 11:case 14:case 15:if(!U&&(d=c.updateQueue,null!==d&&(d=d.lastEffect,null!==d))){e=d=d.next;do{var f=e,g=f.destroy;f=f.tag;void 0!==g&&(0!==(f&2)?Mj(c,b,g):0!==(f&4)&&Mj(c,b,g));e=e.next}while(e!==d)}Yj(a,b,c);break;case 1:if(!U&&(Lj(c,b),d=c.stateNode,\"function\"===typeof d.componentWillUnmount))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(h){W(c,b,h)}Yj(a,b,c);break;case 21:Yj(a,b,c);break;case 22:c.mode&1?(U=(d=U)||null!==\nc.memoizedState,Yj(a,b,c),U=d):Yj(a,b,c);break;default:Yj(a,b,c)}}function ak(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Kj);b.forEach(function(b){var d=bk.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction ck(a,b){var c=b.deletions;if(null!==c)for(var d=0;d<c.length;d++){var e=c[d];try{var f=a,g=b,h=g;a:for(;null!==h;){switch(h.tag){case 5:X=h.stateNode;Xj=!1;break a;case 3:X=h.stateNode.containerInfo;Xj=!0;break a;case 4:X=h.stateNode.containerInfo;Xj=!0;break a}h=h.return}if(null===X)throw Error(p(160));Zj(f,g,e);X=null;Xj=!1;var k=e.alternate;null!==k&&(k.return=null);e.return=null}catch(l){W(e,b,l)}}if(b.subtreeFlags&12854)for(b=b.child;null!==b;)dk(b,a),b=b.sibling}\nfunction dk(a,b){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ck(b,a);ek(a);if(d&4){try{Pj(3,a,a.return),Qj(3,a)}catch(t){W(a,a.return,t)}try{Pj(5,a,a.return)}catch(t){W(a,a.return,t)}}break;case 1:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);break;case 5:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);if(a.flags&32){var e=a.stateNode;try{ob(e,\"\")}catch(t){W(a,a.return,t)}}if(d&4&&(e=a.stateNode,null!=e)){var f=a.memoizedProps,g=null!==c?c.memoizedProps:f,h=a.type,k=a.updateQueue;\na.updateQueue=null;if(null!==k)try{\"input\"===h&&\"radio\"===f.type&&null!=f.name&&ab(e,f);vb(h,g);var l=vb(h,f);for(g=0;g<k.length;g+=2){var m=k[g],q=k[g+1];\"style\"===m?sb(e,q):\"dangerouslySetInnerHTML\"===m?nb(e,q):\"children\"===m?ob(e,q):ta(e,m,q,l)}switch(h){case \"input\":bb(e,f);break;case \"textarea\":ib(e,f);break;case \"select\":var r=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!f.multiple;var y=f.value;null!=y?fb(e,!!f.multiple,y,!1):r!==!!f.multiple&&(null!=f.defaultValue?fb(e,!!f.multiple,\nf.defaultValue,!0):fb(e,!!f.multiple,f.multiple?[]:\"\",!1))}e[Pf]=f}catch(t){W(a,a.return,t)}}break;case 6:ck(b,a);ek(a);if(d&4){if(null===a.stateNode)throw Error(p(162));e=a.stateNode;f=a.memoizedProps;try{e.nodeValue=f}catch(t){W(a,a.return,t)}}break;case 3:ck(b,a);ek(a);if(d&4&&null!==c&&c.memoizedState.isDehydrated)try{bd(b.containerInfo)}catch(t){W(a,a.return,t)}break;case 4:ck(b,a);ek(a);break;case 13:ck(b,a);ek(a);e=a.child;e.flags&8192&&(f=null!==e.memoizedState,e.stateNode.isHidden=f,!f||\nnull!==e.alternate&&null!==e.alternate.memoizedState||(fk=B()));d&4&&ak(a);break;case 22:m=null!==c&&null!==c.memoizedState;a.mode&1?(U=(l=U)||m,ck(b,a),U=l):ck(b,a);ek(a);if(d&8192){l=null!==a.memoizedState;if((a.stateNode.isHidden=l)&&!m&&0!==(a.mode&1))for(V=a,m=a.child;null!==m;){for(q=V=m;null!==V;){r=V;y=r.child;switch(r.tag){case 0:case 11:case 14:case 15:Pj(4,r,r.return);break;case 1:Lj(r,r.return);var n=r.stateNode;if(\"function\"===typeof n.componentWillUnmount){d=r;c=r.return;try{b=d,n.props=\nb.memoizedProps,n.state=b.memoizedState,n.componentWillUnmount()}catch(t){W(d,c,t)}}break;case 5:Lj(r,r.return);break;case 22:if(null!==r.memoizedState){gk(q);continue}}null!==y?(y.return=r,V=y):gk(q)}m=m.sibling}a:for(m=null,q=a;;){if(5===q.tag){if(null===m){m=q;try{e=q.stateNode,l?(f=e.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(h=q.stateNode,k=q.memoizedProps.style,g=void 0!==k&&null!==k&&k.hasOwnProperty(\"display\")?k.display:null,h.style.display=\nrb(\"display\",g))}catch(t){W(a,a.return,t)}}}else if(6===q.tag){if(null===m)try{q.stateNode.nodeValue=l?\"\":q.memoizedProps}catch(t){W(a,a.return,t)}}else if((22!==q.tag&&23!==q.tag||null===q.memoizedState||q===a)&&null!==q.child){q.child.return=q;q=q.child;continue}if(q===a)break a;for(;null===q.sibling;){if(null===q.return||q.return===a)break a;m===q&&(m=null);q=q.return}m===q&&(m=null);q.sibling.return=q.return;q=q.sibling}}break;case 19:ck(b,a);ek(a);d&4&&ak(a);break;case 21:break;default:ck(b,\na),ek(a)}}function ek(a){var b=a.flags;if(b&2){try{a:{for(var c=a.return;null!==c;){if(Tj(c)){var d=c;break a}c=c.return}throw Error(p(160));}switch(d.tag){case 5:var e=d.stateNode;d.flags&32&&(ob(e,\"\"),d.flags&=-33);var f=Uj(a);Wj(a,f,e);break;case 3:case 4:var g=d.stateNode.containerInfo,h=Uj(a);Vj(a,h,g);break;default:throw Error(p(161));}}catch(k){W(a,a.return,k)}a.flags&=-3}b&4096&&(a.flags&=-4097)}function hk(a,b,c){V=a;ik(a,b,c)}\nfunction ik(a,b,c){for(var d=0!==(a.mode&1);null!==V;){var e=V,f=e.child;if(22===e.tag&&d){var g=null!==e.memoizedState||Jj;if(!g){var h=e.alternate,k=null!==h&&null!==h.memoizedState||U;h=Jj;var l=U;Jj=g;if((U=k)&&!l)for(V=e;null!==V;)g=V,k=g.child,22===g.tag&&null!==g.memoizedState?jk(e):null!==k?(k.return=g,V=k):jk(e);for(;null!==f;)V=f,ik(f,b,c),f=f.sibling;V=e;Jj=h;U=l}kk(a,b,c)}else 0!==(e.subtreeFlags&8772)&&null!==f?(f.return=e,V=f):kk(a,b,c)}}\nfunction kk(a){for(;null!==V;){var b=V;if(0!==(b.flags&8772)){var c=b.alternate;try{if(0!==(b.flags&8772))switch(b.tag){case 0:case 11:case 15:U||Qj(5,b);break;case 1:var d=b.stateNode;if(b.flags&4&&!U)if(null===c)d.componentDidMount();else{var e=b.elementType===b.type?c.memoizedProps:Ci(b.type,c.memoizedProps);d.componentDidUpdate(e,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var f=b.updateQueue;null!==f&&sh(b,f,d);break;case 3:var g=b.updateQueue;if(null!==g){c=null;if(null!==b.child)switch(b.child.tag){case 5:c=\nb.child.stateNode;break;case 1:c=b.child.stateNode}sh(b,g,c)}break;case 5:var h=b.stateNode;if(null===c&&b.flags&4){c=h;var k=b.memoizedProps;switch(b.type){case \"button\":case \"input\":case \"select\":case \"textarea\":k.autoFocus&&c.focus();break;case \"img\":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===b.memoizedState){var l=b.alternate;if(null!==l){var m=l.memoizedState;if(null!==m){var q=m.dehydrated;null!==q&&bd(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;\ndefault:throw Error(p(163));}U||b.flags&512&&Rj(b)}catch(r){W(b,b.return,r)}}if(b===a){V=null;break}c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}function gk(a){for(;null!==V;){var b=V;if(b===a){V=null;break}var c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}\nfunction jk(a){for(;null!==V;){var b=V;try{switch(b.tag){case 0:case 11:case 15:var c=b.return;try{Qj(4,b)}catch(k){W(b,c,k)}break;case 1:var d=b.stateNode;if(\"function\"===typeof d.componentDidMount){var e=b.return;try{d.componentDidMount()}catch(k){W(b,e,k)}}var f=b.return;try{Rj(b)}catch(k){W(b,f,k)}break;case 5:var g=b.return;try{Rj(b)}catch(k){W(b,g,k)}}}catch(k){W(b,b.return,k)}if(b===a){V=null;break}var h=b.sibling;if(null!==h){h.return=b.return;V=h;break}V=b.return}}\nvar lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=Infinity,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return 0!==(K&6)?B():-1!==Ak?Ak:Ak=B()}\nfunction yi(a){if(0===(a.mode&1))return 1;if(0!==(K&2)&&0!==Z)return Z&-Z;if(null!==Kg.transition)return 0===Bk&&(Bk=yc()),Bk;a=C;if(0!==a)return a;a=window.event;a=void 0===a?16:jd(a.type);return a}function gi(a,b,c,d){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(a,c,d);if(0===(K&2)||a!==Q)a===Q&&(0===(K&2)&&(qk|=c),4===T&&Ck(a,Z)),Dk(a,d),1===c&&0===K&&0===(b.mode&1)&&(Gj=B()+500,fg&&jg())}\nfunction Dk(a,b){var c=a.callbackNode;wc(a,b);var d=uc(a,a===Q?Z:0);if(0===d)null!==c&&bc(c),a.callbackNode=null,a.callbackPriority=0;else if(b=d&-d,a.callbackPriority!==b){null!=c&&bc(c);if(1===b)0===a.tag?ig(Ek.bind(null,a)):hg(Ek.bind(null,a)),Jf(function(){0===(K&6)&&jg()}),c=null;else{switch(Dc(d)){case 1:c=fc;break;case 4:c=gc;break;case 16:c=hc;break;case 536870912:c=jc;break;default:c=hc}c=Fk(c,Gk.bind(null,a))}a.callbackPriority=b;a.callbackNode=c}}\nfunction Gk(a,b){Ak=-1;Bk=0;if(0!==(K&6))throw Error(p(327));var c=a.callbackNode;if(Hk()&&a.callbackNode!==c)return null;var d=uc(a,a===Q?Z:0);if(0===d)return null;if(0!==(d&30)||0!==(d&a.expiredLanes)||b)b=Ik(a,d);else{b=d;var e=K;K|=2;var f=Jk();if(Q!==a||Z!==b)uk=null,Gj=B()+500,Kk(a,b);do try{Lk();break}catch(h){Mk(a,h)}while(1);$g();mk.current=f;K=e;null!==Y?b=0:(Q=null,Z=0,b=T)}if(0!==b){2===b&&(e=xc(a),0!==e&&(d=e,b=Nk(a,e)));if(1===b)throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;if(6===b)Ck(a,d);\nelse{e=a.current.alternate;if(0===(d&30)&&!Ok(e)&&(b=Ik(a,d),2===b&&(f=xc(a),0!==f&&(d=f,b=Nk(a,f))),1===b))throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;a.finishedWork=e;a.finishedLanes=d;switch(b){case 0:case 1:throw Error(p(345));case 2:Pk(a,tk,uk);break;case 3:Ck(a,d);if((d&130023424)===d&&(b=fk+500-B(),10<b)){if(0!==uc(a,0))break;e=a.suspendedLanes;if((e&d)!==d){R();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),b);break}Pk(a,tk,uk);break;case 4:Ck(a,d);if((d&4194240)===\nd)break;b=a.eventTimes;for(e=-1;0<d;){var g=31-oc(d);f=1<<g;g=b[g];g>e&&(e=g);d&=~f}d=e;d=B()-d;d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*lk(d/1960))-d;if(10<d){a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),d);break}Pk(a,tk,uk);break;case 5:Pk(a,tk,uk);break;default:throw Error(p(329));}}}Dk(a,B());return a.callbackNode===c?Gk.bind(null,a):null}\nfunction Nk(a,b){var c=sk;a.current.memoizedState.isDehydrated&&(Kk(a,b).flags|=256);a=Ik(a,b);2!==a&&(b=tk,tk=c,null!==b&&Fj(b));return a}function Fj(a){null===tk?tk=a:tk.push.apply(tk,a)}\nfunction Ok(a){for(var b=a;;){if(b.flags&16384){var c=b.updateQueue;if(null!==c&&(c=c.stores,null!==c))for(var d=0;d<c.length;d++){var e=c[d],f=e.getSnapshot;e=e.value;try{if(!He(f(),e))return!1}catch(g){return!1}}}c=b.child;if(b.subtreeFlags&16384&&null!==c)c.return=b,b=c;else{if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return!0;b=b.return}b.sibling.return=b.return;b=b.sibling}}return!0}\nfunction Ck(a,b){b&=~rk;b&=~qk;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-oc(b),d=1<<c;a[c]=-1;b&=~d}}function Ek(a){if(0!==(K&6))throw Error(p(327));Hk();var b=uc(a,0);if(0===(b&1))return Dk(a,B()),null;var c=Ik(a,b);if(0!==a.tag&&2===c){var d=xc(a);0!==d&&(b=d,c=Nk(a,d))}if(1===c)throw c=pk,Kk(a,0),Ck(a,b),Dk(a,B()),c;if(6===c)throw Error(p(345));a.finishedWork=a.current.alternate;a.finishedLanes=b;Pk(a,tk,uk);Dk(a,B());return null}\nfunction Qk(a,b){var c=K;K|=1;try{return a(b)}finally{K=c,0===K&&(Gj=B()+500,fg&&jg())}}function Rk(a){null!==wk&&0===wk.tag&&0===(K&6)&&Hk();var b=K;K|=1;var c=ok.transition,d=C;try{if(ok.transition=null,C=1,a)return a()}finally{C=d,ok.transition=c,K=b,0===(K&6)&&jg()}}function Hj(){fj=ej.current;E(ej)}\nfunction Kk(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Gf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;wg(d);switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&$f();break;case 3:zh();E(Wf);E(H);Eh();break;case 5:Bh(d);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(d.type._context);break;case 22:case 23:Hj()}c=c.return}Q=a;Y=a=Pg(a.current,null);Z=fj=b;T=0;pk=null;rk=qk=rh=0;tk=sk=null;if(null!==fh){for(b=\n0;b<fh.length;b++)if(c=fh[b],d=c.interleaved,null!==d){c.interleaved=null;var e=d.next,f=c.pending;if(null!==f){var g=f.next;f.next=e;d.next=g}c.pending=d}fh=null}return a}\nfunction Mk(a,b){do{var c=Y;try{$g();Fh.current=Rh;if(Ih){for(var d=M.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}Ih=!1}Hh=0;O=N=M=null;Jh=!1;Kh=0;nk.current=null;if(null===c||null===c.return){T=1;pk=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=Z;h.flags|=32768;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k,m=h,q=m.tag;if(0===(m.mode&1)&&(0===q||11===q||15===q)){var r=m.alternate;r?(m.updateQueue=r.updateQueue,m.memoizedState=r.memoizedState,\nm.lanes=r.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Ui(g);if(null!==y){y.flags&=-257;Vi(y,g,h,f,b);y.mode&1&&Si(f,l,b);b=y;k=l;var n=b.updateQueue;if(null===n){var t=new Set;t.add(k);b.updateQueue=t}else n.add(k);break a}else{if(0===(b&1)){Si(f,l,b);tj();break a}k=Error(p(426))}}else if(I&&h.mode&1){var J=Ui(g);if(null!==J){0===(J.flags&65536)&&(J.flags|=256);Vi(J,g,h,f,b);Jg(Ji(k,h));break a}}f=k=Ji(k,h);4!==T&&(T=2);null===sk?sk=[f]:sk.push(f);f=g;do{switch(f.tag){case 3:f.flags|=65536;\nb&=-b;f.lanes|=b;var x=Ni(f,k,b);ph(f,x);break a;case 1:h=k;var w=f.type,u=f.stateNode;if(0===(f.flags&128)&&(\"function\"===typeof w.getDerivedStateFromError||null!==u&&\"function\"===typeof u.componentDidCatch&&(null===Ri||!Ri.has(u)))){f.flags|=65536;b&=-b;f.lanes|=b;var F=Qi(f,h,b);ph(f,F);break a}}f=f.return}while(null!==f)}Sk(c)}catch(na){b=na;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}function Jk(){var a=mk.current;mk.current=Rh;return null===a?Rh:a}\nfunction tj(){if(0===T||3===T||2===T)T=4;null===Q||0===(rh&268435455)&&0===(qk&268435455)||Ck(Q,Z)}function Ik(a,b){var c=K;K|=2;var d=Jk();if(Q!==a||Z!==b)uk=null,Kk(a,b);do try{Tk();break}catch(e){Mk(a,e)}while(1);$g();K=c;mk.current=d;if(null!==Y)throw Error(p(261));Q=null;Z=0;return T}function Tk(){for(;null!==Y;)Uk(Y)}function Lk(){for(;null!==Y&&!cc();)Uk(Y)}function Uk(a){var b=Vk(a.alternate,a,fj);a.memoizedProps=a.pendingProps;null===b?Sk(a):Y=b;nk.current=null}\nfunction Sk(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&32768)){if(c=Ej(c,b,fj),null!==c){Y=c;return}}else{c=Ij(c,b);if(null!==c){c.flags&=32767;Y=c;return}if(null!==a)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6;Y=null;return}}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===T&&(T=5)}function Pk(a,b,c){var d=C,e=ok.transition;try{ok.transition=null,C=1,Wk(a,b,c,d)}finally{ok.transition=e,C=d}return null}\nfunction Wk(a,b,c,d){do Hk();while(null!==wk);if(0!==(K&6))throw Error(p(327));c=a.finishedWork;var e=a.finishedLanes;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(p(177));a.callbackNode=null;a.callbackPriority=0;var f=c.lanes|c.childLanes;Bc(a,f);a===Q&&(Y=Q=null,Z=0);0===(c.subtreeFlags&2064)&&0===(c.flags&2064)||vk||(vk=!0,Fk(hc,function(){Hk();return null}));f=0!==(c.flags&15990);if(0!==(c.subtreeFlags&15990)||f){f=ok.transition;ok.transition=null;\nvar g=C;C=1;var h=K;K|=4;nk.current=null;Oj(a,c);dk(c,a);Oe(Df);dd=!!Cf;Df=Cf=null;a.current=c;hk(c,a,e);dc();K=h;C=g;ok.transition=f}else a.current=c;vk&&(vk=!1,wk=a,xk=e);f=a.pendingLanes;0===f&&(Ri=null);mc(c.stateNode,d);Dk(a,B());if(null!==b)for(d=a.onRecoverableError,c=0;c<b.length;c++)e=b[c],d(e.value,{componentStack:e.stack,digest:e.digest});if(Oi)throw Oi=!1,a=Pi,Pi=null,a;0!==(xk&1)&&0!==a.tag&&Hk();f=a.pendingLanes;0!==(f&1)?a===zk?yk++:(yk=0,zk=a):yk=0;jg();return null}\nfunction Hk(){if(null!==wk){var a=Dc(xk),b=ok.transition,c=C;try{ok.transition=null;C=16>a?16:a;if(null===wk)var d=!1;else{a=wk;wk=null;xk=0;if(0!==(K&6))throw Error(p(331));var e=K;K|=4;for(V=a.current;null!==V;){var f=V,g=f.child;if(0!==(V.flags&16)){var h=f.deletions;if(null!==h){for(var k=0;k<h.length;k++){var l=h[k];for(V=l;null!==V;){var m=V;switch(m.tag){case 0:case 11:case 15:Pj(8,m,f)}var q=m.child;if(null!==q)q.return=m,V=q;else for(;null!==V;){m=V;var r=m.sibling,y=m.return;Sj(m);if(m===\nl){V=null;break}if(null!==r){r.return=y;V=r;break}V=y}}}var n=f.alternate;if(null!==n){var t=n.child;if(null!==t){n.child=null;do{var J=t.sibling;t.sibling=null;t=J}while(null!==t)}}V=f}}if(0!==(f.subtreeFlags&2064)&&null!==g)g.return=f,V=g;else b:for(;null!==V;){f=V;if(0!==(f.flags&2048))switch(f.tag){case 0:case 11:case 15:Pj(9,f,f.return)}var x=f.sibling;if(null!==x){x.return=f.return;V=x;break b}V=f.return}}var w=a.current;for(V=w;null!==V;){g=V;var u=g.child;if(0!==(g.subtreeFlags&2064)&&null!==\nu)u.return=g,V=u;else b:for(g=w;null!==V;){h=V;if(0!==(h.flags&2048))try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(na){W(h,h.return,na)}if(h===g){V=null;break b}var F=h.sibling;if(null!==F){F.return=h.return;V=F;break b}V=h.return}}K=e;jg();if(lc&&\"function\"===typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,a)}catch(na){}d=!0}return d}finally{C=c,ok.transition=b}}return!1}function Xk(a,b,c){b=Ji(c,b);b=Ni(a,b,1);a=nh(a,b,1);b=R();null!==a&&(Ac(a,1,b),Dk(a,b))}\nfunction W(a,b,c){if(3===a.tag)Xk(a,a,c);else for(;null!==b;){if(3===b.tag){Xk(b,a,c);break}else if(1===b.tag){var d=b.stateNode;if(\"function\"===typeof b.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Ri||!Ri.has(d))){a=Ji(c,a);a=Qi(b,a,1);b=nh(b,a,1);a=R();null!==b&&(Ac(b,1,a),Dk(b,a));break}}b=b.return}}\nfunction Ti(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=R();a.pingedLanes|=a.suspendedLanes&c;Q===a&&(Z&c)===c&&(4===T||3===T&&(Z&130023424)===Z&&500>B()-fk?Kk(a,0):rk|=c);Dk(a,b)}function Yk(a,b){0===b&&(0===(a.mode&1)?b=1:(b=sc,sc<<=1,0===(sc&130023424)&&(sc=4194304)));var c=R();a=ih(a,b);null!==a&&(Ac(a,b,c),Dk(a,c))}function uj(a){var b=a.memoizedState,c=0;null!==b&&(c=b.retryLane);Yk(a,c)}\nfunction bk(a,b){var c=0;switch(a.tag){case 13:var d=a.stateNode;var e=a.memoizedState;null!==e&&(c=e.retryLane);break;case 19:d=a.stateNode;break;default:throw Error(p(314));}null!==d&&d.delete(b);Yk(a,c)}var Vk;\nVk=function(a,b,c){if(null!==a)if(a.memoizedProps!==b.pendingProps||Wf.current)dh=!0;else{if(0===(a.lanes&c)&&0===(b.flags&128))return dh=!1,yj(a,b,c);dh=0!==(a.flags&131072)?!0:!1}else dh=!1,I&&0!==(b.flags&1048576)&&ug(b,ng,b.index);b.lanes=0;switch(b.tag){case 2:var d=b.type;ij(a,b);a=b.pendingProps;var e=Yf(b,H.current);ch(b,c);e=Nh(null,b,d,a,e,c);var f=Sh();b.flags|=1;\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof?(b.tag=1,b.memoizedState=null,b.updateQueue=\nnull,Zf(d)?(f=!0,cg(b)):f=!1,b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,kh(b),e.updater=Ei,b.stateNode=e,e._reactInternals=b,Ii(b,d,a,c),b=jj(null,b,d,!0,f,c)):(b.tag=0,I&&f&&vg(b),Xi(null,b,e,c),b=b.child);return b;case 16:d=b.elementType;a:{ij(a,b);a=b.pendingProps;e=d._init;d=e(d._payload);b.type=d;e=b.tag=Zk(d);a=Ci(d,a);switch(e){case 0:b=cj(null,b,d,a,c);break a;case 1:b=hj(null,b,d,a,c);break a;case 11:b=Yi(null,b,d,a,c);break a;case 14:b=$i(null,b,d,Ci(d.type,a),c);break a}throw Error(p(306,\nd,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),cj(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),hj(a,b,d,e,c);case 3:a:{kj(b);if(null===a)throw Error(p(387));d=b.pendingProps;f=b.memoizedState;e=f.element;lh(a,b);qh(b,d,null,c);var g=b.memoizedState;d=g.element;if(f.isDehydrated)if(f={element:d,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},b.updateQueue.baseState=\nf,b.memoizedState=f,b.flags&256){e=Ji(Error(p(423)),b);b=lj(a,b,d,c,e);break a}else if(d!==e){e=Ji(Error(p(424)),b);b=lj(a,b,d,c,e);break a}else for(yg=Lf(b.stateNode.containerInfo.firstChild),xg=b,I=!0,zg=null,c=Vg(b,null,d,c),b.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{Ig();if(d===e){b=Zi(a,b,c);break a}Xi(a,b,d,c)}b=b.child}return b;case 5:return Ah(b),null===a&&Eg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ef(d,e)?g=null:null!==f&&Ef(d,f)&&(b.flags|=32),\ngj(a,b),Xi(a,b,g,c),b.child;case 6:return null===a&&Eg(b),null;case 13:return oj(a,b,c);case 4:return yh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Ug(b,null,d,c):Xi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),Yi(a,b,d,e,c);case 7:return Xi(a,b,b.pendingProps,c),b.child;case 8:return Xi(a,b,b.pendingProps.children,c),b.child;case 12:return Xi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;f=b.memoizedProps;\ng=e.value;G(Wg,d._currentValue);d._currentValue=g;if(null!==f)if(He(f.value,g)){if(f.children===e.children&&!Wf.current){b=Zi(a,b,c);break a}}else for(f=b.child,null!==f&&(f.return=b);null!==f;){var h=f.dependencies;if(null!==h){g=f.child;for(var k=h.firstContext;null!==k;){if(k.context===d){if(1===f.tag){k=mh(-1,c&-c);k.tag=2;var l=f.updateQueue;if(null!==l){l=l.shared;var m=l.pending;null===m?k.next=k:(k.next=m.next,m.next=k);l.pending=k}}f.lanes|=c;k=f.alternate;null!==k&&(k.lanes|=c);bh(f.return,\nc,b);h.lanes|=c;break}k=k.next}}else if(10===f.tag)g=f.type===b.type?null:f.child;else if(18===f.tag){g=f.return;if(null===g)throw Error(p(341));g.lanes|=c;h=g.alternate;null!==h&&(h.lanes|=c);bh(g,c,b);g=f.sibling}else g=f.child;if(null!==g)g.return=f;else for(g=f;null!==g;){if(g===b){g=null;break}f=g.sibling;if(null!==f){f.return=g.return;g=f;break}g=g.return}f=g}Xi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,d=b.pendingProps.children,ch(b,c),e=eh(e),d=d(e),b.flags|=1,Xi(a,b,d,c),\nb.child;case 14:return d=b.type,e=Ci(d,b.pendingProps),e=Ci(d.type,e),$i(a,b,d,e,c);case 15:return bj(a,b,b.type,b.pendingProps,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),ij(a,b),b.tag=1,Zf(d)?(a=!0,cg(b)):a=!1,ch(b,c),Gi(b,d,e),Ii(b,d,e,c),jj(null,b,d,!0,a,c);case 19:return xj(a,b,c);case 22:return dj(a,b,c)}throw Error(p(156,b.tag));};function Fk(a,b){return ac(a,b)}\nfunction $k(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Bg(a,b,c,d){return new $k(a,b,c,d)}function aj(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction Zk(a){if(\"function\"===typeof a)return aj(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Da)return 11;if(a===Ga)return 14}return 2}\nfunction Pg(a,b){var c=a.alternate;null===c?(c=Bg(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null);c.flags=a.flags&14680064;c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Rg(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)aj(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ya:return Tg(c.children,e,f,b);case za:g=8;e|=8;break;case Aa:return a=Bg(12,c,b,e|2),a.elementType=Aa,a.lanes=f,a;case Ea:return a=Bg(13,c,b,e),a.elementType=Ea,a.lanes=f,a;case Fa:return a=Bg(19,c,b,e),a.elementType=Fa,a.lanes=f,a;case Ia:return pj(c,e,f,b);default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case Ba:g=10;break a;case Ca:g=9;break a;case Da:g=11;\nbreak a;case Ga:g=14;break a;case Ha:g=16;d=null;break a}throw Error(p(130,null==a?a:typeof a,\"\"));}b=Bg(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Tg(a,b,c,d){a=Bg(7,a,d,b);a.lanes=c;return a}function pj(a,b,c,d){a=Bg(22,a,d,b);a.elementType=Ia;a.lanes=c;a.stateNode={isHidden:!1};return a}function Qg(a,b,c){a=Bg(6,a,null,b);a.lanes=c;return a}\nfunction Sg(a,b,c){b=Bg(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction al(a,b,c,d,e){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=zc(0);this.expirationTimes=zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=zc(0);this.identifierPrefix=d;this.onRecoverableError=e;this.mutableSourceEagerHydrationData=\nnull}function bl(a,b,c,d,e,f,g,h,k){a=new al(a,b,c,h,k);1===b?(b=1,!0===f&&(b|=8)):b=0;f=Bg(3,null,null,b);a.current=f;f.stateNode=a;f.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};kh(f);return a}function cl(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction dl(a){if(!a)return Vf;a=a._reactInternals;a:{if(Vb(a)!==a||1!==a.tag)throw Error(p(170));var b=a;do{switch(b.tag){case 3:b=b.stateNode.context;break a;case 1:if(Zf(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break a}}b=b.return}while(null!==b);throw Error(p(171));}if(1===a.tag){var c=a.type;if(Zf(c))return bg(a,c,b)}return b}\nfunction el(a,b,c,d,e,f,g,h,k){a=bl(c,d,!0,a,e,f,g,h,k);a.context=dl(null);c=a.current;d=R();e=yi(c);f=mh(d,e);f.callback=void 0!==b&&null!==b?b:null;nh(c,f,e);a.current.lanes=e;Ac(a,e,d);Dk(a,d);return a}function fl(a,b,c,d){var e=b.current,f=R(),g=yi(e);c=dl(c);null===b.context?b.context=c:b.pendingContext=c;b=mh(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);a=nh(e,b,g);null!==a&&(gi(a,e,g,f),oh(a,e,g));return g}\nfunction gl(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function hl(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function il(a,b){hl(a,b);(a=a.alternate)&&hl(a,b)}function jl(){return null}var kl=\"function\"===typeof reportError?reportError:function(a){console.error(a)};function ll(a){this._internalRoot=a}\nml.prototype.render=ll.prototype.render=function(a){var b=this._internalRoot;if(null===b)throw Error(p(409));fl(a,b,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var a=this._internalRoot;if(null!==a){this._internalRoot=null;var b=a.containerInfo;Rk(function(){fl(null,a,null,null)});b[uf]=null}};function ml(a){this._internalRoot=a}\nml.prototype.unstable_scheduleHydration=function(a){if(a){var b=Hc();a={blockedOn:null,target:a,priority:b};for(var c=0;c<Qc.length&&0!==b&&b<Qc[c].priority;c++);Qc.splice(c,0,a);0===c&&Vc(a)}};function nl(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType)}function ol(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function pl(){}\nfunction ql(a,b,c,d,e){if(e){if(\"function\"===typeof d){var f=d;d=function(){var a=gl(g);f.call(a)}}var g=el(b,d,a,0,null,!1,!1,\"\",pl);a._reactRootContainer=g;a[uf]=g.current;sf(8===a.nodeType?a.parentNode:a);Rk();return g}for(;e=a.lastChild;)a.removeChild(e);if(\"function\"===typeof d){var h=d;d=function(){var a=gl(k);h.call(a)}}var k=bl(a,0,!1,null,null,!1,!1,\"\",pl);a._reactRootContainer=k;a[uf]=k.current;sf(8===a.nodeType?a.parentNode:a);Rk(function(){fl(b,k,c,d)});return k}\nfunction rl(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f;if(\"function\"===typeof e){var h=e;e=function(){var a=gl(g);h.call(a)}}fl(b,g,a,e)}else g=ql(c,b,a,e,d);return gl(g)}Ec=function(a){switch(a.tag){case 3:var b=a.stateNode;if(b.current.memoizedState.isDehydrated){var c=tc(b.pendingLanes);0!==c&&(Cc(b,c|1),Dk(b,B()),0===(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var b=ih(a,1);if(null!==b){var c=R();gi(b,a,1,c)}}),il(a,1)}};\nFc=function(a){if(13===a.tag){var b=ih(a,134217728);if(null!==b){var c=R();gi(b,a,134217728,c)}il(a,134217728)}};Gc=function(a){if(13===a.tag){var b=yi(a),c=ih(a,b);if(null!==c){var d=R();gi(c,a,b,d)}il(a,b)}};Hc=function(){return C};Ic=function(a,b){var c=C;try{return C=a,b()}finally{C=c}};\nyb=function(a,b,c){switch(b){case \"input\":bb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(p(90));Wa(d);bb(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Qk;Hb=Rk;\nvar sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"};\nvar ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Zb(a);return null===a?null:a.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||\njl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;\nexports.createPortal=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(b))throw Error(p(200));return cl(a,b,null,c)};exports.createRoot=function(a,b){if(!nl(a))throw Error(p(299));var c=!1,d=\"\",e=kl;null!==b&&void 0!==b&&(!0===b.unstable_strictMode&&(c=!0),void 0!==b.identifierPrefix&&(d=b.identifierPrefix),void 0!==b.onRecoverableError&&(e=b.onRecoverableError));b=bl(a,1,!1,null,null,c,!1,d,e);a[uf]=b.current;sf(8===a.nodeType?a.parentNode:a);return new ll(b)};\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(p(188));a=Object.keys(a).join(\",\");throw Error(p(268,a));}a=Zb(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a){return Rk(a)};exports.hydrate=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!0,c)};\nexports.hydrateRoot=function(a,b,c){if(!nl(a))throw Error(p(405));var d=null!=c&&c.hydratedSources||null,e=!1,f=\"\",g=kl;null!==c&&void 0!==c&&(!0===c.unstable_strictMode&&(e=!0),void 0!==c.identifierPrefix&&(f=c.identifierPrefix),void 0!==c.onRecoverableError&&(g=c.onRecoverableError));b=el(b,null,a,1,null!=c?c:null,e,!1,f,g);a[uf]=b.current;sf(a);if(d)for(a=0;a<d.length;a++)c=d[a],e=c._getVersion,e=e(c._source),null==b.mutableSourceEagerHydrationData?b.mutableSourceEagerHydrationData=[c,e]:b.mutableSourceEagerHydrationData.push(c,\ne);return new ml(b)};exports.render=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!ol(a))throw Error(p(40));return a._reactRootContainer?(Rk(function(){rl(null,null,a,!1,function(){a._reactRootContainer=null;a[uf]=null})}),!0):!1};exports.unstable_batchedUpdates=Qk;\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!ol(c))throw Error(p(200));if(null==a||void 0===a._reactInternals)throw Error(p(38));return rl(a,b,c,!1,d)};exports.version=\"18.3.1-next-f1338f8080-20240426\";\n","import React, { useState } from 'react';\n\n/**\n * A button component that prevents transaction spamming by managing its own state\n * and ensuring only one transaction can be active at a time.\n */\nconst TransactionButton = ({ \n  onAction, \n  children, \n  disabled = false,\n  transactionKey, // unique key for this action type\n  className = '',\n  style = {},\n  ...props \n}) => {\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [transactionId] = useState(() => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const handleClick = async (e) => {\n    if (isProcessing || disabled) return;\n    \n    e.preventDefault();\n    e.stopPropagation();\n    \n    setIsProcessing(true);\n    try {\n      await onAction(transactionId, transactionKey);\n    } catch (error) {\n      console.error('Transaction failed:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <button \n      {...props}\n      onClick={handleClick}\n      disabled={disabled || isProcessing}\n      className={`${className} ${isProcessing ? 'processing' : ''}`}\n      style={{\n        ...style,\n        opacity: (disabled || isProcessing) ? 0.6 : 1,\n        cursor: (disabled || isProcessing) ? 'not-allowed' : 'pointer'\n      }}\n    >\n      {isProcessing ? '' : children}\n    </button>\n  );\n};\n\nexport default TransactionButton;","import playersInGridManager from \"../GridState/PlayersInGrid\";\nimport axios from \"axios\";\nimport API_BASE from \"../config\";\n  \nexport const getIngredientDetails = (recipe, allResources) => {\n  \n    const ingredients = [];\n    for (let i = 1; i <= 4; i++) {\n      const ingredientType = recipe[`ingredient${i}`];\n      const ingredientQty = recipe[`ingredient${i}qty`];\n      if (ingredientType && ingredientQty) {\n        const ingredientResource = allResources.find((res) => res.type === ingredientType);\n        const symbol = ingredientResource?.symbol || '';\n        ingredients.push(`${symbol} ${ingredientType} x${ingredientQty}`);\n      }\n    }\n    return ingredients;\n  };\n  \n\n// Utility Function for Socket Listener\nexport function mergeResources(existingResources, updatedResources) {\n  console.log(\" mergeResources called\");\n  console.log(\" Existing Resources:\", existingResources.length);\n  console.log(\" Updated Resources:\", updatedResources);\n\n  const map = new Map();\n\n  // Add all existing resources to map\n  for (const res of existingResources) {\n    const key = `${res.x},${res.y}`;\n    map.set(key, res);\n  }\n\n  // Track whether any actual changes were made\n  let changed = false;\n\n  // Overwrite with updated ones\n  for (const updated of updatedResources) {\n    const key = `${updated.x},${updated.y}`;\n    const existing = map.get(key);\n    const merged = { ...existing, ...updated };\n\n    // Deep compare for debugging\n    const changedFields = Object.entries(updated).filter(\n      ([k, v]) => existing?.[k] !== v\n    );\n    if (changedFields.length > 0) {\n      console.log(` Resource at (${key}) changed fields:`, changedFields);\n      changed = true;\n    } else {\n      console.log(` Resource at (${key}) unchanged`);\n    }\n\n    map.set(key, merged);\n  }\n\n  const result = Array.from(map.values());\n\n  console.log(\" mergeResources returning new array of length:\", result.length);\n  console.log(\" Resources actually changed?\", changed);\n  return result;\n}\n\n\nexport function mergeTiles(existingTiles, updatedTiles) {\n  console.log(\" mergeTiles called\");\n  console.log(\" Existing Tiles:\", existingTiles.length, \"rows\");\n  console.log(\" Updated Tiles:\", updatedTiles);\n\n  const newTiles = existingTiles.map(row => [...row]); // Create deep copy\n  let changed = false;\n\n  updatedTiles.forEach(({ x, y, type: tileType }) => {\n    if (newTiles[y] && typeof newTiles[y][x] !== 'undefined') {\n      const oldTile = newTiles[y][x];\n      if (oldTile !== tileType) {\n        console.log(` Tile at (${x},${y}) changed from \"${oldTile}\" to \"${tileType}\"`);\n        newTiles[y][x] = tileType;\n        changed = true;\n      } else {\n        console.log(` Tile at (${x},${y}) is already \"${tileType}\"  no change`);\n      }\n    } else {\n      console.warn(` Attempted to update invalid tile at (${x},${y})`);\n    }\n  });\n\n  console.log(\" mergeTiles returning new tile array\");\n  console.log(\" Any tiles changed?\", changed);\n  return newTiles;\n}\n\n\nexport function enrichResourceFromMaster(raw, masterResources) {\n// Used by socket listeners to enrich raw resource data with template details\n  const template = masterResources.find(r => r.type === raw.type);  \n  if (!template) {\n    console.warn(` No matching resource template found for ${raw.type}`);\n    return raw;\n  }\n  return {\n    ...template,\n    ...raw, // Allow raw to override specific fields like growEnd, x, y\n  };\n}\n\nexport function getCurrentTileCoordinates(gridId, currentPlayer) {\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  if (!playersInGrid || !currentPlayer?.playerId) {\n    console.warn(' playersInGrid or playerId missing.');\n    return null;\n  }\n  const playerData = playersInGrid[currentPlayer.playerId];\n  if (!playerData) {\n    console.warn(' Player not found in playersInGrid.');\n    return null;\n  }\n  const { x, y } = playerData.position;\n  if (x == null || y == null) {\n    console.warn(' Invalid player position.');\n    return null;\n  }\n  const tileX = Math.floor(x);\n  const tileY = Math.floor(y);\n  return { tileX, tileY };\n}\n\n// export async function getTileResource(gridId, x, y) {\n//   try {\n//     console.log(`Fetching resource at (${x}, ${y}) in grid ${gridId}`);\n//     const response = await axios.get(`${API_BASE}/api/get-resource/${gridId}/${x}/${y}`);\n//     console.log(`Resource at (${x}, ${y}):`, response.data);\n//     return response.data;\n//   } catch (error) {\n//     console.error(`Error fetching resource at (${x}, ${y}) in grid ${gridId}:`, error);\n//     throw error;\n//   }\n// }\n\nexport async function validateTileType(gridId, x, y) {\n  try {\n    console.log(`Validating tile type at (${x}, ${y}) in grid ${gridId}`);\n    const response = await axios.get(`${API_BASE}/api/get-tile/${gridId}/${x}/${y}`);\n    console.log(`Tile type at (${x}, ${y}):`, response.data.tileType);\n    return response.data.tileType;\n  } catch (error) {\n    console.error(`Error fetching tile type at (${x}, ${y}) in grid ${gridId}:`, error);\n    throw error;\n  }\n}\n\n/**\n * Check if an item is a crop (output of farmplot)\n * @param {string} itemType - The item type to check\n * @param {Array} masterResources - Master resources array\n * @returns {boolean} True if the item is a crop\n */\nexport function isACrop(itemType, masterResources) {\n  // Exclude trees from being considered crops\n  if (itemType === 'Oak Tree' || itemType === 'Pine Tree') {\n    return false;\n  }\n  \n  // Check if this item is the output of any farmplot resource\n  return masterResources.some(resource => \n    resource.category === 'farmplot' && resource.output === itemType\n  );\n}\n\n","// GlobalGridStateTilesAndResources.js\nconst GlobalGridStateTilesAndResources = {\n    tiles: [],\n    resources: [],\n  \n    // Setter for tiles\n    setTiles(newTiles) {\n      this.tiles = newTiles;\n      //console.log('Global tiles updated:', this.tiles);\n    },\n  \n    // Setter for resources\n    setResources(newResources) {\n      this.resources = newResources;\n      //console.log('Global resources updated:', this.resources);\n    },\n  \n    // Getter for tiles\n    getTiles() {\n      return this.tiles;\n    },\n  \n    // Getter for resources\n    getResources() {\n      return this.resources;\n    },\n  };\n  \n  export default GlobalGridStateTilesAndResources;","import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport './FTUE.css';\nimport FTUEstepsData from './FTUEsteps.json';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { showNotification } from '../../UI/Notifications/Notifications';\n\n\nconst FTUE = ({ currentPlayer, setCurrentPlayer, onClose, openPanel, setActiveQuestGiver, gridId, setActiveStation, masterResources, setResources, TILE_SIZE }) => {\n  const strings = useStrings();\n  const [currentStepData, setCurrentStepData] = useState(null);\n  const [imageLoaded, setImageLoaded] = useState(false);\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n  const [positiveReasons, setPositiveReasons] = useState([]);\n  const [negativeReasons, setNegativeReasons] = useState([]);\n  \n  // Load the current step data based on player's ftuestep\n  useEffect(() => {\n    // Only show FTUE if player is explicitly a first-time user\n    if (currentPlayer?.firsttimeuser !== true) {\n      console.log('Player is not a first-time user, closing FTUE');\n      onClose();\n      return;\n    }\n    \n    // Handle step 0 by showing step 1 content without advancing yet\n    if (currentPlayer?.ftuestep === 0) {\n      console.log(' Player at FTUE step 0, showing step 1 content');\n      const step1Data = FTUEstepsData.find(step => step.step === 1);\n      if (step1Data) {\n        setCurrentStepData(step1Data);\n      }\n      return;\n    }\n    \n    // Check if we're at step 5 and need to show feedback modal\n    // Only show if no feedback has been collected yet (either positive OR negative feedback exists)\n    const hasFeedback = currentPlayer?.ftueFeedback && \n      (currentPlayer.ftueFeedback.positive?.length > 0 || currentPlayer.ftueFeedback.negative?.length > 0);\n    \n    if (currentPlayer?.ftuestep === 5) {\n      if (!hasFeedback) {\n        setShowFeedbackModal(true);\n        return;\n      } else {\n        // User already has feedback but is stuck at step 5 - advance them to step 6\n        console.log(' User at step 5 already has feedback, advancing to step 6');\n        const advanceToStep6 = async () => {\n          try {\n            const response = await axios.post(`${API_BASE}/api/update-profile`, {\n              playerId: currentPlayer.playerId,\n              updates: { ftuestep: 6 }\n            });\n            if (response.data.success) {\n              setCurrentPlayer(prev => ({\n                ...prev,\n                ftuestep: 6\n              }));\n            }\n          } catch (error) {\n            console.error('Error advancing step 5 user to step 6:', error);\n          }\n        };\n        advanceToStep6();\n        return;\n      }\n    }\n    \n    if (currentPlayer?.ftuestep) {\n      const stepData = FTUEstepsData.find(step => step.step === currentPlayer.ftuestep);\n      if (stepData) {\n        setCurrentStepData(stepData);\n      } else {\n        // If no valid step found, close the FTUE\n        console.log('No valid FTUE step found for step:', currentPlayer.ftuestep);\n        onClose();\n      }\n    }\n  }, [currentPlayer?.ftuestep, currentPlayer?.firsttimeuser, onClose]);\n\n  // Preload image when step data changes\n  useEffect(() => {\n    if (currentStepData?.image) {\n      setImageLoaded(false);\n      const img = new Image();\n      img.src = `/assets/${currentStepData.image}`;\n      img.onload = () => {\n        setImageLoaded(true);\n      };\n      img.onerror = () => {\n        console.error('Failed to load FTUE image:', currentStepData.image);\n        setImageLoaded(true); // Still show modal even if image fails\n      };\n    }\n  }, [currentStepData]);\n\n  // Handle feedback submission\n  const handleFeedbackSubmit = async (isPositive) => {\n    try {\n      // Detect browser type\n      const getBrowserType = () => {\n        const userAgent = navigator.userAgent;\n        if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) return 'Chrome';\n        if (userAgent.includes('Firefox')) return 'Firefox';\n        if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) return 'Safari';\n        if (userAgent.includes('Edg')) return 'Edge';\n        if (userAgent.includes('Opera') || userAgent.includes('OPR')) return 'Opera';\n        return 'Unknown';\n      };\n\n      const browserType = getBrowserType();\n\n      // Save feedback to database and advance to step 5\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { \n          ftueFeedback: {\n            positive: isPositive ? positiveReasons : [],\n            negative: !isPositive ? negativeReasons : [],\n            browser: browserType\n          },\n          ftuestep: 6 // Advance to step 6 after feedback\n        }\n      });\n      \n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          ftueFeedback: {\n            positive: isPositive ? positiveReasons : [],\n            negative: !isPositive ? negativeReasons : [],\n            browser: browserType\n          },\n          ftuestep: 6 // Update local state to step 6\n        }));\n        \n        // Hide feedback modal and close FTUE (player is now at step 6)\n        setShowFeedbackModal(false);\n        onClose(); // Close the entire FTUE modal since player advanced to step 6\n      }\n    } catch (error) {\n      console.error('Error saving FTUE feedback:', error);\n      // Continue anyway to not block the user\n      setShowFeedbackModal(false);\n      onClose(); // Close the entire FTUE modal\n    }\n  };\n\n  const handleOK = async () => {\n    try {\n      // If we're showing step 1 content but player is still at step 0, advance to step 1\n      const currentStep = currentPlayer.ftuestep === 0 ? 1 : currentPlayer.ftuestep;\n      const actualCurrentStep = currentPlayer.ftuestep;\n      const nextStep = currentStep + 1;      \n      // Check if there's a next step in the data\n      const hasNextStep = FTUEstepsData.some(step => step.step === nextStep);\n      \n      // Get current step data to check for notification\n      const stepData = FTUEstepsData.find(step => step.step === currentStep);\n      if (stepData?.notificationKey) {\n        showNotification('To Do', {\n          title: strings[7001],\n          message: strings[stepData.notificationKey]\n        });\n      }\n      \n//////////// FTUE STEP 3 /////////////\n\n      if (currentStep === 3 && openPanel) {\n        console.log(` Step 3: Auto-accepting quests and opening QuestPanel`);\n        \n        \n        // Auto-accept quest 5 (Harvest Wheat) and quest 6 (Learn to Sell)\n        const playerAfterQuest5 = await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 5);\n        await addAcceptedQuest(currentPlayer.playerId, playerAfterQuest5, setCurrentPlayer, 6);\n        \n        console.log(` Added quests 5 and 6, opening QuestPanel`);\n        \n        onClose(); // Close FTUE modal first\n        openPanel('QuestPanel'); // Open the quest panel\n\n//////////// FTUE STEP 4 /////////////\n\n      } else if (currentStep === 4) {\n        console.log(` Processing FTUE step 4 - Grower skill`);\n        \n        // Add the Grower quest (quest 7)\n        await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 7);\n        \n        onClose(); // Close FTUE modal\n        \n        // Auto-open the Skills panel\n        if (openPanel) {\n          console.log(` Step 4: Opening Skills panel`);\n          setActiveStation(null); // Clear active station to prevent Trading Post from re-opening\n          openPanel('SkillsPanel');\n        }\n\n//////////// FTUE STEP 5 /////////////\n\n      } else if (currentStep === 5) {\n        console.log(` Processing FTUE step 5 - Feedback modal`);\n        \n        // Step 5 is now handled by the feedback modal logic\n        // This shouldn't be reached if feedback modal is working correctly\n        onClose();\n\n//////////// FTUE STEP 6 /////////////\n\n      } else if (currentStep === 6) {\n        console.log(` Processing FTUE step 6 - Plant quest`);\n        \n        // Add the Plant quest (quest 4)\n        await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 4);\n        \n        onClose(); // Close FTUE modal\n        \n        // Auto-open the Farming panel\n        if (openPanel) {\n          console.log(` Step 6: Auto-opening Farming panel`);\n          openPanel('FarmingPanel');\n        }\n\n//////////// FTUE STEP 7 /////////////\n\n      } else if (currentStep === 7 && openPanel) {\n        console.log(` Processing FTUE step 7 - Adding quests 18 and 19`);\n        \n        // Auto-accept quests 18 and 19\n        const playerAfterQuest18 = await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 18);\n        await addAcceptedQuest(currentPlayer.playerId, playerAfterQuest18, setCurrentPlayer, 19);\n        \n        onClose(); // Close FTUE modal first\n        \n        // Auto-open the Skills panel\n        if (openPanel) {\n          console.log(` Step 7: Opening Skills panel`);\n          setActiveStation(null); // Clear active station to prevent other panels from re-opening\n          openPanel('SkillsPanel');\n        }\n\n//////////// FTUE STEP 8 /////////////\n\n      } else if (currentStep === 8 && openPanel) {\n        console.log(` Processing FTUE step 8 - Adding shepherd and axe quests`);\n        \n        // Add the shepherd quest (quest 8) and Get Axe quest (quest 10)\n        await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 8);\n        await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 10);\n         \n        onClose(); // Close FTUE modal first\n        openPanel('QuestPanel');\n\n//////////// FTUE STEP 9 /////////////\n\n      } else if (currentStep === 9) {\n        console.log(` Processing FTUE step 9 - axe acquired`);\n        \n        // No quest to add here since Get Axe quest was already added at step 8\n        \n        onClose(); // Close FTUE modal\n\n//////////// FTUE STEP 10 /////////////\n\n      } else if (currentStep === 10) {\n        console.log(` Adding Wizard quest after FTUE step ${currentStep}`);\n        \n        // Add the Axe quest\n        await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 1);\n        await completeTutorial();\n\n        onClose(); // Close FTUE modal\n        return; // Don't continue with normal step advancement\n      }\n\n      if (!hasNextStep) {\n        completeTutorial();\n\n      } else {\n        const stepData = FTUEstepsData.find(step => step.step === currentStep);\n        if (stepData?.continue) {\n          // If the current step has a continue action, advance the FTUE step\n          // Use actualCurrentStep to handle step 0 -> 1 transition properly\n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { ftuestep: actualCurrentStep + 1 }\n          });\n          if (response.data.success) {\n            setCurrentPlayer(prev => ({\n              ...prev,\n              ftuestep: actualCurrentStep + 1\n            }));\n            onClose();\n          }\n        } else {  \n          onClose();\n          return;\n        } \n      }\n\n    } catch (error) {\n      console.error('Error advancing FTUE step:', error);\n    }\n  };\n\n  const completeTutorial = async () => {\n    try {\n      // First check if the Wizard quest (index=1) has already been added\n      const currentActiveQuests = currentPlayer?.activeQuests || [];\n      const wizardQuestExists = currentActiveQuests.some(q => q.questId === \"Find the Wizard in the Valley\");\n      \n      let finalActiveQuests = currentActiveQuests;\n      \n      if (!wizardQuestExists) {\n        console.log(' Adding completed Wizard quest before completing tutorial');\n        \n        // Add the quest with index=1\n        const updatedPlayer = await addAcceptedQuest(currentPlayer.playerId, currentPlayer, setCurrentPlayer, 1);\n        \n        // Mark it as completed\n        if (updatedPlayer.activeQuests && updatedPlayer.activeQuests.length > 0) {\n          const questIndex = updatedPlayer.activeQuests.findIndex(q => q.questId === \"Find the Wizard in the Valley\");\n          if (questIndex !== -1) {\n            updatedPlayer.activeQuests[questIndex].completed = true;\n            finalActiveQuests = updatedPlayer.activeQuests;\n            \n            // Save the completed quest\n            await axios.post(`${API_BASE}/api/update-profile`, {\n              playerId: currentPlayer.playerId,\n              updates: { activeQuests: finalActiveQuests }\n            });\n          }\n        }\n      } else {\n        console.log(' Wizard quest already exists, skipping addition');\n      }\n      \n      \n      // Update the player's firsttimeuser flag to false and remove ftuestep\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { \n          firsttimeuser: false,\n          ftuestep: null  // This will remove the field from the document\n        }\n      });\n      \n      if (response.data.success) {\n        // Update local player state\n        setCurrentPlayer(prev => {\n          const updated = {\n            ...prev,\n            firsttimeuser: false,\n            activeQuests: finalActiveQuests\n          };\n          delete updated.ftuestep;  // Remove ftuestep from local state\n          return updated;\n        });\n        \n        // Close the tutorial\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error completing tutorial:', error);\n      // Close anyway to not block the user\n      onClose();\n    }\n  };\n\n\n\n  // Handle aspiration choice for step 2\n  const handleAspirationChoice = async (aspiration) => {\n    try {\n      // Update player's aspiration in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { \n          aspiration: aspiration,\n          ftuestep: 3 // Advance to next step after choosing\n        }\n      });\n      \n      if (response.data.success) {\n        setCurrentPlayer(prev => ({\n          ...prev,\n          aspiration: aspiration,\n          ftuestep: 3\n        }));\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error setting aspiration:', error);\n    }\n  };\n\n  // Handle checkbox toggle\n  const toggleReason = (reasonIndex, isPositive) => {\n    if (isPositive) {\n      setPositiveReasons(prev => \n        prev.includes(reasonIndex) \n          ? prev.filter(r => r !== reasonIndex)\n          : [...prev, reasonIndex]\n      );\n    } else {\n      setNegativeReasons(prev => \n        prev.includes(reasonIndex) \n          ? prev.filter(r => r !== reasonIndex)\n          : [...prev, reasonIndex]\n      );\n    }\n  };\n\n  // Don't render if no step data or (image not loaded for non-step-2)\n  if (!currentStepData || (currentPlayer?.ftuestep !== 2 && !imageLoaded)) {\n    // But DO render if we're showing the feedback modal\n    if (!showFeedbackModal) {\n      return null;\n    }\n  }\n\n  // Render feedback modal if showing\n  if (showFeedbackModal) {\n    return (\n      <div className=\"ftue-overlay\">\n        <div className=\"ftue-modal\">\n          <div className=\"ftue-header\">\n            <h2>{strings[780]}</h2>\n          </div>\n          \n          <div className=\"ftue-feedback-content\">\n            {/* Positive feedback section */}\n            <div className=\"ftue-feedback-section\">\n              <h3>{strings[781]}</h3>\n              <div className=\"ftue-feedback-options\">\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(784)}\n                    onChange={() => toggleReason(784, true)}\n                  />\n                  {strings[784]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(785)}\n                    onChange={() => toggleReason(785, true)}\n                  />\n                  {strings[785]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(786)}\n                    onChange={() => toggleReason(786, true)}\n                  />\n                  {strings[786]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(787)}\n                    onChange={() => toggleReason(787, true)}\n                  />\n                  {strings[787]}\n                </label>\n              </div>\n              <button \n                className=\"ftue-button ftue-button-primary\" \n                onClick={() => handleFeedbackSubmit(true)}\n              >\n                {strings[783]}\n              </button>\n            </div>\n            \n            {/* Negative feedback section */}\n            <div className=\"ftue-feedback-section\">\n              <h3>{strings[782]}</h3>\n              <div className=\"ftue-feedback-options\">\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(790)}\n                    onChange={() => toggleReason(790, false)}\n                  />\n                  {strings[790]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(791)}\n                    onChange={() => toggleReason(791, false)}\n                  />\n                  {strings[791]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(792)}\n                    onChange={() => toggleReason(792, false)}\n                  />\n                  {strings[792]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(793)}\n                    onChange={() => toggleReason(793, false)}\n                  />\n                  {strings[793]}\n                </label>\n              </div>\n              <button \n                className=\"ftue-button ftue-button-primary\" \n                onClick={() => handleFeedbackSubmit(false)}\n              >\n                {strings[794]}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Custom render for step 2 - Aspiration choice\n  if (currentPlayer?.ftuestep === 2) {\n    return (\n      <div className=\"ftue-overlay\">\n        <div className=\"ftue-modal\">\n          <div className=\"ftue-header\">\n            <h2>{strings[currentStepData.titleKey]}</h2>\n          </div>\n          \n          <div className=\"ftue-text\">\n            <p>{strings[currentStepData.bodyKey]}</p>\n          </div>\n          \n          <div className=\"ftue-aspiration-content\">\n            <div className=\"ftue-aspiration-panels\">\n              {/* Panel 1 */}\n              <div \n                className=\"ftue-aspiration-panel\" \n                onClick={() => handleAspirationChoice(1)}\n              >\n                <h3>{strings[750]}</h3>\n                <p>{strings[751]}</p>\n              </div>\n              \n              {/* Panel 2 */}\n              <div \n                className=\"ftue-aspiration-panel\" \n                onClick={() => handleAspirationChoice(2)}\n              >\n                <h3>{strings[752]}</h3>\n                <p>{strings[753]}</p>\n              </div>\n              \n              {/* Panel 3 */}\n              <div \n                className=\"ftue-aspiration-panel\" \n                onClick={() => handleAspirationChoice(3)}\n              >\n                <h3>{strings[754]}</h3>\n                <p>{strings[755]}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Standard render for other steps\n  return (\n    <div className=\"ftue-overlay\">\n      <div className=\"ftue-modal\">\n        <div className=\"ftue-header\">\n          <h2>{strings[currentStepData.titleKey]}</h2>\n        </div>\n        \n        <div className=\"ftue-text\">\n          <p>{strings[currentStepData.bodyKey]}</p>\n        </div>\n\n        <div className=\"ftue-content\">\n          <div className=\"ftue-image-container\">\n            <img \n              src={`/assets/${currentStepData.image}`} \n              alt={strings[currentStepData.titleKey]}\n              className=\"ftue-image\"\n            />\n          </div>\n          \n          <div className=\"ftue-buttons\">\n            <button className=\"ftue-button ftue-button-primary\" onClick={handleOK}>{strings[796]}</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Export function to get current FTUE step from DB and sync with local state\nexport const getFTUEStep = async (playerId, currentPlayer, setCurrentPlayer) => {\n  try {\n    // Fetch player data from DB\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const dbFtueStep = response.data.ftuestep;\n    \n    // Update local state if different from DB\n    if (currentPlayer && currentPlayer.ftuestep !== dbFtueStep) {\n      console.log(' Syncing FTUE step from DB:', dbFtueStep);\n      setCurrentPlayer(prev => ({\n        ...prev,\n        ftuestep: dbFtueStep\n      }));\n    }\n    \n    return dbFtueStep || 0;\n  } catch (error) {\n    console.error('Error fetching FTUE step:', error);\n    return currentPlayer?.ftuestep || 0;\n  }\n};\n\n// Export function to increment FTUE step in both DB and local state\nexport const incrementFTUEStep = async (playerId, currentPlayer, setCurrentPlayer) => {\n  try {\n    const currentStep = currentPlayer?.ftuestep || 0;\n    const nextStep = currentStep + 1;\n    \n    // Check if the next step exists in the data\n    const nextStepExists = FTUEstepsData.some(step => step.step === nextStep);\n    \n    if (!nextStepExists) {\n      console.log(' No more FTUE steps available after step', currentStep);\n      return currentStep;\n    }\n    \n    // Update DB\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: { ftuestep: nextStep }\n    });\n    \n    if (response.data.success) {\n      // Update local state - this will trigger the modal via the useEffect in App.js\n      setCurrentPlayer(prev => ({\n        ...prev,\n        ftuestep: nextStep\n      }));\n      \n      console.log(' FTUE step incremented to:', nextStep);\n      return nextStep;\n    }\n    \n    return currentStep;\n  } catch (error) {\n    console.error('Error incrementing FTUE step:', error);\n    return currentPlayer?.ftuestep || 0;\n  }\n};\n\n// Export function to add an accepted quest to player data\nexport const addAcceptedQuest = async (playerId, currentPlayer, setCurrentPlayer, questIndex) => {\n  try {\n    // Fetch quest template from API\n    const response = await axios.get(`${API_BASE}/api/quests`);\n    const questTemplates = response.data || [];\n    \n    // Find the specific quest template by index\n    const questTemplate = questTemplates.find(q => q.index === questIndex);\n    if (!questTemplate) {\n      console.error(` Quest template not found for index: ${questIndex}`);\n      return currentPlayer;\n    }\n    \n    // Create the quest object following the activeQuests format\n    const newQuest = {\n      questId: questTemplate.title, // Use title from template\n      startTime: Date.now(),\n      symbol: questTemplate.symbol || '',\n      progress: {\n        goal1: 0,\n        goal2: 0,\n        goal3: 0\n      },\n      completed: false,\n      rewardCollected: false,\n      // Add goal fields from template\n      goal1action: questTemplate.goal1action || null,\n      goal1item: questTemplate.goal1item || null,\n      goal1qty: questTemplate.goal1qty || null,\n      goal2action: questTemplate.goal2action || null,\n      goal2item: questTemplate.goal2item || null,\n      goal2qty: questTemplate.goal2qty || null,\n      goal3action: questTemplate.goal3action || null,\n      goal3item: questTemplate.goal3item || null,\n      goal3qty: questTemplate.goal3qty || null\n    };\n    \n    // Get current active quests\n    const currentActiveQuests = currentPlayer?.activeQuests || [];\n    \n    // Check if quest already exists\n    const questExists = currentActiveQuests.some(q => q.questId === questTemplate.title);\n    if (questExists) {\n      console.log(` Quest \"${questTemplate.title}\" already exists in active quests`);\n      return currentPlayer;\n    }\n    \n    // Add new quest to active quests\n    const updatedActiveQuests = [...currentActiveQuests, newQuest];\n    \n    // Update database\n    const updateResponse = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: { activeQuests: updatedActiveQuests }\n    });\n    \n    if (updateResponse.data.success) {\n      // Update local state\n      const updatedPlayer = {\n        ...currentPlayer,\n        activeQuests: updatedActiveQuests\n      };\n      setCurrentPlayer(updatedPlayer);\n      \n      console.log(` Quest \"${questTemplate.title}\" added to active quests`);\n      return updatedPlayer;\n    }\n    \n    return currentPlayer;\n  } catch (error) {\n    console.error('Error adding accepted quest:', error);\n    return currentPlayer;\n  }\n};\n\nexport default FTUE;","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","import axios from 'axios';\nimport { updateGridResource } from './Utils/GridManagement';\n\nlet farmTimer = null;\n\nclass FarmState {\n    constructor() {\n      this.farmState = [];\n    }\n  \n    initializeFarmState(resources = []) {\n      this.farmState = resources.filter((res) => res.category === 'farmplot' && res.growEnd);\n      \n      \n    }\n  \n    addSeed(seed) {\n      if (!seed.output) {\n        console.warn(' Trying to add a seed without an output! This will break later.', seed);\n      }\n      this.farmState.push(seed);\n    }\n\n  /**\n   * Process seeds periodically to check for growth completion.\n   */\n  startSeedTimer({ gridId, setResources, masterResources }) {\n    if (farmTimer) clearInterval(farmTimer);\n    \n    // Store the current gridId to check if we're still on the same grid\n    const currentGridId = gridId;\n    \n  \n    farmTimer = setInterval(async () => {\n      //console.log('FarmState timer ticking.');\n      //console.log('Current farmState:', this.farmState);\n  \n      const now = Date.now();\n      const completedSeeds = this.farmState.filter((seed) => seed.growEnd <= now);\n      //console.log('Completed seeds:', completedSeeds);\n  \n      if (completedSeeds.length > 0) {\n\n        // Process seeds sequentially to match server processing speed\n        let successfulCount = 0;\n        \n        for (const seed of completedSeeds) {\n          // First check if this seed still exists in current farmState\n          // (it might have been removed by bulk harvest)\n          const stillExists = this.farmState.some(s => \n            s.x === seed.x && s.y === seed.y && s.type === seed.type\n          );\n          \n          if (!stillExists) {\n            console.log(`Seed at (${seed.x}, ${seed.y}) no longer exists in farmState, skipping conversion.`);\n            continue;\n          }\n          \n          const newCrop = masterResources.find((res) => res.type === seed.output);\n          \n          if (!newCrop) {\n            console.warn(`No target resource found for seed output: ${seed.output}`);\n            continue;\n          }\n\n          try {\n            const response = await updateGridResource(\n              currentGridId, \n              { \n                type: newCrop.type,\n                x: seed.x,\n                y: seed.y,\n              },\n              true\n            );\n\n            if (response?.success) {\n              \n              const enriched = {\n                ...newCrop,\n                x: seed.x,\n                y: seed.y\n              };\n\n              // Update UI only after server confirms the update\n              setResources(prev => {\n                const filtered = prev.filter(r => !(r.x === seed.x && r.y === seed.y));\n                return [...filtered, enriched];\n              });\n              \n              // Remove from farmState after successful conversion\n              this.farmState = this.farmState.filter(s => !(s.x === seed.x && s.y === seed.y && s.type === seed.type));\n              \n              successfulCount++;\n              \n              // Add a small delay between conversions to make them visually distinct\n              // This also helps prevent overwhelming the server and keeps us in sync\n              // Using 120ms to match observed server processing time\n              await new Promise(resolve => setTimeout(resolve, 120));\n            } else {\n              console.warn(`Failed to update grid resource for seed at (${seed.x}, ${seed.y}).`);\n            }\n          } catch (error) {\n            console.error(`Error updating grid resource for seed at (${seed.x}, ${seed.y}):`, error);\n          }\n        }\n        \n      }\n    }, 1000);\n  }\n\n  \n  /**\n   * Force process any seeds that are ready to convert\n   * This ensures client/server sync before operations like bulk harvest\n   */\n  async forceProcessPendingSeeds({ gridId, setResources, masterResources }) {\n    const now = Date.now();\n    const completedSeeds = this.farmState.filter((seed) => seed.growEnd <= now);\n    \n    if (completedSeeds.length === 0) {\n      return true;\n    }\n    \n    try {\n      // Process all completed seeds\n      const updatePromises = completedSeeds.map(async (seed) => {\n        const newCrop = masterResources.find((res) => res.type === seed.output);\n        \n        if (!newCrop) {\n          console.warn(`No target resource found for seed output: ${seed.output}`);\n          return null;\n        }\n\n        try {\n          const response = await updateGridResource(\n            gridId, \n            { \n              type: newCrop.type,\n              x: seed.x,\n              y: seed.y,\n            },\n            true\n          );\n\n          if (response?.success) {\n            return { seed, enriched: { ...newCrop, x: seed.x, y: seed.y } };\n          }\n          return null;\n        } catch (error) {\n          console.error(`Error syncing seed at (${seed.x}, ${seed.y}):`, error);\n          return null;\n        }\n      });\n\n      // Wait for all updates\n      const results = await Promise.all(updatePromises);\n      const successfulUpdates = results.filter(result => result !== null);\n      \n      // Update local state\n      if (successfulUpdates.length > 0) {\n        setResources(prev => {\n          const seedPositions = successfulUpdates.map(({ seed }) => `${seed.x},${seed.y}`);\n          const filtered = prev.filter(r => !seedPositions.includes(`${r.x},${r.y}`));\n          const newCrops = successfulUpdates.map(({ enriched }) => enriched);\n          return [...filtered, ...newCrops];\n        });\n        \n        // Remove from farmState\n        const processedSeeds = successfulUpdates.map(({ seed }) => seed);\n        this.farmState = this.farmState.filter(s => !processedSeeds.includes(s));\n      }\n      \n      return true;\n    } catch (error) {\n      console.error(' Error during force sync:', error);\n      return false;\n    }\n  }\n  \n  /**\n   * Stop the seed timer.\n   */\n  stopSeedTimer() {\n    if (farmTimer) clearInterval(farmTimer);\n    farmTimer = null;\n    // Clear farmState when stopping to prevent stale data\n    this.farmState = [];\n  }\n}\n\nconst farmStateInstance = new FarmState();\nexport default farmStateInstance;","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport TransactionButton from '../../UI/TransactionButton';\nimport './AnimalPanel.css';\n\nconst AnimalPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  npcId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) => {\n\n  const [stallDetails, setStallDetails] = useState(null);\n  const [currentNPC, setCurrentNPC] = useState(null);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n  const strings = useStrings();\n\n  console.log('--------Inside Animal Panel:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const stallResource = masterResources.find((res) => res.type === stationType);\n    setStallDetails(stallResource);\n  }, [stationType, masterResources]);\n\n  // Get current NPC data and update it periodically\n  useEffect(() => {\n    const updateNPCData = () => {\n      if (npcId && gridId) {\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n        const npc = Object.values(npcsInGrid).find(n => n.id === npcId);\n        setCurrentNPC(npc);\n      }\n    };\n\n    updateNPCData(); // Initial load\n    const interval = setInterval(updateNPCData, 1000); // Update every second for live status\n\n    return () => clearInterval(interval);\n  }, [npcId, gridId]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Function to generate status text like the tooltip\n  const getNPCStatusText = (npc) => {\n    if (!npc) return \"Unknown status\";\n    \n    switch (npc.state) {\n      case 'processing':\n        return \"is ready.\";\n      case 'hungry':\n        const lookingFor = npc.type === 'Pig' ? 'dirt' : 'grass';\n        return `is hungry and looking for ${lookingFor}.`;\n      case 'grazing':\n        if (npc.grazeEnd) {\n          const remainingTime = Math.max(0, npc.grazeEnd - currentTime);\n          const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n          const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n          return `is grazing. ${minutes}m ${seconds}s`;\n        }\n        return \"is grazing.\";\n      case 'roam':\n        return \"is roaming.\";\n      case 'stall':\n        return \"is looking for an Animal Stall.\";\n      default:\n        return `is in ${npc.state} state.`;\n    }\n  };\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    const ingredients = [];\n    for (let i = 1; i <= 3; i++) {\n      const ingredientType = stallDetails[`ingredient${i}`];\n      const ingredientQty = stallDetails[`ingredient${i}qty`];\n      if (ingredientType && ingredientQty) {\n        ingredients.push({ type: ingredientType, quantity: ingredientQty });\n      }\n    }\n    if (!ingredients.length) { console.error('No ingredients found for refund.'); return; }\n\n    try {\n      for (const { type, quantity } of ingredients) {\n        const success = await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: type,\n          quantity,\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n        if (!success) return;\n      }\n\n      // Update currentPlayer with the new inventory to ensure money display updates\n      setCurrentPlayer(prev => ({ \n        ...prev, \n        inventory: inventory,\n        backpack: backpack \n      }));\n\n      // Note: We don't remove the animal stall building here - only the NPC\n      // The stall building can be sold separately from the AnimalStall panel\n\n      // Remove the animal NPC from NPCsInGrid using the specific NPC ID\n      try {\n        if (npcId) {\n          console.log(` Removing animal NPC ${npcId} (original position: ${currentStationPosition.x}, ${currentStationPosition.y})`);\n          await NPCsInGridManager.removeNPC(gridId, npcId);\n          console.log(\" Animal NPC removed from NPCsInGrid.\");\n        } else {\n          console.error(\"No NPC ID provided - cannot remove animal NPC\");\n        }\n      } catch (error) {\n        console.error('Error removing NPC:', error);\n      }\n\n      const totalRefund = ingredients\n        .filter((item) => item.type === \"Money\")\n        .reduce((sum, item) => sum + item.quantity, 0);\n\n      console.log(`Sold ${stationType} successfully for ${totalRefund} Money.`);\n      updateStatus(`Sold ${getLocalizedString(stationType, strings)} for ${totalRefund} ${getLocalizedString('Money', strings)}.`);\n      onClose();\n    } catch (error) {\n      console.error('Error selling the stall:', error);\n    }\n  };\n  \n\n  return (\n    <Panel onClose={onClose} titleKey=\"1129\" panelName=\"AnimalPanel\" >\n      <div className=\"animal-panel-container\">\n        <div className=\"animal-panel-content\">\n          <h2>\n              {stallDetails?.symbol || ''} {getLocalizedString(stationType, strings)}\n          </h2>\n\n          {/* Show current NPC status */}\n          {currentNPC && (\n            <p>\n              <strong>{getLocalizedString(currentNPC.type, strings)}</strong> {getNPCStatusText(currentNPC)}\n            </p>\n          )}\n        </div>\n        \n        {currentPlayer.location.gtype === 'homestead' && (\n          <div className=\"animal-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(AnimalPanel);\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './Notifications.css';\nimport { useStrings } from '../StringsContext';\n\n// Global notification manager\nlet notificationRoot = null;\nlet notificationTimer = null;\nlet globalClickHandlers = {};\n\n/**\n * Generic notification component\n */\nfunction Notification({ type, data, onDismiss, onClick }) {\n    const strings = useStrings();\n    \n    // Add unmount detection\n    React.useEffect(() => {\n        return () => {\n        };\n    }, []);\n    \n    React.useEffect(() => {\n        // Auto-dismiss after 5 seconds (except for 'To Do' and 'Message' notifications)\n        if (type !== 'To Do' && type !== 'Message') {\n            const timer = setTimeout(() => {\n                onDismiss();\n            }, 5000);\n            \n            return () => {\n                clearTimeout(timer);\n            };\n        } else {\n        }\n        // Remove onDismiss from dependencies to prevent re-running effect\n    }, [type]);\n    \n    // Render different content based on notification type\n    const renderContent = () => {\n        switch (type) {\n            case 'Trophy':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                            {data.type === 'Progress' && data.progress && (\n                                <div className=\"notification-milestone\">{data.progress}</div>\n                            )}\n                            {data.type === 'Count' && data.qty && (\n                                <div className=\"notification-milestone\">{data.qty}x</div>\n                            )}\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{strings[6003]}</div>\n                            <div className=\"notification-name\">{data.name}</div>\n                        </div>\n                    </>\n                );\n            \n            case 'Phase Change':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">Phase Change</div>\n                            <div className=\"notification-name\">{data.message || 'Day has turned to night'}</div>\n                        </div>\n                    </>\n                );\n            \n            case 'Message':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || 'New Message'}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'To Do':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[204]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'Tip':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[7001]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            default:\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\"></div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">Notification</div>\n                            <div className=\"notification-name\">{data.message || 'Something happened!'}</div>\n                        </div>\n                    </>\n                );\n        }\n    };\n    \n    // Add persistent class for notifications that shouldn't auto-dismiss\n    const isPersistent = type === 'To Do' || type === 'Message';\n    const className = `notification ${isPersistent ? 'notification-persistent' : ''}`;\n    \n    return (\n        <div className={className} onClick={onClick} style={{ cursor: onClick ? 'pointer' : 'default' }}>\n            <button className=\"notification-dismiss\" onClick={(e) => {\n                e.stopPropagation();\n                onDismiss();\n            }}></button>\n            <div className=\"notification-content\">\n                {renderContent()}\n            </div>\n        </div>\n    );\n}\n\n/**\n * Shows a notification\n * @param {string} type - The type of notification ('Trophy', 'Phase Change', 'Message', etc.)\n * @param {Object} data - The data to display in the notification\n * @param {Function} onClick - Optional click handler for the notification\n */\n/**\n * Register a global click handler for a notification type\n * @param {string} type - The notification type\n * @param {Function} handler - The click handler\n */\nexport function registerNotificationClickHandler(type, handler) {\n    globalClickHandlers[type] = handler;\n}\n\nexport function showNotification(type, data, onClick = null) {\n    console.log(`[showNotification] Called with type: ${type}`, data);\n    // Clear any existing notification\n    if (notificationTimer) {\n        clearTimeout(notificationTimer);\n    }\n    \n    // Create or reuse the notification container\n    let container = document.getElementById('notification-container');\n    if (!container) {\n        container = document.createElement('div');\n        container.id = 'notification-container';\n        // Append to game container instead of body\n        const gameContainer = document.querySelector('.game-container') || document.querySelector('.App') || document.body;\n        gameContainer.appendChild(container);\n    }\n    \n    if (!notificationRoot) {\n        notificationRoot = ReactDOM.createRoot(container);\n    }\n    \n    const handleDismiss = () => {\n        console.log(`[handleDismiss] Dismissing notification of type: ${type}`);\n        if (notificationRoot) {\n            notificationRoot.render(null);\n        }\n    };\n    \n    // Use passed onClick or fall back to global handler for this type\n    const clickHandler = onClick || (globalClickHandlers[type] ? () => globalClickHandlers[type](data) : null);\n    \n    // Use a unique key to force React to remount the component and trigger animation\n    const notificationKey = `${type}-${Date.now()}`;\n    \n    notificationRoot.render(\n        <Notification \n            key={notificationKey}\n            type={type}\n            data={data}\n            onDismiss={handleDismiss}\n            onClick={clickHandler}\n        />\n    );\n}","import React, { useState, useRef, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport './FloatingText.css';\nimport { calculateTileCenter } from '../VFX/VFX.js';\nimport { useStrings } from '../UI/StringsContext';\n\n// Global array to store floating texts - shared across all instances\nlet globalFloatingTexts = [];\nlet globalForceUpdate = null;\n\nconst FloatingTextManager = () => {\n    const [tick, setTick] = useState(0);\n    const strings = useStrings();\n    const instanceIdRef = useRef(Math.floor(Math.random() * 10000));\n\n    const forceUpdate = () => setTick((prev) => prev + 1);\n\n    // Set this instance as the active one for force updates\n    useEffect(() => {\n        globalForceUpdate = forceUpdate;\n        \n        FloatingTextManager.addFloatingText = (message, x, y, TILE_SIZE, options = {}) => {\n            const displayText = typeof message === 'number'\n                ? (strings[message] || `Missing string for code: ${message}`)\n                : message;\n\n            const container = document.querySelector('.homestead');\n            if (!container) return;\n\n            if (isNaN(x) || isNaN(y)) {\n                console.warn('Invalid coordinates in addFloatingText:', { x, y });\n                return;\n            }\n\n            const { centerX, centerY } = calculateTileCenter(x, y, TILE_SIZE);\n            const newId = `${Date.now()}-${Math.floor(Math.random() * 10000)}`;\n            \n            // Edge detection and offset calculation\n            const EDGE_THRESHOLD = 100; // Distance from edge to trigger offset\n            const OFFSET_AMOUNT = 40; // How much to offset when near edge\n            \n            let finalX = centerX;\n            let finalY = centerY;\n            \n            // Get container dimensions (64x64 grid)\n            const gridSize = 64 * TILE_SIZE;\n            \n            // Check left edge\n            if (centerX < EDGE_THRESHOLD) {\n                finalX = centerX + OFFSET_AMOUNT;\n            }\n            // Check right edge\n            else if (centerX > gridSize - EDGE_THRESHOLD) {\n                finalX = centerX - OFFSET_AMOUNT;\n            }\n            \n            // Check top edge\n            if (centerY < EDGE_THRESHOLD) {\n                finalY = centerY + OFFSET_AMOUNT;\n            }\n            // Check bottom edge  \n            else if (centerY > gridSize - EDGE_THRESHOLD) {\n                finalY = centerY - OFFSET_AMOUNT;\n            }\n\n            globalFloatingTexts.push({\n                id: newId,\n                text: displayText,\n                x: finalX,\n                y: finalY,\n                timestamp: Date.now(),\n                color: options.color,\n                size: options.size\n            });\n\n            if (globalForceUpdate) globalForceUpdate();\n        };\n    }, [strings]);\n\n    const container = document.querySelector('.homestead');\n    if (!container) return null;\n    \n    return createPortal(\n        <div className=\"floating-text-container\">\n            {globalFloatingTexts.map(({ id, text, x, y, color, size }) => (\n                <div\n                    key={id}\n                    className=\"floating-text\"\n                    style={{\n                        position: 'absolute',\n                        left: x,\n                        top: y - 30,\n                        transform: 'translate(-50%, -50%)',\n                        color: color || undefined,\n                        fontSize: size || undefined\n                    }}\n                    onAnimationEnd={(e) => {\n                        // Immediately hide the element to prevent visual artifacts\n                        e.target.style.display = 'none';\n                        \n                        globalFloatingTexts = globalFloatingTexts.filter(t => t.id !== id);\n                        if (globalForceUpdate) globalForceUpdate();\n                    }}\n                >\n                    {text}\n                </div>\n            ))}\n        </div>,\n        container\n    );\n};\n\n// Will be assigned inside useEffect\nFloatingTextManager.addFloatingText = (...args) => {\n    console.warn('FloatingTextManager not ready yet', ...args);\n};\n\nexport default FloatingTextManager;","import React, { createContext, useContext, useState } from 'react';\n\nconst PanelContext = createContext();\n\nexport const PanelProvider = ({ children }) => {\n  const [activePanel, setActivePanel] = useState(null);\n\n  const openPanel = (panelName) => {\n    setActivePanel(panelName);\n  };\n  const closePanel = () => {\n    setActivePanel(null);\n  };\n  return (\n    <PanelContext.Provider value={{ activePanel, openPanel, closePanel, closeAllPanels: closePanel }}>\n      {children}\n    </PanelContext.Provider>\n  );\n};\nexport const usePanelContext = () => {\n  return useContext(PanelContext);\n};\n","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","import API_BASE from './config';\nimport axios from 'axios';\nimport { fetchGridData } from './Utils/GridManagement'; // Utility for fetching grid data\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\n\n/**\n * Grid Initialization (Runs on Refresh or Login)\n * This is for TILES and RESOURCES (not players)\n */\nexport const initializeGrid = async (\n  TILE_SIZE,\n  gridId,\n  setGrid,\n  setResources,\n  setTileTypes,\n  updateStatus,\n  DBPlayerData,\n  masterResources\n) => {\n  try {\n    if (!gridId) {\n      console.error('GridId is missing. Cannot initialize grid.');\n      return;\n    }\n\n    console.log('Initializing grid for gridId:', gridId);\n\n    const gridData = await fetchGridData(gridId, updateStatus, DBPlayerData);\n    const { tiles, resources } = gridData;\n    \n\n    // Process resources to add shadow tiles for multi-tile buildings\n    const processedResources = [];\n    const loadedResources = resources || [];\n    \n    for (const rawResource of loadedResources) {\n      // Enrich resource with master data to get properties like range, passable, etc\n      let resource = rawResource;\n      if (masterResources && masterResources.length > 0) {\n        const template = masterResources.find(r => r.type === rawResource.type);\n        if (template) {\n          resource = {\n            ...template,\n            ...rawResource // Raw data overrides template (for x, y, growEnd, etc)\n          };\n        }\n      }\n      \n      processedResources.push(resource);\n      \n      \n      // If this is a multi-tile resource (has range > 1), create shadow tiles\n      // Note: Resources from server might not have anchorKey, so we generate one if needed\n      if (resource.range && resource.range > 1) {\n        const anchorKey = resource.anchorKey || `${resource.type}-${resource.x}-${resource.y}`;\n        \n        for (let dx = 0; dx < resource.range; dx++) {\n          for (let dy = 0; dy < resource.range; dy++) {\n            // Skip the anchor tile (0,0)\n            if (dx === 0 && dy === 0) continue;\n            \n            const shadowX = resource.x + dx;\n            const shadowY = resource.y - dy;\n            const shadowResource = {\n              type: 'shadow',\n              x: shadowX,\n              y: shadowY,\n              parentAnchorKey: anchorKey,\n              passable: resource.passable\n            };\n            \n            processedResources.push(shadowResource);\n          }\n        }\n      }\n    }\n\n    setGrid(tiles || []);\n    setResources(processedResources);\n    setTileTypes(tiles || []);\n    \n    // Also update the global grid state\n    GlobalGridStateTilesAndResources.setResources(processedResources);\n    \n\n    console.log('Grid, tiles, and resources initialized for gridId:', gridId);\n  } catch (error) {\n    console.error('Error initializing grid:', error);\n  }\n};\n\n\n\n/**\n * Logout Player\n */\nexport const logoutPlayer = (setPlayerData, setisLoginPanelOpen, setGrid, setResources, setTileTypes) => {\n  localStorage.removeItem('player');\n  setPlayerData(null);\n  setGrid([]); // Clear the grid state\n  setResources([]); // Clear resources\n  setTileTypes([]); // Clear tile types\n  setisLoginPanelOpen(true); // Open login modal\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"e009a26f\" + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"game-client:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgame_client\"] = self[\"webpackChunkgame_client\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","import axios from 'axios';\nimport API_BASE from '../config';\n\n// Utility: detect mobile browser\nexport function isMobile() {\n  return /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\n\n// Utility function: return boolean indicating developer status\nexport const checkDeveloperStatus = async (username) => {\n  try {\n    const response = await axios.get(`${API_BASE}/api/check-developer-status/${username}`);\n    return !!response.data?.isDeveloper;\n  } catch (err) {\n    console.warn(' Failed to check developer status:', err);\n    return false;\n  }\n};\n\n// Badge update helper\nexport function updateBadge(currentPlayer, setBadgeState, category, value = true) {\n  const key = `badges_${currentPlayer.username}`;\n  const current = JSON.parse(localStorage.getItem(key)) || {};\n  const updated = { ...current, [category]: value };\n  localStorage.setItem(key, JSON.stringify(updated));\n  setBadgeState(updated);\n}\n\n// Badge read helper\nexport function getBadgeState(currentPlayer) {\n  if (!currentPlayer?.username) {\n    console.warn(\" getBadgeState called without valid currentPlayer\");\n    return {};\n  }\n  const key = `badges_${currentPlayer.username}`;\n  const stored = localStorage.getItem(key);\n  return stored ? JSON.parse(stored) : {};\n}","import React, { useState, useEffect, useRef } from 'react';\nimport socket from '../../socketManager';\nimport { emitChatMessage } from '../../socketManager';\nimport { updateBadge } from '../../Utils/appUtils';\nimport './Chat.css';\nimport API_BASE from '../../config';\n\nconst Chat = ({ currentGridId, currentSettlementId, currentFrontierId, currentPlayer, onClose }) => {\n\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const endRef = useRef(null);\n  const playerId = currentPlayer?._id || 'unknown'; // Fallback if currentPlayer is not available\n\n  useEffect(() => {\n    console.log(\" Chat component mounted with frontierId:\", currentFrontierId);\n\n    //  Join only frontier chat room\n    if (socket && socket.connected && currentFrontierId) {\n      console.log(\" Joining frontier chat room from Chat.js\");\n      socket.emit('join-chat-rooms', {\n        gridId: null,\n        settlementId: null,\n        frontierId: currentFrontierId,\n      });\n    } else {\n      console.warn(\" Socket not connected or no frontierId when Chat mounted.\");\n    }\n\n    //  Clear chat badge on open\n    if (currentPlayer) {\n      updateBadge(currentPlayer, () => {}, 'chat', false ?? true);\n    }\n  }, [currentFrontierId]);\n\n  useEffect(() => {\n    if (!socket) return;\n\n    socket.on('receive-chat-message', (msg) => {\n      // Only show frontier messages\n      if (msg.scope !== 'frontier') return;\n      \n      if (!msg.username && currentPlayer?.username) {\n        msg.username = currentPlayer.username;\n      }\n      console.log(\" Received chat message via socket:\", msg);\n      setMessages(prev => [...prev, msg]);\n    });\n\n    return () => {\n        socket.off('receive-chat-message');\n    };\n    }, [socket]);\n\n\nuseEffect(() => {\n  const fetchMessages = async () => {\n    if (!currentFrontierId) return;\n    \n    try {\n      const res = await fetch(`${API_BASE}/api/chat/frontier/${currentFrontierId}`);\n      const data = await res.json();\n      setMessages(data);\n    } catch (err) {\n      console.error(\"Failed to fetch chat history:\", err);\n    }\n  };\n\n  fetchMessages();\n}, [currentFrontierId]);\n\n\n  useEffect(() => {\n    endRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n\n  const handleSend = (e) => {\n    e.preventDefault();\n    const trimmed = inputText.trim();\n    if (!trimmed || !currentFrontierId) return;\n\n    console.log(\" Sending chat message:\", trimmed);\n\n    emitChatMessage({\n      playerId,\n      username: currentPlayer?.username || 'unknown',\n      message: trimmed,\n      scope: 'frontier',\n      scopeId: currentFrontierId\n    });\n\n    setInputText(''); //  clear input after emitting\n  };\n\n  const handleKeyPress = (e) => {\n    console.log(\" Key pressed:\", e.key);\n    if (e.key === 'Enter') {\n      e.preventDefault(); // Prevents default Enter behavior in input\n      handleSend(e); // Pass the actual event to handleSend\n    }\n  };\n\nreturn (\n    <div className=\"chat-container\">\n\n    <div className=\"chat-panel-header\">\n      <h3> Chat</h3>\n      <button className=\"chat-close-button\" onClick={onClose}></button>\n    </div>\n\n    <div className=\"chat-panel\">\n        <div className=\"chat-messages\">\n        {messages.map((msg, i) => (\n            <div key={msg.id || i} className=\"chat-message\">\n              <strong>{msg.username || '???'}</strong>: {msg.message || '[empty]'}\n            </div>\n        ))}\n        <div ref={endRef} />\n        </div>\n\n        <div className=\"chat-input\">\n        <input\n            type=\"text\"\n            value={inputText}\n            onChange={e => setInputText(e.target.value)}\n            onKeyDown={handleKeyPress}\n            placeholder=\"Message everyone...\"\n        />\n        <button type=\"button\" onClick={handleSend}>Send</button>\n        </div>\n\n    </div>\n    </div>\n  );\n};\n\nexport default Chat;","import React, { useRef, useEffect, useCallback } from 'react';\n\n// Configuration for which tile types should have rounded corners\nconst TILE_ROUNDING_CONFIG = {\n  g: true,  // grass - rounded\n  s: true,  // stone - rounded  \n  w: true,  // water - rounded\n  l: true,  // lava - rounded\n  n: true,  // natural - rounded\n  o: true,  // other - rounded\n  d: false, // dirt - no rounding (base layer)\n  p: true,  // pavement - rounded\n};\n\n// Get CSS color for a tile type\nfunction getTileColor(tileType) {\n  const tileColors = {\n    g: '#67c257', // grass\n    s: '#8b989c', // stone\n    d: '#c0834a', // dirt\n    w: '#58cad8', // water\n    l: '#c4583d', // lava\n    p: '#c5a85d', // pavement\n    n: '#fbde00', // natural\n    o: '#ffffff', // other\n    unknown: '#ff0000', // debug red\n  };\n  return tileColors[tileType] || tileColors.unknown;\n}\n\n// Helper function to draw a single grass tuft\nfunction drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE) {\n  const size = Math.max(1, TILE_SIZE * 0.08 + (tuftSeed * 0.01) % (TILE_SIZE * 0.04));\n  const opacity = 0.15 + (tuftSeed * 0.01) % 0.1;\n  \n  ctx.save();\n  ctx.translate(x, y);\n  ctx.rotate((tuftSeed * 0.5) % 60 - 30);\n  ctx.fillStyle = `rgba(0, 50, 0, ${opacity})`;\n  \n  // Draw irregular grass clump using path\n  ctx.beginPath();\n  const points = [\n    [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n    [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n  ];\n  \n  points.forEach(([px, py], index) => {\n    const drawX = px * size - size/2;\n    const drawY = py * size - size/2;\n    if (index === 0) ctx.moveTo(drawX, drawY);\n    else ctx.lineTo(drawX, drawY);\n  });\n  ctx.closePath();\n  ctx.fill();\n  ctx.restore();\n}\n\n// Calculate which corners should be rounded based on adjacent tiles\nfunction calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes) {\n  // If this tile type doesn't support rounding, return null\n  if (!TILE_ROUNDING_CONFIG[tileType]) {\n    return null;\n  }\n\n  const roundedCorners = {\n    topLeft: false,\n    topRight: false,\n    bottomRight: false,\n    bottomLeft: false\n  };\n  \n  // Check each corner: top-left, top-right, bottom-right, bottom-left\n  const adjacentChecks = [\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'topLeft'\n    },\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'topRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'bottomRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'bottomLeft'\n    }\n  ];\n\n  for (const check of adjacentChecks) {\n    // For a corner to be rounded, BOTH adjacent sides must have different tiles\n    const allNeighborsDifferent = check.neighbors.every(neighbor => {\n      const neighborType = tileTypes[neighbor.row]?.[neighbor.col] || 'd'; // default to dirt if out of bounds\n      return neighborType !== tileType;\n    });\n    \n    roundedCorners[check.corner] = allNeighborsDifferent;\n  }\n  \n  return roundedCorners;\n}\n\n// Calculate corner background color based on adjacent tiles\nfunction calculateCornerColor(tileType, corner, rowIndex, colIndex, tileTypes) {\n  let adjacentTiles = [];\n  \n  switch (corner) {\n    case 'topLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex - 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n    case 'topRight':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex - 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomRight':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex + 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex + 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n  }\n  \n  // Remove the current tile type from consideration\n  adjacentTiles = adjacentTiles.filter(type => type !== tileType);\n  \n  // If all adjacent tiles are the same type, use that color\n  if (adjacentTiles.length > 0 && adjacentTiles.every(type => type === adjacentTiles[0])) {\n    return getTileColor(adjacentTiles[0]);\n  }\n  \n  // If there are different adjacent tiles (mixed colors), default to the tile's own color\n  if (adjacentTiles.length > 1) {\n    const uniqueTypes = [...new Set(adjacentTiles)];\n    if (uniqueTypes.length > 1) {\n      return getTileColor(tileType);\n    }\n  }\n  \n  // If only one adjacent tile type, use priority system\n  const priorityOrder = ['w', 'l', 's', 'd', 'g', 'p', 'n', 'o'];\n  \n  for (const priorityType of priorityOrder) {\n    if (adjacentTiles.includes(priorityType)) {\n      return getTileColor(priorityType);\n    }\n  }\n  \n  // Fallback to dirt if no adjacent tiles found\n  return getTileColor('d');\n}\n\n// Pre-render organic textures for tile types with variation\nfunction createTileTexture(tileType, TILE_SIZE, variation = 0, rowIndex, colIndex, tileTypes) {\n  const canvas = document.createElement('canvas');\n  canvas.width = TILE_SIZE;\n  canvas.height = TILE_SIZE;\n  const ctx = canvas.getContext('2d');\n  \n  // Calculate rounded corners for this tile\n  const roundedCorners = calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes);\n  \n  // Fill base color\n  ctx.fillStyle = getTileColor(tileType);\n  ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n  \n  // Draw corner backgrounds if we have rounded corners\n  if (roundedCorners) {\n    const cornerSize = TILE_SIZE / 2;\n    \n    // Top-left corner\n    if (roundedCorners.topLeft) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'topLeft', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(0, 0, cornerSize, cornerSize);\n    }\n    \n    // Top-right corner\n    if (roundedCorners.topRight) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'topRight', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(cornerSize, 0, cornerSize, cornerSize);\n    }\n    \n    // Bottom-right corner\n    if (roundedCorners.bottomRight) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'bottomRight', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(cornerSize, cornerSize, cornerSize, cornerSize);\n    }\n    \n    // Bottom-left corner\n    if (roundedCorners.bottomLeft) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'bottomLeft', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(0, cornerSize, cornerSize, cornerSize);\n    }\n    \n    // Draw the main tile with rounded corners over the corner backgrounds\n    ctx.fillStyle = getTileColor(tileType);\n    \n    const radius = 8; // Base radius for corners\n    ctx.beginPath();\n    ctx.moveTo(roundedCorners.topLeft ? radius : 0, 0);\n    ctx.lineTo(TILE_SIZE - (roundedCorners.topRight ? radius : 0), 0);\n    if (roundedCorners.topRight) {\n      ctx.quadraticCurveTo(TILE_SIZE, 0, TILE_SIZE, radius);\n    }\n    ctx.lineTo(TILE_SIZE, TILE_SIZE - (roundedCorners.bottomRight ? radius : 0));\n    if (roundedCorners.bottomRight) {\n      ctx.quadraticCurveTo(TILE_SIZE, TILE_SIZE, TILE_SIZE - radius, TILE_SIZE);\n    }\n    ctx.lineTo(roundedCorners.bottomLeft ? radius : 0, TILE_SIZE);\n    if (roundedCorners.bottomLeft) {\n      ctx.quadraticCurveTo(0, TILE_SIZE, 0, TILE_SIZE - radius);\n    }\n    ctx.lineTo(0, roundedCorners.topLeft ? radius : 0);\n    if (roundedCorners.topLeft) {\n      ctx.quadraticCurveTo(0, 0, radius, 0);\n    }\n    ctx.closePath();\n    ctx.fill();\n  }\n  \n  // Add organic textures based on tile type\n  if (tileType === 'g') {\n    // Grass tufts - completely different approaches per variation\n    const baseSeeds = [157, 331, 523, 769]; // Prime numbers for max variation\n    const seed = baseSeeds[variation] || 500;\n    \n    // Completely different positioning strategies per variation\n    if (variation === 0) {\n      // Variation 0: Scattered pattern\n      const positions = [[25, 30], [70, 45], [45, 70]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 73) % 1000;\n        const x = (baseX + (tuftSeed * 0.1) % 20 - 10) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.2) % 20 - 10) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else if (variation === 1) {\n      // Variation 1: Corner clusters\n      const corners = [[20, 20], [75, 25], [30, 75], [80, 80]];\n      corners.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 91) % 1000;\n        const x = (baseX + (tuftSeed * 0.15) % 15 - 7) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.18) % 15 - 7) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else if (variation === 2) {\n      // Variation 2: Organic center cluster\n      const positions = [[50, 40], [60, 55], [45, 60], [35, 45]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 113) % 1000;\n        const x = (baseX + (tuftSeed * 0.25) % 30 - 15) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.3) % 25 - 12) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else {\n      // Variation 3: Random sparse\n      const positions = [[40, 35], [65, 60]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 137) % 1000;\n        const x = (baseX + (tuftSeed * 0.2) % 30 - 15) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.25) % 25 - 12) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    }\n    \n    // Occasional yellow clump - varies by variation  \n    if ((seed + variation * 17) % 5 === 0) {\n      const lightSeed = (seed * 1.41) % 1000;\n      const lightX = (15 + (lightSeed * 0.83) % 70) / 100 * TILE_SIZE;\n      const lightY = (25 + (lightSeed * 1.37) % 50) / 100 * TILE_SIZE;\n      const lightSize = Math.max(2, TILE_SIZE * 0.12 + (lightSeed * 0.01) % (TILE_SIZE * 0.04));\n      \n      ctx.save();\n      ctx.translate(lightX, lightY);\n      ctx.rotate((lightSeed * 0.7) % 60 - 30);\n      ctx.fillStyle = `rgba(220, 220, 40, 0.6)`;\n      \n      ctx.beginPath();\n      const points = [\n        [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n        [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n      ];\n      \n      points.forEach(([px, py], index) => {\n        const drawX = px * lightSize - lightSize/2;\n        const drawY = py * lightSize - lightSize/2;\n        if (index === 0) ctx.moveTo(drawX, drawY);\n        else ctx.lineTo(drawX, drawY);\n      });\n      ctx.closePath();\n      ctx.fill();\n      ctx.restore();\n    }\n  }\n  \n  if (tileType === 'd') {\n    // Dirt cracks - using variation for different patterns\n    const seed = 600 + variation * 150;\n    const numPatches = 4 + (seed % 4);\n    \n    for (let i = 0; i < numPatches; i++) {\n      const patchSeed = (seed + i * 139) % 1000;\n      const x = (5 + (patchSeed * 0.91) % 90) / 100 * TILE_SIZE;\n      const y = (5 + (patchSeed * 1.23) % 90) / 100 * TILE_SIZE;\n      const size = Math.max(1, TILE_SIZE * 0.06 + (patchSeed * 0.01) % (TILE_SIZE * 0.03));\n      const opacity = 0.12 + (patchSeed * 0.01) % 0.08;\n      \n      ctx.save();\n      ctx.translate(x, y);\n      ctx.rotate((patchSeed * 0.7) % 180 * Math.PI / 180);\n      ctx.fillStyle = `rgba(80, 50, 30, ${opacity})`;\n      \n      const width = size * 2;\n      const height = size * 0.5;\n      ctx.fillRect(-width/2, -height/2, width, height);\n      ctx.restore();\n    }\n    \n    // Occasional lighter dirt patch\n    if (seed % 6 === 0) {\n      const lightSeed = (seed * 1.61) % 1000;\n      const lightX = (10 + (lightSeed * 0.79) % 80) / 100 * TILE_SIZE;\n      const lightY = (10 + (lightSeed * 1.47) % 80) / 100 * TILE_SIZE;\n      const lightSize = Math.max(1, TILE_SIZE * 0.08 + (lightSeed * 0.01) % (TILE_SIZE * 0.02));\n      \n      ctx.fillStyle = `rgba(160, 130, 90, 0.25)`;\n      ctx.beginPath();\n      ctx.arc(lightX, lightY, lightSize/2, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  }\n  \n  return canvas;\n}\n\n// Canvas-based tile renderer component\nexport const RenderTilesCanvas = ({ grid, tileTypes, TILE_SIZE, handleTileClick }) => {\n  const canvasRef = useRef(null);\n  const textureCache = useRef(new Map());\n  const lastRenderData = useRef(null);\n  \n  // Clear texture cache when TILE_SIZE changes\n  useEffect(() => {\n    textureCache.current.clear();\n  }, [TILE_SIZE]);\n  \n  // Get or create tile texture with variation\n  const getTileTexture = useCallback((tileType, rowIndex, colIndex) => {\n    // Create 4 variations for grass and dirt, 1 for others\n    const numVariations = (tileType === 'g' || tileType === 'd') ? 4 : 1;\n    const variation = (rowIndex * 73 + colIndex * 37) % numVariations;\n    const cacheKey = `${tileType}-${TILE_SIZE}-${variation}-${rowIndex}-${colIndex}`;\n    \n    if (!textureCache.current.has(cacheKey)) {\n      textureCache.current.set(cacheKey, createTileTexture(tileType, TILE_SIZE, variation, rowIndex, colIndex, tileTypes));\n    }\n    return textureCache.current.get(cacheKey);\n  }, [TILE_SIZE, tileTypes]);\n  \n  // Render tiles to canvas\n  const renderTiles = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !grid || !tileTypes) return;\n    \n    const ctx = canvas.getContext('2d');\n    const rows = grid.length;\n    const cols = grid[0]?.length || 0;\n    \n    // Set canvas size\n    canvas.width = cols * TILE_SIZE;\n    canvas.height = rows * TILE_SIZE;\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    \n    // Render each tile\n    for (let rowIndex = 0; rowIndex < rows; rowIndex++) {\n      for (let colIndex = 0; colIndex < cols; colIndex++) {\n        const tileType = tileTypes[rowIndex]?.[colIndex] || 'unknown';\n        const texture = getTileTexture(tileType, rowIndex, colIndex);\n        \n        ctx.drawImage(\n          texture,\n          colIndex * TILE_SIZE,\n          rowIndex * TILE_SIZE,\n          TILE_SIZE,\n          TILE_SIZE\n        );\n      }\n    }\n  }, [grid, tileTypes, TILE_SIZE, getTileTexture]);\n  \n  // Re-render when dependencies change\n  useEffect(() => {\n    const currentData = JSON.stringify({ grid, tileTypes, TILE_SIZE });\n    if (currentData !== lastRenderData.current) {\n      renderTiles();\n      lastRenderData.current = currentData;\n    }\n  }, [renderTiles, grid, tileTypes, TILE_SIZE]);\n  \n  // Handle tile clicks by converting canvas coordinates\n  const handleCanvasClick = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas || !handleTileClick) return;\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    if (rowIndex >= 0 && rowIndex < grid.length && \n        colIndex >= 0 && colIndex < (grid[0]?.length || 0)) {\n      handleTileClick(rowIndex, colIndex);\n    }\n  }, [handleTileClick, TILE_SIZE, grid]);\n  \n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 1, // Same as DOM tiles\n        cursor: 'pointer',\n        imageRendering: 'pixelated', // Keep crisp pixel art look\n      }}\n    />\n  );\n};","import React from 'react';\n\n// Configuration for which tile types should have rounded corners\nconst TILE_ROUNDING_CONFIG = {\n  g: true,  // grass - rounded\n  s: true,  // stone - rounded  \n  w: true,  // water - rounded\n  l: true,  // lava - rounded\n  n: true,  // natural - rounded\n  o: true,  // other - rounded\n  d: false, // dirt - no rounding (base layer)\n  p: true, // pavement - no rounding\n};\n\n// Calculate which corners should be rounded based on adjacent tiles\nfunction calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes) {\n  // If this tile type doesn't support rounding, return null\n  if (!TILE_ROUNDING_CONFIG[tileType]) {\n    return null;\n  }\n\n  const roundedCorners = {\n    topLeft: false,\n    topRight: false,\n    bottomRight: false,\n    bottomLeft: false\n  };\n  \n  // Check each corner: top-left, top-right, bottom-right, bottom-left\n  const adjacentChecks = [\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'topLeft'\n    },\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'topRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'bottomRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'bottomLeft'\n    }\n  ];\n\n  for (const check of adjacentChecks) {\n    // For a corner to be rounded, BOTH adjacent sides must have different tiles\n    // Example: for top-left corner, both TOP and LEFT neighbors must be different\n    const allNeighborsDifferent = check.neighbors.every(neighbor => {\n      const neighborType = tileTypes[neighbor.row]?.[neighbor.col] || 'd'; // default to dirt if out of bounds\n      return neighborType !== tileType;\n    });\n    \n    roundedCorners[check.corner] = allNeighborsDifferent;\n  }\n  \n  return roundedCorners;\n}\n\n// Get CSS color for a tile type\nfunction getTileColor(tileType) {\n  const tileColors = {\n    g: '#67c257', // grass\n    s: '#8b989c', // stone\n    d: '#c0834a', // dirt\n    w: '#58cad8', // water\n    l: '#c4583d', // lava\n    p: '#c5a85d', // pavement\n    n: '#fbde00', // natural\n    o: '#ffffff', // other\n    unknown: '#ff0000', // debug red\n  };\n  return tileColors[tileType] || tileColors.unknown;\n}\n\n// Calculate corner background color based on adjacent tiles\nfunction calculateCornerColor(tileType, corner, rowIndex, colIndex, tileTypes) {\n  let adjacentTiles = [];\n  \n  switch (corner) {\n    case 'topLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex - 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n    case 'topRight':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex - 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomRight':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex + 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex + 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n  }\n  \n  // Remove the current tile type from consideration\n  adjacentTiles = adjacentTiles.filter(type => type !== tileType);\n  \n  // If all adjacent tiles are the same type, use that color\n  if (adjacentTiles.length > 0 && adjacentTiles.every(type => type === adjacentTiles[0])) {\n    return getTileColor(adjacentTiles[0]);\n  }\n  \n  // If there are different adjacent tiles (mixed colors), default to the tile's own color\n  // This effectively creates no corner rounding by matching the main tile color\n  if (adjacentTiles.length > 1) {\n    const uniqueTypes = [...new Set(adjacentTiles)];\n    if (uniqueTypes.length > 1) {\n      return getTileColor(tileType);\n    }\n  }\n  \n  // If only one adjacent tile type, use priority system\n  const priorityOrder = ['w', 'l', 's', 'd', 'g', 'p', 'n', 'o'];\n  \n  for (const priorityType of priorityOrder) {\n    if (adjacentTiles.includes(priorityType)) {\n      return getTileColor(priorityType);\n    }\n  }\n  \n  // Fallback to dirt if no adjacent tiles found\n  return getTileColor('d');\n}\n\n// Generate CSS border-radius for rounded corners\nfunction generateBorderRadius(roundedCorners) {\n  if (!roundedCorners) {\n    return '0';\n  }\n  \n  const baseRadius = '8px'; // Base radius for corners\n  const extendedRadius = '12px'; // Extended radius for natural variations\n  \n  // Determine if corners should have extended dirt penetration\n  const topLeftExtended = roundedCorners.topLeft && roundedCorners.topRight;\n  const topRightExtended = roundedCorners.topRight && roundedCorners.bottomRight;\n  const bottomRightExtended = roundedCorners.bottomRight && roundedCorners.bottomLeft;\n  const bottomLeftExtended = roundedCorners.bottomLeft && roundedCorners.topLeft;\n  \n  // Build border-radius string: top-left top-right bottom-right bottom-left\n  const corners = [\n    roundedCorners.topLeft ? (topLeftExtended ? extendedRadius : baseRadius) : '0',\n    roundedCorners.topRight ? (topRightExtended ? extendedRadius : baseRadius) : '0', \n    roundedCorners.bottomRight ? (bottomRightExtended ? extendedRadius : baseRadius) : '0',\n    roundedCorners.bottomLeft ? (bottomLeftExtended ? extendedRadius : baseRadius) : '0'\n  ];\n  \n  return corners.join(' ');\n}\n\n// Render individual tile with proper layering\nexport const RenderTile = ({ tileType, rowIndex, colIndex, tileTypes, TILE_SIZE, handleTileClick }) => {\n  const tileClass = `tile-${tileType}`;\n  const key = `${colIndex}-${rowIndex}`;\n  \n  // Calculate rounded corners for this tile\n  const roundedCorners = calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes);\n  const borderRadius = generateBorderRadius(roundedCorners);\n\n  return (\n    <div\n      key={key}\n      onClick={() => handleTileClick(rowIndex, colIndex)}\n      style={{\n        position: 'absolute',\n        top: rowIndex * TILE_SIZE,\n        left: colIndex * TILE_SIZE,\n        width: TILE_SIZE,\n        height: TILE_SIZE,\n        cursor: 'pointer',\n        zIndex: 1, // Tiles are lowest layer\n        overflow: 'hidden',\n      }}\n    >\n      {/* Corner background layers - individual colors based on adjacent tiles */}\n      {roundedCorners && (\n        <>\n          {/* Top-left corner */}\n          {roundedCorners.topLeft && (\n            <div\n              style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                width: '50%',\n                height: '50%',\n                backgroundColor: calculateCornerColor(tileType, 'topLeft', rowIndex, colIndex, tileTypes),\n                zIndex: 1,\n              }}\n            />\n          )}\n          \n          {/* Top-right corner */}\n          {roundedCorners.topRight && (\n            <div\n              style={{\n                position: 'absolute',\n                top: 0,\n                right: 0,\n                width: '50%',\n                height: '50%',\n                backgroundColor: calculateCornerColor(tileType, 'topRight', rowIndex, colIndex, tileTypes),\n                zIndex: 1,\n              }}\n            />\n          )}\n          \n          {/* Bottom-right corner */}\n          {roundedCorners.bottomRight && (\n            <div\n              style={{\n                position: 'absolute',\n                bottom: 0,\n                right: 0,\n                width: '50%',\n                height: '50%',\n                backgroundColor: calculateCornerColor(tileType, 'bottomRight', rowIndex, colIndex, tileTypes),\n                zIndex: 1,\n              }}\n            />\n          )}\n          \n          {/* Bottom-left corner */}\n          {roundedCorners.bottomLeft && (\n            <div\n              style={{\n                position: 'absolute',\n                bottom: 0,\n                left: 0,\n                width: '50%',\n                height: '50%',\n                backgroundColor: calculateCornerColor(tileType, 'bottomLeft', rowIndex, colIndex, tileTypes),\n                zIndex: 1,\n              }}\n            />\n          )}\n        </>\n      )}\n      \n      {/* Actual tile with proper color and rounded corners */}\n      <div\n        className={tileClass}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          borderRadius: borderRadius,\n          zIndex: 2,\n        }}\n      />\n      \n      {/* Organic grass tufts overlay for grass tiles */}\n      {tileType === 'g' && (() => {\n        // Create per-tile randomness using coordinates as seed\n        const seed = (rowIndex * 73 + colIndex * 37) % 1000;\n        const tufts = [];\n        \n        // Generate 3-5 grass tufts per tile with organic distribution\n        const numTufts = 3 + (seed % 3); // 3-5 tufts\n        \n        for (let i = 0; i < numTufts; i++) {\n          const tuftSeed = (seed + i * 127) % 1000;\n          const x = 10 + (tuftSeed * 0.73) % 80; // 10-90% across tile\n          const y = 20 + (tuftSeed * 1.19) % 60; // 20-80% down tile\n          const size = Math.max(1, TILE_SIZE * 0.08 + (tuftSeed * 0.01) % (TILE_SIZE * 0.04)); // Scale with tile size\n          const opacity = 0.15 + (tuftSeed * 0.01) % 0.1; // 0.15-0.25 opacity\n          \n          // Use darker green for most tufts\n          let color = `rgba(0, 50, 0, ${opacity})`;\n          \n          tufts.push(\n            <div\n              key={i}\n              style={{\n                position: 'absolute',\n                left: `${x}%`,\n                top: `${y}%`,\n                width: `${size}px`,\n                height: `${size}px`, // Square base for irregular shape\n                backgroundColor: color,\n                clipPath: 'polygon(30% 100%, 0% 80%, 10% 60%, 0% 40%, 15% 20%, 40% 30%, 60% 10%, 80% 30%, 100% 50%, 85% 80%, 70% 100%)', // Irregular grass clump\n                transform: `rotate(${(tuftSeed * 0.5) % 60 - 30}deg)`, // More rotation variation\n                pointerEvents: 'none',\n              }}\n            />\n          );\n        }\n        \n        // Add occasional lighter green clump (every ~4-6 tiles)\n        if (seed % 5 === 0) {\n          const lightSeed = (seed * 1.41) % 1000;\n          const lightX = 15 + (lightSeed * 0.83) % 70;\n          const lightY = 25 + (lightSeed * 1.37) % 50;\n          const lightSize = Math.max(2, TILE_SIZE * 0.12 + (lightSeed * 0.01) % (TILE_SIZE * 0.04));\n          \n          tufts.push(\n            <div\n              key=\"light\"\n              style={{\n                position: 'absolute',\n                left: `${lightX}%`,\n                top: `${lightY}%`,\n                width: `${lightSize}px`,\n                height: `${lightSize}px`,\n                backgroundColor: `rgba(220, 220, 40, 0.6)`, // Brighter yellow, more opaque\n                clipPath: 'polygon(30% 100%, 0% 80%, 10% 60%, 0% 40%, 15% 20%, 40% 30%, 60% 10%, 80% 30%, 100% 50%, 85% 80%, 70% 100%)',\n                transform: `rotate(${(lightSeed * 0.7) % 60 - 30}deg)`,\n                pointerEvents: 'none',\n              }}\n            />\n          );\n        }\n        \n        return (\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              height: '100%',\n              borderRadius: borderRadius,\n              zIndex: 3,\n              pointerEvents: 'none',\n              overflow: 'hidden',\n            }}\n          >\n            {tufts}\n          </div>\n        );\n      })()}\n      \n      {/* Organic dirt texture effect for dirt tiles */}\n      {tileType === 'd' && (() => {\n        // Create per-tile randomness using coordinates as seed\n        const seed = (rowIndex * 89 + colIndex * 43) % 1000;\n        const patches = [];\n        \n        // Generate 4-7 dirt patches per tile with organic distribution\n        const numPatches = 4 + (seed % 4); // 4-7 patches\n        \n        for (let i = 0; i < numPatches; i++) {\n          const patchSeed = (seed + i * 139) % 1000;\n          const x = 5 + (patchSeed * 0.91) % 90; // 5-95% across tile\n          const y = 5 + (patchSeed * 1.23) % 90; // 5-95% down tile\n          const size = Math.max(1, TILE_SIZE * 0.06 + (patchSeed * 0.01) % (TILE_SIZE * 0.03)); // Smaller than grass tufts\n          const opacity = 0.12 + (patchSeed * 0.01) % 0.08; // 0.12-0.20 opacity\n          \n          patches.push(\n            <div\n              key={i}\n              style={{\n                position: 'absolute',\n                left: `${x}%`,\n                top: `${y}%`,\n                width: `${size * 2}px`, // Wider for crack-like shape\n                height: `${size * 0.5}px`, // Thinner for crack-like shape\n                backgroundColor: `rgba(80, 50, 30, ${opacity})`, // Darker brown cracks\n                borderRadius: '2px', // Slightly rounded for natural look\n                transform: `rotate(${(patchSeed * 0.7) % 180}deg) scale(${0.8 + (patchSeed * 0.001) % 0.4})`, // Random rotation for crack direction\n                pointerEvents: 'none',\n              }}\n            />\n          );\n        }\n        \n        // Add occasional lighter dirt patch (every ~6 tiles)\n        if (seed % 6 === 0) {\n          const lightSeed = (seed * 1.61) % 1000;\n          const lightX = 10 + (lightSeed * 0.79) % 80;\n          const lightY = 10 + (lightSeed * 1.47) % 80;\n          const lightSize = Math.max(1, TILE_SIZE * 0.08 + (lightSeed * 0.01) % (TILE_SIZE * 0.02));\n          \n          patches.push(\n            <div\n              key=\"light\"\n              style={{\n                position: 'absolute',\n                left: `${lightX}%`,\n                top: `${lightY}%`,\n                width: `${lightSize}px`,\n                height: `${lightSize}px`,\n                backgroundColor: `rgba(160, 130, 90, 0.25)`, // Lighter sandy spot\n                borderRadius: '50%',\n                pointerEvents: 'none',\n              }}\n            />\n          );\n        }\n        \n        return (\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              height: '100%',\n              borderRadius: borderRadius,\n              zIndex: 3,\n              pointerEvents: 'none',\n              overflow: 'hidden',\n            }}\n          >\n            {patches}\n          </div>\n        );\n      })()}\n    </div>\n  );\n};\n\n// Render all tiles in the grid using DOM\nexport const RenderTilesDOM = ({ grid, tileTypes, TILE_SIZE, handleTileClick }) => {\n  return grid.map((row, rowIndex) =>\n    row.map((tile, colIndex) => {\n      const tileType = tileTypes[rowIndex]?.[colIndex] || 'unknown';\n      \n      return (\n        <RenderTile\n          key={`tile-${rowIndex}-${colIndex}`}\n          tileType={tileType}\n          rowIndex={rowIndex}\n          colIndex={colIndex}\n          tileTypes={tileTypes}\n          TILE_SIZE={TILE_SIZE}\n          handleTileClick={handleTileClick}\n        />\n      );\n    })\n  );\n};","import React from 'react';\nimport { RenderTilesCanvas } from './RenderTilesCanvas';\nimport { RenderTilesDOM } from './RenderTilesDOM';\n\n/**\n * Main tile rendering component that decides between Canvas and DOM rendering\n */\nexport const RenderTiles = ({ \n  grid,\n  tileTypes,\n  TILE_SIZE,\n  handleTileClick,\n  useCanvasTiles = false\n}) => {\n  // Simple decision: Canvas or DOM\n  if (useCanvasTiles) {\n    return (\n      <RenderTilesCanvas\n        grid={grid}\n        tileTypes={tileTypes}\n        TILE_SIZE={TILE_SIZE}\n        handleTileClick={handleTileClick}\n      />\n    );\n  } else {\n    return (\n      <RenderTilesDOM\n        grid={grid}\n        tileTypes={tileTypes}\n        TILE_SIZE={TILE_SIZE}\n        handleTileClick={handleTileClick}\n      />\n    );\n  }\n};\n\nexport default RenderTiles;","// SVG Asset Manager - handles loading and caching SVG assets for canvas rendering\n\nclass SVGAssetManager {\n  constructor() {\n    this.svgCache = new Map(); // SVG string cache\n    this.textureCache = new Map(); // Rendered bitmap cache\n    this.loadingPromises = new Map(); // Prevent duplicate loads\n    \n    // Default zoom tiers (will be updated from globalTuning)\n    this.ZOOM_TIERS = [16, 34, 50, 68, 100, 150]; // fallback values\n  }\n\n  // Get the best zoom tier for a target size with high-DPI support\n  getBestZoomTier(targetSize) {\n    // Account for device pixel ratio for crisp rendering\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    const adjustedSize = targetSize * Math.max(devicePixelRatio, 1.5); // Always render at least 1.5x for sharpness\n    \n    return this.ZOOM_TIERS.find(tier => tier >= adjustedSize) || this.ZOOM_TIERS[this.ZOOM_TIERS.length - 1];\n  }\n\n  // Load SVG file (with caching) - supports different directories\n  async loadSVG(svgFileName, isOverlay = false) {\n    const cacheKey = isOverlay ? `overlay-${svgFileName}` : svgFileName;\n    \n    if (this.svgCache.has(cacheKey)) {\n      return this.svgCache.get(cacheKey);\n    }\n\n    // Prevent duplicate loading\n    if (this.loadingPromises.has(cacheKey)) {\n      return this.loadingPromises.get(cacheKey);\n    }\n\n    const directory = isOverlay ? '/assets/overlays/' : '/assets/resources/';\n    const loadPromise = fetch(`${directory}${svgFileName}`)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(`Failed to load SVG: ${svgFileName}`);\n        }\n        return response.text();\n      })\n      .then(svgText => {\n        this.svgCache.set(cacheKey, svgText);\n        this.loadingPromises.delete(cacheKey);\n        return svgText;\n      })\n      .catch(error => {\n        console.warn(`SVG asset not found: ${svgFileName}`, error);\n        this.loadingPromises.delete(cacheKey);\n        return null;\n      });\n\n    this.loadingPromises.set(cacheKey, loadPromise);\n    return loadPromise;\n  }\n\n  // Create high-quality texture from SVG at specific size\n  async createSVGTexture(svgText, size) {\n    return new Promise((resolve) => {\n      const canvas = document.createElement('canvas');\n      canvas.width = canvas.height = size;\n      const ctx = canvas.getContext('2d');\n      \n      // Enable better rendering quality\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = 'high';\n\n      // Create image from SVG\n      const img = new Image();\n      img.onload = () => {\n        // Render SVG at high quality\n        ctx.drawImage(img, 0, 0, size, size);\n        resolve(canvas);\n        \n        // Clean up object URL\n        URL.revokeObjectURL(img.src);\n      };\n      img.onerror = () => {\n        console.warn('Failed to render SVG to canvas');\n        URL.revokeObjectURL(img.src);\n        resolve(null);\n      };\n\n      // Convert SVG to data URL\n      const svgBlob = new Blob([svgText], { type: 'image/svg+xml;charset=utf-8' });\n      const url = URL.createObjectURL(svgBlob);\n      img.src = url;\n    });\n  }\n\n  // Get or create cached texture for SVG asset\n  async getSVGTexture(svgFileName, targetSize, isOverlay = false) {\n    const tier = this.getBestZoomTier(targetSize);\n    const cacheKey = `${isOverlay ? 'overlay-' : ''}${svgFileName}-${tier}`;\n\n    // Return cached texture if available\n    if (this.textureCache.has(cacheKey)) {\n      return this.textureCache.get(cacheKey);\n    }\n\n    try {\n      // Load SVG and create texture\n      const svgText = await this.loadSVG(svgFileName, isOverlay);\n      if (!svgText) return null;\n\n      const texture = await this.createSVGTexture(svgText, tier);\n      if (texture) {\n        this.textureCache.set(cacheKey, texture);\n      }\n      return texture;\n    } catch (error) {\n      console.error(`Error creating SVG texture for ${svgFileName}:`, error);\n      return null;\n    }\n  }\n\n  // Get overlay texture (convenience method)\n  async getOverlayTexture(overlayFileName, targetSize) {\n    return this.getSVGTexture(overlayFileName, targetSize, true);\n  }\n\n  // Update zoom tiers from globalTuning\n  updateZoomTiers(globalTuning) {\n    if (!globalTuning) {\n      console.warn('No globalTuning provided, using default zoom tiers');\n      return;\n    }\n    \n    // Extract zoom values from globalTuning\n    const baseZooms = [\n      globalTuning.farZoom || 16,\n      globalTuning.closeZoom || 34, \n      globalTuning.closerZoom || 50\n    ];\n    \n    // Add higher resolution variants for crisp rendering\n    const highResVariants = baseZooms.map(zoom => [\n      zoom * 1.5, // 1.5x for sharpness\n      zoom * 2,   // 2x for high-DPI\n      zoom * 3    // 3x for very high-DPI\n    ]).flat();\n    \n    // Combine and sort unique values\n    this.ZOOM_TIERS = [...new Set([...baseZooms, ...highResVariants])].sort((a, b) => a - b);\n    \n    console.log('Updated SVG zoom tiers from globalTuning:', this.ZOOM_TIERS);\n  }\n\n  // Clear cache (useful for development/testing)\n  clearCache() {\n    this.svgCache.clear();\n    this.textureCache.clear();\n    this.loadingPromises.clear();\n  }\n\n  // Get cache stats for debugging\n  getCacheStats() {\n    return {\n      svgFiles: this.svgCache.size,\n      textures: this.textureCache.size,\n      loading: this.loadingPromises.size\n    };\n  }\n}\n\n// Export singleton instance\nexport default new SVGAssetManager();","// Shared utility for determining resource overlay status\n// Used by both DOM and Canvas rendering systems\n\nexport const getResourceOverlayStatus = (\n  resource, \n  craftingStatus, \n  tradingStatus, \n  badgeState, \n  electionPhase,\n  currentPlayer\n) => {\n  if (!resource) return null;\n\n  const resourceKey = `${resource.x}-${resource.y}`;\n  \n  // Check various status conditions\n  const isCraftReady = craftingStatus?.ready?.includes(resourceKey);\n  const isCraftInProgress = craftingStatus?.inProgress?.includes(resourceKey);\n  const isTradingReady = tradingStatus?.ready?.includes(resourceKey);\n  \n  // Determine overlay type based on priority (most important first)\n  \n  // Crafting status (highest priority)\n  if (isCraftReady) {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  if (isCraftInProgress) {\n    return { type: 'inprogress', priority: 2 };\n  }\n  \n  // Trading Post status\n  if (isTradingReady && resource.type === 'Trading Post') {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  // Mailbox status\n  if (badgeState?.mailbox && resource.type === 'Mailbox') {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  // Pet status (if we add pet logic later)\n  // TODO: Add pet status logic here\n  \n  // Courthouse/Election status\n  if (resource.type === 'Courthouse') {\n    if (electionPhase === 'Campaigning') {\n      return { type: 'campaign', priority: 3 };\n    } else if (electionPhase === 'Voting') {\n      return { type: 'voting', priority: 1 };\n    }\n  }\n  \n  // No overlay needed\n  return null;\n};\n\n// Mapping from overlay types to SVG files\nexport const OVERLAY_SVG_MAPPING = {\n  'ready': 'checkmark.svg',\n  'completed': 'checkmark.svg', \n  'voting': 'checkmark.svg',\n  'inprogress': 'clock.svg',\n  'campaign': 'clock.svg',\n  'available': 'hand.svg',\n};\n\n// Mapping from overlay types to emoji (for DOM fallback)\nexport const OVERLAY_EMOJI_MAPPING = {\n  'ready': { emoji: '', color: 'green' },\n  'completed': { emoji: '', color: '#32CD32' },\n  'voting': { emoji: '', color: 'green' },\n  'inprogress': { emoji: '', color: 'orange' },\n  'campaign': { emoji: '', color: '#FFD700' },\n  'available': { emoji: '', color: '#FFD700' },\n  'exclamation': { emoji: '', color: '#FF6B35' },\n  'attack': { emoji: '', color: '#DC143C' },\n};","/**\n * Shared cursor logic for DOM and Canvas modes\n * Provides consistent cursor behavior across rendering modes\n */\n\n// Global attack cooldown tracking (shared across modes)\nlet globalAttackCooldown = 0;\n\n/**\n * Updates the global attack cooldown\n * @param {number} cooldownEndTime - The timestamp when the cooldown ends\n */\nexport function setGlobalAttackCooldown(cooldownEndTime) {\n  globalAttackCooldown = cooldownEndTime;\n}\n\n/**\n * Gets the current global attack cooldown end time\n * @returns {number} The timestamp when the cooldown ends\n */\nexport function getGlobalAttackCooldown() {\n  return globalAttackCooldown;\n}\n\n/**\n * Determines the appropriate cursor style for an NPC\n * @param {Object} npc - The NPC object\n * @returns {string} CSS cursor class name\n */\nexport function getNPCCursorClass(npc) {\n  if (!npc) return 'cursor-pointer';\n  \n  const currentTime = Date.now();\n  \n  // Handle different NPC types\n  switch (npc.action) {\n    case 'heal':\n    case 'worker':\n    case 'trade':\n    case 'quest':\n      return 'cursor-help';\n      \n    case 'attack':\n    case 'spawn':\n      // For attack NPCs, check cooldown status\n      return currentTime < globalAttackCooldown ? 'cursor-wait' : 'cursor-crosshair';\n      \n    default:\n      return 'cursor-pointer';\n  }\n}\n\n/**\n * Determines the appropriate cursor style for a resource\n * @param {Object} resource - The resource object\n * @returns {string} CSS cursor class name\n */\nexport function getResourceCursorClass(resource) {\n  if (!resource) return 'cursor-pointer';\n  \n  // All resources should show pointer cursor (finger) when hoverable\n  // Specific interactive resources like crafting stations can show help cursor\n  switch (resource.category) {\n    case 'crafting':\n    case 'farmhouse':\n      return 'cursor-help'; // Crafting stations are more interactive\n      \n    default:\n      // All other resources (farmplot, deco, structure, etc.) show pointer\n      return 'cursor-pointer';\n  }\n}\n\n/**\n * Applies cursor class to a DOM element\n * @param {HTMLElement} element - The DOM element\n * @param {string} cursorClass - The cursor class to apply\n */\nexport function applyCursorClass(element, cursorClass) {\n  if (!element) return;\n  \n  // Remove all cursor classes first\n  element.classList.remove('cursor-pointer', 'cursor-help', 'cursor-wait', 'cursor-crosshair');\n  \n  // Apply the new cursor class\n  if (cursorClass) {\n    element.classList.add(cursorClass);\n  }\n}\n\n/**\n * Sets cursor style for canvas elements using CSS\n * @param {HTMLCanvasElement} canvas - The canvas element\n * @param {string} cursorClass - The cursor class to apply\n */\nexport function setCanvasCursor(canvas, cursorClass) {\n  if (!canvas) return;\n  \n  // Map cursor classes to CSS cursor values\n  const cursorMap = {\n    'cursor-pointer': 'pointer',\n    'cursor-help': 'help',\n    'cursor-wait': 'wait',\n    'cursor-crosshair': 'crosshair'\n  };\n  \n  canvas.style.cursor = cursorMap[cursorClass] || 'default';\n}","import React, { useRef, useEffect, useCallback } from 'react';\nimport SVGAssetManager from './SVGAssetManager';\nimport { getResourceOverlayStatus, OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\nimport { getResourceCursorClass, setCanvasCursor } from '../Utils/CursorUtils';\n\n// Test resource art mapping - easy to add/remove for testing\nconst CUSTOM_ART_MAPPING = {\n  'Farmhouse': 'farmhouse.svg',\n  'Oak Tree': 'oak-tree.svg',\n  'Pine Tree': 'pine-tree.svg',\n  'Farm House': 'farmhouse.svg',\n  'Mailbox': 'farmhouse.svg',\n  // Add more test assets here as you create them\n};\n\n\n// Canvas-based resource renderer component\nexport const RenderResourcesCanvas = ({ \n  resources,\n  masterResources, \n  globalTuning,\n  TILE_SIZE,\n  craftingStatus,\n  tradingStatus, \n  badgeState,\n  electionPhase,\n  currentPlayer,\n  handleTileClick,\n  onMouseEnter,\n  onMouseLeave \n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n  \n  \n  // Update SVGAssetManager zoom tiers when globalTuning changes\n  useEffect(() => {\n    if (globalTuning) {\n      SVGAssetManager.updateZoomTiers(globalTuning);\n    }\n  }, [globalTuning]);\n  \n  // Render resources to canvas\n  const renderResources = useCallback(async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !resources) return;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // Only render resources that have custom SVG art\n    const svgResources = resources.filter(resource => \n      resource.type !== 'shadow' && CUSTOM_ART_MAPPING[resource.type]\n    );\n    \n    // Render each SVG resource - only at anchor positions for multi-tile resources\n    for (const resource of svgResources) {\n      // Only render once per resource at its anchor position (x,y)\n      // Multi-tile resources span from (x,y) but are visually rendered from anchor\n      await renderSingleResource(ctx, resource, TILE_SIZE);\n    }\n    \n    // Render overlays for ALL resources (not just SVG ones) when canvas mode is enabled\n    const visibleResources = resources.filter(resource => \n      resource.type !== 'shadow' && resource.category !== 'doober' && resource.category !== 'source'\n    );\n    \n    for (const resource of visibleResources) {\n      await renderResourceOverlay(ctx, resource, TILE_SIZE);\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase]);\n\n  // Render a single SVG resource\n  const renderSingleResource = async (ctx, resource, TILE_SIZE) => {\n    const x = resource.x * TILE_SIZE;\n    const y = resource.y * TILE_SIZE;\n    const size = TILE_SIZE * (resource.range || 1);\n    \n    // Get the SVG art (we know it exists since we filtered for it)\n    const customArt = CUSTOM_ART_MAPPING[resource.type];\n    \n    // Render custom SVG art\n    const texture = await SVGAssetManager.getSVGTexture(customArt, size);\n    if (texture) {\n      ctx.drawImage(texture, x, y, size, size);\n    } else {\n      console.warn(`Failed to load SVG for ${resource.type}: ${customArt}`);\n    }\n  };\n\n  // Render overlay for a resource (status indicators)\n  const renderResourceOverlay = async (ctx, resource, TILE_SIZE) => {\n    // Use shared overlay logic to determine what overlay to show\n    const overlayInfo = getResourceOverlayStatus(\n      resource, \n      craftingStatus, \n      tradingStatus, \n      badgeState, \n      electionPhase,\n      currentPlayer\n    );\n    \n    if (!overlayInfo) return; // No overlay needed\n    \n    const overlayType = overlayInfo.type;\n    \n    // Render overlay if one is determined\n    if (overlayType && OVERLAY_SVG_MAPPING[overlayType]) {\n      const x = resource.x * TILE_SIZE;\n      const y = resource.y * TILE_SIZE;\n      const size = TILE_SIZE * (resource.range || 1);\n      \n      // Position overlay in lower-left corner of the resource's primary tile\n      const overlaySize = Math.max(12, TILE_SIZE * 0.3); // Based on single tile size, not resource size\n      const overlayX = x + 2; // Small offset from left edge\n      const overlayY = y + TILE_SIZE - overlaySize - 2; // Lower corner of primary tile\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        OVERLAY_SVG_MAPPING[overlayType], \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      } else {\n        console.warn(`Failed to load overlay texture for ${overlayType}`);\n      }\n    }\n  };\n\n  // Re-render when dependencies change\n  useEffect(() => {\n    const currentData = JSON.stringify({ \n      resources: resources?.map(r => ({ \n        x: r.x, \n        y: r.y, \n        type: r.type, \n        symbol: r.symbol, \n        range: r.range \n      })), \n      TILE_SIZE,\n      craftingReady: craftingStatus?.ready,\n      craftingInProgress: craftingStatus?.inProgress,\n      tradingReady: tradingStatus?.ready,\n      mailboxBadge: badgeState?.mailbox,\n      electionPhase,\n      playerId: currentPlayer?.id // Include player ID for trade status changes\n    });\n    \n    if (currentData !== lastRenderData.current) {\n      renderResources();\n      lastRenderData.current = currentData;\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase, currentPlayer]);\n\n  // Handle canvas clicks and convert to grid coordinates\n  const handleCanvasClick = useCallback((event) => {\n    if (!handleTileClick) return;\n    \n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    handleTileClick(rowIndex, colIndex);\n  }, [handleTileClick, TILE_SIZE]);\n\n  // Handle mouse events for tooltips and cursor\n  const handleCanvasMouseMove = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      console.log('Canvas resource mouse: No canvas ref');\n      return;\n    }\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    \n    // Find resource at this position - CHECK ALL RESOURCES, not just SVG ones\n    // This matches DOM mode behavior where all resources get mouse events\n    const resource = resources?.find(r => {\n      // Skip shadow, doober, and source resources (same as DOM mode)\n      if (r.type === 'shadow' || r.category === 'doober' || r.category === 'source') {\n        return false;\n      }\n      \n      return colIndex >= r.x && colIndex < r.x + (r.range || 1) &&\n             rowIndex >= r.y && rowIndex < r.y + (r.range || 1);\n    });\n    \n    if (resource) {\n      // Set appropriate cursor for this resource\n      const cursorClass = getResourceCursorClass(resource);\n      setCanvasCursor(canvas, cursorClass);\n      \n      // Call the tooltip handler if provided\n      if (onMouseEnter) {\n        onMouseEnter(event, resource, rowIndex, colIndex);\n      }\n    } else {\n      // No resource - reset cursor\n      setCanvasCursor(canvas, null);\n      if (onMouseLeave) {\n        onMouseLeave(event);\n      }\n    }\n  }, [onMouseEnter, onMouseLeave, resources, TILE_SIZE]);\n\n  const handleCanvasMouseLeave = useCallback((event) => {\n    if (onMouseLeave) {\n      onMouseLeave(event);\n    }\n  }, [onMouseLeave]);\n\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      onMouseMove={handleCanvasMouseMove}\n      onMouseLeave={handleCanvasMouseLeave}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: `${64 * TILE_SIZE}px`,\n        height: `${64 * TILE_SIZE}px`,\n        zIndex: 12, // Above DOM resources (10) and resource overlays (11)\n        pointerEvents: 'auto'\n      }}\n    />\n  );\n};","import React from 'react';\n\n/**\n * DOM-based resource renderer - only renders the resource symbols themselves\n * Overlays and tooltips are handled by RenderDynamicElements\n */\nexport const RenderResourcesDOM = ({\n  resources,\n  TILE_SIZE,\n  handleTileClick\n}) => {\n\n  return (\n    <>\n      {/* Create a 64x64 grid and check each tile for resources */}\n      {Array.from({ length: 64 }, (_, rowIndex) => \n        Array.from({ length: 64 }, (_, colIndex) => {\n          // Check if this tile is part of a multi-tile resource\n          const resource = resources.find((res) => {\n            const range = res.range || 1;\n            // Check if the current tile falls within the resource's range\n            // Resource is anchored at lower-left (res.x, res.y)\n            return colIndex >= res.x && colIndex < res.x + range &&\n                   rowIndex <= res.y && rowIndex > res.y - range;\n          });\n          \n          // Only render if there's a resource\n          if (!resource) return null;\n          \n          const key = `${colIndex}-${rowIndex}`;\n\n          return (\n            <div\n              key={`resource-${rowIndex}-${colIndex}-${resource?.symbol || ''}`}\n              className=\"resource-tile\"\n              data-resource-type={resource.type}\n              data-resource-x={resource.x}\n              data-resource-y={resource.y}\n              onClick={() => handleTileClick(rowIndex, colIndex)}\n              style={{\n                position: 'absolute',\n                top: rowIndex * TILE_SIZE,\n                left: colIndex * TILE_SIZE,\n                width: TILE_SIZE,\n                height: TILE_SIZE,\n                cursor: 'pointer',\n                zIndex: 10, // Above tiles but below PCs (16) and NPCs (15)\n                pointerEvents: resource && resource.x === colIndex && resource.y === rowIndex ? 'auto' : 'none',\n              }}\n            >\n              {/* Resource Symbol - only render at anchor position for multi-tile resources */}\n              {resource && resource.x === colIndex && resource.y === rowIndex && (\n                <div\n                  className=\"resource-overlay\"\n                  style={{\n                    fontSize: resource.range > 1 \n                      ? resource.action === 'wall'\n                        ? `${TILE_SIZE * 1.2 * resource.range}px` // Multi-tile walls\n                        : `${TILE_SIZE * 0.8 * resource.range}px` // Other multi-tile resources\n                      : resource.action === 'wall'\n                        ? `${TILE_SIZE * 1.1}px` // Single-tile walls\n                        : `${TILE_SIZE * 0.7}px`, // Other single-tile resources\n                    width: resource.range > 1 ? `${TILE_SIZE * resource.range}px` : 'auto',\n                    height: resource.range > 1 ? `${TILE_SIZE * resource.range}px` : 'auto',\n                    position: resource.range > 1 ? 'absolute' : 'static',\n                    left: resource.range > 1 ? '0' : 'auto',\n                    top: resource.range > 1 \n                      ? resource.action === 'wall' \n                        ? `${-TILE_SIZE * (resource.range - 1) + 3}px` // Multi-tile walls shifted down 2px\n                        : `-${TILE_SIZE * (resource.range - 1)}px` // Other multi-tile resources\n                      : 'auto',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    zIndex: resource.range > 1 ? 12 : 11, // Above tiles but below NPCs and PCs\n                    pointerEvents: 'none',\n                    overflow: 'visible',\n                    lineHeight: resource.action === 'wall' ? '1' : 'normal',\n                  }}\n                >\n                  {resource.symbol || ''}\n                </div>\n              )}\n\n            </div>\n          );\n        })\n      )}\n    </>\n  );\n};\n\nexport default RenderResourcesDOM;","import React from 'react';\nimport { RenderResourcesCanvas } from './RenderResourcesCanvas';\nimport { RenderResourcesDOM } from './RenderResourcesDOM';\n\n/**\n * Main resource rendering component that decides between Canvas and DOM rendering\n * Only handles the actual resource entities, not their overlays or tooltips\n */\nexport const RenderResources = ({ \n  resources,\n  masterResources,\n  globalTuning,\n  TILE_SIZE,\n  handleTileClick,\n  useCanvasResources = false\n}) => {\n  // Simple decision: Canvas or DOM\n  if (useCanvasResources) {\n    return (\n      <RenderResourcesCanvas\n        resources={resources}\n        masterResources={masterResources}\n        globalTuning={globalTuning}\n        TILE_SIZE={TILE_SIZE}\n        handleTileClick={handleTileClick}\n      />\n    );\n  } else {\n    return (\n      <RenderResourcesDOM\n        resources={resources}\n        TILE_SIZE={TILE_SIZE}\n        handleTileClick={handleTileClick}\n      />\n    );\n  }\n};\n\nexport default RenderResources;","import React, { useRef, useEffect, useCallback, useMemo } from 'react';\nimport SVGAssetManager from './SVGAssetManager';\nimport { OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\nimport { generateNPCTooltipContent, handleNPCClickShared } from '../GameFeatures/NPCs/NPCInteractionUtils';\nimport { getNPCCursorClass, setCanvasCursor } from '../Utils/CursorUtils';\n\n// NPC art mapping - maps NPC types to SVG files\n// Start with a few NPCs for testing, can expand later\nconst NPC_ART_MAPPING = {\n  // Add NPC types as we create SVG art for them\n  // 'Farmer': 'farmer.svg',\n  // 'Kent': 'kent.svg',\n  // For now, we'll render NPCs as emoji symbols in canvas\n};\n\n// Canvas-based NPC renderer component\nconst RenderNPCsCanvasComponent = ({ \n  npcs,\n  TILE_SIZE,\n  currentPlayer,\n  globalTuning,\n  gridId,\n  onNPCClick,\n  onMouseEnter,\n  onMouseLeave,\n  // Status checking functions\n  checkQuestNPCStatus,\n  checkTradeNPCStatus,\n  checkKentNPCStatus,\n  getOverlayContent,\n  // Additional props for NPC interactions\n  strings,\n  masterResources,\n  playersInGrid,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  setHoverTooltip\n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n  \n  // Canvas-specific animation system (mimics DOM's CSS transitions)\n  const canvasAnimations = useRef({});\n  const animationFrameId = useRef(null);\n  const renderNPCsRef = useRef(null);\n  \n  // Use NPCs directly without memoization to ensure we see all position updates\n  useEffect(() => {\n    // Removed log to reduce noise\n  }, [npcs]);\n  \n  // Update SVGAssetManager zoom tiers when globalTuning changes\n  useEffect(() => {\n    if (globalTuning) {\n      SVGAssetManager.updateZoomTiers(globalTuning);\n    }\n  }, [globalTuning]);\n\n  // Animation loop (mimics CSS transition behavior)\n  const startAnimationLoop = useCallback(() => {\n    const animate = () => {\n      const now = Date.now();\n      let hasActiveAnimations = false;\n      \n      // Update all animation positions\n      Object.keys(canvasAnimations.current).forEach(npcId => {\n        const animation = canvasAnimations.current[npcId];\n        if (!animation || animation.duration === 0) return;\n        \n        const elapsed = now - animation.startTime;\n        \n        if (elapsed >= animation.duration) {\n          // Animation complete\n          animation.currentPos = { ...animation.targetPos };\n          animation.duration = 0;\n        } else {\n          // Linear interpolation (matches DOM CSS 'linear' timing)\n          const progress = elapsed / animation.duration;\n          animation.currentPos = {\n            x: animation.startPos.x + (animation.targetPos.x - animation.startPos.x) * progress,\n            y: animation.startPos.y + (animation.targetPos.y - animation.startPos.y) * progress\n          };\n          hasActiveAnimations = true;\n        }\n      });\n      \n      // Re-render canvas\n      if (renderNPCsRef.current) {\n        renderNPCsRef.current();\n      }\n      \n      // Continue loop if there are active animations\n      if (hasActiveAnimations) {\n        animationFrameId.current = requestAnimationFrame(animate);\n      } else {\n        animationFrameId.current = null;\n      }\n    };\n    \n    animationFrameId.current = requestAnimationFrame(animate);\n  }, []);\n\n  // Start animation when NPC positions change\n  // Re-run whenever the NPCs array or positions change\n  useEffect(() => {\n    if (!npcs || npcs.length === 0) return;\n    \n    // Removed log to reduce noise\n    let hasPositionChanges = false;\n    \n    npcs.forEach(npc => {\n      const currentAnimation = canvasAnimations.current[npc.id];\n      \n      // NPCs use their actual position, not renderPositions (that's for PCs)\n      const targetPos = { x: npc.position.x, y: npc.position.y };\n      \n      if (!currentAnimation) {\n        // First time - just set position\n        // NPC initialized\n        canvasAnimations.current[npc.id] = {\n          startPos: { ...targetPos },\n          currentPos: { ...targetPos },\n          targetPos: { ...targetPos },\n          startTime: Date.now(),\n          duration: 0 // No animation needed for first time\n        };\n        hasPositionChanges = true;\n      } else if (currentAnimation.targetPos.x !== targetPos.x || currentAnimation.targetPos.y !== targetPos.y) {\n        // Position changed - start new animation from current position\n        // NPC moved\n        canvasAnimations.current[npc.id] = {\n          startPos: { ...currentAnimation.currentPos },\n          currentPos: { ...currentAnimation.currentPos },\n          targetPos: { ...targetPos },\n          startTime: Date.now(),\n          duration: 1200 // 1.2s to match DOM CSS transitions\n        };\n        hasPositionChanges = true;\n        \n        // Start animation loop if not already running\n        if (!animationFrameId.current) {\n          startAnimationLoop();\n        }\n      }\n    });\n    \n    // Always trigger a render when this effect runs\n    if (renderNPCsRef.current) {\n      // Triggering canvas render\n      renderNPCsRef.current();\n    }\n  }, [npcs, startAnimationLoop]);\n\n  // Cleanup animation loop on unmount\n  useEffect(() => {\n    return () => {\n      if (animationFrameId.current) {\n        cancelAnimationFrame(animationFrameId.current);\n        animationFrameId.current = null;\n      }\n    };\n  }, []);\n\n  // Get current render position for NPC (includes animation state)\n  const getNPCRenderPosition = useCallback((npc) => {\n    const animation = canvasAnimations.current[npc.id];\n    if (animation) {\n      return animation.currentPos;\n    }\n    // Fallback to base position if no animation data\n    return npc.position;\n  }, []);\n  \n  // Render NPCs to canvas\n  const renderNPCs = useCallback(async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !npcs) return;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // Render each NPC\n    for (const npc of npcs) {\n      if (!npc || !npc.position || typeof npc.position.x === 'undefined' || typeof npc.position.y === 'undefined') {\n        continue; // Skip NPCs without valid position data\n      }\n      \n      renderSingleNPC(ctx, npc, TILE_SIZE);\n      await renderNPCOverlay(ctx, npc, TILE_SIZE);\n    }\n  }, [npcs, TILE_SIZE, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus, getNPCRenderPosition]);\n\n  // Store renderNPCs function in ref for animation loop access\n  useEffect(() => {\n    renderNPCsRef.current = renderNPCs;\n    // Trigger immediate render when function is first set\n    if (npcs && npcs.length > 0) {\n      // RenderNPCs function ready\n      renderNPCs();\n    }\n  }, [renderNPCs, npcs]);\n\n  // Render a single NPC\n  const renderSingleNPC = (ctx, npc, TILE_SIZE) => {\n    // Use interpolated position for smooth movement\n    const renderPos = getNPCRenderPosition(npc);\n    const x = renderPos.x * TILE_SIZE;\n    const y = renderPos.y * TILE_SIZE;\n    \n    // Check if we have custom SVG art for this NPC type\n    const customArt = NPC_ART_MAPPING[npc.type];\n    \n    if (customArt) {\n      // For now, skip SVG loading since it's async and we don't have any NPC art yet\n      // Just use emoji rendering\n      renderNPCEmoji(ctx, npc, x, y, TILE_SIZE);\n    } else {\n      // Render NPC as emoji symbol (fallback for NPCs without SVG art)\n      renderNPCEmoji(ctx, npc, x, y, TILE_SIZE);\n    }\n  };\n\n  // Render NPC as emoji symbol in canvas\n  const renderNPCEmoji = (ctx, npc, x, y, TILE_SIZE) => {\n    ctx.save();\n    ctx.font = `${TILE_SIZE * 0.7}px sans-serif`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    \n    // Position text in center of tile\n    const centerX = x + TILE_SIZE / 2;\n    const centerY = y + TILE_SIZE / 2;\n    \n    ctx.fillText(npc.symbol || '', centerX, centerY);\n    ctx.restore();\n  };\n\n  // Render overlay for an NPC (status indicators)\n  const renderNPCOverlay = async (ctx, npc, TILE_SIZE) => {\n    // Determine what overlay to show for this NPC\n    let overlayType = null;\n    \n    // Check quest NPCs first (including Kent)\n    if (npc.action === 'quest' && checkQuestNPCStatus) {\n      overlayType = await checkQuestNPCStatus(npc);\n      \n      // For Kent, also check affordable offers if no quest overlay\n      if (!overlayType && npc.type === 'Kent' && checkKentNPCStatus) {\n        overlayType = checkKentNPCStatus(npc);\n      }\n    }\n    // Check trade NPCs\n    else if (npc.action === 'trade' && checkTradeNPCStatus) {\n      overlayType = checkTradeNPCStatus(npc);\n    }\n    \n    if (!overlayType) return; // No overlay needed\n    \n    // For trade NPCs, overlayType might be the trade item symbol\n    // For other NPCs, it's a status like 'completed', 'available', etc.\n    let svgFileName = OVERLAY_SVG_MAPPING[overlayType];\n    \n    if (!svgFileName && overlayType && overlayType.length <= 3) {\n      // Trade NPC with item symbol - use hand.svg as fallback\n      svgFileName = OVERLAY_SVG_MAPPING['available']; // hand.svg\n    }\n    \n    if (svgFileName) {\n      // Use interpolated position for overlays to match NPC movement  \n      const interpolatedPos = getNPCRenderPosition(npc);\n      const x = interpolatedPos.x * TILE_SIZE;\n      const y = interpolatedPos.y * TILE_SIZE;\n      \n      // Position overlay in lower-left corner of the NPC\n      const overlaySize = Math.max(12, TILE_SIZE * 0.3);\n      const overlayX = x + 2; // Small offset from left edge\n      const overlayY = y + TILE_SIZE - overlaySize - 2; // Lower corner\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        svgFileName, \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      } else {\n        console.warn(`Failed to load overlay texture for NPC ${npc.type}: ${svgFileName}`);\n      }\n    }\n  };\n\n  // Re-render when NPCs change or TILE_SIZE changes\n  // This ensures NPCs appear immediately when the component mounts\n  useEffect(() => {\n    if (renderNPCsRef.current) {\n      renderNPCsRef.current();\n    }\n  }, [npcs, TILE_SIZE, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus, currentPlayer]);\n\n  // Handle canvas clicks and convert to grid coordinates\n  const handleCanvasClick = useCallback((event) => {\n    if (!onNPCClick) return;\n    \n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Find NPC at this position\n    const npc = npcs?.find(n => {\n      const renderPos = getNPCRenderPosition(n);\n      return Math.floor(renderPos.x) === colIndex && Math.floor(renderPos.y) === rowIndex;\n    });\n    \n    if (npc) {\n      // NPC found - handle the click and stop propagation\n      event.preventDefault();\n      event.stopPropagation();\n      \n      // Handle different NPC types properly\n      if (npc.action === 'quest' || npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade') {\n        // These NPCs open panels/dialogs\n        onNPCClick(npc);\n      } else {\n        // These NPCs use the standard handleNPCClick (combat, grazing, etc.)\n        const { handleNPCClick } = require('../GameFeatures/NPCs/NPCUtils');\n        handleNPCClick(\n          npc,\n          Math.round(npc.position?.y || 0),\n          Math.round(npc.position?.x || 0),\n          setInventory,\n          setBackpack,\n          setResources,\n          currentPlayer,\n          setCurrentPlayer,\n          TILE_SIZE,\n          masterResources,\n          masterSkills,\n          currentPlayer?.location?.g,\n          setModalContent,\n          setIsModalOpen,\n          updateStatus,\n          openPanel,\n          setActiveStation,\n          strings,\n          masterTrophies,\n          globalTuning\n        );\n      }\n    } else {\n      // No NPC found - forward this click to the grid by finding the underlying element\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Temporarily hide the canvas so we can find what's underneath\n        canvas.style.pointerEvents = 'none';\n        \n        // Find the element at this position\n        const elementBelow = document.elementFromPoint(event.clientX, event.clientY);\n        \n        // Restore canvas pointer events\n        canvas.style.pointerEvents = 'auto';\n        \n        // If we found an element below, simulate a click on it\n        if (elementBelow) {\n          const clickEvent = new MouseEvent('click', {\n            bubbles: true,\n            cancelable: true,\n            clientX: event.clientX,\n            clientY: event.clientY,\n            button: event.button,\n            buttons: event.buttons\n          });\n          elementBelow.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, [onNPCClick, npcs, TILE_SIZE, getNPCRenderPosition]);\n\n  // Handle mouse events for tooltips and dynamic cursor\n  const handleCanvasMouseMove = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Find NPC at this position\n    const npc = npcs?.find(n => {\n      const renderPos = getNPCRenderPosition(n);\n      return Math.floor(renderPos.x) === colIndex && Math.floor(renderPos.y) === rowIndex;\n    });\n    \n    if (npc) {\n      // NPC found - set appropriate cursor and handle tooltip\n      const cursorClass = getNPCCursorClass(npc);\n      setCanvasCursor(canvas, cursorClass);\n      \n      // Generate tooltip content using shared function\n      const tooltipContent = generateNPCTooltipContent(npc, strings);\n      \n      // Position tooltip at mouse position  \n      if (setHoverTooltip) {\n        const tooltipData = {\n          x: event.clientX,\n          y: event.clientY - 10, // Slightly above cursor\n          content: tooltipContent,\n        };\n        setHoverTooltip(tooltipData);\n      }\n    } else {\n      // No NPC - show default cursor and clear tooltip\n      setCanvasCursor(canvas, null); // Reset to default\n      if (setHoverTooltip) {\n        setHoverTooltip(null);\n      }\n    }\n  }, [onMouseEnter, setHoverTooltip, strings, npcs, TILE_SIZE, getNPCRenderPosition]);\n\n  const handleCanvasMouseLeave = useCallback((event) => {\n    // Clear tooltip when leaving canvas\n    if (setHoverTooltip) {\n      setHoverTooltip(null);\n    }\n    \n    if (onMouseLeave) {\n      onMouseLeave(event);\n    }\n  }, [onMouseLeave, setHoverTooltip]);\n\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      onMouseMove={handleCanvasMouseMove}\n      onMouseLeave={handleCanvasMouseLeave}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 15, // Same as DOM NPCs\n        pointerEvents: 'auto'\n      }}\n    />\n  );\n};\n\n// Export component without complex memoization to ensure position updates are seen\nexport const RenderNPCsCanvas = RenderNPCsCanvasComponent;","import { getDerivedRange } from '../../Utils/worldHelpers';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleNPCClick } from './NPCUtils';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport FloatingTextManager from '../../UI/FloatingText';\n\n// Shared global attack cooldown for consistency between DOM and Canvas modes\nlet globalAttackCooldown = 0;\n\n/**\n * Generates tooltip content for NPCs - shared between DOM and Canvas modes\n * This ensures identical tooltip behavior across rendering modes\n */\nexport function generateNPCTooltipContent(npc, strings) {\n  const localizedNPCType = getLocalizedString(npc.type, strings);\n  let tooltipContent = `<p>${localizedNPCType}</p>`;\n\n  switch (npc.action) {\n    case 'graze': {\n      switch (npc.state) {\n        case 'processing':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is ready.</p>`;\n          break;\n        case 'hungry': {\n          const lookingFor = npc.type === 'Pig' ? 'dirt' : 'grass';\n          tooltipContent = `<p>${localizedNPCType}</p><p>is hungry and</p><p>looking for ${lookingFor}.</p>`;\n          break;\n        }\n        case 'grazing': {\n          let countdownText = \"\";\n          if (npc.grazeEnd) {\n            const remainingTime = Math.max(0, npc.grazeEnd - Date.now());\n            const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n            const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n            countdownText = `<p>${minutes}m ${seconds}s</p>`;\n          }\n          tooltipContent = `<p>${localizedNPCType}</p><p>is grazing.</p>${countdownText}`;\n          break;\n        }\n        case 'idle':\n          tooltipContent = `<p>Zzzz...</p>`;\n          break;\n        case 'roam':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is roaming.</p>`;\n          break;\n        case 'stall':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is looking for an Animal Stall.</p>`;\n          break;\n        default:\n          tooltipContent = `<p>${localizedNPCType}</p>`;\n          break;\n      }\n      break;\n    }\n    case 'quest':\n      if (npc.type === 'Kent') {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[47] || 'Kent says hi!'}\"</p>`;\n      } else {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[48] || 'I have quests!'}\"</p>`;\n      }\n      break;\n    case 'trade':\n    case 'heal':\n    case 'worker':\n      tooltipContent = `<p>${localizedNPCType}</p>`;\n      break;\n    case 'attack':\n    case 'spawn':\n      tooltipContent = `<p>${localizedNPCType}</p><p>HP: ${npc.hp}/${npc.maxhp}</p>`;\n      // Add state info for enemy NPCs\n      if (npc.state) {\n        tooltipContent += `<p>State: ${npc.state}</p>`;\n      }\n      break;\n    default:\n      tooltipContent = `<p>${npc.type}</p>`;\n      break;\n  }\n\n  return tooltipContent;\n}\n\n/**\n * Handles NPC clicks with full parity to DOM mode logic - shared between DOM and Canvas\n * This ensures identical click behavior across rendering modes\n */\nexport function handleNPCClickShared(npc, {\n  currentPlayer,\n  playersInGrid,\n  gridId,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  globalTuning,\n  strings,\n  // Overlay checking function (optional - only used by DOM mode)\n  getNPCOverlay,\n  // Event handlers\n  onNPCClick,\n  setHoverTooltip,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation\n}) {\n  // Check if NPC has an overlay that prevents clicking (DOM mode feature)\n  if (getNPCOverlay) {\n    const overlayData = getNPCOverlay(npc.id);\n    if (overlayData && !overlayData.clickable) {\n      return false; // Prevent clicking on non-clickable overlay NPCs\n    }\n  }\n  \n  //  Prevent interaction with NPCs on another player's homestead\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n  if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead) {\n    return false; // Cannot interact with NPCs on another player's homestead\n  }\n  \n  // Clear any existing tooltip\n  if (setHoverTooltip) {\n    setHoverTooltip(null);\n  }\n  \n  const currentTime = Date.now();\n  \n  // Handle attack NPCs with cooldown\n  if (npc.action === 'attack' || npc.action === 'spawn') {\n    const pcState = playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)];\n    const speed = pcState?.speed ?? currentPlayer.baseSpeed ?? 5;\n    if (currentTime < globalAttackCooldown) {\n      return false; // Still on cooldown\n    }\n    globalAttackCooldown = currentTime + (speed * 1000);\n  }\n  \n  // Handle quest/heal/worker/trade NPCs with range checking\n  if (npc.action === 'quest' || npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade') {\n    // Check range for helper NPCs\n    const playerPos = playersInGridManager.getPlayerPosition(currentPlayer?.location?.g, String(currentPlayer._id));\n    const npcPos = { x: Math.round(npc.position?.x || 0), y: Math.round(npc.position?.y || 0) };\n    \n    if (playerPos && typeof playerPos.x === 'number' && typeof playerPos.y === 'number') {\n      const distance = Math.sqrt(Math.pow(playerPos.x - npcPos.x, 2) + Math.pow(playerPos.y - npcPos.y, 2));\n      const playerRange = getDerivedRange(currentPlayer, masterResources);\n      \n      if (distance > playerRange) {\n        // Show \"Out of range\" message\n        FloatingTextManager.addFloatingText(24, npcPos.x, npcPos.y, TILE_SIZE);\n        return false;\n      }\n    }\n    \n    // Use onNPCClick for these special NPCs (opens panels/dialogs)\n    if (onNPCClick) {\n      onNPCClick(npc);\n    }\n    return true;\n  } else {\n    // Use handleNPCClick for regular NPCs (combat, grazing, etc.)\n    handleNPCClick(\n      npc,\n      Math.round(npc.position?.y || 0),\n      Math.round(npc.position?.x || 0),\n      setInventory,\n      setBackpack,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      TILE_SIZE,\n      masterResources,\n      masterSkills,\n      currentPlayer?.location?.g,\n      setModalContent,\n      setIsModalOpen,\n      updateStatus,\n      openPanel,\n      setActiveStation,\n      strings,\n      masterTrophies,\n      globalTuning\n    );\n    return true;\n  }\n}\n\n/**\n * Gets the current attack cooldown status\n */\nexport function getAttackCooldownStatus() {\n  return {\n    cooldownEnd: globalAttackCooldown,\n    isOnCooldown: Date.now() < globalAttackCooldown\n  };\n}\n\n/**\n * Determines cursor class for NPC based on action and cooldown status\n */\nexport function getNPCCursorClass(npc) {\n  if (npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade' || npc.action === 'quest') {\n    return 'cursor-help';\n  } else if (npc.action === 'attack' || npc.action === 'spawn') {\n    // For attack NPCs, check reload status\n    const currentTime = Date.now();\n    return currentTime < globalAttackCooldown ? 'cursor-wait' : 'cursor-crosshair';\n  }\n  return 'cursor-pointer';\n}\n\n/**\n * Sets the shared global attack cooldown (used by DOM mode to sync with shared state)\n */\nexport function setGlobalAttackCooldown(cooldownEnd) {\n  globalAttackCooldown = cooldownEnd;\n}","import React, { createContext, useContext, useState } from 'react';\n\nconst NPCOverlayContext = createContext();\n\nexport const NPCOverlayProvider = ({ children }) => {\n  // Map of npcId -> { overlay: 'hourglass'|'exclamation'|'attack'|etc, clickable: boolean }\n  const [npcOverlays, setNpcOverlays] = useState({});\n  \n  const setNPCOverlay = (npcId, overlayType, clickable = true) => {\n    console.log(` NPC ${npcId}: ${overlayType ? `setting overlay '${overlayType}'` : 'clearing overlay'} (clickable: ${clickable})`);\n    setNpcOverlays(prev => ({\n      ...prev,\n      [npcId]: overlayType ? { overlay: overlayType, clickable } : undefined\n    }));\n  };\n  \n  const clearNPCOverlay = (npcId) => {\n    setNPCOverlay(npcId, null);\n  };\n  \n  const getNPCOverlay = (npcId) => {\n    return npcOverlays[npcId];\n  };\n  \n  // Helper methods for common overlay types\n  const setBusyOverlay = (npcId) => setNPCOverlay(npcId, 'hourglass', false);\n  const setQuestOverlay = (npcId) => setNPCOverlay(npcId, 'exclamation', true);\n  const setAttackOverlay = (npcId) => setNPCOverlay(npcId, 'attack', true);\n  \n  return (\n    <NPCOverlayContext.Provider value={{ \n      npcOverlays,\n      setNPCOverlay,\n      clearNPCOverlay,\n      getNPCOverlay,\n      setBusyOverlay,\n      setQuestOverlay,\n      setAttackOverlay\n    }}>\n      {children}\n    </NPCOverlayContext.Provider>\n  );\n};\n\nexport const useNPCOverlay = () => useContext(NPCOverlayContext);","// Singleton manager for active conversations\nclass ConversationManager {\n  constructor() {\n    this.activeConversations = new Map(); // speakerId -> {emoji, topic, timestamp}\n    this.relationshipOutcomes = new Map(); // speakerId -> {type: 'positive'|'negative', timestamp}\n    this.listeners = new Set();\n  }\n  \n  // Add a conversation bubble\n  addSpeech(speakerId, emoji, topic, isMatch = false) {\n    console.log(' ConversationManager.addSpeech:', { speakerId, emoji, topic, isMatch });\n    this.activeConversations.set(speakerId, {\n      emoji,\n      topic,\n      timestamp: Date.now(),\n      isMatch\n    });\n    this.notifyListeners();\n  }\n  \n  // Remove a conversation bubble\n  removeSpeech(speakerId) {\n    console.log(' ConversationManager.removeSpeech:', speakerId);\n    this.activeConversations.delete(speakerId);\n    this.notifyListeners();\n  }\n  \n  // Get active speech for a speaker\n  getSpeech(speakerId) {\n    return this.activeConversations.get(speakerId);\n  }\n  \n  // Subscribe to changes\n  subscribe(listener) {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n  \n  // Notify all listeners of changes\n  notifyListeners() {\n    this.listeners.forEach(listener => listener());\n  }\n  \n  // Clear all conversations\n  clear() {\n    this.activeConversations.clear();\n    this.relationshipOutcomes.clear();\n    this.notifyListeners();\n  }\n  \n  // Add relationship outcome VFX\n  showOutcome(speakerId, isPositive) {\n    console.log(' ConversationManager.showOutcome:', { speakerId, isPositive });\n    this.relationshipOutcomes.set(speakerId, {\n      type: isPositive ? 'positive' : 'negative',\n      timestamp: Date.now()\n    });\n    this.notifyListeners();\n    \n    // Auto-remove after animation duration\n    setTimeout(() => {\n      this.relationshipOutcomes.delete(speakerId);\n      this.notifyListeners();\n    }, 2500); // 2.5 seconds to ensure animation completes\n  }\n  \n  // Get outcome for a speaker\n  getOutcome(speakerId) {\n    return this.relationshipOutcomes.get(speakerId);\n  }\n}\n\n// Export singleton instance\nexport default new ConversationManager();","import React, { useEffect, useState, useRef } from 'react';\nimport { getDerivedRange } from '../Utils/worldHelpers';\nimport { handleNPCClick } from '../GameFeatures/NPCs/NPCUtils';\nimport { renderPositions } from '../PlayerMovement';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport FloatingTextManager from '../UI/FloatingText';\nimport { useNPCOverlay } from '../UI/NPCOverlayContext';\nimport ConversationManager from '../GameFeatures/Relationships/ConversationManager';\nimport { getNPCCursorClass, setGlobalAttackCooldown, getGlobalAttackCooldown } from '../Utils/CursorUtils';\n\n/**\n * DOM-based NPC renderer - renders NPCs directly without NPCComponent\n * Note: Overlays and tooltips are now handled by RenderDynamicElements\n */\nexport const RenderNPCsDOM = ({\n  npcs,\n  TILE_SIZE,\n  currentPlayer,\n  globalTuning,\n  gridId,\n  onNPCClick,\n  checkQuestNPCStatus,\n  checkTradeNPCStatus,\n  checkKentNPCStatus,\n  strings,\n  masterResources,\n  playersInGrid,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies\n}) => {\n  const { getNPCOverlay } = useNPCOverlay();\n  \n  return (\n    <>\n      {npcs.map((npc) => {\n        // Skip NPCs without valid position data\n        if (!npc || !npc.position || typeof npc.position.x === 'undefined' || typeof npc.position.y === 'undefined') {\n          console.warn('NPC missing position data:', npc);\n          return null;\n        }\n        \n        return (\n          <NPCRenderer\n            key={npc.id}\n            npc={npc}\n            TILE_SIZE={TILE_SIZE}\n            currentPlayer={currentPlayer}\n            onNPCClick={onNPCClick}\n            gridId={gridId}\n            strings={strings}\n            masterResources={masterResources}\n            playersInGrid={playersInGrid}\n            getNPCOverlay={getNPCOverlay}\n            setInventory={setInventory}\n            setBackpack={setBackpack}\n            setResources={setResources}\n            setCurrentPlayer={setCurrentPlayer}\n            masterSkills={masterSkills}\n            setModalContent={setModalContent}\n            setIsModalOpen={setIsModalOpen}\n            updateStatus={updateStatus}\n            openPanel={openPanel}\n            setActiveStation={setActiveStation}\n            masterTrophies={masterTrophies}\n            globalTuning={globalTuning}\n          />\n        );\n      })}\n    </>\n  );\n};\n\n// Individual NPC renderer component (replaces NPCComponent)\nconst NPCRenderer = ({\n  npc,\n  TILE_SIZE,\n  currentPlayer,\n  onNPCClick,\n  gridId,\n  strings,\n  masterResources,\n  playersInGrid,\n  getNPCOverlay,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  globalTuning\n}) => {\n  const [position, setPosition] = useState({ x: npc.position.x, y: npc.position.y });\n  const prevTileSizeRef = useRef(TILE_SIZE);\n  \n  // Update position when NPC moves or from render positions override\n  useEffect(() => {\n    const overridePos = renderPositions[npc.id];\n    setPosition(overridePos || npc.position);\n  }, [npc.position, npc.id]);\n  \n  // Detect TILE_SIZE changes to disable transitions\n  const tileSizeChanged = prevTileSizeRef.current !== TILE_SIZE;\n  useEffect(() => {\n    prevTileSizeRef.current = TILE_SIZE;\n  }, [TILE_SIZE]);\n  \n  const handleClick = () => {\n    const overlayData = getNPCOverlay(npc.id);\n    if (overlayData && !overlayData.clickable) {\n      return;\n    }\n\n    const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n    if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead) {\n      return;\n    }\n\n    const currentTime = Date.now();\n\n    if (npc.action === 'attack' || npc.action === 'spawn') {\n      const pcState = playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)];\n      const speed = pcState?.speed ?? currentPlayer.baseSpeed ?? 5;\n      if (currentTime < getGlobalAttackCooldown()) return;\n      setGlobalAttackCooldown(currentTime + (speed * 1000));\n    }\n\n    if (npc.action === 'quest' || npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade') {\n      const playerPos = playersInGridManager.getPlayerPosition(currentPlayer?.location?.g, String(currentPlayer._id));\n      const npcPos = { x: Math.round(npc.position?.x || 0), y: Math.round(npc.position?.y || 0) };\n      \n      if (playerPos && typeof playerPos.x === 'number' && typeof playerPos.y === 'number') {\n        const distance = Math.sqrt(Math.pow(playerPos.x - npcPos.x, 2) + Math.pow(playerPos.y - npcPos.y, 2));\n        const playerRange = getDerivedRange(currentPlayer, masterResources);\n        \n        if (distance > playerRange) {\n          FloatingTextManager.addFloatingText(24, npcPos.x, npcPos.y, TILE_SIZE);\n          return;\n        }\n      }\n      \n      onNPCClick(npc);\n    } else {\n      handleNPCClick(\n        npc,\n        Math.round(npc.position?.y || 0),\n        Math.round(npc.position?.x || 0),\n        setInventory,\n        setBackpack,\n        setResources,\n        currentPlayer,\n        setCurrentPlayer,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        currentPlayer?.location?.g,\n        setModalContent,\n        setIsModalOpen,\n        updateStatus,\n        openPanel,\n        setActiveStation,\n        strings,\n        masterTrophies,\n        globalTuning\n      );\n    }\n  };\n  \n  // Get cursor class using shared logic\n  const cursorClass = getNPCCursorClass(npc);\n  \n  // Check if range indicators should be shown\n  const showRangeIndicator = currentPlayer?.settings?.rangeOn !== false && \n                             (npc.action === 'attack' || npc.action === 'spawn') && \n                             npc.attackrange && \n                             npc.attackrange > 0;\n\n  return (\n    <>\n      {/* Attack range indicator - renders behind NPC */}\n      {showRangeIndicator && (\n        <div\n          className=\"attack-range npc-attack-range\"\n          data-npc-id={npc.id}\n          style={{\n            position: 'absolute',\n            left: `${position.x * TILE_SIZE - (npc.attackrange * TILE_SIZE) + TILE_SIZE / 2}px`,\n            top: `${position.y * TILE_SIZE - (npc.attackrange * TILE_SIZE) + TILE_SIZE / 2}px`,\n            width: `${npc.attackrange * 2 * TILE_SIZE}px`,\n            height: `${npc.attackrange * 2 * TILE_SIZE}px`,\n            border: '2px dashed rgba(255, 100, 100, 0.5)',\n            borderRadius: '50%',\n            pointerEvents: 'none',\n            zIndex: 5,\n            transition: tileSizeChanged ? 'none' : 'left 1.2s linear, top 1.2s linear',\n          }}\n        />\n      )}\n      \n      {/* NPC character */}\n      <div\n        className={`npc ${cursorClass} npc-dom`}\n        data-npc-type={npc.type}\n        data-npc-id={npc.id}\n        data-npc-x={position.x}\n        data-npc-y={position.y}\n        style={{\n          position: 'absolute',\n          left: `${position.x * TILE_SIZE}px`,\n          top: `${position.y * TILE_SIZE}px`,\n          width: `${TILE_SIZE}px`,\n          height: `${TILE_SIZE}px`,\n          fontSize: `${TILE_SIZE * 0.7}px`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 15,\n          pointerEvents: 'auto',\n          transition: tileSizeChanged ? 'none' : 'left 1.2s linear, top 1.2s linear',\n        }}\n        onMouseDown={handleClick}\n      >\n        {npc.symbol}\n      </div>\n    </>\n  );\n};\n\nexport default RenderNPCsDOM;","import React from 'react';\nimport { RenderNPCsCanvas } from './RenderNPCsCanvas';\nimport { RenderNPCsDOM } from './RenderNPCsDOM';\n\n/**\n * Main NPC rendering component that decides between Canvas and DOM rendering\n * Only handles the actual NPC entities, not their overlays or tooltips\n */\nexport const RenderNPCs = ({ \n  npcs,\n  TILE_SIZE,\n  currentPlayer,\n  globalTuning,\n  gridId,\n  onNPCClick,\n  \n  // NPC status checking functions (shared logic)\n  checkQuestNPCStatus,\n  checkTradeNPCStatus,\n  checkKentNPCStatus,\n  \n  // Props for NPC interactions\n  strings,\n  masterResources,\n  playersInGrid,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  \n  useCanvasNPCs = false\n}) => {\n  // Simple decision: Canvas or DOM\n  if (useCanvasNPCs) {\n    return (\n      <RenderNPCsCanvas\n        npcs={npcs}\n        TILE_SIZE={TILE_SIZE}\n        currentPlayer={currentPlayer}\n        globalTuning={globalTuning}\n        gridId={gridId}\n        onNPCClick={onNPCClick}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n        strings={strings}\n        masterResources={masterResources}\n        playersInGrid={playersInGrid}\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        setResources={setResources}\n        setCurrentPlayer={setCurrentPlayer}\n        masterSkills={masterSkills}\n        setModalContent={setModalContent}\n        setIsModalOpen={setIsModalOpen}\n        updateStatus={updateStatus}\n        openPanel={openPanel}\n        setActiveStation={setActiveStation}\n        masterTrophies={masterTrophies}\n      />\n    );\n  } else {\n    return (\n      <RenderNPCsDOM\n        npcs={npcs}\n        TILE_SIZE={TILE_SIZE}\n        currentPlayer={currentPlayer}\n        globalTuning={globalTuning}\n        gridId={gridId}\n        onNPCClick={onNPCClick}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n        strings={strings}\n        masterResources={masterResources}\n        playersInGrid={playersInGrid}\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        setResources={setResources}\n        setCurrentPlayer={setCurrentPlayer}\n        masterSkills={masterSkills}\n        setModalContent={setModalContent}\n        setIsModalOpen={setIsModalOpen}\n        updateStatus={updateStatus}\n        openPanel={openPanel}\n        setActiveStation={setActiveStation}\n        masterTrophies={masterTrophies}\n      />\n    );\n  }\n};\n\nexport default RenderNPCs;","import React from 'react';\n\n/**\n * Canvas-based PC (Player Character) renderer\n * TODO: Implement canvas rendering for PCs\n */\nexport const RenderPCsCanvas = ({\n  pcs,\n  TILE_SIZE,\n  currentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings\n}) => {\n  // TODO: Implement canvas rendering for PCs\n  console.warn('RenderPCsCanvas not yet implemented - falling back to DOM');\n  return null;\n};\n\nexport default RenderPCsCanvas;","import React, { useEffect, useState, useRef } from 'react';\nimport { handleAttackOnPC } from '../GameFeatures/Combat/Combat';\nimport ConversationManager from '../GameFeatures/Relationships/ConversationManager';\nimport { getDerivedRange } from '../Utils/worldHelpers';\n\n/**\n * DOM-based PC (Player Character) renderer - renders PCs directly without PCComponent\n * Note: Overlays and tooltips are now handled by RenderDynamicElements\n */\nexport const RenderPCsDOM = ({\n  pcs,\n  TILE_SIZE,\n  currentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings\n}) => {\n  return (\n    <>\n      {pcs.map((pc) => {\n        // Skip PCs without valid position data\n        if (!pc || !pc.position || typeof pc.position.x === 'undefined' || typeof pc.position.y === 'undefined') {\n          console.warn('PC missing position data:', pc);\n          return null;\n        }\n        \n        const isCurrentPlayer = String(pc.playerId) === String(currentPlayer?._id);\n        \n        return (\n          <PCRenderer\n            key={pc.playerId}\n            pc={pc}\n            TILE_SIZE={TILE_SIZE}\n            currentPlayer={currentPlayer}\n            isCurrentPlayer={isCurrentPlayer}\n            onPCClick={onPCClick}\n            setCurrentPlayer={setCurrentPlayer}\n            setInventory={setInventory}\n            setBackpack={setBackpack}\n            masterResources={masterResources}\n            strings={strings}\n          />\n        );\n      })}\n    </>\n  );\n};\n\n// Individual PC renderer component (replaces PCComponent)\nconst PCRenderer = ({ \n  pc, \n  TILE_SIZE,\n  currentPlayer,\n  isCurrentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings\n}) => {\n  const [position, setPosition] = useState({ x: pc.position.x, y: pc.position.y });\n  const prevTileSizeRef = useRef(TILE_SIZE);\n\n  // Update position when PC moves\n  useEffect(() => {\n    setPosition(pc.position);\n  }, [pc.position]);\n  \n  // Detect TILE_SIZE changes to disable transitions\n  const tileSizeChanged = prevTileSizeRef.current !== TILE_SIZE;\n  useEffect(() => {\n    prevTileSizeRef.current = TILE_SIZE;\n  }, [TILE_SIZE]);\n\n  const handleClick = async (e) => {\n    e.stopPropagation();\n\n    // Always call onPCClick to open social panel\n    if (onPCClick) {\n      onPCClick(pc);\n    }\n    \n    // Check if we should also trigger combat\n    const isNotSelf = String(pc.playerId) !== String(currentPlayer._id);\n    const isAttackable = pc.hp > 0 && !pc.iscamping;\n    const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n    const isTown = currentPlayer?.location?.gtype === 'town';\n    \n    if (isNotSelf && isAttackable && !isHomestead && !isTown) {\n      await handleAttackOnPC(\n        pc, // target PC\n        currentPlayer, // attacking player\n        currentPlayer?.location?.g, // gridId\n        TILE_SIZE\n      );\n    }\n  };\n\n  const isCamping = pc.iscamping;\n  const isInBoat = pc.isinboat;\n  \n  // Check if range indicators should be shown (only for current player)\n  const showRangeIndicators = isCurrentPlayer && currentPlayer?.settings?.rangeOn !== false;\n  const derivedRange = showRangeIndicators ? getDerivedRange(currentPlayer, masterResources) : 0;\n  const attackRange = showRangeIndicators ? pc.attackrange : 0;\n  const isInHomestead = currentPlayer?.location?.gtype === \"homestead\";\n\n  // Determine cursor style\n  const getCursorClass = () => {\n    if (isCurrentPlayer) return 'cursor-default';\n    if (isCamping || pc.hp <= 0) return 'cursor-default';\n    if (isInHomestead || currentPlayer?.location?.gtype === 'town') return 'cursor-pointer';\n    return 'cursor-crosshair';\n  };\n\n  return (\n    <>\n      {/* Regular range indicator (gray circle) */}\n      {showRangeIndicators && derivedRange > 1 && (\n        <div\n          className=\"attack-range player-range\"\n          style={{\n            position: 'absolute',\n            left: `${position.x * TILE_SIZE - derivedRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            top: `${position.y * TILE_SIZE - derivedRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            width: `${derivedRange * 2 * TILE_SIZE}px`,\n            height: `${derivedRange * 2 * TILE_SIZE}px`,\n            backgroundColor: 'rgba(128, 128, 128, 0.2)',\n            borderRadius: '50%',\n            pointerEvents: 'none',\n            zIndex: 10,\n            transition: tileSizeChanged ? 'none' : 'left 0.2s ease-out, top 0.2s ease-out',\n          }}\n        />\n      )}\n      \n      {/* Attack range indicator (red dotted ring) */}\n      {showRangeIndicators && attackRange > 0 && !isInHomestead && (\n        <div\n          className=\"attack-range player-attackrange\"\n          style={{\n            position: 'absolute',\n            left: `${position.x * TILE_SIZE - attackRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            top: `${position.y * TILE_SIZE - attackRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            width: `${attackRange * 2 * TILE_SIZE}px`,\n            height: `${attackRange * 2 * TILE_SIZE}px`,\n            border: '2px dashed rgba(255, 100, 100, 0.5)',\n            borderRadius: '50%',\n            pointerEvents: 'none',\n            zIndex: 11,\n            transition: tileSizeChanged ? 'none' : 'left 0.2s ease-out, top 0.2s ease-out',\n          }}\n        />\n      )}\n      \n      {/* PC character */}\n      <div\n        className={`pc ${isCurrentPlayer ? 'current-player' : ''} ${getCursorClass()} pc-dom`}\n        data-pc-id={pc.playerId}\n        data-pc-username={pc.username}\n        data-pc-x={position.x}\n        data-pc-y={position.y}\n        data-pc-hp={pc.hp}\n        data-is-camping={isCamping}\n        data-is-in-boat={isInBoat}\n        style={{\n          position: 'absolute',\n          left: `${position.x * TILE_SIZE}px`,\n          top: `${position.y * TILE_SIZE}px`,\n          width: `${TILE_SIZE}px`,\n          height: `${TILE_SIZE}px`,\n          fontSize: `${TILE_SIZE * 0.7}px`,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 16,\n          transition: tileSizeChanged ? 'none' : 'left 0.2s ease-out, top 0.2s ease-out',\n          pointerEvents: 'auto',\n          color: isCamping ? '#888' : (pc.hp <= 0 ? '#666' : 'inherit'),\n        }}\n        onClick={handleClick}\n      >\n        {pc.avatar || ''}\n      </div>\n    </>\n  );\n};\n\nexport default RenderPCsDOM;","import React from 'react';\nimport { RenderPCsCanvas } from './RenderPCsCanvas';\nimport { RenderPCsDOM } from './RenderPCsDOM';\n\n/**\n * Main PC (Player Character) rendering component that decides between Canvas and DOM rendering\n * Only handles the actual PC entities, not their overlays or tooltips\n */\nexport const RenderPCs = ({ \n  pcs,\n  TILE_SIZE,\n  currentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings,\n  useCanvasPCs = false\n}) => {\n  // Simple decision: Canvas or DOM\n  if (useCanvasPCs) {\n    return (\n      <RenderPCsCanvas\n        pcs={pcs}\n        TILE_SIZE={TILE_SIZE}\n        currentPlayer={currentPlayer}\n        onPCClick={onPCClick}\n        setCurrentPlayer={setCurrentPlayer}\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        masterResources={masterResources}\n        strings={strings}\n      />\n    );\n  } else {\n    return (\n      <RenderPCsDOM\n        pcs={pcs}\n        TILE_SIZE={TILE_SIZE}\n        currentPlayer={currentPlayer}\n        onPCClick={onPCClick}\n        setCurrentPlayer={setCurrentPlayer}\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        masterResources={masterResources}\n        strings={strings}\n      />\n    );\n  }\n};\n\nexport default RenderPCs;","import React, { useRef, useEffect, useState, memo } from 'react';\nimport { getResourceOverlayStatus, OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\nimport SVGAssetManager from './SVGAssetManager';\n\n/**\n * Canvas-based dynamic elements renderer\n * Handles tooltips, overlays, badges, attack ranges, VFX, etc.\n */\nexport const RenderDynamicElementsCanvas = ({\n  resources,\n  npcs,\n  pcs,\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  hoverTooltip,\n  setHoverTooltip,\n  TILE_SIZE,\n  strings,\n  generateResourceTooltip,\n  generateNPCTooltip,\n  generatePCTooltip\n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n\n  // Render overlays to canvas\n  const renderOverlays = async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !resources) return;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // Render resource overlays\n    for (const resource of resources) {\n      if (resource.type === 'shadow' || resource.category === 'doober' || resource.category === 'source') continue;\n      \n      const overlayInfo = getResourceOverlayStatus(\n        resource, \n        craftingStatus, \n        tradingStatus, \n        badgeState, \n        electionPhase,\n        currentPlayer\n      );\n      \n      if (!overlayInfo) continue;\n      \n      const overlayType = overlayInfo.type;\n      if (!overlayType || !OVERLAY_SVG_MAPPING[overlayType]) continue;\n      \n      const x = resource.x * TILE_SIZE;\n      const y = resource.y * TILE_SIZE;\n      const size = TILE_SIZE * (resource.range || 1);\n      \n      // Position overlay in lower-left corner of the resource\n      const overlaySize = Math.max(12, TILE_SIZE * 0.3);\n      const overlayX = x + 2;\n      const overlayY = y + TILE_SIZE - overlaySize - 2;\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        OVERLAY_SVG_MAPPING[overlayType], \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      }\n    }\n  };\n\n  // Re-render when dependencies change\n  useEffect(() => {\n    const currentData = JSON.stringify({ \n      resources: resources?.map(r => ({ \n        x: r.x, \n        y: r.y, \n        type: r.type\n      })), \n      TILE_SIZE,\n      craftingReady: craftingStatus?.ready,\n      craftingInProgress: craftingStatus?.inProgress,\n      tradingReady: tradingStatus?.ready,\n      mailboxBadge: badgeState?.mailbox,\n      electionPhase,\n      playerId: currentPlayer?.id\n    });\n    \n    if (currentData !== lastRenderData.current) {\n      renderOverlays();\n      lastRenderData.current = currentData;\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase, currentPlayer]);\n\n  // Handle mouse events for tooltips\n  const handleCanvasMouseMove = (event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Find resource at this position\n    const resource = resources?.find(r => {\n      if (r.type === 'shadow' || r.category === 'doober' || r.category === 'source') return false;\n      return colIndex >= r.x && colIndex < r.x + (r.range || 1) &&\n             rowIndex >= r.y && rowIndex < r.y + (r.range || 1);\n    });\n    \n    if (resource) {\n      setHoverTooltip({\n        x: event.clientX,\n        y: event.clientY - 10,\n        content: generateResourceTooltip(resource, strings),\n      });\n    } else {\n      setHoverTooltip(null);\n    }\n  };\n\n  const handleCanvasMouseLeave = () => {\n    setHoverTooltip(null);\n  };\n\n  return (\n    <>\n      {/* Overlay Canvas */}\n      <canvas\n        ref={canvasRef}\n        onMouseMove={handleCanvasMouseMove}\n        onMouseLeave={handleCanvasMouseLeave}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          zIndex: 11,\n          pointerEvents: 'auto',\n        }}\n      />\n      \n      {/* Hover Tooltip (still rendered as DOM for now) */}\n      {hoverTooltip && (\n        <HoverTooltip \n          tooltip={hoverTooltip}\n        />\n      )}\n    </>\n  );\n};\n\n// Separate component for the hover tooltip\nconst HoverTooltip = memo(({ tooltip }) => {\n  if (!tooltip) return null;\n  \n  return (\n    <div\n      className=\"HoverTooltip\"\n      style={{\n        position: 'fixed',\n        top: tooltip.y - 10,\n        left: tooltip.x,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n        pointerEvents: 'none',\n      }}\n      dangerouslySetInnerHTML={{ __html: tooltip.content }}\n    />\n  );\n});\n\nexport default RenderDynamicElementsCanvas;","import React, { useRef, useEffect, useState, memo } from 'react';\nimport { getResourceOverlayStatus, OVERLAY_EMOJI_MAPPING } from '../Utils/ResourceOverlayUtils';\n\n/**\n * DOM-based dynamic elements renderer\n * Handles tooltips, overlays, badges, attack ranges, VFX, etc.\n */\nexport const RenderDynamicElementsDOM = ({\n  resources,\n  npcs,\n  pcs,\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  hoverTooltip,\n  setHoverTooltip,\n  TILE_SIZE,\n  strings,\n  generateResourceTooltip,\n  generateNPCTooltip,\n  generatePCTooltip\n}) => {\n  const hoverTimersRef = useRef({});\n  \n  // Clean up all tooltip timers when component unmounts\n  useEffect(() => {\n    return () => {\n      Object.keys(hoverTimersRef.current).forEach(key => {\n        clearInterval(hoverTimersRef.current[key]);\n      });\n      hoverTimersRef.current = {};\n    };\n  }, []);\n\n  // Set up hover listeners for resource elements\n  useEffect(() => {\n    const handleResourceMouseEnter = (event) => {\n      const resourceEl = event.target.closest('.resource-tile');\n      if (!resourceEl) return;\n      \n      const resourceX = parseInt(resourceEl.dataset.resourceX);\n      const resourceY = parseInt(resourceEl.dataset.resourceY);\n      const resource = resources?.find(r => r.x === resourceX && r.y === resourceY);\n      \n      if (!resource || resource.category === 'doober' || resource.category === 'source') return;\n      \n      const rect = resourceEl.getBoundingClientRect();\n      const key = `${resourceX}-${resourceY}`;\n      \n      const updateTooltip = () => {\n        setHoverTooltip({\n          x: rect.left + rect.width / 2,\n          y: rect.top,\n          content: generateResourceTooltip(resource, strings),\n        });\n      };\n      \n      updateTooltip(); // Immediate render\n      hoverTimersRef.current[key] = setInterval(updateTooltip, 1000);\n    };\n    \n    const handleResourceMouseLeave = (event) => {\n      const resourceEl = event.target.closest('.resource-tile');\n      if (!resourceEl) return;\n      \n      const resourceX = parseInt(resourceEl.dataset.resourceX);\n      const resourceY = parseInt(resourceEl.dataset.resourceY);\n      const key = `${resourceX}-${resourceY}`;\n      \n      if (hoverTimersRef.current[key]) {\n        clearInterval(hoverTimersRef.current[key]);\n        delete hoverTimersRef.current[key];\n      }\n      setHoverTooltip(null);\n    };\n    \n    // Add event listeners to the grid container\n    const gridContainer = document.querySelector('.homestead');\n    if (gridContainer) {\n      gridContainer.addEventListener('mouseenter', handleResourceMouseEnter, true);\n      gridContainer.addEventListener('mouseleave', handleResourceMouseLeave, true);\n    }\n    \n    return () => {\n      if (gridContainer) {\n        gridContainer.removeEventListener('mouseenter', handleResourceMouseEnter, true);\n        gridContainer.removeEventListener('mouseleave', handleResourceMouseLeave, true);\n      }\n    };\n  }, [resources, setHoverTooltip, generateResourceTooltip, strings]);\n\n  return (\n    <>\n      {/* Resource Overlays */}\n      {resources?.map((resource) => {\n        if (resource.category === 'doober' || resource.category === 'source') return null;\n        \n        const overlayInfo = getResourceOverlayStatus(\n          resource, \n          craftingStatus, \n          tradingStatus, \n          badgeState, \n          electionPhase,\n          currentPlayer\n        );\n        \n        if (!overlayInfo) return null;\n        \n        const emojiMapping = OVERLAY_EMOJI_MAPPING[overlayInfo.type];\n        if (!emojiMapping) return null;\n        \n        return (\n          <div\n            key={`overlay-${resource.x}-${resource.y}`}\n            className=\"game-overlay\"\n            style={{\n              position: 'absolute',\n              top: resource.y * TILE_SIZE,\n              left: resource.x * TILE_SIZE,\n              width: TILE_SIZE,\n              height: TILE_SIZE,\n              color: emojiMapping.color,\n              zIndex: 11,\n              pointerEvents: 'none',\n              display: 'flex',\n              alignItems: 'flex-end',\n              justifyContent: 'flex-start',\n              padding: '2px',\n            }}\n          >\n            {emojiMapping.emoji}\n          </div>\n        );\n      })}\n      \n      {/* Hover Tooltip */}\n      {hoverTooltip && (\n        <HoverTooltip \n          tooltip={hoverTooltip}\n        />\n      )}\n    </>\n  );\n};\n\n// Separate component for the hover tooltip\nconst HoverTooltip = memo(({ tooltip }) => {\n  const [tooltipContent, setTooltipContent] = useState(null);\n  \n  useEffect(() => {\n    setTooltipContent(tooltip);\n  }, [tooltip]);\n  \n  if (!tooltipContent) return null;\n  \n  return (\n    <div\n      className=\"HoverTooltip\"\n      style={{\n        position: 'fixed',\n        top: tooltipContent.y - 10,\n        left: tooltipContent.x,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n        pointerEvents: 'none',\n      }}\n      dangerouslySetInnerHTML={{ __html: tooltipContent.content }}\n    />\n  );\n});\n\nexport default RenderDynamicElementsDOM;","import axios from 'axios';\nimport API_BASE from '../config';\n\nclass QuestCache {\n  constructor() {\n    this.cache = null;\n    this.cacheTime = null;\n    this.cacheExpiry = 5 * 60 * 1000; // 5 minutes cache\n    this.pendingRequest = null;\n  }\n\n  async getQuests() {\n    // If we have a pending request, wait for it\n    if (this.pendingRequest) {\n      return this.pendingRequest;\n    }\n\n    // If cache is fresh, return it\n    if (this.cache && this.cacheTime && (Date.now() - this.cacheTime < this.cacheExpiry)) {\n      // Removed console.log to reduce spam\n      return Promise.resolve(this.cache);\n    }\n\n    // Make new request and cache it\n    console.log(' Fetching fresh quests from API');\n    this.pendingRequest = axios.get(`${API_BASE}/api/quests`)\n      .then(response => {\n        this.cache = response.data;\n        this.cacheTime = Date.now();\n        this.pendingRequest = null;\n        return this.cache;\n      })\n      .catch(error => {\n        this.pendingRequest = null;\n        throw error;\n      });\n\n    return this.pendingRequest;\n  }\n\n  // Force cache refresh (e.g., after quest completion)\n  invalidate() {\n    console.log(' Invalidating quest cache');\n    this.cache = null;\n    this.cacheTime = null;\n  }\n\n  // Get quests for a specific NPC\n  async getQuestsForNPC(npcType) {\n    const allQuests = await this.getQuests();\n    return allQuests.filter(quest => quest.giver === npcType);\n  }\n}\n\n// Create singleton instance\nconst questCache = new QuestCache();\n\nexport default questCache;","import React, { useCallback } from 'react';\nimport { RenderDynamicElementsCanvas } from './RenderDynamicElementsCanvas';\nimport { RenderDynamicElementsDOM } from './RenderDynamicElementsDOM';\nimport { getLocalizedString } from '../Utils/stringLookup';\nimport questCache from '../Utils/QuestCache';\n\n/**\n * Generate tooltip content for a resource - shared between Canvas and DOM\n */\nexport function generateResourceTooltip(resource, strings) {\n  if (!resource || resource.category === 'doober' || resource.category === 'source') return '';\n\n  const lines = [];\n  const currentTime = Date.now();\n  const localizedResourceType = getLocalizedString(resource.type, strings);\n\n  switch (resource.category) {\n    case 'farmplot':\n      lines.push(`<p>${localizedResourceType}</p>`);\n      if (resource.growEnd) {\n        const remainingTime = Math.max(0, resource.growEnd - currentTime);\n        const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n        const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n        const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n        const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n        if (remainingTime > 0) {\n          const parts = [];\n          if (days > 0) parts.push(`${days}d`);\n          if (hours > 0) parts.push(`${hours}h`);\n          if (minutes > 0) parts.push(`${minutes}m`);\n          if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n          lines.push(`<p> ${parts.join(' ')} remaining</p>`);\n        }\n      }\n      break;\n\n    case 'crafting':\n      lines.push(`<p>${localizedResourceType}</p>`);\n      if (resource.craftEnd) {\n        const remainingTime = Math.max(0, resource.craftEnd - currentTime);\n        const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n        const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n        const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n        const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n        if (remainingTime > 0) {\n          const parts = [];\n          if (days > 0) parts.push(`${days}d`);\n          if (hours > 0) parts.push(`${hours}h`);\n          if (minutes > 0) parts.push(`${minutes}m`);\n          if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n          lines.push(`<p> ${parts.join(' ')} remaining</p>`);\n        }\n      }\n      break;\n\n    default:\n      lines.push(`<p>${localizedResourceType}</p>`);\n      break;\n  }\n\n  return lines.join('');\n}\n\n/**\n * Generate tooltip content for NPCs - shared between Canvas and DOM\n */\nexport function generateNPCTooltip(npc, strings) {\n  // This will be moved from NPCInteractionUtils.js\n  return `<p>${npc.type}</p>`;\n}\n\n/**\n * Generate tooltip content for PCs - shared between Canvas and DOM\n */\nexport function generatePCTooltip(pc, strings) {\n  return `<p>${pc.username || 'Unknown Player'}</p>`;\n}\n\n/**\n * Check quest NPC status - shared logic for overlays\n */\nexport const checkQuestNPCStatus = async (npc, currentPlayer) => {\n  if (!currentPlayer) return null;\n  \n  try {\n    // Use cached quests instead of direct API call\n    const allQuests = await questCache.getQuests();\n    \n    // Use same filtering logic as NPCPanel\n    let npcQuests = allQuests\n      .filter((quest) => quest.giver === npc.type)\n      .filter((quest) => {\n        const activeQuest = currentPlayer.activeQuests?.find(q => q.questId === quest.title);\n        if (activeQuest) {\n          return activeQuest.completed && !activeQuest.rewardCollected;\n        }\n        return (quest.repeatable === true || quest.repeatable === 'true') || !currentPlayer.completedQuests?.some(q => q.questId === quest.title);\n      });\n\n    // Apply FTUE filtering for first-time users\n    if (currentPlayer.firsttimeuser === true) {\n      npcQuests = npcQuests.filter((quest) => {\n        const hasFtuestep = quest.ftuestep != null && \n                           quest.ftuestep !== undefined && \n                           quest.ftuestep !== '' && \n                           quest.ftuestep !== 0;\n        \n        if (!hasFtuestep) {\n          return false;\n        } else if (quest.ftuestep > (currentPlayer.ftuestep || 0)) {\n          return false;\n        } else {\n          return true;\n        }\n      });\n    }\n\n    // Check if any quests have completed rewards to collect\n    const hasCompletedQuests = npcQuests.some(quest => {\n      const activeQuest = currentPlayer.activeQuests?.find(q => q.questId === quest.title);\n      return activeQuest && activeQuest.completed && !activeQuest.rewardCollected;\n    });\n\n    let status = null;\n    if (hasCompletedQuests) {\n      status = 'completed'; // Show checkmark\n    } else if (npcQuests.length > 0) {\n      status = 'available'; // Show question mark/hand\n    }\n    \n    return status;\n  } catch (error) {\n    console.error('Error checking quest NPC status:', error);\n    return null;\n  }\n};\n\n/**\n * Check trade NPC status - shared logic for overlays\n */\nexport const checkTradeNPCStatus = (npc, masterResources) => {\n  if (!npc.symbol || !masterResources) return null;\n  \n  const tradeResource = masterResources.find(r => \n    r.category === 'trader' && r.symbol === npc.symbol\n  );\n  \n  if (!tradeResource) return null;\n  \n  // Trade NPCs show their trade item symbol as the overlay\n  return tradeResource.input;\n};\n\n/**\n * Check Kent NPC status - shared logic for overlays\n */\nexport const checkKentNPCStatus = (npc, currentPlayer) => {\n  if (npc.type !== 'Kent' || !currentPlayer) return null;\n  \n  try {\n    const kentOffers = currentPlayer?.kentOffers?.offers || [];\n    \n    // Check if player can afford any of Kent's offers\n    const canAffordAny = kentOffers.some(offer => {\n      // Calculate player's total quantity from inventory and backpack\n      const inventoryQty = currentPlayer?.inventory?.find(item => item.type === offer.item)?.quantity || 0;\n      const backpackQty = currentPlayer?.backpack?.find(item => item.type === offer.item)?.quantity || 0;\n      const playerQty = inventoryQty + backpackQty;\n      \n      return playerQty >= offer.quantity;\n    });\n    \n    return canAffordAny ? 'completed' : null;\n  } catch (error) {\n    console.error('Error checking Kent status:', error);\n    return null;\n  }\n};\n\n/**\n * Main dynamic elements rendering component that decides between Canvas and DOM rendering\n * Handles tooltips, overlays, badges, attack ranges, VFX, etc.\n */\nexport const RenderDynamicElements = ({ \n  // Grid data\n  resources,\n  npcs,\n  pcs,\n  \n  // Status data for overlays\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  masterResources,\n  \n  // UI state\n  hoverTooltip,\n  setHoverTooltip,\n  \n  // Configuration\n  TILE_SIZE,\n  strings,\n  useCanvasDynamicElements = false\n}) => {\n  // Simple decision: Canvas or DOM\n  if (useCanvasDynamicElements) {\n    return (\n      <RenderDynamicElementsCanvas\n        resources={resources}\n        npcs={npcs}\n        pcs={pcs}\n        craftingStatus={craftingStatus}\n        tradingStatus={tradingStatus}\n        badgeState={badgeState}\n        electionPhase={electionPhase}\n        currentPlayer={currentPlayer}\n        masterResources={masterResources}\n        hoverTooltip={hoverTooltip}\n        setHoverTooltip={setHoverTooltip}\n        TILE_SIZE={TILE_SIZE}\n        strings={strings}\n        generateResourceTooltip={generateResourceTooltip}\n        generateNPCTooltip={generateNPCTooltip}\n        generatePCTooltip={generatePCTooltip}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n      />\n    );\n  } else {\n    return (\n      <RenderDynamicElementsDOM\n        resources={resources}\n        npcs={npcs}\n        pcs={pcs}\n        craftingStatus={craftingStatus}\n        tradingStatus={tradingStatus}\n        badgeState={badgeState}\n        electionPhase={electionPhase}\n        currentPlayer={currentPlayer}\n        masterResources={masterResources}\n        hoverTooltip={hoverTooltip}\n        setHoverTooltip={setHoverTooltip}\n        TILE_SIZE={TILE_SIZE}\n        strings={strings}\n        generateResourceTooltip={generateResourceTooltip}\n        generateNPCTooltip={generateNPCTooltip}\n        generatePCTooltip={generatePCTooltip}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n      />\n    );\n  }\n};\n\nexport default RenderDynamicElements;","const lockedResources = new Map(); // Key: \"x-y\", Value: timestamp\n\nexport function lockResource(x, y) {\n  lockedResources.set(`${x}-${y}`, Date.now());\n}\n\nexport function unlockResource(x, y) {\n    lockedResources.delete(`${x}-${y}`);\n}\n\nexport function isResourceLocked(x, y) {\n  const lockTime = lockedResources.get(`${x}-${y}`);\n  const now = Date.now();\n\n  // Ignore lock if it has expired (e.g., 3 seconds timeout)\n  return lockTime && now - lockTime < 1000;\n}\n","/**\n * Warehouse materials and ingredient drop utilities\n */\n\n// Import isACrop from ResourceHelpers since it's a general utility\nimport { isACrop } from './ResourceHelpers';\n\n/**\n * Determine which third of players a player belongs to based on their ID\n * Used for asymmetric rarity distribution\n * @param {string} playerId - The player's unique ID\n * @returns {number} 0, 1, or 2 (splits players into thirds)\n */\nexport function getPlayerRarityGroup(playerId) {\n  // Simple hash: sum all character codes\n  let hash = 0;\n  for (let i = 0; i < playerId.length; i++) {\n    hash += playerId.charCodeAt(i);\n  }\n  // Return 0, 1, or 2 (splits players into thirds)\n  return hash % 3;\n}\n\n/**\n * Map warehouse ingredient rarity based on player's deterministic group\n * Each third of players gets a different rarity distribution\n * @param {string} itemType - The warehouse ingredient type (Saw, Shovel, Screwdriver)\n * @param {string} playerId - The player's unique ID\n * @returns {string} 'common', 'uncommon', or 'rare'\n */\nexport function getPersonalizedWarehouseRarity(itemType, playerId) {\n  const rarityGroup = getPlayerRarityGroup(playerId);\n  \n  // Define rotation pattern for the three warehouse ingredients\n  // Each row represents what a player group experiences\n  const rarityRotation = {\n    'Saw': ['common', 'uncommon', 'rare'],        // Group 0: common, Group 1: uncommon, Group 2: rare\n    'Shovel': ['uncommon', 'rare', 'common'],      // Group 0: uncommon, Group 1: rare, Group 2: common\n    'Screwdriver': ['rare', 'common', 'uncommon']  // Group 0: rare, Group 1: common, Group 2: uncommon\n  };\n  \n  // Return the rarity for this item based on player's group\n  return rarityRotation[itemType]?.[rarityGroup] || 'common';\n}\n\n\n/**\n * Checks for and processes warehouse ingredient drops when collecting crops\n * Uses globalTuning.harvestDropRate to determine if a drop occurs (e.g., 0.1 = 10% chance)\n * Then uses resource.scrollchance to determine which warehouse ingredient to drop\n * @param {string} collectedItemType - The type of item that was collected\n * @param {number} col - Column position for floating text\n * @param {number} row - Row position for floating text\n * @param {number} TILE_SIZE - Tile size for positioning\n * @param {Object} params - Object containing required parameters\n * @param {Object} params.currentPlayer - Current player object\n * @param {Array} params.inventory - Current inventory\n * @param {Array} params.backpack - Current backpack\n * @param {Function} params.setInventory - Inventory setter\n * @param {Function} params.setBackpack - Backpack setter\n * @param {Function} params.setCurrentPlayer - Player setter\n * @param {Function} params.updateStatus - Status update function\n * @param {Array} params.masterResources - Master resources array with warehouse ingredients (requires: \"Warehouse\")\n * @param {Object} params.globalTuning - Global tuning configuration with harvestDropRate\n * @param {Object} params.strings - Localized strings\n * @param {Function} params.FloatingTextManager - Floating text manager\n * @param {Function} params.gainIngredients - Gain ingredients function\n * @param {Function} params.trackQuestProgress - Quest progress tracking function\n * @param {Function} params.getLocalizedString - String localization function\n * @param {Function} params.selectWeightedRandomItem - Weighted random selection function\n * @param {Function} params.getDropQuantity - Drop quantity calculation function\n * @returns {Promise<{dropped: boolean, item?: string, quantity?: number}>} Result of the drop attempt\n */\nexport async function checkAndDropWarehouseIngredient(\n  collectedItemType,\n  col,\n  row,\n  TILE_SIZE,\n  {\n    currentPlayer,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    globalTuning,\n    strings,\n    FloatingTextManager,\n    gainIngredients,\n    trackQuestProgress,\n    getLocalizedString,\n    selectWeightedRandomItem,\n  }\n) {\n  // Check if this is a crop (excluding Wheat to prevent exploit)\n  if (!isACrop(collectedItemType, masterResources) || collectedItemType === 'Wheat') {\n    return { dropped: false };\n  }\n  \n  console.log(`<> Collected crop: ${collectedItemType}, checking for warehouse ingredient drops...`);\n  \n  // Check if we should drop based on harvestDropRate from globalTuning\n  const dropRate = globalTuning?.harvestDropRate || 0.1; // Default to 10% if not configured\n  const roll = Math.random();\n  \n  if (roll > dropRate) {\n    console.log(`< Drop roll failed: ${roll.toFixed(3)} > ${dropRate} (${(dropRate * 100).toFixed(0)}% chance)`);\n    return { dropped: false };\n  }\n  \n  console.log(`< Drop roll succeeded: ${roll.toFixed(3)} <= ${dropRate} (${(dropRate * 100).toFixed(0)}% chance)`);\n  \n  // Get all warehouse ingredients from masterResources\n  const warehouseIngredients = masterResources.filter(res => res.requires === 'Warehouse' && res.scrollchance);\n  \n  if (warehouseIngredients.length === 0) {\n    console.warn('\u000f No warehouse ingredients found in masterResources');\n    return { dropped: false };\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedIngredients = warehouseIngredients.map(ingredient => ({\n    ...ingredient,\n    scrollchance: getPersonalizedWarehouseRarity(ingredient.type, currentPlayer.playerId)\n  }));\n  \n  // Use weighted random selection based on personalized rarity\n  const selectedIngredient = selectWeightedRandomItem(personalizedIngredients, 1);\n  \n  if (!selectedIngredient) {\n    return { dropped: false };\n  }\n  \n  // Warehouse ingredients always drop exactly 1, regardless of rarity\n  const dropQty = 1;\n  \n  console.log(`< Warehouse ingredient drop: ${selectedIngredient.type} x${dropQty} (${selectedIngredient.scrollchance})`);\n  \n  // Show bonus floating text with offset to avoid overlap with main doober text\n  const symbol = selectedIngredient.symbol || '';\n  FloatingTextManager.addFloatingText(\n    `${symbol} +${dropQty} ${getLocalizedString(selectedIngredient.type, strings)}`, \n    col, \n    row - (30 / TILE_SIZE), // Offset up (converted to tile units)\n    TILE_SIZE\n  );\n  \n  // Add the warehouse ingredient to inventory\n  const bonusGained = await gainIngredients({\n    playerId: currentPlayer.playerId,\n    currentPlayer,\n    resource: selectedIngredient.type,\n    quantity: dropQty,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    globalTuning,\n  });\n  \n  if (!bonusGained) {\n    console.warn('L Failed to add bonus warehouse ingredient to inventory - may be full');\n    // Don't show error to user - this is a bonus drop\n    return { dropped: true, item: selectedIngredient.type, quantity: dropQty, added: false };\n  }\n  \n  // Track quest progress for the bonus item\n  await trackQuestProgress(currentPlayer, 'Collect', selectedIngredient.type, dropQty, setCurrentPlayer);\n  \n  return { dropped: true, item: selectedIngredient.type, quantity: dropQty, added: true };\n}\n\n/**\n * Calculate warehouse ingredient drops for bulk harvest operations\n * Calculates drops per farm plot harvested, ignoring skill multipliers\n * @param {number} numPlotsHarvested - Number of farm plots that were harvested\n * @param {Object} params - Object containing required parameters\n * @param {Array} params.masterResources - Master resources array with warehouse ingredients\n * @param {Object} params.globalTuning - Global tuning configuration with harvestDropRate\n * @param {Function} params.selectWeightedRandomItem - Weighted random selection function\n * @param {string} params.playerId - Player ID for personalized rarity calculation\n * @returns {Array} Array of warehouse ingredient drops: [{type, quantity, symbol}]\n */\nexport function calculateBulkWarehouseDrops(numPlotsHarvested, {\n  masterResources,\n  globalTuning,\n  selectWeightedRandomItem,\n  playerId\n}) {\n  const warehouseDrops = [];\n  \n  // Get all warehouse ingredients from masterResources\n  const warehouseIngredients = masterResources.filter(res => res.requires === 'Warehouse' && res.scrollchance);\n  \n  if (warehouseIngredients.length === 0) {\n    console.warn('\u000f No warehouse ingredients found in masterResources');\n    return warehouseDrops;\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedIngredients = warehouseIngredients.map(ingredient => ({\n    ...ingredient,\n    scrollchance: getPersonalizedWarehouseRarity(ingredient.type, playerId)\n  })); \n  \n  // Get drop rate from globalTuning\n  const dropRate = globalTuning?.harvestDropRate || 0.1; // Default to 10%\n  \n  console.log(`< Bulk warehouse calculation: globalTuning.harvestDropRate = ${globalTuning?.harvestDropRate}, resolved dropRate = ${dropRate}`);\n  \n  // Roll for drops once per farm plot harvested (ignoring skill multipliers)\n  for (let i = 0; i < numPlotsHarvested; i++) {\n    const roll = Math.random();\n    \n    if (roll <= dropRate) {\n      // Select a warehouse ingredient using weighted random with personalized rarity\n      const selectedIngredient = selectWeightedRandomItem(personalizedIngredients, 1);\n      \n      if (selectedIngredient) {\n        // Always drop quantity 1 for warehouse ingredients\n        warehouseDrops.push({\n          type: selectedIngredient.type,\n          quantity: 1,\n          symbol: selectedIngredient.symbol || '',\n          rarity: selectedIngredient.scrollchance || 'common'\n        });\n      }\n    }\n  }\n  \n  console.log(`< Bulk warehouse drops calculated: ${warehouseDrops.length} total drops from ${numPlotsHarvested} plots`);\n  return warehouseDrops;\n}\n\n/**\n * Aggregate warehouse drops by type for display\n * @param {Array} warehouseDrops - Array of individual drops\n * @returns {Object} Aggregated drops: {type: {quantity, symbol, rarity}}\n */\nexport function aggregateWarehouseDrops(warehouseDrops) {\n  const aggregated = {};\n  \n  warehouseDrops.forEach(drop => {\n    if (!aggregated[drop.type]) {\n      aggregated[drop.type] = {\n        quantity: 0,\n        symbol: drop.symbol,\n        rarity: drop.rarity\n      };\n    }\n    aggregated[drop.type].quantity += drop.quantity;\n  });\n  \n  return aggregated;\n}\n\n/**\n * Get personalized pet rewards by applying asymmetric rarity to warehouse ingredients\n * For pets, we still use pet level as a multiplier, but warehouse ingredients get personalized rarity\n * @param {Array} petRewards - Array of resources with source === 'pets'\n * @param {string} playerId - Player ID for personalized rarity\n * @returns {Array} Array of pet rewards with personalized rarity for warehouse ingredients\n */\nexport function getPersonalizedPetRewards(petRewards, playerId) {\n  return petRewards.map(reward => {\n    // Only apply personalized rarity to warehouse ingredients\n    if (reward.requires === 'Warehouse') {\n      return {\n        ...reward,\n        scrollchance: getPersonalizedWarehouseRarity(reward.type, playerId)\n      };\n    }\n    // Non-warehouse items keep their original rarity\n    return reward;\n  });\n}","/**\n * DropRates.js\n * Shared utility for managing drop rates and rarity chances across the game.\n * Used by both ScrollReveal and PetPanel systems.\n */\n\n/**\n * Standard rarity table for the game\n * These values represent the relative weight/chance of each rarity tier.\n * Higher numbers = more common.\n */\nconst STANDARD_RARITY_TABLE = {\n  'common': 100,     // 1 in 1 (baseline)\n  'uncommon': 50,    // 1 in 2 \n  'rare': 20,        // 1 in 5\n  'epic': 5,         // 1 in 20\n  'legendary': 1     // 1 in 100\n};\n\n/**\n * Convert rarity string to numeric chance value for weighted selection\n * @param {string} rarity - Rarity tier: 'common', 'uncommon', 'rare', 'epic', 'legendary'\n * @param {number} level - Optional level multiplier (default: 1). Higher levels increase drop rates.\n *                        Level 1 = standard rates, Level 2 = 2x drop rates, etc.\n * @returns {number} Chance weight (higher = more common)\n */\nexport function getRarityChance(rarity, level = 1) {\n  // Handle backward compatibility with old numeric values\n  if (typeof rarity === 'number') {\n    return rarity * level;\n  }\n  \n  // Get base rarity from table\n  const baseRarity = STANDARD_RARITY_TABLE[rarity] || STANDARD_RARITY_TABLE['common'];\n  \n  // Apply level multiplier to effectively reduce the rarity gap\n  // The goal is to make rare items more common at higher levels\n  // by multiplying their weight more than common items.\n  // \n  // We use a formula that compresses the rarity distribution:\n  // newWeight = baseRarity * level^scaleFactor\n  // where scaleFactor is higher for rarer items\n  // \n  // For the desired behavior where legendary goes from 1/100 to 1/20 at level 5:\n  // We need legendary weight to go from 1 to 5 (5x increase)\n  // While common weight should increase less dramatically\n  \n  // Calculate scale factor based on rarity (rarer items get bigger boost)\n  // Common (100) gets smallest boost, Legendary (1) gets biggest boost\n  const rarityScale = 1 + (100 - baseRarity) / 100; // Common=1, Legendary=1.99\n  \n  // Apply the level scaling with the rarity-specific multiplier\n  // This makes rare items increase faster than common items\n  return baseRarity * Math.pow(level, rarityScale - 1);\n}\n\n/**\n * Example calculations for getRarityChance at different levels:\n * \n * Level 1 (base rates):\n * - Common: 100 * 1^0 = 100 (1 in 1.76)\n * - Uncommon: 50 * 1^0.5 = 50 (1 in 3.52)\n * - Rare: 20 * 1^0.8 = 20 (1 in 8.8)\n * - Epic: 5 * 1^0.95 = 5 (1 in 35.2)\n * - Legendary: 1 * 1^0.99 = 1 (1 in 176)\n * \n * Level 5 (compressed distribution):\n * - Common: 100 * 5^0 = 100 (1 in 3.89)\n * - Uncommon: 50 * 5^0.5 = 111.8 (1 in 3.48)\n * - Rare: 20 * 5^0.8 = 65.9 (1 in 5.91)\n * - Epic: 5 * 5^0.95 = 22.8 (1 in 17.07)\n * - Legendary: 1 * 5^0.99 = 4.9 (1 in 79.4)\n * \n * This achieves the goal where legendary becomes approximately 5x more common at level 5\n * while common items stay at the same absolute weight.\n */\n\n/**\n * Select a random rarity tier based on weighted probabilities\n * @param {number} level - Optional level multiplier for drop rates (default: 1)\n * @returns {string} Selected rarity tier\n */\nexport function selectRandomRarity(level = 1) {\n  // Calculate total weight with level multiplier\n  const totalWeight = Object.entries(STANDARD_RARITY_TABLE).reduce(\n    (sum, [rarity, baseChance]) => sum + getRarityChance(rarity, level), \n    0\n  );\n  \n  // Generate random value\n  const roll = Math.random() * totalWeight;\n  let cumulative = 0;\n  \n  // Find which rarity tier the roll falls into\n  for (const [rarity, baseChance] of Object.entries(STANDARD_RARITY_TABLE)) {\n    cumulative += getRarityChance(rarity, level);\n    if (roll <= cumulative) {\n      return rarity;\n    }\n  }\n  \n  // Fallback (shouldn't reach here)\n  return 'common';\n}\n\n/**\n * Select a random item from a weighted array based on rarity\n * @param {Array} items - Array of items with scrollchance property\n * @param {number} level - Optional level multiplier for drop rates (default: 1)\n * @returns {Object|null} Selected item or null if no items\n */\nexport function selectWeightedRandomItem(items, level = 1) {\n  if (!items || items.length === 0) {\n    return null;\n  }\n  \n  // Calculate total weight based on rarity chances\n  const totalWeight = items.reduce(\n    (sum, item) => sum + getRarityChance(item.scrollchance, level), \n    0\n  );\n  \n  // Generate weighted random selection\n  const roll = Math.random() * totalWeight;\n  let cumulative = 0;\n  \n  // Find the selected item based on weighted probability\n  for (const item of items) {\n    cumulative += getRarityChance(item.scrollchance, level);\n    if (roll <= cumulative) {\n      return item;\n    }\n  }\n  \n  // Fallback to first item\n  return items[0];\n}\n\n/**\n * Get drop quantity for a given rarity\n * Common items tend to drop in larger quantities\n * @param {string} rarity - The rarity tier\n * @returns {number} Quantity to drop\n */\nexport function getDropQuantity(rarity) {\n  const quantityRanges = {\n    'common': { min: 2, max: 3 },\n    'uncommon': { min: 2, max: 3 },\n    'rare': { min: 2, max: 3 },\n    'epic': { min: 1, max: 1 },\n    'legendary': { min: 1, max: 1 }\n  };\n  \n  const range = quantityRanges[rarity] || quantityRanges['common'];\n  return Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;\n}\n\n/**\n * Export the standard rarity table for reference\n */\nexport const RARITY_TABLE = STANDARD_RARITY_TABLE;","import API_BASE from './config.js'; \nimport axios from 'axios';\nimport { fetchInventoryAndBackpack, refreshPlayerAfterInventoryUpdate } from './Utils/InventoryManagement';\nimport { gainIngredients, spendIngredients, calculateSkillMultiplier, hasRoomFor } from './Utils/InventoryManagement';\nimport { updateGridResource } from './Utils/GridManagement';\nimport { loadMasterResources, loadMasterSkills } from './Utils/TuningManager'; // Centralized tuning manager\nimport FloatingTextManager from './UI/FloatingText';\nimport { lockResource, unlockResource } from './Utils/ResourceLockManager';\nimport { handleTransitSignpost } from './GameFeatures/Transit/Transit';\nimport { trackQuestProgress } from './GameFeatures/Quests/QuestGoalTracker';\nimport { createCollectEffect, createSourceConversionEffect, calculateTileCenter } from './VFX/VFX';\nimport { earnTrophy } from './GameFeatures/Trophies/TrophyUtils';\nimport { useStrings } from './UI/StringsContext';\nimport { getLocalizedString } from './Utils/stringLookup';\nimport { formatSingleCollection } from './UI/StatusBar/CollectionFormatters';\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport { checkAndDropWarehouseIngredient } from './Utils/WarehouseMaterials';\nimport { selectWeightedRandomItem, getDropQuantity } from './Economy/DropRates';\n \n // Handles resource click actions based on category. //\n export async function handleResourceClick(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  addFloatingText,\n  gridId,\n  TILE_SIZE,\n  tileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  updateStatus,\n  masterResources,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  closeAllPanels,\n  strings,\n  bulkOperationContext,\n  openPanel,\n  masterTrophies = null,\n  globalTuning = null\n) {\n  console.log(`Resource Clicked:  (${row}, ${col}):`, { resource, tileType: tileTypes[row]?.[col] });\n  if (!resource || !resource.category) { console.error(`Invalid resource at (${col}, ${row}):`, resource); return; }\n  \n  lockResource(col, row); // Optimistically lock the resource\n\n  try {\n    // Load master resources and skills (cached internally)\n    if (!masterResources || masterResources.length === 0) { \n      masterResources = await loadMasterResources();  // Direct assignment without `const`\n    }\n    if (!masterSkills || masterSkills.length === 0) { \n      masterSkills = await loadMasterSkills(); \n    }\n    const skills = currentPlayer.skills;\n    // Fetch inventory and backpack if either is empty\n    if ((!Array.isArray(inventory)) || (!Array.isArray(backpack))) {\n      console.warn('Inventory or backpack is not initialized; fetching from server.');\n      const { inventory: fetchedInventory, backpack: fetchedBackpack } = await fetchInventoryAndBackpack(currentPlayer.playerId);\n      setInventory(fetchedInventory); // Update state with fetched inventory\n      setBackpack(fetchedBackpack); // Update state with fetched backpack\n    }\n\n    switch (resource.category) {\n\n      case 'doober':\n      case 'special':\n        await handleDooberClick(\n          resource,\n          row,\n          col,\n          resources,\n          setResources,\n          setInventory,\n          setBackpack,\n          currentPlayer?.inventory || [],\n          currentPlayer?.backpack || [],\n          skills,\n          gridId,\n          addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          masterSkills, // Pass tuning data\n          strings,\n          openPanel,\n          globalTuning,\n          masterTrophies\n        );\n        break;\n\n      case 'source':\n        await handleSourceConversion(\n          resource,\n          row,\n          col,\n          resources,\n          setResources,\n          inventory,\n          setInventory,\n          backpack,\n          setBackpack,  \n          gridId,\n          addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          masterResources,\n          masterSkills, \n          setModalContent,\n          setIsModalOpen,\n          updateStatus,\n          strings\n        );\n        break;\n\n      case 'seed':\n        console.log('Seed clicked; do nothing');\n        break;\n\n      case 'deco':\n        console.log('Deco clicked; placeholder for future functionality');\n        break;\n\n      case 'travel':\n        console.log('Travel sign clicked');\n        console.log('bulkOperationContext:', bulkOperationContext);\n        console.log('isAnyBulkOperationActive:', bulkOperationContext?.isAnyBulkOperationActive?.());\n        \n        // Check if any bulk operation is active\n        if (bulkOperationContext?.isAnyBulkOperationActive?.()) {\n          const activeOps = bulkOperationContext.getActiveBulkOperations();\n          console.log(' Travel blocked: Bulk operation in progress', activeOps);\n          updateStatus(470);\n          return;\n        }\n        \n        try {\n          await handleTransitSignpost(\n            currentPlayer,\n            resource.type,\n            setCurrentPlayer,\n            setGridId, \n            setGrid,\n            setTileTypes, \n            setResources,\n            updateStatus,\n            TILE_SIZE,\n            skills,\n            closeAllPanels,\n            bulkOperationContext,\n            null, // masterResources not available\n            null, // strings not available in ResourceClicking\n            null  // masterTrophies not available in ResourceClicking\n          );\n        } catch (error) {\n          console.error(\"Error handling travel signpost:\", error.message || error);\n        }\n        break;\n        \n      default:\n        console.warn(`Unhandled resource category: ${resource.category}`);\n    }\n  } catch (error) {\n    console.error('Error handling resource click:', error);\n    unlockResource(col, row); // Unlock the resource on error\n  } finally {\n    unlockResource(col, row);\n  }\n}\n\n\n// HANDLE DOOBER CLICKS //\n//\nexport async function handleDooberClick(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory = [],\n  backpack = [],\n  skills = [],\n  gridId,\n  addFloatingText,\n  TILE_SIZE,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  masterSkills,\n  strings = {},\n  openPanel = null,\n  globalTuning = null,\n  masterTrophies = null\n) {\n  console.log('handleDooberClick: Current Player:', currentPlayer);\n  console.log('handleDooberClick: Current backpack:', backpack);\n  const gtype = currentPlayer.location.gtype;\n  const baseQtyCollected = resource.qtycollected || 1;\n\n  if (!Array.isArray(inventory) || !Array.isArray(backpack)) {\n    console.warn(\"Inventory or backpack missing; aborting doober click.\");\n    return;\n  }\n\n  // Create a unique ID for this doober to prevent double-processing\n  const dooberId = `${resource.type}-${col}-${row}`;\n  \n  // Check if we're already processing this doober (prevent double-clicks)\n  if (window._processingDoobers && window._processingDoobers.has(dooberId)) {\n    console.log(\"Already processing this doober, ignoring duplicate click\");\n    return;\n  }\n  \n  // Mark this doober as being processed\n  if (!window._processingDoobers) {\n    window._processingDoobers = new Set();\n  }\n  window._processingDoobers.add(dooberId);\n\n  console.log('MasterSkills:', masterSkills);\n  // Extract player skills and upgrades from inventory\n  const playerBuffs = skills\n    .filter((item) => {\n      const resourceDetails = masterResources.find((res) => res.type === item.type);\n      const isSkill = resourceDetails?.category === 'skill' || resourceDetails?.category === 'upgrade';\n      const appliesToResource = (masterSkills?.[item.type]?.[resource.type] || 1) > 1;\n      return isSkill && appliesToResource;\n    })\n    .map((buffItem) => buffItem.type);\n\n  //console.log('Player Buffs (Skills and Upgrades):', playerBuffs);\n  // Calculate skill multiplier\n  const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n    const buffValue = masterSkills?.[buff]?.[resource.type] || 1;\n    //console.log(`Buff \"${buff}\" applies to \"${resource.type}\" with multiplier x${buffValue}`);\n    return multiplier * buffValue;\n  }, 1);\n  const qtyCollected = baseQtyCollected * skillMultiplier;\n  console.log('[DEBUG] qtyCollected after multiplier:', qtyCollected);\n  \n  // Check for missing backpack FIRST before any optimistic updates\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const isCurrencyItem = resource.type === 'Money' || \n                        resource.type === 'Gem' || \n                        resource.type === 'Yellow Heart' ||\n                        resource.type === 'Green Heart' ||\n                        resource.type === 'Purple Heart';\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n  \n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      // Missing backpack - show status message and floating text\n      updateStatus(19); // Missing backpack message\n      FloatingTextManager.addFloatingText(strings[\"44\"] || \"No backpack\", col, row, TILE_SIZE);\n      // Clear processing flag\n      if (window._processingDoobers) {\n        window._processingDoobers.delete(dooberId);\n      }\n      return;\n    }\n  }\n  \n  // Pre-check capacity before optimistic update\n  const hasRoom = hasRoomFor({\n    resource: resource.type,\n    quantity: qtyCollected,\n    currentPlayer,\n    inventory,\n    backpack,\n    masterResources,\n    globalTuning\n  });\n  \n  if (!hasRoom) {\n    // At this point we know they have a backpack if needed, so this is a real capacity issue\n    console.warn(\"Pre-check: No room for resource. Showing error immediately.\");\n    FloatingTextManager.addFloatingText(strings[\"41\"] || \"Not enough room\", col, row, TILE_SIZE);\n    if (openPanel) {\n      openPanel('InventoryPanel');\n    }\n    // Clear processing flag\n    if (window._processingDoobers) {\n      window._processingDoobers.delete(dooberId);\n    }\n    return;\n  }\n  \n  // Optimistically remove the resource from display AND show effects\n  setResources((prevResources) =>\n    prevResources.filter((res) => !(res.x === col && res.y === row))\n  );\n  \n  // Show VFX and floating text immediately for responsiveness\n  createCollectEffect(col, row, TILE_SIZE);\n  FloatingTextManager.addFloatingText(`+${qtyCollected} ${getLocalizedString(resource.type, strings)}`, col, row, TILE_SIZE);\n\n  // Perform server validation\n  try {\n    // Use gainIngredients to handle inventory/backpack update, sync, and capacity check\n    console.log(\"Calling gainIngredients with: \",resource.type);\n    \n    const gainResult = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: resource.type,\n      quantity: qtyCollected,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n    // Handle the result based on error type\n    if (gainResult === true) {\n      // Success - continue with normal flow\n    } else if (gainResult && gainResult.success === false) {\n      // Check if we should rollback based on error type\n      if (gainResult.isCapacityError) {\n        // Real conflict - rollback the doober\n        console.warn(\" Capacity limit reached. Rolling back doober.\");\n        setResources((prevResources) => [...prevResources, resource]);\n        \n        // Check if the error is specifically about missing backpack\n        if (gainResult.isMissingBackpack) {\n          // Don't show floating text - status message (19) already set by gainIngredients\n          // Don't open inventory panel for missing backpack\n        } else {\n          // Show floating text for actual capacity error\n          FloatingTextManager.addFloatingText(strings[\"41\"] || \"Not enough room\", col, row, TILE_SIZE);\n          // Auto-open inventory panel when truly at capacity\n          console.log(\"Opening inventory panel. openPanel function:\", openPanel);\n          if (openPanel) {\n            openPanel('InventoryPanel');\n          } else {\n            console.warn(\"openPanel function not available!\");\n          }\n        }\n        // Clear processing flag\n        if (window._processingDoobers) {\n          window._processingDoobers.delete(dooberId);\n        }\n        return;\n      } else if (gainResult.isNetworkError) {\n        // Network/server error - don't rollback, the server might have queued it\n        console.warn(\" Network error during collection, but server may have queued the operation. Not rolling back.\");\n        // Still show success effects since server likely processed it\n      } else {\n        // Other client-side errors - rollback\n        console.warn(\" Client error during collection. Rolling back.\");\n        setResources((prevResources) => [...prevResources, resource]);\n        // Clear processing flag\n        if (window._processingDoobers) {\n          window._processingDoobers.delete(dooberId);\n        }\n        return;\n      }\n    }\n    \n    // Calculate skill info for formatting\n    const skillInfo = calculateSkillMultiplier(resource.type, skills || [], masterSkills);\n    \n    // Format and show status message using shared formatter\n    const statusMessage = formatSingleCollection('harvest', resource.type, qtyCollected, \n      skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n    updateStatus(statusMessage);\n\n    const gridUpdateResponse = await updateGridResource(\n      gridId,\n      { type: null, x: col, y: row }, // Collecting doober removes it\n      true\n    );\n    if (!gridUpdateResponse?.success) {\n      console.warn(' Grid update failed even though inventory succeeded.');\n      return;\n    }\n\n    // Track quest progress for \"Collect\" actions\n    // trackQuestProgress expects: (player, action, item, quantity, setCurrentPlayer)\n    await trackQuestProgress(currentPlayer, 'Collect', resource.type, qtyCollected, setCurrentPlayer);\n\n    // Check for warehouse ingredient drops when collecting crops\n    await checkAndDropWarehouseIngredient(\n      resource.type,\n      col,\n      row,\n      TILE_SIZE,\n      {\n        currentPlayer,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n        strings,\n        FloatingTextManager,\n        gainIngredients,\n        trackQuestProgress,\n        getLocalizedString,\n        selectWeightedRandomItem,\n      }\n    );\n\n    // Award trophies for specific collected items\n    if (masterTrophies && currentPlayer?.playerId) {\n      try {\n        if (resource.type === \"King's Crown\") {\n          console.log(` Awarding King's Crown trophy for collecting ${qtyCollected} crown(s)`);\n          \n          // Award the Count-type trophy for each crown collected\n          for (let i = 0; i < qtyCollected; i++) {\n            await earnTrophy(currentPlayer.playerId, \"King's Crown\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${qtyCollected} King's Crown trophy instance(s)`);\n        } else if (resource.type === \"Trident\") {\n          console.log(` Awarding Trident trophy for collecting ${qtyCollected} trident(s)`);\n          \n          // Award the Count-type trophy for each trident collected\n          for (let i = 0; i < qtyCollected; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Trident\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${qtyCollected} Trident trophy instance(s)`);\n        }\n      } catch (error) {\n        console.error(' Error awarding collection trophy:', error);\n        // Don't fail the collection if trophy awarding fails\n      }\n    }\n\n    // Update currentPlayer state locally\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    console.log('[DEBUG] Player state refreshed after inventory update.');\n  } catch (error) {\n    console.error('Error during doober collection:', error);\n    // Rollback local resource state on server failure\n    setResources((prevResources) => [...prevResources, resource]);\n  } finally {\n    unlockResource(col, row); // Always unlock the resource\n    // Clear the processing flag for this doober\n    if (window._processingDoobers) {\n      window._processingDoobers.delete(dooberId);\n    }\n  }\n}\n\n\n// Helper: Handles use of required key/item for a resource\n// Returns a Promise<boolean>: true if item used, false otherwise\nlet pendingKeyResolve = null; // Module-level temporary resolve callback\n\nexport async function handleUseKey(resource,requirement,col,row,TILE_SIZE,currentPlayer,setCurrentPlayer,inventory,setInventory,backpack,setBackpack,addFloatingText,strings,setModalContent,setIsModalOpen,updateStatus) {\n  console.log('handleUseKey: resource:', resource);\n  if (!requirement) return true;\n  if (pendingKeyResolve) {return false;}   // Only allow one modal pending at a time\n  const hasRequirement = currentPlayer.inventory.find((item) => item.type === requirement);\n  if (!hasRequirement) { updateStatus(`${strings[\"35\"]}${requirement}`); return false; }\n\n  return new Promise((resolve) => {\n    pendingKeyResolve = resolve;\n\n    const handleYes = async () => {\n      const spent = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          ingredient1: requirement,\n          ingredient1qty: 1,\n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spent) {\n        console.warn(' Failed to spend key item.');\n        return;\n      }\n\n      updateStatus(`${strings[\"36\"]}${requirement}`);\n\n      setIsModalOpen(false);\n      if (pendingKeyResolve) {\n        pendingKeyResolve(true);\n        pendingKeyResolve = null;\n      }\n    };\n    const handleNo = () => {\n      setIsModalOpen(false);\n      if (pendingKeyResolve) {\n        pendingKeyResolve(false);\n        pendingKeyResolve = null;\n      }\n    };\n\n    const totalOwned =\n      (currentPlayer.inventory.find(item => item.type === requirement)?.quantity || 0) +\n      (currentPlayer.backpack?.find(item => item.type === requirement)?.quantity || 0);\n      \n    setModalContent({\n      title: `${strings[\"5045\"]} ${requirement}?`,\n      message: `${strings[\"5046\"]} ${requirement}?`,\n      message2: `${strings[\"5047\"]} ${totalOwned}.`,\n      size: 'small',\n      onClose: handleNo,  //  Close button acts like \"No\"\n      children: (\n        <div style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n          <button onClick={handleYes}>Yes</button>\n          <button onClick={handleNo}>No</button>\n        </div>\n      ),\n    });\n    setIsModalOpen(true);\n  });\n}\n \n// HANDLE SOURCE CONVERSIONS //\n//\nexport async function handleSourceConversion(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  gridId,\n  addFloatingText,\n  TILE_SIZE,\n  currentPlayer,\n  setCurrentPlayer,\n  masterResources,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  strings\n) {\n  if (resource.action !== 'convertTo') return;\n\n  // Get target resource first\n  const targetResource = masterResources.find((res) => res.type === resource.output);\n  if (!targetResource) { console.warn(` No matching resource found for output: ${resource.output}`); return; }\n\n  // Get required skill\n  const requirement = resource.requires;\n  const isSkillOrUpgrade = masterResources.some(\n    res => res.type === requirement && (res.category === \"skill\" || res.category === \"upgrade\")\n  );\n  const isKey = masterResources.some(\n    res => res.type === requirement && (res.category === \"doober\")\n  );\n\n  // Required Skill Missing\n  if (isSkillOrUpgrade) {\n    const hasSkill = currentPlayer.skills?.some(skill => skill.type === requirement);\n    if (!hasSkill) {\n      addFloatingText(`${requirement} Required`, col, row, TILE_SIZE);\n      return;\n    }\n  }\n  //  Handle Key Requirement\n  if (isKey) {\n    const usedKey = await handleUseKey(resource,requirement,col,row,TILE_SIZE,currentPlayer,setCurrentPlayer,inventory,setInventory,backpack,setBackpack,addFloatingText,strings,setModalContent,setIsModalOpen,updateStatus,);\n    if (!usedKey) return;\n  }\n  // Check if the object should disappear (output is null/empty) or transform\n  const shouldDisappear = !resource.output || resource.output === 'null' || !targetResource;\n  \n  if (shouldDisappear) {\n    // Find the original resource to check for shadows - use global state like ProtectedSelling does\n    const originalResource = GlobalGridStateTilesAndResources.getResources().find(\n      r => r.x === col && r.y === row\n    );\n    \n    // Update local state to reflect removal of resource and shadows\n    const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n      (res) => {\n        // Remove the main resource\n        if (res.x === col && res.y === row) return false;\n        \n        // Remove any shadows belonging to this resource if it was multi-tile\n        if (originalResource && originalResource.range && originalResource.range > 1 && res.type === 'shadow') {\n          const anchorKey = originalResource.anchorKey || `${originalResource.type}-${originalResource.x}-${originalResource.y}`;\n          if (res.parentAnchorKey === anchorKey) {\n            return false;\n          }\n        }\n        return true;\n      }\n    );\n    \n    // Update both global and local state with the same filtered array - exactly like ProtectedSelling does\n    GlobalGridStateTilesAndResources.setResources(filteredResources);\n    setResources(filteredResources);\n\n    // Perform server update to remove the main resource\n    try {\n      const gridUpdateResponse = await updateGridResource(\n        gridId, \n        { type: null, x: col, y: row }, \n        true\n      );\n      if (gridUpdateResponse?.success) {\n        // VFX\n        createSourceConversionEffect(col, row, TILE_SIZE, requirement);\n        console.log(' Resource removal completed successfully on the server.');\n      } else {\n        throw new Error('Server failed to confirm the resource removal.');\n      }\n    } catch (error) {\n      console.error(' Error during resource removal:', error);\n      console.warn('Server update failed. The client may become out of sync.');\n    }\n  } else {\n    // Build the new resource object to replace the one we just clicked\n    const x = col;\n    const y = row;\n    const enrichedNewResource = {\n      ...targetResource,\n      x,\n      y,\n      symbol: targetResource.symbol,\n      qtycollected: targetResource.qtycollected || 1,\n      category: targetResource.category || 'doober',\n      growEnd: targetResource.growEnd || null,\n    };\n    console.log('Enriched newResource for local state: ', enrichedNewResource);\n\n    // Find the original resource to check for shadows - use global state like ProtectedSelling does\n    const originalResource = GlobalGridStateTilesAndResources.getResources().find(\n      r => r.x === col && r.y === row\n    );\n    \n    // Filter out the main resource AND any shadows, then add the new resource\n    const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n      (res) => {\n        // Remove the main resource\n        if (res.x === col && res.y === row) return false;\n        \n        // Remove any shadows belonging to this resource if it was multi-tile\n        if (originalResource && originalResource.range && originalResource.range > 1 && res.type === 'shadow') {\n          const anchorKey = originalResource.anchorKey || `${originalResource.type}-${originalResource.x}-${originalResource.y}`;\n          if (res.parentAnchorKey === anchorKey) {\n            return false;\n          }\n        }\n        return true;\n      }\n    );\n    \n    // Add the new resource to the filtered list\n    const finalResources = [...filteredResources, enrichedNewResource];\n    \n    // Update both global and local state with the same filtered array - exactly like ProtectedSelling does\n    GlobalGridStateTilesAndResources.setResources(finalResources);\n    setResources(finalResources);\n\n    // Perform server update\n    try {\n      const gridUpdateResponse = await updateGridResource(\n        gridId, \n        { type: targetResource.type, x: col, y: row }, \n        true\n      );\n      if (gridUpdateResponse?.success) {\n        // VFX\n        createSourceConversionEffect(col, row, TILE_SIZE, requirement);\n        console.log(' Source conversion completed successfully on the server.');\n      } else {\n        throw new Error('Server failed to confirm the source conversion.');\n      }\n    } catch (error) {\n      console.error(' Error during source conversion:', error);\n      console.warn('Server update failed. The client may become out of sync.');\n    }\n  }\n  \n  // Shared cleanup regardless of disappear/transform\n  try {\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    unlockResource(col, row);\n  } catch (error) {\n    console.error(' Error during cleanup:', error);\n  }\n}","import React, { createContext, useContext, useState } from 'react';\n\nconst UILockContext = createContext();\n\nexport const UILockProvider = ({ children }) => {\n  const [uiLocked, setUILocked] = useState(false);\n  return (\n    <UILockContext.Provider value={{ uiLocked, setUILocked }}>\n      {children}\n    </UILockContext.Provider>\n  );\n};\n\nexport const useUILock = () => useContext(UILockContext);","import React, { createContext, useContext, useState } from 'react';\n\nconst GridStatePCContext = createContext();\nconst GridStatePCUpdateContext = createContext();\n\nexport const usePlayersInGrid = () => useContext(GridStatePCContext);\nexport const useGridStatePCUpdate = () => useContext(GridStatePCUpdateContext);\n\nexport function GridStatePCProvider({ children }) {\n  const [playersInGrid, setPlayersInGrid] = useState({});\n\n  return (\n    <GridStatePCContext.Provider value={playersInGrid}>\n      <GridStatePCUpdateContext.Provider value={setPlayersInGrid}>\n        {children}\n      </GridStatePCUpdateContext.Provider>\n    </GridStatePCContext.Provider>\n  );\n}\n","import React, { createContext, useContext, useState } from 'react';\n\nconst GridStateContext = createContext();\nconst GridStateUpdateContext = createContext();\n\nexport const useGridState = () => useContext(GridStateContext);\nexport const useGridStateUpdate = () => useContext(GridStateUpdateContext);\n\nlet externalSetGridState = null;\nexport const setGridStateExternally = (state) => {\n  if (externalSetGridState) {\n    externalSetGridState(state);\n  }\n};\n\nexport function GridStateProvider({ children }) {\n  const [NPCsInGrid, setGridState] = useState({}); // instead of null  externalSetGridState = setGridState;\n\n  return (\n    <GridStateContext.Provider value={NPCsInGrid}>\n      <GridStateUpdateContext.Provider value={setGridState}>\n        {children}\n      </GridStateUpdateContext.Provider>\n    </GridStateContext.Provider>\n  );\n}","import socket from '../socketManager';\nimport NPCsInGridManager from './GridStateNPCs';\n\nclass NPCController {\n  constructor() {\n    this.controlledGrids = new Map();\n    this.setupSocketListeners();\n    this.retryTimeout = null;\n  }\n\n  setupSocketListeners() {\n    socket.on('npc-controller-assigned', ({ gridId }) => {\n      console.log(` Assigned as NPC controller for grid ${gridId}`);\n      this.setAsController(gridId);\n    });\n\n    socket.on('npc-controller-revoked', ({ gridId }) => {\n      console.log(` Revoked as NPC controller for grid ${gridId}`);\n      this.removeController(gridId);\n    });\n\n    // Add new listener for controller updates\n    socket.on('npc-controller-update', ({ controllerUsername, gridId }) => {\n      console.log(` Controller update received for ${gridId}: ${controllerUsername}`);\n      const currentPlayer = JSON.parse(localStorage.getItem('player'));\n      if (controllerUsername && currentPlayer?.username === controllerUsername) {\n        this.setAsController(gridId);\n      } else {\n        this.removeController(gridId);\n      }\n    });\n \n    // Add connection status listeners\n    socket.on('connect', () => {\n      console.log(' NPCController socket connected');\n    });\n\n    socket.on('disconnect', () => {\n      console.log(' NPCController socket disconnected');\n    });\n\n    // Add response listener\n    socket.on('join-grid-controller-response', ({ success, gridId }) => {\n      console.log(` Received controller join response: success=${success}, gridId=${gridId}`);\n    });\n  }\n\n  joinGrid(gridId) {\n    if (!socket.connected) {\n      console.log(' Socket not ready, retrying controller join in 1s...');\n      clearTimeout(this.retryTimeout);\n      this.retryTimeout = setTimeout(() => this.joinGrid(gridId), 1000);\n      return;\n    }\n\n    console.log(` Requesting controller status for grid ${gridId}`);\n    socket.emit('join-grid-controller', { \n      gridId,\n      timestamp: Date.now() // Add timestamp for debugging\n    });\n  }\n\n  leaveGrid(gridId) {\n    console.log(` Leaving grid ${gridId}`);\n    socket.emit('leave-grid-controller', { gridId });\n    this.removeController(gridId);\n  }\n\n  setAsController(gridId) {\n    console.log(` Setting controller status for grid ${gridId}`);\n    // Add explicit true value and verify it's set\n    this.controlledGrids.set(gridId, { isController: true });\n    console.log(` Controller Map after set:`, \n      Array.from(this.controlledGrids.entries())\n    );\n\n    // Force an immediate NPC update\n    const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (NPCsInGrid?.npcs) {\n      Object.values(NPCsInGrid.npcs).forEach(npc => {\n        if (typeof npc.update === 'function') {\n          npc.update(Date.now(), NPCsInGrid);\n        }\n      });\n    }\n  }\n\n  removeController(gridId) {\n    this.controlledGrids.delete(gridId);\n    console.log(` Removed controller for grid ${gridId}`);\n    console.log(` Controller Map after remove:`, \n      Array.from(this.controlledGrids.entries())\n    );\n  }\n\n  isControllingGrid(gridId) {\n    const controllerData = this.controlledGrids.get(gridId);\n    const isController = controllerData?.isController === true;\n    // console.log(` Controller check for ${gridId}:`, {\n    //   hasData: !!controllerData,\n    //   isController: isController,\n    //   rawValue: controllerData?.isController\n    // });\n    return isController;\n  }\n}\n\nexport const npcController = new NPCController();\nexport default npcController;\n","import React, { createContext, useState, useContext } from 'react';\nimport { useStrings } from '../StringsContext';\nimport './StatusBar.css';\n\n// Create Context\nexport const StatusBarContext = createContext();\n\n// Provider Component\nexport const StatusBarProvider = ({ children }) => {\n  const strings = useStrings(); // Get strings from context\n  const [messages, setMessages] = useState([]); // Array of message objects with id and text\n  const messageIdRef = React.useRef(0); // Counter for unique message IDs\n\n  /**\n   * Updates the status bar message.\n   * @param {number|string} input - Index for predefined message or custom string.\n   */\n  const updateStatus = (input) => {\n    let newMessage = '';\n    \n    if (typeof input === 'number') {\n      // Use predefined string from strings.json\n      const predefinedMessage = strings[input];\n      if (predefinedMessage) {\n        newMessage = predefinedMessage;\n      } else {\n        console.warn(`No string found for index ${input}. Falling back to default.`);\n        return;\n      }\n    } else if (typeof input === 'string') {\n      // Use custom string directly\n      newMessage = input;\n    } else {\n      console.warn('Invalid status message input. Falling back to default.');\n      return;\n    }\n\n    // Create a new message object with unique ID\n    const messageObject = {\n      id: messageIdRef.current++,\n      text: newMessage\n    };\n\n    // Add new message to the beginning (no max limit for infinite scrolling)\n    setMessages(prev => [messageObject, ...prev]);\n  };\n\n  return (\n    <StatusBarContext.Provider value={{ messages, updateStatus }}>\n      {children}\n    </StatusBarContext.Provider>\n  );\n};\n\n// StatusBar Component\nconst StatusBar = () => {\n  const { messages } = React.useContext(StatusBarContext);\n  const [displayMessages, setDisplayMessages] = React.useState([]);\n  const [slideOffset, setSlideOffset] = React.useState(0);\n  const [scrollPosition, setScrollPosition] = React.useState(0);\n  const [canScrollRight, setCanScrollRight] = React.useState(false);\n  const prevFirstId = React.useRef(null);\n  const newMessageRef = React.useRef(null);\n  const messagesContainerRef = React.useRef(null);\n  const viewportRef = React.useRef(null);\n\n  React.useEffect(() => {\n    if (messages.length === 0) {\n      setDisplayMessages([]);\n      setSlideOffset(0);\n      setScrollPosition(0);\n      return;\n    }\n\n    const currentFirstId = messages[0]?.id;\n    \n    // First render or new message\n    if (prevFirstId.current === null) {\n      // Initial load - also animate the first message\n      setScrollPosition(0); // Reset scroll position\n      if (newMessageRef.current) {\n        const width = newMessageRef.current.offsetWidth || 200; // fallback width\n        setSlideOffset(-width);\n        setDisplayMessages(messages);\n        \n        requestAnimationFrame(() => {\n          setSlideOffset(0);\n        });\n      } else {\n        // Fallback if ref not ready\n        setSlideOffset(-200);\n        setDisplayMessages(messages);\n        \n        requestAnimationFrame(() => {\n          setSlideOffset(0);\n        });\n      }\n    } else if (currentFirstId !== prevFirstId.current) {\n      // New message added - reset scroll position first\n      setScrollPosition(0); // Reset to left before showing new message\n      \n      // Then measure and animate the new message\n      if (newMessageRef.current) {\n        const width = newMessageRef.current.offsetWidth;\n        // Start with new message off-screen\n        setSlideOffset(-width);\n        setDisplayMessages(messages);\n        \n        // Trigger slide animation\n        requestAnimationFrame(() => {\n          setSlideOffset(0);\n        });\n      }\n    } else {\n      // No change\n      setDisplayMessages(messages);\n    }\n    \n    prevFirstId.current = currentFirstId;\n  }, [messages]);\n\n  // Check if we can scroll right\n  React.useEffect(() => {\n    if (messagesContainerRef.current && viewportRef.current) {\n      const containerWidth = messagesContainerRef.current.scrollWidth;\n      const viewportWidth = viewportRef.current.offsetWidth;\n      const maxScroll = containerWidth - viewportWidth;\n      \n      // Can scroll right if we haven't reached the max scroll position\n      setCanScrollRight(scrollPosition < maxScroll && containerWidth > viewportWidth);\n    }\n  }, [scrollPosition, displayMessages]);\n\n  // Handle scrolling\n  const handleScrollRight = () => {\n    if (messagesContainerRef.current && viewportRef.current) {\n      const containerWidth = messagesContainerRef.current.scrollWidth;\n      const viewportWidth = viewportRef.current.offsetWidth;\n      const maxScroll = containerWidth - viewportWidth;\n      \n      // Scroll right by viewport width or to the end\n      const newPosition = Math.min(scrollPosition + viewportWidth, maxScroll);\n      setScrollPosition(newPosition);\n    }\n  };\n\n  const handleScrollLeft = () => {\n    // Scroll left by viewport width or to the beginning\n    const viewportWidth = viewportRef.current?.offsetWidth || window.innerWidth;\n    const newPosition = Math.max(scrollPosition - viewportWidth, 0);\n    setScrollPosition(newPosition);\n  };\n\n  return (\n    <div className=\"status-bar\">\n      {/* Left scroll arrow - only show when scrolled */}\n      {scrollPosition > 0 && (\n        <button\n          className=\"status-bar-arrow status-bar-arrow-left\"\n          onClick={handleScrollLeft}\n          aria-label=\"Scroll left\"\n        >\n          \n        </button>\n      )}\n      \n      <div className=\"status-bar-viewport\" ref={viewportRef}>\n        {/* Hidden measuring container */}\n        {messages.length > 0 && messages[0].id !== prevFirstId.current && (\n          <div style={{ position: 'absolute', visibility: 'hidden', whiteSpace: 'nowrap' }}>\n            <span ref={newMessageRef} className=\"status-message\">\n              {messages[0].text}\n            </span>\n            <span className=\"status-separator\">&nbsp;&nbsp;&nbsp;&nbsp;</span>\n          </div>\n        )}\n        \n        {/* Actual messages container */}\n        <div \n          ref={messagesContainerRef}\n          className=\"status-bar-messages\"\n          style={{\n            transform: `translateX(${slideOffset - scrollPosition}px)`,\n            transition: slideOffset === 0 && scrollPosition === 0 ? 'transform 0.5s ease-out' : \n                       scrollPosition !== 0 ? 'transform 0.3s ease-out' : 'none'\n          }}\n        >\n          {displayMessages.map((msg, index) => (\n            <React.Fragment key={msg.id}>\n              <span className=\"status-message\">\n                {msg.text}\n              </span>\n              {index < displayMessages.length - 1 && (\n                <span className=\"status-separator\">&nbsp;&nbsp;&nbsp;&nbsp;</span>\n              )}\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n      \n      {/* Right scroll arrow - only show when can scroll right */}\n      {canScrollRight && (\n        <button\n          className=\"status-bar-arrow status-bar-arrow-right\"\n          onClick={handleScrollRight}\n          aria-label=\"Scroll right\"\n        >\n          \n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default StatusBar;","import React, { createContext, useContext, useState } from 'react';\n\nconst BulkOperationContext = createContext();\n\nexport const BulkOperationProvider = ({ children }) => {\n  // Track active bulk operations by type\n  const [activeBulkOperations, setActiveBulkOperations] = useState({});\n  \n  const startBulkOperation = (operationType, operationId) => {\n    setActiveBulkOperations(prev => ({\n      ...prev,\n      [operationId]: {\n        type: operationType,\n        startTime: Date.now(),\n        active: true\n      }\n    }));\n  };\n  \n  const endBulkOperation = (operationId) => {\n    setActiveBulkOperations(prev => {\n      const newState = { ...prev };\n      delete newState[operationId];\n      return newState;\n    });\n  };\n  \n  const isAnyBulkOperationActive = () => {\n    return Object.keys(activeBulkOperations).length > 0;\n  };\n  \n  const getActiveBulkOperations = () => {\n    return Object.entries(activeBulkOperations).map(([id, operation]) => ({\n      id,\n      ...operation\n    }));\n  };\n  \n  return (\n    <BulkOperationContext.Provider value={{ \n      activeBulkOperations,\n      startBulkOperation,\n      endBulkOperation,\n      isAnyBulkOperationActive,\n      getActiveBulkOperations\n    }}>\n      {children}\n    </BulkOperationContext.Provider>\n  );\n};\n\nexport const useBulkOperation = () => {\n  const context = useContext(BulkOperationContext);\n  if (!context) {\n    throw new Error('useBulkOperation must be used within a BulkOperationProvider');\n  }\n  return context;\n};","import React from 'react';\nimport './ZoomedOut.css';\n\n// Helper function for grid tile colors\nexport const getGridBackgroundColor = (type) => {\n  switch (type) {\n    // Settlement grid types\n    case \"homestead\":\n    case \"homesteadSet\":\n      case \"homesteadSetN\":\n        case \"homesteadSetNE\":\n          case \"homesteadSetE\":\n            case \"homesteadSetSE\":\n              case \"homesteadSetS\":\n                case \"homesteadSetSW\":\n                  case \"homesteadSetW\":\n                    case \"homesteadSetNW\":\n      return 'var(--homestead-color)';\n    \n    // Valley types (both views)\n    case \"valley0\":\n    case \"valley1\":\n    case \"valley2\":\n    case \"valley3\":\n    case \"valley0Set\":  \n    case \"valley1Set\":\n    case \"valley2Set\":\n    case \"valley3Set\":\n      return 'var(--valley-color)';\n    \n    // Settlement-specific types\n    case \"reserved\":\n      return 'var(--reserved-color)';\n    case \"town\":\n      return 'var(--town-color)';\n    \n    default:\n      return 'var(--unknown-color)';\n  }\n};\n\nconst ZoomOut = ({ children }) => {\n  return (\n    <div className=\"zoom-out-container\">\n      {children}\n    </div>\n  );\n};\n\nexport default ZoomOut;\n","import API_BASE from \"../config\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport \"./SettlementView.css\";\nimport { StatusBarContext } from \"../UI/StatusBar/StatusBar\";\nimport { changePlayerLocation } from \"../Utils/GridManagement\";\nimport { fetchTownSignpostPosition, fetchHomesteadSignpostPosition } from \"../Utils/worldHelpers\";\nimport settlementTileData from './SettlementTile.json';\nimport { useBulkOperation } from \"../UI/BulkOperationContext\";\nimport { getGridBackgroundColor } from './ZoomedOut';\nimport { centerCameraOnPlayer } from \"../PlayerMovement\";\nimport playersInGridManager from \"../GridState/PlayersInGrid\";\nimport { fetchHomesteadOwner } from \"../Utils/worldHelpers\";\nimport { updateGridStatus } from \"../Utils/GridManagement\";\nimport { processRelocation } from \"../Utils/Relocation\";\n\n// Center camera on player's current grid in settlement view\nexport function centerCameraOnPlayerGrid(currentPlayer, settlementGrid) {\n  if (!currentPlayer?.location?.g || !settlementGrid || settlementGrid.length === 0) {\n    console.warn(\"Cannot center camera: missing player location or settlement grid\");\n    return;\n  }\n\n  const playerGridId = currentPlayer.location.g;\n  \n  // Find the player's grid position in the settlement\n  let playerRow = -1;\n  let playerCol = -1;\n  \n  for (let row = 0; row < settlementGrid.length; row++) {\n    for (let col = 0; col < settlementGrid[row].length; col++) {\n      if (settlementGrid[row][col]?.gridId === playerGridId) {\n        playerRow = row;\n        playerCol = col;\n        break;\n      }\n    }\n    if (playerRow !== -1) break;\n  }\n  \n  if (playerRow === -1 || playerCol === -1) {\n    console.warn(`Player's grid ${playerGridId} not found in settlement`);\n    return;\n  }\n\n  // Wait for next frame to ensure layout is complete\n  requestAnimationFrame(() => {\n    // Find the specific tile element instead of calculating position\n    const allTiles = document.querySelectorAll(\".settlement-tile\");\n    const tileIndex = playerRow * 8 + playerCol; // 8 columns per row\n    const playerTile = allTiles[tileIndex];\n    \n    if (!playerTile) {\n      console.warn(\"Player tile element not found\");\n      return;\n    }\n\n    // Scroll the tile into view with centering\n    playerTile.scrollIntoView({\n      behavior: \"smooth\",\n      block: \"center\",\n      inline: \"center\"\n    });\n    \n    // Fallback: If scrollIntoView doesn't work well, try manual scroll after a delay\n    setTimeout(() => {\n      const updatedRect = playerTile.getBoundingClientRect();\n      const isVisible = (\n        updatedRect.top >= 0 &&\n        updatedRect.left >= 0 &&\n        updatedRect.bottom <= window.innerHeight &&\n        updatedRect.right <= window.innerWidth\n      );\n      \n      if (!isVisible) {\n        // Calculate center manually using body scroll\n        const tileCenterX = updatedRect.left + (updatedRect.width / 2);\n        const tileCenterY = updatedRect.top + (updatedRect.height / 2);\n        const windowCenterX = window.innerWidth / 2;\n        const windowCenterY = window.innerHeight / 2;\n        \n        const scrollX = window.scrollX + (tileCenterX - windowCenterX);\n        const scrollY = window.scrollY + (tileCenterY - windowCenterY);\n        \n        window.scrollTo({\n          left: Math.max(0, scrollX),\n          top: Math.max(0, scrollY),\n          behavior: \"smooth\"\n        });\n      }\n    }, 500);\n  });\n}\n\nconst SettlementView = ({ \n  currentPlayer, \n  isDeveloper,\n  setZoomLevel, \n  isRelocating,\n  setIsRelocating,\n  setCurrentPlayer,            \n  setGridId,        \n  setGrid,      \n  setResources, \n  setTileTypes,  \n  TILE_SIZE,\n  masterResources,\n  closeAllPanels,\n  visibleSettlementId,\n  setVisibleSettlementId,\n}) => {\n\n  const [settlementGrid, setSettlementGrid] = useState([]);\n  const [players, setPlayers] = useState(new Map());  // Map player IDs to player data\n  const [error, setError] = useState(null);\n  const [NPCsInGrids, setGridStates] = useState({});  // Add new state for grid states\n  const [playersInGridMap, setPlayersInGrid] = useState({});\n  const { updateStatus } = useContext(StatusBarContext);\n  const bulkOperationContext = useBulkOperation();\n\n  // Added diagnostic log for player-to-ownerId matching\n  if (players) {\n    const ownerIdsInGrid = settlementGrid.flat().map(tile => tile.ownerId).filter(Boolean);\n    const unmatchedOwnerIds = ownerIdsInGrid.filter(id => !players.get(id));\n  }\n\n  // Fetch both settlement grid and player data\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        console.log(\" Fetching settlement bundle for ID:\", visibleSettlementId);\n        const response = await axios.post(`${API_BASE}/api/get-settlement-bundle`, { settlementId: visibleSettlementId });\n        console.log(\" Settlement bundle response:\", response.data);\n        const { gridStates, players: playersArray, settlement } = response.data;\n\n        // Transform playersArray (array) to playersById (object)\n        const playersById = {};\n        if (Array.isArray(playersArray)) {\n          for (const player of playersArray) {\n            playersById[player._id] = player;\n          }\n        }\n\n        setGridStates(gridStates || {});\n        setPlayers(new Map(Object.entries(playersById || {})));\n        setSettlementGrid(settlement?.grids || []);\n        console.log(\" Settlement grid set:\", settlement?.grids);\n\n        //  Fetch playersInGrid for all grids in this settlement\n        const gridIds = (settlement?.grids || []).flat().map(tile => tile.gridId).filter(Boolean);\n        const gridStateResponse = await axios.post(`${API_BASE}/api/get-multiple-grid-states`, { gridIds });\n        const mergedPlayersInGrid = {};\n\n        for (const gridId in gridStateResponse.data) {\n          const pcs = gridStateResponse.data[gridId]?.playersInGrid?.pcs || {};\n          mergedPlayersInGrid[gridId] = pcs;\n        }\n\n        setPlayersInGrid(mergedPlayersInGrid);\n\n      } catch (err) {\n        console.error(\"Error fetching settlement bundle:\", err);\n        setError(\"Failed to fetch settlement data\");\n      }\n    };\n\n    fetchData();\n  }, [visibleSettlementId]);\n\n  useEffect(() => {\n    if (isRelocating) {\n      updateStatus(125);\n    }\n  }, [isRelocating]);\n\n  // Center camera on player's grid when settlement view loads\n  useEffect(() => {\n    if (settlementGrid.length > 0 && currentPlayer?.location?.g) {\n      // Delay to ensure DOM is ready and rendered\n      setTimeout(() => {\n        centerCameraOnPlayerGrid(currentPlayer, settlementGrid);\n      }, 300);\n    }\n  }, [settlementGrid, currentPlayer?.location?.g]);\n\n\n  const handleTileClick = async (tile, TILE_SIZE) => {\n    console.log(\"Clicked tile:\", tile);\n\n    if (tile.settlementId && tile.settlementId !== visibleSettlementId) {\n      console.log(\"Switching visible settlement to:\", tile.settlementId);\n      setVisibleSettlementId(tile.settlementId);\n      return;\n    }\n  \n    // Are we in RELOCATIONN mode?\n    if (isRelocating) {\n      if (tile.gridType !== 'homestead') {\n        updateStatus(123); return;\n      }\n      if (tile.available != true) {\n        updateStatus(124); return; \n      }\n      if (tile.available === true) {\n        // CONFIRMATION MOADAL\n        processRelocation(currentPlayer, setCurrentPlayer, currentPlayer.gridId, tile.gridCoord, settlementGrid);\n        setIsRelocating(false);\n        setZoomLevel('close');\n        updateStatus(121);\n      }\n      return;\n    }\n\n    // Clicking on the tile where the player already is\n    if (tile.gridId === currentPlayer.location.g) {\n      setZoomLevel(\"far\");\n      if ([\"valley0\", \"valley1\", \"valley2\", \"valley3\"].includes(tile.gridType)) {\n        updateStatus(16);\n      } else if (tile.gridType === \"town\") {\n        updateStatus(111);\n      } else {\n        const { username, gridType } = await fetchHomesteadOwner(currentPlayer.location.g);\n        await updateGridStatus(gridType, username, updateStatus, currentPlayer, currentPlayer.location.g);\n      }\n      let pcs = null;\n      let pc = null;\n      pcs = playersInGridManager.getPlayersInGrid(tile.gridId);\n      pc = pcs?.[currentPlayer.playerId];\n      centerCameraOnPlayer(pc.position, TILE_SIZE);\n      return;\n    }\n    \n    // Check if player has Horse skill before allowing teleportation to another grid\n    if (tile.gridId && tile.gridId !== currentPlayer.location.g) {\n      const hasHorse = currentPlayer.skills?.some((skill) => skill.type === \"Horse\" && skill.quantity > 0);\n      if (!hasHorse) {\n        console.log(\" Player lacks Horse skill for teleportation\");\n        updateStatus(15); // \"You need Horse skill to travel\"\n        return;\n      }\n    }\n  \n    // Clicking on any other valley tile\n    if ([\"valley0\", \"valley1\", \"valley2\", \"valley3\"].includes(tile.gridType) && !isDeveloper) {\n      updateStatus(9);\n      return;\n    }\n\n    try {\n      // Default position\n      let arrivalX = 0;\n      let arrivalY = 0;\n      \n      // If clicking on a town tile, find the Train location\n      if (tile.gridType === \"town\") {\n        console.log(\" Clicking on town grid, fetching Train location...\");\n        const signpostPosition = await fetchTownSignpostPosition(tile.gridId);\n        arrivalX = signpostPosition.x;\n        arrivalY = signpostPosition.y;\n      }\n      // If clicking on a homestead tile, find the Signpost Town location\n      else if (tile.gridType === \"homestead\") {\n        console.log(\" Clicking on homestead grid, fetching Signpost Town location...\");\n        const signpostPosition = await fetchHomesteadSignpostPosition(tile.gridId);\n        arrivalX = signpostPosition.x;\n        arrivalY = signpostPosition.y;\n      }\n      \n      const toLocation = {\n        x: arrivalX,  \n        y: arrivalY,\n        g: tile.gridId,\n        s: currentPlayer.location.s,\n        f: currentPlayer.location.f,\n        gtype: tile.gridType || \"unknown\", \n        gridCoord: tile.gridCoord || 0,\n      };\n  \n      console.log(\"Built toLocation object:\", toLocation);\n      console.log(\"About to call changePlayerLocation from SettlementView;  current player = \",currentPlayer, \"toLocatoin = \", toLocation);\n     \n      // Call changePlayerLocation using the properly built toLocation\n      await changePlayerLocation(\n        currentPlayer,\n        currentPlayer.location,\n        toLocation,  \n        setCurrentPlayer,\n        setGridId,                //  Ensure this is passed\n        setGrid,                  //  Pass setGrid function\n        setTileTypes,             //  Pass setTileTypes function\n        setResources,             //  Pass setResources function\n        TILE_SIZE,\n        closeAllPanels,\n        updateStatus,\n        bulkOperationContext,\n        masterResources,\n        null, // strings not available in SettlementView\n        null  // masterTrophies not available in SettlementView\n      );\n      // Zoom into grid view after movement\n      setZoomLevel(\"far\"); \n\n    } catch (error) {\n      console.error(\"Error changing player location:\", error);\n      updateStatus(10); // General error\n    }\n  };\n\nconst getTooltip = (tile) => {\n    if (!tile.gridId) return '';\n    const pcs = playersInGridMap[tile.gridId];\n    if (!pcs || Object.keys(pcs).length === 0) return '';\n    return Object.values(pcs)\n      .map(pc => `${pc.username || 'Unknown'}: ${pc.hp || 0} HP`)\n      .join('\\n');\n  };\n\n  const renderMiniGrid = (tile) => {\n    let gridType = tile.gridType;\n    if (gridType === \"homestead\") {\n      gridType = tile.available ? \"homesteadEmpty\" : \"homesteadOccupied\";\n    }\n  \n    const tileData = settlementTileData[gridType] || Array(8).fill(Array(8).fill(\"\"));\n    const isPlayerHere = tile.gridId === currentPlayer.location.g;\n  \n    let owner = null;\n    if (tile.ownerId && players) {\n      const ownerIdStr = typeof tile.ownerId === 'object' ? tile.ownerId._id : tile.ownerId;\n      owner = players.get(ownerIdStr);\n    }\n  \n    if (tile.ownerId && !owner) {\n    }\n  \n    const tooltip = getTooltip(tile);\n  \n    let miniX = 0;\n    let miniY = 0;\n    const isValleyGrid = [\"valley0\", \"valley1\", \"valley2\", \"valley3\"].includes(gridType);\n    let playerPCs = null;\n    let playerPC = null;\n\n    if (isPlayerHere && isValleyGrid && tile.gridId) {\n      playerPCs = playersInGridManager.getPlayersInGrid(tile.gridId);\n      playerPC = playerPCs?.[currentPlayer.playerId];\n      if (playerPC?.position) {\n        miniX = Math.floor(playerPC.position.x / 8);\n        miniY = Math.floor(playerPC.position.y / 8);\n      }\n    }\n  \n    return (\n      <div className=\"mini-grid\">\n        {tileData.map((row, rowIndex) =>\n          row.map((cell, colIndex) => {\n            let content = cell;\n  \n            if (isPlayerHere && isValleyGrid && rowIndex === miniY && colIndex === miniX) {\n              content = currentPlayer.icon;\n            }\n  \n            //  For homestead or other grid types, show icon at default corner\n            else if (isPlayerHere && !isValleyGrid && rowIndex === 0 && colIndex === 0) {\n              content = currentPlayer.icon;\n            }\n  \n            //  Homestead trade stall rendering\n            if (gridType === \"homesteadOccupied\") {\n              if (rowIndex === 7 && colIndex < 6) {\n                if (owner && Array.isArray(owner.tradeStall)) {\n                  const stall = owner.tradeStall[colIndex];\n                  // Only show the item if it hasn't been bought\n                  if (stall?.resource && !stall?.boughtBy) {\n                    const template = masterResources.find(r => r.type === stall.resource);\n                    if (template?.symbol) content = template.symbol;\n                  }\n                }\n              } else if (cell === \"username\") {\n                content = owner?.username || \"\";\n              } else if (cell === \"role\") {\n                content = owner?.role || \"Citizen\";\n              } else if (cell === \"netWorth\") {\n                content = `${owner?.netWorth?.toLocaleString() || \"0\"} (net worth)`;\n              }\n            }\n  \n            return (\n              <div key={`${rowIndex}-${colIndex}`} className=\"mini-cell\">\n                <span>{content}</span>\n                {tooltip && (\n                  <div className=\"tooltip\">\n                    <p>Who's Here:</p>\n                    {tooltip}\n                  </div>\n                )}\n              </div>\n            );\n          })\n        )}\n      </div>\n    );\n  };\n\n  if (error) return <div>Error: {error}</div>;\n  if (!settlementGrid.length) return <div>Loading Settlement Grid...</div>;\n\n  return (\n    <div className=\"settlement-grid\">\n      {settlementGrid.map((row, rowIndex) =>\n        row.map((tile, colIndex) => (\n          <div\n            key={`${rowIndex}-${colIndex}`}\n            className=\"settlement-tile\"\n            style={{\n              backgroundColor: getGridBackgroundColor(tile.gridType),\n            }}\n            onClick={() => handleTileClick(tile,TILE_SIZE)}\n          >\n            {renderMiniGrid(tile)}\n          </div>\n        ))\n      )}\n    </div>\n  );\n};\n\nexport default SettlementView;\n","import axios from \"axios\";\nimport API_BASE from \"../config\";\n\nexport const processRelocation = async (currentPlayer, setCurrentPlayer, fromGridId, targetGridCoord, settlementGrid) => {\n  console.log(\"At processRelocation; fromGridId =\", fromGridId, \"; targetGridCoord =\", targetGridCoord);\n  console.log(\"settlementGrid =\", settlementGrid);\n\n  try {\n    const relocationResponse = await axios.post(`${API_BASE}/api/relocate-homestead`, {\n      fromGridId,\n      targetGridCoord,\n    });\n\n    //  Refresh player data\n    try {\n      console.log(\" Fetching updated player data...\");\n      const playerResponse = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}`);\n      console.log(\" Updated player object:\", playerResponse.data);\n\n      if (playerResponse.data) {\n        setCurrentPlayer(playerResponse.data);\n        localStorage.setItem(\"player\", JSON.stringify(playerResponse.data));\n        console.log(\" setCurrentPlayer + localStorage update complete\");\n      }\n    } catch (error) {\n      console.error(\" Failed to refresh player data after relocation:\", error);\n    }\n\n    console.log(\" Relocation successful:\", relocationResponse.data);\n    return relocationResponse.data;\n  } catch (error) {\n    console.error(\" Relocation failed:\", error.response?.data || error.message);\n    return { success: false, error: error.response?.data || error.message };\n  }\n};","import API_BASE from \"../config\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport \"./FrontierView.css\";\nimport { StatusBarContext } from \"../UI/StatusBar/StatusBar\";\nimport { changePlayerLocation } from \"../Utils/GridManagement\";\nimport { fetchHomesteadSignpostPosition } from \"../Utils/worldHelpers\";\nimport frontierTileData from './FrontierTile.json';\nimport { useBulkOperation } from \"../UI/BulkOperationContext\";\nimport { getGridBackgroundColor } from './ZoomedOut';\nimport { showNotification } from '../UI/Notifications/Notifications';\nimport { useStrings } from '../UI/StringsContext';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\n\n\nconst FrontierView = ({ \n  currentPlayer, \n  isDeveloper,\n  setZoomLevel, \n  isRelocating,\n  setIsRelocating,\n  setCurrentPlayer,            \n  setGridId,                //  Ensure this is passed\n  setGrid,                  //  Pass setGrid function\n  setResources,             //  Pass setResources function\n  setTileTypes,             //  Pass setTileTypes function\n  TILE_SIZE,\n  closeAllPanels,\n  visibleSettlementId,\n  setVisibleSettlementId,\n  masterResources,          //  Add masterResources prop\n  masterTrophies,           //  Add masterTrophies prop\n}) => {\n\n  const [frontierGrid, setFrontierGrid] = useState([]);\n  const [settlementGrids, setSettlementGrids] = useState({}); // Store all settlement grids\n  const [error, setError] = useState(null);\n  const { updateStatus } = useContext(StatusBarContext);\n  const bulkOperationContext = useBulkOperation();\n  const strings = useStrings();\n \n  // Fetch Frontier Grid and Settlement Grids together\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/frontier-bundle/${currentPlayer.location.f}?playerSettlementId=${currentPlayer.location.s}`);\n        const { frontierGrid, settlementGrids = {} } = response.data;\n        setFrontierGrid(frontierGrid);\n        const settlementData = settlementGrids;\n        setSettlementGrids(settlementData);\n      } catch (err) {\n        console.error(\"Error fetching frontier bundle:\", err);\n        setError(\"Failed to fetch grid data\");\n      }\n    };\n    fetchData();\n  }, [currentPlayer.location.f]);\n\n  useEffect(() => {\n    if (isRelocating) {\n      updateStatus(125);\n    }\n  }, [isRelocating]);\n\n  // Show notification when zooming out to Frontier view (first time only)\n  useEffect(() => {\n    const checkAndShowFrontierTip = async () => {\n      // Check if player has already seen the frontier tip\n      const hasSawFrontierTip = currentPlayer.trophies?.some(trophy => trophy.name === \"SawFrontierTip\");\n      \n      if (!hasSawFrontierTip) {\n        console.log(' First time in Frontier view - awarding \"SawFrontierTip\" trophy');\n        \n        try {\n          // Award the invisible trophy to mark they've seen the tip\n          await earnTrophy(currentPlayer.playerId, \"SawFrontierTip\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          \n          // Show the notification\n          showNotification('Tip', {\n            title: strings[7001],\n            message: strings[7020]\n          });\n          \n          console.log(' Frontier tip shown and trophy awarded');\n        } catch (error) {\n          console.error(' Error awarding SawFrontierTip trophy:', error);\n          // Still show notification even if trophy award fails\n          showNotification('Tip', {\n            title: strings[7001],\n            message: strings[7020]\n          });\n        }\n      } else {\n        console.log(' Player already has SawFrontierTip trophy - skipping notification');\n      }\n    };\n    \n    if (currentPlayer?.playerId && strings && masterTrophies) {\n      checkAndShowFrontierTip();\n    }\n  }, [currentPlayer?.playerId, strings, masterTrophies]); // Re-run if these dependencies change\n\n  const handleTileClick = async (tile) => {\n    console.log(' Tile clicked:', tile);\n    console.log(' Current player state:', {\n      id: currentPlayer?._id,\n      playerId: currentPlayer?.playerId,\n      location: currentPlayer?.location,\n      gridId: currentPlayer?.gridId\n    });\n\n    // Are we in RELOCATION mode?\n    if (isRelocating) {\n      if (tile.settlementType.startsWith('homesteadSet')) {\n        if (tile.settlementId) { setVisibleSettlementId(tile.settlementId);}\n        setZoomLevel('settlement'); return;\n      } else { updateStatus(122); return; }\n    };\n\n    try {\n      // Add validation before attempting transit\n      if (!tile.settlementId) {\n        console.warn(' Missing settlementId in clicked tile');\n        updateStatus(\"Invalid destination\");\n        return;\n      }\n\n      // Case 1: Current settlement\n      if (tile.settlementId === currentPlayer.location.s) {\n          console.log(' Player clicked current settlement - zooming in');\n        setZoomLevel(\"settlement\");\n        updateStatus(12);\n        return;\n      }\n\n      // Case 2: Clicking on a tile where the player owns a homestead\n      if (tile.settlementType.startsWith('homesteadSet')) {\n        try {\n          // Fetch the settlement grid\n          const response = await axios.get(`${API_BASE}/api/get-settlement-grid/${tile.settlementId}`);\n          const grids = response.data.grid || [];\n          // Find the player's owned homestead\n          const ownedHomestead = grids.flat().find(\n            (grid) => grid.gridType === \"homestead\" && grid.gridId === currentPlayer.gridId\n          );    \n          if (ownedHomestead) {\n            console.log(\"Traveling to owned homestead:\", ownedHomestead);\n            \n            // Fetch the homestead grid data to find Signpost Town location\n            const signpostPosition = await fetchHomesteadSignpostPosition(ownedHomestead.gridId);\n            \n            const toLocation = {\n              x: signpostPosition.x,  \n              y: signpostPosition.y,\n              g: ownedHomestead.gridId, \n              s: tile.settlementId, \n              f: currentPlayer.location.f,\n              gtype: ownedHomestead.gridType, \n              gridCoord: ownedHomestead.gridCoord  \n            };\n            await changePlayerLocation(\n              currentPlayer,\n              currentPlayer.location, \n              toLocation,\n              setCurrentPlayer,\n              setGridId,                //  Ensure this is passed\n              setGrid,                  //  Pass setGrid function\n              setTileTypes,             //  Pass setTileTypes function\n              setResources,             //  Pass setResources function\n              TILE_SIZE,\n              closeAllPanels,\n              updateStatus,\n              bulkOperationContext,\n              masterResources,          //  Pass masterResources\n              strings,                  //  Pass strings for valley trophy check\n              null                      //  masterTrophies not available in FrontierView\n            ); \n            setZoomLevel(\"far\");\n            return;\n          }\n        } catch (error) {\n          console.error(\"Error checking for owned homestead:\", error);\n          updateStatus(8); // General error\n          return;\n        }\n        updateStatus(17); // Homestead tile clicked but no ownership\n        return;\n      }\n\n      // Case 3: Clicking on any other valley tile\n      if ([\"valley0Set\", \"valley1Set\", \"valley2Set\", \"valley3Set\"].includes(tile.settlementType)) {\n        updateStatus(9); // Valley tile clicked\n        return;\n      }\n\n    } catch (error) {\n      console.error(' Transit error details:', {\n        message: error.message,\n        response: error.response?.data,\n        status: error.response?.status,\n        tile: tile\n      });\n      updateStatus(99);\n    }\n  };\n\n  const renderMiniGrid = (tile) => {\n    const tileData = frontierTileData[tile.settlementType] || Array(8).fill(Array(8).fill(\"\"));\n    const settlementGrid = settlementGrids[tile.settlementId]?.grid || [];\n    const flatSettlementGrid = settlementGrid.flat();\n\n    return (\n      <div className=\"mini-grid\">\n        {tileData.map((row, rowIndex) =>\n          row.map((cell, colIndex) => {\n            const gridIndex = rowIndex * 8 + colIndex;\n            const gridData = flatSettlementGrid[gridIndex];\n\n            // Default content from tile data\n            let content = cell;\n\n            // Player's icon always overrides other content\n            if (gridData?.gridId && gridData.gridId === currentPlayer.location.g) {\n              content = currentPlayer.icon;\n            } else if (gridData?.gridType === 'homestead' && !gridData.available) {\n              content = '';\n            } else if (gridData?.gridType === 'town') {\n              content = '';\n            }\n\n            return (\n              <div key={`${rowIndex}-${colIndex}`} className=\"mini-cell\">\n                <span>{content}</span>\n              </div>\n            );\n          })\n        )}\n      </div>\n    );\n  };\n\n  if (error) return <div>Error: {error}</div>;\n  if (!frontierGrid.length) return <div>Loading Frontier Grid...</div>;\n\n  return (\n    <div className=\"frontier-grid\">\n      {frontierGrid.map((row, rowIndex) =>\n        row.map((tile, colIndex) => (\n          <div\n            key={`${rowIndex}-${colIndex}`}\n            className=\"frontier-tile\"\n            style={{\n              backgroundColor: getGridBackgroundColor(tile.settlementType),\n            }}\n            onClick={() => handleTileClick(tile)}\n          >\n            {renderMiniGrid(tile)}\n          </div>\n        ))\n      )}\n    </div>\n  );\n};\n\nexport default FrontierView;\n","// src/UI/Modal.js\nimport React from 'react';\nimport './Modal.css';\nimport './SharedButtons.css';\n\nfunction Modal({ isOpen = true, onClose, title, children, custom, message, message2, size = \"standard\", className }) {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className={`modal-container ${size === \"small\" ? \"modal-small\" : \"\"} ${className || \"\"}`}>\n        {/* Close Button (X style) */}\n        <button className=\"modal-close-btn\" onClick={onClose}>\n          &times;\n        </button>\n\n        {title && <h2 className=\"modal-title\">{title}</h2>}\n\n        <div className=\"modal-content\">\n          {message && <p className=\"modal-message\">{message}</p>}\n          {message2 && <p className=\"modal-message\">{message2}</p>}\n          {children}\n          {custom}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Modal;","import API_BASE from '../config';\nimport Modal from './Modal';\nimport React, { useState } from 'react';\nimport './LanguagePickerModal.css';\nimport './SharedButtons.css';\nimport LANGUAGE_OPTIONS from './Languages.json';\nimport axios from 'axios';\nimport { useStrings } from './StringsContext';\n\nexport default function LanguagePickerModal({ currentPlayer, setCurrentPlayer, updateStatus, onClose, onSave }) {\n  const strings = useStrings();\n  const [selectedLanguage, setSelectedLanguage] = useState(currentPlayer.language || '');\n\n  const handleLanguageClick = (langCode) => {\n    setSelectedLanguage(langCode);\n  };\n\nconst handleSave = async () => {\n  try {\n    const updatedPlayer = { ...currentPlayer, language: selectedLanguage };\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n    setCurrentPlayer(updatedPlayer);\n\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: currentPlayer._id,\n      updates: { language: selectedLanguage },\n    });\n\n    updateStatus && updateStatus('Language updated!');\n    onSave && onSave();\n\n    //  Only reload after successful DB update\n    window.location.reload();\n  } catch (error) {\n    console.error('Error saving language:', error);\n    updateStatus && updateStatus('Failed to update language');\n  }\n};\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose}>\n      <div className=\"language-modal\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        <h1>{strings[130]}</h1>\n        <ul className=\"language-list\">\n          {LANGUAGE_OPTIONS.map(({ code, label, flag }) => (\n            <li\n              key={code}\n              className={`language-item ${selectedLanguage === code ? 'selected' : ''}`}\n              onClick={() => handleLanguageClick(code)}\n            >\n              <span className=\"flag\">{flag}</span> {label}\n            </li>\n          ))}\n        </ul>\n        <div className=\"modal-buttons shared-buttons\">\n          <button className=\"btn-basic btn-modal btn-success\" onClick={handleSave}>{strings[131]}</button>\n        </div>\n      </div>\n    </div>\n  );\n}","import axios from 'axios';\nimport API_BASE from '../config';\nimport playersInGridManager from '../GridState/PlayersInGrid';\n\nexport const updatePlayerIcon = async (currentPlayer, setCurrentPlayer, playerId, icon, updateStatus) => {\n\n    //  Validate that the icon is a proper emoji\n    const isEmoji = (icon) => {\n      return typeof icon === 'string' && /\\p{Emoji}/u.test(icon);\n    };\n\n    if (!isEmoji(icon)) {\n        console.error(' Attempted to set non-emoji icon:', icon);\n        updateStatus?.(\"Please select a valid emoji.\");\n        return;\n    }\n\n    const updates = { icon };\n\n    const res = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates\n    });\n    if (!res.data.success) {\n        throw new Error('Failed to update icon');\n    }\n\n    //  Proceed only if DB update was successful\n    const gridId = currentPlayer?.location?.g;\n    if (gridId) {\n        const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n        if (playerData) {\n            const updatedPlayerData = {\n                ...playerData,\n                icon: icon,\n            };\n            playersInGridManager.updatePC(gridId, currentPlayer.playerId, updatedPlayerData);\n            console.log(` Updated icon in playersInGrid: ${currentPlayer.playerId}  ${icon}`);\n        }\n    } else {\n        console.warn(\" No valid gridId found, skipping NPCsInGrid update.\");\n    }\n\n    const updatedCurrentPlayer = { ...currentPlayer, icon };\n    localStorage.setItem('player', JSON.stringify(updatedCurrentPlayer));\n    setCurrentPlayer(updatedCurrentPlayer); //  Trigger React state update\n    console.log(' Updated localStorage and state for currentPlayer:', icon);\n\n  return res.data.player;\n};","var RELEASE_TRAIN = 'basil';\n\nvar runtimeVersionToUrlVersion = function runtimeVersionToUrlVersion(version) {\n  return version === 3 ? 'v3' : version;\n};\n\nvar ORIGIN = 'https://js.stripe.com';\nvar STRIPE_JS_URL = \"\".concat(ORIGIN, \"/\").concat(RELEASE_TRAIN, \"/stripe.js\");\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar STRIPE_JS_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/(v3|[a-z]+)\\/stripe\\.js(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar isStripeJSURL = function isStripeJSURL(url) {\n  return V3_URL_REGEX.test(url) || STRIPE_JS_URL_REGEX.test(url);\n};\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(ORIGIN, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!isStripeJSURL(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(STRIPE_JS_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"7.4.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise$1 = null;\nvar onErrorListener = null;\nvar onLoadListener = null;\n\nvar onError = function onError(reject) {\n  return function (cause) {\n    reject(new Error('Failed to load Stripe.js', {\n      cause: cause\n    }));\n  };\n};\n\nvar onLoad = function onLoad(resolve, reject) {\n  return function () {\n    if (window.Stripe) {\n      resolve(window.Stripe);\n    } else {\n      reject(new Error('Stripe.js not available'));\n    }\n  };\n};\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise$1 !== null) {\n    return stripePromise$1;\n  }\n\n  stripePromise$1 = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      } else if (script && onLoadListener !== null && onErrorListener !== null) {\n        var _script$parentNode;\n\n        // remove event listeners\n        script.removeEventListener('load', onLoadListener);\n        script.removeEventListener('error', onErrorListener); // if script exists, but we are reloading due to an error,\n        // reload script to trigger 'load' event\n\n        (_script$parentNode = script.parentNode) === null || _script$parentNode === void 0 ? void 0 : _script$parentNode.removeChild(script);\n        script = injectScript(params);\n      }\n\n      onLoadListener = onLoad(resolve, reject);\n      onErrorListener = onError(reject);\n      script.addEventListener('load', onLoadListener);\n      script.addEventListener('error', onErrorListener);\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  }); // Resets stripePromise on error\n\n  return stripePromise$1[\"catch\"](function (error) {\n    stripePromise$1 = null;\n    return Promise.reject(error);\n  });\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var pk = args[0];\n  var isTestKey = pk.match(/^pk_test/); // @ts-expect-error this is not publicly typed\n\n  var version = runtimeVersionToUrlVersion(maybeStripe.version);\n  var expectedVersion = RELEASE_TRAIN;\n\n  if (isTestKey && version !== expectedVersion) {\n    console.warn(\"Stripe.js@\".concat(version, \" was loaded on the page, but @stripe/stripe-js@\").concat(\"7.4.0\", \" expected Stripe.js@\").concat(expectedVersion, \". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning\"));\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar stripePromise;\nvar loadCalled = false;\n\nvar getStripePromise = function getStripePromise() {\n  if (stripePromise) {\n    return stripePromise;\n  }\n\n  stripePromise = loadScript(null)[\"catch\"](function (error) {\n    // clear cache on error\n    stripePromise = null;\n    return Promise.reject(error);\n  });\n  return stripePromise;\n}; // Execute our own script injection after a tick to give users time to do their\n// own script injection.\n\n\nPromise.resolve().then(function () {\n  return getStripePromise();\n})[\"catch\"](function (error) {\n  if (!loadCalled) {\n    console.warn(error);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now(); // if previous attempts are unsuccessful, will re-load script\n\n  return getStripePromise().then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import API_BASE from '../config';\nimport React, { useEffect, useState, useContext } from 'react';\nimport axios from 'axios';\nimport Modal from '../UI/Modal';\nimport './Store.css';\nimport '../UI/SharedButtons.css';\nimport { StatusBarContext } from '../UI/StatusBar/StatusBar';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { updateBadge } from '../Utils/appUtils';\nimport { useStrings } from '../UI/StringsContext';\n\nexport const handlePurchase = async (offerId, currentPlayer, updateStatus) => {\n  try {\n    const response = await axios.post(`${API_BASE}/api/create-checkout-session`, {\n      playerId: currentPlayer.playerId,\n      offerId\n    });\n\n    if (response.data?.id) {\n      const stripe = await loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\n      await stripe.redirectToCheckout({ sessionId: response.data.id });\n    } else {\n      updateStatus(\" Failed to initiate checkout.\");\n    }\n  } catch (err) {\n    console.error(\" Error initiating checkout:\", err);\n    updateStatus(\" Error initiating checkout.\");\n  }\n};\n\nfunction Store({ onClose, currentPlayer, setCurrentPlayer, resources, openMailbox, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const [offers, setOffers] = useState([]);\n  const { updateStatus } = useContext(StatusBarContext);\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const purchaseSuccess = params.get(\"purchase\");\n    console.log(\" URL query params:\", {\n      purchaseSuccess,\n      playerId: params.get(\"playerId\"),\n      offerId: params.get(\"offerId\")\n    });\n    const playerId = params.get(\"playerId\");\n    const offerId = params.get(\"offerId\");\n\n    if (purchaseSuccess === \"success\" && playerId && offerId) {\n\n      //  Finalize fulfillment by notifying backend\n      axios.post(`${API_BASE}/api/purchase-store-offer`, {\n        playerId,\n        offerId\n      }).then(() => {\n        console.log(\" Called /api/purchase-store-offer successfully for:\", { playerId, offerId });\n        console.log(\" Store reward successfully delivered.\");\n        updateStatus(\" Purchase successful! Check your Inbox.\");\n        updateBadge(currentPlayer, () => {}, \"store\", false); // Clear store badge\n\n        axios.get(`${API_BASE}/api/player/${playerId}`).then((playerResponse) => {\n          setCurrentPlayer(playerResponse.data);\n        }).catch((err) => {\n          console.error(\" Failed to refresh player data:\", err);\n        });\n        \n      }).catch((err) => {\n        console.error(\" Error calling /api/purchase-store-offer with:\", { playerId, offerId });\n        console.error(\" Failed to deliver store reward:\", err);\n        updateStatus(\" Purchase may not have been delivered. Please contact support.\");\n      });\n\n      //  Optionally hit backend to finalize fulfillment if needed\n\n      //  Clean up query params from the URL\n      const url = new URL(window.location.href);\n      url.search = \"\";\n      window.history.replaceState({}, document.title, url.toString());\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchOffers();\n  }, []);\n\n  const fetchOffers = async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/api/store-offers`);\n      setOffers(response.data || []);\n    } catch (error) {\n      console.error(\" Failed to load store offers:\", error);\n    }\n  };\n\n  const isOfferExpired = (offer) => {\n    if (!offer.shelflifeDays || !currentPlayer?.created) return false;\n\n    const created = new Date(currentPlayer.created);\n    const now = new Date();\n    const daysSince = Math.floor((now - created) / (1000 * 60 * 60 * 24));\n\n    return daysSince > offer.shelflifeDays;\n  };\n\n  return (\n    <Modal\n      onClose={(args) => {\n        if (args?.openMailbox && typeof openMailbox === 'function') {\n          openMailbox();\n        }\n        onClose();\n      }}\n      title={strings[1701]}\n    >\n        <h3>{strings[1702]}</h3>\n        <h4>{strings[1703]}</h4>\n        <h4>{strings[1704]}</h4>\n\n      <div className=\"store-offers\">\n        {(() => {\n          const activeOffers = offers.filter((offer) => !isOfferExpired(offer));\n          const processedIds = new Set();\n          \n          return activeOffers.map((offer) => {\n            // Skip if already processed\n            if (processedIds.has(offer.id)) return null;\n            \n            // Process offers 3 & 4 together\n            if (offer.id === 3 || offer.id === 4) {\n              const offer3 = activeOffers.find(o => o.id === 3);\n              const offer4 = activeOffers.find(o => o.id === 4);\n              \n              if (offer3) processedIds.add(3);\n              if (offer4) processedIds.add(4);\n              \n              return (\n                <div key=\"group-3-4\" className=\"store-offer-row\">\n                  {offer3 && (\n                    <div className=\"store-offer-card store-offer-card-half\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer3.title}</h3>\n                        <p>{offer3.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer3.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer3.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer3.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer4 && (\n                    <div className=\"store-offer-card store-offer-card-half\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer4.title}</h3>\n                        <p>{offer4.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer4.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer4.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer4.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              );\n            }\n            \n            // Process offers 6, 7 & 8 together\n            if (offer.id === 6 || offer.id === 7 || offer.id === 8) {\n              const offer6 = activeOffers.find(o => o.id === 6);\n              const offer7 = activeOffers.find(o => o.id === 7);\n              const offer8 = activeOffers.find(o => o.id === 8);\n              \n              if (offer6) processedIds.add(6);\n              if (offer7) processedIds.add(7);\n              if (offer8) processedIds.add(8);\n              \n              return (\n                <div key=\"group-6-7-8\" className=\"store-offer-row\">\n                  {offer6 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer6.title}</h3>\n                        <p>{offer6.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer6.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer6.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer6.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer7 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer7.title}</h3>\n                        <p>{offer7.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer7.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer7.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer7.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer8 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer8.title}</h3>\n                        <p>{offer8.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer8.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer8.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer8.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              );\n            }\n            \n            // Mark as processed and render normally\n            processedIds.add(offer.id);\n            \n            return (\n              <div key={offer.id} className={`store-offer-card${String(offer.id) === \"1\" ? ' store-offer-card-gold' : ''}`}>\n                <div className=\"store-offer-left\">\n                  <h3>{offer.title}</h3>\n                  <p>{offer.body}</p>\n                  <p className=\"store-reward-line\">\n                    {offer.rewards.map(r => {\n                      const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                      return `${symbol} ${r.qty} ${r.item}`;\n                    }).join(\", \")}\n                  </p>\n                </div>\n                <div className=\"store-offer-right\">\n                  <div className=\"store-price\">USD ${offer.price.toFixed(2)}</div>\n                  <div className=\"shared-buttons\">\n                    <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer.id, currentPlayer, updateStatus)}>Buy</button>\n                  </div>\n                </div>\n              </div>\n            );\n          });\n        })()}\n      </div>\n    </Modal>\n  );\n}\n\nexport default Store;","import React, { useState } from 'react';\nimport './ChangeIconModal.css';\nimport '../UI/SharedButtons.css';\nimport { updatePlayerIcon } from '../Authentication/ChangeIcon';\nimport ICON_OPTIONS from '../Authentication/PlayerIcons.json';\nimport { handlePurchase } from '../Store/Store';\nimport { useStrings } from '../UI/StringsContext';\n\nexport default function ChangeIconModal({ currentPlayer, setCurrentPlayer, updateStatus, currentIcon, playerId, onClose, onSave, setModalContent, setModalIsOpen  }) {\n  const [selectedIcon, setSelectedIcon] = useState(currentIcon);\n  const strings = useStrings();\n  \n  const handleSave = async () => {\n    try {\n      // Save the emoji label instead of the ID\n      await updatePlayerIcon(currentPlayer, setCurrentPlayer, playerId, selectedIcon);\n      onSave(selectedIcon);\n    } catch (err) {\n      alert(\"Failed to update icon.\");\n    }\n  };\n\n  // Determine gold status\n  const isGold = currentPlayer.accountStatus === 'Gold';\n\n  // Split icons into free and paid\n  const freeIcons = ICON_OPTIONS.free || [];\n  const paidIcons = ICON_OPTIONS.paid || [];\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"icon-modal\">\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        <h2>Choose Your Avatar</h2>\n\n        <br />\n\n        <div className=\"icon-grid\">\n          {freeIcons.map(icon => (\n            <button\n              key={icon.value}\n              className={`icon-button ${selectedIcon === icon.value ? 'selected' : ''}`}\n              onClick={() => setSelectedIcon(icon.value)}\n              disabled={false}\n            >\n              {icon.value}\n            </button>\n          ))}\n        </div>\n\n        <h3>Premium Avatars</h3>\n\n        {!isGold && (\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(1, currentPlayer, updateStatus)}>Unlock Premium Avatars</button>\n          </div>\n        )}\n\n        <div className=\"icon-grid\">\n          {paidIcons.map(icon => {\n            const locked = !isGold;\n            return (\n              <button\n                key={icon.value}\n                className={`icon-button ${selectedIcon === icon.value ? 'selected' : ''} ${locked ? 'locked' : ''}`}\n                disabled={locked}\n                onClick={() => {\n                  if (!locked) setSelectedIcon(icon.value);\n                }}\n              >\n                {icon.value}\n              </button>\n            );\n          })}\n        </div>\n\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic\" onClick={handleSave}>Save</button>\n        </div>\n      </div>\n    </div>\n  );\n}","import API_BASE from './config';\nimport axios from 'axios';\n\n/**\n * Update player settings both locally and on the server.\n */\nexport async function updatePlayerSettings(newSettings, currentPlayer, setCurrentPlayer) {\n  try {\n    // Prepare payload\n    const updatedPlayer = {\n      ...currentPlayer,\n      settings: { ...newSettings }, // Merge new settings\n    };\n\n    // Save to local storage first for immediate responsiveness\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n    setCurrentPlayer(updatedPlayer);\n\n    console.log('Updating settings on server:', newSettings);\n\n    // Send update to server using update-profile API\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: currentPlayer.playerId,\n      updates: {\n        settings: newSettings\n      }\n    });\n\n    if (response.data.success) {\n      console.log('Settings updated successfully on server.');\n    } else {\n      console.error('Server update failed:', response.data.error);\n    }\n  } catch (error) {\n    console.error('Error updating player settings:', error);\n  }\n}","import React, { createContext, useContext, useState } from 'react';\n\n// Create a context\nconst ModalContext = createContext();\n\n// Hook to use context\nexport const useModalContext = () => useContext(ModalContext);\n\n// Provider to wrap the app\nexport const ModalProvider = ({ children, custom }) => {\n  const [activeModal, setActiveModal] = useState(null);\n\n  const openModal = (modalName) => {\n    console.log(`Opening modal: ${modalName}`);\n    setActiveModal(modalName);\n  };\n\n  const closeModal = () => {\n    setActiveModal(null);\n  };\n\n  return (\n    <ModalContext.Provider value={{ activeModal, setActiveModal, openModal, closeModal }}>\n      {children}\n      {custom}\n    </ModalContext.Provider>\n  );\n};\n","import API_BASE from '../config';\nimport React, { useState, useEffect, useContext, useRef } from 'react';\nimport ChangeIconModal from '../UI/ChangeIconModal';\nimport axios from 'axios';\nimport '../UI/Panel.css'; // Use the standardized styles\nimport '../UI/SharedButtons.css'; // Use the standardized buttons\nimport Panel from '../UI/Panel';\nimport { updatePlayerSettings } from '../settings';  \nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { StatusBarContext } from '../UI/StatusBar/StatusBar';\nimport { usePanelContext } from '../UI/PanelContext';\nimport LANGUAGE_OPTIONS from '../UI/Languages.json';\nimport { useModalContext } from '../UI/ModalContext';\nimport { useStrings } from '../UI/StringsContext';\n\nconst ProfilePanel = ({ onClose, currentPlayer, setCurrentPlayer, handleLogout, isRelocating, setIsRelocating, zoomLevel, setZoomLevel }) => {\n  const strings = useStrings();\n  const { openPanel } = usePanelContext();\n\n  const [isDeveloper, setIsDeveloper] = useState(false);\n  const hasCheckedDeveloperStatus = useRef(false);\n  const [showChangeIconModal, setShowChangeIconModal] = useState(false);\n\n  useEffect(() => {\n    const checkDevStatus = async () => {\n      try {\n        if (!hasCheckedDeveloperStatus.current && currentPlayer?.username) {\n          const res = await axios.get(`${API_BASE}/api/check-developer-status/${currentPlayer.username}`);\n          if (res.data?.isDeveloper) {\n            setIsDeveloper(true);\n          }\n          hasCheckedDeveloperStatus.current = true;\n          console.log(' Developer check complete. isDeveloper:', res.data?.isDeveloper);\n        }\n      } catch (err) {\n        console.warn(' Failed to check developer status:', err);\n      }\n    };\n\n    checkDevStatus();\n  }, [currentPlayer]);\n\n  const [formData, setFormData] = useState({\n    username: '',\n    icon: '',\n    password: '',\n    accountStatus: 'Free',\n    role: 'Citizen',\n  });\n\n  const { updateStatus } = useContext(StatusBarContext);\n  const [isSaving, setIsSaving] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  // Local settings to track changes independently\n  const [localSettings, setLocalSettings] = useState({\n    isStateMachineEnabled: false,\n    isTeleportEnabled: false,\n    toggleVFX: true,\n    renderSVGResources: false,\n  });\n\n  // Initialize form fields and local settings\n  useEffect(() => {\n    if (currentPlayer) {\n      const { settings } = currentPlayer;\n      setLocalSettings({\n        isStateMachineEnabled: settings?.isStateMachineEnabled ?? false,\n        isTeleportEnabled: settings?.isTeleportEnabled ?? false,\n        toggleVFX: settings?.toggleVFX ?? true,\n        rangeOn: settings?.rangeOn ?? true,\n        renderSVGResources: settings?.renderSVGResources ?? false,\n      });\n  \n      setFormData({\n        username: currentPlayer.username || '',\n        icon: currentPlayer.icon || '',\n        password: '',\n        accountStatus: currentPlayer.accountStatus || 'Free',\n        role: currentPlayer.role || 'Citizen',\n      });\n  \n      setErrorMessage('');\n\n      console.log('Profile: curentPlayer = ',currentPlayer);\n    }\n  }, [currentPlayer]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: value,\n    }));\n  };\n\n  const handleToggleChange = (key) => {\n    setLocalSettings((prev) => {\n      const updatedSettings = {\n        ...prev,\n        [key]: !prev[key],\n      };\n\n      //  Call the centralized function to update local and server settings\n      updatePlayerSettings(updatedSettings, currentPlayer, setCurrentPlayer);\n      return updatedSettings;\n    });\n  };\n\n  const { setActiveModal } = useModalContext();\n\n  const handleLanguage = () => {\n    setActiveModal('LanguagePicker');\n  };\n\n  const handleSave = async () => {\n    setIsSaving(true);\n    setErrorMessage('');\n  \n    try {\n      // Validate username and icon inputs\n      if (!formData.username.trim()) {\n        throw new Error('Username cannot be empty.');\n      }\n  \n      // Prepare updates payload\n      const updates = {\n        username: formData.username.trim(),\n        icon: formData.icon.trim(),\n        ...(formData.password && { password: formData.password }),\n        accountStatus: formData.accountStatus,\n        role: formData.role,\n        settings: { ...localSettings }, // Save settings as an object\n      };\n  \n      console.log('Saving updates:', updates);\n  \n      // Call API to update the player profile\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates,\n      });\n  \n      if (response.data.success) {\n        console.log('Profile and settings successfully updated:', response.data.player);\n\n        //  Update the React state\n        const updatedPlayer = {\n          ...currentPlayer,\n          settings: { ...localSettings },\n          username: formData.username.trim(),\n          icon: formData.icon.trim(),\n          accountStatus: formData.accountStatus,\n          role: formData.role,\n        };\n\n        setCurrentPlayer(updatedPlayer);\n        localStorage.setItem('player', JSON.stringify(updatedPlayer));\n        console.log('Updated localStorage after save:', updatedPlayer.settings);\n\n        //  Update the Settlement with the player's new role (only if it's not Citizen)\n        if (formData.role && formData.role !== 'Citizen') {\n          console.log(` Assigning player to role \"${formData.role}\" in the settlement...`);\n          \n          await axios.post(`${API_BASE}/api/update-settlement-role`, {\n            settlementId: currentPlayer.location.s, //  Settlement ID\n            playerId: currentPlayer._id,           //  Player's ID\n            roleName: formData.role                //  Role they are assigned to\n          });\n        }\n\n        //  Directly update playersInGrid via playersInGridManager\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n            const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n            if (playerData) {\n                const updatedPlayerData = {\n                    ...playerData,\n                    username: formData.username.trim(),\n                };\n\n                playersInGridManager.updatePC(gridId, currentPlayer.playerId, updatedPlayerData);\n\n                console.log(` Updated username in playersInGrid: ${currentPlayer.playerId}  ${formData.username.trim()}`);\n            }\n        } else {\n            console.warn(\" No valid gridId found, skipping NPCsInGrid update.\");\n        }\n\n        // Notify success and close panel\n        onClose();\n      } else {\n        const errorMessage = response.data.error || 'Failed to update profile.';\n        console.error(errorMessage);\n        setErrorMessage(errorMessage);\n      }\n    } catch (error) {\n      console.error('Error during save operation:', error);\n      //  Check if the error message contains \"TAKEN\"\n      if (error.response?.data?.error === \"TAKEN\") {\n        console.log(\" Username is already taken.\");\n        updateStatus(50); \n      }\n      setErrorMessage(error.message || 'An unexpected error occurred while saving.');\n    } finally {\n      setIsSaving(false);\n    }\n};\n\n\n  const handleRelocation = async () => {\n    if (isRelocating) {\n      setIsRelocating(false);\n      setZoomLevel('close');\n      updateStatus(0);\n    } else {\n      setIsRelocating(true);\n      setZoomLevel('frontier');\n    }\n  };\n\n  const handleGoldPanelSwitch = () => {\n    openPanel('GoldBenefitsPanel');\n  };\n\n\n\n\n\n  \n  return (\n    <Panel\n      onClose={() => {\n        setIsRelocating(false);\n        if (zoomLevel === 'settlement' || zoomLevel === 'frontier') {\n          setZoomLevel('close');\n          updateStatus(0);\n        }\n        onClose();\n      }}\n      titleKey=\"1119\"\n      panelName=\"ProfilePanel\"\n    >\n      <div className=\"standard-panel\">\n\n        <h2>{strings[4051]} {currentPlayer.username} {currentPlayer.icon}</h2>\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={() => setShowChangeIconModal(true)}>\n            {strings[4065]}\n          </button>\n        </div>\n\n        <br />\n\n        {/* User Details Form */}\n        <div className=\"form-group\">\n          <label>{strings[4052]}</label>\n          <input\n            name=\"username\"\n            type=\"text\"\n            value={formData.username}\n            onChange={handleInputChange}\n            placeholder=\"Enter your username\"\n          />\n        </div>\n        <div className=\"form-group\">\n          <label>{strings[4053]}</label>\n          <input\n            name=\"password\"\n            type=\"password\"\n            value={formData.password}\n            onChange={handleInputChange}\n            placeholder=\"Enter new password (optional)\"\n          />\n        </div>\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleSave} disabled={isSaving}>\n            {isSaving ? 'Saving...' : strings[10128]}\n          </button>\n        </div>\n\n        <br />\n        <br />\n\n        <h3>{strings[4054]}</h3>\n\n        {isDeveloper && (\n          <div className=\"form-group\">\n            <label>{strings[4055]}</label>\n            <select name=\"accountStatus\" value={formData.accountStatus} onChange={handleInputChange}>\n              <option value=\"Free\">Free</option>\n              <option value=\"Bronze\">Bronze</option>\n              <option value=\"Silver\">Silver</option>\n              <option value=\"Gold\">Gold</option>\n            </select>\n          </div>\n        )}\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-gold\" onClick={handleGoldPanelSwitch}>\n            {formData.accountStatus === 'Gold' ? strings[10130] : strings[10131]}\n          </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-danger\" onClick={handleLogout}>\n            {strings[4056]}\n          </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const confirmed = window.confirm(\"Are you sure you want to delete your account? This action cannot be undone.\");\n              if (!confirmed) return;\n\n              try {\n                const response = await axios.post(`${API_BASE}/api/delete-player`, {\n                  playerId: currentPlayer.playerId,\n                });\n\n                if (response.data.success) {\n                  alert(\"Account deleted successfully.\");\n                  localStorage.removeItem('player');\n                  window.location.reload();\n                } else {\n                  alert(\"Failed to delete account.\");\n                }\n              } catch (err) {\n                console.error(\"Error deleting account:\", err);\n                alert(\"An error occurred while trying to delete your account.\");\n              }\n            }}\n          >\n            {strings[4057]}\n          </button>\n        </div>\n        <p>{strings[4058]} {currentPlayer?.playerId || 'N/A'}</p>\n        <p>Home Settlement ID: {currentPlayer?.settlementId || 'N/A'}</p>\n\n        <br/>\n\n\n        {/* Relocation Controls */}\n\n        <h3>{strings[4059]}</h3>\n        <p>{strings[4060]} <strong>{currentPlayer.relocations}</strong></p>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleRelocation} disabled={!currentPlayer.relocations}>\n            {isRelocating ? strings[10132] : strings[10133]}\n          </button>\n        </div>\n        <p>{strings[4061]}</p>\n\n\n        {/* Settings Toggles */}\n\n        <h3>{strings[4062]}</h3>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleLanguage}>\n             {LANGUAGE_OPTIONS.find(l => l.code === currentPlayer.language)?.label || 'Language'}\n          </button>\n        </div>\n\n        <div className=\"shared-buttons\">\n          <button\n            className={`btn-basic ${localSettings.renderSVGResources ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => handleToggleChange('renderSVGResources')}\n          >\n             Render SVG Resources: {localSettings.renderSVGResources ? 'is ON' : 'is OFF'}\n          </button>\n        </div>\n\n        <div className=\"shared-buttons\">\n          <button\n            className={`btn-basic ${localSettings.rangeOn ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => handleToggleChange('rangeOn')}\n          >\n            {strings[4064]}{localSettings.rangeOn ? 'is ON' : 'is OFF'}\n          </button>\n        </div>\n\n        {isDeveloper && (\n          <div className=\"shared-buttons\">\n            <button\n              className={`btn-basic ${localSettings.isTeleportEnabled ? 'btn-success' : 'btn-neutral'}`}\n              onClick={() => handleToggleChange('isTeleportEnabled')}\n            >\n              Teleport: {localSettings.isTeleportEnabled ? 'is ON' : 'is OFF'}\n            </button>\n          </div>\n        )}\n\n        <div className=\"shared-buttons\">\n          <button\n            className={`btn-basic ${localSettings.toggleVFX ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => handleToggleChange('toggleVFX')}\n          >\n            VFX: {localSettings.toggleVFX ? 'is ON' : 'is OFF'}\n          </button>\n        </div>\n\n        {showChangeIconModal && (\n          <ChangeIconModal\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            updateStatus={updateStatus}\n            currentIcon={formData.icon}\n            playerId={currentPlayer.playerId}\n            onClose={() => setShowChangeIconModal(false)}\n            onSave={(newIcon) => {\n              setFormData(prev => ({ ...prev, icon: newIcon }));\n              setShowChangeIconModal(false);\n            }}\n          />\n        )}\n      </div>\n    </Panel>\n    \n  );\n};\n\nexport default ProfilePanel;","/**\n * Conversion Tracking Utility\n * Handles conversion events for various advertising platforms\n */\n\n// Google Analytics 4 Event\nexport const trackGoogleAccountCreation = (username, userId) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'sign_up', {\n      method: 'email',\n      value: 1,\n      currency: 'USD',\n      user_id: userId,\n      custom_parameters: {\n        username: username\n      }\n    });\n    \n    // Google Ads will automatically import this conversion from GA4\n    // No need for separate Google Ads conversion tracking when using GA4\n  }\n};\n\n// Reddit Pixel Event\nexport const trackRedditAccountCreation = (userId) => {\n  if (typeof window.rdt !== 'undefined') {\n    // Reddit's SignUp event doesn't accept custom parameters\n    window.rdt('track', 'SignUp');\n  }\n};\n\n// Facebook/Meta Pixel Event\nexport const trackFacebookAccountCreation = (username, userId) => {\n  if (typeof window.fbq !== 'undefined') {\n    window.fbq('track', 'CompleteRegistration', {\n      value: 1.00,\n      currency: 'USD',\n      content_name: 'game_account',\n      status: true,\n      user_id: userId\n    });\n  }\n};\n\n// TikTok Pixel Event\nexport const trackTikTokAccountCreation = (userId) => {\n  if (typeof window.ttq !== 'undefined') {\n    window.ttq.track('CompleteRegistration', {\n      value: 1.00,\n      currency: 'USD',\n      content_id: userId\n    });\n  }\n};\n\n// Master function to track across all platforms\nexport const trackAccountCreation = (username, userId) => {\n  console.log(' Tracking account creation for:', username, userId);\n  \n  // Track on all platforms\n  trackGoogleAccountCreation(username, userId);\n  trackRedditAccountCreation(userId);\n  trackFacebookAccountCreation(username, userId);\n  trackTikTokAccountCreation(userId);\n  \n  // You can add more platforms here as needed\n};\n\n// Track other important events\nexport const trackTutorialComplete = (userId) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'tutorial_complete', {\n      user_id: userId\n    });\n  }\n  \n  if (typeof window.rdt !== 'undefined') {\n    window.rdt('track', 'Custom', {\n      customEventName: 'TutorialComplete'\n    });\n  }\n};\n\nexport const trackFirstPurchase = (userId, value) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'purchase', {\n      value: value,\n      currency: 'USD',\n      user_id: userId,\n      items: [{\n        item_name: 'in_game_purchase',\n        price: value,\n        quantity: 1\n      }]\n    });\n  }\n  \n  if (typeof window.fbq !== 'undefined') {\n    window.fbq('track', 'Purchase', {\n      value: value,\n      currency: 'USD',\n      user_id: userId\n    });\n  }\n};","import API_BASE from '../config';\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport { useStrings } from '../UI/StringsContext';\nimport LANGUAGE_OPTIONS from '../UI/Languages.json';\nimport '../UI/SharedButtons.css';\nimport { trackAccountCreation } from '../Utils/conversionTracking';\n\nconst CreateAccount = ({ setCurrentPlayer, zoomLevel, setZoomLevel, setIsLoggedIn, closeModal }) => {\n  const strings = useStrings();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [language, setLanguage] = useState('en');\n  const [error, setError] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\nconst handleCreateAccount = async (e) => {\n  e.preventDefault();\n  if (isSubmitting) return;\n  setIsSubmitting(true);\n\n  try {\n    const frontierName = 'Valley View 1';\n\n    // 1. Fetch the Frontier by Name\n    const frontierResponse = await axios.get(`${API_BASE}/api/frontiers-by-name`, { params: { name: frontierName } });\n    if (!frontierResponse.data || frontierResponse.data.length === 0) throw new Error('Frontier not found');\n    const frontier = frontierResponse.data[0];\n\n    // 2. Locate an available sub-grid in a settlement\n    let assignedSettlementId = null;\n    let assignedGridCoord = null;\n    let gridType = null;\n\n    for (const settlementRow of frontier.settlements || []) {\n      for (const settlement of settlementRow) {\n        if (settlement.available !== true) continue;\n\n        const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlement.settlementId}`);\n        const settlementData = settlementResponse.data;\n\n        const availableGrid = settlementData.grids.flat().find((grid) => grid.available === true);\n        if (availableGrid) {\n          assignedSettlementId = settlement.settlementId;\n          assignedGridCoord = availableGrid.gridCoord;\n          gridType = availableGrid.gridType;\n          break;\n        }\n      }\n      if (assignedGridCoord) break;\n    }\n\n    if (!assignedSettlementId || !assignedGridCoord) {\n      throw new Error('No available sub-grids in the Frontier.');\n    }\n\n    // 3. Register player using unified endpoint (server will create the grid)\n    const registerPayload = {\n      username,\n      password,\n      language,\n      location: {\n        x: 30,\n        y: 33,\n        gridCoord: assignedGridCoord,\n        settlementId: assignedSettlementId,\n        frontierId: frontier._id,\n        gtype: gridType,\n      },\n    };\n\n    console.log('Calling /api/register-new-player with payload:', registerPayload);\n    const response = await axios.post(`${API_BASE}/api/register-new-player`, registerPayload);\n    if (!response.data.success || !response.data.player) {\n      throw new Error('Player registration failed');\n    }\n\n    const player = response.data.player;\n    const location = player.location;\n    const assignedGridId = location?.g;\n\n    console.log(' Player registered:', player);\n\n    // Track the successful account creation for ad platforms\n    trackAccountCreation(player.username, player._id || player.playerId);\n\n    // 4. Finalize account setup\n    setCurrentPlayer(player);\n    localStorage.removeItem('player');\n    localStorage.setItem('player', JSON.stringify(player));\n\n    // 5. Save PC to grid\n    const now = Date.now();\n    const newPC = {\n      playerId: player._id,\n      type: 'pc',\n      username: player.username,\n      position: { x: 30, y: 33 },\n      icon: player.icon || '',\n      hp: player.baseHp || 25,\n      maxhp: player.baseMaxhp || 25,\n      attackbonus: player.baseAttackbonus || 1,\n      armorclass: player.baseArmorclass || 1,\n      damage: player.baseDamage || 1,\n      attackrange: player.baseAttackrange || 1,\n      speed: player.baseSpeed || 1,\n      iscamping: false,\n      isinboat: false,\n      lastUpdated: now,\n    };\n\n    const payload = {\n      gridId: assignedGridId,\n      playerId: player._id,\n      pc: newPC,\n      lastUpdated: now,\n    };\n\n    await axios.post(`${API_BASE}/api/save-single-pc`, payload);\n\n    // 6. Send welcome message\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId: player._id,\n        messageId: 1,\n      });\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n    }\n\n    // 7. Close modal and reload\n    if (closeModal) closeModal();\n    localStorage.setItem(\"initialZoomLevel\", \"close\");\n    window.location.reload();\n\n  } catch (err) {\n    console.error('Error during account creation:', err);\n    setError(err.response?.data?.error || 'Account creation failed. Please try again.');\n    setIsSubmitting(false);\n  }\n};\n\nreturn (\n  <div id=\"create-account-form\">\n    <h2>{strings[4002]}</h2>\n    <form onSubmit={handleCreateAccount}>\n      <input\n        type=\"text\"\n        placeholder=\"Username\"\n        value={username}\n        onChange={(e) => setUsername(e.target.value)}\n      />\n      <input\n        type=\"password\"\n        placeholder=\"Password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n      />\n      <select\n        value={language}\n        onChange={(e) => setLanguage(e.target.value)}\n      >\n        <option value=\"\">{strings[4067]}</option>\n        {LANGUAGE_OPTIONS.map(({ code, label }) => (\n          <option key={code} value={code}>\n            {label}\n          </option>\n        ))}\n      </select>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" type=\"submit\" disabled={isSubmitting}>\n          {strings[4002]}\n        </button>\n      </div>\n    </form>\n\n    <div className=\"shared-buttons\">\n      <button className=\"btn-basic btn-neutral\"\n        type=\"button\"\n        onClick={() => setIsLoggedIn(false)}\n      >\n        {strings[4066]}\n      </button>\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n      </div>\n\n      <p> <strong>{strings[4004]}</strong></p>\n    </div>\n    \n  );\n};\n\nexport default CreateAccount;","import API_BASE from '../config';\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../UI/Panel';\nimport CreateAccount from './CreateAccount';\nimport '../UI/Panel.css'; \nimport '../UI/SharedButtons.css'; \n\nimport { useStrings } from '../UI/StringsContext';\n\nconst LoginPanel = ({ onClose, setCurrentPlayer, zoomLevel, setZoomLevel, onLoginSuccess }) => {\n  const strings = useStrings();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [showCreateAccount, setShowCreateAccount] = useState(false);\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    try {\n      console.log('Login attempt:', { username, password });\n\n      const response = await axios.post(`${API_BASE}/api/login`, { username, password });\n      if (response.data.success) {\n        const player = response.data.player;\n        console.log('Login successful:', player);\n\n        setCurrentPlayer(player); // Set player data\n        localStorage.setItem('player', JSON.stringify(player)); // Store in local storage\n        onClose(); // Close panel\n\n        if (onLoginSuccess) {\n          onLoginSuccess(player); // Notify parent component\n        }\n      } else {\n        setError(response.data.error || 'Invalid username or password');\n      }\n    } catch (err) {\n      console.error('Error during login:', err);\n      setError('Login failed. Please try again.');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1021\" titleKey=\"1121\" panelName=\"LoginPanel\">\n      {showCreateAccount ? (\n        <CreateAccount\n          setCurrentPlayer={setCurrentPlayer}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel}\n          setIsLoggedIn={() => {\n            setShowCreateAccount(false);\n            onClose();\n          }}\n        />\n      ) : (\n        <div className=\"standard-panel\">\n          <form onSubmit={handleLogin} className=\"panel-form\">\n            <div className=\"form-group\">\n\n            <div className=\"shared-buttons\">\n            <h3>{strings[4001]}</h3>\n              <button\n                type=\"button\"\n                className=\"btn-basic btn-success\"\n                onClick={() => setShowCreateAccount(true)}\n              >\n                {strings[4002]}\n              </button>\n            </div>  \n            <h4>{strings[4004]}</h4>\n            <h4>{strings[4005]}</h4>\n\n            <h3>{strings[5033]}</h3>\n\n            <h3>{strings[4010]}</h3>\n\n              <label htmlFor=\"username\">Username</label>\n              <input\n                id=\"username\"\n                type=\"text\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">{strings[4006]}</label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n              />\n            </div>\n            {error && <p className=\"error-message\">{error}</p>}\n\n            <div className=\"shared-buttons\">\n              <button type=\"submit\" className=\"btn-basic btn-neutral\">\n                {strings[4007]}\n              </button>\n            </div>\n          </form>\n          <div className=\"panel-buffer-space\" />\n          <div className=\"panel-buffer-space\" />\n\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic btn-success\"\n              onClick={() => window.location.href = 'mailto:valleyviewgamedev@gmail.com'}\n            >\n              {strings[97]}\n            </button>\n          </div>\n\n        </div>\n        \n      )}\n    </Panel>\n  );\n};\n\nexport default LoginPanel;\n","// A small component to add to App.js Base Panel for visual debugging\nimport React from 'react';\nimport './GridStateDebug.css';\n\nconst GridStateDebugPanel = ({ gridId, gridCoord, gridType, settlementId, NPCsInGrid, playersInGrid }) => {\n  const formatJSON = (obj) => {\n    try {\n      return JSON.stringify(obj, null, 2);\n    } catch {\n      return '[Unserializable]';\n    }\n  };\n\n  const currentNPCs = NPCsInGrid?.[gridId] || 'Not loaded';\n  const currentPCs = playersInGrid?.[gridId] || 'Not loaded';\n\n  return (\n    <div className=\"grid-debug-panel\">\n      <h4 style={{ color: 'white' }}>Debug:</h4>\n      <br></br>\n      <h5>gridId:</h5>\n      <pre>{formatJSON(gridId)}</pre>\n      <h5>gridCoord: {formatJSON(gridCoord)}</h5>\n      <h5>gridType: {formatJSON(gridType)}</h5>\n      <h5>settlementId: {formatJSON(settlementId)}</h5>\n      <br></br>\n      <h5> NPCsInGrid?[gridId]</h5>\n      <pre>{formatJSON(currentNPCs)}</pre>\n      <h5> PlayersInGrid?[gridId]</h5>\n      <pre>{formatJSON(currentPCs)}</pre>\n    </div>\n  );\n};\n\nexport default GridStateDebugPanel;\n","import API_BASE from '../config'; \nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../UI/Panel';\nimport '../UI/Panel.css'; // Specific styles for Debug Panel\nimport '../UI/SharedButtons.css'; // Specific styles for Debug Panel\nimport { fetchInventory, refreshPlayerAfterInventoryUpdate } from './InventoryManagement';\nimport { fetchGridData, changePlayerLocation } from './GridManagement';\nimport NPCsInGridManager from '../GridState/GridStateNPCs'; // Use default export for NPCsInGridManager\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport GridStateDebugPanel from './GridStateDebug';\nimport { generateTownGrids, generateValleyGrids, createSingleValleyGrid } from './WorldGeneration';\nimport { updatePlayerSettings } from '../settings';\n\nconst DebugPanel = ({ onClose, currentPlayer, setCurrentPlayer, setInventory, setResources, currentGridId, updateStatus, TILE_SIZE, setGrid, setGridId, setTileTypes, closeAllPanels, useCanvasTiles, setUseCanvasTiles }) => {\n  const [timers, setTimers] = useState([]);\n  const [npcs, setNPCs] = useState([]);\n  const [pcs, setPCs] = useState([]);\n  const [updatedNPCs, setUpdatedNPCs] = useState(npcs);\n  const [refreshDebug, setRefreshDebug] = useState(false);\n  const [singleGridCoord, setSingleGridCoord] = useState('');\n  const [toGridCoord, setToGridCoord] = useState('');\n  const [usernameToDelete, setUsernameToDelete] = useState('');\n  const [messageIdentifier, setMessageIdentifier] = useState('');\n  \n  // Performance monitoring state\n  const [performanceMetrics, setPerformanceMetrics] = useState({\n    fps: 0,\n    domElementCount: 0,\n    memoryUsage: 0,\n    renderMode: 'Unknown'\n  });\n  \n  // Fetch resources with timers when the panel opens or gridId changes\n  useEffect(() => {\n    if (!currentGridId) return;\n\n    const fetchTimers = async () => {\n        try {\n            console.log('Fetching timers for gridId:', currentGridId);\n            const gridData = await fetchGridData(currentGridId,updateStatus,currentPlayer);\n\n            //  Include both growEnd (Farming) and craftEnd (Crafting)\n            const resourcesWithTimers = (gridData.resources || []).filter(\n                (res) => res.growEnd || res.craftEnd\n            );\n\n            console.log(' Active Timers:', resourcesWithTimers);\n            setTimers(resourcesWithTimers);\n        } catch (error) {\n            console.error('Error fetching timers:', error);\n        }\n    };\n\n    fetchTimers();\n  }, [currentGridId]);\n\n  // Refresh timers periodically\n  useEffect(() => {\n    const timerInterval = setInterval(() => {\n      setTimers((prevTimers) =>\n        prevTimers.map((timer) => {\n          const growTimeRemaining = timer.growEnd ? Math.max(0, Math.floor((timer.growEnd - Date.now()) / 1000)) : null;\n          const craftTimeRemaining = timer.craftEnd ? Math.max(0, Math.floor((timer.craftEnd - Date.now()) / 1000)) : null;\n\n          return {\n            ...timer,\n            remainingTime: growTimeRemaining !== null ? growTimeRemaining : craftTimeRemaining, // Prioritize active timer\n          };\n        })\n      );\n    }, 1000);\n\n    return () => clearInterval(timerInterval);\n  }, []);\n\n  // Fetch NPCs and PCs from GridState\n  useEffect(() => {\n    if (!currentGridId) return;\n\n    const fetchGridStateEntities = () => {\n      const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n      const playersInGrid = playersInGridManager.getPlayersInGrid(currentGridId);\n\n      if (!NPCsInGrid) {\n        console.warn(`No NPCsInGrid found for gridId: ${currentGridId}`);\n        setNPCs([]);\n      } else {\n        setNPCs(Object.values(NPCsInGrid.npcs || {}));\n      }\n\n      if (!playersInGrid) {\n        console.warn(`No playersInGrid found for gridId: ${currentGridId}`);\n        setPCs([]);\n      } else {\n        setPCs(Object.values(playersInGrid));\n      }\n    };\n\n    fetchGridStateEntities();\n  }, [currentGridId, refreshDebug]);\n  \n  // Synchronize updatedNPCs with npcs when npcs changes\n  useEffect(() => {\n    setUpdatedNPCs(npcs);\n  }, [npcs]);\n\n  // Performance monitoring useEffect\n  useEffect(() => {\n    let frameCount = 0;\n    let lastTime = performance.now();\n    let animationFrameId;\n\n    const measurePerformance = () => {\n      frameCount++;\n      const currentTime = performance.now();\n      \n      // Calculate FPS every second\n      if (currentTime - lastTime >= 1000) {\n        const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));\n        \n        // Count DOM elements\n        const domElementCount = document.querySelectorAll('*').length;\n        \n        // Detect render mode by checking for canvas vs DOM tiles\n        const hasCanvasTiles = document.querySelector('canvas[style*=\"position: absolute\"]') !== null;\n        const hasDOMTiles = document.querySelector('.tile-g, .tile-s, .tile-d, .tile-w, .tile-l, .tile-p, .tile-n, .tile-o') !== null;\n        let renderMode = 'Unknown';\n        if (hasCanvasTiles && !hasDOMTiles) {\n          renderMode = 'Canvas';\n        } else if (!hasCanvasTiles && hasDOMTiles) {\n          renderMode = 'DOM';\n        } else if (hasCanvasTiles && hasDOMTiles) {\n          renderMode = 'Mixed';\n        }\n        \n        // Get memory usage if available\n        let memoryUsage = 0;\n        if (performance.memory) {\n          memoryUsage = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024); // MB\n        }\n        \n        setPerformanceMetrics({\n          fps,\n          domElementCount,\n          memoryUsage,\n          renderMode\n        });\n        \n        frameCount = 0;\n        lastTime = currentTime;\n      }\n      \n      animationFrameId = requestAnimationFrame(measurePerformance);\n    };\n    \n    animationFrameId = requestAnimationFrame(measurePerformance);\n    \n    return () => {\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n    };\n  }, []);\n\n\n\n\n  const handleResetGrid = async () => {\n    if (!currentGridId) { console.error('currentGridId is not defined.'); return; }\n    console.log('handleResetGrid: gridId:', currentGridId);\n  \n    try {\n      // Fetch settlement details using the player's current location\n      const settlementId = currentPlayer?.location?.s; // Fetch settlementId from current player location\n      if (!settlementId) {\n        console.error('Settlement ID not found for the current player.');\n        alert('Settlement ID not found for the current player.');\n        return;\n      }\n  \n      // Fetch settlement data to retrieve frontierId\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n      const settlement = settlementResponse.data;\n  \n      if (!settlement || !settlement.frontierId) {\n        console.error('Settlement data is incomplete or missing frontierId.');\n        alert('Settlement data is incomplete or missing frontierId.');\n        return;\n      }\n  \n      const frontierId = settlement.frontierId; // Extract frontierId from the settlement\n      console.log('Settlement and frontierId resolved:', { settlementId, frontierId });\n  \n      // Fetch grid data to determine the gridType dynamically\n      const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${currentGridId}`);\n      const gridData = gridResponse.data;\n  \n      if (!gridData || !gridData.gridType) {\n        console.error('Grid data is incomplete or missing gridType.');\n        alert('Grid data is incomplete or missing gridType.');\n        return;\n      }\n  \n      const gridType = gridData.gridType;\n\n      let gridCoord = null;\n      for (const row of settlement.grids) {\n        for (const cell of row) {\n          if (cell.gridId && String(cell.gridId) === String(currentGridId)) {\n            gridCoord = cell.gridCoord;\n            break;\n          }\n        }\n        if (gridCoord !== null) break;\n      }\n\n      if (gridCoord === null) {\n        console.error('Could not resolve gridCoord from settlement.');\n        alert('Could not resolve gridCoord from settlement.');\n        return;\n      }\n\n      console.log('Extracted gridData: gridType=', gridType, '; gridCoord=', gridCoord);\n  \n      // Send request to reset the grid\n      const resetResponse = await axios.post(`${API_BASE}/api/reset-grid`, {\n        gridCoord,\n        gridId: currentGridId, // Use the Mongo `_id` of the grid\n        gridType,\n        settlementId,\n        frontierId,\n      });\n  \n      console.log(`Grid ${currentGridId} of type ${gridType} reset successfully:`, resetResponse.data);\n      updateStatus(903);\n      window.location.reload();\n    } catch (error) {\n      console.error(`Error resetting grid \"${currentGridId}\":`, error);\n      alert(`Failed to reset grid \"${currentGridId}\". Check the console for details.`);\n    }\n  }; \n\n  \n  const handleAddMoney = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) { console.error('No user logged in. Cannot add money.'); return; }\n      // Call delta-based inventory update\n      await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n        playerId,\n        delta: { type: 'Money', quantity: 10000, target: 'inventory' },\n      });\n\n      // Update local inventory state\n      const updatedInventory = await fetchInventory(playerId);\n      setInventory(updatedInventory);\n      // Update currentPlayer with the new inventory\n      setCurrentPlayer(prev => ({ ...prev, inventory: updatedInventory }));\n      // Refresh player data (but preserve the inventory we just set)\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, true);\n      console.log(' Added 10,000 Money successfully using delta update.');\n    } catch (error) {\n      console.error(' Error adding money:', error);\n    }\n  };\n\nconst handleGetRich = async () => {\n  try {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) {\n      console.error('No user logged in. Cannot perform Get Rich.');\n      return;\n    }\n\n    // Define resources to add\n    const resourcesToAdd = [\n      { type: 'Money', quantity: 100000 },\n      { type: 'Potion A', quantity: 50 },\n      { type: 'Potion B', quantity: 50 },\n      { type: 'Potion C', quantity: 50 },\n      { type: 'Gem', quantity: 200 },\n      { type: 'Book', quantity: 100 },\n      { type: 'Wood', quantity: 1000 },\n      { type: 'Clay', quantity: 1000 },\n      { type: 'Stone', quantity: 1000 },\n      { type: 'Wheat', quantity: 1000 },\n      { type: 'Corn', quantity: 1000 },\n      { type: 'Carrot', quantity: 1000 },\n      { type: 'Grapes', quantity: 500 },\n      { type: 'Apple', quantity: 500 },\n      { type: 'Bread', quantity: 500 },\n      { type: 'Olive Oil', quantity: 500 },\n      { type: 'Honey', quantity: 500 },\n      { type: 'Flour', quantity: 500 },\n      { type: 'Butter', quantity: 500 },\n      { type: 'Egg', quantity: 500 },\n      { type: 'Sugar', quantity: 500 },\n      { type: 'Cream', quantity: 500 },\n      { type: 'Lemon', quantity: 500 },\n      { type: 'Orange', quantity: 500 },\n      { type: 'Cloth', quantity: 500 },\n      { type: 'Lumber', quantity: 500 },\n      { type: 'Thread', quantity: 500 },\n      { type: 'Milk', quantity: 500 },\n      { type: 'Aged Wine', quantity: 500 },\n      { type: 'Sweater', quantity: 500 },\n      { type: 'Cheese', quantity: 500 },\n      { type: 'Sugarcane', quantity: 500 },\n      { type: 'Strawberry', quantity: 500 },\n      { type: 'Diamond Ring', quantity: 500 },\n      { type: 'Feverfew', quantity: 100 },\n      { type: 'Golden Key', quantity: 100 },\n      { type: 'Skeleton Key', quantity: 100 },\n      { type: 'Furniture', quantity: 100 },\n      { type: 'Port', quantity: 100 },\n      { type: 'Wool', quantity: 500 },\n      { type: 'Scroll', quantity: 100 },\n      { type: 'Pottery', quantity: 100 },\n      { type: 'Portrait', quantity: 10 },\n      { type: 'Trident', quantity: 10 },\n      { type: 'Yellow Heart', quantity: 1000 },\n      { type: 'Green Heart', quantity: 500 },\n      { type: 'Purple Heart', quantity: 500 },\n      { type: 'Saw', quantity: 10 },\n      { type: 'Shovel', quantity: 20 },\n      { type: 'Screwdriver', quantity: 30 },\n      { type: 'Hammer', quantity: 40 },\n      { type: 'Bolt', quantity: 50 },\n    ];\n\n    // Use delta endpoint for batched update, adding target: 'inventory' to each resource\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n      playerId,\n      delta: resourcesToAdd.map(item => ({ ...item, target: 'inventory' })),\n    });\n\n    // Update local inventory state\n    const updatedInventory = await fetchInventory(playerId);\n    setInventory(updatedInventory);\n    \n    // Update currentPlayer with the new inventory\n    setCurrentPlayer(prev => ({ ...prev, inventory: updatedInventory }));\n    \n    // Refresh player data after the batched update (preserve inventory)\n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, true);\n\n    console.log(' Get Rich: Inventory updated successfully via delta.');\n  } catch (error) {\n    console.error(' Error performing Get Rich:', error);\n  }\n};\n  \n  const handleGetSkills = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No user logged in. Cannot add skills.');\n        return;\n      }\n  \n      // Fetch master resources\n      const response = await axios.get(`${API_BASE}/api/resources`);\n      const masterResources = response.data;\n  \n      if (!Array.isArray(masterResources)) {\n        console.error('Master resources are not an array:', masterResources);\n        return;\n      }\n  \n      // Filter resources of type \"skill\"\n      const skillResources = masterResources.filter((res) => res.category === 'skill');\n      if (skillResources.length === 0) {\n        console.warn('No skill resources found.');\n        alert('No skill resources available to add.');\n        return;\n      }\n  \n      // Fetch the latest skills\n      const skillsResponse = await axios.get(`${API_BASE}/api/skills/${playerId}`);\n      const currentSkills = skillsResponse.data.skills || [];\n  \n      // Create a new skills list by adding one of each skill\n      const updatedSkills = [...currentSkills];\n      skillResources.forEach((skill) => {\n        const existingSkill = updatedSkills.find((item) => item.type === skill.type);\n        if (existingSkill) {\n          existingSkill.quantity += 1;\n        } else {\n          updatedSkills.push({ type: skill.type, quantity: 1 });\n        }\n      });\n  \n      // Send the full updated skills list to the server\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId,\n        skills: updatedSkills,\n      });\n  \n      // Update the `currentPlayer` state with new skills\n      const updatedPlayer = { ...currentPlayer, skills: updatedSkills };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n      updateStatus(904);\n      console.log('Get Skills: Added skills successfully.');\n    } catch (error) {\n      console.error('Error adding skills:', error);\n      alert('Failed to add skills. Check console for details.');\n    }\n  };\n  \n  const handleClearTrophies = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear trophies.');\n        return;\n      }\n\n      // Clear trophies\n      const clearedTrophies = [];\n      console.log('Clearing all trophies.');\n      \n      // Update trophies on the server by setting to empty array\n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates: {\n          trophies: clearedTrophies\n        }\n      });\n      \n      console.log('Trophies cleared successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Update the local state for trophies\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        trophies: clearedTrophies\n      }));\n      \n      updateStatus('Trophies cleared successfully.');\n      console.log('Trophies cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing trophies:', error);\n    }\n  };\n  \n  const handleClearInventory = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear inventory.');\n        return;\n      }\n\n      // Retain only Money and Gems in the inventory\n      const filteredInventory = currentPlayer.inventory.filter(\n        (item) => item.type === 'Money' || item.type === 'Gem'\n      );\n      console.log('Filtered inventory to retain only Money and Gems:', filteredInventory);\n\n      // Update inventory on the server\n      await axios.post(`${API_BASE}/api/update-inventory`, {\n        playerId,\n        inventory: filteredInventory,\n        backpack: currentPlayer.backpack || [],\n      });\n      console.log('Inventory updated successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Force a re-fetch to confirm changes are saved\n      const updatedInventory = await fetchInventory(playerId);\n      console.log('Fetched inventory after clearing:', updatedInventory);\n\n      // Update the local state for inventory\n      setInventory(updatedInventory);\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        inventory: updatedInventory,\n      }));\n      updateStatus(900);\n      console.log('Inventory cleared successfully except for Money.');\n    } catch (error) {\n      console.error('Error clearing inventory:', error);\n    }\n  };\n\n  const handleClearSkillsAndPowers = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear skills and powers.');\n        return;\n      }\n\n      // Clear skills\n      const clearedSkills = [];\n      console.log('Clearing all skills.');\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId,\n        skills: clearedSkills,\n      });\n      console.log('Skills cleared successfully on the server.');\n\n      // Clear powers\n      const clearedPowers = [];\n      console.log('Clearing all powers.');\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId,\n        powers: clearedPowers,\n      });\n      console.log('Powers cleared successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Update the local state for skills and powers\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        skills: clearedSkills,\n        powers: clearedPowers,\n      }));\n      updateStatus(905);\n      console.log('Skills and powers cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing skills and powers:', error);\n    }\n  };\n  \n  const handleClearQuestHistory = async () => {\n    try {\n        const playerId = currentPlayer?.playerId;\n        if (!playerId) {\n            console.error('No player logged in. Cannot clear quest history.');\n            return;\n        }\n\n        // Make the API request to clear both activeQuests and completedQuests\n        await axios.post(`${API_BASE}/api/clear-quest-history`, { playerId });\n\n        // Update the `currentPlayer` state to reflect changes\n        const updatedPlayer = { \n            ...currentPlayer, \n            activeQuests: [], \n            completedQuests: [] \n        };\n        setCurrentPlayer(updatedPlayer);\n\n        console.log('Quest history cleared successfully.');\n        updateStatus(901); // Update with a debug-specific status code\n\n    } catch (error) {\n        console.error('Error clearing quest history:', error);\n    }\n  };\n\n  const handleClearTradeStall = async () => {\n    try {\n      const username = currentPlayer?.username;\n      if (!username) {\n        console.error('No user logged in. Cannot clear Trade Stall.');\n        return;\n      }\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        username,\n        tradeStall: [], // Clear the trade stall\n      });\n\n      console.log('Trade Stall cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing Trade Stall:', error);\n    }\n  };\n\n  const handleWelcomeMessage = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId,\n        messageId: 1, // Assuming 1 is the Welcome message ID\n      });\n      console.log(\" Welcome message added to mailbox.\");\n      updateStatus(\" Welcome message delivered.\");\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n      updateStatus(\" Failed to deliver welcome message.\");\n    }\n  };\n\n  const handleRewardMessage = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId,\n        messageId: 101, \n      });\n      console.log(\" Welcome message added to mailbox.\");\n      updateStatus(\" Welcome message delivered.\");\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n      updateStatus(\" Failed to deliver welcome message.\");\n    }\n  };\n\n  const sendMessageToAll = async (messageId) => {\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message-all`, {\n        messageId: messageId, // Send to all players\n      });\n      console.log(` Message ${messageId} added to mailbox for all users.`);\n      updateStatus(` Message ${messageId} delivered to all users.`);\n      // Optionally refresh current player\n      if (currentPlayer?.playerId) {\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      }\n    } catch (mailError) {\n      console.error(` Failed to send message ${messageId}:`, mailError);\n      updateStatus(` Failed to deliver message ${messageId}.`);\n    }\n  };\n  \n  const handleClearGridState = async (command) => {\n    switch (command) {\n      case 'cleargrid':\n        if (NPCsInGridManager.clearGridState(currentGridId)) {\n          updateStatus('Grid state cleared successfully');\n          // Clear from localStorage if you're using it\n          localStorage.removeItem(`NPCsInGrid_${currentGridId}`);\n        } else {\n          updateStatus('Failed to clear grid state');\n        }\n        break;\n\n      // Add other debug commands here\n      default:\n        console.warn(`Unknown debug command: ${command}`);\n    }\n  };\n\n  // Add Reset Combat Stats handler\n  const handleResetCombatStats = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot reset combat stats.');\n        return;\n      }\n\n      const combatStats = {\n        maxhp: currentPlayer.baseMaxhp,\n        attackbonus: currentPlayer.baseAttackbonus,\n        armorclass: currentPlayer.baseArmorclass,\n        damage: currentPlayer.baseDamage,\n        attackrange: currentPlayer.baseAttackrange,\n        speed: currentPlayer.baseSpeed,\n      };\n\n      await playersInGridManager.updatePC(currentGridId, playerId, combatStats);\n\n      console.log('Combat stats reset successfully using updatePC.');\n      updateStatus(906); // Optional: new debug status\n    } catch (error) {\n      console.error('Error resetting combat stats:', error);\n    }\n  };\n\n  const handleCreateNewFrontier = async () => {\n    try {\n      const response = await axios.post(`${API_BASE}/api/create-frontier`);\n      console.log('Create New Frontier response:', response.data);\n      alert('New Frontier created successfully!');\n    } catch (error) {\n      console.error('Error creating new Frontier:', error);\n      alert('Failed to create new Frontier. Check console for details.');\n    }\n  };\n\n  const handleGenerateTown = async () => {\n    try { await generateTownGrids({ currentPlayer }); } catch (error) {\n      console.error('Error generating town:', error);\n      alert('Failed to generate town. Check console for details.');\n    }\n  };\n\n  const handleGenerateValley = async (valleyType) => {\n    try { await generateValleyGrids({ valleyType, currentPlayer }); } catch (error) {\n      console.error(`Error generating valley${valleyType} grids:`, error);\n      alert(`Failed to generate valley${valleyType} grids. Check the console for details.`);\n    }\n  };\n\n  const handleDeleteAccount = async (username) => {\n    // Accept either {username} or username string for backward compatibility\n    if (typeof username === \"object\" && username?.username) {\n      username = username.username;\n    }\n    if (!username) {\n      alert(\"Please enter a username.\");\n      return;\n    }\n\n    try {\n      // Step 1: Look up the player by username\n      const lookupResponse = await axios.get(`${API_BASE}/api/get-player-by-username/${username}`);\n      const player = lookupResponse.data;\n\n      if (!player || !player._id) {\n        alert(`Player not found for username: ${username}`);\n        return;\n      }\n\n      const confirmed = window.confirm(`Are you sure you want to delete the account for \"${username}\"? This cannot be undone.`);\n      if (!confirmed) return;\n\n      // Step 2: Delete the player by ID\n      const deleteResponse = await axios.post(`${API_BASE}/api/delete-player`, {\n        playerId: player._id,\n      });\n\n      if (deleteResponse.data.success) {\n        alert(` Account for \"${username}\" deleted successfully.`);\n        console.log(` Account deleted for username: ${username}`);\n      } else {\n        alert(\" Failed to delete account. See console for details.\");\n        console.error(\"Delete failed:\", deleteResponse.data);\n      }\n    } catch (error) {\n      console.error(\" Error deleting account:\", error);\n      alert(\"An error occurred while trying to delete the account.\");\n    }\n  };\n\n  const handleTeleport = async (gridCoord) => {\n    if (!gridCoord || typeof gridCoord !== 'number' || isNaN(gridCoord)) {\n      console.error(' Invalid gridCoord passed to handleTeleport:', gridCoord);\n      updateStatus(' Invalid grid selected for teleport.');\n      return;\n    }\n\n    // Extract settlement row and col from the 4th and 5th digits\n    const coordStr = String(gridCoord).padStart(7, '0'); // Ensure string is long enough\n    const row = parseInt(coordStr[3], 10); // 4th digit\n    const col = parseInt(coordStr[4], 10); // 5th digit\n\n    console.log(` Parsed gridCoord ${gridCoord}  row=${row}, col=${col}`);\n\n    try {\n      // 1. Call backend to get settlement data\n      const response = await axios.get(`${API_BASE}/api/get-settlement-by-coords/${row}/${col}`);\n      const settlement = response.data;\n\n      if (!settlement || !settlement.grids || settlement.grids.length === 0) {\n        console.warn('No settlement or empty grids array found.');\n        updateStatus(' Settlement data not found.');\n        return;\n      }\n\n      // 2. Search through grids to find the matching gridCoord\n      let matchingGridObj = null;\n      for (const row of settlement.grids) {\n        for (const cell of row) {\n          if (cell.gridCoord === gridCoord) {\n            matchingGridObj = cell;\n            break;\n          }\n        }\n        if (matchingGridObj) break;\n      }\n\n      if (!matchingGridObj) {\n        console.warn(`GridCoord ${gridCoord} not found in settlement.`);\n        updateStatus(' Grid not found in settlement.');\n        return;\n      }\n\n      // 3. Build toLocation using found grid data\n      const fromLocation = currentPlayer.location;\n      const toLocation = {\n        x: 0,\n        y: 0,\n        g: matchingGridObj.gridId,\n        s: settlement._id,\n        f: currentPlayer.location.f,\n        gtype: matchingGridObj.gridType,\n        gridCoord: gridCoord,\n      };\n\n      // 4. Call changePlayerLocation\n      changePlayerLocation(\n        currentPlayer,\n        fromLocation,\n        toLocation,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        setResources,\n        TILE_SIZE,\n        closeAllPanels,\n        updateStatus,\n        null, // bulkOperationContext not available\n        null, // masterResources not available\n        null, // strings not available\n        null  // masterTrophies not available\n      );\n    } catch (error) {\n      console.error('Error during teleport:', error);\n      updateStatus(' Teleport failed due to error.');\n    }\n  };\n\n\n  const handleResetFTUE = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n\n    try {\n      // Update player document on DB: player.firsttimeuser = true\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates: { firsttimeuser: true, ftuestep: 1 }, \n      });\n      \n      if (response.data.success) {\n        // Update in the local storage as well\n        const updatedPlayer = {\n          ...currentPlayer,\n          firsttimeuser: true,\n          ftuestep: 1, \n        };\n        localStorage.setItem('player', JSON.stringify(updatedPlayer));\n        \n        console.log(' FTUE reset successfully.');\n        updateStatus(' FTUE reset. Refreshing page...');\n        \n        // Refresh the window after a short delay\n        setTimeout(() => {\n          window.location.reload();\n        }, 1000);\n      } else {\n        console.error(' Failed to reset FTUE:', response.data.error);\n        updateStatus(' Failed to reset FTUE.');\n      }\n    } catch (error) {\n      console.error(' Error resetting FTUE:', error);\n      updateStatus(' Error resetting FTUE.');\n    }\n  };\n\n  const handleRemoveHomestead = async () => {\n    if (!currentGridId) {\n      console.error(' No grid ID available.');\n      updateStatus(' No grid ID available.');\n      return;\n    }\n\n    // Check if this is actually a homestead\n    const gridType = currentPlayer?.location?.gtype;\n    if (gridType !== 'homestead') {\n      alert(' This command only works on homestead grids.');\n      return;\n    }\n\n    const confirmed = window.confirm(\n      ` Are you absolutely sure you want to remove this homestead grid?\\n\\n` +\n      `Grid ID: ${currentGridId}\\n\\n` +\n      `This will:\\n` +\n      `1. Delete this grid from the database\\n` +\n      `2. Mark this location as available in the settlement\\n\\n` +\n      `This action CANNOT be undone!`\n    );\n\n    if (!confirmed) return;\n\n    try {\n      console.log(' Removing homestead grid:', currentGridId);\n      \n      const response = await axios.post(`${API_BASE}/api/remove-homestead`, {\n        gridId: currentGridId\n      });\n\n      if (response.data.success) {\n        console.log(' Homestead removed successfully');\n        updateStatus(' Homestead removed. Players relocated. Reloading...');\n        \n        // The server has relocated all players using relocateOnePlayerHome\n        // Just reload the page to reflect the new state\n        setTimeout(() => {\n          window.location.reload();\n        }, 1500);\n      } else {\n        console.error(' Failed to remove homestead:', response.data);\n        updateStatus(' Failed to remove homestead.');\n      }\n    } catch (error) {\n      console.error(' Error removing homestead:', error);\n      updateStatus(' Error removing homestead.');\n      alert('Failed to remove homestead. Check console for details.');\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} titleKey=\"1120\" panelName=\"DebugPanel\">\n      {/* Performance Metrics Section */}\n      <div style={{ \n        backgroundColor: '#f0f0f0', \n        padding: '10px', \n        marginBottom: '15px', \n        borderRadius: '5px',\n        fontFamily: 'monospace',\n        fontSize: '12px'\n      }}>\n        <h3 style={{ margin: '0 0 10px 0', color: '#333' }}> Performance Metrics</h3>\n        \n        {/* Canvas Tiles Toggle Button */}\n        <div style={{ marginBottom: '10px' }}>\n          <button \n            className=\"btn-basic btn-neutral\"\n            onClick={() => setUseCanvasTiles(!useCanvasTiles)}\n            style={{ fontSize: '12px', padding: '5px 10px' }}\n          >\n            {useCanvasTiles ? ' Switch to DOM Tiles' : ' Switch to Canvas Tiles'}\n          </button>\n        </div>\n        \n        {/* SVG Resources Toggle Button */}\n        <div style={{ marginBottom: '10px' }}>\n          <button \n            className={`btn-basic ${currentPlayer?.settings?.renderSVGResources ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => {\n              const newValue = !currentPlayer?.settings?.renderSVGResources;\n              const newSettings = {\n                ...currentPlayer?.settings,\n                renderSVGResources: newValue\n              };\n              updatePlayerSettings(newSettings, currentPlayer, setCurrentPlayer);\n            }}\n            style={{ fontSize: '12px', padding: '5px 10px' }}\n          >\n            {currentPlayer?.settings?.renderSVGResources ? ' Switch to DOM Resources' : ' Switch to SVG Resources'}\n          </button>\n        </div>\n        \n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>\n          <div>\n            <strong>FPS:</strong> <span style={{ color: performanceMetrics.fps >= 30 ? 'green' : performanceMetrics.fps >= 15 ? 'orange' : 'red' }}>\n              {performanceMetrics.fps}\n            </span>\n          </div>\n          <div>\n            <strong>Render Mode:</strong> <span style={{ color: performanceMetrics.renderMode === 'Canvas' ? 'green' : 'blue' }}>\n              {performanceMetrics.renderMode}\n            </span>\n          </div>\n          <div>\n            <strong>DOM Elements:</strong> {performanceMetrics.domElementCount.toLocaleString()}\n          </div>\n          {performanceMetrics.memoryUsage > 0 && (\n            <div>\n              <strong>Memory:</strong> {performanceMetrics.memoryUsage} MB\n            </div>\n          )}\n        </div>\n      </div>\n      \n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleCreateNewFrontier}> Create New Frontier </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleResetGrid}> Reset This Grid </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleRemoveHomestead}> Remove Homestead </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleGenerateTown}> Generate Town </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={() => handleGenerateValley(0)}> Generate Valley 0 </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={() => handleGenerateValley(1)}> Generate Valley 1 </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={() => handleGenerateValley(2)}> Generate Valley 2 </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={() => handleGenerateValley(3)}> Generate Valley 3 </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearInventory}> Clear Inventory </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearSkillsAndPowers}> Clear Skills & Powers </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleResetCombatStats}> Reset Combat Stats </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearQuestHistory}> Clear Quest History </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearGridState}> Clear Grid State </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearTradeStall}> Clear Trade Stall </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearTrophies}> Clear Trophies </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleResetFTUE}> Reset FTUE </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleWelcomeMessage}> Resend Welcome Message </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleRewardMessage}> Resend Reward Message </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleAddMoney}> Add Money </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleGetRich}> Get Rich </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleGetSkills}> Get Skills </button>\n      </div>\n\n        <h3>Create Single Valley Grid</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter GridCoord\"\n          value={singleGridCoord}\n          onChange={(e) => setSingleGridCoord(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const settlementId = currentPlayer?.location?.s;\n              const frontierId = currentPlayer?.location?.f;\n              const gridType = currentPlayer?.location?.gtype || 'valley0';\n              if (!singleGridCoord || !settlementId || !frontierId) {\n                alert(\"Missing gridCoord, settlementId, or frontierId.\");\n                return;\n              }\n              try {\n                await createSingleValleyGrid({\n                  gridCoord: singleGridCoord,\n                });\n              } catch (error) {\n                console.error(\"Error creating single valley grid:\", error);\n                alert(\"Failed to create valley grid. See console for details.\");\n              }\n            }}\n          >\n            Create Grid\n          </button>\n        </div>\n\n        <h3>Teleport to Another Grid</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Username\"\n          value={toGridCoord}\n          onChange={(e) => setToGridCoord(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              try {\n                const parsedCoord = parseInt(toGridCoord, 10);\n                if (isNaN(parsedCoord)) {\n                  alert(\"Invalid gridCoord (not a number).\");\n                  return;\n                }\n                await handleTeleport(parsedCoord);\n              } catch (error) {\n                console.error(\"Error teleporting:\", error);\n                alert(\"Failed to teleport.\");\n              }\n            }}\n          >\n            Teleport\n          </button>\n        </div>\n        \n\n        <h3>Delete User Account</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Username\"\n          value={usernameToDelete}\n          onChange={(e) => setUsernameToDelete(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const confirmed = window.confirm(` Are you absolutely sure you want to permanently delete the account for \"${usernameToDelete}\"? This cannot be undone.`);\n              if (!confirmed) return;\n\n              try {\n                await handleDeleteAccount({\n                  username: usernameToDelete,\n                });\n              } catch (error) {\n                console.error(\"Error deleting user account:\", error);\n                alert(\"Failed to delete user account. See console for details.\");\n              }\n            }}\n          >\n            Delete\n          </button>\n        </div>\n        \n\n        <h3>Send Message to All Users</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Message ID\"\n          value={messageIdentifier}\n          onChange={(e) => setMessageIdentifier(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              if (!messageIdentifier) {\n                alert(\"Please enter a message ID.\");\n                return;\n              }\n              try {\n                await sendMessageToAll(Number(messageIdentifier));\n              } catch (error) {\n                console.error(\"Error sending message to all users:\", error);\n                alert(\"Failed to send message. See console for details.\");\n              }\n            }}\n          >\n            Send Message\n          </button>\n        </div>\n\n    <br />\n    <h3>FTUE Step: {currentPlayer?.ftuestep || \"Not set\"}</h3>\n    <h3>Warehouse Level: {currentPlayer?.warehouseLevel ?? 0}</h3>\n\n      <div className=\"debug-timers\">\n        <h3> Active Timers:</h3>\n        {timers.length > 0 ? (\n          <ul>\n            {timers.map((res, index) => (\n              <li key={index}>\n                {res.type} at ({res.x}, {res.y}) - \n                {res.growEnd ? `  Farming Timer Ends in ${res.remainingTime}s` : \"\"}\n                {res.craftedItem ? `  ${res.craftedItem}: ` : \"\"}\n                {res.craftEnd ? ` Ends in ${res.remainingTime}s` : \"\"}\n              </li>\n            ))}\n          </ul>\n        ) : (\n          <p>No active timers.</p>\n        )}\n      </div>\n          \n    <GridStateDebugPanel\n      gridId={currentGridId}\n      gridCoord={currentPlayer?.location?.gridCoord}\n      gridType={currentPlayer?.location?.gtype}\n      settlementId={currentPlayer?.location?.s}\n      NPCsInGrid={{ [currentGridId]: NPCsInGridManager.getNPCsInGrid(currentGridId) }}\n      playersInGrid={{ [currentGridId]: playersInGridManager.getPlayersInGrid(currentGridId) }}\n    />\n\n    </Panel>\n  );\n};\n\nexport default DebugPanel;","import API_BASE from '../config';\nimport axios from 'axios';\n\n\nexport async function generateTownGrids ({ currentPlayer })\n    {\n    try {\n      const settlementId = currentPlayer.location.s;\n      if (!settlementId) {\n        console.error('No settlement ID found for the current player.');\n        alert('No settlement ID found for the current player.');\n        return;\n      }\n  \n      // Fetch the settlement data\n      const response = await axios.get(\n        `${API_BASE}/api/get-settlement/${settlementId}`\n      );\n  \n      const settlement = response.data;\n      if (!settlement || !settlement.grids || settlement.grids.length === 0) {\n        console.error('Settlement data is incomplete or missing grids.');\n        alert('Settlement data is incomplete or missing grids.');\n        return;\n      }\n  \n      // Find all uninitialized town grids by looking for gridType === 'town' but no gridId\n      const townGrids = [];\n      settlement.grids.forEach((row) => {\n        row.forEach((grid) => {\n          if (grid.gridType === 'town' && !grid.gridId) {\n            // Instead of placeholderName, push the gridCoord\n            townGrids.push(grid.gridCoord);\n          }\n        });\n      });\n  \n      if (townGrids.length === 0) {\n        console.log('No uninitialized town grids found in this settlement.');\n        alert('No uninitialized town grids found in this settlement.');\n        return;\n      }\n  \n      console.log(`Found ${townGrids.length} uninitialized town grids. Processing grids...`);\n  \n      // Generate/create each town grid by passing gridCoord\n      for (const gridCoord of townGrids) {\n        try {\n          console.log(`Creating Town grid with gridCoord: ${gridCoord}`);\n  \n          const result = await axios.post(`${API_BASE}/api/create-grid`, {\n            gridCoord,             // instead of placeholderName\n            gridType: 'town',\n            settlementId,\n            frontierId: settlement.frontierId,\n          });\n  \n          console.log(`Processed town grid for gridCoord: ${gridCoord}`, result.data);\n  \n        } catch (gridError) {\n          console.error(`Failed to process grid for gridCoord: ${gridCoord}`, gridError);\n        }\n      }\n  \n      alert('Town grids created successfully!');\n    } catch (error) {\n      console.error('Error processing town grids:', error);\n      alert('Failed to create town grids. Check the console for details.');\n    }\n  };\n\n\n\n\nexport async function generateValleyGrids({ valleyType, currentPlayer }) {\n    try {\n      const frontierId = currentPlayer?.location?.f;\n      if (!frontierId) {\n        console.error(\"No frontier ID found for the current player.\");\n        alert(\"No frontier ID found for the current player.\");\n        return;\n      }\n      console.log(`Fetching frontier data for ID: ${frontierId}`);\n      const frontierResponse = await axios.get(`${API_BASE}/api/get-frontier/${frontierId}`);\n      const frontierData = frontierResponse.data;\n      if (!frontierData || !frontierData.settlements) {\n        console.error(\"Frontier data is incomplete or missing settlements.\");\n        alert(\"Frontier data is incomplete or missing settlements.\");\n        return;\n      }\n      console.log(`Searching settlements for valley${valleyType} grids.`);\n      const valleyGrids = [];\n  \n      // 1) For each settlement in the frontier, fetch its data\n      for (const settlementRow of frontierData.settlements) {\n        for (const settlement of settlementRow) {\n          if (!settlement?.settlementId) {\n            console.warn(\"Settlement is invalid or missing settlementId. Skipping.\");\n            continue;\n          }\n          try {\n            console.log(\"Fetching settlement data for settlement ID:\", settlement.settlementId);\n            const settlementResponse = await axios.get(\n              `${API_BASE}/api/get-settlement/${settlement.settlementId}`\n            );\n            const settlementData = settlementResponse.data;\n  \n            if (!settlementData?.grids) {\n              console.warn(`Settlement ${settlement.settlementId} has no grids. Skipping.`);\n              continue;\n            }\n            // 2) Find all uninitialized valleyX sub-grids (i.e., same valleyType, no gridId)\n            settlementData.grids.flat().forEach((grid) => {\n              if (grid.gridType === `valley${valleyType}` && !grid.gridId) {\n                valleyGrids.push({\n                  ...grid,\n                  settlementId: settlement.settlementId,\n                });\n              }\n            });\n          } catch (error) {\n            console.error(`Failed to fetch data for settlement ${settlement.settlementId}:`, error);\n          }\n        }\n      }\n  \n      if (valleyGrids.length === 0) {\n        console.log(`No valley${valleyType} grids found in this frontier.`);\n        alert(`No valley${valleyType} grids found in this frontier.`);\n        return;\n      }\n  \n      console.log(`Found ${valleyGrids.length} valley${valleyType} grids. Starting generation process.`);\n  \n      // 3) Create each valley grid via /create-grid, sending gridCoord instead of placeholderName\n      for (const valleyGrid of valleyGrids) {\n        try {\n          console.log(\n            `Creating valley${valleyType} grid with gridCoord: ${valleyGrid.gridCoord}, Settlement ID: ${valleyGrid.settlementId}`\n          );\n  \n          await axios.post(`${API_BASE}/api/create-grid`, {\n            gridCoord: valleyGrid.gridCoord,\n            gridType: valleyGrid.gridType, // 'valley0', 'valley1', 'valley2', or 'valley3'\n            settlementId: valleyGrid.settlementId,\n            frontierId: frontierId,\n          });\n  \n          console.log(`Successfully created valley${valleyType} grid for gridCoord: ${valleyGrid.gridCoord}`);\n        } catch (error) {\n          console.error(\n            `Error creating valley${valleyType} grid with gridCoord ${valleyGrid.gridCoord}:`,\n            error\n          );\n        }\n      }\n  \n      alert(`Valley${valleyType} grids processed successfully!`);\n    } catch (error) {\n      console.error(`Error processing valley${valleyType} grids:`, error);\n      alert(`Failed to process valley${valleyType} grids. Check the console for details.`);\n    }\n  };\n\n\nexport async function createSingleValleyGrid({ gridCoord }) {\n  try {\n    console.log(\" Fetching all settlements to determine gridType for gridCoord:\", gridCoord);\n    const settlementsResponse = await axios.get(`${API_BASE}/api/settlements`);\n    const settlements = settlementsResponse.data;\n\n    if (!settlements || settlements.length === 0) {\n      throw new Error(\"No settlements returned from the server\");\n    }\n\n    let foundGrid = null;\n    let foundSettlementId = null;\n    let foundFrontierId = null;\n\n    for (const settlement of settlements) {\n      if (!settlement.grids) continue;\n\n      for (const row of settlement.grids) {\n        for (const grid of row) {\n          console.log(` Checking gridCoord ${grid.gridCoord} (type: ${typeof grid.gridCoord}) against input ${gridCoord}`);\n          if (String(grid.gridCoord) === String(gridCoord)) {\n            foundGrid = grid;\n            foundSettlementId = settlement._id;\n            foundFrontierId = settlement.frontierId;\n            break;\n          }\n        }\n        if (foundGrid) break;\n      }\n      if (foundGrid) break;\n    }\n\n    if (!foundGrid) {\n      console.warn(` GridCoord ${gridCoord} not found in any settlement.`);\n      alert(\"GridCoord not found in any settlement data.\");\n      return;\n    }\n\n    const payload = {\n      gridCoord,\n      gridType: foundGrid.gridType,\n      settlementId: foundSettlementId,\n      frontierId: foundFrontierId,\n    };\n\n    console.log(\" Sending grid creation request with:\", payload);\n\n    const response = await axios.post(`${API_BASE}/api/create-grid`, payload);\n\n    console.log(` Grid created: ${gridCoord}`, response.data);\n    alert(`Grid ${gridCoord} created successfully!`);\n  } catch (error) {\n    console.error(` Failed to create grid ${gridCoord}:`, error);\n    alert(`Failed to create grid ${gridCoord}. See console for details.`);\n  }\n}","import React, { useState, useMemo } from 'react';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { useStrings } from '../../UI/StringsContext';\nimport { isCurrency } from '../../Utils/InventoryManagement';\nimport './ManageContentsModal.css';\n\nconst ManageContentsModal = ({\n  inventory,\n  masterResources,\n  showActions = false,\n  warehouseAmounts,\n  setWarehouseAmounts,\n  handleAmountChange,\n  handleDiscardWarehouseItem,\n  strings: passedStrings\n}) => {\n  const contextStrings = useStrings();\n  const strings = passedStrings || contextStrings;\n  const [sortField, setSortField] = useState('name');\n  const [sortDirection, setSortDirection] = useState('asc');\n\n  // Sort inventory data\n  const sortedInventory = useMemo(() => {\n    const filtered = inventory.filter(item => !isCurrency(item.type));\n    \n    return filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortField) {\n        case 'name':\n          aValue = getLocalizedString(a.type, strings).toLowerCase();\n          bValue = getLocalizedString(b.type, strings).toLowerCase();\n          break;\n        case 'quantity':\n          aValue = a.quantity;\n          bValue = b.quantity;\n          break;\n        default:\n          return 0;\n      }\n      \n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [inventory, strings, sortField, sortDirection]);\n\n  const handleSort = (field) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (field) => {\n    if (sortField !== field) return '';\n    return sortDirection === 'asc' ? '' : '';\n  };\n\n  if (sortedInventory.length === 0) {\n    return <p>{strings[76]}</p>;\n  }\n\n  return (\n    <div className=\"manage-contents-container\">\n      <div className=\"manage-contents-header\">\n        <table>\n          <thead>\n            <tr>\n              <th onClick={() => handleSort('name')} className=\"sortable-header\">\n                {strings[191] || \"Item\"} {getSortIcon('name')}\n              </th>\n              <th onClick={() => handleSort('quantity')} className=\"sortable-header\">\n                {strings[185] || \"Quantity\"} {getSortIcon('quantity')}\n              </th>\n              {showActions && (\n                <>\n                  <th>{strings[186] || \"Amount\"}</th>\n                  <th>{strings[192] || \"Action\"}</th>\n                </>\n              )}\n            </tr>\n          </thead>\n        </table>\n      </div>\n      \n      <div className=\"manage-contents-scroll\">\n        <table>\n          <tbody>\n            {sortedInventory.map((item, index) => (\n              <tr key={index}>\n                <td>\n                  {masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}\n                </td>\n                <td>{item.quantity.toLocaleString()}</td>\n                {showActions && (\n                  <>\n                    <td>\n                      <div className=\"amount-input\">\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, (warehouseAmounts[item.type] || 0) - 1, item.quantity)\n                          }\n                          disabled={(warehouseAmounts[item.type] || 0) <= 0}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"number\"\n                          value={warehouseAmounts[item.type] || 0}\n                          onChange={(e) =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, parseInt(e.target.value, 10) || 0, item.quantity)\n                          }\n                        />\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, (warehouseAmounts[item.type] || 0) + 1, item.quantity)\n                          }\n                          disabled={(warehouseAmounts[item.type] || 0) >= item.quantity}\n                        >\n                          +\n                        </button>\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, item.quantity, item.quantity)\n                          }\n                          style={{ marginLeft: '4px' }}\n                        >\n                          {strings[165]}\n                        </button>\n                      </div>\n                    </td>\n                    <td>\n                      <button\n                        className=\"add-button\"\n                        onClick={() => handleDiscardWarehouseItem(item)}\n                        disabled={!(warehouseAmounts[item.type] > 0 && warehouseAmounts[item.type] <= item.quantity)}\n                      >\n                        {strings[188]}\n                      </button>\n                    </td>\n                  </>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default ManageContentsModal;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport '../../UI/Panel.css';\nimport '../../UI/SharedButtons.css';\nimport './InventoryPanel.css'; \nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { deriveWarehouseAndBackpackCapacity, isCurrency } from '../../Utils/InventoryManagement';\nimport { handlePurchase } from '../../Store/Store';\nimport ManageContentsModal from './ManageContentsModal';\n\nfunction InventoryPanel({ onClose, masterResources, globalTuning, currentPlayer, setCurrentPlayer, setInventory, setBackpack, updateStatus, openPanel, setActiveStation, setModalContent, setIsModalOpen }) {\n\n    const strings = useStrings();\n    const inventory = currentPlayer?.inventory || [];\n    const backpack = currentPlayer?.backpack || [];\n    const baseWarehouseCapacity = currentPlayer?.warehouseCapacity || 0;\n    const baseBackpackCapacity = currentPlayer?.backpackCapacity || 0;\n    const [showBackpackModal, setShowBackpackModal] = useState(false);\n    const [showWarehouseModal, setShowWarehouseModal] = useState(false);\n    const [inventorySortField, setInventorySortField] = useState('name');\n    const [inventorySortDirection, setInventorySortDirection] = useState('asc');\n    const [backpackSortField, setBackpackSortField] = useState('name');\n    const [backpackSortDirection, setBackpackSortDirection] = useState('asc');\n    const [backpackAmounts, setBackpackAmounts] = useState({}); // Store amounts per resource for backpack\n    const [warehouseAmounts, setWarehouseAmounts] = useState({}); // Store amounts per resource for warehouse\n    const hasBackpackSkill = currentPlayer?.skills?.some(item => item.type === 'Backpack');\n    const finalCapacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n    \n    // Get Gold bonuses from globalTuning prop\n    const warehouseGoldBonus = globalTuning?.warehouseCapacityGold || 100000;\n    const backpackGoldBonus = globalTuning?.backpackCapacityGold || 5000;\n    \n    const calculateTotalQuantity = (inventory) =>\n        inventory.filter((item) => !isCurrency(item.type)).reduce((total, item) => total + item.quantity, 0);\n    \n    // Inventory sorting functions\n    const handleInventorySort = (field) => {\n        if (inventorySortField === field) {\n            setInventorySortDirection(inventorySortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setInventorySortField(field);\n            setInventorySortDirection('asc');\n        }\n    };\n\n    const getInventorySortIcon = (field) => {\n        if (inventorySortField !== field) return '';\n        return inventorySortDirection === 'asc' ? '' : '';\n    };\n\n    const getSortedInventory = () => {\n        const filtered = inventory.filter(item => !isCurrency(item.type));\n        \n        return filtered.sort((a, b) => {\n            let aValue, bValue;\n            \n            switch (inventorySortField) {\n                case 'name':\n                    aValue = getLocalizedString(a.type, strings).toLowerCase();\n                    bValue = getLocalizedString(b.type, strings).toLowerCase();\n                    break;\n                case 'quantity':\n                    aValue = a.quantity;\n                    bValue = b.quantity;\n                    break;\n                default:\n                    return 0;\n            }\n            \n            if (aValue < bValue) return inventorySortDirection === 'asc' ? -1 : 1;\n            if (aValue > bValue) return inventorySortDirection === 'asc' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    // Backpack sorting functions\n    const handleBackpackSort = (field) => {\n        if (backpackSortField === field) {\n            setBackpackSortDirection(backpackSortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setBackpackSortField(field);\n            setBackpackSortDirection('asc');\n        }\n    };\n\n    const getBackpackSortIcon = (field) => {\n        if (backpackSortField !== field) return '';\n        return backpackSortDirection === 'asc' ? '' : '';\n    };\n\n    const getSortedBackpack = () => {\n        const filtered = backpack.filter(item => !isCurrency(item.type));\n        \n        return filtered.sort((a, b) => {\n            let aValue, bValue;\n            \n            switch (backpackSortField) {\n                case 'name':\n                    aValue = getLocalizedString(a.type, strings).toLowerCase();\n                    bValue = getLocalizedString(b.type, strings).toLowerCase();\n                    break;\n                case 'quantity':\n                    aValue = a.quantity;\n                    bValue = b.quantity;\n                    break;\n                default:\n                    return 0;\n            }\n            \n            if (aValue < bValue) return backpackSortDirection === 'asc' ? -1 : 1;\n            if (aValue > bValue) return backpackSortDirection === 'asc' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    const handleAmountChange = (amounts, setAmounts, type, value, maxValue) => {\n        const clampedValue = Math.min(Math.max(0, value), maxValue);\n        setAmounts((prev) => ({\n            ...prev,\n            [type]: clampedValue,\n        }));\n    };\n\n\n    const handleMoveItem = async (item) => {\n        const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n        const amount = backpackAmounts[item.type] || 0;\n        \n        if (amount <= 0) return;\n\n        try {\n            if (isAtHome) {\n                // Check warehouse capacity before moving\n                const currentWarehouseUsage = calculateTotalQuantity(inventory);\n                const spaceAvailable = finalCapacities.warehouse - currentWarehouseUsage;\n                \n                if (amount > spaceAvailable) {\n                    updateStatus(20); // Warehouse full message\n                    return;\n                }\n                \n                const updatedWarehouse = [...inventory];\n                const existingIndex = updatedWarehouse.findIndex(i => i.type === item.type);\n                if (existingIndex !== -1) {\n                    updatedWarehouse[existingIndex].quantity += amount;\n                } else {\n                    updatedWarehouse.push({ ...item, quantity: amount });\n                }\n\n                const updatedBackpack = backpack.map(i => {\n                    if (i.type === item.type) {\n                        const newQuantity = i.quantity - amount;\n                        return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                    }\n                    return i;\n                }).filter(Boolean);\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    inventory: updatedWarehouse,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    inventory: updatedWarehouse,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setInventory(updatedWarehouse);\n                setBackpack(updatedBackpack);\n\n                updateStatus(`Moved ${amount}x ${getLocalizedString(item.type, strings)} to warehouse`);\n            } else {\n                const updatedBackpack = backpack.map(i => {\n                    if (i.type === item.type) {\n                        const newQuantity = i.quantity - amount;\n                        return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                    }\n                    return i;\n                }).filter(Boolean);\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setBackpack(updatedBackpack);\n\n                updateStatus(` Discarded ${amount}x ${getLocalizedString(item.type, strings)}`);\n            }\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleMoveAll = async () => {\n        const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n\n        try {\n            if (isAtHome) {\n                const itemsToMove = backpack.filter((item) => item.type !== \"Tent\" && item.type !== \"Boat\");\n                \n                // Calculate total quantity to move\n                const totalToMove = itemsToMove.reduce((sum, item) => sum + item.quantity, 0);\n                const currentWarehouseUsage = calculateTotalQuantity(inventory);\n                const spaceAvailable = finalCapacities.warehouse - currentWarehouseUsage;\n                \n                if (totalToMove > spaceAvailable) {\n                    updateStatus(20); // Warehouse full message\n                    return;\n                }\n\n                const updatedWarehouseInventory = [...inventory];\n\n                itemsToMove.forEach((item) => {\n                    const existingIndex = updatedWarehouseInventory.findIndex((invItem) => invItem.type === item.type);\n                    if (existingIndex !== -1) {\n                        updatedWarehouseInventory[existingIndex].quantity += item.quantity;\n                    } else {\n                        updatedWarehouseInventory.push(item);\n                    }\n                });\n\n                const updatedBackpack = backpack.filter((item) => item.type === \"Tent\" || item.type === \"Boat\");\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    inventory: updatedWarehouseInventory,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    inventory: updatedWarehouseInventory,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setInventory(updatedWarehouseInventory);\n                setBackpack(updatedBackpack);\n\n                updateStatus(`Moved all items to warehouse`);\n            } else {\n                // When not at home, discard all items except Tent and Boat\n                const itemsToKeep = backpack.filter((item) => item.type === \"Tent\" || item.type === \"Boat\");\n                \n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    backpack: itemsToKeep,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    backpack: itemsToKeep,\n                });\n                \n                // Also update parent component's state\n                setBackpack(itemsToKeep);\n\n                updateStatus(` Discarded all items except Tent and Boat`);\n            }\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleDiscardWarehouseItem = async (item) => {\n        try {\n            const amount = warehouseAmounts[item.type] || 0;\n            \n            if (amount <= 0) return;\n            \n            const updatedWarehouse = inventory.map(i => {\n                if (i.type === item.type) {\n                    const newQuantity = i.quantity - amount;\n                    return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                }\n                return i;\n            }).filter(Boolean);\n\n            await axios.post(`${API_BASE}/api/update-inventory`, {\n                playerId: currentPlayer.playerId,\n                inventory: updatedWarehouse,\n            });\n\n            setCurrentPlayer({\n                ...currentPlayer,\n                inventory: updatedWarehouse,\n            });\n            \n            // Also update parent component's state\n            setInventory(updatedWarehouse);\n\n            updateStatus(` Discarded ${amount}x ${getLocalizedString(item.type, strings)}`);\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleDiscardAllWarehouse = async () => {\n        try {\n            await axios.post(`${API_BASE}/api/update-inventory`, {\n                playerId: currentPlayer.playerId,\n                inventory: [],\n            });\n\n            setCurrentPlayer({\n                ...currentPlayer,\n                inventory: [],\n            });\n            \n            // Also update parent component's state\n            setInventory([]);\n\n            updateStatus(` Discarded all warehouse items`);\n            setShowWarehouseModal(false);\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1001\" titleKey=\"1101\" panelName=\"InventoryPanel\">\n            \n\n            {/* CURRENCIES */}\n            <div className=\"currency-section\">\n                <div className=\"currency-display\">\n                    {/* Column 1: Money and Gems */}\n                    <div className=\"currency-column\">\n                        <div className=\"currency-item\">\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Money')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\">\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Gem')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                    </div>\n                    {/* Column 2: Hearts */}\n                    <div className=\"currency-column\">\n                        <div className=\"currency-item\">\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Yellow Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\">\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Green Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\">\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Purple Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <hr className=\"inventory-divider\" />\n\n            {/* Gold Pass info for non-Gold users */}\n            {currentPlayer.accountStatus !== 'Gold' && (\n                <>\n                    <div className=\"gold-pass-info\">\n                        {strings[199]}\n                    </div>\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%', marginBottom: '20px' }}>\n                        <button \n                            className=\"btn-basic btn-gold\"\n                            onClick={() => handlePurchase(1, currentPlayer, updateStatus)}\n                        >\n                            {strings[9061]}\n                        </button>\n                    </div>\n                </>\n            )}\n\n\n            {/* BACKPACK */}\n\n            <h3>{strings[182]}</h3>\n\n            {hasBackpackSkill ? (\n              <>\n                <div className=\"capacity-display\">\n                    {strings[183]} {calculateTotalQuantity(backpack)}/\n                    <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n                        {finalCapacities.backpack}\n                    </span>\n                    {currentPlayer?.accountStatus === \"Gold\" && (\n                        <div style={{fontSize: \"12px\", color: \"#666\", marginTop: \"2px\"}}>\n                            (+{backpackGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n                        </div>\n                    )}\n                </div>\n\n                {backpack.length > 0 && (\n                <div className=\"shared-buttons\">\n                    <button className=\"btn-basic btn-neutral\" onClick={() => setShowBackpackModal(true)}>\n                    {strings[78]}\n                    </button>\n                </div>\n                )}\n                <div className=\"backpack-table-container\" style={{height: 'auto', maxHeight: '300px'}}>\n                    {backpack.filter(item => !isCurrency(item.type)).length > 0 ? (\n                        <>\n                            <div className=\"backpack-table-header\">\n                                <table>\n                                    <thead>\n                                        <tr>\n                                            <th onClick={() => handleBackpackSort('name')} className=\"sortable-header\">\n                                                {strings[191] || \"Item\"} {getBackpackSortIcon('name')}\n                                            </th>\n                                            <th onClick={() => handleBackpackSort('quantity')} className=\"sortable-header\">\n                                                {strings[185] || \"Quantity\"} {getBackpackSortIcon('quantity')}\n                                            </th>\n                                        </tr>\n                                    </thead>\n                                </table>\n                            </div>\n                            <div className=\"backpack-table-scroll\">\n                                <table>\n                                    <tbody>\n                                        {getSortedBackpack().map((item, index) => (\n                                            <tr key={index}>\n                                                <td>{masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}</td>\n                                                <td>{item.quantity.toLocaleString()}</td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </>\n                    ) : (\n                        <p>{strings[77]}</p>\n                    )}\n                </div>\n              </>\n            ) : (\n              <div className=\"capacity-display\">{strings[75]}</div>\n            )}\n\n            <hr className=\"inventory-divider\" />\n\n            {/* WAREHOUSE */}\n\n            <h3>{strings[181]}</h3>\n\n            <div className=\"capacity-display\">\n                {strings[183]} {calculateTotalQuantity(inventory)}/\n                <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n                    {finalCapacities.warehouse}\n                </span>\n                {currentPlayer?.accountStatus === \"Gold\" && (\n                    <div style={{fontSize: \"12px\", color: \"#666\", marginTop: \"2px\"}}>\n                        (+{warehouseGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n                    </div>\n                )}\n            </div>\n\n            <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-success\" onClick={() => {\n                    onClose();\n                    setTimeout(() => {\n                        openPanel('WarehousePanel');\n                    }, 0);\n                }}>\n                {strings[194]}\n                </button>\n            </div>\n\n            {inventory.length > 0 && (\n            <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-neutral\" onClick={() => setShowWarehouseModal(true)}>\n                {strings[184]}\n                </button>\n            </div>\n            )}\n\n            {/* INGREDIENT LIST */}\n\n            <div className=\"inventory-table-container\">\n                {inventory.filter(item => !isCurrency(item.type)).length > 0 ? (\n                    <>\n                        <div className=\"inventory-table-header\">\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th onClick={() => handleInventorySort('name')} className=\"sortable-header\">\n                                            {strings[191] || \"Item\"} {getInventorySortIcon('name')}\n                                        </th>\n                                        <th onClick={() => handleInventorySort('quantity')} className=\"sortable-header\">\n                                            {strings[185] || \"Quantity\"} {getInventorySortIcon('quantity')}\n                                        </th>\n                                    </tr>\n                                </thead>\n                            </table>\n                        </div>\n                        <div className=\"inventory-table-scroll\">\n                            <table>\n                                <tbody>\n                                    {getSortedInventory().map((item, index) => (\n                                        <tr key={index}>\n                                            <td>{masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}</td>\n                                            <td>{item.quantity.toLocaleString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    </>\n                ) : (\n                    <p>{strings[76]}</p>\n                )}\n            </div>\n\n\n            {showBackpackModal && (() => {\n                const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n                const nonTentBoatItems = backpack.filter( (item) => item.type !== \"Tent\" && item.type !== \"Boat\" );\n                const isAddAllDisabled = isAtHome ? (backpack.length === 0 || nonTentBoatItems.length === 0) : \n                                        (backpack.length === 0 || nonTentBoatItems.length === 0);\n                return (\n                    <div className=\"inventory-modal\">\n                        <button className=\"close-button\" onClick={() => setShowBackpackModal(false)}></button>\n                        <h2>{isAtHome ? strings[187] : strings[193]}</h2>\n\n                        <div className=\"inventory-modal-scroll\">\n                        <table>\n                            <thead>\n                                <tr>\n                                    <th>{strings[191]}</th>\n                                    <th>{strings[185]}</th>\n                                    <th>{strings[186]}</th>\n                                    <th>{strings[192]}</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {backpack.map((item) => {\n                                    const isTentAtHome = isAtHome && item.type === \"Tent\";\n                                    const isBoatAtHome = isAtHome && item.type === \"Boat\";\n                                    const isTentOrBoatNotHome = !isAtHome && (item.type === \"Tent\" || item.type === \"Boat\");\n\n                                    return (\n                                        <tr key={item.type}>\n                                            <td>{masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}</td>\n                                            <td>{item.quantity.toLocaleString()}</td>\n                                            <td>\n                                                <div className=\"amount-input\">\n                                                    <button\n                                                        onClick={() =>\n                                                            handleAmountChange(backpackAmounts, setBackpackAmounts, item.type, (backpackAmounts[item.type] || 0) - 1, item.quantity)\n                                                        }\n                                                        disabled={(backpackAmounts[item.type] || 0) <= 0}\n                                                    >\n                                                        -\n                                                    </button>\n                                                    <input\n                                                        type=\"number\"\n                                                        value={backpackAmounts[item.type] || 0}\n                                                        onChange={(e) =>\n                                                            handleAmountChange(backpackAmounts, setBackpackAmounts, item.type, parseInt(e.target.value, 10) || 0, item.quantity)\n                                                        }\n                                                    />\n                                                    <button\n                                                        onClick={() =>\n                                                            handleAmountChange(backpackAmounts, setBackpackAmounts, item.type, (backpackAmounts[item.type] || 0) + 1, item.quantity)\n                                                        }\n                                                        disabled={(backpackAmounts[item.type] || 0) >= item.quantity}\n                                                    >\n                                                        +\n                                                    </button>\n                                                    <button\n                                                        onClick={() =>\n                                                            handleAmountChange(backpackAmounts, setBackpackAmounts, item.type, item.quantity, item.quantity)\n                                                        }\n                                                        style={{ marginLeft: '4px' }}\n                                                    >\n                                                        {strings[165]}\n                                                    </button>\n                                                </div>\n                                            </td>\n                                            <td>\n                                                <button\n                                                    className=\"btn-basic add-button\"\n                                                    onClick={() => handleMoveItem(item)}\n                                                    disabled={isTentAtHome || isBoatAtHome || isTentOrBoatNotHome || !(backpackAmounts[item.type] > 0 && backpackAmounts[item.type] <= item.quantity)}\n                                                >\n                                                    {isAtHome ? strings[187] : strings[188]}\n                                                </button>\n                                            </td>\n                                        </tr>\n                                    );\n                                })}\n                            </tbody>\n                        </table>\n\n                        <button \n                            className=\"btn-basic sell-button\" \n                            onClick={handleMoveAll} \n                            disabled={isAddAllDisabled}\n                        >\n                            {isAtHome ? strings[189] : strings[190]}\n                        </button>\n                        </div>\n                    </div>\n                );\n            })()}\n\n            {showWarehouseModal && (\n                <div className=\"inventory-modal\">\n                    <button className=\"close-button\" onClick={() => setShowWarehouseModal(false)}></button>\n                    <h2>{strings[193]}</h2>\n\n                    <ManageContentsModal\n                        inventory={inventory}\n                        masterResources={masterResources}\n                        showActions={true}\n                        warehouseAmounts={warehouseAmounts}\n                        setWarehouseAmounts={setWarehouseAmounts}\n                        handleAmountChange={handleAmountChange}\n                        handleDiscardWarehouseItem={handleDiscardWarehouseItem}\n                        strings={strings}\n                    />\n\n                    <button \n                        className=\"sell-button\" \n                        onClick={() => {\n                            setModalContent({\n                                title: \"Are you sure?\",\n                                message: \"This will permanently discard ALL items in your warehouse!\",\n                                message2: \"This action cannot be undone.\",\n                                custom: (\n                                    <div className=\"shared-buttons\" style={{ marginTop: '20px' }}>\n                                        <button \n                                            className=\"btn-basic btn-danger\" \n                                            onClick={() => {\n                                                handleDiscardAllWarehouse();\n                                                setIsModalOpen(false);\n                                            }}\n                                        >\n                                            Yes, Discard All\n                                        </button>\n                                        <button \n                                            className=\"btn-basic btn-success\" \n                                            onClick={() => setIsModalOpen(false)}\n                                            style={{ marginLeft: '10px' }}\n                                        >\n                                            Cancel\n                                        </button>\n                                    </div>\n                                )\n                            });\n                            setIsModalOpen(true);\n                        }}\n                    >\n                        {strings[190]}\n                    </button>\n                </div>\n            )}\n        </Panel>\n    );\n}\n\nexport default InventoryPanel;","import React from 'react';\nimport { getLocalizedString } from '../Utils/stringLookup';\nimport { calculateGemSpeedupCost } from './EconomyUtils';\nimport './GemCosts.css';\n\n// Pure function that doesn't use hooks\nexport const calculateGemPurchase = ({ \n    resource, \n    inventory, \n    backpack, \n    masterResources,\n    currentPlayer,\n    strings,\n    overrideGemCost = null\n}) => {\n    // Ensure arrays are defined\n    const safeInventory = inventory || [];\n    const safeBackpack = backpack || [];\n    const safeMasterResources = masterResources || [];\n    \n    // Calculate total gems from inventory and backpack\n    const inventoryGems = safeInventory.find(item => item.type === 'Gem')?.quantity || 0;\n    const backpackGems = safeBackpack.find(item => item.type === 'Gem')?.quantity || 0;\n    const playerGems = inventoryGems + backpackGems;\n    const ownedSkills = currentPlayer?.skills || [];\n    \n    // Track what will be spent (simplified - only actual quantities)\n    const spendingItems = [];\n    \n    // Calculate for ingredient requirements - track what player can actually spend\n    for (let i = 1; i <= 10; i++) {\n        const ingredientType = resource[`ingredient${i}`];\n        const ingredientQty = resource[`ingredient${i}qty`];\n        \n        if (ingredientType && ingredientQty) {\n            const resourceData = safeMasterResources.find(r => r.type === ingredientType);\n            \n            // Calculate what player has\n            const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n            const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n            const playerQty = inventoryQty + backpackQty;\n            const willSpend = Math.min(playerQty, ingredientQty);\n            \n            // Track what will be spent\n            if (willSpend > 0) {\n                spendingItems.push({\n                    symbol: resourceData?.symbol || '',\n                    name: getLocalizedString(ingredientType, strings),\n                    amount: willSpend\n                });\n            }\n        }\n    }\n    \n    // Calculate for skill requirement\n    if (resource.requires) {\n        const requiredSkill = safeMasterResources.find(r => r.type === resource.requires);\n        \n        // Check if player has the required skill\n        const hasSkill = ownedSkills.some(skill => skill.type === resource.requires);\n        if (hasSkill) {\n            spendingItems.push({\n                symbol: requiredSkill?.symbol || '',\n                name: getLocalizedString(resource.requires, strings),\n                amount: '',\n                isSkill: true\n            });\n        }\n    }\n    \n    // Calculate gem cost using simplified approach\n    let gemCost;\n    \n    // If an override gem cost is provided (like for speedups), use it directly\n    if (overrideGemCost !== null && overrideGemCost !== undefined) {\n        gemCost = overrideGemCost;\n    } else {\n        // Only charge for missing ingredients - resource.gemcost is the total if you had nothing\n        // Calculate missing ingredient costs\n        let missingIngredientCost = 0;\n        for (let i = 1; i <= 10; i++) {\n            const ingredientType = resource[`ingredient${i}`];\n            const ingredientQty = resource[`ingredient${i}qty`];\n            \n            if (ingredientType && ingredientQty) {\n                const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n                const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const missingQty = Math.max(0, ingredientQty - playerQty);\n                \n                if (missingQty > 0) {\n                    const resourceData = safeMasterResources.find(r => r.type === ingredientType);\n                    const ingredientGemCost = resourceData?.gemcost || 1;\n                    missingIngredientCost += ingredientGemCost * missingQty;\n                }\n            }\n        }\n        \n        // Check missing skill cost\n        if (resource.requires) {\n            const hasSkill = ownedSkills.some(skill => skill.type === resource.requires);\n            if (!hasSkill) {\n                const requiredSkill = safeMasterResources.find(r => r.type === resource.requires);\n                const skillGemCost = requiredSkill?.gemcost || 1;\n                missingIngredientCost += skillGemCost;\n            }\n        }\n        \n        // Gem cost is ONLY the cost of missing ingredients\n        gemCost = Math.ceil(missingIngredientCost);\n        \n        // Minimum of 1 gem if there are any missing ingredients\n        if (gemCost === 0 && missingIngredientCost > 0) {\n            gemCost = 1;\n        }\n    }\n    \n    // Create a modified recipe for purchase\n    const getModifiedRecipe = () => {\n        const modifiedRecipe = { ...resource };\n        \n        // Adjust ingredient quantities to what player actually has\n        for (let i = 1; i <= 10; i++) {\n            const ingredientType = resource[`ingredient${i}`];\n            const ingredientQty = resource[`ingredient${i}qty`];\n            \n            if (ingredientType && ingredientQty) {\n                const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n                const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                \n                // Set to what player can actually spend\n                modifiedRecipe[`ingredient${i}qty`] = Math.min(playerQty, ingredientQty);\n            }\n        }\n        \n        // Add gems as the next available ingredient slot\n        // Find the first empty slot after existing ingredients\n        let gemSlot = 1;\n        for (let i = 1; i <= 10; i++) {\n            if (!resource[`ingredient${i}`]) {\n                gemSlot = i;\n                break;\n            }\n        }\n        \n        modifiedRecipe[`ingredient${gemSlot}`] = 'Gem';\n        modifiedRecipe[`ingredient${gemSlot}qty`] = gemCost;\n        \n        return modifiedRecipe;\n    };\n    \n    const hasEnoughGems = playerGems >= gemCost;\n    \n    return {\n        render: () => (\n            <div className=\"gem-purchase-tooltip\">                \n                <div className=\"spending-summary\">\n                    <div className=\"spending-label\">Will use:</div>\n                    {spendingItems.map((item, index) => (\n                        <div key={index} className=\"spending-line\">\n                            {item.symbol} {item.amount} {item.isSkill ? '(Skill)' : ''}\n                        </div>\n                    ))}\n                    <div className=\"spending-line gem-line\">\n                         {gemCost}  (You have:  {playerGems})\n                    </div>\n                </div>\n                \n                \n                {!hasEnoughGems && (\n                    <div className=\"tooltip-footer\">\n                        Click for more \n                    </div>\n                )}\n            </div>\n        ),\n        getModifiedRecipe,\n        hasEnoughGems,\n        gemCost\n    };\n};\n\nexport default calculateGemPurchase;","import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { calculateGemPurchase } from '../Economy/GemCosts';\nimport { useStrings } from './StringsContext';\nimport { usePanelContext } from './PanelContext';\nimport './ResourceButton.css';\n\n// Utility function to format numbers with locale-specific comma separators\nconst formatNumber = (number) => {\n  if (typeof number === 'number') {\n    return number.toLocaleString();\n  }\n  if (typeof number === 'string' && !isNaN(Number(number))) {\n    return Number(number).toLocaleString();\n  }\n  return number; // Return as-is if it's not a number\n};\n\n// Function to format numbers in HTML details strings\nconst formatDetailsForDisplay = (details) => {\n  if (!details || typeof details !== 'string') {\n    return details;\n  }\n  \n  // Replace standalone numbers (not part of words) with formatted versions\n  // This regex finds numbers that are either at word boundaries or surrounded by non-alphanumeric characters\n  return details.replace(/\\b(\\d{4,})\\b/g, (match, number) => {\n    return formatNumber(parseInt(number, 10));\n  });\n};\n \nconst ResourceButton = ({ \n  symbol, \n  name, \n  details, \n  info, \n  disabled, \n  className,\n  style, \n  onClick, \n  hideInfo = false, \n  children,\n  // Transaction support props\n  transactionKey,\n  onTransactionAction,\n  isTransactionMode = false,\n  // Gem button props\n  gemCost = null,\n  onGemPurchase = null,\n  hideGem = false,\n  // For gem calculation\n  resource = null,\n  inventory = null,\n  backpack = null,\n  masterResources = null,\n  currentPlayer = null\n}) => { \n  const strings = useStrings();\n  const { openPanel } = usePanelContext();\n  const [showInfo, setShowInfo] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [transactionId] = useState(() => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const [showGemTooltip, setShowGemTooltip] = useState(false);\n  const [gemTooltipPosition, setGemTooltipPosition] = useState({ top: 0, left: 0 });\n  const buttonRef = useRef(null);\n  \n  // Only create gem calculation when we have gem functionality enabled\n  const shouldCalculateGem = !!(resource && inventory && backpack && masterResources && currentPlayer && onGemPurchase && (gemCost || resource?.gemcost));\n  \n  const gemCalculation = useMemo(() => {\n    if (!shouldCalculateGem) {\n      return null;\n    }\n    \n    try {\n      return calculateGemPurchase({\n        resource,\n        inventory,\n        backpack,\n        masterResources,\n        currentPlayer,\n        strings,\n        overrideGemCost: gemCost // Pass the explicit gem cost if provided\n      });\n    } catch (error) {\n      console.error('Error creating gem calculation:', error);\n      return null;\n    }\n  }, [shouldCalculateGem, resource, inventory, backpack, masterResources, currentPlayer, strings]);\n\n  // Debug processing state changes\n  useEffect(() => {\n    if (isTransactionMode && transactionKey) {\n      console.log(` [RESOURCE_BUTTON] Processing state changed: ${isProcessing} for ${transactionKey}`);\n    }\n  }, [isProcessing, transactionKey, isTransactionMode]);\n\n  const updateTooltipPosition = (event) => {\n    setTooltipPosition({\n      top: event.clientY + window.scrollY + 10, //  Adjust Y position (below cursor)\n      left: event.clientX + window.scrollX + 15, //  Adjust X position (to the right of cursor)\n    });\n  };\n\n  const updateGemTooltipPosition = (event) => {\n    setGemTooltipPosition({\n      top: event.clientY + window.scrollY + 10,\n      left: event.clientX + window.scrollX + 15,\n    });\n  };\n\n  const handleClick = async (e) => {\n    if (disabled || isProcessing) return;\n\n    if (isTransactionMode && onTransactionAction && transactionKey) {\n      // Transaction mode - prevent multiple clicks\n      e.preventDefault();\n      e.stopPropagation();\n      \n      console.log(` [RESOURCE_BUTTON] Setting processing state for ${transactionKey}`);\n      setIsProcessing(true);\n      try {\n        await onTransactionAction(transactionId, transactionKey);\n        console.log(` [RESOURCE_BUTTON] Transaction completed for ${transactionKey}`);\n      } catch (error) {\n        console.error('Transaction failed:', error);\n      } finally {\n        console.log(` [RESOURCE_BUTTON] Clearing processing state for ${transactionKey}`);\n        setIsProcessing(false);\n      }\n    } else if (onClick) {\n      // Normal mode\n      onClick(e);\n    }\n  };\n\n  const handleGemClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (onGemPurchase && gemCalculation) {\n      if (gemCalculation.hasEnoughGems) {\n        // Has enough gems - execute the purchase\n        const modifiedRecipe = gemCalculation.getModifiedRecipe();\n        onGemPurchase(modifiedRecipe);\n      } else {\n        // Not enough gems - open the HowToGemsPanel\n        openPanel('HowToGemsPanel');\n      }\n    }\n  };\n\n  return (\n    <>\n      <div\n        className=\"resource-button-wrapper\"\n      >\n        <button\n          ref={buttonRef}\n          className={`resource-button ${disabled || isProcessing ? 'disabled' : ''} ${className || ''} ${isProcessing ? 'processing' : ''}`}\n          onClick={handleClick}\n          disabled={disabled || isProcessing}\n          style={{\n            opacity: (disabled || isProcessing) ? 0.6 : 1,\n            cursor: (disabled || isProcessing) ? 'not-allowed' : 'pointer',\n            ...style\n          }}\n        >\n\n          {/*  Ensure default content is displayed */}\n          <span className=\"resource-title\">\n            {isProcessing ? '' : symbol} {isProcessing ? 'Processing...' : name}\n          </span>\n          <span className=\"resource-details\" dangerouslySetInnerHTML={{ \n            __html: isProcessing ? 'Processing...' : (details ? formatDetailsForDisplay(details) : details)\n          }} />\n\n\n          {/*  Render children properly (fixes missing text issue) */}\n          {children}\n          \n          {/*  Hide \"\" info button when `hideInfo` is true */}\n          {!hideInfo && info && (\n            <span\n              className=\"info-button\"\n              onMouseEnter={(event) => {\n                setShowInfo(true);\n                updateTooltipPosition(event);\n              }}\n              onMouseMove={updateTooltipPosition} //  Dynamically reposition on cursor move\n              onMouseLeave={() => setShowInfo(false)}\n            >\n              \n            </span>\n            )}\n\n        </button>\n\n        {/*  Gem button for gem purchases - moved outside button so it's always clickable */}\n        {!hideGem && shouldCalculateGem && gemCalculation && !isProcessing && (\n          <span\n            className=\"gem-button\"\n            onClick={handleGemClick}\n            onMouseEnter={(event) => {\n              setShowGemTooltip(true);\n              updateGemTooltipPosition(event);\n            }}\n            onMouseMove={updateGemTooltipPosition}\n            onMouseLeave={() => setShowGemTooltip(false)}\n          >\n            \n          </span>\n        )}\n      </div>\n\n      {/*  Render info toaster inside `document.body` for proper layering */}\n      {showInfo && info && ReactDOM.createPortal(\n        <div\n          className=\"info-toaster\"\n          style={{\n            top: tooltipPosition.top,\n            left: tooltipPosition.left,\n            position: 'absolute', //  Prevents clipping\n          }}\n        >\n          {typeof info === 'string' ? (\n            <p dangerouslySetInnerHTML={{ __html: info }} />\n          ) : (\n            <>{info}</> //  Supports JSX rendering\n          )}\n        </div>,\n        document.body\n      )}\n\n      {/*  Render gem tooltip inside `document.body` for proper layering */}\n      {showGemTooltip && gemCalculation && ReactDOM.createPortal(\n        <div\n          style={{\n            top: gemTooltipPosition.top,\n            left: gemTooltipPosition.left,\n            position: 'absolute',\n            zIndex: 99999,\n          }}\n        >\n          {gemCalculation.render()}\n        </div>,\n        document.body\n      )}\n    </>\n  );\n};\n\nexport default ResourceButton;","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { canAfford, isCurrency } from '../../Utils/InventoryManagement';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { deriveWarehouseAndBackpackCapacity } from '../../Utils/InventoryManagement';\nimport './WarehousePanel.css';\n\nconst WarehousePanel = ({\n  onClose,\n  setInventory,\n  currentPlayer,\n  setCurrentPlayer,\n  masterResources,\n  globalTuning,\n  masterWarehouse,\n  updateStatus,\n}) => {\n  const strings = useStrings();\n  const inventory = currentPlayer?.inventory || [];\n  const [currentLevel, setCurrentLevel] = useState(0);\n  const [nextLevel, setNextLevel] = useState(null);\n  const [needsLevelMigration, setNeedsLevelMigration] = useState(false);\n\n  // Calculate current warehouse level and handle backward compatibility\n  useEffect(() => {\n    if (!masterWarehouse || masterWarehouse.length === 0) return;\n    \n    // Use the stored level if available\n    if (currentPlayer?.warehouseLevel !== undefined) {\n      setCurrentLevel(currentPlayer.warehouseLevel);\n      setNeedsLevelMigration(false);\n    } else {\n      // For backward compatibility, start at level 0\n      setCurrentLevel(0);\n      setNeedsLevelMigration(true);\n      \n      // Auto-migrate the level to the player document\n      if (currentPlayer?.playerId) {\n        migrateLevelToPlayer(0);\n      }\n    }\n    \n    // Get next level data\n    const level = currentPlayer?.warehouseLevel ?? currentLevel;\n    if (level < masterWarehouse.length - 1) {\n      setNextLevel(masterWarehouse[level + 1]);\n    } else {\n      setNextLevel(null);\n    }\n  }, [currentPlayer?.warehouseCapacity, currentPlayer?.warehouseLevel, masterWarehouse]);\n\n  // Function to migrate level to player document\n  const migrateLevelToPlayer = async (level) => {\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          warehouseLevel: level\n        }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer({\n          ...currentPlayer,\n          warehouseLevel: level\n        });\n        setNeedsLevelMigration(false);\n        console.log('Successfully migrated warehouse level to player document');\n      }\n    } catch (error) {\n      console.error('Error migrating warehouse level:', error);\n    }\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleUpgrade(modifiedRecipe);\n  };\n\n  const handleUpgrade = async (customRecipe = null) => {\n    if (!nextLevel) return;\n\n    const recipeToUse = customRecipe || nextLevel;\n\n    // Build ingredients array\n    const ingredients = [];\n    \n    // Add all 5 potential ingredients (including gems if present)\n    for (let i = 1; i <= 5; i++) {\n      const ingredientType = recipeToUse[`ingredient${i}`];\n      const ingredientQty = recipeToUse[`ingredient${i}qty`];\n      \n      if (ingredientType && ingredientQty) {\n        ingredients.push({\n          type: ingredientType,\n          quantity: ingredientQty\n        });\n      }\n    }\n    \n    console.log('Warehouse upgrade - Recipe to use:', recipeToUse);\n    console.log('Warehouse upgrade - Ingredients array:', ingredients);\n\n    // Check if player can afford (now handled by spendIngredients)\n    if (!customRecipe && !canAfford(nextLevel, inventory, null, 1)) {\n      updateStatus(16); // Cannot afford message\n      return;\n    }\n\n    try {\n      // Spend ingredients using the proper async function\n      const spendSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: recipeToUse,\n        inventory,\n        backpack: [],\n        setInventory,\n        setBackpack: () => {}, // Not using backpack for warehouse upgrades\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spendSuccess) {\n        console.warn('Failed to spend ingredients.');\n        return;\n      }\n      \n      // Calculate new capacity and level\n      const newCapacity = (currentPlayer.warehouseCapacity || 1000) + nextLevel.add;\n      const newLevel = nextLevel.Level;\n      \n      // Update player's warehouse capacity AND level\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          warehouseCapacity: newCapacity,\n          warehouseLevel: newLevel\n        }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer({\n          ...currentPlayer,\n          warehouseCapacity: newCapacity,\n          warehouseLevel: newLevel\n        });\n\n        updateStatus(`${strings[197] || \"Warehouse upgraded\"}`);\n      }\n    } catch (error) {\n      console.error('Error upgrading warehouse:', error);\n      updateStatus('Failed to upgrade warehouse');\n    }\n  };\n\n  // Get current capacity info\n  const finalCapacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n  \n  // Get Gold bonus from globalTuning prop\n  const warehouseGoldBonus = globalTuning?.warehouseCapacityGold || 100000;\n  \n  // Calculate total quantity in warehouse (excluding currencies)\n  const calculateTotalQuantity = (inventory) => {\n    if (!inventory || !Array.isArray(inventory)) return 0;\n    return inventory\n      .filter((item) => item && !isCurrency(item.type))\n      .reduce((total, item) => total + (item.quantity || 0), 0);\n  };\n  \n  const currentUsage = calculateTotalQuantity(inventory);\n\n  return (\n    <Panel \n      onClose={onClose} \n      titleKey=\"181\" // \"Warehouse\"\n      panelName=\"WarehousePanel\"\n    >\n      <div className=\"standard-panel\">\n        <div className=\"warehouse-capacity-display\">\n          <h3>\n            {strings[183]} {currentUsage}/\n            <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n              {finalCapacities.warehouse}\n            </span>\n          </h3>\n          {currentPlayer?.accountStatus === \"Gold\" && (\n            <p style={{fontSize: \"14px\", color: \"#666\", margin: \"5px 0\"}}>\n              (+{warehouseGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n            </p>\n          )}\n        </div>\n\n        {nextLevel ? (\n          <>\n            <p className=\"upgrade-info\">\n              {strings[196] || \"Add\"} {nextLevel.add} {strings[198] || \"to warehouse capacity\"}\n            </p>\n\n            <div className=\"skills-options\">\n              <ResourceButton\n                symbol=\"\"\n                name={strings[2024] || \"Upgrade Warehouse\"}\n                details={(() => {\n                  // Build details string similar to CraftingStation\n                  const ingredients = [];\n                  for (let i = 1; i <= 5; i++) {\n                    const type = nextLevel[`ingredient${i}`];\n                    const qty = nextLevel[`ingredient${i}qty`];\n                    if (!type || !qty) continue;\n                    \n                    const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                    const playerQty = inventoryQty;\n                    const color = playerQty >= qty ? 'green' : 'red';\n                    const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                    ingredients.push(`<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`);\n                  }\n                  return `${strings[461] || \"Requires:\"}<div>${ingredients.join('')}</div>`;\n                })()}\n                info={`+${nextLevel.add} ${strings[2021] || \"capacity\"}`}\n                disabled={!canAfford(nextLevel, inventory, null, 1)}\n                onClick={() => handleUpgrade()}\n                // Don't pass gemCost prop - instead ensure resource has gemcost property\n                onGemPurchase={!canAfford(nextLevel, inventory, null, 1) ? handleGemPurchase : null}\n                resource={{...nextLevel, gemcost: 1}} // Add gemcost property to enable gem button\n                inventory={inventory}\n                backpack={[]}\n                masterResources={masterResources}\n                currentPlayer={currentPlayer}\n              />\n            </div>\n          </>\n        ) : (\n          <div className=\"max-level\">\n            <p>{strings[88] || \"Your warehouse is at maximum capacity.\"}</p>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default WarehousePanel;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport '../../UI/Panel.css';\nimport './TrophyPanel.css'; \nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport FloatingTextManager from '../../UI/FloatingText';\n\n\nfunction TrophyPanel({ onClose, masterResources, masterTrophies, currentPlayer, setCurrentPlayer, updateStatus, openPanel, setActiveStation, inventory, setInventory, backpack, setBackpack }) {\n\n    const strings = useStrings();\n    const [trophies, setTrophies] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [collecting, setCollecting] = useState(null); // Track which trophy is being collected\n    \n    useEffect(() => {\n        // Fetch trophies when panel opens\n        const fetchTrophies = async () => {\n            try {\n                setLoading(true);\n                const response = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}/trophies`);\n                if (response.data.success) {\n                    setTrophies(response.data.trophies || []);\n                }\n            } catch (error) {\n                console.error('Error fetching trophies:', error);\n                updateStatus('Failed to load trophies');\n            } finally {\n                setLoading(false);\n            }\n        };\n        \n        if (currentPlayer?.playerId) {\n            fetchTrophies();\n        }\n    }, [currentPlayer?.playerId]);\n    \n    // Handle collecting trophy reward\n    const handleCollectReward = async (trophyName) => {\n        try {\n            setCollecting(trophyName);\n            \n            const response = await axios.post(`${API_BASE}/api/collect-trophy-reward`, {\n                playerId: currentPlayer.playerId,\n                trophyName: trophyName\n            });\n            \n            if (response.data.success) {\n                const { gemReward, inventory } = response.data;\n                \n                // Update inventory from server response\n                if (inventory) {\n                    setInventory(inventory);\n                    setCurrentPlayer(prev => ({ ...prev, inventory }));\n                }\n                \n                // Update local trophy state to mark as collected\n                setTrophies(prevTrophies => \n                    prevTrophies.map(t => \n                        t.name === trophyName ? { ...t, collected: true } : t\n                    )\n                );\n                \n                FloatingTextManager.addFloatingText(`+${gemReward} `, window.innerWidth / 2, window.innerHeight / 2, 64);\n                updateStatus(` Earned ${gemReward} Gem${gemReward > 1 ? 's' : ''} from your trophy`);\n            } else {\n                updateStatus(response.data.message || 'Failed to collect reward');\n            }\n        } catch (error) {\n            console.error('Error collecting trophy reward:', error);\n            updateStatus('Failed to collect trophy reward');\n        } finally {\n            setCollecting(null);\n        }\n    };\n\n    // Helper function to get progress info\n    const getProgressInfo = (trophyDef, playerTrophy) => {\n        if (!trophyDef.progress || trophyDef.progress.length === 0) return null;\n        \n        const currentProgress = playerTrophy?.progress || 0;\n        const progressArray = trophyDef.progress;\n        \n        // Find last achieved milestone and next milestone\n        let lastAchievedMilestone = null;\n        let lastMilestone = 0; // For progress bar calculation\n        let nextMilestone = progressArray[0];\n        \n        for (let i = 0; i < progressArray.length; i++) {\n            if (currentProgress >= progressArray[i]) {\n                // This milestone has been achieved\n                lastAchievedMilestone = progressArray[i];\n                lastMilestone = progressArray[i];\n                // Look for next milestone\n                if (i + 1 < progressArray.length) {\n                    nextMilestone = progressArray[i + 1];\n                } else {\n                    // Max milestone reached\n                    nextMilestone = progressArray[i];\n                }\n            } else {\n                // Found the next milestone to achieve\n                nextMilestone = progressArray[i];\n                break;\n            }\n        }\n        \n        // For display, we show progress between current milestone boundaries\n        const progressBetweenMilestones = currentProgress - lastMilestone;\n        const milestoneDifference = nextMilestone - lastMilestone;\n        const percentage = milestoneDifference > 0 ? (progressBetweenMilestones / milestoneDifference) * 100 : 100;\n        \n        return {\n            current: currentProgress,\n            lastAchievedMilestone, // The actual milestone number to display on icon\n            lastMilestone, // For progress bar calculation\n            nextMilestone,\n            percentage: Math.min(100, Math.max(0, percentage)),\n            displayText: `${currentProgress} / ${nextMilestone}`,\n            hasAchievedAll: currentProgress >= progressArray[progressArray.length - 1]\n        };\n    };\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1035\" titleKey=\"1135\" panelName=\"TrophyPanel\">\n            \n            <div className=\"trophy-container\">\n                {loading ? (\n                    <div className=\"loading\">Loading trophies...</div>\n                ) : (\n                    <div className=\"trophy-grid\">\n                        {masterTrophies?.filter(trophy => trophy.visible !== false).sort((a, b) => {\n                            // Sort trophies by status:\n                            // 1. Earned but not collected (highest priority)\n                            // 2. Earned and collected\n                            // 3. Not earned (lowest priority)\n                            \n                            const playerTrophyA = trophies.find(t => t.name === a.name);\n                            const playerTrophyB = trophies.find(t => t.name === b.name);\n                            \n                            const isEarnedA = !!playerTrophyA;\n                            const isEarnedB = !!playerTrophyB;\n                            \n                            const hasUncollectedRewardA = isEarnedA && playerTrophyA?.collected === false;\n                            const hasUncollectedRewardB = isEarnedB && playerTrophyB?.collected === false;\n                            \n                            // If both have uncollected rewards, maintain original order\n                            if (hasUncollectedRewardA && hasUncollectedRewardB) return 0;\n                            // If only A has uncollected reward, A comes first\n                            if (hasUncollectedRewardA && !hasUncollectedRewardB) return -1;\n                            // If only B has uncollected reward, B comes first\n                            if (!hasUncollectedRewardA && hasUncollectedRewardB) return 1;\n                            \n                            // Neither has uncollected rewards, check if earned\n                            // If both are earned and collected, maintain original order\n                            if (isEarnedA && isEarnedB) return 0;\n                            // If only A is earned, A comes first\n                            if (isEarnedA && !isEarnedB) return -1;\n                            // If only B is earned, B comes first\n                            if (!isEarnedA && isEarnedB) return 1;\n                            \n                            // Neither is earned, maintain original order\n                            return 0;\n                        }).map((trophyDef, index) => {\n                            // Find if player has earned this trophy\n                            const playerTrophy = trophies.find(t => t.name === trophyDef.name);\n                            const isEarned = !!playerTrophy;\n                            const progressInfo = trophyDef.type === 'Progress' ? getProgressInfo(trophyDef, playerTrophy) : null;\n                            const hasUncollectedReward = isEarned && playerTrophy?.collected === false;\n                            const isCollecting = collecting === trophyDef.name;\n                            \n                            return (\n                                <div \n                                    key={index} \n                                    className={`trophy-card ${!isEarned ? 'unearned' : ''} trophy-${(trophyDef.type || 'Event').toLowerCase()}`}\n                                    data-tooltip={trophyDef.tooltip || ''}\n                                >\n                                    <div className=\"trophy-icon-wrapper\">\n                                        <div className=\"trophy-icon\"></div>\n                                        {isEarned && trophyDef.type === 'Progress' && progressInfo?.lastAchievedMilestone && (\n                                            <div className=\"progress-number\">{progressInfo.lastAchievedMilestone}</div>\n                                        )}\n                                    </div>\n                                    <div className=\"trophy-content\">\n                                        <div className=\"trophy-name\">\n                                            {getLocalizedString(trophyDef.name, strings)}\n                                        </div>\n                                        {trophyDef.type === 'Progress' && progressInfo && (\n                                            <div className=\"trophy-progress\">\n                                                <div className=\"progress-text\">\n                                                    {progressInfo.displayText}\n                                                </div>\n                                                <div className=\"progress-bar\">\n                                                    <div \n                                                        className=\"progress-fill\" \n                                                        style={{\n                                                            width: `${Math.min(100, Math.max(0, progressInfo.percentage))}%`\n                                                        }}\n                                                    />\n                                                </div>\n                                            </div>\n                                        )}\n                                        {trophyDef.type === 'Count' && isEarned && playerTrophy?.qty > 0 && (\n                                            <div className=\"trophy-count\">\n                                                <div className=\"count-text\">\n                                                    {playerTrophy.qty}x\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                    {hasUncollectedReward && (\n                                        <div \n                                            className=\"trophy-reward-gem\"\n                                            onClick={() => handleCollectReward(trophyDef.name)}\n                                            style={{\n                                                opacity: isCollecting ? 0.5 : 1,\n                                                cursor: isCollecting ? 'wait' : 'pointer'\n                                            }}\n                                        >\n                                            \n                                        </div>\n                                    )}\n                                </div>\n                            );\n                        })}\n                    </div>\n                )}\n            </div>\n  \n        </Panel>\n    );\n}\n\nexport default TrophyPanel;","import React, { memo } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { useStrings } from './StringsContext';\n\nconst HowToPanel = memo(({ onClose }) => {\n  const strings = useStrings();\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1018\" titleKey=\"1118\" panelName=\"HowToPanel\">\n      <div className=\"panel-content\">\n        <p>{strings[9000]}</p>\n        <h2>{strings[9001]}</h2>\n        <p>{strings[9002]}</p>\n        <p>{strings[9003]}</p>\n        <h3>{strings[9004]}</h3>\n        <p>{strings[9005]}</p>\n        <p>{strings[9006]}</p>\n        <p>{strings[9007]}</p>\n        <h3>{strings[9008]}</h3>\n        <p>{strings[9009]}</p>\n        <p>{strings[9010]}</p>\n        <p>{strings[9011]}</p>\n        <h3>{strings[9012]}</h3>\n        <p>{strings[9013]}</p>\n        <p>{strings[9014]}</p>\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToPanel;\n","import React, { memo } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { useStrings } from './StringsContext';\n\nconst HowToMoneyPanel = memo(({ onClose }) => {\n\n  const strings = useStrings();\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1026\" titleKey=\"1126\" panelName=\"HowToMoneyPanel\">\n      <div className=\"panel-content\">\n\n        <h2>{strings[9020]}</h2>\n        <p>{strings[9021]}</p>\n        <p>{strings[9022]}</p>\n        <p>{strings[9023]}</p>\n        <p>{strings[9024]}</p>\n        <h2>{strings[9025]}</h2>\n        <p>{strings[9026]}</p>\n        <p>{strings[9027]}</p>\n\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToMoneyPanel;\n","import React, { memo, useState, useEffect } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { handlePurchase } from '../Store/Store';\nimport { useStrings } from './StringsContext';\nimport axios from 'axios';\nimport API_BASE from '../config';\nimport './SharedButtons.css';\n\nconst HowToGemsPanel = memo(({ currentPlayer, updateStatus, onClose }) => {\n\n  const strings = useStrings();\n  const [offers, setOffers] = useState({});\n\n  useEffect(() => {\n    const fetchOffers = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/store-offers`);\n        const offerData = response.data || [];\n        // Convert array to object keyed by id for easy lookup\n        const offerMap = {};\n        offerData.forEach(offer => {\n          offerMap[offer.id] = offer;\n        });\n        setOffers(offerMap);\n      } catch (error) {\n        console.error(\" Failed to load store offers:\", error);\n      }\n    };\n    fetchOffers();\n  }, []);\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1034\" titleKey=\"1134\" panelName=\"HowToGemsPanel\">\n      <div className=\"panel-content\">\n\n        <h2>{strings[9030]}</h2>\n        <p>{strings[9031]}</p>\n        <p>{strings[9032]}</p>\n\n        <div className=\"shared-buttons\" style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '100%', gap: '10px' }}>\n        <p style={{ marginBottom: '0px', fontWeight: 'bold' }}>{strings[9040]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(6, currentPlayer, updateStatus)}>{strings[9041]}{offers[6] ? ` $${offers[6].price.toFixed(2)}` : ''}</button>\n        <p style={{ marginBottom: '0px', marginTop: '6px', fontWeight: 'bold' }}>{strings[9042]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(7, currentPlayer, updateStatus)}>{strings[9043]}{offers[7] ? ` $${offers[7].price.toFixed(2)}` : ''}</button>\n        <p style={{ marginBottom: '0px', marginTop: '6px', fontWeight: 'bold' }}>{strings[9044]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(8, currentPlayer, updateStatus)}>{strings[9045]}{offers[8] ? ` $${offers[8].price.toFixed(2)}` : ''}</button>\n        </div>\n\n        <p>{strings[9033]}</p>\n\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToGemsPanel;\n","import React from 'react';\nimport './ResourceButton.css';\nimport './QuestButton.css';\nimport { useStrings } from './StringsContext';\n\nconst QuestButton = ({ quest, state, onClick }) => {\n  const strings = useStrings();\n  const { symbol, title, completed, goals = [], reward, rewardqty } = quest;\n\n  return (\n    <div\n      className={`quest-item ${state}`}\n      onClick={onClick}\n    >\n      <div className=\"quest-header\">\n        <h2>{symbol}</h2>\n        {state === 'reward' && <span className=\"quest-checkmark\"></span>}\n      </div>\n      <h3>{title}</h3>\n      <h4>{completed ? strings[206] : strings[207]}</h4>\n      {goals.map((goal, index) =>\n        goal.action && goal.item && goal.qty ? (\n          <p key={index}>\n            {goal.action} {goal.item} x{goal.qty}: {goal.progress} of {goal.qty}\n          </p>\n        ) : null\n      )}\n      {reward && rewardqty && (\n        <p>Reward: {rewardqty} {reward}</p>\n      )}\n    </div>\n  );\n};\n\nconst QuestGiverButton = ({ quest, state, onClick }) => {\n  const strings = useStrings();\n  const { symbol, title, reward, rewardqty, goals = [] } = quest;\n  const buttonText = state === 'reward' ? strings[208] : strings[209];\n  return (\n    <div\n      className={`quest-item ${state}`}\n      onClick={onClick}\n    >\n      <div className=\"quest-header\">\n        <h2>{symbol}</h2>\n        {state === 'reward' && <span className=\"quest-checkmark\"></span>}\n      </div>\n      <h3>{title}</h3>\n      <div className=\"quest-goals\">\n        {goals.map((goal, index) =>\n          goal.action && goal.item && goal.qty ? (\n            <p key={index}>{goal.action} {goal.item} x{goal.qty}</p>\n          ) : null\n        )}\n      </div>\n      <p>Reward: {rewardqty} {reward}</p>\n      <button className=\"quest-giver-button\">{buttonText}</button>\n    </div>\n  );\n};\n\nexport { QuestButton, QuestGiverButton };","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panel';\nimport { QuestButton } from '../../UI/QuestButton';\nimport '../../UI/ResourceButton.css';\nimport '../../UI/QuestButton.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction QuestPanel({ onClose, currentPlayer }) {\n  const strings = useStrings();\n  const [playerQuests, setPlayerQuests] = useState([]);\n  const [questTemplates, setQuestTemplates] = useState([]);\n\n  // Load active player quests\n  useEffect(() => {\n    if (currentPlayer?.activeQuests) {\n      setPlayerQuests(currentPlayer.activeQuests);\n    }\n  }, [currentPlayer]);\n\n  // Load all quest templates from tuning file\n  useEffect(() => {\n    const fetchQuestTemplates = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/quests`);\n        setQuestTemplates(response.data || []);\n      } catch (error) {\n        console.error('Error fetching quest templates:', error);\n      }\n    };\n    fetchQuestTemplates();\n  }, []);\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1006\" titleKey=\"1106\" panelName=\"QuestPanel\">\n      {(!playerQuests || playerQuests.length === 0) ? (\n        <p>{strings[203]}</p>\n      ) : (\n        <div className=\"standard-panel\">\n          {playerQuests.map((quest, index) => {\n            const template = questTemplates.find(t => t.title === quest.questId);\n            const goals = [\n              {\n                action: quest.goal1action,\n                item: quest.goal1item,\n                qty: quest.goal1qty,\n                progress: quest.progress?.goal1 || 0,\n              },\n              {\n                action: quest.goal2action,\n                item: quest.goal2item,\n                qty: quest.goal2qty,\n                progress: quest.progress?.goal2 || 0,\n              },\n              {\n                action: quest.goal3action,\n                item: quest.goal3item,\n                qty: quest.goal3qty,\n                progress: quest.progress?.goal3 || 0,\n              },\n            ].filter(goal => goal.action && goal.item && goal.qty);\n\n            return (\n              <QuestButton\n                key={index}\n                className={`resource-button ${quest.completed ? 'reward' : 'in-progress'}`}\n                quest={{\n                  symbol: quest.symbol,\n                  title: quest.questId,\n                  completed: quest.completed,\n                  goals,\n                  textbody: template?.textbody || '',\n                  reward: template?.reward || '',\n                  rewardqty: template?.rewardqty || 1,\n                }}\n                state={quest.completed ? 'reward' : 'in-progress'}\n                onClick={null}\n              />\n            );\n          })}\n        </div>\n      )}\n    </Panel>\n  );\n}\n\nexport default QuestPanel;","import axios from 'axios';\nimport API_BASE from '../../config';\nimport RelationshipMatrix from './RelationshipMatrix.json';\n\n/**\n * Central utility for managing relationship changes\n * Creates a new relationship if it doesn't exist, or updates existing one\n */\nexport const updateRelationship = async (currentPlayer, targetName, delta) => {\n  \n  try {\n    const playerId = currentPlayer._id || currentPlayer.playerId;\n    \n    // Check if relationship exists\n    const existingRelationship = currentPlayer.relationships?.find(rel => rel.name === targetName);\n    \n    if (!existingRelationship) {\n      // Create new relationship\n      const response = await axios.post(`${API_BASE}/api/add-relationship`, {\n        playerId,\n        targetName,\n        initialScore: delta\n      });\n      \n      return {\n        success: response.data.success,\n        player: response.data.player,\n        relationships: response.data.relationships\n      };\n    } else {\n      // Update existing relationship\n      const response = await axios.post(`${API_BASE}/api/update-relationship`, {\n        playerId,\n        targetName,\n        delta: delta\n      });\n      \n      return {\n        success: response.data.success,\n        player: response.data.player,\n        relationships: response.data.relationships,\n        relationship: response.data.relationship\n      };\n    }\n  } catch (error) {\n    console.error('Error updating relationship:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Update relationship status (friend, crush, love, married, rival, etc.)\n */\nexport const updateRelationshipStatus = async (currentPlayer, targetName, status, value) => {\n  try {\n    const playerId = currentPlayer._id || currentPlayer.playerId;\n    \n    const response = await axios.post(`${API_BASE}/api/add-or-update-relationship-status`, {\n      playerId,\n      name: targetName,\n      status: status,\n      value: value\n    });\n    \n    // Check for \"Meet the Cast\" trophy if status is \"met\" and value is true\n    if (response.data.success && status === 'met' && value === true) {\n      // Get all character names from RelationshipMatrix\n      const allCharacters = RelationshipMatrix\n        .filter(char => char.type)\n        .map(char => char.type);\n      \n      // Check if player has met all characters\n      const updatedPlayer = response.data.player;\n      const metCharacters = updatedPlayer.relationships.filter(rel => rel.met === true);\n      const hasMetAll = allCharacters.every(charName => \n        metCharacters.some(rel => rel.name === charName)\n      );\n      \n      if (hasMetAll) {\n        // Award \"Meet the Cast\" trophy\n        try {\n          const trophyResponse = await axios.post(`${API_BASE}/api/earn-trophy`, {\n            playerId,\n            trophyName: 'Meet the Cast'\n          });\n          \n          if (trophyResponse.data.success && trophyResponse.data.isNewMilestone) {\n            console.log(` Player earned Meet the Cast trophy!`);\n            // Trophy notification will be handled by the earn-trophy endpoint\n          }\n        } catch (trophyError) {\n          console.error('Error awarding Meet the Cast trophy:', trophyError);\n        }\n      }\n    }\n    \n    return {\n      success: response.data.success,\n      player: response.data.player,\n      relationship: response.data.relationship\n    };\n  } catch (error) {\n    console.error('Error updating relationship status:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Get relationship status between player and target\n */\nexport const getRelationshipStatus = (currentPlayer, targetName) => {\n  if (!currentPlayer?.relationships) return null;\n  \n  return currentPlayer.relationships.find(rel => rel.name === targetName) || {\n    name: targetName,\n    relscore: 0\n  };\n};\n\n\n/**\n * Get NPC reactions when player forms a new relationship status\n * Returns an array of NPCs that would react and their relationship changes\n */\nexport const getNPCReactions = (targetNPC, newStatus) => {\n  const reactions = [];\n  \n  // RelationshipMatrix is now an array, so iterate through it\n  RelationshipMatrix.forEach((npcEntry) => {\n    // Get the NPC name from the 'type' field\n    const npc = npcEntry.type;\n    \n    // Skip the target NPC\n    if (npc === targetNPC) return;\n    \n    // Check if this NPC has a relationship with the target\n    const npcRelationshipWithTarget = npcEntry[targetNPC];\n    \n    if (npcRelationshipWithTarget) {\n      // If new status is love, and another NPC loves this NPC\n      if (newStatus === 'love' && npcRelationshipWithTarget === 'love') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n      // If new status is friend, and another NPC has Rival with this NPC\n      else if (newStatus === 'friend' && npcRelationshipWithTarget === 'rival') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n      // If new status is friend, and another NPC has Friend with this NPC\n      else if (newStatus === 'friend' && npcRelationshipWithTarget === 'friend') {\n        reactions.push({\n          npc: npc,\n          scoreChange: 30\n        });\n      }\n      // If new status is rival, and another NPC has Rival with this NPC\n      else if (newStatus === 'rival' && npcRelationshipWithTarget === 'rival') {\n        reactions.push({\n          npc: npc,\n          scoreChange: 50\n        });\n      }\n      // If new status is rival, and another NPC has Love with this NPC\n      else if (newStatus === 'rival' && npcRelationshipWithTarget === 'love') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n    }\n  });\n  \n  return reactions;\n};\n\n/**\n * Check if an interaction should be blocked based on other relationships\n * Returns { allowed: boolean, reason?: string }\n */\nexport const checkOtherRelationships = (currentPlayer, targetNPC, interaction) => {\n  // Check if this interaction would add a relationship status\n  if (!interaction.relbitadd) {\n    return { allowed: true };\n  }\n  \n  // Check for married status - can only be married to one NPC\n  if (interaction.relbitadd === 'married') {\n    const existingMarriage = currentPlayer.relationships?.find(rel => \n      rel.married === true && rel.name !== targetNPC\n    );\n    if (existingMarriage) {\n      return { \n        allowed: false, \n        reason: `You are already married to ${existingMarriage.name}` \n      };\n    }\n  }\n  \n  // Check for friend status with rivals\n  if (interaction.relbitadd === 'friend') {\n    // Get all NPCs that are rivals of the target\n    const targetRivals = [];\n    RelationshipMatrix.forEach((npcEntry) => {\n      const npc = npcEntry.type;\n      if (npcEntry[targetNPC] === 'rival') {\n        targetRivals.push(npc);\n      }\n    });\n    \n    // Check if player is friends with any of target's rivals\n    for (const rival of targetRivals) {\n      const playerRelWithRival = currentPlayer.relationships?.find(rel => rel.name === rival);\n      if (playerRelWithRival?.friend === true) {\n        return { \n          allowed: false, \n          reason: `${targetNPC} won't be friends with you because you're friends with ${rival}` \n        };\n      }\n    }\n  }\n  \n  // Check for love/crush status with NPCs who are already in love\n  if (interaction.relbitadd === 'love' || interaction.relbitadd === 'crush') {\n    // Check if target NPC already loves someone else\n    const targetNPCEntry = RelationshipMatrix.find(entry => entry.type === targetNPC);\n    if (targetNPCEntry) {\n      // Find who the target loves by checking all their relationships\n      const targetLoves = Object.entries(targetNPCEntry)\n        .filter(([key, value]) => key !== 'type' && key !== 'symbol' && value === 'love');\n      \n      if (targetLoves.length > 0) {\n        return { \n          allowed: false, \n          reason: `${targetNPC} is already in love with ${targetLoves[0][0]}` \n        };\n      }\n    }\n  }\n  \n  return { allowed: true };\n};\n\n/**\n * Generate a status message for relationship changes\n * @param {string} targetName - The NPC the player interacted with\n * @param {string} newStatus - The new relationship status (if any)\n * @param {boolean} success - Whether the interaction was successful\n * @param {Array} reactions - Array of NPC reactions from getNPCReactions\n * @param {Object} strings - The strings object from useStrings hook\n * @returns {string} The status message to display\n */\nexport const generateRelationshipStatusMessage = (targetName, newStatus, success, reactions = [], strings = {}) => {\n  let message = '';\n  \n  if (success && newStatus) {\n    // Generate primary status message based on the new status\n    switch (newStatus) {\n      case 'met':\n        message = `${strings[602]} ${targetName}.`;\n        break;\n      case 'friend':\n        message = `${strings[603]} ${targetName}.`;\n        break;\n      case 'crush':\n        message = `${strings[604]} ${targetName}.`;\n        break;\n      case 'love':\n        message = `${strings[605]} ${targetName}.`;\n        break;\n      case 'married':\n        message = `${strings[606]} ${targetName} ${strings[607]}`;\n        break;\n      case 'rival':\n        message = `${strings[606]} ${targetName} ${strings[608]}`;\n        break;\n      default:\n        message = `${strings[615]} ${targetName} ${strings[616]}`;\n    }\n    \n    // Add reaction messages if there are any\n    if (reactions && reactions.length > 0) {\n      const negativeReactions = reactions.filter(r => r.setStatus === 'rival' || r.scoreChange < 0);\n      const positiveReactions = reactions.filter(r => r.scoreChange > 0 && r.setStatus !== 'rival');\n      \n      if (negativeReactions.length > 0) {\n        if (negativeReactions.length === 1) {\n          const reaction = negativeReactions[0];\n          if (reaction.setStatus === 'rival') {\n            message += ` ${reaction.npc} ${strings[609]}`;\n          } else {\n            message += ` ${reaction.npc} ${strings[610]}`;\n          }\n        } else {\n          const npcNames = negativeReactions.map(r => r.npc).join(` ${strings[614]} `);\n          message += ` ${npcNames} ${strings[611]}`;\n        }\n      }\n      \n      if (positiveReactions.length > 0) {\n        if (positiveReactions.length === 1) {\n          const reaction = positiveReactions[0];\n          message += ` ${reaction.npc} ${strings[612]}`;\n        } else {\n          const npcNames = positiveReactions.map(r => r.npc).join(` ${strings[614]} `);\n          message += ` ${npcNames} ${strings[613]}`;\n        }\n      }\n    }\n  }\n  \n  return message;\n};\n\n/**\n * Get resource multiplier based on relationship status with an NPC\n * @param {string} npcName - The name of the NPC\n * @param {Object} currentPlayer - The current player object with relationships\n * @param {Object} strings - The localized strings object\n * @returns {Object} - { multiplier: number, bonusMessage: string }\n */\nexport const getRelationshipMultiplier = (npcName, currentPlayer, strings) => {\n\n  // Find the NPC in the RelationshipMatrix\n  const npcEntry = RelationshipMatrix.find(entry => entry.type === npcName);\n\n  // If no NPC entry found or no buffs defined, return default\n  if (!npcEntry || (!npcEntry.buff4friend && !npcEntry.buff4love && !npcEntry.buff4marriage)) {\n    return { multiplier: 1, bonusMessage: '' };\n  }\n  \n  // Find player's relationship with this NPC\n  const relationship = currentPlayer.relationships?.find(rel => rel.name === npcName);\n  \n  if (!relationship) {\n    return { multiplier: 1, bonusMessage: '' };\n  }\n  \n  // Check relationship status and apply appropriate buff\n  if (relationship.married === true && npcEntry.buff4marriage) {\n    return { \n      multiplier: npcEntry.buff4marriage, \n      bonusMessage: ` ${npcEntry.buff4marriage}x ${strings[621]}.` \n    };\n  } else if (relationship.love === true && npcEntry.buff4love) {\n    return { \n      multiplier: npcEntry.buff4love, \n      bonusMessage: ` ${npcEntry.buff4love}x ${strings[623]}.` \n    };\n  } else if (relationship.friend === true && npcEntry.buff4friend) {\n    return { \n      multiplier: npcEntry.buff4friend, \n      bonusMessage: ` ${npcEntry.buff4friend}x ${strings[622]}.` \n    };\n  }\n  \n  return { multiplier: 1, bonusMessage: '' };\n};\n","import React, { useState, useEffect } from 'react';\nimport './Conversation.css';\nimport ConversationManager from './ConversationManager';\nimport RelationshipMatrix from './RelationshipMatrix.json';\n\n// Track conversation results for chance modification\nlet conversationResults = {\n  matchingInterests: 0,\n  matchingRandom: 0,\n  totalRounds: 0\n};\n\n// Calculate modified chance based on conversation results\nexport const calculateModifiedChance = (baseChance, interaction, conversationResults, currentPlayer, targetName) => {\n  let modifiedChance = baseChance || 1.0;\n  \n  // 1. Add bonus for matching interests during conversation\n  if (interaction.interaction === 'Talk' && conversationResults.matchingInterests > 0) {\n    // Add 0.5 for each matching interest\n    modifiedChance += (0.5 * conversationResults.matchingInterests);\n  }\n  \n  // 1b. Add bonus for matching random topics during conversation\n  if (interaction.interaction === 'Talk' && conversationResults.matchingRandom > 0) {\n    // Add 0.5 for each matching random topic\n    modifiedChance += (0.5 * conversationResults.matchingRandom);\n  }\n  \n  // 2. Add bonus for relationship status buffs\n  if (currentPlayer && currentPlayer.relationships) {\n    const relationship = currentPlayer.relationships.find(rel => rel.name === targetName);\n    if (relationship && relationship.relstatus) {\n      // Check relbuff1, relbuff2, relbuff3\n      for (let i = 1; i <= 3; i++) {\n        const buffField = interaction[`relbuff${i}`];\n        if (buffField && relationship.relstatus.includes(buffField)) {\n          // Add the buff amount (default 0.2 if not specified)\n          const buffAmount = interaction[`relbuffamount${i}`] || 0.2;\n          modifiedChance += buffAmount;\n        }\n      }\n    }\n  }\n  \n  // Cap at 1.0 (100% chance)\n  return Math.min(modifiedChance, 1.0);\n};\n\n// Main conversation sequence handler\nexport const playConversation = async (\n  playerPosition,\n  npcPosition,\n  playerEmoji = '',\n  npcEmoji = '',\n  TILE_SIZE,\n  onComplete,\n  playerId = null,\n  npcId = null,\n  interaction = null,\n  currentPlayer = null,\n  masterResources = null\n) => {\n  console.log(' playConversation started:', { playerPosition, npcPosition, playerEmoji, npcEmoji, playerId, npcId, interaction });\n  \n  // Reset conversation results\n  conversationResults = {\n    matchingInterests: 0,\n    matchingRandom: 0,\n    totalRounds: 0\n  };\n  \n  // Use rounds from interaction if available, otherwise random 1-3\n  const numExchanges = interaction?.rounds || (Math.floor(Math.random() * 3) + 1);\n  \n  // Helper function to get current TILE_SIZE dynamically\n  const getCurrentTileSize = () => {\n    // Try to get the actual tile size from the DOM element\n    const gameContainer = document.querySelector('.homestead');\n    if (gameContainer) {\n      const gridElement = gameContainer.querySelector('.grid');\n      if (gridElement) {\n        const firstTile = gridElement.querySelector('.tile');\n        if (firstTile) {\n          return firstTile.offsetWidth;\n        }\n      }\n    }\n    return TILE_SIZE; // Fallback to passed TILE_SIZE\n  };\n\n  \n  // Create context for topic resolution\n  const topicContext = {\n    playerIcon: currentPlayer?.icon || playerEmoji,\n    npcIcon: npcEmoji,\n    currentPlayer: currentPlayer,\n    interaction: interaction,\n    masterResources: masterResources,\n    npcId: npcId\n  };\n  \n  // Add relationship score if it exists\n  if (currentPlayer?.relationships && npcId) {\n    const relationship = currentPlayer.relationships.find(rel => rel.name === npcId);\n    if (relationship) {\n      topicContext.relscore = relationship.relscore;\n    }\n  }\n  \n  // Play conversation sequence\n  for (let i = 0; i < numExchanges; i++) {\n    const roundNum = i + 1;\n    conversationResults.totalRounds = roundNum;\n    \n    // Player speaks - use provided ID or position-based ID\n    const playerSpeakerId = playerId || `player_${Math.floor(playerPosition.x)}_${Math.floor(playerPosition.y)}`;\n    const playerTopicKey = interaction?.[`playertopic${roundNum}`];\n    const playerTopic = playerTopicKey ? getTopicSymbol(playerTopicKey, topicContext, true) : '';\n    \n    await showSpeech('player', playerSpeakerId, playerEmoji, playerTopic);\n    await animateCharacter('player', playerPosition, getCurrentTileSize());\n    await delay(1500);\n    await hideSpeech(playerSpeakerId);\n    \n    await delay(500); // Brief pause between speakers\n    \n    // NPC responds - use provided ID or position-based ID\n    const npcSpeakerId = npcId || `npc_${Math.floor(npcPosition.x)}_${Math.floor(npcPosition.y)}`;\n    const npcTopicKey = interaction?.[`npctopic${roundNum}`];\n    const npcTopic = npcTopicKey ? getTopicSymbol(npcTopicKey, topicContext, false) : '';\n    \n    // Check if topics match for bonus\n    let isMatch = false;\n    \n    // Check if both topics are interests and if they match\n    if (playerTopicKey === 'interest' && npcTopicKey === 'interest' && playerTopic === npcTopic) {\n      conversationResults.matchingInterests++;\n      isMatch = true;\n      console.log(' Matching interests!', playerTopic, npcTopic, 'Total matches:', conversationResults.matchingInterests);\n    }\n    \n    // Check if both topics are random and if they match\n    if (playerTopicKey === 'random' && npcTopicKey === 'random' && playerTopic === npcTopic) {\n      conversationResults.matchingRandom++;\n      isMatch = true;\n      console.log(' Matching random topics!', playerTopic, npcTopic, 'Total matches:', conversationResults.matchingRandom);\n    }\n    \n    await showSpeech('npc', npcSpeakerId, npcEmoji, npcTopic, isMatch);\n    await animateCharacter('npc', npcPosition, getCurrentTileSize());\n    await delay(1500);\n    await hideSpeech(npcSpeakerId);\n    \n    await delay(500); // Brief pause before next exchange\n  }\n  \n  // Conversation complete - trigger callback with results\n  if (onComplete) {\n    onComplete(conversationResults);\n  }\n};\n\n\n// Get topic emoji based on interaction type and relationship status\nexport const getConversationTopic = (interaction, relationship) => {\n  // TODO: Implement topic selection algorithm\n  // For now, return a default topic\n\n  return '?';\n};\n\n// Convert topic key to actual symbol/emoji\nexport const getTopicSymbol = (topicKey, context = {}, isPlayerTurn = false) => {\n  if (!topicKey) return ''; // Default fallback\n  \n  // Handle emoji shortcuts\n  if (topicKey.startsWith('emoji_')) {\n    const emojiMap = {\n      'emoji_heart': '',\n      'emoji_pinkheart': '',\n      'emoji_friend': '',\n      'emoji_diamond': '',\n      'emoji_forgive': '',\n      'emoji_questionmark': '',\n      'emoji_annoyed': '',\n      'emoji_laughing': '',\n      'emoji_blush': '',\n      'emoji_hug': '',\n      'emoji_wink': '',\n      'emoji_kiss': '',\n      'emoji_angry': '',\n      'emoji_sad': '',\n      'emoji_happy': '',\n      'emoji_thinking': '',\n      'emoji_wow': '',\n      'emoji_love': '',\n      'emoji_cool': '',\n      'emoji_party': '',\n      'emoji_sleepy': '',\n      'emoji_hungry': '',\n      'emoji_brokenheart': ''\n    };\n    return emojiMap[topicKey] || '';\n  }\n  \n  // Handle special context-based topics\n  switch (topicKey) {\n    case 'player':\n      return context.playerIcon || '';\n      \n    case 'npc':\n      return context.npcIcon || '';\n      \n    case 'interest':\n      // Show player's top resources from inventory/backpack\n      if (isPlayerTurn && context.currentPlayer && context.masterResources) {\n        const inventory = context.currentPlayer.inventory || [];\n        const backpack = context.currentPlayer.backpack || [];\n        \n        // Combine inventory and backpack items\n        const allItems = [...inventory, ...backpack];\n        \n        // Sort by quantity and get top 3 (excluding Money)\n        const topItems = allItems\n          .filter(item => item.type !== 'Money' && item.type !== 'Gem')\n          .sort((a, b) => b.quantity - a.quantity)\n          .slice(0, 5)\n          .map(item => {\n            const resource = context.masterResources.find(r => r.type === item.type);\n            return resource?.symbol || item.type;\n          })\n          .filter(symbol => symbol); // Remove any undefined\n        \n        // Return random item from top 3, or fallback\n        if (topItems.length > 0) {\n          return topItems[Math.floor(Math.random() * topItems.length)];\n        }\n      }\n      \n      // For NPC turn, check RelationshipMatrix for interests\n      if (!isPlayerTurn && context.npcId && context.masterResources) {\n        const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n        if (npcEntry) {\n          // Collect all defined interests (interest1, interest2, interest3, etc.)\n          const npcInterests = [];\n          let i = 1;\n          while (npcEntry[`interest${i}`]) {\n            // Look up the interest in masterResources to get its symbol\n            const interest = npcEntry[`interest${i}`];\n            const resource = context.masterResources.find(r => r.type === interest);\n            if (resource && resource.symbol) {\n              npcInterests.push(resource.symbol);\n            }\n            i++;\n          }\n          \n          // If NPC has interests defined, return one randomly\n          if (npcInterests.length > 0) {\n            return npcInterests[Math.floor(Math.random() * npcInterests.length)];\n          }\n        }\n      }\n      \n      // Fallback to default interests\n      const interests = ['', '', '', '', '', '', ''];\n      return interests[Math.floor(Math.random() * interests.length)];\n\n    case 'relationship':\n      // TODO: Add logic based on relationship status\n      return '';\n      \n    case 'random':\n      // TODO: Add random topic selection\n      if (context.relscore > 80) {\n        // If relscore is high, use secret topics\n        const secretTopics = ['', '', '', '', '', '', '', '', '', ''];\n        return secretTopics[Math.floor(Math.random() * secretTopics.length)];\n      } else {\n        const randomTopics = ['', '', '', '', ''];\n        return randomTopics[Math.floor(Math.random() * randomTopics.length)];\n      };\n\n      case 'quest':\n      return '';\n      \n    case 'trade':\n      return '';\n      \n    case 'skill':\n      return '';\n      \n    case 'location':\n      return '';\n      \n    case 'weather':\n      const weatherTopics = ['', '', '', ''];\n      return weatherTopics[Math.floor(Math.random() * weatherTopics.length)];\n      \n    case 'time':\n      return '';\n      \n    default:\n      // If it's not a recognized key, just return it as-is (might be an emoji already)\n      return topicKey;\n  }\n};\n\n\n// Show speech bubble for a character\nconst showSpeech = async (speakerType, speakerId, emoji, topic, isMatch = false) => {\n  console.log(' showSpeech called:', { speakerType, speakerId, emoji, topic, isMatch });\n  ConversationManager.addSpeech(speakerId, emoji, topic || emoji, isMatch);\n};\n\n// Hide speech bubble for a character\nconst hideSpeech = async (speakerId) => {\n  ConversationManager.removeSpeech(speakerId);\n};\n\n// Animate character bouncing\nconst animateCharacter = async (characterType, position, TILE_SIZE) => {\n  // Find the character element based on type and position\n  let characterElement;\n  \n  if (characterType === 'player') {\n    // Find player element - new React components use left/top positioning\n    const playerElements = document.querySelectorAll('.pc');\n    characterElement = Array.from(playerElements).find(el => {\n      // Check both transform (old) and left/top (new) positioning\n      const transform = el.style.transform;\n      const left = parseFloat(el.style.left);\n      const top = parseFloat(el.style.top);\n      \n      if (!isNaN(left) && !isNaN(top)) {\n        // New positioning system\n        const expectedX = position.x * TILE_SIZE;\n        const expectedY = position.y * TILE_SIZE;\n        return Math.abs(left - expectedX) < TILE_SIZE/2 && Math.abs(top - expectedY) < TILE_SIZE/2;\n      } else if (transform) {\n        // Old positioning system fallback\n        const match = transform.match(/translate\\((-?\\d+(?:\\.\\d+)?)px,\\s*(-?\\d+(?:\\.\\d+)?)px\\)/);\n        if (match) {\n          const x = parseFloat(match[1]);\n          const y = parseFloat(match[2]);\n          const expectedX = position.x * TILE_SIZE;\n          const expectedY = position.y * TILE_SIZE;\n          return Math.abs(x - expectedX) < TILE_SIZE/2 && Math.abs(y - expectedY) < TILE_SIZE/2;\n        }\n      }\n      return false;\n    });\n  } else {\n    // Find NPC element - new React components use left/top positioning\n    const npcElements = document.querySelectorAll('.npc');\n    characterElement = Array.from(npcElements).find(el => {\n      // Check both transform (old) and left/top (new) positioning\n      const transform = el.style.transform;\n      const left = parseFloat(el.style.left);\n      const top = parseFloat(el.style.top);\n      \n      if (!isNaN(left) && !isNaN(top)) {\n        // New positioning system\n        const expectedX = position.x * TILE_SIZE;\n        const expectedY = position.y * TILE_SIZE;\n        return Math.abs(left - expectedX) < TILE_SIZE/2 && Math.abs(top - expectedY) < TILE_SIZE/2;\n      } else if (transform) {\n        // Old positioning system fallback\n        const match = transform.match(/translate\\((-?\\d+(?:\\.\\d+)?)px,\\s*(-?\\d+(?:\\.\\d+)?)px\\)/);\n        if (match) {\n          const x = parseFloat(match[1]);\n          const y = parseFloat(match[2]);\n          const expectedX = position.x * TILE_SIZE;\n          const expectedY = position.y * TILE_SIZE;\n          return Math.abs(x - expectedX) < TILE_SIZE/2 && Math.abs(y - expectedY) < TILE_SIZE/2;\n        }\n      }\n      return false;\n    });\n  }\n  \n  if (characterElement) {\n    // Simply add the animation class\n    characterElement.classList.add('speaking-animation');\n    \n    // Remove animation class after duration\n    setTimeout(() => {\n      characterElement.classList.remove('speaking-animation');\n    }, 1500);\n  }\n};\n\n// Utility delay function\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n// Component for rendering conversation UI if needed\nconst ConversationUI = ({ isActive, playerData, npcData }) => {\n  if (!isActive) return null;\n  \n  return (\n    <div className=\"conversation-overlay\">\n      {/* This can be used for additional UI elements if needed */}\n    </div>\n  );\n};\n\nexport default ConversationUI;","import React, { useState, useEffect } from 'react';\nimport { \n  updateRelationship, \n  updateRelationshipStatus, \n  getNPCReactions, \n  checkOtherRelationships,\n  generateRelationshipStatusMessage \n} from './RelationshipUtils';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { playConversation, calculateModifiedChance } from './Conversation';\nimport ConversationManager from './ConversationManager';\nimport '../../UI/SharedButtons.css';\n\nconst RelationshipCard = ({ \n  currentPlayer,\n  setCurrentPlayer,\n  targetName,\n  targetType = 'npc', // 'npc' or 'player'\n  targetEmoji = null, // Optional emoji for the target\n  onRelationshipChange,\n  showActions = true,\n  compact = false,\n  masterInteractions = [],\n  updateStatus,\n  checkDistance = null, // Optional function to check if target is in range\n  onInteractionClick = null, // Optional function to handle zoom/camera when interaction is clicked\n  playerPosition = null, // Player's grid position for conversation\n  targetPosition = null, // Target's grid position for conversation\n  TILE_SIZE = 30, // Tile size for positioning speech bubbles\n  masterResources = [] // Master resources for topic resolution\n}) => {\n  const [relationship, setRelationship] = useState(null);\n  const [isInitializing, setIsInitializing] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const strings = useStrings();\n\n  useEffect(() => {\n    loadOrCreateRelationship();\n  }, [currentPlayer?.playerId, targetName]);\n\n  const loadOrCreateRelationship = async () => {\n    if (!currentPlayer || !targetName) {\n      return;\n    }\n\n    // Find existing relationship\n    const existingRel = currentPlayer.relationships?.find(rel => rel.name === targetName);\n    \n    if (existingRel) {\n      setRelationship(existingRel);\n    } else if (!isInitializing) {\n      // Create new relationship with score 0\n      setIsInitializing(true);\n      const result = await updateRelationship(currentPlayer, targetName, 0);\n      \n      if (result.success && result.player) {\n        // Update the currentPlayer with the new data\n        setCurrentPlayer(result.player);\n        const newRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(newRel || {\n          name: targetName,\n          relscore: 0\n        });\n      }\n      setIsInitializing(false);\n    }\n  };\n\n  const handleInteraction = async (interaction) => {\n    if (!relationship || isProcessing) return;\n    \n    setIsProcessing(true);\n    \n    // Check distance first, before any zoom/camera operations\n    if (checkDistance && !checkDistance()) {\n      if (updateStatus) {\n        updateStatus(620); // \"You are too far away\"\n      }\n      setIsProcessing(false);\n      return;\n    }\n    \n    // Handle zoom and camera centering only after distance check passes\n    if (onInteractionClick) {\n      await onInteractionClick();\n    }\n    \n    // Check if interaction is allowed based on other relationships\n    const relationshipCheck = checkOtherRelationships(currentPlayer, targetName, interaction);\n    if (!relationshipCheck.allowed) {\n      if (updateStatus) {\n        updateStatus(` ${relationshipCheck.reason}`);\n      }\n      setIsProcessing(false);\n      return;\n    }\n    \n    // Play conversation sequence if positions are provided\n    if (playerPosition && targetPosition) {\n      const playerEmoji = currentPlayer.icon || '';\n      const defaultTargetEmoji = targetType === 'npc' ? '' : '';\n      const conversationTargetEmoji = targetEmoji || defaultTargetEmoji;\n      \n      // Use player ID for consistent tracking\n      const playerId = currentPlayer._id?.toString() || currentPlayer.playerId;\n      const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n      \n      // Store conversation results for chance calculation\n      let conversationResults = null;\n      \n      await playConversation(\n        playerPosition,\n        targetPosition,\n        playerEmoji,\n        conversationTargetEmoji,\n        TILE_SIZE,\n        (results) => {\n          // Store conversation results\n          conversationResults = results;\n        },\n        playerId,\n        targetId,\n        interaction,\n        currentPlayer,\n        masterResources\n      );\n      \n      // Calculate modified chance based on conversation results\n      const baseChance = interaction.chance || 1.0;\n      const modifiedChance = conversationResults \n        ? calculateModifiedChance(baseChance, interaction, conversationResults, currentPlayer, targetName)\n        : baseChance;\n      \n      console.log(' Chance calculation:', {\n        baseChance,\n        conversationResults,\n        modifiedChance\n      });\n      \n      // Roll for success based on modified chance\n      const randomRoll = Math.random();\n      const success = randomRoll <= modifiedChance;\n      \n      // Continue with success/failure handling\n      await handleInteractionOutcome(success, interaction);\n    } else {\n      // No conversation - use base chance\n      const randomRoll = Math.random();\n      const success = randomRoll <= (interaction.chance || 1.0);\n      \n      // Continue with success/failure handling\n      await handleInteractionOutcome(success, interaction);\n    }\n  };\n  \n  // Helper function to handle interaction outcome\n  const handleInteractionOutcome = async (success, interaction) => {\n    if (success) {\n      // Update relationship score\n      const scoreChange = interaction.relscoreresult || 0;\n      const result = await updateRelationship(currentPlayer, targetName, scoreChange);\n      \n      if (result.success && result.player) {\n        setCurrentPlayer(result.player);\n        let updatedRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(updatedRel);\n        \n        // Add relationship status if specified\n        if (interaction.relbitadd) {\n          const statusResult = await updateRelationshipStatus(\n            currentPlayer, \n            targetName, \n            interaction.relbitadd, \n            true\n          );\n          \n          if (statusResult.success && statusResult.player) {\n            setCurrentPlayer(statusResult.player);\n            updatedRel = statusResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n            \n            // Check for NPC reactions only if this is an NPC\n            let npcReactions = [];\n            if (targetType === 'npc') {\n              npcReactions = getNPCReactions(targetName, interaction.relbitadd);\n              \n              // Apply each reaction\n              for (const reaction of npcReactions) {\n                // Clear all statuses if needed\n                if (reaction.clearAllStatuses) {\n                  // First, set the score to the exact value\n                  const scoreResult = await updateRelationship(\n                    statusResult.player, \n                    reaction.npc, \n                    reaction.setScore - (statusResult.player.relationships?.find(r => r.name === reaction.npc)?.relscore || 0)\n                  );\n                  \n                  if (scoreResult.success && scoreResult.player) {\n                    // Clear all statuses dynamically from masterInteractions\n                    const statuses = masterInteractions\n                      .filter(item => item.isaninteraction === false)\n                      .map(item => item.interaction.toLowerCase());\n                    for (const status of statuses) {\n                      await updateRelationshipStatus(scoreResult.player, reaction.npc, status, false);\n                    }\n                    \n                    // Set new status\n                    if (reaction.setStatus) {\n                      // First ensure they are \"met\"\n                      const metResult = await updateRelationshipStatus(\n                        scoreResult.player, \n                        reaction.npc, \n                        'met', \n                        true\n                      );\n                      \n                      // Then set the reaction status\n                      const finalResult = await updateRelationshipStatus(\n                        metResult.success ? metResult.player : scoreResult.player, \n                        reaction.npc, \n                        reaction.setStatus, \n                        true\n                      );\n                      if (finalResult.success && finalResult.player) {\n                        setCurrentPlayer(finalResult.player);\n                      }\n                    }\n                  }\n                } else if (reaction.scoreChange) {\n                  // Just change the score\n                  const scoreResult = await updateRelationship(\n                    statusResult.player, \n                    reaction.npc, \n                    reaction.scoreChange\n                  );\n                  if (scoreResult.success && scoreResult.player) {\n                    // Ensure they are \"met\" if relationship exists and score is positive\n                    const updatedRelWithReactor = scoreResult.player.relationships?.find(r => r.name === reaction.npc);\n                    if (updatedRelWithReactor && !updatedRelWithReactor.met) {\n                      const metResult = await updateRelationshipStatus(\n                        scoreResult.player, \n                        reaction.npc, \n                        'met', \n                        true\n                      );\n                      if (metResult.success && metResult.player) {\n                        setCurrentPlayer(metResult.player);\n                      } else {\n                        setCurrentPlayer(scoreResult.player);\n                      }\n                    } else {\n                      setCurrentPlayer(scoreResult.player);\n                    }\n                  }\n                }\n              }\n            }\n            \n            // Generate and display status message for successful interaction\n            if (updateStatus) {\n              const statusMessage = generateRelationshipStatusMessage(\n                targetName, \n                interaction.relbitadd, \n                true, \n                npcReactions,\n                strings\n              );\n              if (statusMessage) {\n                updateStatus(statusMessage);\n              }\n            }\n          }\n        }\n        \n        // Remove relationship status if specified\n        if (interaction.relbitremove) {\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer, \n            targetName, \n            interaction.relbitremove, \n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n        \n        // Check if any relationship statuses should be removed due to score falling below minimum\n        const statusesToRemove = masterInteractions.filter(item => {\n          // Only check non-interaction status items\n          if (item.isaninteraction !== false) return false;\n          \n          // Check if this status has a minimum score requirement\n          if (typeof item.relscoremin !== 'number') return false;\n          \n          // Check if the new score is below the minimum and the relationship has this status\n          const statusKey = item.interaction.toLowerCase();\n          return updatedRel.relscore < item.relscoremin && updatedRel[statusKey] === true;\n        });\n        \n        // Remove any statuses that no longer meet minimum score requirements\n        for (const statusItem of statusesToRemove) {\n          const statusKey = statusItem.interaction.toLowerCase();\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer,\n            targetName,\n            statusKey,\n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n      \n        // Show relationship outcome VFX\n        if (scoreChange !== 0) {\n          const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n          ConversationManager.showOutcome(targetId, scoreChange > 0);\n        }\n        \n      }\n    } else {\n      // Failed interaction - decrease score by same amount\n      const scoreChange = -(interaction.relscoreresult || 0);\n      const result = await updateRelationship(currentPlayer, targetName, scoreChange);\n      \n      if (result.success && result.player) {\n        setCurrentPlayer(result.player);\n        let updatedRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(updatedRel);\n        \n        // Check if any relationship statuses should be removed due to score falling below minimum\n        const statusesToRemove = masterInteractions.filter(item => {\n          // Only check non-interaction status items\n          if (item.isaninteraction !== false) return false;\n          \n          // Check if this status has a minimum score requirement\n          if (typeof item.relscoremin !== 'number') return false;\n          \n          // Check if the new score is below the minimum and the relationship has this status\n          const statusKey = item.interaction.toLowerCase();\n          return updatedRel.relscore < item.relscoremin && updatedRel[statusKey] === true;\n        });\n        \n        // Remove any statuses that no longer meet minimum score requirements\n        for (const statusItem of statusesToRemove) {\n          const statusKey = statusItem.interaction.toLowerCase();\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer,\n            targetName,\n            statusKey,\n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n      }\n      \n      // Show relationship outcome VFX for failed interaction\n      if (scoreChange < 0) {\n        const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n        ConversationManager.showOutcome(targetId, false);\n      }\n    }\n    \n    // Call the parent's relationship change handler\n    if (onRelationshipChange) {\n      onRelationshipChange(interaction, success);\n    }\n    \n    setIsProcessing(false);\n  };\n\n  if (!relationship) {\n    return null;\n  }\n\n  // Determine color based on score\n  const getScoreColor = (score) => {\n    if (score > 50) return '#4CAF50'; // Green\n    if (score > 0) return '#8BC34A'; // Light Green\n    if (score === 0) return '#9E9E9E'; // Gray\n    if (score > -50) return '#FF9800'; // Orange\n    return '#F44336'; // Red\n  };\n\n  const scoreColor = getScoreColor(relationship.relscore);\n\n  // Get visible relationship statuses early so we can use in both compact and full views\n  const visibleStatuses = masterInteractions.filter(item => {\n    // Only consider non-interaction items\n    if (item.isaninteraction !== false) return false;\n    \n    // Check if visible and if the relationship has this status\n    const statusKey = item.interaction.toLowerCase();\n    return item.isvisible && relationship[statusKey] === true;\n  });\n\n  if (compact) {\n    // Compact version for inline display\n    return (\n      <div className=\"relationship-card-compact\">\n        <span className=\"relationship-name\">{targetName}</span>\n        <span className=\"relationship-score\" style={{ color: scoreColor }}>\n          [{relationship.relscore}]\n        </span>\n        {/* Status flags */}\n        {visibleStatuses.map((status) => (\n          <span key={status.interaction} className=\"relationship-status\">\n             {getLocalizedString(status.interaction, strings)}\n          </span>\n        ))}\n      </div>\n    );\n  }\n\n  // Get available interactions based on visibility and relationship score\n  const availableInteractions = masterInteractions.filter(interaction => {\n    // Only include actual interactions\n    if (interaction.isaninteraction === false) return false;\n    // Only show visible interactions\n    if (!interaction.isvisible) return false;\n    // Check if relationship score is within min/max range\n    const minScore = interaction.relscoremin ?? -100;\n    const maxScore = interaction.relscoremax ?? 100;\n    if (relationship.relscore < minScore || relationship.relscore > maxScore) return false;\n    \n    // Check if required relationship status exists\n    if (interaction.relbitrequired && !relationship[interaction.relbitrequired]) {\n      return false; // Doesn't have required status\n    }\n    \n    // Check relbitblock fields - hide interaction if any blocked status exists\n    for (let i = 1; i <= 3; i++) {\n      const blockField = interaction[`relbitblock${i}`];\n      if (blockField) {\n        if (blockField === 'all') {\n          // Block if ANY relationship status exists\n          const hasAnyStatus = relationship.met || relationship.friend || \n                             relationship.crush || relationship.love || \n                             relationship.married || relationship.rival;\n          if (hasAnyStatus) return false;\n        } else if (relationship[blockField]) {\n          // Block if specific status exists\n          return false;\n        }\n      }\n    }\n    \n    return true;\n  });\n\n  // Full card version\n  return (\n    <div className=\"relationship-card\">\n      <div className=\"relationship-card-content\">\n        <h3 className=\"relationship-title\">{strings[601]}</h3>\n        \n        <div className=\"relationship-score-bar-container\">\n          <div className=\"relationship-score-gradient\">\n            <div \n              className=\"relationship-score-marker\"\n              style={{ \n                left: `${((relationship.relscore + 100) / 200) * 100}%`\n              }}\n            />\n          </div>\n        </div>\n\n        {/* Status flags display */}\n        <div className=\"relationship-status-display\">\n          {visibleStatuses.map((status) => (\n            <span \n              key={status.interaction}\n              className={`relationship-status-badge ${status.interaction.toLowerCase()}`}\n            >\n              {getLocalizedString(status.interaction, strings)}\n            </span>\n          ))}\n        </div>\n\n        {showActions && availableInteractions.length > 0 && (\n          <div className=\"relationship-actions shared-buttons\">\n            {availableInteractions.map((interaction) => (\n              <button\n                key={interaction.interaction} \n                className=\"btn-basic\"\n                onClick={() => handleInteraction(interaction)}\n                disabled={isProcessing}\n              >\n                {getLocalizedString(interaction.interaction, strings)}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(RelationshipCard);","import React, { useEffect, useRef } from 'react';\nimport ConversationManager from '../Relationships/ConversationManager';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\n\nconst HealerInteraction = ({\n  isHealing,\n  currentPlayer,\n  TILE_SIZE,\n  healAmount,\n  onHealingComplete\n}) => {\n  const animationTimeoutRef = useRef(null);\n  const conversationTimeoutRef = useRef(null);\n\n  useEffect(() => {\n    // Get player position for speech bubble\n    const gridId = currentPlayer?.location?.g;\n    const playerId = currentPlayer._id?.toString();\n    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    const speakerId = playerId || `player_${Math.floor(playerInGridState?.position?.x || 0)}_${Math.floor(playerInGridState?.position?.y || 0)}`;\n    \n    if (isHealing && currentPlayer && playerInGridState?.position) {\n      console.log(' Starting heal animation');\n      // Show prayer bubble over player\n      ConversationManager.addSpeech(speakerId, '', '', false);\n      \n      // Animate player bouncing\n      animatePlayer(playerInGridState.position, TILE_SIZE);\n      \n      // Remove speech bubble after animation\n      conversationTimeoutRef.current = setTimeout(() => {\n        console.log(' Removing speech bubble after timeout');\n        ConversationManager.removeSpeech(speakerId);\n      }, 1500);\n    }\n    \n    // Cleanup function - runs when isHealing changes or component unmounts\n    return () => {\n      console.log(' Cleanup - isHealing changed to:', isHealing);\n      if (animationTimeoutRef.current) {\n        clearTimeout(animationTimeoutRef.current);\n      }\n      if (conversationTimeoutRef.current) {\n        clearTimeout(conversationTimeoutRef.current);\n      }\n      \n      // Ensure speech bubble is removed\n      ConversationManager.removeSpeech(speakerId);\n      \n      // Ensure animation is removed\n      const playerElements = document.querySelectorAll('.pc');\n      playerElements.forEach(el => {\n        el.classList.remove('speaking-animation');\n      });\n    };\n  }, [isHealing, currentPlayer, TILE_SIZE]);\n  \n  // Animate player bouncing - similar to conversation\n  const animatePlayer = (position, TILE_SIZE) => {\n    // First remove any existing animation from all players\n    const allPlayerElements = document.querySelectorAll('.pc');\n    allPlayerElements.forEach(el => {\n      el.classList.remove('speaking-animation');\n    });\n    \n    // Find the specific player element\n    const playerElement = Array.from(allPlayerElements).find(el => {\n      const left = parseFloat(el.style.left);\n      const top = parseFloat(el.style.top);\n      \n      if (!isNaN(left) && !isNaN(top)) {\n        const expectedX = position.x * TILE_SIZE;\n        const expectedY = position.y * TILE_SIZE;\n        return Math.abs(left - expectedX) < TILE_SIZE/2 && Math.abs(top - expectedY) < TILE_SIZE/2;\n      }\n      return false;\n    });\n    \n    if (playerElement) {\n      // Add bounce animation class\n      playerElement.classList.add('speaking-animation');\n      \n      // Remove animation after duration\n      animationTimeoutRef.current = setTimeout(() => {\n        playerElement.classList.remove('speaking-animation');\n      }, 1500);\n    }\n  };\n  \n  // This component doesn't render anything visible - it just manages the animation\n  return null;\n};\n\nexport default HealerInteraction;","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport '../../UI/SharedButtons.css';\nimport '../Crafting/ScrollStation.css'; // Import for shared station panel styles\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford, hasRoomFor } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { gainIngredients, spendIngredients } from '../../Utils/InventoryManagement';\nimport { QuestGiverButton } from '../../UI/QuestButton';\nimport { modifyPlayerStatsInPlayer, modifyPlayerStatsInGridState } from '../../Utils/playerManagement';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport RelationshipCard from '../Relationships/RelationshipCard';\nimport { getRelationshipStatus, getRelationshipMultiplier } from '../Relationships/RelationshipUtils';\nimport '../Relationships/Relationships.css';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { checkDeveloperStatus } from '../../Utils/appUtils';\nimport questCache from '../../Utils/QuestCache';\nimport { calculateDistance, getDerivedRange } from '../../Utils/worldHelpers';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport HealerInteraction from './HealerInteraction';\n\nconst NPCPanel = ({\n  onClose,\n  npcData,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterInteractions,\n  masterTraders,\n  masterTrophies,\n  zoomLevel,\n  setZoomLevel,\n  centerCameraOnPlayer,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [questList, setQuestList] = useState([]);\n  const [healRecipes, setHealRecipes] = useState([]);\n  const [tradeRecipes, setTradeRecipes] = useState([]);\n  const [statusMessage, setStatusMessage] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [canQuest, setCanQuest] = useState(false);\n  const [hasHiddenQuests, setHasHiddenQuests] = useState(false);\n  const [questThreshold, setQuestThreshold] = useState(0);\n  const [canTrade, setCanTrade] = useState(false);\n  const [tradeThreshold, setTradeThreshold] = useState(0);\n  const [isDeveloper, setIsDeveloper] = useState(false);\n  const [isHealing, setIsHealing] = useState(false); // Prevent spam-clicking heal button\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const COOLDOWN_DURATION = 1500; // 1500ms cooldown (3x longer than terraform)\n\n\n  // Ensure npcData has default values\n  if (!npcData) {\n    console.warn(\"NPCPanel was opened with missing npcData.\");\n    npcData = { type: \"Unknown NPC\", symbol: \"\" }; // Provide default fallback values\n  }\n\n  // Check developer status\n  useEffect(() => {\n    const checkStatus = async () => {\n      if (currentPlayer?.username) {\n        const devStatus = await checkDeveloperStatus(currentPlayer.username);\n        setIsDeveloper(devStatus);\n      }\n    };\n    checkStatus();\n  }, [currentPlayer]);\n\n  // Check if player can quest based on relationship\n  useEffect(() => {\n    if (masterInteractions && npcData && npcData.action === 'quest') {\n      // Find the quest interaction threshold\n      const questInteraction = masterInteractions.find(interaction => \n        interaction.interaction === 'Quest' || interaction.interaction === 'quest'\n      );\n      \n      if (questInteraction) {\n        setQuestThreshold(questInteraction.relscoremin || 0);\n        \n        // Get current relationship status\n        const relationship = getRelationshipStatus(currentPlayer, npcData.type);\n        const currentScore = relationship?.relscore || 0;\n        \n        setCanQuest(currentScore >= questInteraction.relscoremin);\n      } else {\n        // If no quest threshold defined, allow questing\n        setCanQuest(true);\n      }\n    }\n    \n    // Check if player can trade based on relationship\n    if (npcData && npcData.action === 'trade') {\n      const tradeInteraction = masterInteractions.find(interaction => \n        interaction.interaction === 'Trade' || interaction.interaction === 'trade'\n      );\n      \n      if (tradeInteraction) {\n        setTradeThreshold(tradeInteraction.relscoremin || 0);\n        \n        // Get current relationship status\n        const relationship = getRelationshipStatus(currentPlayer, npcData.type);\n        const currentScore = relationship?.relscore || 0;\n        \n        setCanTrade(currentScore >= tradeInteraction.relscoremin);\n      } else {\n        // If no trade threshold defined, allow trading\n        setCanTrade(true);\n      }\n    }\n  }, [masterInteractions, npcData, currentPlayer]);\n\n  // Handle quests or healing logic\n  useEffect(() => {\n    if (!npcData || !npcData.type) return;\n\n    if (npcData.action === 'quest') {\n      // Add a small delay to debounce rapid changes\n      const timeoutId = setTimeout(() => {\n        fetchQuests();\n      }, 100);\n      \n      return () => clearTimeout(timeoutId);\n    } else if (npcData.action === 'heal') {\n      const filteredRecipes = masterResources.filter((resource) => resource.type === npcData.type);\n      setHealRecipes(filteredRecipes);\n    } else if (npcData.action === 'trade') {\n      // Find this trader in masterTraders\n      const trader = masterTraders?.find(t => t.trader === npcData.type);\n      \n      if (trader && trader.trades) {\n        // Transform trader.trades into the format expected by the rest of the component\n        const filteredRecipes = trader.trades.map(trade => {\n          // Get the symbol from masterResources\n          const resourceDef = masterResources.find(r => r.type === trade.gives.type);\n          \n          const recipe = {\n            type: trade.gives.type,\n            symbol: resourceDef?.symbol || '?',\n            tradeqty: trade.gives.quantity,\n            requiresArray: trade.requires, // Store the full requires array for dynamic ingredients\n            requires: trade.requiresSkill || null, // Keep 'requires' for skill requirements\n            source: npcData.type,\n            gemcost: resourceDef?.gemcost || null\n          };\n          \n          // Also add legacy format for backward compatibility\n          trade.requires.forEach((req, index) => {\n            recipe[`ingredient${index + 1}`] = req.type;\n            recipe[`ingredient${index + 1}qty`] = req.quantity;\n          });\n          \n          return recipe;\n        });\n        \n        setTradeRecipes(filteredRecipes);\n      } else {\n        // Fallback to old method if masterTraders is not available\n        const filteredRecipes = masterResources.filter((resource) => resource.source === npcData.type);\n        setTradeRecipes(filteredRecipes);\n      }\n    }\n  }, [npcData, currentPlayer?.activeQuests, currentPlayer?.completedQuests, currentPlayer?.ftuestep, masterResources, masterTraders]);\n\n  \n  ////////////////////////////////////////////////////////////\n  ////////////////////// Fetch QUESTS for QUEST NPCs\n  const fetchQuests = async () => {\n    try {\n      // Use cached quests instead of direct API call\n      const allQuests = await questCache.getQuests();\n\n      // Use new quest filtering logic\n      let npcQuests = allQuests\n        .filter((quest) => quest.giver === npcData.type)\n        .filter((quest) => {\n          const activeQuest = currentPlayer.activeQuests.find(q => q.questId === quest.title);\n          const isInCompleted = currentPlayer.completedQuests.some(q => q.questId === quest.title);        \n          if (activeQuest) {\n            const shouldShow = activeQuest.completed && !activeQuest.rewardCollected;\n            return shouldShow;\n          }          \n          const shouldShow = (quest.repeatable === true || quest.repeatable === 'true') || !isInCompleted;\n          return shouldShow;\n        });\n\n      // Check if any quests exist that are hidden due to relationship requirements\n      const relationship = currentPlayer.relationships?.find(rel => rel.name === npcData.type);\n      const questsHiddenByRelationship = npcQuests.some((quest) => {\n        // Check if quest has relationship requirements that aren't met\n        if (quest.rel || quest.relscore) {\n          // If no relationship exists with this NPC, quest is hidden\n          if (!relationship) return true;\n          // Check relationship status requirement\n          if (quest.rel && relationship[quest.rel] !== true) return true;\n          // Check relationship score requirement\n          if (quest.relscore && (relationship.relscore || 0) < quest.relscore) return true;\n        }\n        return false;\n      });\n\n      // Filter by relationship requirements (existing logic)\n      npcQuests = npcQuests.filter((quest) => {\n        // Check if quest has relationship requirements\n        if (quest.rel || quest.relscore) {\n          // If no relationship exists with this NPC, exclude the quest\n          if (!relationship) return false;\n          // Check relationship status requirement\n          if (quest.rel && relationship[quest.rel] !== true) { return false; }\n          // Check relationship score requirement\n          if (quest.relscore && (relationship.relscore || 0) < quest.relscore) { return false; }\n        }\n        return true;\n      });\n\n      // Filter by FTUE step only if player is a first-time user\n      if (currentPlayer.firsttimeuser === true) {\n        // Apply FTUE filtering to the already-filtered npcQuests, not the original response.data\n        npcQuests = npcQuests.filter((quest) => {\n          // For first-time users:\n          // 1. Quest must have ftuestep defined (not null, undefined, or empty string)\n          // 2. Quest ftuestep must be <= current player ftuestep\n          const hasFtuestep = quest.ftuestep != null && \n                             quest.ftuestep !== undefined && \n                             quest.ftuestep !== '' && \n                             quest.ftuestep !== 0;\n          \n          if (!hasFtuestep) {\n            return false;\n          } else if (quest.ftuestep > (currentPlayer.ftuestep || 0)) {\n            return false;\n          } else {\n            return true;\n          }\n        });\n      }\n      setQuestList(npcQuests);\n      setHasHiddenQuests(questsHiddenByRelationship);\n    } catch (error) {\n      console.error('Error fetching quests:', error);\n    }\n  };\n\n  const handleAcceptQuest = async (questTitle) => {\n    if (!questTitle) return;\n    // Find the accepted quest in questList\n    const acceptedQuest = questList.find(q => q.title === questTitle);\n    if (!acceptedQuest) {\n        console.error(`Quest \"${questTitle}\" not found in available quests.`);\n        return;\n    }\n    // Prepare progress tracking for skill-based goals\n    let initialProgress = { goal1: 0, goal2: 0, goal3: 0 }; // Explicitly initialize\n    let goalsCompleted = 0;\n    let totalGoals = 0;\n\n    for (let i = 1; i <= 3; i++) {\n      const goalAction = acceptedQuest[`goal${i}action`];\n      const goalItem = acceptedQuest[`goal${i}item`];\n      const goalQty = acceptedQuest[`goal${i}qty`];\n\n      if (!goalAction || !goalItem || !goalQty) continue; // Skip undefined goals\n      totalGoals++; // Count valid goals\n\n      if (goalAction === \"Gain skill with\") {\n          // Check if player already has the required skill\n          const playerHasSkill = currentPlayer.skills?.some(skill => skill.type === goalItem);\n          if (playerHasSkill) {\n              initialProgress[`goal${i}`] = 1; // Pre-mark as completed\n              goalsCompleted++;\n          } else {\n              initialProgress[`goal${i}`] = 0; // Start at 0\n          }\n      } else {\n          initialProgress[`goal${i}`] = 0; // Default progress for other goals\n      }\n    }\n    // If all goals are completed before even accepting, mark the quest as completed\n    const isQuestCompleted = totalGoals > 0 && goalsCompleted === totalGoals;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/add-player-quest`, {\n        playerId: currentPlayer.playerId,\n        questId: questTitle,\n        startTime: Date.now(),\n        progress: initialProgress, // Send pre-computed progress\n        completed: isQuestCompleted, // If all goals are done, mark it completed\n      });\n\n      if (response.data.success) {\n        setCurrentPlayer(response.data.player); // Update player after quest is added\n        updateStatus(202);\n        // No need to invalidate cache when accepting quests\n      } else {\n        setStatusMessage(`Failed to accept quest: ${response.data.error}`);\n      }\n    } catch (error) {\n      console.error('Error accepting quest:', error);\n      setStatusMessage('Error accepting quest. Check console.');\n    }\n  };\n\nconst handleGetReward = async (quest) => {\n    try {\n      // Get relationship-based multiplier from RelationshipMatrix data\n      const { multiplier, bonusMessage } = getRelationshipMultiplier(npcData.type, currentPlayer, strings);\n      const rewardQuantity = Math.floor((quest.rewardqty || 1) * multiplier);\n      \n      // Ensure inventory and backpack are valid arrays\n      const safeInventory = Array.isArray(inventory) ? inventory : [];\n      const safeBackpack = Array.isArray(backpack) ? backpack : [];\n      \n      const success = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: quest.reward,\n        quantity: rewardQuantity,\n        inventory: safeInventory,\n        backpack: safeBackpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n      // Check if gainIngredients failed (returns object with success: false, or falsy value)\n      if (success !== true && (!success || success.success === false)) return;\n\n      // Award trophies for specific quest rewards\n      try {\n        if (quest.reward === \"Prospero's Orb\") {\n          console.log(` Awarding Prospero's Orb trophy for collecting ${rewardQuantity} orb(s)`);\n          \n          // Award the Count-type trophy for each orb collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Prospero's Orb\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Prospero's Orb trophy instance(s)`);\n        } else if (quest.reward === \"Skeleton Key\") {\n          console.log(` Awarding Skeleton Key trophy for collecting ${rewardQuantity} key(s)`);\n          \n          // Award the Count-type trophy for each key collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Skeleton Key\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Skeleton Key trophy instance(s)`);\n        } else if (quest.reward === \"Golden Key\") {\n          console.log(` Awarding Golden Key trophy for collecting ${rewardQuantity} key(s)`);\n          \n          // Award the Count-type trophy for each key collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Golden Key\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Golden Key trophy instance(s)`);\n        }\n        \n      } catch (error) {\n        console.error(' Error awarding quest reward trophy:', error);\n        // Don't fail the quest completion if trophy awarding fails\n      }\n\n      // Track quest progress for \"Collect\" type quests (use multiplied quantity)\n      await trackQuestProgress(currentPlayer, 'Collect', quest.reward, rewardQuantity, setCurrentPlayer);\n\n      let updatedCompletedQuests = currentPlayer.completedQuests.map((q) =>\n        q.questId === quest.title ? { ...q, rewardCollected: true } : q\n      );\n      const alreadyCompleted = updatedCompletedQuests.some(q => q.questId === quest.title);\n      if (!alreadyCompleted) {\n        updatedCompletedQuests.push({\n          questId: quest.title,\n          rewardCollected: true,\n          timestamp: Date.now(),\n        });\n      }\n\n      // Remove the quest from activeQuests\n      const updatedActiveQuests = currentPlayer.activeQuests.filter(q => q.questId !== quest.title);\n\n      const updatedPlayer = {\n        ...currentPlayer,\n        completedQuests: updatedCompletedQuests,\n        activeQuests: updatedActiveQuests,\n      };\n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          completedQuests: updatedPlayer.completedQuests,\n          activeQuests: updatedActiveQuests,\n        },\n      }).then((result) => {\n      });\n      // Don't call refreshPlayerAfterInventoryUpdate here - gainIngredients already updated the state\n      // and calling refresh would overwrite the local updates with potentially stale server data\n      // Update player with quest progress but preserve the inventory that was just updated\n      setCurrentPlayer(prev => ({\n        ...prev,\n        completedQuests: updatedPlayer.completedQuests,\n        activeQuests: updatedActiveQuests,\n      }));\n      setQuestList((prevList) => prevList.filter((q) => q.title !== quest.title));\n      \n      // Show quest complete message with bonus if applicable\n      if (bonusMessage) {\n        updateStatus(`Action item complete! Received ${rewardQuantity} ${getLocalizedString(quest.reward, strings)}. ${bonusMessage}`);\n      } else {\n        updateStatus(201);\n      }\n\n    } catch (error) {\n      console.error('Error collecting quest reward:', error);\n      alert('Failed to collect quest reward.');\n    }\n  };\n\n\nconst handleGemPurchase = async (modifiedRecipe, actionType) => {\n    // This is called by the gem button with a recipe modified to include gems\n    // Route to the appropriate handler based on action type\n    if (actionType === 'heal') {\n      return handleHeal(modifiedRecipe);\n    } else if (actionType === 'trade') {\n      return handleTrade(modifiedRecipe);\n    }\n  };\n\nconst handleHeal = async (recipe) => {\n    setErrorMessage('');\n\n    const itemKey = `heal-${recipe.type}`;\n    if (!recipe || isHealing || coolingDownItems.has(itemKey)) {\n      if (!recipe) setErrorMessage('Invalid healing recipe selected.');\n      return;\n    }\n    \n    // Set healing flag and cooldown to prevent spam clicks\n    setIsHealing(true);\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n    \n    // Set timeout for cooldown removal\n    setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n    // Fetch current HP and Max HP from playersInGridManager\n    const gridId = currentPlayer?.location?.g;\n    const playerId = currentPlayer._id?.toString();\n    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    if (!playerInGridState) {\n      console.error(`Player ${currentPlayer.username} not found in NPCsInGrid.`);\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    const currentHp = playerInGridState.hp;\n    const maxHp = playerInGridState.maxhp;\n  \n    // Check if healer has HP remaining\n    const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n    if (healerInGrid && healerInGrid.hp !== undefined && healerInGrid.hp <= 0) {\n      updateStatus(`${getLocalizedString(npcData.type, strings)} has no heals remaining.`);\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    \n    // Healing logic with NPCsInGrid HP\n    if (npcData.output === 'hp') {\n      if (currentHp >= maxHp) {\n        updateStatus(401);  // Player is already at full HP\n        setTimeout(() => {\n          setIsHealing(false);\n        }, COOLDOWN_DURATION);\n        return;\n      }\n    }\n    const spendResult = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!spendResult) {\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    \n    // Refresh player to update money display\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    const healAmount = npcData.qtycollected;\n    const statToMod = 'hp';\n    const amountToMod = Math.min(healAmount, maxHp - currentHp);  // Ensure it doesn't exceed max HP\n\n    try {\n      await modifyPlayerStatsInGridState(statToMod, amountToMod, currentPlayer._id, gridId);\n      setCurrentPlayer((prev) => ({\n        ...prev,\n        hp: Math.min(prev.maxhp, prev.hp + amountToMod),\n      }));  \n      updateStatus(`${strings[405]}${amountToMod}.`);\n\n      // Deduct 1 HP from the healer NPC\n      const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n      if (healerInGrid && healerInGrid.hp !== undefined) {\n        const newHealerHP = healerInGrid.hp - 1;\n        \n        if (newHealerHP <= 0) {\n          // Remove the healer from the grid when HP reaches 0\n          await NPCsInGridManager.removeNPC(gridId, npcData.id);\n          updateStatus(`${getLocalizedString(npcData.type, strings)} has been exhausted and disappeared.`);\n          onClose(); // Close the panel since the NPC is gone\n        } else {\n          // Update the healer's HP in the grid\n          await NPCsInGridManager.updateNPC(gridId, npcData.id, { hp: newHealerHP });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error applying healing:', error);\n    } finally {\n      // Clear the healing flag after cooldown duration to sync with animation\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n    }\n\n  };\n\n  const handleTrade = async (recipe) => {\n    setErrorMessage('');\n    if (!recipe) {\n      setErrorMessage('Invalid recipe selected.');\n      return;\n    }\n\n    let quantityToGive = recipe.tradeqty || 1;\n    \n    // Get relationship-based multiplier from RelationshipMatrix data\n    const { multiplier, bonusMessage } = getRelationshipMultiplier(npcData.type, currentPlayer, strings);\n    quantityToGive = Math.floor(quantityToGive * multiplier);\n    \n    // Check if we have room for the trade reward BEFORE spending ingredients\n    const hasRoom = hasRoomFor({\n      resource: recipe.type,\n      quantity: quantityToGive,\n      currentPlayer,\n      inventory: inventory,  // Use current prop\n      backpack: backpack,    // Use current prop\n      masterResources,\n      globalTuning\n    });\n    \n    // Create safe copies after the capacity check\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n    \n    if (!hasRoom) {\n      const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n      const isMoney = recipe.type === \"Money\";\n      const isGem = recipe.type === \"Gem\";\n      \n      if (!isMoney && !isGem && !isHomestead) {\n        // Check if player has backpack skill\n        const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n        if (!hasBackpackSkill) {\n          updateStatus(19); // Missing backpack\n        } else {\n          updateStatus(21); // Backpack full\n        }\n      } else {\n        updateStatus(20); // Warehouse full\n      }\n      return;\n    }\n\n    const spendResult = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendResult || (spendResult.success !== undefined && !spendResult.success)) {\n      setErrorMessage('Not enough ingredients.');\n      return;\n    }\n    \n    // Use the updated inventory and backpack from spendIngredients\n    const gained = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: recipe.type,\n      quantity: quantityToGive,\n      inventory: spendResult.updatedInventory,  // Use the updated inventory\n      backpack: spendResult.updatedBackpack,   // Use the updated backpack\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n    \n    if (!gained) {\n      setErrorMessage('Failed to complete trade.');\n      return;\n    }\n\n    // Track quest progress for trading (using 'Collect' action to match quest system)\n    await trackQuestProgress(currentPlayer, 'Collect', recipe.type, quantityToGive, setCurrentPlayer);\n    \n    // Build ingredient list for status message\n    const ingredientList = [];\n    \n    // Check if using new format with requiresArray\n    if (recipe.requiresArray && Array.isArray(recipe.requiresArray)) {\n      recipe.requiresArray.forEach(req => {\n        if (req.type && req.quantity) {\n          ingredientList.push(`${req.quantity} ${req.type}`);\n        }\n      });\n    } else {\n      // Legacy format - check all numbered ingredients\n      for (let i = 1; i <= 10; i++) {\n        const ingredientType = recipe[`ingredient${i}`];\n        const ingredientQty = recipe[`ingredient${i}qty`];\n        if (ingredientType && ingredientQty) {\n          ingredientList.push(`${ingredientQty} ${ingredientType}`);\n        }\n      }\n    }\n    const ingredientString = ingredientList.join(', ');\n    \n    // Show success message with bonus if applicable\n    updateStatus(`Exchanged ${ingredientString} for ${quantityToGive} ${getLocalizedString(recipe.type, strings)}.${bonusMessage}`);\n  };\n\n  const handleSellNPC = async () => {\n    if (!npcData || !npcData.id) {\n      console.error('Cannot sell NPC: Missing NPC data or ID');\n      return;\n    }\n\n    try {\n      const gridId = currentPlayer.location.g;\n      await NPCsInGridManager.removeNPC(gridId, npcData.id);\n      updateStatus(`${getLocalizedString(npcData.type, strings)} has been removed from the grid.`);\n      onClose(); // Close the panel after selling\n    } catch (error) {\n      console.error('Error selling NPC:', error);\n      updateStatus(` Failed to remove ${getLocalizedString(npcData.type, strings)}.`);\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1013\" title={`${npcData.symbol} ${getLocalizedString(npcData.type, strings)}`} panelName=\"NPCPanel\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n\n{/* //////////////////// QUESTS //////////////////////// */}\n\n      {npcData.action === 'quest' && (\n        <div className=\"quest-options\">\n          \n          {/* Relationship Card - only show if NPC doesn't have output='noRel' */}\n          {(() => {\n            const npcResource = masterResources.find(r => r.type === npcData.type && r.category === 'npc');\n            const shouldHideRelationship = npcResource?.output === 'noRel';\n            \n            if (shouldHideRelationship) {\n              return null;\n            }\n            \n            return (\n              <RelationshipCard\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            targetName={npcData.type}\n            targetType=\"npc\"\n            targetEmoji={npcData.symbol}\n            showActions={true}\n            compact={false}\n            masterInteractions={masterInteractions}\n            updateStatus={updateStatus}\n            masterResources={masterResources}\n            playerPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              return playerInGridState?.position || null;\n            })()}\n            targetPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              return npcInGrid?.position || null;\n            })()}\n            TILE_SIZE={TILE_SIZE}\n            checkDistance={() => {\n              // Get player position\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              if (!playerInGridState?.position) return false;\n              \n              // Get NPC position\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              if (!npcInGrid?.position) return false;\n              \n              // Calculate distance\n              const distance = calculateDistance(playerInGridState.position, npcInGrid.position);\n              const playerRange = getDerivedRange(currentPlayer, masterResources);\n              \n              return distance <= playerRange;\n            }}\n            onInteractionClick={() => {\n              return new Promise((resolve) => {\n                const wasZoomedOut = zoomLevel !== 'closer';\n                \n                // Zoom to closer if not already\n                if (wasZoomedOut) {\n                  setZoomLevel('closer');\n                  // Wait for zoom animation and re-render to complete\n                  setTimeout(() => {\n                    // Center camera on player after zoom\n                    const gridId = currentPlayer?.location?.g;\n                    const playerId = currentPlayer._id?.toString();\n                    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                    if (playerInGridState?.position) {\n                      // Use a larger tile size for closer zoom (typically 50)\n                      const closerTileSize = masterResources?.find(r => r.type === 'globalTuning')?.closerZoom || 50;\n                      centerCameraOnPlayer(playerInGridState.position, closerTileSize);\n                    }\n                    // Give additional time for camera centering\n                    setTimeout(resolve, 300);\n                  }, 100);\n                } else {\n                  // Already zoomed in, just center camera\n                  const gridId = currentPlayer?.location?.g;\n                  const playerId = currentPlayer._id?.toString();\n                  const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                  if (playerInGridState?.position) {\n                    // Already at closer zoom, use current TILE_SIZE\n                    centerCameraOnPlayer(playerInGridState.position, TILE_SIZE);\n                  }\n                  resolve();\n                }\n              });\n            }}\n            onRelationshipChange={(interaction, success) => {\n              // Additional handling if needed after interaction completes\n            }}\n          />\n            );\n          })()}\n          \n          {/* Show message if quest interaction is not available due to relationship */}\n          {!canQuest && (\n            <div style={{ \n              padding: '10px', \n              backgroundColor: '#f5f5f5', \n              borderRadius: '5px', \n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: '#666'\n            }}>\n              {strings[625]}\n            </div>\n          )}\n\n          {canQuest && hasHiddenQuests && (\n            <div style={{ \n              padding: '10px', \n              backgroundColor: '#f5f5f5', \n              borderRadius: '5px', \n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: '#666'\n            }}>\n              {strings[627]}\n            </div>\n          )}\n          \n          {canQuest && questList.length === 0 && !hasHiddenQuests && (\n            <div style={{ \n              padding: '10px', \n              backgroundColor: '#f5f5f5', \n              borderRadius: '5px', \n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: '#666'\n            }}>\n              {strings[205]}\n            </div>\n          )}\n\n          {canQuest && (\n            <>\n              {questList.length > 0 && (\n                <h3>{strings[204]}</h3>\n              )}\n              {questList.map((quest) => {\n            const isRewardable = currentPlayer.activeQuests.some(\n              (q) => q.questId === quest.title && q.completed && !q.rewardCollected\n            );\n\n            const state = isRewardable ? 'reward' : 'accept';\n            const onClick = state === 'reward'\n              ? () => handleGetReward(quest)\n              : () => handleAcceptQuest(quest.title);\n\n            return (\n              <QuestGiverButton\n                key={quest.title}\n                quest={{\n                  symbol: quest.symbol,\n                  title: quest.title,\n                  textbody: quest.textbody,\n                  goals: [\n                    { action: quest.goal1action, item: quest.goal1item, qty: quest.goal1qty },\n                    { action: quest.goal2action, item: quest.goal2item, qty: quest.goal2qty },\n                    { action: quest.goal3action, item: quest.goal3item, qty: quest.goal3qty },\n                  ],\n                  reward: quest.reward,\n                  rewardqty: quest.rewardqty,\n                }}\n                state={state}\n                onClick={onClick}\n              />\n            );\n              })}\n            </>\n          )}\n          \n        </div>\n      )}\n\n\n{/* //////////////////// HEALING //////////////////////// */}\n\n      {npcData.action === 'heal' && healRecipes.length > 0 && (\n        <div className=\"heal-options\">\n          {/* Render healer interaction animation when healing */}\n          <HealerInteraction\n            isHealing={isHealing}\n            currentPlayer={currentPlayer}\n            TILE_SIZE={TILE_SIZE}\n            healAmount={npcData.qtycollected}\n            onHealingComplete={() => setIsHealing(false)}\n          />\n<br />\n          {/* Fetch and display player's HP from playersInGridManager */}\n          {(() => {\n            const gridId = currentPlayer?.location?.g;\n            const playerId = currentPlayer._id?.toString();\n            const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n<br />\n            if (playerInGridState) {\n              return (\n                <>\n                  <h2>{strings[511]} <br />{playerInGridState.hp} / {playerInGridState.maxhp}</h2>\n                </>\n              );\n            } else {\n              return <h4>{strings[512]}</h4>;\n            }\n          })()}\n<br />\n          {healRecipes.map((recipe) => {\n            const ingredients = getIngredientDetails(recipe, masterResources);\n            const affordable = canAfford(recipe, inventory, 1);\n            const healAmount = recipe.qtycollected; // Healing value\n\n            const itemKey = `heal-${recipe.type}`;\n            const isCoolingDown = coolingDownItems.has(itemKey);\n            \n            // Check if healer has HP remaining\n            const gridId = currentPlayer?.location?.g;\n            const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n            const healerOutOfHP = healerInGrid && healerInGrid.hp !== undefined && healerInGrid.hp <= 0;\n            \n            // Get the NPC template from masterResources to find maxhp\n            const npcTemplate = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n            const totalHeals = npcTemplate?.maxhp || 'Unknown';\n            \n            return (\n              <div key={recipe.type}>\n                <ResourceButton\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  details={`${strings[463]}  +${healAmount}<br>${strings[461]} ${ingredients.join(', ') || 'None'}`}\n                  info={`${strings[51]}${totalHeals}`}\n                  disabled={!affordable || isHealing || isCoolingDown || healerOutOfHP}\n                  onClick={() => handleHeal(recipe)}\n                  className={isCoolingDown ? 'cooldown' : ''}\n                  style={isCoolingDown ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                  // Gem purchase props\n                  gemCost={recipe.gemcost || null}\n                  onGemPurchase={(recipe.gemcost && !affordable && !isHealing && !isCoolingDown && !healerOutOfHP) ? (modifiedRecipe) => handleGemPurchase(modifiedRecipe, 'heal') : null}\n                  resource={recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                />\n                {/* Display healer's HP below the ResourceButton */}\n                {healerInGrid && healerInGrid.hp !== undefined && (\n                  <div style={{ textAlign: 'center', marginTop: '5px', fontStyle: 'italic', color: '#666' }}>\n                    {strings[49]} {healerInGrid.hp}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n      )}\n\n{/* //////////////////// TRADING //////////////////////// */}\n\n      {npcData.action === 'trade' && (\n        <div className=\"trade-options\">\n          \n          {/* Relationship Card - only show if NPC doesn't have output='noRel' */}\n          {(() => {\n            const npcResource = masterResources.find(r => r.type === npcData.type && r.category === 'npc');\n            const shouldHideRelationship = npcResource?.output === 'noRel';\n            \n            if (shouldHideRelationship) {\n              return null;\n            }\n            \n            return (\n              <RelationshipCard\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            targetName={npcData.type}\n            targetType=\"npc\"\n            targetEmoji={npcData.symbol}\n            showActions={true}\n            compact={false}\n            masterInteractions={masterInteractions}\n            updateStatus={updateStatus}\n            masterResources={masterResources}\n            playerPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              return playerInGridState?.position || null;\n            })()}\n            targetPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              return npcInGrid?.position || null;\n            })()}\n            TILE_SIZE={TILE_SIZE}\n            checkDistance={() => {\n              // Get player position\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              if (!playerInGridState?.position) return false;\n              \n              // Get NPC position\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              if (!npcInGrid?.position) return false;\n              \n              // Calculate distance\n              const distance = calculateDistance(playerInGridState.position, npcInGrid.position);\n              const playerRange = getDerivedRange(currentPlayer, masterResources);\n              \n              return distance <= playerRange;\n            }}\n            onInteractionClick={() => {\n              return new Promise((resolve) => {\n                const wasZoomedOut = zoomLevel !== 'closer';\n                \n                // Zoom to closer if not already\n                if (wasZoomedOut) {\n                  setZoomLevel('closer');\n                  // Wait for zoom animation and re-render to complete\n                  setTimeout(() => {\n                    // Center camera on player after zoom\n                    const gridId = currentPlayer?.location?.g;\n                    const playerId = currentPlayer._id?.toString();\n                    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                    if (playerInGridState?.position) {\n                      // Use a larger tile size for closer zoom (typically 50)\n                      const closerTileSize = masterResources?.find(r => r.type === 'globalTuning')?.closerZoom || 50;\n                      centerCameraOnPlayer(playerInGridState.position, closerTileSize);\n                    }\n                    // Give additional time for camera centering\n                    setTimeout(resolve, 300);\n                  }, 100);\n                } else {\n                  // Already zoomed in, just center camera\n                  const gridId = currentPlayer?.location?.g;\n                  const playerId = currentPlayer._id?.toString();\n                  const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                  if (playerInGridState?.position) {\n                    // Already at closer zoom, use current TILE_SIZE\n                    centerCameraOnPlayer(playerInGridState.position, TILE_SIZE);\n                  }\n                  resolve();\n                }\n              });\n            }}\n            onRelationshipChange={(interaction, success) => {\n              // Additional handling if needed after interaction completes\n            }}\n          />\n            );\n          })()}\n          \n          {/* Show message if trade interaction is not available due to relationship */}\n          {!canTrade && (\n            <div style={{ \n              padding: '10px', \n              backgroundColor: '#f5f5f5', \n              borderRadius: '5px', \n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: '#666'\n            }}>\n              {strings[626]}\n            </div>\n          )}\n          \n          {canTrade && (\n            <>\n              <h3>{strings[420]}</h3>\n              {tradeRecipes.length > 0 ? (\n                tradeRecipes.map((recipe) => {\n                  const affordable = canAfford(recipe, inventory, backpack, 1);\n                  const quantityToGive = recipe.tradeqty || 1;\n\n                  // Format costs with color per ingredient (matching CraftingStation.js style)\n                  // Support dynamic number of ingredients based on whether data comes from masterTraders or legacy format\n                  let formattedCosts = '';\n                  \n                  // Check if this recipe has a 'requiresArray' array (from masterTraders)\n                  if (recipe.requiresArray && Array.isArray(recipe.requiresArray)) {\n                    // New format from masterTraders - dynamic number of ingredients\n                    formattedCosts = recipe.requiresArray.map((req) => {\n                      const type = req.type;\n                      const qty = req.quantity;\n                      if (!type || !qty) return '';\n                      \n                      const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n                      const color = playerQty >= qty ? 'green' : 'red';\n                      const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                      return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n                    }).join('');\n                  } else {\n                    // Legacy format - check ingredient1 through ingredientN\n                    const ingredientsList = [];\n                    for (let i = 1; i <= 10; i++) { // Check up to 10 ingredients for safety\n                      const type = recipe[`ingredient${i}`];\n                      const qty = recipe[`ingredient${i}qty`];\n                      if (!type || !qty) continue;\n                      \n                      const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n                      const color = playerQty >= qty ? 'green' : 'red';\n                      const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                      ingredientsList.push(`<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`);\n                    }\n                    formattedCosts = ingredientsList.join('');\n                  }\n\n                  return (\n                    <ResourceButton\n                      key={recipe.type}\n                      symbol={recipe.symbol}\n                      name={`${getLocalizedString(recipe.type, strings)} (${quantityToGive}x)`}\n                      details={`${strings[461]}<div>${formattedCosts}</div>`}\n                      disabled={!affordable}\n                      onClick={() => handleTrade(recipe)}\n                      // Gem purchase props\n                      gemCost={recipe.gemcost || null}\n                      onGemPurchase={(recipe.gemcost && !affordable) ? (modifiedRecipe) => handleGemPurchase(modifiedRecipe, 'trade') : null}\n                      resource={recipe}\n                      inventory={inventory}\n                      backpack={backpack}\n                      masterResources={masterResources}\n                      currentPlayer={currentPlayer}\n                    />\n                  );\n                })\n              ) : (\n                <p>{strings[423]}</p>\n              )}\n              \n              {/* Trader story text */}\n              {(() => {\n                const storyStringMap = {\n                  Iago: 1201,\n                  Juliet: 1202,\n                  Falstaff: 1203,\n                  Apothecary: 1204,\n                  Gertrude: 1205,\n                  Leontes: 1206,\n                  Caliban: 1207,\n                };\n                \n                if (storyStringMap[npcData.type]) {\n                  return (\n                    <div className=\"trader-story\">\n                      <p>{strings[storyStringMap[npcData.type]]}</p>\n                    </div>\n                  );\n                }\n                return null;\n              })()}\n            </>\n          )}\n        </div>\n      )}\n\n        </div>\n        \n        {/* Pinned footer with sell/refund button */}\n        {isDeveloper && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <button \n                className=\"btn-basic btn-danger\" \n                onClick={handleSellNPC}\n              >\n                {strings[490]}\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(NPCPanel);\n","import API_BASE from '../config';\nimport axios from 'axios';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { changePlayerLocation } from './GridManagement';\nimport { fetchHomesteadSignpostPosition } from './worldHelpers';\n\nexport const modifyPlayerStatsInGridState = async (statToMod, amountToMod, playerId, gridId) => {\n  try {\n    console.log('made it to modifyPlayerStatsInGridState');\n    console.log('statToMod = ', statToMod, '; amountToMod = ', amountToMod);\n\n    if (!statToMod || !amountToMod) { console.error('Invalid stat or amount to modify.'); return; }\n\n    // Use playersInGridManager to get PCs and update\n    const pcs = playersInGridManager.getPlayersInGrid(gridId);\n    const player = pcs?.[playerId];\n\n    if (!player) {\n      console.warn(` Player ${playerId} not found in playersInGrid for gridId ${gridId}`);\n      console.warn(' All available PCs:', Object.keys(pcs));\n      return;\n    }\n\n    // Modify stat safely\n    const updatedValue = (player[statToMod] || 0) + amountToMod;\n    playersInGridManager.updatePC(gridId, playerId, { [statToMod]: updatedValue });\n    console.log(` Modified ${statToMod} for player ${playerId} by +${amountToMod}. New value: ${updatedValue}`);\n\n  } catch (error) {\n    console.error('Error in modifyPlayerStats:', error);\n  }\n};\n\n\nexport const modifyPlayerStatsInPlayer = async (statToMod, amountToMod, playerId) => {\n  try {\n    console.log(' Modifying player stats in the Player Profile (DB)');\n    console.log('statToMod = ', statToMod, '; amountToMod = ', amountToMod);\n\n    if (!statToMod || !amountToMod) {\n      console.error(' Invalid stat or amount to modify.');\n      return null;\n    }\n\n    // Step 1: Fetch the current player data from the server\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const currentPlayerData = response.data;\n\n    if (!currentPlayerData || !currentPlayerData.playerId) {\n      console.error(' Failed to fetch current player data from the server.');\n      return null;\n    }\n\n    // Step 2: Calculate new stat value by adding to the existing value\n    const currentStatValue = currentPlayerData[statToMod] || 0;  // Default to 0 if undefined\n    const newStatValue = currentStatValue + amountToMod;\n    console.log(` Updating ${statToMod}: ${currentStatValue} + ${amountToMod} = ${newStatValue}`);\n\n    // Step 3: Send the updated stat back to the database\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: {\n        [statToMod]: newStatValue,  //  Now ADDING instead of replacing\n      },\n    });\n\n    console.log(` Successfully updated ${statToMod} in the database.`);\n\n    // Step 4: Return updated player data\n    currentPlayerData[statToMod] = newStatValue;\n    return currentPlayerData;\n\n  } catch (error) {\n    console.error(' Error in modifyPlayerStatsInPlayer:', error);\n    return null;\n  }\n};\n\n/**\n * Determines if a given stat should be stored in NPCsInGrid rather than the player document.\n * @param {string} stat - The name of the stat to check.\n * @returns {boolean} - Returns true if the stat belongs in NPCsInGrid, false otherwise.\n */\nexport const isAGridStateStat = (stat) => {\n  const NPCsInGridStats = new Set([\n    \"damage\",\n    \"armorclass\",\n    \"hp\",\n    \"maxhp\",\n    \"attackbonus\",\n    \"attackrange\",\n    \"speed\",\n    \"iscamping\",\n    \"isinboat\",\n  ]);\n\n  return NPCsInGridStats.has(stat);\n};\n\nexport const handlePlayerDeath = async (\n  player,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setResources,\n  setTileTypes,\n  TILE_SIZE,\n  updateStatus,\n  setModalContent,\n  setIsModalOpen,\n  closeAllPanels\n\n) => {\n  console.log(' Handling player death for', player.username);\n\n  try {\n    const currentGridId = player.location.g;\n    \n    // Fetch the Signpost Town position from the homestead grid\n    const signpostPosition = await fetchHomesteadSignpostPosition(player.gridId);\n    \n    // Determine respawn grid and coordinates\n    const targetLocation = {\n      x: signpostPosition.x,\n      y: signpostPosition.y,\n      g: player.gridId !== currentGridId ? player.gridId : currentGridId,\n      s: player.settlementId,\n      gtype: \"homestead\",\n    };\n    // Preserve other location fields (frontier, settlement, gtype)\n    const updatedLocation = {\n      ...player.location,\n      ...targetLocation,\n    };\n\n    // Determine restored HP based on account status\n    let restoredHp = 25;\n    if (player.accountStatus === \"Gold\") {\n      restoredHp = Math.floor(player.baseMaxhp / 2); // use baseMaxhp or maxHp as appropriate\n    }\n    \n    // Calculate proper maxHP from base stats and equipment (don't let it get corrupted)\n    const properMaxHp = (player.baseMaxhp || 25) + (player.maxhpModifier || 0);\n    \n    console.log(` [HP DEBUG] Death recovery for ${player.username}:`);\n    console.log('  player.baseMaxhp:', player.baseMaxhp);\n    console.log('  player.maxhp (before):', player.maxhp);\n    console.log('  properMaxHp (calculated):', properMaxHp);\n    console.log('  restoredHp:', restoredHp);\n    \n    // Keep only Tent and Boat items in backpack, discard everything else\n    const filteredBackpack = player.backpack.filter((item) => item.type === \"Tent\" || item.type === \"Boat\");\n    const originalLocation = { ...player.location }; //  preserve the correct fromLocation\n    \n    // Create updated player object with restored HP and proper maxHP\n    const updatedPlayer = {\n      ...player,\n      hp: restoredHp,\n      maxhp: properMaxHp,  // Ensure maxHP is not corrupted\n      backpack: filteredBackpack,\n      location: updatedLocation\n    };\n\n    // 1. **Update Player Data in the Database**\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: player._id,\n      updates: {\n        backpack: filteredBackpack,  // Backpack now only contains Tent and Boat\n        hp: restoredHp,  // Use restored HP value\n        maxhp: properMaxHp,  // Ensure maxHP is preserved in database\n        location: updatedLocation,  // Update location\n        settings: player.settings,\n      },\n    });\n    setCurrentPlayer(updatedPlayer);\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n\n    // REMOVED: Don't update PlayersInGrid here - let changePlayerLocation handle the cleanup\n    // The player is dead and about to be moved, so we shouldn't update their HP in the current grid\n\n    console.log(`Player ${player.username} will be teleported to home grid with ${restoredHp} HP.`);\n    console.log(' Player before changePlayerLocation:', JSON.stringify(updatedPlayer, null, 2));\n\n    // 4. **Load New Grid & Add Player to GridState**\n    await changePlayerLocation(\n      updatedPlayer,\n      originalLocation,   // fromLocation\n      updatedLocation,   // toLocation\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      TILE_SIZE,\n      closeAllPanels,\n      updateStatus,\n      null, // bulkOperationContext not available\n      null, // masterResources not available\n      null, // strings not available\n      null  // masterTrophies not available\n    );\n\n    // 5. **Ensure HP is properly set in the grid state after teleportation**\n    console.log(` Ensuring player HP is set to ${restoredHp} in grid state`);\n    const playersInGridManager = await import('../GridState/PlayersInGrid').then(m => m.default);\n    await playersInGridManager.updatePC(updatedPlayer.gridId, updatedPlayer._id, { hp: restoredHp });\n    \n    // Also ensure the currentPlayer state reflects the restored HP\n    setCurrentPlayer(prevPlayer => ({\n      ...prevPlayer,\n      hp: restoredHp\n    }));\n\n  } catch (error) {\n    console.error('Error during player death handling and teleportation:', error);\n  }\n};\n","import API_BASE from '../config';\nimport axios from 'axios';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients } from '../Utils/InventoryManagement';\nimport { updateGridResource } from '../Utils/GridManagement';\nimport { addResourceToGrid } from '../Utils/worldHelpers';\nimport FloatingTextManager from '../UI/FloatingText';\nimport { trackQuestProgress } from './Quests/QuestGoalTracker';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { getCurrentTileCoordinates, enrichResourceFromMaster } from '../Utils/ResourceHelpers';\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { incrementFTUEStep } from './FTUE/FTUE';\n\nexport const handleConstructionWithGems = async (params) => {\n  // Wrapper function that uses a modified recipe if provided\n  if (params.modifiedRecipe) {\n    // Replace the selected resource in buildOptions with the modified recipe\n    const modifiedBuildOptions = params.buildOptions.map(item =>\n      item.type === params.modifiedRecipe.type ? params.modifiedRecipe : item\n    );\n    return handleConstruction({\n      ...params,\n      buildOptions: modifiedBuildOptions,\n    });\n  }\n  return handleConstruction(params);\n};\n\nexport const handleConstruction = async ({\n  TILE_SIZE,\n  selectedItem,\n  buildOptions,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  updateStatus,\n}) => {\n  if (!currentPlayer) {\n    console.warn('Current Player not provided; inventory changes will not be saved.');\n    return;\n  }\n  if (!selectedItem) {\n    console.warn('Invalid building selection.');\n    return;\n  }\n  // **Get player position dynamically **\n  const playerId = currentPlayer._id.toString();  // Convert ObjectId to string\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  const player = playersInGrid?.[playerId];\n  const playerPosition = player?.position;  // Use grid-relative coordinates directly (no scaling)\n\n  const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n  if (!coords) return;\n  const { tileX, tileY } = coords;\n  const x = tileX;\n  const y = tileY;\n\n  console.log('playerPosition = ', playerPosition);\n  console.log('x = ',tileX,\" y = \",tileY);\n\n  // Ensure valid player position\n  if (!playerPosition || tileX == null || tileY == null) {\n    console.warn('Player position is invalid.');\n    return;\n  }\n\n  const selectedResource = buildOptions.find((item) => item.type === selectedItem);\n\n  // Check if this is a multi-tile resource\n  const resourceRange = selectedResource.range || 1;\n  console.log(` Building ${selectedItem} with range ${resourceRange}`);\n\n  // Skip tile occupation check for NPCs since they don't occupy grid tiles\n  if (selectedResource.category !== 'npc') {\n    // For multi-tile resources, check all required tiles\n    // Using player position as lower-left anchor\n    const tilesToCheck = [];\n    for (let dx = 0; dx < resourceRange; dx++) {\n      for (let dy = 0; dy < resourceRange; dy++) {\n        tilesToCheck.push({ x: x + dx, y: y - dy });\n      }\n    }\n\n    console.log(' Tiles to check for placement:', tilesToCheck);\n\n    // Check if any of the required tiles are occupied\n    const occupiedTile = tilesToCheck.find(tile => \n      resources.some(res => res.x === tile.x && res.y === tile.y)\n    );\n\n    if (occupiedTile) {\n      console.warn(`Cannot build ${selectedItem} - tile at (${occupiedTile.x}, ${occupiedTile.y}) is occupied.`);\n      FloatingTextManager.addFloatingText(306, x, y, TILE_SIZE);\n      return; // Exit before deducting inventory\n    }\n  }\n\n  const success = await spendIngredients({\n    playerId: currentPlayer.playerId,\n    recipe: selectedResource,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n  });\n  if (!success) {\n    FloatingTextManager.addFloatingText(305, playerPosition.x, playerPosition.y, TILE_SIZE);\n    return;\n  }\n  // refreshPlayerAfterInventoryUpdate is already called inside spendIngredients\n\n  console.log('selectedResource.action=', selectedResource.action);\n\n  // Calculate total cost for status message\n  const costDetails = [];\n  for (let i = 1; i <= 4; i++) {\n    const ingredientType = selectedResource[`ingredient${i}`];\n    const ingredientQty = selectedResource[`ingredient${i}qty`];\n    if (ingredientType && ingredientQty) {\n      costDetails.push(`${ingredientQty} ${ingredientType}`);\n    }\n  }\n  const costString = costDetails.length > 0 ? costDetails.join(', ') : 'free';\n\n  if (selectedResource.category === 'npc') {\n    // Spawning NPC directly at player's tile coordinates\n    NPCsInGridManager.spawnNPC(gridId, selectedResource, playerPosition);\n    console.log('Spawned NPC:', gridId, selectedResource, playerPosition);\n    \n    // Show floating text for NPC purchase\n    FloatingTextManager.addFloatingText(300, playerPosition.x, playerPosition.y, TILE_SIZE);\n    \n    // Show status message with purchase details\n    updateStatus(`${selectedResource.type} purchased for ${costString}.`);\n    \n    // Track quest progress for \"Buy\" actions\n    await trackQuestProgress(currentPlayer, 'Buy', selectedResource.type, 1, setCurrentPlayer);\n    \n    // Check if first-time user bought a cow\n    if (currentPlayer.firsttimeuser === true && selectedResource.type === 'Cow') {\n      console.log(' First-time user purchased first Cow, advancing FTUE step');\n      await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n    }\n\n  } else {\n    console.log('Placing resource on the grid:', selectedItem);\n    const debugBefore = resources.find(res => res.x === x && res.y === y);\n    console.log(' Existing resource at location before setResources:', debugBefore);\n\n    const rawResource = { type: selectedItem, x, y };\n    const enriched = enrichResourceFromMaster(rawResource, buildOptions); // buildOptions contains masterResources\n    \n    // Ensure range is included for multi-tile resources\n    if (resourceRange > 1) {\n      enriched.range = resourceRange;\n      enriched.anchorKey = `${selectedItem}_${x}_${y}`;\n    }\n    \n    let finalResources = [...resources, enriched];\n\n    console.log(' Preparing resource update with:', enriched);\n    \n    try {\n      // Create shadow placeholders for multi-tile objects in LOCAL STATE ONLY\n      if (resourceRange > 1) {\n        \n        for (let dx = 0; dx < resourceRange; dx++) {\n          for (let dy = 0; dy < resourceRange; dy++) {\n            // Skip the anchor tile (0,0)\n            if (dx === 0 && dy === 0) continue;\n            \n            const shadowX = x + dx;\n            const shadowY = y - dy;\n            const shadowResource = {\n              type: 'shadow',\n              x: shadowX,\n              y: shadowY,\n              parentAnchorKey: enriched.anchorKey,\n              passable: enriched.passable // Inherit passable property from parent\n              // No symbol - renders as empty/invisible\n            };\n            \n            \n            // Add shadow to final resources array (LOCAL STATE ONLY - NOT SAVED TO DB)\n            finalResources.push(shadowResource);\n          }\n        }\n      }\n      \n      // Update local state ONCE with all resources (main + shadows)\n      console.log(' Updating local state with all resources');\n      GlobalGridStateTilesAndResources.setResources(finalResources);\n      setResources(finalResources);\n      \n      // Update ONLY the main resource in DB (NOT shadows)\n      await updateGridResource(gridId, rawResource, true);\n      \n      FloatingTextManager.addFloatingText(300, playerPosition.x, playerPosition.y, TILE_SIZE);\n      \n      // Show status message with purchase details\n      updateStatus(`${selectedItem} purchased for ${costString}.`);\n      \n      // Track quest progress sequentially to avoid conflicts\n      await trackQuestProgress(currentPlayer, 'Build', selectedItem, 1, setCurrentPlayer);\n      await trackQuestProgress(currentPlayer, 'Buy', selectedItem, 1, setCurrentPlayer);\n    } catch (error) {\n      console.error('Error placing resource on grid:', error);\n      return;\n    }\n  }\n};","// governmentUtils.js\nimport axios from 'axios';\nimport API_BASE from '../../config';\n\n/**\n * Fetches the mayor's username for a given settlementId.\n * Returns \"Vacant\" if no mayor is assigned,\n * \"Error\" if something went wrong,\n * or the mayor's username.\n */\nexport async function getMayorUsername(settlementId) {\n  if (!settlementId) {\n    console.warn(\" No settlementId provided to getMayorUsername.\");\n    return \"Error\";\n  }\n\n  try {\n    // Step 1: Fetch settlement data\n    const res = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n    const settlement = res.data;\n\n    // Step 2: Find the role entry for Mayor\n    const mayorRole = settlement.roles?.find(role => role.roleName === \"Mayor\");\n    if (!mayorRole || !mayorRole.playerId || mayorRole.playerId === \"Vacant\") {\n      return \"Vacant\";\n    }\n\n    // Step 3: Fetch player info\n    const playerRes = await axios.get(`${API_BASE}/api/player/${mayorRole.playerId}`);\n    return playerRes.data.username || \"Unknown\";\n    \n  } catch (err) {\n    console.error(\" Failed to fetch mayor username:\", err);\n    return \"Error\";\n  }\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/PanelContext';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { getMayorUsername } from '../Government/GovUtils';\n\nconst BuildPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, // Added for quest tracking\n  masterSkills, // Uncomment if needed for skill checks\n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n}) => {\n  const { closePanel } = usePanelContext(); // Use closePanel from context\n  const [buildOptions, setBuildOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [isMayor, setIsMayor] = useState(false);\n  const strings = useStrings();\n\n  // Fetch inventory and build options when the panel initializes\n  useEffect(() => {\n    console.log(' BuildPanel opened with currentPlayer:', {\n      username: currentPlayer?.username,\n      role: currentPlayer?.role,\n      homeSettlementId: currentPlayer?.settlementId,\n      currentLocation: currentPlayer?.location,\n      isDeveloper\n    });\n    \n    const fetchData = async () => {\n      //setIsContentLoading(true);\n      try {\n        // Check if player is mayor ONLY if we're in a town\n        let isPlayerMayor = false;\n        if (currentPlayer.location.gtype === 'town' && currentPlayer.location.s) {\n          console.log(' In town, checking if player is mayor...');\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n          console.log(' Mayor check:', { mayorUsername, playerUsername: currentPlayer.username, isPlayerMayor });\n        }\n        setIsMayor(isPlayerMayor);\n        \n        // Fetch inventory\n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        // Fetch all resources and filter for build options\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        \n        // Debug: Show all BuildTown resources\n        const buildTownResources = allResourcesData.filter(r => r.source === 'BuildTown');\n        console.log(' BuildTown resources found:', buildTownResources.map(r => r.type));\n        //  Filter build options based on the player's location\n        const validBuildOptions = allResourcesData.filter(resource => {\n          // Check if resource is a valid build option based on source and location\n          // Convert to strings for comparison to handle ObjectId vs string issues\n          const currentSettlementStr = String(currentPlayer.location.s || '');\n          const homeSettlementStr = String(currentPlayer.settlementId || '');\n          const settlementsMatch = currentSettlementStr === homeSettlementStr;\n          \n          if (resource.source === 'BuildTown') {\n            console.log(`BuildPanel: Checking ${resource.type}:`, {\n              source: resource.source,\n              gtype: currentPlayer.location.gtype,\n              isPlayerMayor,\n              currentSettlement: currentPlayer.location.s,\n              homeSettlement: currentPlayer.settlementId,\n              currentSettlementStr,\n              homeSettlementStr,\n              settlementsMatch,\n              isDeveloper\n            });\n          }\n          \n          const isValidSource = resource.source === 'Build' || \n            (resource.source === 'BuildTown' && currentPlayer.location.gtype === 'town' && (isPlayerMayor || isDeveloper) && \n             (settlementsMatch || isDeveloper)) ||\n            (resource.source === 'BuildValley' && currentPlayer.location.gtype != 'homestead');\n          \n          if (!isValidSource) return false;\n          \n          // Check seasonal restriction\n          if (resource.season && currentSeason && resource.season !== currentSeason) {\n            return false;\n          }\n          \n          // Pet-specific filtering\n          if (resource.category === 'pet') {\n            console.log(` Checking pet ${resource.type}...`);\n            \n            // Only allow pets on homesteads (unless isDeveloper)\n            if (currentPlayer.location.gtype !== 'homestead' && !isDeveloper) {\n              console.log(` Filtering out pet ${resource.type} - not on homestead`);\n              return false;\n            }\n            \n            // Check if player already has this pet type on their homestead\n            // Resources on the grid use layoutkey to identify their type\n            const existingPetOfType = resources.find(r => \n              r.layoutkey === resource.type || r.type === resource.type\n            );\n            \n            if (existingPetOfType && !isDeveloper) {\n              console.log(` Filtering out pet ${resource.type} - already exists on grid (layoutkey: ${existingPetOfType.layoutkey}, type: ${existingPetOfType.type})`);\n              return false; // Already have one of this pet type\n            }\n            \n            console.log(` Pet ${resource.type} is available to build`);\n          }\n          \n          return true;\n        });\n        \n        // Debug: Show what will be displayed\n        const buildTownInFinal = validBuildOptions.filter(r => r.source === 'BuildTown');\n        console.log(' Final BuildPanel options:', {\n          totalOptions: validBuildOptions.length,\n          buildTownIncluded: buildTownInFinal.map(r => r.type),\n          shouldHaveBuildTown: currentPlayer.location.gtype === 'town' && \n                               (isPlayerMayor || isDeveloper) && \n                               (String(currentPlayer.location.s) === String(currentPlayer.settlementId) || isDeveloper)\n        });\n        \n        setBuildOptions(validBuildOptions); \n      } catch (error) {\n        console.error('Error fetching build panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [currentPlayer, currentPlayer?.location?.s, currentPlayer?.location?.gtype, currentPlayer?.settlementId, isDeveloper, currentSeason]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  // Count BuildTown buildings on the current grid\n  const countTownBuildings = () => {\n    if (!resources || !allResources) return 0;\n    \n    return resources.filter(resource => {\n      // Find the master resource to check if it's a BuildTown source\n      const masterResource = allResources.find(mr => mr.type === resource.type);\n      return masterResource && masterResource.source === 'BuildTown';\n    }).length;\n  };\n\n  const maxTownBuildings = globalTuning?.maxTownBuildings || 50; // Default to 50 if not set\n  const currentTownBuildings = countTownBuildings();\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n\n  \n  return (\n    <Panel onClose={closePanel} descriptionKey=\"1002\" titleKey=\"1102\" panelName=\"BuildPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buildOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory, backpack);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              \n              // Check if this is a BuildTown building and if we've hit the limit\n              const isTownBuilding = item.source === 'BuildTown' && currentPlayer.location.gtype !== 'homestead';\n              const townBuildingLimitReached = isTownBuilding && currentTownBuildings >= maxTownBuildings;\n              const isDisabled = !affordable || !requirementsMet || townBuildingLimitReached;\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (townBuildingLimitReached ? `<span style=\"color: red;\">${strings[407]}</span><br>` : '') +\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              const info = `\n                ${strings[820]}${\n                  allResources\n                    .filter((res) => res.source === item.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None'\n                }\n              `;\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  info={info}\n                  disabled={isDisabled}\n                  onClick={() =>\n                    !isDisabled &&\n                    handleConstruction({\n                      TILE_SIZE,\n                      selectedItem: item.type,\n                      buildOptions,\n                      inventory,\n                      setInventory,\n                      backpack,\n                      setBackpack, \n                      resources,\n                      setResources,\n                      setErrorMessage: console.error, // Replace with real error handling if needed\n                      currentPlayer,\n                      setCurrentPlayer,\n                      gridId,\n                      updateStatus,\n                    })\n                  }\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet) && !townBuildingLimitReached) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>   \n    </Panel>\n  );\n};\n\nexport default React.memo(BuildPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect, useMemo } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/PanelContext';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\n\nconst BuyPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory, \n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, \n  masterSkills, \n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  NPCsInGrid,\n  globalTuning,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Check if resource is a buy item\n            if (resource.source !== 'Buy') return false;\n            \n            // Check passability based on location\n            if (!isDeveloper && !isHomestead && resource.passable === false) return false;\n            \n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n            \n            // FTUE level filtering for first-time users\n            if (currentPlayer?.firsttimeuser === true && resource.level) {\n              const playerFTUEStep = currentPlayer?.ftuestep || 0;\n              if (resource.level > playerFTUEStep) {\n                return false;\n              }\n            }\n            \n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  // Count current farm animals on the grid\n  const countFarmAnimals = () => {\n    if (!NPCsInGrid?.[gridId]?.npcs) return 0;\n    return Object.values(NPCsInGrid[gridId].npcs).filter(npc => npc.action === 'graze').length;\n  };\n  \n  const maxFarmAnimals = globalTuning?.maxFarmAnimals || 10; // Default to 10 if not set\n  const currentFarmAnimals = countFarmAnimals();\n\n  return ( \n    <Panel onClose={closePanel} descriptionKey=\"1003\" titleKey=\"1103\" panelName=\"BuyPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              \n              // Check if this is a farm animal and if we've hit the limit\n              const isFarmAnimal = item.passable && item.action === 'graze';\n              const farmAnimalLimitReached = isFarmAnimal && currentFarmAnimals >= maxFarmAnimals;\n              const isDisabled = !affordable || !requirementsMet || farmAnimalLimitReached;\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (farmAnimalLimitReached ? `<span style=\"color: red;\">${strings[407]}</span><br>` : '') +\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              // Create info tooltip content\n              const info = (\n                <div className=\"info-content\">\n                  <div>{strings[820]}{item.output ? `${allResources.find(r => r.type === item.output)?.symbol || ''} ${getLocalizedString(item.output, strings)}` : 'Nothing'}</div>\n                  <div>{strings[821]}{item.qtycollected || 1}</div>\n                </div>\n              );\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  info={info}\n                  disabled={isDisabled}\n                  onClick={() =>\n                    affordable &&\n                    requirementsMet &&\n                    !farmAnimalLimitReached &&\n                    handleConstruction({\n                      TILE_SIZE,\n                      selectedItem: item.type,\n                      buildOptions: buyOptions,\n                      inventory,\n                      setInventory,\n                      backpack,\n                      setBackpack,\n                      resources,\n                      setResources,\n                      setErrorMessage: console.error,\n                      currentPlayer,\n                      setCurrentPlayer,\n                      gridId,\n                      updateStatus,\n                    })\n                  }\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet) && !farmAnimalLimitReached) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(BuyPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/PanelContext';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\n\nconst PetsPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory, \n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, \n  masterSkills, \n  updateStatus,\n  isDeveloper,\n  currentSeason,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Check if resource is a buy item\n            if (resource.source !== 'Zoo') return false;\n            \n            // Check passability based on location\n            if (!isDeveloper && !isHomestead && resource.passable === false) return false;\n            \n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n            \n            // FTUE level filtering for first-time users\n            if (currentPlayer?.firsttimeuser === true && resource.level) {\n              const playerFTUEStep = currentPlayer?.ftuestep || 0;\n              if (resource.level > playerFTUEStep) {\n                return false;\n              }\n            }\n            \n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  return ( \n    <Panel onClose={closePanel} descriptionKey=\"1039\" titleKey=\"1139\" panelName=\"PetsPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const requirementsMet = hasRequiredSkill(item.requires);\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              // Create info tooltip content\n              const info = (\n                <div className=\"info-content\">\n                  <div>{strings[820]}{item.output ? `${allResources.find(r => r.type === item.output)?.symbol || ''} ${getLocalizedString(item.output, strings)}` : 'Nothing'}</div>\n                  <div>{strings[821]}{item.qtycollected || 1}</div>\n                </div>\n              );\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  info={info}\n                  disabled={!affordable || !requirementsMet}\n                  onClick={() =>\n                    affordable &&\n                    requirementsMet &&\n                    handleConstruction({\n                      TILE_SIZE,\n                      selectedItem: item.type,\n                      buildOptions: buyOptions,\n                      inventory,\n                      setInventory,\n                      backpack,\n                      setBackpack,\n                      resources,\n                      setResources,\n                      setErrorMessage: console.error,\n                      currentPlayer,\n                      setCurrentPlayer,\n                      gridId,\n                      updateStatus,\n                    })\n                  }\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet)) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(PetsPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/PanelContext';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\n\nconst BuyDecoPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory, \n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, \n  masterSkills, \n  updateStatus,\n  isDeveloper,\n  currentSeason,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Check if resource is a deco item\n            if (resource.source !== 'Deco') return false;\n            \n            // Check passability based on location\n            if (!isDeveloper && !isHomestead && resource.passable === false) return false;\n            \n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n            \n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  return ( \n    <Panel onClose={closePanel} descriptionKey=\"1031\" titleKey=\"1131\" panelName=\"BuyDecoPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const requirementsMet = hasRequiredSkill(item.requires);\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  disabled={!affordable || !requirementsMet}\n                  onClick={() =>\n                    affordable &&\n                    requirementsMet &&\n                    handleConstruction({\n                      TILE_SIZE,\n                      selectedItem: item.type,\n                      buildOptions: buyOptions,\n                      inventory,\n                      setInventory,\n                      backpack,\n                      setBackpack,\n                      resources,\n                      setResources,\n                      setErrorMessage: console.error,\n                      currentPlayer,\n                      setCurrentPlayer,\n                      gridId,\n                      updateStatus,\n                    })\n                  }\n                  gemCost={item.gemcost || null}\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet)) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(BuyDecoPanel);","// Shared function to format countdown timers consistently across the app\n//  Ensures endTime is a valid Date object before doing calculations.\nexport const formatCountdown = (endTime, now) => {\n    if (!endTime || endTime <= now) return \"0s\"; \n  \n    const timeDiff = endTime - now;\n    const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);\n  \n    // Build the string dynamically, only showing non-zero values\n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`); // Always show seconds if nothing else\n    \n    return parts.join(' ');\n};\n\n// Shared function to format static durations (e.g., \"Time needed: X\")\n// Only shows non-zero time units, stopping at the smallest non-zero unit\nexport const formatDuration = (seconds) => {\n    if (!seconds || seconds <= 0) return \"0s\";\n    \n    const days = Math.floor(seconds / 86400);\n    const hours = Math.floor((seconds % 86400) / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = Math.floor(seconds % 60);\n    \n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (secs > 0 || parts.length === 0) parts.push(`${secs}s`); // Always show seconds if nothing else\n    \n    // For static durations, only show the first 2 most significant units\n    // e.g., \"2d 16h\" instead of \"2d 16h 0m 0s\"\n    return parts.slice(0, 2).join(' ');\n}; ","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { handleFarmPlotPlacement, handleTerraform } from './Farming';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { formatDuration } from '../../UI/Timers';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\n\nconst FarmingPanel = ({\n  onClose,\n  TILE_SIZE,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  tiles,\n  tileTypes,\n  setTileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n  currentSeason\n}) => {\n\n  const strings = useStrings();\n  const [farmPlots, setFarmPlots] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const COOLDOWN_DURATION = 450;\n\n \n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    //setIsContentLoading(true);\n    try {\n      const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(inventoryResponse.data.inventory || []);\n\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      const allResourcesData = resourcesResponse.data;\n      setAllResources(allResourcesData);\n\n      const farmPlotItems = allResourcesData.filter((resource) => {\n        // Check if resource is a farm plot\n        return resource.category === 'farmplot';\n      });\n      \n      // Add isOffSeason flag to each farmplot\n      const farmPlotsWithSeasonInfo = farmPlotItems.map(item => ({\n        ...item,\n        isOffSeason: item.season && currentSeason && item.season !== currentSeason\n      }));\n      \n      setFarmPlots(farmPlotsWithSeasonInfo);\n    } catch (error) {\n      console.error('Error fetching farming panel data:', error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Wrap for Farm Plot Placement\n  const handleFarmPlacementWithCooldown = async (item) => {\n    const itemKey = `plot-${item.type}`;\n    if (coolingDownItems.has(itemKey)) return;\n    \n    // Apply cooldown immediately for instant response\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n    \n    // Set timeout immediately (like Bank does) for proper sync\n    const cooldownTimer = setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n    \n    // Attempt the placement\n    const result = await handleFarmPlotPlacement({\n      selectedItem: item,\n      TILE_SIZE,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      gridId,\n      masterResources,\n      masterSkills,\n      updateStatus,\n    });\n    \n    // If placement failed, immediately remove cooldown and cancel timer\n    if (result !== true) {\n      clearTimeout(cooldownTimer);\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1004\" titleKey=\"1104\" panelName=\"FarmingPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n\n            {/* Farm Plot Options */}\n            {farmPlots.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory, 1);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              const isOffSeason = item.isOffSeason;\n\n              const symbol = item.symbol || '';\n\n              // For off-season items, show simplified information\n              if (isOffSeason) {\n                return (\n                  <ResourceButton\n                    key={item.type}\n                    symbol={symbol}\n                    name={getLocalizedString(item.type, strings)}\n                    details=\"Off season\"\n                    info={null}\n                    disabled={true}\n                    onClick={() => {}}\n                  />\n                );\n              }\n\n              // Regular (in-season) item display\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                (item.growtime ? `${strings[458]}${formatDuration(item.growtime)}<br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              const info =\n                `${strings[820]}${\n                  allResources\n                    .filter((res) => res.source === item.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None'\n                }`;\n\n              const itemKey = `plot-${item.type}`;\n              const isCoolingDown = coolingDownItems.has(itemKey);\n              \n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  className={isCoolingDown ? 'cooldown' : ''}\n                  style={isCoolingDown ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                  details={details}\n                  info={info}\n                  disabled={isCoolingDown || !affordable || !requirementsMet}\n                  onClick={() =>\n                    affordable &&\n                    requirementsMet &&\n                    handleFarmPlacementWithCooldown(item)\n                  }\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}; \n\nexport default React.memo(FarmingPanel);","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { addResourceToGrid } from '../../Utils/worldHelpers';\nimport { convertTileType, updateGridResource } from '../../Utils/GridManagement';\nimport { validateTileType, enrichResourceFromMaster } from '../../Utils/ResourceHelpers';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients } from '../../Utils/InventoryManagement';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport farmState from '../../FarmState';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getCurrentTileCoordinates } from '../../Utils/ResourceHelpers';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\n\nexport const handleFarmPlotPlacement = async ({ \n  selectedItem,\n  TILE_SIZE,\n  resources,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n}) => {\n  try {\n    console.log(masterResources);\n    \n    const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n    if (!coords) return false;\n    const { tileX, tileY } = coords;\n\n    // Use local tile data instead of async server call for instant response\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const tileType = tiles?.[tileY]?.[tileX];\n    if (!tileType || tileType !== 'd') {\n      FloatingTextManager.addFloatingText(303, tileX, tileY, TILE_SIZE); // \"Must be dirt\"\n      return false;\n    }\n\n    const tileOccupied = resources.find((res) => res.x === tileX && res.y === tileY);\n    if (tileOccupied) {\n      FloatingTextManager.addFloatingText(304, tileX, tileY, TILE_SIZE); // \"Occupied\"\n      return false;\n    }\n\n    const didSpend = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: selectedItem,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!didSpend) {\n      FloatingTextManager.addFloatingText(305, tileX, tileY, TILE_SIZE); // \"Missing ingredients\"\n      return false;\n    }\n\n    // Timer setup\n    const growEndTime = Date.now() + (selectedItem.growtime || 0) * 1000;\n    console.log(` Planting ${selectedItem.type}: growtime = ${selectedItem.growtime}, growEndTime = ${growEndTime}, secondsFromNow = ${(growEndTime - Date.now()) / 1000}`);\n\n    // Lookup from masterResources for enrichment\n    console.log(\" Attempting to plant:\", selectedItem.type, \"at\", tileX, tileY);\n    const enrichedNewResource = enrichResourceFromMaster(\n      {\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n      },\n      masterResources\n    );\n    console.log(\" Enriched resource before setResources:\", enrichedNewResource);\n\n    // Optimistically update local client state\n    const existing = GlobalGridStateTilesAndResources.getResources() || [];\n    GlobalGridStateTilesAndResources.setResources([...existing, enrichedNewResource]);\n    console.log(\" Global resources after planting:\", GlobalGridStateTilesAndResources.getResources());\n    setResources([...existing, enrichedNewResource]);\n\n    // Update server and all clients\n    const gridUpdateResponse = await updateGridResource(\n      gridId,\n      {\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n      },\n      true\n    );\n\n    if (gridUpdateResponse?.success) {\n      farmState.addSeed({\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n        output: selectedItem.output, //  required for crop conversion\n      });\n\n      FloatingTextManager.addFloatingText(302, tileX, tileY, TILE_SIZE); // \"Planted!\"\n      \n      // Track quest progress for \"Plant\" actions\n      // Use the output (crop) name instead of the plot name for quest tracking\n      const cropName = selectedItem.output || selectedItem.type;\n      await trackQuestProgress(currentPlayer, 'Plant', cropName, 1, setCurrentPlayer);\n      \n      // Check for FTUE step advancement when ANY farm plot is placed\n      if (currentPlayer.firsttimeuser === true && currentPlayer.ftuestep === 6) {\n        console.log(' Player placed a farm plot at FTUE step 6, incrementing step');\n        const { incrementFTUEStep } = await import('../FTUE/FTUE');\n        await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n      }\n      return true; // Success!\n    } else {\n      throw new Error('Server update failed.');\n    }\n  } catch (error) {\n    console.error(' Error in handleFarmPlotPlacement:', error);\n    return false;\n  }\n};\n\n\n\nexport const handleTerraform = async ({ TILE_SIZE, actionType, gridId, currentPlayer, tileTypes, setTileTypes }) => {\n\n  console.log(\"handleTerraform;  currentPlayer = \",currentPlayer);\n  \n  if (!currentPlayer?.location) {\n    console.error(\" handleTerraform: Missing currentPlayer location.\");\n    return;\n  }\n\n  const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n  if (!coords) return;\n  const { tileX, tileY } = coords;\n  const tile = tileTypes?.[tileY]?.[tileX];\n  console.log(\"tile at \",tileY,\", \",tileX,\" = \",tile);\n\n  if (!tile) {\n    console.error(\" handleTerraform: Could not find tile at given coordinates.\");\n    return;\n  }\n  if (tile === 'l') {\n      FloatingTextManager.addFloatingText(320, tileX, tileY, TILE_SIZE);\n    return;\n  }\n  if (tile === 'w') {\n      FloatingTextManager.addFloatingText(320, tileX, tileY, TILE_SIZE); // Same message as lava for now\n    return;\n  }\n\n  let newType;\n  // Determine the new tile type based on the action\n  switch (actionType) {\n    case \"till\":\n      newType = \"d\";\n      break;\n    case \"plantGrass\":\n      newType = \"g\";\n      break;\n    case \"pave\":\n      newType = \"p\";\n      break;\n    case \"stone\":\n      newType = \"s\";\n      break;\n    case \"water\":\n      newType = \"w\";\n      break;\n    default:\n      console.error(` handleTerraform: Unknown actionType \"${actionType}\"`);\n      return;\n  }\n\n  console.log(` handleTerraform: Changing tile at (${tileX}, ${tileY}) to \"${newType}\"`);\n\n  // Call convertTileType to update the tile in the database and emit the change\n  await convertTileType(gridId, tileX, tileY, newType, setTileTypes);\n};\n","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { handleFarmPlotPlacement, handleTerraform } from './Farming';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\n\nconst ToolsPanel = ({\n  onClose,\n  TILE_SIZE,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  tiles,\n  tileTypes,\n  setTileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n  isDeveloper\n}) => {\n\n  const strings = useStrings();\n  const [farmPlots, setFarmPlots] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const COOLDOWN_DURATION = 500;\n\n \n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    //setIsContentLoading(true);\n    try {\n      const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(inventoryResponse.data.inventory || []);\n\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      const allResourcesData = resourcesResponse.data;\n      setAllResources(allResourcesData);\n\n      const farmPlotItems = allResourcesData.filter((resource) => resource.category === 'farmplot');\n      setFarmPlots(farmPlotItems);\n    } catch (error) {\n      console.error('Error fetching farming panel data:', error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Wrap for Terraform Actions\n  const handleTerraformWithCooldown = async (actionType) => {\n    const itemKey = `terraform-${actionType}`;\n    if (coolingDownItems.has(itemKey)) return;\n    \n    // Apply cooldown immediately for instant response\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n    \n    // Set timeout immediately for proper sync with CSS animation\n    setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n\n    await handleTerraform({\n      TILE_SIZE,\n      actionType,\n      gridId,\n      currentPlayer,\n      tileTypes,\n      setTileTypes,\n    });\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1033\" titleKey=\"1133\" panelName=\"ToolsPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {/* Till Land Button */}\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString(\"Till Land\", strings)}\n              className={coolingDownItems.has('terraform-till') ? 'cooldown' : ''}\n              style={coolingDownItems.has('terraform-till') ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n              details={`${strings[461]} None`}\n              disabled={coolingDownItems.has('terraform-till')}\n              info={strings[310]}\n              onClick={() => handleTerraformWithCooldown(\"till\")}\n            />\n\n            {/* Plant Grass Button */}\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString(\"Plant Grass\", strings)}\n              className={coolingDownItems.has('terraform-plantGrass') ? 'cooldown' : ''}\n              style={coolingDownItems.has('terraform-plantGrass') ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n              details={`${strings[461]} None<br>${strings[460]}${getLocalizedString('Grower', strings)}`}\n              disabled={coolingDownItems.has('terraform-plantGrass') || !hasRequiredSkill('Grower')}\n              info={strings[311]}\n              onClick={() => handleTerraformWithCooldown(\"plantGrass\")}\n            />\n\n            {/* Lay Pavement Button */}\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString(\"Lay Pavement\", strings)}\n              className={coolingDownItems.has('terraform-pave') ? 'cooldown' : ''}\n              style={coolingDownItems.has('terraform-pave') ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n              details={`${strings[461]} None<br>${strings[460]}${getLocalizedString('Pickaxe', strings)}`}\n              disabled={coolingDownItems.has('terraform-pave') || !hasRequiredSkill('Pickaxe')}\n              info={strings[312]}\n              onClick={() => handleTerraformWithCooldown(\"pave\")}\n            />\n\n            {/* Lay Stone Button */}\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString(\"Lay Stone\", strings)}\n              className={coolingDownItems.has('terraform-stone') ? 'cooldown' : ''}\n              style={coolingDownItems.has('terraform-stone') ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n              details={`${strings[461]} None<br>${strings[460]}${getLocalizedString('Pickaxe', strings)}`}\n              disabled={coolingDownItems.has('terraform-stone') || !hasRequiredSkill('Pickaxe')}\n              info={strings[312]}\n              onClick={() => handleTerraformWithCooldown(\"stone\")}\n            />\n\n            {/* Create Water Button - Developer Only */}\n            {isDeveloper && (\n              <ResourceButton\n                symbol=\"\"\n                name={getLocalizedString(\"Create Water\", strings)}\n                className={coolingDownItems.has('terraform-water') ? 'cooldown' : ''}\n                style={coolingDownItems.has('terraform-water') ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                details={`${strings[461]} None<br>Developer Only`}\n                disabled={coolingDownItems.has('terraform-water')}\n                info=\"Creates a water tile (Developer only)\"\n                onClick={() => handleTerraformWithCooldown(\"water\")}\n              />\n            )}\n\n\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}; \n\nexport default React.memo(ToolsPanel);","import API_BASE from '../config';\nimport axios from 'axios';\nimport { createCollectEffect } from '../VFX/VFX';\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { updateGridResource } from './GridManagement';\n\n// Generate unique transaction ID\nfunction generateTransactionId() {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Protected selling function for all panels\nexport async function handleProtectedSelling({\n  currentPlayer,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  onClose\n}) {\n  console.log(` [PROTECTED SELLING] Starting protected sale for ${stationType} at (${currentStationPosition.x}, ${currentStationPosition.y})`);\n  \n  // Debug: Check what resources exist at this position\n  const allResources = GlobalGridStateTilesAndResources.getResources();\n  const resourcesAtPosition = allResources.filter(res => {\n    // Check exact position\n    if (res.x === currentStationPosition.x && res.y === currentStationPosition.y) {\n      return true;\n    }\n    // Check if this position is covered by a multi-tile resource\n    const range = res.range || 1;\n    if (range > 1) {\n      return currentStationPosition.x >= res.x && currentStationPosition.x < res.x + range &&\n             currentStationPosition.y <= res.y && currentStationPosition.y > res.y - range;\n    }\n    return false;\n  });\n  \n  console.log(` Resources at/covering position (${currentStationPosition.x}, ${currentStationPosition.y}):`, resourcesAtPosition);\n  \n  // Generate  transaction ID and key\n  const transactionId = generateTransactionId();\n  const transactionKey = `sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`;\n  \n  try {\n    const response = await axios.post(`${API_BASE}/api/sell-for-refund`, {\n      playerId: currentPlayer.playerId,\n      gridId,\n      stationX: currentStationPosition.x,\n      stationY: currentStationPosition.y,\n      stationType,\n      transactionId,\n      transactionKey\n    });\n\n    if (response.data.success) {\n      const { refundIngredients, totalMoneyRefund, inventory, removedStation } = response.data;\n      \n      // Update inventory from server response\n      if (inventory) {\n        setInventory(inventory);\n        setCurrentPlayer(prev => ({ ...prev, inventory }));\n      }\n\n      // Find the resource to check if it has shadows\n      const soldResource = GlobalGridStateTilesAndResources.getResources().find(\n        (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n      );\n      \n      // Remove ONLY the main resource from DB (shadows only exist in local state)\n      await updateGridResource(gridId, {\n        x: currentStationPosition.x,\n        y: currentStationPosition.y,\n        type: null\n      }, true);\n      \n      console.log(` Removed main resource from database`);\n      \n      // Update local state to reflect removal of station and shadows\n      const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n        (res) => {\n          // Remove the sold station\n          if (res.x === currentStationPosition.x && res.y === currentStationPosition.y) return false;\n          \n          // Remove any shadows belonging to this station\n          if (soldResource && soldResource.range && soldResource.range > 1 && res.type === 'shadow') {\n            // Generate the anchorKey the same way we do when creating shadows\n            const anchorKey = soldResource.anchorKey || `${soldResource.type}-${soldResource.x}-${soldResource.y}`;\n            if (res.parentAnchorKey === anchorKey) {\n              return false;\n            }\n          }\n          return true;\n        }\n      );\n      GlobalGridStateTilesAndResources.setResources(filteredResources);\n      setResources(filteredResources);\n\n      // Visual feedback\n      createCollectEffect(currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n      \n      console.log(` Station ${stationType} sold successfully for ${totalMoneyRefund} Money.`);\n      updateStatus(`Sold ${stationType} for ${totalMoneyRefund} Money.`);\n      \n      // Close the panel\n      onClose();\n      \n      return { success: true, totalMoneyRefund };\n    }\n  } catch (error) {\n    console.error('Error in protected station selling:', error);\n    \n    if (error.response?.status === 429) {\n      updateStatus(471);\n    } else if (error.response?.status === 400) {\n      console.error(' 400 Error details:', error.response?.data);\n      updateStatus(` Cannot sell: ${error.response?.data?.error || 'Invalid request'}`);\n    } else {\n      updateStatus(' Failed to sell station');\n    }\n    \n    return { success: false, error: error.response?.data?.error || 'Unknown error' };\n  }\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { spendIngredients } from '../../Utils/InventoryManagement';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport { incrementFTUEStep } from '../FTUE/FTUE';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\nconst SkillsPanel = ({ \n    onClose,\n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer,\n    setCurrentPlayer,\n    stationType, \n    currentStationPosition,\n    gridId,\n    isDeveloper,\n    TILE_SIZE,\n    updateStatus,\n    masterSkills,\n    setResources,\n    masterResources,\n}) => {\n  const strings = useStrings();\n  const [entryPoint, setEntryPoint] = useState(stationType || \"Skills Panel\"); \n  const [allResources, setAllResources] = useState([]);\n  const [skillsToAcquire, setSkillsToAcquire] = useState([]);\n  const [ownedSkills, setOwnedSkills] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [stationEmoji, setStationEmoji] = useState(''); // Default emoji for Skills Panel\n\n  //  Update `entryPoint` when `stationType` changes\n  useEffect(() => {\n    if (!stationType) {\n      setEntryPoint(\"Basic Skills\"); //  Ensure default entry point when coming from the UI button\n      // NOTE: This \"Basic Skills\" string comes from resources.json\n    } else if (stationType !== entryPoint) {\n      setEntryPoint(stationType);\n    }\n  }, [stationType]);\n\n  //  Fetch resources when `entryPoint` changes\n  useEffect(() => {\n    const fetchResourcesAndInventory = async () => {\n      setIsContentLoading(true);\n      try {\n        console.log(\"Fetching skills and inventory for:\", entryPoint);\n        \n        const [inventoryResponse, skillsResponse, resourcesResponse] = await Promise.all([\n          axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`),\n          axios.get(`${API_BASE}/api/skills/${currentPlayer.playerId}`),\n          axios.get(`${API_BASE}/api/resources`),\n        ]);\n\n        const serverInventory = inventoryResponse.data.inventory || [];\n        const serverBackpack = inventoryResponse.data.backpack || [];\n        const serverSkills = skillsResponse.data.skills || [];\n        const allResourcesData = resourcesResponse.data;\n\n        setInventory(serverInventory);\n        setBackpack(serverBackpack);\n        setAllResources(allResourcesData);\n\n        const stationResource = allResourcesData.find((resource) => resource.type === stationType);\n        setStationEmoji(stationResource?.symbol || '');\n\n        //  Filter owned skills\n        const ownedSkills = serverSkills.filter(skill =>\n          allResourcesData.some(res => res.type === skill.type && (res.category === 'skill' || res.category === 'upgrade'))\n        );\n        setOwnedSkills(ownedSkills);\n\n        //  Filter available skills based on `entryPoint`\n        let availableSkills = allResourcesData.filter(\n          res => (res.category === 'skill' || res.category === 'upgrade') &&\n          res.source === entryPoint && \n          !ownedSkills.some(owned => owned.type === res.type)\n        );\n\n        //  Additional filter for first-time users\n        if (currentPlayer?.firsttimeuser === true) {\n          // Helper function to check if skill can be acquired\n          const canAcquireSkill = (skill) => {\n            // Check if skill has requirements\n            if (skill.requires) {\n              // Check if the player owns the required skill\n              const hasRequirement = ownedSkills.some(owned => owned.type === skill.requires);\n              if (!hasRequirement) return false;\n            }\n            \n            // Check if skill level is appropriate for FTUE step\n            if (currentPlayer.ftuestep != null && skill.level != null) {\n              return skill.level <= currentPlayer.ftuestep;\n            }\n            \n            // If no FTUE step or skill level, can acquire\n            return true;\n          };\n\n          availableSkills = availableSkills.filter(canAcquireSkill);\n        }\n\n        setSkillsToAcquire(availableSkills);\n      } catch (error) {\n        console.error('Error fetching resources, inventory, or skills:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n\n    fetchResourcesAndInventory();\n  }, [entryPoint, currentPlayer?.ftuestep, currentPlayer?.playerId]); //  Re-fetch when `entryPoint` changes, FTUE step changes, or player changes\n\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || \n        ownedSkills.some((owned) => owned.type === requiredSkill);\n  };\n\n\nconst handleGemPurchase = async (modifiedRecipe) => {\n  // This is called by the gem button with a recipe modified to include gems\n  return handlePurchase(modifiedRecipe.type, modifiedRecipe);\n};\n\nconst handlePurchase = async (resourceType, customRecipe = null) => {\n  const resource = skillsToAcquire.find((item) => item.type === resourceType);\n  const recipeToUse = customRecipe || resource;\n  \n  const spendSuccess = await spendIngredients({\n    playerId: currentPlayer.playerId,\n    recipe: recipeToUse,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n  });\n\n  if (!spendSuccess) {\n    console.warn('Failed to spend ingredients.');\n    return;\n  }\n\n  const updatedSkills = [...ownedSkills];\n  // Add the new skill regardless of whether it's skill or upgrade category\n  updatedSkills.push({ type: resource.type, category: resource.category, quantity: 1 });\n  setOwnedSkills(updatedSkills);\n  updateStatus(` ${getLocalizedString(resource.type, strings)} skill acquired.`);\n  \n  try { \n    await axios.post(`${API_BASE}/api/update-skills`, {\n      playerId: currentPlayer.playerId,\n      skills: updatedSkills,\n    });\n    await trackQuestProgress(currentPlayer, 'Gain skill with', resource.type, 1, setCurrentPlayer);\n    await earnTrophy(currentPlayer.playerId, 'Skill Builder', 1, currentPlayer, null, setCurrentPlayer);    \n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    \n    // Check if the player is a first-time user and just acquired the Axe skill\n    if (currentPlayer.firsttimeuser === true && resource.type === 'Axe') {\n      console.log(' First-time user acquired Axe skill, advancing FTUE step');\n      await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n    }\n    \n    // Check if the player is a first-time user and just acquired the Grower skill\n    if (currentPlayer.firsttimeuser === true && resource.type === 'Grower') {\n      console.log(' First-time user acquired Grower skill, advancing FTUE step');\n      await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n    }\n\n    // Instead of re-fetching, update the acquire list locally\n    setSkillsToAcquire(prev => prev.filter(skill => skill.type !== resource.type));\n\n  } catch (error) {\n    console.error('Error updating player on server:', error);\n    setErrorMessage('Error updating player on server.');\n  }\n};\n\n  const handleSellStation = async () => {\n    try {\n      const success = await handleProtectedSelling({\n        currentPlayer,\n        stationType,\n        currentStationPosition,\n        gridId,\n        setResources,\n        setInventory,\n        setCurrentPlayer,\n        updateStatus,\n        onClose,\n      });\n      \n      if (success) {\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error selling station:', error);\n      updateStatus('Failed to sell station');\n    }\n  };\n\n  // Check if we should show the sell button\n  const showSellButton = isDeveloper && \n    [\"Adventure Camp\", \"Laboratory\", \"School\", \"Guild\"].includes(entryPoint) &&\n    currentStationPosition && gridId;\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1005\" title={`${stationEmoji} ${entryPoint}`} panelName=\"SkillsPanel\">\n      <div className=\"standard-panel\">\n      \n      {showSellButton && (\n        <div className=\"shared-buttons\">\n          <TransactionButton \n            className=\"btn-danger\" \n            onAction={handleSellStation}\n            transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n          >\n            {strings[490]}\n          </TransactionButton>\n        </div>\n      )}\n      \n      {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {![\"Adventure Camp\", \"Laboratory\", \"School\", \"Guild\"].includes(entryPoint) && (\n              <div className=\"skills-owned\">\n                <h3>{strings[1303]}</h3>\n                {ownedSkills.length > 0 ? (\n                  ownedSkills.map((skill, index) => (\n                    <div key={index}>\n                      {getLocalizedString(skill.type, strings)} \n                    </div>\n                  ))\n                ) : (\n                  <p>{strings[1305]}</p>\n                )}\n              </div>\n            )}\n\n\n            <div className=\"skills-to-acquire\">\n              {skillsToAcquire.length > 0 && <h3>{strings[1301]}</h3>}\n              <div className=\"skills-options\">\n                {skillsToAcquire.map((resource) => {\n                  const affordable = canAfford(resource, inventory, backpack, 1);\n                  const meetsRequirement = hasRequiredSkill(resource.requires);\n\n                  const formattedCosts = [1, 2, 3, 4].map((i) => {\n                    const type = resource[`ingredient${i}`];\n                    const qty = resource[`ingredient${i}qty`];\n                    if (!type || !qty) return '';\n\n                    const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                    const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                    const playerQty = inventoryQty + backpackQty;\n                    const color = playerQty >= qty ? 'green' : 'red';\n                    const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                    return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n                  }).join('');\n\n                  const skillColor = meetsRequirement ? 'green' : 'red';\n                  const details =\n                    (resource.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(resource.requires, strings)}</span><br>` : '') +\n                    `${strings[461]}<div>${formattedCosts}</div>`;\n\n                  //  **Check if this skill modifies a player attribute**\n                  const attributeModifier = resource.output\n                    ? `+${resource.qtycollected || 1} to ${strings[resource.output] || resource.output}`\n                    : null;\n\n                  //  Check if this skill provides a collection buff\n                  let buffText = '';\n                  const buffedItems = masterSkills[resource.type];\n                  if (buffedItems && typeof buffedItems === 'object') {\n                    const items = Object.keys(buffedItems);\n                    if (items.length > 0) {\n                      const prettyList = items.join(', ');\n                      buffText = `Collection multiplied: ${prettyList}`;\n                    }\n                  }\n\n                  const unlocks = allResources\n                    .filter((res) => res.requires === resource.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None';\n\n                    const info = (\n                      <div className=\"info-content\">\n                        {attributeModifier && <div>{attributeModifier}</div>}\n                        {unlocks !== 'None' && (\n                          <div style={{ display: 'block', marginBottom: '3px' }}>\n                            <strong>Unlocks:</strong> {unlocks}\n                          </div>\n                        )}\n                        {buffText && <div style={{ color: 'blue' }}>{buffText}</div>}\n                      </div>\n                    );\n\n                  return (\n                    <ResourceButton\n                      key={resource.type}\n                      symbol={resource.symbol}\n                      name={getLocalizedString(resource.type, strings)}\n                      details={details}\n                      info={info}\n                      disabled={!affordable || !meetsRequirement}\n                      onClick={() => handlePurchase(resource.type)}\n                      // Don't pass gemCost - let ResourceButton calculate it based on missing ingredients\n                      onGemPurchase={(resource.gemcost && (!affordable || !meetsRequirement)) ? handleGemPurchase : null}\n                      resource={resource}\n                      inventory={inventory}\n                      backpack={backpack}\n                      masterResources={masterResources || allResources}\n                      currentPlayer={currentPlayer}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n\n          </>\n        )}\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(SkillsPanel);","/**\n * Calculates settlement population by counting occupied homesteads\n * This is the unified method for determining settlement population across the application\n * @param {Object} settlementData - The settlement data object containing grids\n * @returns {number} The population count based on occupied homesteads\n */\nexport const calculateSettlementPopulation = (settlementData) => {\n  if (!settlementData || !settlementData.grids) {\n    console.warn('calculateSettlementPopulation: No settlement data or grids provided');\n    return 0;\n  }\n\n  const allGrids = settlementData.grids?.flat() || [];\n  const occupiedHomesteads = allGrids.filter(grid => \n    grid.gridType === \"homestead\" && grid.available === false\n  ).length || 0;\n  \n  return occupiedHomesteads;\n};","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport { getMayorUsername } from './GovUtils';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport '../../UI/Modal.css';\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\n\nfunction GovPanel({ onClose, currentPlayer, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [settlementData, setSettlementData] = useState(null);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [taxRate, setTaxRate] = useState(0);\n  const [population, setPopulation] = useState(0);\n  const [taxLog, setTaxLog] = useState([]);\n  const [mayor, setMayor] = useState(\"\");\n  // Community Buildings counts\n  const resources = GlobalGridStateTilesAndResources.getResources() || [];\n  const buildingCounts = {\n      School: 0,\n      Hospital: 0,\n      Library: 0\n  };\n  resources.forEach(res => {\n      if (res.type === 'School') buildingCounts.School++;\n      if (res.type === 'Hospital') buildingCounts.Hospital++;\n      if (res.type === 'Library') buildingCounts.Library++;\n  });\n  \n  useEffect(() => {\n    const fetchGovernmentData = async () => {\n      setIsContentLoading(true);\n      if (!currentPlayer || !currentPlayer.settlementId) {\n        console.warn(\" currentPlayer or settlementId is not available yet.\");\n        return; \n      }\n  \n      try {\n        console.log(\" Fetching full settlement data for ID:\", currentPlayer.settlementId);\n        \n        const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n        const settlement = settlementResponse.data;\n        setSettlementData(settlement);\n        setTaxLog(settlement.taxlog || []);\n        setTaxRate(settlement.taxrate || 0);\n        \n        const population = calculateSettlementPopulation(settlement);\n        setPopulation(population);\n        \n        const mayorName = await getMayorUsername(currentPlayer.settlementId);\n        setMayor(mayorName);\n          \n      } catch (error) {\n        console.error(\" Error fetching government data:\", error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n  \n    fetchGovernmentData();\n  }, [currentPlayer]);\n\n  const handleShowTaxLog = async () => {\n    if (!currentPlayer?.settlementId) {\n      console.warn(\" Cannot show tax log: settlementId missing.\");\n      return;\n    }\n\n    console.log(\" Requesting tax log for settlement ID:\", currentPlayer.settlementId);\n \n    try {\n      const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/taxlog`);\n      console.log(\" Tax log response:\", response.data);\n      const taxlog = response.data.taxlog || [];\n\n      console.log(\" Parsed taxlog:\", taxlog);\n\n      const taxLogTable = (\n        <table className=\"tax-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5102\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5103\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5104\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5105\"]}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...taxlog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.totalcollected}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.currentmayor}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.mayortake}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: strings[\"5100\"],\n        size: \"large\",\n        message: taxlog.length === 0\n          ? strings[\"5101\"]\n          : undefined,\n        custom: taxLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch tax log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load tax log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1007\" titleKey=\"1107\" panelName=\"GovPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n            {/* Settlement Information */}\n            {settlementData && (\n              <>\n                <h3><strong>{strings[\"3001\"]}</strong></h3>  \n                <h3 style={{ color: 'rgb(154, 106, 22)' }}><strong>{settlementData.displayName || settlementData.name || 'Unnamed Settlement'}</strong></h3>\n                <h3>{strings[\"3002\"]} <strong>{population}</strong></h3>\n              </>\n            )}\n\n            {/* Taxes Section */}\n            <h3>{strings[\"3003\"]} {taxRate}%</h3>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-success\" onClick={handleShowTaxLog}>{strings[3020]}</button>            \n            </div>\n            <p>{strings[\"3004\"]}</p>\n            \n\n{/* CURRENT MAYOR section */}\n            <h3>{strings[2085]}</h3>\n            <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{mayor || \"Vacant\"}</strong></h2>\n\n            <p>{strings[\"3005\"]}</p>\n            <p>{strings[\"3009\"]}</p>\n            <p>{strings[\"3010\"]}</p>\n            <p>{strings[\"3011\"]}</p>\n            <p>{strings[\"3012\"]}</p>\n            <p>{strings[\"3013\"]}</p>\n\n            {/* COMMUNITY BUILDINGS section - only show in towns */}\n            {currentPlayer?.location?.gtype === 'town' && (\n              <>\n                <h3>{strings[\"2090\"]}</h3>\n                <p>{buildingCounts.School > 0 ? `${strings[\"2092\"]}${buildingCounts.School}` : strings[\"2093\"]}</p>\n                <p>{buildingCounts.Hospital > 0 ? `${strings[\"2094\"]}${buildingCounts.Hospital}` : strings[\"2095\"]}</p>\n                <p>{buildingCounts.Library > 0 ? `${strings[\"2098\"]}${buildingCounts.Library}` : strings[\"2099\"]}</p>\n              </>\n            )}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}\n\nexport default GovPanel;","import API_BASE from '../../config.js';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport { formatCountdown } from '../../UI/Timers.js';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction BankPanel({ \n    onClose, \n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer, \n    setCurrentPlayer, \n    updateStatus,\n    masterResources,\n    globalTuning, }) \n{\n    const strings = useStrings();\n    const [isContentLoading, setIsContentLoading] = useState(false);\n    const [bankOffers, setBankOffers] = useState([]);\n    const [bankTimer, setBankTimer] = useState(\"\");\n    const [bankPhase, setBankPhase] = useState(\"\");\n    const [coolingDownButtons, setCoolingDownButtons] = useState(new Set());\n    const COOLDOWN_DURATION = 1500; // 3x longer for bank transactions\n\n    // Fetch data - separated from timer logic\n    const fetchBankOffers = async () => {\n       setIsContentLoading(true);\n       try {\n            const response = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n            setBankOffers(response.data.bank?.offers || []);\n            setBankPhase(response.data.bank?.phase || \"\");\n        } catch (error) {\n            console.error(' Error fetching bank offers:', error);\n        } finally {\n            setIsContentLoading(false);\n        }\n    };\n\n    // Timer + Phase Change Detection\n    useEffect(() => {\n        const updateCountdown = () => {\n            const now = Date.now();\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            const bankTimerData = storedTimers.bank || {};\n            \n            // Check for phase change\n            if (bankTimerData.phase !== bankPhase) {\n                console.log(\" Bank phase changed, fetching new data...\");\n                fetchBankOffers();\n            }\n            \n            setBankTimer(formatCountdown(bankTimerData.endTime, now));\n        };\n\n        updateCountdown();\n        const interval = setInterval(updateCountdown, 1000);\n        return () => clearInterval(interval);\n    }, [bankPhase, currentPlayer?.frontierId]);\n\n    // Initial load\n    useEffect(() => {\n        if (currentPlayer?.frontierId) {\n            fetchBankOffers();\n        }\n    }, [currentPlayer?.frontierId]);\n\n    //  Handle trade transaction\n    const handleTrade = async (offer) => {\n        if (!offer || !currentPlayer) return;\n\n        // Spend ingredients\n        const success = await spendIngredients({\n          playerId: currentPlayer.playerId,\n          recipe: {\n            ingredient1: offer.itemBought,\n            ingredient1qty: offer.qtyBought,\n          },\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n        });\n\n        if (!success) return;\n\n        // Gain the given item (usually Money)\n        const gainSuccess = await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: offer.itemGiven,\n          quantity: offer.qtyGiven,\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n\n        if (!gainSuccess) return;\n\n        await trackQuestProgress(currentPlayer,'Sell',offer.itemBought,offer.qtyBought,setCurrentPlayer);\n\n        updateStatus(` Exchanged ${offer.qtyBought} ${offer.itemBought} for ${offer.qtyGiven} ${offer.itemGiven}.`);\n    };\n\n    // Wrap handleTrade with cooldown to prevent spam clicking\n    const handleTradeWithCooldown = async (offer, buttonIndex) => {\n        if (coolingDownButtons.has(buttonIndex)) return;\n        \n        console.log(`Starting cooldown for button ${buttonIndex}, duration: ${COOLDOWN_DURATION}ms (${COOLDOWN_DURATION / 1000}s)`);\n        \n        // Add this button to cooling down set\n        setCoolingDownButtons(prev => new Set(prev).add(buttonIndex));\n        \n        setTimeout(() => {\n            console.log(`Ending cooldown for button ${buttonIndex}`);\n            // Remove this button from cooling down set\n            setCoolingDownButtons(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(buttonIndex);\n                return newSet;\n            });\n        }, COOLDOWN_DURATION);\n\n        await handleTrade(offer);\n    };\n\n    //  Lookup function for symbols from `masterResources`\n    const getSymbol = (resourceType) => {\n        const resource = masterResources.find(res => res.type === resourceType);\n        return resource?.symbol || \"\"; // Default to question mark if no symbol found\n    };\n\n    return (\n      <Panel onClose={onClose} descriptionKey=\"1017\" titleKey=\"1117\" panelName=\"BankPanel\">\n        {/* Check if player is in their home settlement */}\n        {(() => {\n          const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n          console.log(' Bank access check:', {\n            currentSettlement: currentPlayer.location.s,\n            homeSettlement: currentPlayer.settlementId,\n            isInHomeSettlement\n          });\n          return !isInHomeSettlement;\n        })() ? (\n          <div style={{ textAlign: 'center', padding: '20px' }}>\n            <h2>{strings[2050] || \"This is not your home settlement. You cannot access banking services in any settlement but your own.\"}</h2>\n          </div>\n        ) : isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {/* Active phase showing current offers */}\n            {bankPhase === \"active\" ? (\n              <>\n                <h3>{strings[\"1402\"]}</h3> {/* \"These offers good for\" */}\n                <h2>{bankTimer}</h2>\n                {bankOffers.length > 0 ? (\n                  bankOffers.map((offer, index) => {\n                    // Calculate player's total quantity from inventory and backpack\n                    const inventoryQty = inventory?.find(item => item.type === offer.itemBought)?.quantity || 0;\n                    const backpackQty = backpack?.find(item => item.type === offer.itemBought)?.quantity || 0;\n                    const playerQty = inventoryQty + backpackQty;\n                    \n                    return (\n                      <ResourceButton\n                        key={index}\n                        className={coolingDownButtons.has(index) ? 'cooldown' : ''}\n                        style={coolingDownButtons.has(index) ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                        onClick={() => handleTradeWithCooldown(offer, index)}\n                        disabled={coolingDownButtons.has(index) || !canAfford({\n                          ingredient1: offer.itemBought,\n                          ingredient1qty: offer.qtyBought\n                        }, inventory, backpack, 1)}\n                        hideInfo={true}\n                      >\n                        <div className=\"resource-details\">\n                          <span><strong>{strings[\"1403\"]}</strong></span> {/* \"Will buy\" */}\n                          {getSymbol(offer.itemBought)} {offer.itemBought} x{offer.qtyBought} / {playerQty}\n                          <br />\n                          {strings[\"1404\"]} {getSymbol(offer.itemGiven)} {offer.qtyGiven} {/* \"for\" */}\n                        </div>\n                      </ResourceButton>\n                    );\n                  })\n                ) : (\n                  <p>{strings[\"1405\"]}</p>  \n                )}\n              </>\n            ) : (\n              <>\n                <h3>{strings[\"1406\"]}</h3> {/* \"New offers in\" */}\n                <h2>{bankTimer}</h2>\n                <p>{strings[\"1407\"]}</p> {/* \"Generating new orders. Thank you for your patience.\" */}\n              </>\n            )}\n          </>\n        )}\n      </Panel>\n    );\n}\n\nexport default BankPanel;","import { isACrop } from '../../Utils/ResourceHelpers';\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\n\n/**\n * Generates new Kent offers based on player skills and available resources\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @returns {Array} Array of new Kent offers\n */\nexport function generateNewKentOffers(currentPlayer, masterResources, globalTuning, currentSeason) {\n    const playerSkills = currentPlayer?.skills || [];\n    const playerSkillTypes = playerSkills.map(skill => skill.type);\n    \n    console.log(' Kent offer generation:', {\n        isFirstTimeUser: currentPlayer?.firsttimeuser,\n        playerSkills: playerSkillTypes\n    });\n    \n    // Filter eligible resources for Kent offers\n    const eligibleResources = masterResources.filter(resource => {\n        // Must be a doober\n        if (resource.category !== 'doober') return false;\n        \n        // Exclude resources with noBank output\n        if (resource.output === 'noBank') return false;\n        \n        // Check if player has required skills\n        if (resource.requires && !playerSkillTypes.includes(resource.requires)) {\n            return false;\n        }\n        \n        // Check if resource is seasonal and matches current season\n        if (resource.season && resource.season !== currentSeason) {\n            return false;\n        }\n        \n        // Check if any ingredients are out of season\n        const ingredients = [\n            resource.ingredient1,\n            resource.ingredient2, \n            resource.ingredient3,\n            resource.ingredient4\n        ].filter(Boolean);\n        \n        for (const ingredient of ingredients) {\n            const ingredientResource = masterResources.find(r => r.type === ingredient);\n            if (ingredientResource && ingredientResource.season && ingredientResource.season !== currentSeason) {\n                return false;\n            }\n        }\n        \n        // === FIRST-TIME USER ONLY FILTERS ===\n        // If player is first time user, only show crops\n        if (currentPlayer?.firsttimeuser === true) {\n            if (!isACrop(resource.type, masterResources)) {\n                return false;\n            }\n        }\n        \n        // === FILTERS FOR ALL USERS (including first-time users) ===\n        // Filter out epic and legendary scroll chance items\n        if (resource.scrollchance === 'epic' || resource.scrollchance === 'legendary') {\n            return false;\n        }\n        \n        // Filter out valley source items\n        if (resource.source === 'valley') {\n            return false;\n        }\n        \n        // Filter out resources where the source requires skills the player doesn't have\n        const sourceResource = masterResources.find(r => r.type === resource.source);\n        \n        console.log(` Checking ${resource.type} (source: ${resource.source}):`, {\n            foundSourceResource: !!sourceResource,\n            sourceType: sourceResource?.type,\n            sourceRequires: sourceResource?.requires,\n            playerSkills: playerSkillTypes,\n            hasRequiredSkill: sourceResource?.requires ? playerSkillTypes.includes(sourceResource.requires) : 'N/A',\n            shouldFilter: sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)\n        });\n        \n        // If source resource exists and requires a skill the player doesn't have, exclude\n        if (sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)) {\n            console.log(` Filtering out ${resource.type} - source ${resource.source} requires ${sourceResource.requires} skill`);\n            return false;\n        }\n        \n        // Filter out resources that are outputs of attack resources if player doesn't have \"Explore the Valley\" trophy\n        const hasExploreValleyTrophy = currentPlayer?.trophies?.some(trophy => trophy.title === \"Explore the Valley\");\n        if (!hasExploreValleyTrophy) {\n            const attackResource = masterResources.find(r => \n                r.action === 'attack' && r.output === resource.type\n            );\n            \n            if (attackResource) {\n                console.log(` Filtering out ${resource.type} - output of attack resource ${attackResource.type}, player lacks \"Explore the Valley\" trophy`);\n                return false;\n            }\n        }\n        \n        return true;\n    });\n    \n    if (eligibleResources.length === 0) {\n        console.warn('No eligible resources found for Kent offers');\n        return [];\n    }\n    \n    const newOffers = [];\n    const maxOffers = globalTuning?.maxKentOffers || 6;\n    const currentOfferCount = currentPlayer?.kentOffers?.offers?.length || 0;\n    \n    // Determine how many new offers to generate\n    let offersToGenerate = 2; // Default to 2\n    if (currentOfferCount + 2 > maxOffers) {\n        offersToGenerate = Math.max(0, maxOffers - currentOfferCount);\n    }\n    \n    for (let i = 0; i < offersToGenerate; i++) {\n        // Get all existing Kent offers to check for duplicates\n        const allExistingOffers = [...(currentPlayer?.kentOffers?.offers || []), ...newOffers];\n        \n        // Count how many offers already exist for each resource type\n        const resourceCounts = {};\n        allExistingOffers.forEach(offer => {\n            resourceCounts[offer.item] = (resourceCounts[offer.item] || 0) + 1;\n        });\n        \n        // Filter out resources that already have 2 or more offers\n        const availableResources = eligibleResources.filter(resource => \n            (resourceCounts[resource.type] || 0) < 2\n        );\n        \n        // If no resources available (all have 2+ offers), break out of loop\n        if (availableResources.length === 0) {\n            console.log(' No more unique resources available (all have 2+ offers)');\n            break;\n        }\n        \n        const randomResource = availableResources[Math.floor(Math.random() * availableResources.length)];\n        \n        // Determine quantity based on crop status and first-time user status\n        let quantity;\n        if (isACrop(randomResource.type, masterResources)) {\n            if (currentPlayer?.firsttimeuser === true) {\n                quantity = Math.floor(Math.random() * 9) + 4; // Random from 4 to 12 for first-time users\n            } else {\n                quantity = Math.floor(Math.random() * 37) + 4; // Random from 4 to 40 for regular users\n            }\n        } else {\n            quantity = Math.floor(Math.random() * 10) + 1; // Random from 1 to 10\n        }\n        \n        // Calculate primary reward (Money = maxprice * quantity)\n        const rewardAmount = (randomResource.maxprice || 100) * quantity;\n        \n        const rewards = [\n            {\n                item: 'Money',\n                quantity: rewardAmount\n            }\n        ];\n\n        // Check for bonus valley resource reward (same method as warehouse ingredients)\n        const dropRate = globalTuning?.harvestDropRate || 0.1; // Use same drop rate as warehouse ingredients\n        const bonusRoll = Math.random();\n        \n        console.log(` Kent bonus reward check for ${randomResource.type}:`);\n        console.log(`   globalTuning.harvestDropRate: ${globalTuning?.harvestDropRate}`);\n        console.log(`   Resolved drop rate: ${dropRate} (${(dropRate * 100).toFixed(1)}%)`);\n        console.log(`   Roll: ${bonusRoll.toFixed(3)}`);\n        console.log(`   Success: ${bonusRoll <= dropRate ? 'YES' : 'NO'}`);\n        \n        if (bonusRoll <= dropRate) {\n            console.log(` Kent bonus reward roll succeeded!`);\n            \n            // Get all valley resources from masterResources\n            const valleyResources = masterResources.filter(res => res.source === 'valley' && res.scrollchance);\n            \n            console.log(`   Found ${valleyResources.length} valley resources with scrollchance:`);\n            valleyResources.forEach(res => {\n                console.log(`     - ${res.type} (${res.scrollchance})`);\n            });\n            \n            if (valleyResources.length > 0) {\n                // Use weighted random selection based on scrollchance rarity\n                const selectedValleyResource = selectWeightedRandomItem(valleyResources, 1);\n                \n                console.log(`   Selected valley resource: ${selectedValleyResource?.type || 'NONE'}`);\n                \n                if (selectedValleyResource) {\n                    // Valley resources drop 1-3 quantity based on rarity\n                    let bonusQuantity = 1;\n                    switch(selectedValleyResource.scrollchance) {\n                        case 'legendary':\n                        case 'epic':\n                            bonusQuantity = 1;\n                            break;\n                        case 'rare':\n                            bonusQuantity = Math.floor(Math.random() * 2) + 1; // 1-2\n                            break;\n                        case 'uncommon':\n                        case 'common':\n                        default:\n                            bonusQuantity = Math.floor(Math.random() * 3) + 1; // 1-3\n                            break;\n                    }\n                    \n                    rewards.push({\n                        item: selectedValleyResource.type,\n                        quantity: bonusQuantity\n                    });\n                    \n                    console.log(` ADDED valley bonus reward: ${selectedValleyResource.type} x${bonusQuantity} (${selectedValleyResource.scrollchance})`);\n                } else {\n                    console.log(` selectWeightedRandomItem returned null`);\n                }\n            } else {\n                console.log(` No valley resources found with scrollchance`);\n            }\n        } else {\n            console.log(` Kent bonus reward roll failed: ${bonusRoll.toFixed(3)} > ${dropRate}`);\n        }\n        \n        const newOffer = {\n            item: randomResource.type,\n            quantity: quantity,\n            rewards: rewards\n        };\n        \n        newOffers.push(newOffer);\n    }\n    \n    console.log(`Generated ${newOffers.length} new Kent offers:`, newOffers);\n    return newOffers;\n}\n\n/**\n * Removes a completed offer from the player's Kent offers and returns the position\n * @param {Object} kentOffers - Current kentOffers object\n * @param {Object} completedOffer - The offer that was just completed\n * @returns {Object} { kentOffers: updated kentOffers object, removedIndex: position of removed offer }\n */\nexport function removeCompletedOffer(kentOffers, completedOffer) {\n    if (!kentOffers || !kentOffers.offers) {\n        return { kentOffers, removedIndex: -1 };\n    }\n    \n    // Find the index of the completed offer\n    const removedIndex = kentOffers.offers.findIndex(offer => \n        offer.item === completedOffer.itemBought && \n        offer.quantity === completedOffer.qtyBought\n    );\n    \n    // Remove the completed offer\n    const updatedOffers = kentOffers.offers.filter((offer, index) => index !== removedIndex);\n    \n    return {\n        kentOffers: {\n            ...kentOffers,\n            offers: updatedOffers\n        },\n        removedIndex\n    };\n}\n\n/**\n * Updates Kent offers after a trade: removes completed offer and adds new ones\n * @param {Object} currentPlayer - The current player object\n * @param {Object} completedOffer - The offer that was just completed\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @returns {Object} Updated kentOffers object\n */\nexport function updateKentOffersAfterTrade(currentPlayer, completedOffer, masterResources, globalTuning, currentSeason) {\n    // Remove the completed offer and get its position\n    const { kentOffers: kentOffersWithoutCompleted, removedIndex } = removeCompletedOffer(currentPlayer.kentOffers, completedOffer);\n    \n    // Generate new offers (limit to 1 to replace the removed offer)\n    const newOffers = generateNewKentOffers(\n        { ...currentPlayer, kentOffers: kentOffersWithoutCompleted }, \n        masterResources, \n        globalTuning,\n        currentSeason\n    );\n    \n    // Insert the new offer at the same position as the removed one\n    const updatedOffers = [...kentOffersWithoutCompleted.offers];\n    \n    if (newOffers.length > 0 && removedIndex >= 0) {\n        // Insert the first new offer at the exact position of the removed offer\n        updatedOffers.splice(removedIndex, 0, newOffers[0]);\n        \n        // Add any additional new offers at the end\n        if (newOffers.length > 1) {\n            updatedOffers.push(...newOffers.slice(1));\n        }\n    } else if (newOffers.length > 0) {\n        // If we couldn't find the position, just add at the end\n        updatedOffers.push(...newOffers);\n    }\n    \n    return {\n        ...kentOffersWithoutCompleted,\n        offers: updatedOffers\n    };\n}","import API_BASE from '../../config.js';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { updateKentOffersAfterTrade } from './KentOfferLogic';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport './Kent.css'; // Kent-specific styles\nimport { formatCountdown } from '../../UI/Timers.js';\nimport { useStrings } from '../../UI/StringsContext';\nimport { incrementFTUEStep } from '../FTUE/FTUE';\nimport { getLocalizedString } from '../../Utils/stringLookup';\n\nfunction KentPanel({ \n    onClose, \n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer, \n    setCurrentPlayer, \n    updateStatus,\n    masterResources,\n    globalTuning,\n    currentSeason, }) \n{\n    const strings = useStrings();\n    const [isContentLoading, setIsContentLoading] = useState(false);\n    const [kentOffers, setKentOffers] = useState([]);\n    const [kentTimer, setKentTimer] = useState(\"\");\n    const [kentPhase, setKentPhase] = useState(\"\");\n    const [isTrading, setIsTrading] = useState(false); \n\n    // Generate fallback Kent offer and save to DB\n    const generateFallbackKentOffer = async () => {\n        try {\n            // Find Wheat's maxprice from masterResources\n            const wheatResource = masterResources.find(res => res.type === 'Wheat');\n            const wheatMaxPrice = wheatResource?.maxprice || 100; // fallback to 100 if not found\n            \n            const fallbackKentOffers = {\n                endTime: 0, // Available immediately\n                offers: [{\n                    item: 'Wheat',\n                    quantity: 4,\n                    rewards: [{\n                        item: 'Money',\n                        quantity: wheatMaxPrice * 4\n                    }]\n                }]\n            };\n            \n            // Save to player's kentOffers in DB\n            const response = await axios.post(`${API_BASE}/api/update-profile`, {\n                playerId: currentPlayer.playerId,\n                updates: { kentOffers: fallbackKentOffers }\n            });\n            \n            if (response.data.success) {\n                console.log(' Generated fallback Kent offers:', fallbackKentOffers);\n                return fallbackKentOffers;\n            }\n        } catch (error) {\n            console.error(' Error generating fallback Kent offer:', error);\n        }\n        return { endTime: 0, offers: [] };\n    };\n\n    // Fetch Kent offers from player data\n    const fetchKentOffers = async () => {\n        setIsContentLoading(true);\n        try {\n            // Get Kent offers from currentPlayer data\n            const kentData = currentPlayer?.kentOffers;\n            \n            // If no kentOffers exist or offers array is empty, generate fallback\n            if (!kentData || !kentData.offers || kentData.offers.length === 0) {\n                console.log(' No Kent offers found, generating fallback...');\n                const fallbackKentOffers = await generateFallbackKentOffer();\n                setKentOffers(fallbackKentOffers.offers || []);\n            } else {\n                setKentOffers(kentData.offers || []);\n            }\n            \n            setKentPhase('active'); // Kent is always active\n        } catch (error) {\n            console.error(' Error fetching Kent offers:', error);\n        } finally {\n            setIsContentLoading(false);\n        }\n    };\n\n    // Kent timer logic\n    useEffect(() => {\n        const updateKentTimer = () => {\n            const now = Date.now();\n            const kentData = currentPlayer?.kentOffers;\n            const endTime = kentData?.endTime || 0;\n            \n            if (endTime > now) {\n                // Timer is active - panel locked\n                setKentTimer(formatCountdown(endTime, now));\n                setKentPhase('locked');\n            } else {\n                // Timer expired - offers available\n                setKentTimer(strings[45]);\n                setKentPhase('active');\n            }\n        };\n\n        updateKentTimer();\n        const interval = setInterval(updateKentTimer, 1000);\n        return () => clearInterval(interval);\n    }, [currentPlayer?.kentOffers?.endTime]);\n\n    // Initial load\n    useEffect(() => {\n        if (currentPlayer?.playerId) {\n            fetchKentOffers();\n        }\n    }, [currentPlayer?.playerId]);\n\n    //  Handle trade transaction with protection against spam clicking\n    const handleTrade = async (offer) => {\n        if (!offer || !currentPlayer || isTrading) return;\n        \n        //  EXPLOIT FIX: Check Kent timer before allowing any trade\n        if (isKentOnCooldown()) {\n            console.log(' Kent trade blocked: Timer still active');\n            updateStatus(' Kent is not available yet. Please wait for the timer to expire.');\n            return;\n        }\n        \n        // Set trading flag to prevent spam clicks\n        setIsTrading(true);\n        \n        try {\n\n            // Spend ingredients\n            const success = await spendIngredients({\n              playerId: currentPlayer.playerId,\n              recipe: {\n                ingredient1: offer.itemBought,\n                ingredient1qty: offer.qtyBought,\n              },\n              inventory,\n              backpack,\n              setInventory,\n              setBackpack,\n              setCurrentPlayer,\n              updateStatus,\n            });\n\n            if (!success) return;\n\n            // Gain all rewards\n            let allRewardsSuccess = true;\n            const originalOffer = kentOffers.find(kentOffer => \n              kentOffer.item === offer.itemBought && kentOffer.quantity === offer.qtyBought\n            );\n            \n            if (originalOffer && originalOffer.rewards) {\n              for (const reward of originalOffer.rewards) {\n                const gainSuccess = await gainIngredients({\n                  playerId: currentPlayer.playerId,\n                  currentPlayer,\n                  resource: reward.item,\n                  quantity: reward.quantity,\n                  inventory,\n                  backpack,\n                  setInventory,\n                  setBackpack,\n                  setCurrentPlayer,\n                  updateStatus,\n                  masterResources,\n                  globalTuning,\n                });\n                \n                if (!gainSuccess) {\n                  allRewardsSuccess = false;\n                  break;\n                }\n              }\n            } else {\n              // Fallback to old single reward system\n              const gainSuccess = await gainIngredients({\n                playerId: currentPlayer.playerId,\n                currentPlayer,\n                resource: offer.itemGiven,\n                quantity: offer.qtyGiven,\n                inventory,\n                backpack,\n                setInventory,\n                setBackpack,\n                setCurrentPlayer,\n                updateStatus,\n                masterResources,\n                globalTuning,\n              });\n              allRewardsSuccess = gainSuccess;\n            }\n\n            if (!allRewardsSuccess) return;\n\n            // Create status message for multiple rewards\n            const rewardText = originalOffer && originalOffer.rewards \n              ? originalOffer.rewards.map(reward => `${reward.quantity} ${reward.item}`).join(', ')\n              : `${offer.qtyGiven} ${offer.itemGiven}`;\n\n            await refreshOffersAndSetTimer(offer, ` Exchanged ${offer.qtyBought} ${offer.itemBought} for ${rewardText}.`);\n            await trackQuestProgress(currentPlayer,'Sell',offer.itemBought,offer.qtyBought,setCurrentPlayer);\n            // Check if we should increment FTUE step after selling\n            if (currentPlayer.ftuestep === 3) {\n                console.log(' Player at FTUE step 3 sold wheat, incrementing FTUE step');\n                await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n            }\n            \n        } catch (error) {\n            console.error(' Error in Kent trade:', error);\n            updateStatus(' Trade failed. Please try again.');\n        } finally {\n            // Always clear the trading flag\n            setIsTrading(false);\n        }\n    };\n\n    //  Handle dismissing an offer without trading\n    const handleDismiss = async (offer) => {\n        if (!offer || !currentPlayer || isTrading) return;\n        \n        //  EXPLOIT FIX: Check Kent timer before allowing any dismiss\n        if (isKentOnCooldown()) {\n            console.log(' Kent dismiss blocked: Timer still active');\n            updateStatus(' Kent is not available yet. Please wait for the timer to expire.');\n            return;\n        }\n        \n        // Set trading flag to prevent spam clicks\n        setIsTrading(true);\n        \n        try {\n            await refreshOffersAndSetTimer(offer, ` Dismissed offer for ${offer.itemBought}.`);\n        } catch (error) {\n            console.error(' Error dismissing Kent offer:', error);\n            updateStatus(' Failed to dismiss offer. Please try again.');\n        } finally {\n            // Always clear the trading flag\n            setIsTrading(false);\n        }\n    };\n\n    //  Shared function to refresh offers and set timer\n    const refreshOffersAndSetTimer = async (offer, statusMessage) => {\n        // Reset Kent timer and update offers\n        const kentRefreshSeconds = globalTuning?.kentRefreshTimerSeconds || 5;\n        const newEndTime = Date.now() + (kentRefreshSeconds * 1000);\n        \n        // Update Kent offers: remove completed offer and add new ones\n        const updatedKentOffers = updateKentOffersAfterTrade(\n            currentPlayer,\n            offer,\n            masterResources,\n            globalTuning,\n            currentSeason\n        );\n        \n        // Set the new timer\n        updatedKentOffers.endTime = newEndTime;\n        \n        // Update player's kentOffers with new timer\n        const updateResponse = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { kentOffers: updatedKentOffers }\n        });\n        \n        if (updateResponse.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n                ...prev,\n                kentOffers: updatedKentOffers\n            }));\n            \n            // Update local kentOffers display\n            setKentOffers(updatedKentOffers.offers || []);\n        }\n\n        updateStatus(statusMessage);\n    };\n\n\n    //  Helper function to check if Kent is currently on cooldown\n    const isKentOnCooldown = () => {\n        const now = Date.now();\n        const kentData = currentPlayer?.kentOffers;\n        const endTime = kentData?.endTime || 0;\n        return endTime > now;\n    };\n\n    //  Lookup function for symbols from `masterResources`\n    const getSymbol = (resourceType) => {\n        const resource = masterResources.find(res => res.type === resourceType);\n        return resource?.symbol || \"\"; // Default to question mark if no symbol found\n    };\n\n    return (\n      <Panel onClose={onClose}  titleKey=\"1138\" panelName=\"KentPanel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {/* Show timer at top with fixed height */}\n            <div className=\"kent-header-area\">\n              {kentPhase === 'locked' ? (\n                <>\n                  <h2>{strings[46]}</h2>\n                  <h2>{kentTimer}</h2>\n                </>\n              ) : (\n                <h2>{kentTimer}</h2>\n              )}\n            </div>\n            \n            {/* Always show offers, but disable during cooldown */}\n            <>\n              {kentOffers.length > 0 ? (\n                kentOffers.map((offer, index) => {\n                    // Calculate player's total quantity from inventory and backpack\n                    const inventoryQty = inventory?.find(item => item.type === offer.item)?.quantity || 0;\n                    const backpackQty = backpack?.find(item => item.type === offer.item)?.quantity || 0;\n                    const playerQty = inventoryQty + backpackQty;\n                    \n                    // Convert Kent offer format to bank offer format for compatibility\n                    const convertedOffer = {\n                        itemBought: offer.item,\n                        qtyBought: offer.quantity,\n                        itemGiven: offer.rewards[0]?.item || 'Money',\n                        qtyGiven: offer.rewards[0]?.quantity || 0\n                    };\n                    \n                    // Check if Kent panel is locked (use both phase state and real-time check)\n                    const isLocked = kentPhase === 'locked' || isKentOnCooldown();\n                    \n                    return (\n                      <div key={index} className=\"kent-offer-wrapper\">\n                        <ResourceButton\n                          className={`kent-offer-button ${isLocked ? 'disabled' : ''}`}\n                          onClick={() => !isLocked && !isTrading && handleTrade(convertedOffer)}\n                          disabled={isLocked || isTrading || !canAfford({\n                            ingredient1: convertedOffer.itemBought,\n                            ingredient1qty: convertedOffer.qtyBought\n                          }, inventory, backpack, 1)}\n                          hideInfo={true}\n                        >\n                          <div className=\"resource-details\">\n                            <div className=\"kent-offer-content\">\n                              <div className=\"kent-offer-symbol\">\n                                {getSymbol(convertedOffer.itemBought)}\n                              </div>\n                              <div className=\"kent-offer-details\">\n                                <div className=\"kent-offer-requirement\">\n                                  <span className={`kent-offer-item ${playerQty < convertedOffer.qtyBought ? 'insufficient' : 'sufficient'}`}>\n                                    {getLocalizedString(convertedOffer.itemBought, strings)} x{convertedOffer.qtyBought} / {playerQty}\n                                  </span>\n                                </div>\n                                <div className=\"kent-offer-reward\">\n                                  {strings[42]} {offer.rewards.map((reward, rewardIndex) => \n                                    `${getSymbol(reward.item)} ${reward.quantity.toLocaleString()}${rewardIndex < offer.rewards.length - 1 ? ', ' : ''}`\n                                  ).join('')}\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </ResourceButton>\n                        <div \n                          className={`kent-dismiss-button ${isLocked || isTrading ? 'disabled' : ''}`}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            if (!isLocked && !isTrading) {\n                              handleDismiss(convertedOffer);\n                            }\n                          }}\n                        >\n                          \n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>No offers available from Kent.</p>\n              )}\n            </>\n          </>\n        )}\n      </Panel>\n    );\n}\n\nexport default KentPanel;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport './Train.css';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { formatCountdown } from '../../UI/Timers';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction TrainPanel({ \n  onClose, \n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer, \n  setCurrentPlayer, \n  updateStatus,\n  masterResources,\n  setModalContent,\n  setIsModalOpen,\n  globalTuning\n  }) \n{\n  const strings = useStrings();\n  const [trainOffers, setTrainOffers] = useState([]);\n  const [trainPhase, setTrainPhase] = useState(\"loading\");\n  const [trainTimer, setTrainTimer] = useState(\"\");\n  const [nextOffers, setNextOffers] = useState([]);\n  const [trainRewards, setTrainRewards] = useState([]);\n  const [latestInventory, setLatestInventory] = useState([]);\n  const [playerUsernames, setPlayerUsernames] = useState({}); // Map of playerId -> username\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [currentTrainNumber, setCurrentTrainNumber] = useState(null);\n\n  // 1. Initial load for the player\n  useEffect(() => {\n    const fetchInventory = async () => {\n      if (!currentPlayer?.playerId) return;\n      setIsContentLoading(true);\n      try {\n        const response = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setLatestInventory(response.data.inventory || []);\n      } catch (error) {\n        console.error(\" Error fetching latest inventory:\", error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n    fetchInventory();\n\n    if (currentPlayer?.settlementId) {\n      fetchTrainOffers();\n    }\n  }, [currentPlayer?.playerId, currentPlayer?.settlementId]);\n\n\n  // 2. Fetch fresh train offers on *every* phase change\n  useEffect(() => {\n    if (currentPlayer?.settlementId) {\n      fetchTrainOffers(); //  fixes stale data after phase transitions\n    }\n  }, [trainPhase]);\n\n\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = Date.now();\n\n      const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n      const trainTimerData = storedTimers.train || {};\n\n      const phase = trainTimerData.phase;\n      setTrainPhase(phase || \"unknown\");\n\n      const endTime = trainTimerData.endTime;\n      if (!endTime || isNaN(endTime)) {\n        setTrainTimer(\"N/A\");\n        return;\n      } else {\n        setTrainTimer(formatCountdown(endTime, now));\n      }\n    };\n\n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetchTrainOffers = async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n      const offers = response.data?.currentoffers || [];\n      setTrainOffers(offers);\n      setNextOffers(response.data?.nextoffers || []);\n      // Get current train info from trainlog\n      const trainlog = response.data?.trainlog || [];\n      const currentTrain = trainlog.find(log => log.status === \"Current Train\");\n      if (currentTrain) {\n        // Use rewards from the current train log entry\n        setTrainRewards(currentTrain.rewards || []);\n        if (currentTrain.trainnumber) {\n          setCurrentTrainNumber(currentTrain.trainnumber);\n        }\n      } else {\n        // No current train, clear rewards\n        setTrainRewards([]);\n      }\n      \n      // Fetch usernames for claimed/completed offers\n      await fetchUsernames(offers);\n    } catch (error) {\n      console.error(\" Error fetching train offers:\", error);\n    }\n  };\n\n  const fetchUsernames = async (offers) => {\n    try {\n      // Find all unique player IDs that have claimed or completed offers\n      const playerIds = [...new Set(\n        offers\n          .filter(offer => offer.claimedBy)\n          .map(offer => offer.claimedBy)\n      )];\n\n      if (playerIds.length === 0) return;\n\n      // Fetch usernames for these player IDs\n      const usernamePromises = playerIds.map(async (playerId) => {\n        try {\n          const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n          return { playerId, username: response.data.username };\n        } catch (error) {\n          console.error(` Error fetching username for player ${playerId}:`, error);\n          return { playerId, username: 'Unknown' };\n        }\n      });\n\n      const usernameResults = await Promise.all(usernamePromises);\n      \n      // Convert to map and update state\n      const usernameMap = usernameResults.reduce((acc, { playerId, username }) => {\n        acc[playerId] = username;\n        return acc;\n      }, {});\n\n      setPlayerUsernames(prev => ({ ...prev, ...usernameMap }));\n    } catch (error) {\n      console.error(\" Error fetching usernames:\", error);\n    }\n  };\n\n  const [showLogicModal, setShowLogicModal] = useState(false);\n  const [logicModalData, setLogicModalData] = useState({ logic: '', trainNumber: null });\n\n  const handleShowLogic = (logicText, trainNumber) => {\n    setLogicModalData({ logic: logicText, trainNumber });\n    setShowLogicModal(true);\n  };\n\n  const handleShowTrainLog = async () => {\n    if (!setModalContent || !setIsModalOpen) {\n      console.warn(\"Modal context functions not available.\");\n      return;\n    }\n\n    if (!currentPlayer?.settlementId) {\n      console.warn(\" Cannot show train log: settlementId missing.\");\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/trainlog`);\n      const trainlog = response.data.trainlog || [];\n\n      const trainLogTable = (\n        <table className=\"train-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>Train #</th>\n              <th style={{ padding: \"6px 12px\" }}>Date</th>\n              <th style={{ padding: \"6px 12px\" }}>Status</th>\n              <th style={{ padding: \"6px 12px\" }}>Offers Filled</th>\n              <th style={{ padding: \"6px 12px\" }}>Total Winners</th>\n              <th style={{ padding: \"6px 12px\" }}>Reward Summary</th>\n              <th style={{ padding: \"6px 12px\" }}>Logic</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...trainlog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>{entry.trainnumber || '-'}</td>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.status || ''}</td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Train' || entry.status === 'Current Train' ? 'n/a' : entry.alloffersfilled ? '' : ''}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Train' || entry.status === 'Current Train' ? 'n/a' : entry.totalwinners}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {(() => {\n                    // Combine rewards of the same type for display\n                    const combinedRewards = {};\n                    (entry.rewards || []).forEach((reward) => {\n                      if (combinedRewards[reward.item]) {\n                        combinedRewards[reward.item] += reward.qty;\n                      } else {\n                        combinedRewards[reward.item] = reward.qty;\n                      }\n                    });\n                    return Object.entries(combinedRewards).map(([item, totalQty]) => `${totalQty} ${item}`).join(', ');\n                  })()}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.logic ? (\n                    <button \n                      onClick={() => handleShowLogic(entry.logic, entry.trainnumber)}\n                      className=\"train-logic-button\"\n                    >\n                      Logic\n                    </button>\n                  ) : (\n                    '-'\n                  )}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: \"Train Log\",\n        size: \"large\",\n        message: trainlog.length === 0 ? \"No recent train activity.\" : undefined,\n        custom: trainLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch train log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load train log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n  const getSymbol = (type) => {\n    return masterResources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n  const handleClaim = async (offer) => {\n    if (!offer || offer.claimedBy) return;\n\n    //  Check if player already has a claimed offer\n    const alreadyClaimed = trainOffers.some(\n      (o) => o.claimedBy === currentPlayer.playerId && !o.filled\n    );\n    if (alreadyClaimed) {\n      updateStatus(2014); //  Already claimed an offer\n      return;\n    }\n\n    try {\n      // Find the exact index of the offer to ensure uniqueness\n      const offerIndex = trainOffers.findIndex(\n        (o) => o.itemBought === offer.itemBought &&\n              o.qtyBought === offer.qtyBought &&\n              !o.claimedBy &&\n              !o.filled\n      );\n      if (offerIndex === -1) {\n        console.warn(\" No matching unclaimed offer found to claim.\");\n        return;\n      }\n\n      const updatedOffer = {\n        ...trainOffers[offerIndex],\n        claimedBy: currentPlayer.playerId,\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-train-offer/${currentPlayer.settlementId}`, {\n        updateOffer: updatedOffer,\n      });\n\n      if (response.status === 200) {\n        setTrainOffers(prev => {\n          const newOffers = [...prev];\n          newOffers[offerIndex] = updatedOffer;\n          return newOffers;\n        });\n        \n        // Add current player's username to the map immediately\n        setPlayerUsernames(prev => ({\n          ...prev,\n          [currentPlayer.playerId]: currentPlayer.username\n        }));\n      }\n    } catch (err) {\n      console.error(\" Error claiming train offer:\", err);\n      \n      // Handle case where offer was already claimed\n      if (err.response?.status === 409) {\n        updateStatus(2017); // This order has already been claimed.\n        // Refresh offers to get latest state\n        fetchTrainOffers();\n      } else {\n        updateStatus(505); // Generic error\n      }\n    }\n  };\n\n  const handleFulfill = async (offer) => {\n    if (!offer || offer.claimedBy !== currentPlayer.playerId) return;\n\n    // Spend the ingredients (the item being delivered)\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: { \n        type: offer.itemBought, \n        ingredient1: offer.itemBought, \n        ingredient1qty: offer.qtyBought \n      },\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!success) return;\n\n    try {\n      // First update the train offer\n      await axios.post(`${API_BASE}/api/update-train-offer/${currentPlayer.settlementId}`, {\n        updateOffer: {\n          ...offer,\n          filled: true,\n        },\n      });\n\n    // Award Money for fulfillment\n    await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: \"Money\",\n      quantity: offer.qtyGiven,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n      // Update local state in correct order\n      setTrainOffers(prev => {\n        const index = prev.findIndex(o =>\n          o.itemBought === offer.itemBought &&\n          o.qtyBought === offer.qtyBought &&\n          o.claimedBy === currentPlayer.playerId &&\n          !o.filled\n        );\n        if (index === -1) return prev;\n        const newOffers = [...prev];\n        newOffers[index] = { ...newOffers[index], filled: true };\n        return newOffers;\n      });\n\n      updateStatus(` Delivered ${offer.qtyBought} ${offer.itemBought}.`);\n\n    } catch (error) {\n      console.error(\" Error fulfilling offer:\", error);\n      fetchTrainOffers(); // Refresh offers on error to ensure sync\n    }\n  };\n\n  const renderNextShipment = () => {\n    if (![\"loading\", \"departing\"].includes(trainPhase)) return null;\n    if (!nextOffers.length) return null;\n  \n    //  Deduplicate by itemBought\n    const seen = new Set();\n    const uniqueOffers = nextOffers.filter((offer) => {\n      if (seen.has(offer.itemBought)) return false;\n      seen.add(offer.itemBought);\n      return true;\n    });\n  \n    return (\n      <div className=\"next-shipment-preview\">\n        <h4>{strings[2003]}</h4>\n        <div className=\"next-shipment-container\">\n          {uniqueOffers.map((offer, index) => (\n            <div key={index} className=\"next-shipment-item\">\n              {getSymbol(offer.itemBought)} {offer.itemBought}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderRewardSection = () => {\n    if (!trainRewards.length || trainPhase !== \"loading\") return null;\n  \n    //  Combine rewards of the same type\n    const combinedRewards = {};\n    trainRewards.forEach((reward) => {\n      if (combinedRewards[reward.item]) {\n        combinedRewards[reward.item] += reward.qty;\n      } else {\n        combinedRewards[reward.item] = reward.qty;\n      }\n    });\n  \n    return (\n      <div className=\"reward-section\">\n        <h4>{strings[2004]}</h4>\n        <div className=\"train-rewards-container\">\n          {Object.entries(combinedRewards).map(([item, totalQty], index) => (\n            <div key={index} className=\"train-reward-item\">\n              {getSymbol(item)} {totalQty} {item}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderOfferSection = (title, offers) => {\n    if (!offers.length) return null;\n    return (\n      <div className=\"offer-section\">\n        <h4>{title}</h4>\n        {offers.map((offer, index) => {\n          const isYours = offer.claimedBy === currentPlayer.playerId;\n          const isCompleted = offer.filled;\n          const affordable = latestInventory?.some(\n            (item) => item.type === offer.itemBought && item.quantity >= offer.qtyBought\n          ) || false;\n\n          const playerQty = latestInventory?.find(inv => inv.type === offer.itemBought)?.quantity || 0;\n          const costColor = playerQty >= offer.qtyBought ? 'green' : 'red';\n          const costDisplay = `<span style=\"color: ${costColor};\">${getSymbol(offer.itemBought)} ${offer.itemBought} ${offer.qtyBought} / ${playerQty}</span>`;\n          const rewardDisplay = `+${getSymbol(offer.itemGiven)} ${offer.itemGiven} ${offer.qtyGiven.toLocaleString()}`;\n          const details = `Offer:<div>${costDisplay}</div><br>Reward:<div>${rewardDisplay}</div>`;\n\n          let buttonText = '';\n          if (isCompleted) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = username;\n          } else if (isYours && affordable) {\n            buttonText = strings[2005];\n          } else if (isYours) {\n            buttonText = strings[2006];\n          } else if (offer.claimedBy) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = `${strings[2007]} (${username})`;\n          } else {\n            buttonText = strings[2008];\n          }\n\n          return (\n            <ResourceButton\n              key={index}\n              name={isCompleted || offer.claimedBy ? (playerUsernames[offer.claimedBy] || 'Unknown') : ''}\n              className={`train-offer-card ${\n                !offer.claimedBy ? 'unclaimed' : \n                'resource-button'\n              }`}\n              onClick={() =>\n                isCompleted ? null :\n                isYours ? handleFulfill(offer) :\n                !offer.claimedBy ? handleClaim(offer) : null\n              }\n              disabled={isCompleted || (!isYours && offer.claimedBy) || (isYours && !affordable)}\n              details={details}\n            >\n              {!isCompleted && !offer.claimedBy ? buttonText : \n               !isCompleted && offer.claimedBy ? strings[2007] : ''}\n            </ResourceButton>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const claimedByYou = trainOffers.filter(o => o.claimedBy === currentPlayer.playerId && !o.filled);\n  const available = trainOffers.filter(o => !o.claimedBy);\n  const claimedByOthers = trainOffers.filter(o => o.claimedBy && o.claimedBy !== currentPlayer.playerId && !o.filled);\n  const completed = trainOffers.filter(o => o.filled);\n\n  const allOrdersFilled = trainPhase === 'departing' || trainPhase === 'arriving'\n  ? trainOffers.length > 0 && trainOffers.every(o => o.filled)\n  : false;\n\n\n  return (\n    <>\n    <Panel onClose={onClose} descriptionKey=\"1022\" titleKey=\"1122\" panelName=\"TrainPanel\">\n      {/* Check if player is in their home settlement */}\n      {(() => {\n        const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n        console.log(' Train access check:', {\n          currentSettlement: currentPlayer.location.s,\n          homeSettlement: currentPlayer.settlementId,\n          isInHomeSettlement\n        });\n        return !isInHomeSettlement;\n      })() ? (\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n          <h2>{strings[2050] || \"This is not your home settlement.\"}</h2>\n        </div>\n      ) : isContentLoading ? (\n        <p>{strings[98]}</p>\n      ) : (\n        <>\n          <h3>{strings[2020]} {trainPhase} {currentTrainNumber ? `(Train #${currentTrainNumber})` : ''}</h3>\n          <h2> {trainTimer}</h2>\n\n          {trainPhase === \"loading\" && (\n            <>\n              {renderRewardSection()}\n              {renderOfferSection(strings[2009], claimedByYou)}\n              {renderOfferSection(strings[2010], available)}\n              {renderOfferSection(strings[2011], claimedByOthers)}\n              {renderOfferSection(strings[2012], completed)}\n            </>\n          )}\n\n          {allOrdersFilled && (\n            <div className=\"train-rewards-banner\">\n              {strings[2016]}\n            </div>\n          )}\n\n          {(trainPhase === \"loading\" || trainPhase === \"departing\") && renderNextShipment()}\n\n\n        <div className=\"shared-buttons\" style={{ margin: '2px 0' }}>\n          <button className=\"btn-basic btn-neutral\" onClick={() => handleShowTrainLog()}>\n            {strings[2015]}\n          </button>\n        </div>\n\n\n        </>\n      )}\n    </Panel>\n    \n    {showLogicModal && (\n      <div className=\"train-logic-modal-overlay\">\n        <div className=\"train-logic-modal\">\n          <button \n            onClick={() => setShowLogicModal(false)}\n            className=\"train-logic-modal-close\"\n          >\n            \n          </button>\n          <h3>\n            Train #{logicModalData.trainNumber || '?'} Logic\n          </h3>\n          <pre>\n            {logicModalData.logic || 'No logic information available'}\n          </pre>\n        </div>\n      </div>\n    )}\n    </>\n  );\n}\n\nexport default TrainPanel;","import { isACrop } from '../../Utils/ResourceHelpers';\n\n/**\n * Generates new Train offers based on player skills and available resources\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @returns {Array} Array of new Train offers\n */\nexport function generateNewTrainOffers(currentPlayer, masterResources, globalTuning, currentSeason) {\n    const playerSkills = currentPlayer?.skills || [];\n    const playerSkillTypes = playerSkills.map(skill => skill.type);\n    \n    console.log(' Train offer generation:', {\n        isFirstTimeUser: currentPlayer?.firsttimeuser,\n        playerSkills: playerSkillTypes\n    });\n    \n    // Filter eligible resources for Train offers\n    const eligibleResources = masterResources.filter(resource => {\n        // Must be a doober\n        if (resource.category !== 'doober') return false;\n        \n        // Exclude resources with noBank output\n        if (resource.output === 'noBank') return false;\n        \n        // Exclude resources that don't have a source defined (player cannot create them)\n        if (!resource.source) return false;\n        \n        // Check if player has required skills\n        if (resource.requires && !playerSkillTypes.includes(resource.requires)) {\n            return false;\n        }\n        \n        // Check if resource is seasonal and matches current season\n        if (resource.season && resource.season !== currentSeason) {\n            return false;\n        }\n        \n        // Check if any ingredients are out of season\n        const ingredients = [\n            resource.ingredient1,\n            resource.ingredient2, \n            resource.ingredient3,\n            resource.ingredient4\n        ].filter(Boolean);\n        \n        for (const ingredient of ingredients) {\n            const ingredientResource = masterResources.find(r => r.type === ingredient);\n            if (ingredientResource && ingredientResource.season && ingredientResource.season !== currentSeason) {\n                return false;\n            }\n        }\n        \n        // === FIRST-TIME USER ONLY FILTERS ===\n        // If player is first time user, only show crops\n        if (currentPlayer?.firsttimeuser === true) {\n            if (!isACrop(resource.type, masterResources)) {\n                return false;\n            }\n        }\n        \n        // === FILTERS FOR ALL USERS (including first-time users) ===\n        // Filter out epic and legendary scroll chance items\n        if (resource.scrollchance === 'epic' || resource.scrollchance === 'legendary') {\n            return false;\n        }\n        \n        // Filter out valley source items\n        if (resource.source === 'valley') {\n            return false;\n        }\n        \n        // Filter out resources where the source requires skills the player doesn't have\n        const sourceResource = masterResources.find(r => r.type === resource.source);\n        \n        // If source resource exists and requires a skill the player doesn't have, exclude\n        if (sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)) {\n            return false;\n        }\n        \n        // Filter out resources that are outputs of attack resources if player doesn't have \"Explore the Valley\" trophy\n        const hasExploreValleyTrophy = currentPlayer?.trophies?.some(trophy => trophy.title === \"Explore the Valley\");\n        if (!hasExploreValleyTrophy) {\n            const attackResource = masterResources.find(r => \n                r.action === 'attack' && r.output === resource.type\n            );\n            \n            if (attackResource) {\n                return false;\n            }\n        }\n        \n        return true;\n    });\n    \n    if (eligibleResources.length === 0) {\n        console.warn('No eligible resources found for Train offers');\n        return [];\n    }\n    \n    const newOffers = [];\n    const maxOffers = globalTuning?.maxTrainOffers || 8; // Trains typically have more offers than Kent\n    \n    // Generate offers (typically 6-8 for trains)\n    const offersToGenerate = Math.min(maxOffers, eligibleResources.length);\n    \n    for (let i = 0; i < offersToGenerate; i++) {\n        // Avoid duplicates by tracking used resources\n        const usedResources = newOffers.map(offer => offer.item);\n        const availableResources = eligibleResources.filter(resource => \n            !usedResources.includes(resource.type)\n        );\n        \n        if (availableResources.length === 0) {\n            console.log(' No more unique resources available for train offers');\n            break;\n        }\n        \n        const randomResource = availableResources[Math.floor(Math.random() * availableResources.length)];\n        \n        // Determine quantity - trains typically want larger quantities than Kent\n        let quantity;\n        if (isACrop(randomResource.type, masterResources)) {\n            if (currentPlayer?.firsttimeuser === true) {\n                quantity = Math.floor(Math.random() * 16) + 5; // Random from 5 to 20 for first-time users\n            } else {\n                quantity = Math.floor(Math.random() * 46) + 5; // Random from 5 to 50 for regular users\n            }\n        } else {\n            quantity = Math.floor(Math.random() * 15) + 2; // Random from 2 to 16\n        }\n        \n        const newOffer = {\n            item: randomResource.type,\n            quantity: quantity\n        };\n        \n        newOffers.push(newOffer);\n    }\n    \n    console.log(`Generated ${newOffers.length} new Train offers:`, newOffers);\n    return newOffers;\n}\n\n/**\n * Generates new Train rewards based on train offers and current season\n * @param {Array} trainOffers - Array of train offers\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @returns {Array} Array of train rewards\n */\nexport function generateTrainRewards(trainOffers, currentPlayer, masterResources, globalTuning, currentSeason) {\n    const rewards = [];\n    \n    console.log(' Train reward generation for season:', currentSeason);\n    \n    // Convert season to lowercase to match globalTuning format\n    const seasonKey = currentSeason ? currentSeason.toLowerCase() : 'spring';\n    console.log(' Looking for season key:', seasonKey);\n    \n    // Get train rewards from globalTuning based on current season\n    const seasonalRewards = globalTuning?.trainRewards?.[seasonKey];\n    console.log(' Seasonal rewards found:', seasonalRewards);\n    \n    if (!seasonalRewards || !Array.isArray(seasonalRewards)) {\n        console.warn(' No train rewards found for season:', seasonKey, 'in globalTuning');\n        console.warn(' Available keys:', Object.keys(globalTuning?.trainRewards || {}));\n        return rewards;\n    }\n    \n    console.log(' Available seasonal rewards:', seasonalRewards);\n    \n    // Generate seasonal resource rewards (1-3 different rewards from the season's trainRewards)\n    const numSeasonalRewards = Math.floor(Math.random() * Math.min(3, seasonalRewards.length)) + 1; // 1 to 3 or max available\n    const usedRewards = new Set();\n    \n    for (let i = 0; i < numSeasonalRewards; i++) {\n        // Filter out already used rewards\n        const availableRewards = seasonalRewards.filter(reward => !usedRewards.has(reward));\n        \n        if (availableRewards.length === 0) break;\n        \n        const randomReward = availableRewards[Math.floor(Math.random() * availableRewards.length)];\n        usedRewards.add(randomReward);\n        \n        // Determine reward quantity (typically smaller quantities for special items)\n        let quantity;\n        if (isACrop(randomReward, masterResources)) {\n            quantity = Math.floor(Math.random() * 10) + 1; // 1 to 10 for crops\n        } else {\n            quantity = Math.floor(Math.random() * 3) + 1; // 1 to 3 for special items like hearts\n        }\n        \n        rewards.push({\n            item: randomReward,\n            quantity: quantity\n        });\n    }\n    \n    console.log(`Generated ${rewards.length} train rewards:`, rewards);\n    return rewards;\n}\n\n/**\n * Generates complete train data for a player (both offers and rewards)\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season\n * @param {number} trainNumber - The train number to generate for\n * @returns {Object} { offers: [], rewards: [] }\n */\nexport function generateCompleteTrainData(currentPlayer, masterResources, globalTuning, currentSeason, trainNumber) {\n    console.log(` Generating complete train data for train #${trainNumber} in ${currentSeason}`);\n    \n    const offers = generateNewTrainOffers(currentPlayer, masterResources, globalTuning, currentSeason);\n    const rewards = generateTrainRewards(offers, currentPlayer, masterResources, globalTuning, currentSeason);\n    \n    return {\n        offers,\n        rewards\n    };\n}","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { generateCompleteTrainData } from './TrainOfferLogic';\nimport './Train.css';\nimport { formatCountdown } from '../../UI/Timers';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction NewTrainPanel({ \n  onClose, \n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer, \n  setCurrentPlayer, \n  updateStatus,\n  masterResources,\n  setModalContent,\n  setIsModalOpen,\n  globalTuning,\n  currentSeason\n  }) \n{\n  const strings = useStrings();\n  const [trainPhase, setTrainPhase] = useState(\"loading\");\n  const [trainTimer, setTrainTimer] = useState(\"\");\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [playerTrainNumber, setPlayerTrainNumber] = useState(0);\n  const [settlementTrainNumber, setSettlementTrainNumber] = useState(0);\n  const [settlementTrainPhase, setSettlementTrainPhase] = useState(\"\");\n  const [currentTrainOffers, setCurrentTrainOffers] = useState([]);\n  const [currentTrainRewards, setCurrentTrainRewards] = useState([]);\n  const [nextTrainOffers, setNextTrainOffers] = useState([]);\n  const [nextTrainRewards, setNextTrainRewards] = useState([]);\n  const [isTrading, setIsTrading] = useState(false);\n  const [rewardsDeliveredMessage, setRewardsDeliveredMessage] = useState(\"\");\n\n  // Initialize train data on component load\n  useEffect(() => {\n    if (currentPlayer?.playerId && currentPlayer?.settlementId) {\n      initializeTrainData();\n    }\n  }, [currentPlayer?.playerId, currentPlayer?.settlementId]);\n\n  // Update timer from localStorage\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = Date.now();\n      const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n      const trainTimerData = storedTimers.train || {};\n\n      const phase = trainTimerData.phase;\n      setTrainPhase(phase || \"unknown\");\n      setSettlementTrainPhase(phase || \"unknown\");\n\n      const endTime = trainTimerData.endTime;\n      if (!endTime || isNaN(endTime)) {\n        setTrainTimer(\"N/A\");\n        return;\n      } else {\n        setTrainTimer(formatCountdown(endTime, now));\n      }\n    };\n\n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Watch for train phase changes and trigger reward delivery\n  useEffect(() => {\n    if (!currentPlayer?.playerId || !settlementTrainPhase) return;\n    \n    const checkForRewardDelivery = async () => {\n      const playerTrainNum = currentPlayer?.train?.currentTrainNumber || 0;\n      const lastRewardDelivery = currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0;\n      \n      // Check if we should deliver rewards for current train when it starts departing/arriving\n      const shouldDeliverRewards = (\n        playerTrainNum === settlementTrainNumber && \n        (settlementTrainPhase === 'departing' || settlementTrainPhase === 'arriving') &&\n        playerTrainNum > lastRewardDelivery\n      );\n      \n      if (shouldDeliverRewards) {\n        console.log(' [Reactive] Train phase changed to departing/arriving - checking for reward delivery');\n        await checkAndDeliverCurrentTrainRewards(playerTrainNum);\n      }\n    };\n    \n    checkForRewardDelivery();\n  }, [settlementTrainPhase, currentPlayer?.train?.currentTrainNumber, settlementTrainNumber]);\n\n  // Clear rewards message when entering loading phase (new train cycle)\n  useEffect(() => {\n    if (trainPhase === \"loading\" && rewardsDeliveredMessage) {\n      setRewardsDeliveredMessage(\"\");\n    }\n  }, [trainPhase, rewardsDeliveredMessage]);\n\n\n  const initializeTrainData = async () => {\n    setIsContentLoading(true);\n    try {\n      console.log(' Initializing personalized train data...');\n      \n      // Step 1: Get settlement train number\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n      const trainlog = settlementResponse.data?.trainlog || [];\n      const currentTrainLog = trainlog.find(log => log.status === \"Current Train\");\n      const currentSettlementTrainNumber = currentTrainLog?.trainnumber || 1;\n      \n      setSettlementTrainNumber(currentSettlementTrainNumber);\n      console.log(' Settlement train number:', currentSettlementTrainNumber);\n\n      // Step 2: Get player's current train number\n      const currentPlayerTrainNumber = currentPlayer?.train?.currentTrainNumber || 0;\n      setPlayerTrainNumber(currentPlayerTrainNumber);\n      console.log(' Player train number:', currentPlayerTrainNumber);\n\n      // Step 3: Determine which train data to show based on comparison\n      await determineTrainDataToShow(currentPlayerTrainNumber, currentSettlementTrainNumber, settlementTrainPhase);\n\n    } catch (error) {\n      console.error(\" Error initializing train data:\", error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  const determineTrainDataToShow = async (playerTrainNum, settlementTrainNum, settlementPhase) => {\n    console.log(' Determining train data to show:', { \n      playerTrainNum, \n      settlementTrainNum, \n      settlementPhase,\n      lastRewardDelivery: currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0 \n    });\n    \n    // Check if we should deliver rewards for current train when it starts departing\n    const shouldDeliverRewards = (\n      playerTrainNum === settlementTrainNum && \n      (settlementPhase === 'departing' || settlementPhase === 'arriving') &&\n      playerTrainNum > (currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0)\n    );\n    \n    // Check if player is behind on train numbers\n    const isPlayerBehind = playerTrainNum < settlementTrainNum;\n    \n    if (shouldDeliverRewards) {\n      // Player is on current train and it's departing/arriving - deliver rewards then show current data\n      console.log(' Train is departing/arriving - checking for reward delivery');\n      await checkAndDeliverCurrentTrainRewards(playerTrainNum);\n      await showCurrentTrainData();\n    } else if (isPlayerBehind) {\n      // Player is behind - advance them to current train\n      console.log(' Player is behind, advancing to current train');\n      await advancePlayerToCurrentTrain(settlementTrainNum);\n    } else if (playerTrainNum === settlementTrainNum) {\n      // Player is on current train - show existing data or generate if missing\n      console.log(' Player is on current train');\n      await showCurrentTrainData();\n    } else {\n      // Player is ahead (shouldn't happen, but handle gracefully)\n      console.log(' Player is ahead of settlement train - this should not happen');\n      await showCurrentTrainData();\n    }\n  };\n\n  const showCurrentTrainData = async () => {\n    // Use existing player train data if available\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    const existingNextOffers = currentPlayer?.train?.nextTrainOffers || [];\n    const existingNextRewards = currentPlayer?.train?.nextTrainRewards || [];\n\n    if (existingCurrentOffers.length === 0) {\n      // Generate new train data for current train\n      console.log(' Generating new current train data');\n      await generateAndSaveTrainData(settlementTrainNumber);\n    } else {\n      // Use existing data\n      console.log(' Using existing current train data');\n      setCurrentTrainOffers(existingCurrentOffers);\n      setCurrentTrainRewards(existingCurrentRewards);\n      setNextTrainOffers(existingNextOffers);\n      setNextTrainRewards(existingNextRewards);\n    }\n  };\n\n  const checkAndDeliverCurrentTrainRewards = async (trainNumber) => {\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    \n    // Check if all current offers were completed\n    if (existingCurrentOffers.length > 0) {\n      const allOffersCompleted = existingCurrentOffers.every(offer => offer.completed === true);\n      \n      if (allOffersCompleted && existingCurrentRewards.length > 0) {\n        console.log(' All current train offers completed! Delivering rewards to mailbox:', existingCurrentRewards);\n        \n        // Generate a unique message ID based on timestamp\n        const messageId = Date.now();\n        \n        // Create the message for the mailbox\n        const newMessage = {\n          messageId: 101,\n          timestamp: new Date(),\n          rewards: existingCurrentRewards.map(reward => ({\n            item: reward.item,\n            qty: reward.quantity\n          })),\n          read: false,\n          collected: false,\n          neverPurge: false\n        };\n        \n        try {\n          // Add the message to player's messages array AND update lastRewardDeliveryTrainNumber\n          const currentMessages = currentPlayer?.messages || [];\n          const updatedMessages = [...currentMessages, newMessage];\n          \n          const updatedTrainData = {\n            ...currentPlayer.train,\n            lastRewardDeliveryTrainNumber: trainNumber\n          };\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { \n              messages: updatedMessages,\n              train: updatedTrainData\n            }\n          });\n          \n          if (response.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n              ...prev,\n              messages: updatedMessages,\n              train: updatedTrainData\n            }));\n            \n            // Create reward summary for status message\n            const rewardSummary = existingCurrentRewards.map(reward => \n              `${getSymbol(reward.item)} ${reward.quantity} ${reward.item}`\n            ).join(', ');\n            \n            updateStatus(` Train rewards delivered to your mailbox: ${rewardSummary}`);\n            setRewardsDeliveredMessage(strings[2016] || \"Train rewards have been delivered to your mailbox!\");\n            console.log(' Current train rewards successfully delivered to mailbox');\n          }\n        } catch (error) {\n          console.error(' Error delivering current train rewards to mailbox:', error);\n        }\n      } else {\n        // Some offers were not completed\n        const completedCount = existingCurrentOffers.filter(offer => offer.completed === true).length;\n        console.log(` Train departing with ${completedCount}/${existingCurrentOffers.length} offers completed`);\n        \n        // Still update lastRewardDeliveryTrainNumber to prevent future attempts\n        try {\n          const updatedTrainData = {\n            ...currentPlayer.train,\n            lastRewardDeliveryTrainNumber: trainNumber\n          };\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { train: updatedTrainData }\n          });\n          \n          if (response.data.success) {\n            setCurrentPlayer(prev => ({\n              ...prev,\n              train: updatedTrainData\n            }));\n          }\n        } catch (error) {\n          console.error(' Error updating lastRewardDeliveryTrainNumber:', error);\n        }\n      }\n    }\n  };\n\n  const checkAndDeliverPreviousTrainRewards = async () => {\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    \n    // Check if all current offers were completed\n    if (existingCurrentOffers.length > 0) {\n      const allOffersCompleted = existingCurrentOffers.every(offer => offer.completed === true);\n      \n      if (allOffersCompleted && existingCurrentRewards.length > 0) {\n        console.log(' All train offers completed! Delivering rewards to mailbox:', existingCurrentRewards);\n        \n        // Generate a unique message ID based on timestamp\n        const messageId = Date.now();\n        \n        // Create the message for the mailbox\n        const newMessage = {\n          messageId: 101,\n          timestamp: new Date(),\n          rewards: existingCurrentRewards.map(reward => ({\n            item: reward.item,\n            qty: reward.quantity\n          })),\n          read: false,\n          collected: false,\n          neverPurge: false\n        };\n        \n        try {\n          // Add the message to player's messages array\n          const currentMessages = currentPlayer?.messages || [];\n          const updatedMessages = [...currentMessages, newMessage];\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { messages: updatedMessages }\n          });\n          \n          if (response.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n              ...prev,\n              messages: updatedMessages\n            }));\n            \n            // Create reward summary for status message\n            const rewardSummary = existingCurrentRewards.map(reward => \n              `${getSymbol(reward.item)} ${reward.quantity} ${reward.item}`\n            ).join(', ');\n            \n            updateStatus(` Train rewards delivered to your mailbox: ${rewardSummary}`);\n            setRewardsDeliveredMessage(strings[2016] || \"Train rewards have been delivered to your mailbox!\");\n            console.log(' Train rewards successfully delivered to mailbox');\n          }\n        } catch (error) {\n          console.error(' Error delivering train rewards to mailbox:', error);\n        }\n      } else if (existingCurrentOffers.length > 0) {\n        // Some offers were not completed\n        const completedCount = existingCurrentOffers.filter(offer => offer.completed === true).length;\n        console.log(` Train expired with ${completedCount}/${existingCurrentOffers.length} offers completed`);\n        updateStatus(` Previous train left with ${completedCount}/${existingCurrentOffers.length} orders completed`);\n      }\n    }\n  };\n\n  const advancePlayerToCurrentTrain = async (newTrainNumber) => {\n    console.log(' Advancing player to train', newTrainNumber);\n    \n    // Check if player completed all previous train offers and deliver rewards\n    await checkAndDeliverPreviousTrainRewards();\n    \n    // Move next train data to current (if exists)\n    const existingNextOffers = currentPlayer?.train?.nextTrainOffers || [];\n    const existingNextRewards = currentPlayer?.train?.nextTrainRewards || [];\n    \n    let newCurrentOffers = [];\n    let newCurrentRewards = [];\n    \n    if (existingNextOffers.length > 0) {\n      // Use existing next train data as current\n      newCurrentOffers = existingNextOffers;\n      newCurrentRewards = existingNextRewards;\n      console.log(' Using existing next train data as current');\n    } else {\n      // Generate new current train data\n      console.log(' Generating new current train data');\n      const trainData = generateCompleteTrainData(\n        currentPlayer, \n        masterResources, \n        globalTuning, \n        currentSeason, \n        newTrainNumber\n      );\n      newCurrentOffers = trainData.offers;\n      newCurrentRewards = trainData.rewards;\n    }\n\n    // Generate new next train data\n    const nextTrainData = generateCompleteTrainData(\n      currentPlayer, \n      masterResources, \n      globalTuning, \n      currentSeason, \n      newTrainNumber + 1\n    );\n\n    // Update player in database\n    const updatedTrainData = {\n      currentTrainNumber: newTrainNumber,\n      currentTrainOffers: newCurrentOffers,\n      currentTrainRewards: newCurrentRewards,\n      nextTrainOffers: nextTrainData.offers,\n      nextTrainRewards: nextTrainData.rewards\n    };\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setPlayerTrainNumber(newTrainNumber);\n        setCurrentTrainOffers(newCurrentOffers);\n        setCurrentTrainRewards(newCurrentRewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        console.log(' Player advanced to train', newTrainNumber);\n      }\n    } catch (error) {\n      console.error(' Error advancing player train:', error);\n    }\n  };\n\n  const generateAndSaveTrainData = async (trainNumber) => {\n    // Generate current and next train data\n    const currentTrainData = generateCompleteTrainData(\n      currentPlayer, \n      masterResources, \n      globalTuning, \n      currentSeason, \n      trainNumber\n    );\n    \n    const nextTrainData = generateCompleteTrainData(\n      currentPlayer, \n      masterResources, \n      globalTuning, \n      currentSeason, \n      trainNumber + 1\n    );\n\n    const updatedTrainData = {\n      currentTrainNumber: trainNumber,\n      currentTrainOffers: currentTrainData.offers,\n      currentTrainRewards: currentTrainData.rewards,\n      nextTrainOffers: nextTrainData.offers,\n      nextTrainRewards: nextTrainData.rewards\n    };\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(currentTrainData.offers);\n        setCurrentTrainRewards(currentTrainData.rewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        console.log(' Generated and saved new train data');\n      }\n    } catch (error) {\n      console.error(' Error saving train data:', error);\n    }\n  };\n\n  const getSymbol = (type) => {\n    return masterResources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n  // Check if loading phase has expired based on client timer\n  const isLoadingPhaseExpired = () => {\n    const now = Date.now();\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n    const trainTimerData = storedTimers.train || {};\n    const endTime = trainTimerData.endTime;\n    const phase = trainTimerData.phase;\n    \n    // If we're in loading phase and the timer has expired, consider it expired\n    if (phase === \"loading\" && endTime && now >= endTime) {\n      return true;\n    }\n    \n    // If we're already in departing or arriving phase, definitely expired\n    if (phase === \"departing\" || phase === \"arriving\") {\n      return true;\n    }\n    \n    return false;\n  };\n\n  const handleFulfillOffer = async (offer) => {\n    if (!offer || !currentPlayer || isTrading) return;\n    \n    // Check if loading phase has expired (client-side authority)\n    if (isLoadingPhaseExpired()) {\n      updateStatus(' Train has already departed! Cannot fulfill orders.');\n      return;\n    }\n    \n    // Set trading flag to prevent spam clicks\n    setIsTrading(true);\n    \n    try {\n      // Spend the ingredients (the item being delivered)\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          type: offer.item, \n          ingredient1: offer.item, \n          ingredient1qty: offer.quantity \n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) return;\n      // Calculate money reward\n      const resource = masterResources.find(r => r.type === offer.item);\n      const moneyReward = (resource?.maxprice || 100) * offer.quantity;\n\n      // Award money for fulfillment\n      await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: \"Money\",\n        quantity: moneyReward,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Mark the fulfilled offer as completed instead of removing it\n      const updatedCurrentOffers = currentTrainOffers.map(o => {\n        if (o.item === offer.item && o.quantity === offer.quantity && !o.completed) {\n          return { ...o, completed: true };\n        }\n        return o;\n      });\n\n      // Update player train data in database\n      const updatedTrainData = {\n        ...currentPlayer.train,\n        currentTrainOffers: updatedCurrentOffers\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(updatedCurrentOffers);\n        updateStatus(` Delivered ${offer.quantity} ${offer.item} for ${getSymbol('Money')} ${moneyReward.toLocaleString()}.`);\n      }\n    } catch (error) {\n      console.error(\" Error fulfilling train offer:\", error);\n      updateStatus(' Trade failed. Please try again.');\n    } finally {\n      // Always clear the trading flag\n      setIsTrading(false);\n    }\n  };\n\n  const handleGenerateOffers = async () => {\n    if (isTrading) return;\n    \n    // Set trading flag to prevent spam clicks\n    setIsTrading(true);\n    \n    console.log(' [DEBUG] Regenerating train offers...');\n    \n    try {\n      // Generate new current train data\n      const currentTrainData = generateCompleteTrainData(\n        currentPlayer, \n        masterResources, \n        globalTuning, \n        currentSeason, \n        playerTrainNumber\n      );\n      \n      // Generate new next train data\n      const nextTrainData = generateCompleteTrainData(\n        currentPlayer, \n        masterResources, \n        globalTuning, \n        currentSeason, \n        playerTrainNumber + 1\n      );\n\n      const updatedTrainData = {\n        ...currentPlayer.train,\n        currentTrainOffers: currentTrainData.offers,\n        currentTrainRewards: currentTrainData.rewards,\n        nextTrainOffers: nextTrainData.offers,\n        nextTrainRewards: nextTrainData.rewards\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(currentTrainData.offers);\n        setCurrentTrainRewards(currentTrainData.rewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        updateStatus(' [DEBUG] Generated new train offers and rewards!');\n        console.log(' [DEBUG] Train offers regenerated successfully');\n      }\n    } catch (error) {\n      console.error(\" [DEBUG] Error regenerating train offers:\", error);\n      updateStatus(' Failed to generate new offers');\n    } finally {\n      // Always clear the trading flag\n      setIsTrading(false);\n    }\n  };\n\n  const renderCurrentOffers = () => {\n    if (currentTrainOffers.length === 0) return null;\n\n    return (\n      <div className=\"offer-section\">\n        <h4>Your Train Orders</h4>\n        {currentTrainOffers.map((offer, index) => {\n          const isCompleted = offer.completed || false;\n          const playerQty = inventory?.find(item => item.type === offer.item)?.quantity || 0;\n          const backpackQty = backpack?.find(item => item.type === offer.item)?.quantity || 0;\n          const totalQty = playerQty + backpackQty;\n          const loadingExpired = isLoadingPhaseExpired();\n          const affordable = totalQty >= offer.quantity && !isCompleted && !loadingExpired;\n\n          // Calculate money reward\n          const resource = masterResources.find(r => r.type === offer.item);\n          const moneyReward = (resource?.maxprice || 100) * offer.quantity;\n\n          let costDisplay, details, buttonText;\n          \n          if (isCompleted) {\n            costDisplay = `<span style=\"color: green;\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity}</span>`;\n            details = `<div>${costDisplay}</div>Completed`;\n            buttonText = '';\n          } else if (loadingExpired) {\n            costDisplay = `<span style=\"color: gray;\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity} / ${totalQty}</span>`;\n            details = `<div>${costDisplay}</div>Train Departed`;\n            buttonText = '';\n          } else {\n            const costColor = affordable ? 'green' : 'red';\n            costDisplay = `<span style=\"color: ${costColor};\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity} / ${totalQty}</span>`;\n            const rewardDisplay = `${getSymbol('Money')} ${moneyReward.toLocaleString()}`;\n            details = `<div>${costDisplay}</div>${strings[42]} ${rewardDisplay}`;\n            buttonText = '';\n          }\n\n          return (\n            <div key={index} style={{ position: 'relative' }}>\n              <ResourceButton\n                className={`train-offer-card ${isCompleted ? 'completed' : ''}`}\n                onClick={() => !isTrading && affordable && !isCompleted ? handleFulfillOffer(offer) : null}\n                disabled={isCompleted || !affordable || isTrading}\n                details={details}\n              >\n                {buttonText}\n              </ResourceButton>\n              {isCompleted && (\n                <div style={{\n                  position: 'absolute',\n                  top: '50%',\n                  right: '10px',\n                  transform: 'translateY(-50%)',\n                  fontSize: '2em',\n                  color: 'green',\n                  pointerEvents: 'none',\n                  zIndex: 10\n                }}>\n                  \n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const renderCurrentRewards = () => {\n    return (\n      <div className=\"reward-section\">\n        <h4>{strings[2019]}</h4>\n        {currentTrainRewards.length > 0 ? (\n          <div className=\"train-rewards-container\">\n            {currentTrainRewards.map((reward, index) => (\n              <div key={index} className=\"train-reward-item\">\n                {getSymbol(reward.item)} {reward.quantity} {reward.item}\n              </div>\n            ))}\n          </div>\n        ) : (\n          <p>No rewards available</p>\n        )}\n      </div>\n    );\n  };\n\n  const renderNextTrain = () => {\n    if (nextTrainOffers.length === 0) return null;\n\n    return (\n      <div className=\"next-shipment-preview\">\n        <h4>{strings[2003]}</h4>\n        <div className=\"next-shipment-container\">\n          <div style={{ marginBottom: '10px' }}>\n            <strong>Orders:</strong>\n          </div>\n          {nextTrainOffers.map((offer, index) => (\n            <div key={index} className=\"next-shipment-item\">\n              {getSymbol(offer.item)} {offer.item}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1022\" titleKey=\"1122\" panelName=\"NewTrainPanel\">\n      {(() => {\n        const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n        return !isInHomeSettlement;\n      })() ? (\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n          <h2>{strings[2050] || \"This is not your home settlement.\"}</h2>\n        </div>\n      ) : isContentLoading ? (\n        <p>{strings[98]}</p>\n      ) : (\n        <>\n          <h3>(New) Train is {trainPhase} (#{playerTrainNumber})</h3>\n          <h2> {trainTimer}</h2>\n\n          {rewardsDeliveredMessage && (trainPhase === \"departing\" || trainPhase === \"arriving\") && (\n            <div style={{ \n              backgroundColor: '#4CAF50', \n              color: 'white', \n              padding: '10px', \n              margin: '10px 0', \n              borderRadius: '5px',\n              textAlign: 'center',\n              fontWeight: 'bold'\n            }}>\n               {rewardsDeliveredMessage}\n            </div>\n          )}\n\n          {trainPhase === \"loading\" && (\n            <>\n              {renderCurrentRewards()}\n              {renderCurrentOffers()}\n            </>\n          )}\n\n          {(trainPhase === \"loading\" || trainPhase === \"departing\") && renderNextTrain()}\n        </>\n      )}\n\n    </Panel>\n  );\n}\n\nexport default NewTrainPanel;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport './Carnival.css';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { formatCountdown } from '../../UI/Timers';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction CarnivalPanel({ \n  onClose, \n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer, \n  setCurrentPlayer, \n  updateStatus,\n  masterResources,\n  setModalContent,\n  setIsModalOpen,\n  globalTuning\n  }) \n{\n  const strings = useStrings();\n  const [carnivalOffers, setCarnivalOffers] = useState([]);\n  const [carnivalPhase, setCarnivalPhase] = useState(\"here\");\n  const [carnivalTimer, setCarnivalTimer] = useState(\"\");\n  const [nextOffers, setNextOffers] = useState([]);\n  const [carnivalRewards, setCarnivalRewards] = useState([]);\n  const [latestInventory, setLatestInventory] = useState([]);\n  const [playerUsernames, setPlayerUsernames] = useState({}); // Map of playerId -> username\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [currentCarnivalNumber, setCurrentCarnivalNumber] = useState(null);\n\n  // 1. Initial load for the player\n  useEffect(() => {\n    const fetchInventory = async () => {\n      if (!currentPlayer?.playerId) return;\n      setIsContentLoading(true);\n      try {\n        const response = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setLatestInventory(response.data.inventory || []);\n      } catch (error) {\n        console.error(\" Error fetching latest inventory:\", error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n    fetchInventory();\n\n    if (currentPlayer?.settlementId) {\n      fetchCarnivalOffers();\n    }\n  }, [currentPlayer?.playerId, currentPlayer?.settlementId]);\n\n\n  // 2. Fetch fresh carnival offers on *every* phase change\n  useEffect(() => {\n    if (currentPlayer?.settlementId) {\n      fetchCarnivalOffers(); //  fixes stale data after phase transitions\n    }\n  }, [carnivalPhase]);\n\n\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = Date.now();\n\n      const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n      const carnivalTimerData = storedTimers.carnival || {};\n\n      const phase = carnivalTimerData.phase;\n      setCarnivalPhase(phase || \"unknown\");\n\n      const endTime = carnivalTimerData.endTime;\n      if (!endTime || isNaN(endTime)) {\n        setCarnivalTimer(\"N/A\");\n        return;\n      } else {\n        setCarnivalTimer(formatCountdown(endTime, now));\n      }\n    };\n\n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetchCarnivalOffers = async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n      const offers = response.data?.carnival?.currentoffers || [];\n      setCarnivalOffers(offers);\n      setNextOffers(response.data?.carnival?.nextoffers || []);\n      // Get current carnival info from carnivallog\n      const carnivallog = response.data?.carnival?.carnivallog || [];\n      const currentCarnival = carnivallog.find(log => log.status === \"Current Carnival\");\n      if (currentCarnival) {\n        // Use rewards from the current carnival log entry\n        setCarnivalRewards(currentCarnival.rewards || []);\n        if (currentCarnival.carnivalnumber) {\n          setCurrentCarnivalNumber(currentCarnival.carnivalnumber);\n        }\n      } else {\n        // No current carnival, clear rewards\n        setCarnivalRewards([]);\n      }\n      \n      // Fetch usernames for claimed/completed offers\n      await fetchUsernames(offers);\n    } catch (error) {\n      console.error(\" Error fetching carnival offers:\", error);\n    }\n  };\n\n  const fetchUsernames = async (offers) => {\n    try {\n      // Find all unique player IDs that have claimed or completed offers\n      const playerIds = [...new Set(\n        offers\n          .filter(offer => offer.claimedBy)\n          .map(offer => offer.claimedBy)\n      )];\n\n      if (playerIds.length === 0) return;\n\n      // Fetch usernames for these player IDs\n      const usernamePromises = playerIds.map(async (playerId) => {\n        try {\n          const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n          return { playerId, username: response.data.username };\n        } catch (error) {\n          console.error(` Error fetching username for player ${playerId}:`, error);\n          return { playerId, username: 'Unknown' };\n        }\n      });\n\n      const usernameResults = await Promise.all(usernamePromises);\n      \n      // Convert to map and update state\n      const usernameMap = usernameResults.reduce((acc, { playerId, username }) => {\n        acc[playerId] = username;\n        return acc;\n      }, {});\n\n      setPlayerUsernames(prev => ({ ...prev, ...usernameMap }));\n    } catch (error) {\n      console.error(\" Error fetching usernames:\", error);\n    }\n  };\n\n  const [showLogicModal, setShowLogicModal] = useState(false);\n  const [logicModalData, setLogicModalData] = useState({ logic: '', carnivalNumber: null });\n\n  const handleShowLogic = (logicText, carnivalNumber) => {\n    setLogicModalData({ logic: logicText, carnivalNumber });\n    setShowLogicModal(true);\n  };\n\n  const handleShowCarnivalLog = async () => {\n    if (!setModalContent || !setIsModalOpen) {\n      console.warn(\"Modal context functions not available.\");\n      return;\n    }\n\n    if (!currentPlayer?.settlementId) {\n      console.warn(\" Cannot show carnival log: settlementId missing.\");\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/carnivallog`);\n      const carnivallog = response.data.carnivallog || [];\n\n      const carnivalLogTable = (\n        <table className=\"carnival-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>Carnival #</th>\n              <th style={{ padding: \"6px 12px\" }}>Date</th>\n              <th style={{ padding: \"6px 12px\" }}>Status</th>\n              <th style={{ padding: \"6px 12px\" }}>Offers Filled</th>\n              <th style={{ padding: \"6px 12px\" }}>Total Winners</th>\n              <th style={{ padding: \"6px 12px\" }}>Reward Summary</th>\n              <th style={{ padding: \"6px 12px\" }}>Logic</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...carnivallog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>{entry.carnivalnumber || '-'}</td>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.status || ''}</td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Carnival' || entry.status === 'Current Carnival' ? 'n/a' : entry.alloffersfilled ? '' : ''}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Carnival' || entry.status === 'Current Carnival' ? 'n/a' : entry.totalwinners}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {(() => {\n                    // Combine rewards of the same type for display\n                    const combinedRewards = {};\n                    (entry.rewards || []).forEach((reward) => {\n                      if (combinedRewards[reward.item]) {\n                        combinedRewards[reward.item] += reward.qty;\n                      } else {\n                        combinedRewards[reward.item] = reward.qty;\n                      }\n                    });\n                    return Object.entries(combinedRewards).map(([item, totalQty]) => `${totalQty} ${item}`).join(', ');\n                  })()}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.logic ? (\n                    <button \n                      onClick={() => handleShowLogic(entry.logic, entry.carnivalnumber)}\n                      className=\"carnival-logic-button\"\n                    >\n                      Logic\n                    </button>\n                  ) : (\n                    '-'\n                  )}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: \"Carnival Log\",\n        size: \"large\",\n        message: carnivallog.length === 0 ? \"No recent carnival activity.\" : undefined,\n        custom: carnivalLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch carnival log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load carnival log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n  const getSymbol = (type) => {\n    return masterResources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n  const handleClaim = async (offer) => {\n    if (!offer || offer.claimedBy) return;\n\n    //  Check if player already has a claimed offer\n    const alreadyClaimed = carnivalOffers.some(\n      (o) => o.claimedBy === currentPlayer.playerId && !o.filled\n    );\n    if (alreadyClaimed) {\n      updateStatus(2014); //  Already claimed an offer\n      return;\n    }\n\n    try {\n      // Find the exact index of the offer to ensure uniqueness\n      const offerIndex = carnivalOffers.findIndex(\n        (o) => o.itemBought === offer.itemBought &&\n              o.qtyBought === offer.qtyBought &&\n              !o.claimedBy &&\n              !o.filled\n      );\n      if (offerIndex === -1) {\n        console.warn(\" No matching unclaimed offer found to claim.\");\n        return;\n      }\n\n      const updatedOffer = {\n        ...carnivalOffers[offerIndex],\n        claimedBy: currentPlayer.playerId,\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-carnival-offer/${currentPlayer.settlementId}`, {\n        updateOffer: updatedOffer,\n      });\n\n      if (response.status === 200) {\n        setCarnivalOffers(prev => {\n          const newOffers = [...prev];\n          newOffers[offerIndex] = updatedOffer;\n          return newOffers;\n        });\n        \n        // Add current player's username to the map immediately\n        setPlayerUsernames(prev => ({\n          ...prev,\n          [currentPlayer.playerId]: currentPlayer.username\n        }));\n      }\n    } catch (err) {\n      console.error(\" Error claiming carnival offer:\", err);\n      \n      // Handle case where offer was already claimed\n      if (err.response?.status === 409) {\n        updateStatus(2017); // This order has already been claimed.\n        // Refresh offers to get latest state\n        fetchCarnivalOffers();\n      } else {\n        updateStatus(505); // Generic error\n      }\n    }\n  };\n\n  const handleFulfill = async (offer) => {\n    if (!offer || offer.claimedBy !== currentPlayer.playerId) return;\n\n    // Spend the ingredients (the item being delivered)\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: { \n        type: offer.itemBought, \n        ingredient1: offer.itemBought, \n        ingredient1qty: offer.qtyBought \n      },\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!success) return;\n\n    try {\n      // First update the carnival offer\n      await axios.post(`${API_BASE}/api/update-carnival-offer/${currentPlayer.settlementId}`, {\n        updateOffer: {\n          ...offer,\n          filled: true,\n        },\n      });\n\n    // Award Money for fulfillment\n    await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: \"Money\",\n      quantity: offer.qtyGiven,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n      // Update local state in correct order\n      setCarnivalOffers(prev => {\n        const index = prev.findIndex(o =>\n          o.itemBought === offer.itemBought &&\n          o.qtyBought === offer.qtyBought &&\n          o.claimedBy === currentPlayer.playerId &&\n          !o.filled\n        );\n        if (index === -1) return prev;\n        const newOffers = [...prev];\n        newOffers[index] = { ...newOffers[index], filled: true };\n        return newOffers;\n      });\n\n      updateStatus(` Delivered ${offer.qtyBought} ${offer.itemBought}.`);\n\n    } catch (error) {\n      console.error(\" Error fulfilling offer:\", error);\n      fetchCarnivalOffers(); // Refresh offers on error to ensure sync\n    }\n  };\n\n  const renderNextShipment = () => {\n    if (![\"here\", \"departing\"].includes(carnivalPhase)) return null;\n    if (!nextOffers.length) return null;\n  \n    //  Deduplicate by itemBought\n    const seen = new Set();\n    const uniqueOffers = nextOffers.filter((offer) => {\n      if (seen.has(offer.itemBought)) return false;\n      seen.add(offer.itemBought);\n      return true;\n    });\n  \n    return (\n      <div className=\"next-shipment-preview\">\n        <h4>{strings[2018]}</h4>\n        <div className=\"next-shipment-container\">\n          {uniqueOffers.map((offer, index) => (\n            <div key={index} className=\"next-shipment-item\">\n              {getSymbol(offer.itemBought)} {offer.itemBought}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderRewardSection = () => {\n    if (!carnivalRewards.length || carnivalPhase !== \"here\") return null;\n  \n    //  Combine rewards of the same type\n    const combinedRewards = {};\n    carnivalRewards.forEach((reward) => {\n      if (combinedRewards[reward.item]) {\n        combinedRewards[reward.item] += reward.qty;\n      } else {\n        combinedRewards[reward.item] = reward.qty;\n      }\n    });\n  \n    return (\n      <div className=\"reward-section\">\n        <h4>{strings[2004]}</h4>\n        <div className=\"carnival-rewards-container\">\n          {Object.entries(combinedRewards).map(([item, totalQty], index) => (\n            <div key={index} className=\"carnival-reward-item\">\n              {getSymbol(item)} {totalQty} {item}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderOfferSection = (title, offers) => {\n    if (!offers.length) return null;\n    return (\n      <div className=\"offer-section\">\n        <h4>{title}</h4>\n        {offers.map((offer, index) => {\n          const isYours = offer.claimedBy === currentPlayer.playerId;\n          const isCompleted = offer.filled;\n          const affordable = latestInventory?.some(\n            (item) => item.type === offer.itemBought && item.quantity >= offer.qtyBought\n          ) || false;\n\n          const playerQty = latestInventory?.find(inv => inv.type === offer.itemBought)?.quantity || 0;\n          const costColor = playerQty >= offer.qtyBought ? 'green' : 'red';\n          const costDisplay = `<span style=\"color: ${costColor};\">${getSymbol(offer.itemBought)} ${offer.itemBought} ${offer.qtyBought} / ${playerQty}</span>`;\n          const rewardDisplay = `${getSymbol(offer.itemGiven)} ${offer.qtyGiven.toLocaleString()}`;\n          const details = `<div>${costDisplay}</div><br>${strings[42]}: ${rewardDisplay}`;\n\n          let buttonText = '';\n          if (isCompleted) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = username;\n          } else if (isYours && affordable) {\n            buttonText = strings[2005];\n          } else if (isYours) {\n            buttonText = strings[2006];\n          } else if (offer.claimedBy) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = `${strings[2007]} (${username})`;\n          } else {\n            buttonText = strings[2008];\n          }\n\n          return (\n            <ResourceButton\n              key={index}\n              name={isCompleted || offer.claimedBy ? (playerUsernames[offer.claimedBy] || 'Unknown') : ''}\n              className={`carnival-offer-card ${\n                !offer.claimedBy ? 'unclaimed' : \n                'resource-button'\n              }`}\n              onClick={() =>\n                isCompleted ? null :\n                isYours ? handleFulfill(offer) :\n                !offer.claimedBy ? handleClaim(offer) : null\n              }\n              disabled={isCompleted || (!isYours && offer.claimedBy) || (isYours && !affordable)}\n              details={details}\n            >\n              <strong>{!isCompleted && !offer.claimedBy ? buttonText : \n               !isCompleted && offer.claimedBy ? strings[2007] : ''}</strong>\n            </ResourceButton>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const claimedByYou = carnivalOffers.filter(o => o.claimedBy === currentPlayer.playerId && !o.filled);\n  const available = carnivalOffers.filter(o => !o.claimedBy);\n  const claimedByOthers = carnivalOffers.filter(o => o.claimedBy && o.claimedBy !== currentPlayer.playerId && !o.filled);\n  const completed = carnivalOffers.filter(o => o.filled);\n\n  const allOrdersFilled = carnivalPhase === 'departing' || carnivalPhase === 'arriving'\n  ? carnivalOffers.length > 0 && carnivalOffers.every(o => o.filled)\n  : false;\n\n\n  return (\n    <>\n    <Panel onClose={onClose} descriptionKey=\"1037\" titleKey=\"1137\" panelName=\"CarnivalPanel\">\n      {/* Check if player is in their home settlement */}\n      {(() => {\n        const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n        console.log(' Carnival access check:', {\n          currentSettlement: currentPlayer.location.s,\n          homeSettlement: currentPlayer.settlementId,\n          isInHomeSettlement\n        });\n        return !isInHomeSettlement;\n      })() ? (\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n          <h2>{strings[1352] || \"This is not your home settlement.\"}</h2>\n        </div>\n      ) : isContentLoading ? (\n        <p>{strings[98]}</p>\n      ) : (\n        <>\n          <h3>{strings[1352]} {carnivalPhase} {currentCarnivalNumber ? `(#${currentCarnivalNumber})` : ''}</h3>\n          <h2> {carnivalTimer}</h2>\n\n          {carnivalPhase === \"here\" && (\n            <>\n              {renderRewardSection()}\n              {renderOfferSection(strings[2009], claimedByYou)}\n              {renderOfferSection(strings[2010], available)}\n              {renderOfferSection(strings[2011], claimedByOthers)}\n              {renderOfferSection(strings[2012], completed)}\n            </>\n          )}\n\n          {allOrdersFilled && (\n            <div className=\"carnival-rewards-banner\">\n              {strings[2016]}\n            </div>\n          )}\n\n          {(carnivalPhase === \"here\" || carnivalPhase === \"departing\") && renderNextShipment()}\n\n        <div className=\"shared-buttons\" style={{ margin: '2px 0' }}>\n            <button className=\"btn-basic btn-neutral\" onClick={() => handleShowCarnivalLog()}>\n                {strings[1351]}\n            </button>\n        </div>\n        </>\n      )}\n    </Panel>\n    \n    {showLogicModal && (\n      <div className=\"carnival-logic-modal-overlay\">\n        <div className=\"carnival-logic-modal\">\n          <button \n            onClick={() => setShowLogicModal(false)}\n            className=\"carnival-logic-modal-close\"\n          >\n            \n          </button>\n          <h3>\n            Carnival #{logicModalData.carnivalNumber || '?'} Logic\n          </h3>\n          <pre>\n            {logicModalData.logic || 'No logic information available'}\n          </pre>\n        </div>\n      </div>\n    )}\n    </>\n  );\n}\n\nexport default CarnivalPanel;","import API_BASE from '../../config';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport Modal from '../../UI/Modal';\nimport axios from 'axios';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport './Courthouse.css';\nimport '../../UI/Panel.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport '../../UI/Modal.css';\nimport '../../UI/SharedButtons.css';\nimport { getMayorUsername } from './GovUtils';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\nimport { formatCountdown } from '../../UI/Timers';\n\nconst CourthousePanel = ({ onClose, currentPlayer, setCurrentPlayer }) => {\n\n    const strings = useStrings();\n    const [settlement, setSettlement] = useState(null);\n    const [taxRate, setTaxRate] = useState(0);\n    const [isMayor, setIsMayor] = useState(false);\n    const [electionPhase, setElectionPhase] = useState('');\n    const [countdown, setCountdown] = useState('');\n    const { updateStatus } = useContext(StatusBarContext);\n    const [campaignPromises, setCampaignPromises] = useState([]);\n    const [newPromise, setNewPromise] = useState('');\n    const [selectedCandidate, setSelectedCandidate] = useState(null);\n    const [hasVoted, setHasVoted] = useState(false);\n    const [votedFor, setVotedFor] = useState('');\n    const [candidateList, setCandidateList] = useState([]);\n    const [tempTaxRate, setTempTaxRate] = useState(0); // Temporary UI state for the slider\n    const [hoveredCandidate, setHoveredCandidate] = useState(null);\n    const [tooltipPosition, setTooltipPosition] = useState({ x: 0, y: 0 });\n    const [tempSettlementName, setTempSettlementName] = useState('');\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [modalContent, setModalContent] = useState(null);\n    const [mayor, setMayor] = useState(\"\");\n    const [population, setPopulation] = useState(0);\n\n    \n    const handleViewElectionLog = async () => {\n        if (!currentPlayer?.settlementId) {\n          console.warn(\" Cannot show election log: settlementId missing.\");\n          return;\n        }\n\n        console.log(\" Show Election Log clicked\");\n        console.log(\" Fetching election log for settlement:\", currentPlayer.settlementId);\n\n        try {\n          const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/electionlog`);\n          console.log(\" Election log API response:\", response.data);\n\n          const electionlog = response.data.electionlog || [];\n\n          const electionLogTable = (\n            <table className=\"election-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n              <thead>\n                <tr>\n                  <th style={{ padding: \"6px 12px\" }}>Date</th>\n                  <th style={{ padding: \"6px 12px\" }}>Candidates</th>\n                  <th style={{ padding: \"6px 12px\" }}>Elected Mayor</th>\n                </tr>\n              </thead>\n              <tbody>\n                {[...electionlog].reverse().map((entry, i) => (\n                  <tr key={i}>\n                    <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                    <td style={{ padding: \"6px 12px\" }}>\n                      {entry.candidates?.length > 0 ? (\n                        entry.candidates.map((c, j) => (\n                          <div key={j}>{c.username}: {c.votes} votes</div>\n                        ))\n                      ) : (\n                        <em>No candidates</em>\n                      )}\n                    </td>\n                    <td style={{ padding: \"6px 12px\" }}>{entry.electedmayor || 'None'}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          );\n\n          setModalContent({\n            title: \"Recent Election Results\",\n            size: \"large\",\n            message: electionlog.length === 0\n              ? \"No election results recorded yet.\"\n              : undefined,\n            custom: electionLogTable,\n          });\n          setIsModalOpen(true);\n        } catch (error) {\n          console.error(\" Failed to fetch election log:\", error);\n          setModalContent({\n            title: \"Error\",\n            message: \"Failed to load election log.\",\n            size: \"small\",\n          });\n          setIsModalOpen(true);\n        }\n    };\n\n    // Effect for initial data load only\n    useEffect(() => {\n        fetchElectionData();\n    }, [currentPlayer.settlementId]);\n\n    // Combined countdown and phase monitor effect\n    useEffect(() => {\n        const updateTimerAndPhase = () => {\n            const now = Date.now();\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            const electionData = storedTimers.elections || {};\n            \n            // Update phase first\n            const newPhase = electionData.phase || \"Administration\";\n            if (newPhase !== electionPhase) {\n                console.log(\" Election phase changing to:\", newPhase);\n                setElectionPhase(newPhase);\n            }\n\n            // Then update countdown using shared formatCountdown function\n            const endTime = electionData.endTime;\n            if (!endTime || isNaN(endTime)) {\n                setCountdown(\"N/A\");\n                return;\n            }\n\n            setCountdown(formatCountdown(endTime, now));\n        };\n\n        updateTimerAndPhase(); // Initial run\n        const interval = setInterval(updateTimerAndPhase, 1000);\n        return () => clearInterval(interval);\n    }, []); // No dependencies needed\n\n    // Effect to fetch fresh data on phase changes\n    useEffect(() => {\n        console.log(\" Phase changed to:\", electionPhase);\n        if (electionPhase === \"Counting\") {\n            setCampaignPromises([]);\n            setCandidateList([]);\n        }\n        fetchElectionData();\n    }, [electionPhase]);\n\n    const fetchElectionData = async () => {\n        try {\n            const settlementResponse = await axios.get(\n                `${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`\n            );\n            const settlementData = settlementResponse.data;\n            \n            setSettlement(settlementData);\n            setTaxRate(settlementData.taxrate || 0);\n            setTempTaxRate(settlementData.taxrate || 0);\n            setCampaignPromises(settlementData.campaignPromises || []);\n            setTempSettlementName(settlementData.displayName || '');\n            \n            // Update mayor status\n            const mayorRole = settlementData.roles.find(role => role.roleName === 'Mayor');\n            setIsMayor(mayorRole && mayorRole.playerId.toString() === currentPlayer._id.toString());\n            \n            // Fetch mayor username\n            const mayorName = await getMayorUsername(currentPlayer.settlementId);\n            setMayor(mayorName);\n            \n            // Calculate population\n            const populationCount = calculateSettlementPopulation(settlementData);\n            setPopulation(populationCount);\n\n            // Always reset hasVoted and votedFor before checking\n            setHasVoted(false);\n            setVotedFor('');\n            if (settlementData.votes) {\n                const playerVote = settlementData.votes.find(v => String(v.voterId) === String(currentPlayer._id));\n                if (playerVote) {\n                    setHasVoted(true);\n                    const votedCandidate = settlementData.campaignPromises?.find(p => \n                        String(p.playerId) === String(playerVote.candidateId)\n                    );\n                    setVotedFor(votedCandidate?.username || 'Unknown');\n                }\n            }\n\n            // Only update candidates list if in voting phase and haven't voted\n            if (electionPhase === \"Voting\" && !hasVoted) {\n                const uniqueCandidates = settlementData.campaignPromises?.reduce((acc, promise) => {\n                    if (!acc.find((c) => c.playerId === promise.playerId)) {\n                        acc.push({ playerId: promise.playerId, username: promise.username });\n                    }\n                    return acc;\n                }, []) || [];\n                setCandidateList(uniqueCandidates);\n            }\n        } catch (error) {\n            console.error(' Error fetching election data:', error);\n        }\n    };\n\n    const handleAddCampaignPromise = async () => {\n        if (!newPromise.trim()) return;\n        if (newPromise.length > 200) {\n            updateStatus('Campaign promises cannot exceed 200 characters.');\n            return;\n        }\n        try {\n            const response = await axios.post(`${API_BASE}/api/save-campaign-promise`, {\n                settlementId: currentPlayer.settlementId,\n                playerId: currentPlayer._id,\n                username: currentPlayer.username,\n                text: newPromise,\n            });\n\n            if (response.data.message) {\n                console.log(` ${response.data.message}`);\n                updateStatus(' Campaign promise submitted.');\n                setCampaignPromises(response.data.campaignPromises);\n                setNewPromise('');\n            }\n        } catch (error) {\n            console.error(' Error submitting campaign promise:', error);\n            updateStatus(' Failed to submit campaign promise.');\n        }\n    };\n\n    const handleVote = async () => {\n        if (!selectedCandidate) return;\n\n        try {\n            const response = await axios.post(`${API_BASE}/api/cast-vote`, {\n                settlementId: currentPlayer.settlementId,\n                voterId: currentPlayer._id,\n                candidateId: selectedCandidate,\n            });\n\n            if (response.data.message) {\n                console.log(` ${response.data.message}`);\n                updateStatus(' Vote successfully cast.');\n                setHasVoted(true);\n                // Store the username of the voted candidate\n                const votedCandidate = candidateList.find(c => c.playerId === selectedCandidate);\n                setVotedFor(votedCandidate?.username || 'Unknown');\n                await trackQuestProgress(currentPlayer, 'Vote', 'Election', 1);\n                fetchElectionData();\n            }\n        } catch (error) {\n            console.error(' Error casting vote:', error);\n            if (error.response.data.error === \"Already voted.\") {\n                updateStatus(' You already voted.');\n            } else {\n                updateStatus(' Failed to cast vote.');\n            }\n        }\n    };\n\n    const handleSaveTaxRate = async () => {\n        if (!isMayor) return;\n    \n        try {\n            console.log(` Saving new tax rate: ${tempTaxRate}%`);\n    \n            const response = await axios.post(`${API_BASE}/api/update-settlement`, {\n                settlementId: currentPlayer.settlementId,\n                updates: { taxrate: tempTaxRate }, //  Save the new tax rate\n            });\n    \n            if (response.data.success) {\n                console.log(` Tax rate updated successfully.`);\n                updateStatus(` Tax rate set to ${tempTaxRate}%`);\n                //  Sync stored tax rate with UI slider\n                setTaxRate(tempTaxRate);\n            } else {\n                console.error(` Failed to update tax rate:`, response.data.error);\n                updateStatus(\" Error updating tax rate.\");\n            }\n        } catch (error) {\n            console.error(' Error saving tax rate:', error);\n            updateStatus(\" Failed to save tax rate.\");\n        }\n    };\n\n    const handleSaveSettlementName = async () => {\n        if (!isMayor || !tempSettlementName.trim()) return;\n\n        try {\n            const response = await axios.post(`${API_BASE}/api/update-settlement`, {\n                settlementId: currentPlayer.settlementId,\n                updates: { displayName: tempSettlementName } // Changed from name to displayName\n            });\n\n            if (response.data.success) {\n                updateStatus(`Settlement renamed to ${tempSettlementName}`);\n                setSettlement(prev => ({ ...prev, displayName: tempSettlementName }));\n            } else {\n                updateStatus(\" Error updating settlement name.\");\n            }\n        } catch (error) {\n            console.error(' Error saving settlement name:', error);\n            updateStatus(\" Failed to save settlement name.\");\n        }\n    };\n\n    const getCandidatePromise = (candidateId) => {\n        return campaignPromises.find(promise => \n            promise.playerId === candidateId\n        )?.text || \"No campaign promise made.\";\n    };\n\n    console.log(\"hasVoted:\", hasVoted);\n    console.log(\"electionPhase:\", electionPhase);\n\n\n\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1012\" titleKey=\"1112\" panelName=\"Courthouse\">\n            <div className=\"panel-content courthouse-panel\">\n            {/* Check if player is in their home settlement */}\n            {(() => {\n                const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n                console.log(' Courthouse access check:', {\n                    currentSettlement: currentPlayer.location.s,\n                    homeSettlement: currentPlayer.settlementId,\n                    isInHomeSettlement\n                });\n                return !isInHomeSettlement;\n            })() ? (\n                <div style={{ textAlign: 'center', padding: '20px' }}>\n                    <h2>{strings[2050] || \"This is not your home settlement.\"}</h2>\n                </div>\n            ) : (\n                <>\n                {isMayor && <h2>{strings[2080]}</h2>}\n                \n                <div className=\"debug-buttons\">\n\n\n{/* Settlement name section */}\n                    <h3>{strings[2082]}</h3>\n                    {isMayor ? (\n                        <div className=\"settlement-name-editor\">\n                            <input\n                                type=\"text\"\n                                value={tempSettlementName}\n                                onChange={(e) => setTempSettlementName(e.target.value)}\n                                placeholder={strings[2081]}\n                            />\n                            <div className=\"shared-buttons\" style={{ display: 'inline-block', marginLeft: '8px' }}>\n                                <button \n                                    className=\"btn-basic btn-success btn-modal-small\" \n                                    onClick={handleSaveSettlementName}\n                                    disabled={!tempSettlementName.trim()}\n                                    style={{ width: 'auto' }}\n                                >\n                                    {strings[2083]}\n                                </button>\n                            </div>\n                        </div>\n                    ) : (\n                        <h3 style={{ color: 'rgb(154, 106, 22)' }}><strong>{settlement?.displayName || 'Unnamed'}</strong></h3>\n                    )}\n \n{/* POPULATION section */}\n                    <h3>{strings[\"3002\"]} <strong>{population}</strong></h3>\n\n{/* TAX RATE section */} \n \n                    <h3>{strings[2041]} {taxRate}%</h3>\n                    {isMayor && (\n                        <div className=\"tax-rate-editor\">\n                            <input\n                                type=\"range\" min=\"0\" max=\"20\" value={tempTaxRate}\n                                onChange={(e) => setTempTaxRate(Number(e.target.value))}\n                            />\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '8px' }}>\n                            <span style={{ flex: 1 }}>{strings[2042]} {tempTaxRate}%</span>\n                            <button\n                                className=\"btn-basic btn-success btn-modal-small\"\n                                onClick={handleSaveTaxRate}\n                                style={{\n                                width: 'auto',\n                                maxWidth: '100px',\n                                flexShrink: 0\n                                }}\n                            >\n                                {strings[\"2043\"]}\n                            </button>\n                            </div>\n                        </div>\n                    )}\n\n{/* CURRENT MAYOR section - only show if player is not the mayor */}\n                    {!isMayor && (\n                        <>\n                            <h3>{strings[2085]}</h3>\n                            <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{mayor || \"Vacant\"}</strong></h2>\n                        </>\n                    )}\n\n                    {!isMayor && <h2>{strings[2079]}</h2>}\n\n                    <p>{strings[2084]}</p>\n\n\n{/* ELECTIONS section */} \n\n                    <br></br> \n                    <h2>{strings[2045]}</h2>\n                    <div className=\"shared-buttons\">\n                        <button className=\"btn-basic btn-success\" onClick={handleViewElectionLog}>Recent Election Results</button>\n                    </div>\n                    <p><strong>\n                        {electionPhase === \"Counting\" && strings[\"2062\"]}\n                        {electionPhase === \"Voting\" && strings[\"2061\"]}\n                        {electionPhase === \"Campaigning\" && strings[\"2060\"]}\n                        {electionPhase === \"Administration\" && strings[\"2063\"]}\n                    </strong></p>\n                    <p>{countdown}</p>\n\n{/*  Campaigning Phase */}\n\n                    {electionPhase === \"Campaigning\" && (\n                        <>\n                            <h3>{strings[2048]}</h3>\n                            \n                            {/*  Scrollable List of Promises */}\n                            <div className=\"campaign-promises\">\n                                {campaignPromises.length > 0 ? (\n                                    campaignPromises.map((promise, index) => (\n                                        <div key={index} className=\"campaign-entry\">\n                                            <strong>{promise.username}:</strong> {promise.text}\n                                        </div>\n                                    ))\n                                ) : (\n                                    <p>{strings[2071]}</p>\n                                )}\n                            </div>\n\n                            {/*  Player Can Submit a Promise */}\n                            {!campaignPromises.some(p => p.playerId === currentPlayer._id) && (\n                                <>\n                                    <textarea\n                                        value={newPromise}\n                                        onChange={(e) => setNewPromise(e.target.value)}\n                                        placeholder={strings[2072]}\n                                    />\n                                    <div className=\"shared-buttons\">\n                                        <button className=\"btn-basic btn-success\" onClick={handleAddCampaignPromise}>Submit Campaign Promise</button>\n                                    </div>\n                                </>\n                            )}\n                        </>\n                    )}\n\n{/* Voting Phase UI */}\n\n                <div className=\"voting-section\">\n                </div>\n                    {electionPhase === 'Voting' && (\n                        <div className=\"voting-section\">\n                            {hasVoted ? (\n                                <p>{strings[2077]}</p>\n                            ) : candidateList.length > 0 ? (\n                                <>\n                                    <h3>Cast Your Vote</h3>\n                                    {candidateList.map((candidate, index) => (\n                                        <div \n                                            key={candidate.playerId || index}\n                                            className=\"candidate-row\"\n                                            onMouseEnter={(e) => {\n                                                setHoveredCandidate(candidate.playerId);\n                                                setTooltipPosition({\n                                                    x: e.clientX + 10,\n                                                    y: e.clientY - 40\n                                                });\n                                            }}\n                                            onMouseLeave={() => setHoveredCandidate(null)}\n                                        >\n                                            <input \n                                                type=\"radio\" \n                                                name=\"vote\" \n                                                value={candidate.playerId}\n                                                onChange={() => {\n                                                    setSelectedCandidate(candidate.playerId);\n                                                }}\n                                            />\n                                            {candidate.username}\n                                        </div>\n                                    ))}\n                                    <div className=\"shared-buttons\">\n                                        <button \n                                            className=\"btn-basic btn-success\"\n                                            onClick={handleVote} \n                                            disabled={!selectedCandidate}\n                                        >\n                                            {strings[2074]}\n                                        </button>\n                                    </div>\n\n                                    {/* Tooltip */}\n                                    {hoveredCandidate && (\n                                        <div \n                                            className=\"candidate-tooltip\"\n                                            style={{\n                                                left: tooltipPosition.x,\n                                                top: tooltipPosition.y,\n                                            }}\n                                        >\n                                            <strong>{strings[2076]}</strong><br />\n                                            \"{getCandidatePromise(hoveredCandidate)}\"\n                                        </div>\n                                    )}\n                                </>\n                            ) : (\n                                <p>{strings[2078]}</p>\n                            )}\n\n\n                            {/*  Extra message if no one ran */}\n                            {candidateList.length === 0 && (\n                                <p><em>No one ran for mayor this election cycle.</em></p>\n                            )}\n                            \n                        </div>\n                    )}\n                </div>\n                </>\n            )}\n            </div>\n            {isModalOpen && (\n                <Modal\n                    isOpen={isModalOpen}\n                    onClose={() => setIsModalOpen(false)}\n                    title={modalContent?.title}\n                    size={modalContent?.size}\n                    message={modalContent?.message}\n                    custom={modalContent?.custom}\n                />\n            )}\n        </Panel>\n    );\n};\n\nexport default CourthousePanel;","/**\n * Economy utility functions for gem costs and calculations\n */\n\n/**\n * Calculate gem cost for speeding up crafting based on remaining time\n * @param {number} remainingTimeMs - Remaining time in milliseconds\n * @returns {number} - Number of gems required\n */\nexport function calculateGemSpeedupCost(remainingTimeMs) {\n  if (remainingTimeMs <= 0) return 0;\n  \n  const remainingMinutes = remainingTimeMs / (1000 * 60);\n  \n  // Use formula: gem cost = (remainingMinutes)^0.45\n  // This gives approximately:\n  // - 40 minutes  ~5 gems\n  // - 100 minutes  ~8 gems\n  const gemCost = Math.ceil(Math.pow(remainingMinutes, 0.45));\n  \n  return gemCost;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport '../../UI/ResourceButton.css'; \nimport ResourceButton from '../../UI/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { calculateGemSpeedupCost } from '../../Economy/EconomyUtils';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { canAfford, calculateSkillMultiplier, applySkillMultiplier } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { formatSingleCollection } from '../../UI/StatusBar/CollectionFormatters';\nimport '../../UI/SharedButtons.css';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { getMayorUsername } from '../Government/GovUtils';\nimport './ScrollStation.css'; // Import for shared station panel styles\n\nconst CraftingStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  resources,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  TILE_SIZE,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n  const [stationRefreshKey, setStationRefreshKey] = useState(0);\n  const [isMayor, setIsMayor] = useState(false);\n\n   //  Check for active crafting timers\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n\n    console.log(' Checking GlobalGridStateTilesAndResources for active crafting timers...');\n    \n    const station = GlobalGridStateTilesAndResources.getResources()?.find(\n      (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n    );\n\n    if (station && station.craftEnd) {\n        \n        setCraftedItem(station.craftedItem);\n        setIsCrafting(true);\n        setActiveTimer(true);  //  Ensure UI treats this as an active timer\n\n        const updateCountdown = () => {\n          const remainingTime = Math.max(0, Math.floor((station.craftEnd - Date.now()) / 1000));\n          setCraftingCountdown(remainingTime);\n\n          if (remainingTime === 0) {\n              console.log(' Crafting complete! Ready to collect.');\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n          }\n      };\n\n        updateCountdown();\n        const timer = setInterval(updateCountdown, 1000);\n        return () => clearInterval(timer);\n    } else {\n        console.log(' No active crafting timer found.');\n        setCraftedItem(null);\n        setIsCrafting(false);\n        setIsReadyToCollect(false);\n        setCraftingCountdown(null);\n        setActiveTimer(false);\n    }\n  }, [stationType, currentStationPosition, GlobalGridStateTilesAndResources.getResources(), craftingCountdown]); //  Ensure state triggers re-render\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => {\n        // Check if resource source matches station type\n        if (resource.source !== stationType) return false;\n        \n        // Check seasonal restriction\n        if (resource.season && currentSeason && resource.season !== currentSeason) {\n          return false;\n        }\n        \n        return true;\n      });\n      \n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n  // Check if player is mayor for town building selling permissions\n  useEffect(() => {\n    const checkMayorStatus = async () => {\n      let isPlayerMayor = false;\n      if (currentPlayer?.location?.gtype === 'town' && currentPlayer?.location?.s) {\n        try {\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n        } catch (error) {\n          console.error('Error checking mayor status:', error);\n        }\n      }\n      setIsMayor(isPlayerMayor);\n    };\n\n    if (currentPlayer) {\n      checkMayorStatus();\n    }\n  }, [currentPlayer?.location?.s, currentPlayer?.username]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Protected function to start crafting using transaction system\n  const handleCraft = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected craft for ${recipe.type}`);\n    console.log('Current station state:', { craftedItem, isCrafting, isReadyToCollect, craftingCountdown });\n    setErrorMessage('');\n    \n    if (!recipe) { \n      setErrorMessage('Invalid recipe selected.'); \n      return; \n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update only the specific station resource in global state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state immediately\n        setCraftedItem(craftedItem);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        FloatingTextManager.addFloatingText(404, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        updateStatus(`${strings[440]} ${getLocalizedString(recipe.type, strings)}`);\n\n        console.log(` ${recipe.type} crafting started using protected endpoint.`);\n      }\n    } catch (error) {\n      console.error('Error in protected crafting start:', error);\n      if (error.response?.status === 429) {\n        updateStatus(451);\n      } else if (error.response?.status === 400) {\n        updateStatus(450);\n      } else {\n        updateStatus(452);\n      }\n    }\n  };\n\n\n  // Protected function to collect crafted items using transaction system\n  const handleCollect = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected collection for ${recipe.type}`);\n    \n    if (!recipe) { \n      console.error(\" No valid crafted item to collect.\"); \n      return; \n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { collectedItem, isNPC, inventory, updatedStation } = response.data;\n\n        //  Apply skill buffs to crafted collection (station-based)\n        console.log('MasterSkills:', masterSkills);\n        console.log('Station Type:', stationType);\n\n        // Use shared skill calculation utility\n        const skillInfo = calculateSkillMultiplier(stationType, currentPlayer.skills || [], masterSkills);\n\n        // Apply multiplier to quantity (default to 1 if not provided by backend)\n        const baseQtyCollected = 1;\n        const finalQtyCollected = applySkillMultiplier(baseQtyCollected, skillInfo.multiplier);\n\n        console.log('[DEBUG] qtyCollected after multiplier:', finalQtyCollected);\n\n        // Handle NPC spawning client-side\n        if (isNPC) {\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: currentStationPosition.x, y: currentStationPosition.y });\n            // Trigger refresh to update available recipes\n            setNpcRefreshKey(prev => prev + 1);\n          }\n          // Show floating text for NPCs immediately since they don't need inventory space\n          FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        } else {\n          // Only add non-NPC items to inventory\n          // Update inventory with buffed quantity\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: finalQtyCollected,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          // Check if gainIngredients failed (returns object with success: false, or falsy value)\n          if (gained !== true && (!gained || gained.success === false)) {\n            console.error(' Failed to add buffed crafted item to inventory.');\n            return; // Exit early - don't clear crafting state if we couldn't collect\n          }\n          \n          // Show floating text only after successful collection\n          FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        }\n\n        // Only clear crafting state if we successfully collected (or it's an NPC)\n        \n        // Track quest progress for all crafted items (both NPCs and regular items)\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, finalQtyCollected, setCurrentPlayer);\n\n        // Update grid resources to remove crafting state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n\n        // Force a refresh of the station state\n        setStationRefreshKey(prev => prev + 1);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Use shared formatter for status message\n        const statusMessage = formatSingleCollection('craft', collectedItem, finalQtyCollected, \n          skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n        updateStatus(statusMessage);\n\n        console.log(`${recipe.type} collected successfully using protected endpoint.`);\n      }\n    } catch (error) {\n      console.error('Error in protected crafting collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect item');\n      }\n    }\n  };\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n\n  // Handle gem speedup for crafting\n  const handleGemSpeedup = async (recipe) => {\n    if (!isCrafting || !craftingCountdown) {\n      console.error(' No active crafting to speed up');\n      return;\n    }\n\n    const remainingTimeMs = craftingCountdown * 1000;\n    const gemCost = calculateGemSpeedupCost(remainingTimeMs);\n    \n    // Check if player has enough gems\n    const currentGems = (currentPlayer.inventory?.find(item => item.type === 'Gem')?.quantity || 0) +\n                       (currentPlayer.backpack?.find(item => item.type === 'Gem')?.quantity || 0);\n    \n    if (currentGems < gemCost) {\n      updateStatus(`Need ${gemCost} gems to speed up crafting`);\n      return;\n    }\n\n    try {\n      // Spend gems to complete crafting instantly\n      const spentResult = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          ingredient1: 'Gem',\n          ingredient1qty: gemCost,\n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spentResult) {\n        console.error(' Failed to spend gems for speedup');\n        return;\n      }\n\n      // Update the station in the database to mark crafting as complete\n      const updateResponse = await updateGridResource(\n        gridId,\n        {\n          type: stationType,\n          x: currentStationPosition.x,\n          y: currentStationPosition.y,\n          craftEnd: Date.now(), // Set to current time to complete immediately\n          craftedItem\n        },\n        true\n      );\n\n      if (updateResponse?.success) {\n        // Update global state to reflect the database change\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: Date.now(), craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftingCountdown(0);\n        setIsCrafting(false);\n        setIsReadyToCollect(true);\n\n        updateStatus(`Used ${gemCost} gems to complete crafting instantly`);\n        FloatingTextManager.addFloatingText(`-${gemCost} `, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        console.log(` Crafting completed instantly using ${gemCost} gems`);\n      } else {\n        throw new Error('Failed to update crafting station in database');\n      }\n    } catch (error) {\n      console.error(' Error in gem speedup:', error);\n      updateStatus(' Failed to speed up crafting');\n    }\n  };\n\n  // Handle gem purchase for instant crafting\n  const handleGemPurchase = async (modifiedRecipe) => {\n    console.log(' [GEM DEBUG] handleGemPurchase called with:', modifiedRecipe);\n    \n    // This is called by the gem button with a recipe modified to include gems\n    // First spend the ingredients (including gems)\n    const spendSuccess = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: modifiedRecipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendSuccess) {\n      console.warn('Failed to spend ingredients for gem purchase.');\n      return;\n    }\n    \n    console.log(' [GEM DEBUG] Ingredients spent successfully');\n\n    // For regular crafting items, add them to inventory immediately\n    const craftedResource = allResources.find(res => res.type === modifiedRecipe.type);\n    if (craftedResource) {\n      // Add the item to inventory\n      const gained = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: modifiedRecipe.type,\n        quantity: 1,\n        inventory: currentPlayer.inventory,\n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Check if gainIngredients succeeded (returns true on success, object with success: false on failure)\n      if (gained === true || (gained && gained.success === true)) {\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Craft', modifiedRecipe.type, 1, setCurrentPlayer);\n        \n        // Update status and effects\n        updateStatus(` ${getLocalizedString(modifiedRecipe.type, strings)} crafted instantly!`);\n        FloatingTextManager.addFloatingText(`+1 ${getLocalizedString(modifiedRecipe.type, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      } else {\n        updateStatus(' Failed to add crafted item to inventory');\n      }\n    } else {\n      updateStatus('Gem purchase not supported for this item type');\n    }\n  };\n  \n  // Generate skill bonus message\n  const getSkillBonusMessage = () => {\n    // Find all skills that apply to this station\n    const applicableSkills = Object.entries(masterSkills || {})\n      .filter(([skillName, stations]) => {\n        return stations && typeof stations === 'object' && stations[stationType] > 1;\n      })\n      .map(([skillName, stations]) => ({\n        skillName,\n        multiplier: stations[stationType],\n        hasSkill: currentPlayer.skills?.some(item => item.type === skillName)\n      }));\n    \n    if (applicableSkills.length === 0) return null;\n    \n    // Separate owned and unowned skills\n    const ownedSkills = applicableSkills.filter(skill => skill.hasSkill);\n    const unownedSkills = applicableSkills.filter(skill => !skill.hasSkill);\n    \n    // Calculate combined multiplier for owned skills\n    const combinedMultiplier = ownedSkills.reduce((total, skill) => total * skill.multiplier, 1);\n    \n    let messages = [];\n    \n    // Message for owned skills\n    if (ownedSkills.length > 0) {\n      if (ownedSkills.length === 1) {\n        // Single skill: \"Your [skill] Skill increases the base output of this station by [X].\"\n        messages.push(`${strings[805]}${getLocalizedString(ownedSkills[0].skillName, strings)}${strings[806]}${ownedSkills[0].multiplier}x.`);\n      } else {\n        // Multiple skills: list them with their multipliers and show combined effect\n        const skillsList = ownedSkills\n          .map(skill => `${getLocalizedString(skill.skillName, strings)} (${skill.multiplier}x)`)\n          .join(' & ');\n        messages.push(`Your ${skillsList} skills combine to increase output by ${combinedMultiplier}x.`);\n      }\n    }\n    \n    // Message for unowned skills\n    if (unownedSkills.length > 0) {\n      unownedSkills.forEach(skill => {\n        const skillResource = allResources.find(res => res.type === skill.skillName);\n        const skillSource = skillResource?.source || 'Skill Shop';\n        // \"Acquire the [skill] Skill at the [source] to increase the output of this station by [X]x.\"\n        messages.push(`${strings[801]}${getLocalizedString(skill.skillName, strings)}${strings[802]}${getLocalizedString(skillSource, strings)}${strings[803]}${skill.multiplier}x.`);\n      });\n    }\n    \n    return messages.join(' ');\n  };\n\n  const skillMessage = getSkillBonusMessage();\n\n  // Count hospitals on the current grid\n  const countHospitals = () => {\n    if (!resources || !allResources) return 0;\n    \n    return resources.filter(resource => {\n      // Find the master resource to check if it's a Hospital\n      const masterResource = allResources.find(mr => mr.type === resource.type);\n      return masterResource && masterResource.type === 'Hospital';\n    }).length;\n  };\n\n  // Count existing healers on the current grid\n  const countHealers = () => {\n    const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (!npcsInGrid) return 0;\n    \n    return Object.values(npcsInGrid).filter(npc => npc && npc.action === 'heal').length;\n  };\n\n  // Calculate maximum healers allowed based on hospitals and doctorsPerHospital setting\n  const getMaxHealersAllowed = () => {\n    const hospitalCount = countHospitals();\n    const doctorsPerHospital = globalTuning?.doctorsPerHospital || 1; // Default to 1 if not set\n    return hospitalCount * doctorsPerHospital;\n  };\n\n  const currentHealers = countHealers();\n  const maxHealersAllowed = getMaxHealersAllowed();\n\n  return (\n    <Panel onClose={onClose} title={`${stationEmoji} ${getLocalizedString(stationType, strings)}`} panelName=\"CraftingStation\">\n      <div className=\"station-panel-container\">\n        {/* Check if Library or Hospital requires home settlement */}\n        {(stationType === 'Library' || stationType === 'Hospital') && \n         String(currentPlayer.location.s) !== String(currentPlayer.settlementId) ? (\n          <div style={{ textAlign: 'center', padding: '20px' }}>\n            <h2>{strings[2050] || \"This is not your home settlement. You cannot access community services in any settlement but your own.\"}</h2>\n          </div>\n        ) : (\n          <>\n            {skillMessage && (\n              <div className=\"station-panel-header\" style={{ \n                padding: '10px', \n                backgroundColor: '#f0f0f0', \n                borderRadius: '5px',\n                fontStyle: 'italic',\n                marginBottom: '10px'\n              }}>\n                {skillMessage}\n              </div>\n            )}\n            <div className=\"station-panel-content\">\n        \n          {recipes?.length > 0 ? (\n            recipes.map((recipe) => {\n              const ingredients = getIngredientDetails(recipe, allResources || []);\n              const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n              const requirementsMet = hasRequiredSkill(recipe.requires);\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const isCrafting = craftedItem === recipe.type && craftingCountdown > 0;\n              const isReadyToCollect = craftedItem === recipe.type && craftingCountdown === 0;\n              \n              // Check if this is a healer and if we've hit the hospital capacity limit\n              const isHealer = recipe.action === 'heal';\n              const healerLimitReached = isHealer && currentHealers >= maxHealersAllowed;\n              \n              // Calculate gem speedup cost for this crafting item\n              // craftingCountdown is already in seconds, so we don't multiply by 1000\n              const gemSpeedupCost = isCrafting ? calculateGemSpeedupCost(craftingCountdown * 1000) : 0;\n\n              \n              const craftTimeText = isCrafting\n              ? `${strings[441]} ${formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}`\n              : isReadyToCollect\n              ? strings[457] \n              : recipe.crafttime\n              ? `${strings[458]} ${formatDuration(recipe.crafttime)}`\n              : strings[459];\n              \n              const info = (\n                <div className=\"info-content\">\n                  <div>\n                    <strong>{strings[421]}</strong>{' '}\n                    {allResources\n                      .filter((res) =>\n                        [res.ingredient1, res.ingredient2, res.ingredient3, res.ingredient4].includes(recipe.type)\n                      )\n                      .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                      .join(', ') || 'None'}\n                  </div>\n                  <div><strong>{strings[422]}</strong>  {recipe.minprice || 'n/a'}</div>\n                  {/* Show healer maxhp info for Hospital buildings with healer NPCs */}\n                  {stationType === 'Hospital' && recipe.action === 'heal' && (\n                    <div><strong>{strings[51]}</strong> {recipe.maxhp || 'n/a'}</div>\n                  )}\n                </div>\n              );\n              \n              // Format costs with color per ingredient (now using display: block and no <br>)\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  className={`resource-button ${isCrafting ? 'in-progress' : isReadyToCollect ? 'ready btn-sell' : ''}`}\n                  details={\n                    isCrafting ? craftTimeText :\n                    (\n                      (healerLimitReached ? `<span style=\"color: red;\">${strings[408]}</span><br>` : '') +\n                      (recipe.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(recipe.requires, strings)}</span><br>` : '') +\n                      `${craftTimeText}<br>` +\n                      (isReadyToCollect ? '' : `${strings[461]}<div>${formattedCosts}</div>`)\n                    )\n                  }\n                  info={info}\n                  disabled={!isReadyToCollect && (craftedItem !== null || !affordable || !requirementsMet || healerLimitReached)}\n                  onClick={undefined} // Remove direct onClick since we're using transaction mode\n                  // Transaction mode props for both craft start and collect\n                  isTransactionMode={true}\n                  transactionKey={isReadyToCollect ? \n                    `crafting-collect-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}` : \n                    `crafting-start-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}`}\n                  onTransactionAction={isReadyToCollect ? \n                    (transactionId, transactionKey) => handleCollect(transactionId, transactionKey, recipe) :\n                    (transactionId, transactionKey) => handleCraft(transactionId, transactionKey, recipe)}\n                  // Gem purchase props (for instant purchase) or speedup props (for active crafting)\n                  gemCost={isCrafting ? gemSpeedupCost : null}\n                  onGemPurchase={isCrafting ? \n                    () => handleGemSpeedup(recipe) : \n                    ((recipe.gemcost && (!affordable || !requirementsMet) && craftedItem === null && !healerLimitReached) ? handleGemPurchase : null)}\n                  resource={isCrafting ? { \n                    type: 'CraftingSpeedup', \n                    gemcost: gemSpeedupCost // Main gem cost, no ingredients\n                  } : recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                  // Hide gem button logic:\n                  // - If ready to collect: hide\n                  // - If this item is crafting: show speedup button\n                  // - If another item is crafting: hide\n                  // - If nothing is crafting and no gem cost: hide\n                  // - If nothing is crafting and has gem cost: show purchase button\n                  // - If healer limit reached: hide\n                  hideGem={isReadyToCollect || \n                           (!isCrafting && craftedItem !== null) || \n                           (!isCrafting && !recipe.gemcost) ||\n                           healerLimitReached}\n                >\n                </ResourceButton>\n              );\n            })\n          ) : <p>{strings[424]}</p>}\n\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n        \n            {(currentPlayer.location.gtype === 'homestead' || \n              isDeveloper || \n              (stationDetails?.source === 'BuildTown' && currentPlayer.location.gtype === 'town' && isMayor)) && (\n              <div className=\"station-panel-footer\">\n                <div className=\"shared-buttons\">\n                  <TransactionButton \n                    className=\"btn-basic btn-success\" \n                    onAction={handleSellStation}\n                    transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n                  >\n                    {strings[425]}\n                  </TransactionButton>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(CraftingStation);","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport '../../UI/ResourceButton.css'; \nimport ResourceButton from '../../UI/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { calculateGemSpeedupCost } from '../../Economy/EconomyUtils';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport '../../UI/SharedButtons.css';\nimport workerPlacementData from './WorkerPlacement.json';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\nconst FarmHouse = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n\n   //  Check for active crafting timers\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n    \n    const station = GlobalGridStateTilesAndResources.getResources()?.find(\n      (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n    );\n\n    if (station && station.craftEnd) {\n        console.log(` Active crafting found: ${station.craftedItem} until ${new Date(station.craftEnd).toLocaleTimeString()}`);\n        \n        setCraftedItem(station.craftedItem);\n        setIsCrafting(true);\n        setActiveTimer(true);  //  Ensure UI treats this as an active timer\n\n        const updateCountdown = () => {\n          const remainingTime = Math.max(0, Math.floor((station.craftEnd - Date.now()) / 1000));\n          setCraftingCountdown(remainingTime);\n\n          if (remainingTime === 0) {\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n          }\n      };\n\n        updateCountdown();\n        const timer = setInterval(updateCountdown, 1000);\n        return () => clearInterval(timer);\n    } else {\n        console.log(' No active crafting timer found.');\n        setCraftedItem(null);\n        setIsCrafting(false);\n        setIsReadyToCollect(false);\n        setCraftingCountdown(null);\n        setActiveTimer(false);\n    }\n  }, [stationType, currentStationPosition, GlobalGridStateTilesAndResources.getResources(), craftingCountdown]); //  Ensure state triggers re-render\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => resource.source === stationType);\n      \n      // Filter by FTUE step only if player is a first-time user\n      if (currentPlayer.firsttimeuser === true && currentPlayer.ftuestep != null) {\n        console.log(` Filtering FarmHouse recipes by FTUE step: ${currentPlayer.ftuestep}`);\n        filteredRecipes = filteredRecipes.filter((recipe) => {\n          // Only show recipes with level <= current FTUE step\n          return recipe.level == null || recipe.level <= currentPlayer.ftuestep;\n        });\n      }\n      \n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);\n        \n        console.log('Existing NPC types on grid:', existingNPCTypes);\n        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Protected function to start crafting using transaction system\n  const handleCraft = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected craft for ${recipe.type}`);\n    setErrorMessage('');\n    \n    if (!recipe) { \n      setErrorMessage('Invalid recipe selected.'); \n      return; \n    }\n\n    try {\n      const payload = {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe,\n        transactionId,\n        transactionKey,\n        // Add flag to indicate if this is a gem purchase (ingredients already paid)\n        isGemPurchase: transactionKey && transactionKey.includes('crafting-gem-')\n      };\n      \n      console.log(' [CRAFT DEBUG] Sending to server:', payload);\n      \n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, payload);\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update only the specific station resource in global state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state immediately\n        setCraftedItem(craftedItem);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        FloatingTextManager.addFloatingText(404, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        updateStatus(`${strings[440]} ${getLocalizedString(recipe.type, strings)}`);\n\n      }\n    } catch (error) {\n      console.error('Error in protected crafting start:', error);\n      console.error('Error response data:', error.response?.data);\n      if (error.response?.status === 429) {\n        updateStatus(451);\n      } else if (error.response?.status === 400) {\n        updateStatus(450);\n      } else {\n        updateStatus(452);\n      }\n    }\n  };\n\n\n  // Protected function to collect crafted items using transaction system\n  const handleCollect = async (transactionId, transactionKey, recipe) => {\n    \n    if (!recipe) { console.error(\" No valid crafted item to collect.\"); return; }\n\n    console.log(' [COLLECT DEBUG] Starting collection:', {\n      craftedItem,\n      recipeType: recipe?.type,\n      ftuestep: currentPlayer.ftuestep,\n      firsttimeuser: currentPlayer.firsttimeuser,\n      stationType\n    });\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { collectedItem, isNPC, inventory, updatedStation } = response.data;\n        \n        console.log(' [COLLECT DEBUG] Server response:', {\n          collectedItem,\n          isNPC,\n          hasInventory: !!inventory\n        });\n\n        //  Apply skill buffs to crafted collection\n        console.log('MasterSkills:', masterSkills);\n\n        // Extract player skills and upgrades\n        const playerBuffs = (currentPlayer.skills || [])\n          .filter((item) => {\n            const resourceDetails = allResources.find((res) => res.type === item.type);\n            const isSkill = resourceDetails?.category === 'skill' || resourceDetails?.category === 'upgrade';\n            const appliesToResource = (masterSkills?.[item.type]?.[collectedItem] || 1) > 1;\n            return isSkill && appliesToResource;\n          })\n          .map((buffItem) => buffItem.type);\n\n        // Calculate skill multiplier\n        const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n          const buffValue = masterSkills?.[buff]?.[collectedItem] || 1;\n          return multiplier * buffValue;\n        }, 1);\n\n        // Apply multiplier to quantity (default to 1 if not provided by backend)\n        const baseQtyCollected = 1;\n        const finalQtyCollected = baseQtyCollected * skillMultiplier;\n\n        console.log('[DEBUG] qtyCollected after multiplier:', finalQtyCollected);\n        FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n\n        // Handle NPC spawning client-side\n        if (isNPC) {\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            // Get placement offset from WorkerPlacement.json\n            const placementData = workerPlacementData.find(data => data.workerType === collectedItem);\n            const offsetX = placementData?.offsetX || 0;\n            const offsetY = placementData?.offsetY || 0;\n            \n            const spawnPosition = {\n              x: currentStationPosition.x + offsetX,\n              y: currentStationPosition.y + offsetY\n            };\n            \n            console.log(`Spawning ${collectedItem} at offset (${offsetX}, ${offsetY}) from Farm House, final position: (${spawnPosition.x}, ${spawnPosition.y})`);\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, spawnPosition);\n            \n            // Check for First Farm Worker trophy\n            if (craftedResource.action === 'worker') {\n              await earnTrophy(currentPlayer.playerId, 'First Farm Worker', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n            }\n            \n            // Trigger refresh to update available recipes\n            setNpcRefreshKey(prev => prev + 1);\n          }\n        } else {\n          // Only add non-NPC items to inventory\n          // Update inventory with buffed quantity\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: finalQtyCollected,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          if (!gained) {\n            console.error(' Failed to add buffed crafted item to inventory.');\n          }\n        }\n\n        // Track quest progress for all crafted items (both NPCs and regular items)\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, finalQtyCollected, setCurrentPlayer);\n        // Update grid resources to remove crafting state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      }\n    } catch (error) {\n      console.error('Error in protected crafting collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(454);\n      }\n    }\n  };\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n\n  // Handle gem speedup for crafting\n  const handleGemSpeedup = async (recipe) => {\n    if (!isCrafting || !craftingCountdown) {\n      console.error(' No active crafting to speed up');\n      return;\n    }\n\n    const remainingTimeMs = craftingCountdown * 1000;\n    const gemCost = calculateGemSpeedupCost(remainingTimeMs);\n    \n    // Check if player has enough gems\n    const currentGems = (currentPlayer.inventory?.find(item => item.type === 'Gem')?.quantity || 0) +\n                       (currentPlayer.backpack?.find(item => item.type === 'Gem')?.quantity || 0);\n    \n    if (currentGems < gemCost) {\n      updateStatus(`Need ${gemCost} gems to speed up crafting`);\n      return;\n    }\n\n    try {\n      // Spend gems to complete crafting instantly\n      const spentResult = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          ingredient1: 'Gem',\n          ingredient1qty: gemCost,\n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spentResult) {\n        console.error(' Failed to spend gems for speedup');\n        return;\n      }\n\n      // Update the station in the database to mark crafting as complete\n      const updateResponse = await updateGridResource(\n        gridId,\n        {\n          type: stationType,\n          x: currentStationPosition.x,\n          y: currentStationPosition.y,\n          craftEnd: Date.now(), // Set to current time to complete immediately\n          craftedItem\n        },\n        true\n      );\n\n      if (updateResponse?.success) {\n        // Update global state to reflect the database change\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: Date.now(), craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftingCountdown(0);\n        setIsCrafting(false);\n        setIsReadyToCollect(true);\n\n        updateStatus(`Used ${gemCost} gems to complete crafting instantly`);\n        FloatingTextManager.addFloatingText(`-${gemCost} `, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        console.log(` Crafting completed instantly using ${gemCost} gems`);\n      } else {\n        throw new Error('Failed to update crafting station in database');\n      }\n    } catch (error) {\n      console.error(' Error in gem speedup:', error);\n      updateStatus(' Failed to speed up crafting');\n    }\n  };\n  \n  // Handle gem purchase\n  const handleGemPurchase = async (modifiedRecipe) => {\n    console.log(' [GEM DEBUG] handleGemPurchase called with:', modifiedRecipe);\n    \n    // This is called by the gem button with a recipe modified to include gems\n    // First spend the ingredients (including gems)\n    const spendSuccess = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: modifiedRecipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendSuccess) {\n      console.warn('Failed to spend ingredients for gem purchase.');\n      return;\n    }\n    \n    console.log(' [GEM DEBUG] Ingredients spent successfully');\n\n    // For gem purchases with NPCs, spawn them immediately\n    const craftedResource = allResources.find(res => res.type === modifiedRecipe.type);\n    if (craftedResource && craftedResource.category === 'npc') {\n      // Get placement offset from WorkerPlacement.json\n      const placementData = workerPlacementData.find(data => data.workerType === modifiedRecipe.type);\n      const offsetX = placementData?.offsetX || 0;\n      const offsetY = placementData?.offsetY || 0;\n      \n      const spawnPosition = {\n        x: currentStationPosition.x + offsetX,\n        y: currentStationPosition.y + offsetY\n      };\n      \n      console.log(`Spawning ${modifiedRecipe.type} at offset (${offsetX}, ${offsetY}) from Farm House`);\n      NPCsInGridManager.spawnNPC(gridId, craftedResource, spawnPosition);\n      \n      // Check for First Farm Worker trophy\n      if (craftedResource.action === 'worker') {\n        await earnTrophy(currentPlayer.playerId, 'First Farm Worker', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      }\n      \n      // Track quest progress\n      await trackQuestProgress(currentPlayer, 'Craft', modifiedRecipe.type, 1, setCurrentPlayer);\n      \n      \n      // Update status and effects\n      updateStatus(` ${getLocalizedString(modifiedRecipe.type, strings)} hired instantly!`);\n      FloatingTextManager.addFloatingText(`+1 ${getLocalizedString(modifiedRecipe.type, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n      \n      // Trigger refresh\n      setNpcRefreshKey(prev => prev + 1);\n      \n      // Refresh player data\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    } else {\n      // For non-NPC items, we would need different handling\n      updateStatus('Gem purchase not supported for this item type');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1032\" titleKey=\"1132\" panelName=\"FarmHouse\">\n      <div className=\"standard-panel\">\n        \n          {recipes?.length > 0 ? (\n            recipes.map((recipe) => {\n              const ingredients = getIngredientDetails(recipe, allResources || []);\n              const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n              const requirementsMet = hasRequiredSkill(recipe.requires);\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const isCrafting = craftedItem === recipe.type && craftingCountdown > 0;\n              const isReadyToCollect = craftedItem === recipe.type && craftingCountdown === 0;\n              \n              // Calculate gem speedup cost for this crafting item\n              const remainingTimeMs = isCrafting ? craftingCountdown * 1000 : 0;\n              const gemSpeedupCost = isCrafting ? calculateGemSpeedupCost(remainingTimeMs) : 0;\n\n              \n              const craftTimeText = isCrafting\n              ? `${strings[441]} ${formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}`\n              : isReadyToCollect\n              ? strings[457] \n              : recipe.crafttime\n              ? `${strings[458]} ${formatDuration(recipe.crafttime)}`\n              : strings[459];\n              \n              // Custom tooltips for workers\n              let info;\n              if (recipe.type === 'Farm Hand') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[350]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Rancher') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[351]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Lumberjack') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[352]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Crafter') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[353]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Kent') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[354]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'The Shepherd') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[355]}</div>\n                  </div>\n                );\n              } else {\n                // Default info for non-worker recipes\n                info = (\n                  <div className=\"info-content\">\n                    <div>\n                      <strong>{strings[421]}</strong>{' '}\n                      {allResources\n                        .filter((res) =>\n                          [res.ingredient1, res.ingredient2, res.ingredient3, res.ingredient4].includes(recipe.type)\n                        )\n                        .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                        .join(', ') || 'None'}\n                    </div>\n                    <div><strong>{strings[422]}</strong>  {recipe.minprice || 'n/a'}</div>\n                  </div>\n                );\n              }\n              \n              // Format costs with color per ingredient (now using display: block and no <br>)\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  className={`resource-button ${isCrafting ? 'in-progress' : isReadyToCollect ? 'ready btn-sell' : ''}`}\n                  details={\n                    isCrafting ? craftTimeText :\n                    (\n                      (recipe.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(recipe.requires, strings)}</span><br>` : '') +\n                      `${craftTimeText}<br>` +\n                      (isReadyToCollect ? '' : `${strings[461]}<div>${formattedCosts}</div>`)\n                    )\n                  }\n                  info={info}\n                  disabled={!isReadyToCollect && (craftedItem !== null || !affordable || !requirementsMet)}\n                  onClick={undefined} // Remove direct onClick since we're using transaction mode\n                  // Transaction mode props for both craft start and collect\n                  isTransactionMode={true}\n                  transactionKey={isReadyToCollect ? \n                    `crafting-collect-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}` : \n                    `crafting-start-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}`}\n                  onTransactionAction={isReadyToCollect ? \n                    (transactionId, transactionKey) => handleCollect(transactionId, transactionKey, recipe) :\n                    (transactionId, transactionKey) => handleCraft(transactionId, transactionKey, recipe)}\n                  // Gem purchase props (for instant purchase) or speedup props (for active crafting)\n                  gemCost={isCrafting ? gemSpeedupCost : null}\n                  onGemPurchase={isCrafting ? \n                    () => handleGemSpeedup(recipe) : \n                    ((recipe.gemcost && (!affordable || !requirementsMet) && craftedItem === null) ? handleGemPurchase : null)}\n                  resource={isCrafting ? { \n                    type: 'CraftingSpeedup', \n                    gemcost: gemSpeedupCost // Main gem cost, no ingredients\n                  } : recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  // Hide gem button logic:\n                  // - If ready to collect: hide\n                  // - If this item is crafting: show speedup button\n                  // - If another item is crafting: hide\n                  // - If nothing is crafting and no gem cost: hide\n                  // - If nothing is crafting and has gem cost: show purchase button\n                  hideGem={isReadyToCollect || \n                           (!isCrafting && craftedItem !== null) || \n                           (!isCrafting && !recipe.gemcost)}\n                >\n                </ResourceButton>\n              );\n            })\n          ) : <p>{strings[456]}</p>}\n\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n        {(isDeveloper) && (\n          <>\n            <hr />\n              <div className=\"shared-buttons\">\n                <TransactionButton \n                  className=\"btn-basic btn-danger\" \n                  onAction={handleSellStation}\n                  transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n                >\n                  {strings[490]}\n                </TransactionButton>\n              </div>\n\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(FarmHouse);","import React, { useState, useEffect } from 'react';\nimport Modal from './Modal';\nimport './ProgressModal.css';\n\nfunction ProgressModal({ isOpen, title, message }) {\n  const [frame, setFrame] = useState(0);\n  const hourglassFrames = ['', ''];\n  \n  useEffect(() => {\n    if (!isOpen) {\n      setFrame(0);\n      return;\n    }\n    \n    // Animate hourglass every 500ms\n    const timer = setInterval(() => {\n      setFrame(prev => (prev + 1) % hourglassFrames.length);\n    }, 500);\n    \n    return () => clearInterval(timer);\n  }, [isOpen]);\n  \n  if (!isOpen) return null;\n  \n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={() => {}} // No close button during operation\n      title={title}\n      size=\"small\"\n      className=\"progress-modal\"\n    >\n      <div className=\"progress-modal-content\">\n        <div className=\"progress-message\">{message}</div>\n        \n        <div className=\"progress-hourglass\">\n          {hourglassFrames[frame]}\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default ProgressModal;","import React, { useState } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport Modal from '../../UI/Modal';\nimport { calculateBulkHarvestCapacity, buildBulkHarvestOperations } from './BulkHarvestUtils';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { calculateBulkWarehouseDrops, aggregateWarehouseDrops } from '../../Utils/WarehouseMaterials';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\nimport '../../UI/SharedButtons.css';\n\n// Component for the bulk harvest selection modal\nexport function BulkHarvestModal({ \n  isOpen, \n  onClose, \n  crops, \n  getFreshCrops,\n  onExecute,\n  showBulkReplant,\n  hasRequiredSkill,\n  strings,\n  currentSeason,\n  masterResources\n}) {\n  const [selectedCropTypes, setSelectedCropTypes] = useState({});\n  const [selectedReplantTypes, setSelectedReplantTypes] = useState({});\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && crops.length > 0) {\n      // Select all crops by default\n      const defaultSelection = {};\n      crops.forEach(crop => {\n        defaultSelection[crop.type] = true;\n      });\n      setSelectedCropTypes(defaultSelection);\n      \n      // Select replant options if available\n      if (showBulkReplant) {\n        const defaultReplantSelection = {};\n        crops.forEach(crop => {\n          // Check if player has required skill\n          const hasSkill = hasRequiredSkill(crop.replantRequires);\n          \n          // Check if crop is in season\n          let isInSeason = true;\n          if (currentSeason && masterResources) {\n            const farmplot = masterResources.find(r => \n              r.category === 'farmplot' && r.output === crop.type\n            );\n            if (farmplot && farmplot.season) {\n              isInSeason = farmplot.season === currentSeason;\n            }\n          }\n          \n          if (hasSkill && isInSeason) {\n            defaultReplantSelection[crop.type] = true;\n          }\n        });\n        setSelectedReplantTypes(defaultReplantSelection);\n      }\n    }\n  }, [isOpen, crops, showBulkReplant, hasRequiredSkill, currentSeason, masterResources]);\n\n  const handleToggleCrop = (cropType) => {\n    setSelectedCropTypes(prev => {\n      const newValue = !prev[cropType];\n      // If unchecking harvest, also uncheck replant\n      if (!newValue) {\n        setSelectedReplantTypes(replantPrev => ({\n          ...replantPrev,\n          [cropType]: false\n        }));\n      }\n      return {\n        ...prev,\n        [cropType]: newValue\n      };\n    });\n  };\n\n  const handleToggleReplant = (cropType) => {\n    setSelectedReplantTypes(prev => {\n      const newValue = !prev[cropType];\n      // If checking replant, also check harvest\n      if (newValue) {\n        setSelectedCropTypes(cropPrev => ({\n          ...cropPrev,\n          [cropType]: true\n        }));\n      }\n      return {\n        ...prev,\n        [cropType]: newValue\n      };\n    });\n  };\n\n  const handleExecute = async () => {\n    if (isProcessing) return;\n    \n    setIsProcessing(true);\n    try {\n      // If getFreshCrops is provided, validate selections against fresh data\n      if (getFreshCrops) {\n        const freshCrops = await getFreshCrops();\n        \n        // Filter selections to only include crops that still exist\n        const validCropTypes = {};\n        const validReplantTypes = {};\n        \n        freshCrops.forEach(crop => {\n          if (selectedCropTypes[crop.type]) {\n            validCropTypes[crop.type] = true;\n          }\n          if (selectedReplantTypes[crop.type]) {\n            validReplantTypes[crop.type] = true;\n          }\n        });\n        \n        onExecute(validCropTypes, validReplantTypes);\n      } else {\n        onExecute(selectedCropTypes, selectedReplantTypes);\n      }\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[315] || \"Select Crops to Harvest\"} size=\"medium\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>\n        <div style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px' }}>\n            <button \n              className=\"btn-basic btn-success btn-modal-small\"\n              onClick={() => {\n                const allSelected = {};\n                crops.forEach(crop => {\n                  allSelected[crop.type] = true;\n                });\n                setSelectedCropTypes(allSelected);\n              }}\n            >\n              {strings[316] || 'Select All'}\n            </button>\n            <button \n              className=\"btn-basic btn-neutral btn-modal-small\"\n              onClick={() => {\n                setSelectedCropTypes({});\n                // When deselecting all harvest, also deselect all replant\n                setSelectedReplantTypes({});\n              }}\n            >\n              {strings[317] || 'Deselect All'}\n            </button>\n          </div>\n          \n          {showBulkReplant && (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', marginLeft: 'auto' }}>\n              <button \n                className=\"btn-basic btn-success btn-modal-small\"\n                onClick={() => {\n                  const allReplantSelected = {};\n                  const allHarvestSelected = {};\n                  crops.forEach(crop => {\n                    // Check if player has required skill\n                    const hasSkill = hasRequiredSkill(crop.replantRequires);\n                    \n                    // Check if crop is in season\n                    let isInSeason = true;\n                    if (currentSeason && masterResources) {\n                      const farmplot = masterResources.find(r => \n                        r.category === 'farmplot' && r.output === crop.type\n                      );\n                      if (farmplot && farmplot.season) {\n                        isInSeason = farmplot.season === currentSeason;\n                      }\n                    }\n                    \n                    if (hasSkill && isInSeason) {\n                      allReplantSelected[crop.type] = true;\n                      // When selecting replant, also select harvest\n                      allHarvestSelected[crop.type] = true;\n                    } else {\n                      // Keep existing harvest selection for crops that can't be replanted\n                      allHarvestSelected[crop.type] = selectedCropTypes[crop.type] || false;\n                    }\n                  });\n                  setSelectedReplantTypes(allReplantSelected);\n                  setSelectedCropTypes(prev => ({\n                    ...prev,\n                    ...allHarvestSelected\n                  }));\n                }}\n              >\n                {strings[316] || 'Select All'}\n              </button>\n              <button \n                className=\"btn-basic btn-neutral btn-modal-small\"\n                onClick={() => setSelectedReplantTypes({})}\n              >\n                {strings[317] || 'Deselect All'}\n              </button>\n            </div>\n          )}\n        </div>\n        \n        {showBulkReplant && (\n          <div style={{ display: 'flex', marginBottom: '10px', fontSize: '14px', fontWeight: 'bold' }}>\n            <div style={{ width: '30px', paddingLeft: '5px' }}>{strings[342] || 'Harvest?'}</div>\n            <div style={{ flex: 1 }}></div>\n            <div style={{ width: '140px', textAlign: 'center' }}>{strings[343] || 'Replant?'}</div>\n          </div>\n        )}\n        \n        <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n          {crops.map(crop => {\n            // Check if player has required skill\n            const hasSkill = hasRequiredSkill(crop.replantRequires);\n            \n            // Check if crop is in season\n            let isInSeason = true;\n            if (currentSeason && masterResources) {\n              // Find the farmplot that produces this crop to check its season\n              const farmplot = masterResources.find(r => \n                r.category === 'farmplot' && r.output === crop.type\n              );\n              if (farmplot && farmplot.season) {\n                isInSeason = farmplot.season === currentSeason;\n              }\n            }\n            \n            const canReplant = hasSkill && isInSeason;\n            return (\n              <div key={crop.type} style={{ display: 'flex', alignItems: 'center', marginBottom: '8px', padding: '5px', borderBottom: '1px solid #eee' }}>\n                <div style={{ width: '30px' }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedCropTypes[crop.type] || false}\n                    onChange={() => handleToggleCrop(crop.type)}\n                    style={{ width: '20px' }}\n                  />\n                </div>\n                <div style={{ flex: 1, textAlign: 'left' }}>\n                  {crop.symbol} {getLocalizedString(crop.type, strings)} ({crop.count})\n                </div>\n                {showBulkReplant && (() => {\n                  return (\n                    <div style={{ marginLeft: '60px', width: '100px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                      {!isInSeason && (\n                        <span style={{ fontSize: '12px', color: '#888', marginRight: '5px' }}>off season</span>\n                      )}\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedReplantTypes[crop.type] || false}\n                        onChange={() => canReplant && handleToggleReplant(crop.type)}\n                        disabled={!canReplant}\n                        style={{ \n                          width: '20px',\n                          opacity: canReplant ? 1 : 0.5,\n                          cursor: canReplant ? 'pointer' : 'not-allowed'\n                        }}\n                        title={canReplant ? '' : (!isInSeason ? `${crop.type} is not available in current season` : `Requires ${crop.replantRequires || 'unknown skill'} to replant ${crop.type}`)}\n                      />\n                    </div>\n                  );\n                })()}\n              </div>\n            );\n          })}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className={`btn-basic ${isProcessing ? 'btn-neutral' : 'btn-success'} btn-modal`}\n            onClick={handleExecute}\n            disabled={isProcessing || Object.values(selectedCropTypes).every(selected => !selected)}\n          >\n            {isProcessing ? 'Processing...' : (strings[318] || 'Harvest Selected')}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk harvest\nexport async function executeBulkHarvest({\n  selectedCropTypes,\n  selectedReplantTypes,\n  resources,\n  masterResources,\n  masterSkills,\n  currentPlayer,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  setResources,\n  gridId,\n  showBulkReplant,\n  strings,\n  refreshPlayerAfterInventoryUpdate,\n  globalTuning\n}) {\n  // Get selected crop types\n  const selectedTypes = Object.keys(selectedCropTypes).filter(type => selectedCropTypes[type]);\n  \n  if (selectedTypes.length === 0) {\n    return { success: false, error: strings[449] || 'No crops selected for harvest.' };\n  }\n  \n  // Sync FarmState before proceeding to ensure client/server consistency\n  const farmState = await import('../../FarmState').then(m => m.default);\n  \n  await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n  \n  // Get fresh resources after initial sync\n  const GlobalGridStateTilesAndResources = await import('../../GridState/GlobalGridStateTilesAndResources').then(m => m.default);\n  let currentResources = GlobalGridStateTilesAndResources.getResources();\n  \n  // Find all farmplots that might still be converting to crops\n  const pendingFarmplots = currentResources.filter(res => {\n    if (res.category === 'farmplot' && res.growEnd) {\n      const now = Date.now();\n      return res.growEnd <= now; // Should have converted but might not be synced yet\n    }\n    return false;\n  });\n  \n  if (pendingFarmplots.length > 0) {\n    // Wait up to 5 seconds for conversions to complete\n    let attempts = 0;\n    const maxAttempts = 50;\n    \n    while (attempts < maxAttempts) {\n      await new Promise(resolve => setTimeout(resolve, 100));\n      attempts++;\n      \n      // Get fresh resources\n      currentResources = GlobalGridStateTilesAndResources.getResources();\n      \n      // Check if all pending farmplots have been converted\n      const stillPending = pendingFarmplots.filter(farmplot => {\n        const resourceAtPosition = currentResources.find(res => \n          res.x === farmplot.x && res.y === farmplot.y\n        );\n        \n        if (!resourceAtPosition) return false;\n        \n        if (resourceAtPosition.category === 'farmplot' && resourceAtPosition.growEnd) {\n          return true; // Still a farmplot waiting to convert\n        }\n        \n        return false;\n      });\n      \n      if (stillPending.length === 0) {\n        break;\n      }\n    }\n    \n    if (attempts === maxAttempts) {\n      // One more force sync attempt\n      await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n      await new Promise(resolve => setTimeout(resolve, 200));\n    }\n  }\n  \n  // Final sync to catch any last-minute conversions\n  await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n  await new Promise(resolve => setTimeout(resolve, 100));\n  \n  // Final resource fetch\n  const freshResources = GlobalGridStateTilesAndResources.getResources();\n  \n\n  // First, calculate capacity to check if we can harvest\n  const capacityCheck = await calculateBulkHarvestCapacity(\n    selectedTypes,\n    freshResources,  // Use the fresh resources we just validated\n    masterResources,\n    masterSkills,\n    currentPlayer,\n    globalTuning\n  );\n  \n\n  // Check if we have enough space\n  if (!capacityCheck.canHarvest) {\n    const spaceNeeded = capacityCheck.totalCapacityNeeded;\n    const spaceAvailable = capacityCheck.availableSpace;\n    return { \n      success: false, \n      error: `${strings[447] || 'Not enough space'}: ${spaceNeeded} needed, ${spaceAvailable} available` \n    };\n  }\n\n  // If replanting, check seeds\n  if (showBulkReplant && !capacityCheck.canReplantAll) {\n    const missingSeeds = Object.entries(capacityCheck.hasEnoughSeeds)\n      .filter(([_, data]) => !data.enough)\n      .map(([type, data]) => `${getLocalizedString(type, strings)}: ${data.needed - data.has} more needed`)\n      .join(', ');\n    \n    // Still proceed with harvest, but warn about replanting\n    console.log(` Not enough seeds for replanting: ${missingSeeds}`);\n  }\n\n  // Build operations for API call\n  const operations = buildBulkHarvestOperations(capacityCheck, selectedReplantTypes);\n  \n  // Generate transaction ID for idempotency\n  const transactionId = `bulk-harvest-${currentPlayer._id}-${Date.now()}`;\n  const transactionKey = `bulk-harvest-${gridId}`;\n\n  // Make the bulk harvest API call\n  try {\n    const response = await axios.post(`${API_BASE}/api/bulk-harvest`, {\n      playerId: currentPlayer._id,\n      gridId: gridId,\n      operations: operations,\n      transactionId: transactionId,\n      transactionKey: transactionKey\n    });\n\n\n    if (response.data.success) {\n      const results = response.data.results;\n    \n    // Update local inventory state\n    if (response.data.inventory) {\n      setInventory(response.data.inventory.warehouse || []);\n      setBackpack(response.data.inventory.backpack || []);\n      \n      // Update player state with new inventory\n      setCurrentPlayer(prev => ({\n        ...prev,\n        inventory: response.data.inventory.warehouse || [],\n        backpack: response.data.inventory.backpack || []\n      }));\n    }\n\n    // Remove harvested resources from local state\n    const harvestedPositions = new Set();\n    if (results.harvested) {\n      Object.values(results.harvested).forEach(data => {\n        if (data && data.positions && Array.isArray(data.positions)) {\n          data.positions.forEach(pos => harvestedPositions.add(`${pos.x},${pos.y}`));\n        }\n      });\n    }\n    \n    \n    const updatedResources = freshResources.filter(res => \n      !harvestedPositions.has(`${res.x},${res.y}`)\n    );\n    \n    // Add replanted resources\n    if (results.replanted) {\n      Object.entries(results.replanted).forEach(([cropType, data]) => {\n        \n        // Find the farmplot that produces this crop\n        const farmplot = masterResources.find(r => \n          r.category === 'farmplot' && r.output === cropType\n        );\n        \n        if (farmplot && data.positions && Array.isArray(data.positions)) {\n          data.positions.forEach((pos, index) => {\n            // Calculate growEnd from current time + growtime\n            // The server gives us growtime in seconds, but we need milliseconds\n            const growTimeMs = (data.growtime || farmplot.growtime || 300) * 1000;\n            const growEnd = Date.now() + growTimeMs;\n            \n            \n            // Create the farmplot resource with all necessary properties\n            updatedResources.push({\n              ...farmplot, // Include all properties from the farmplot template\n              x: pos.x,\n              y: pos.y,\n              type: farmplot.type, // This will be \"Wheat Plot\", not \"Wheat\"\n              growEnd: growEnd,\n              stage: 1,\n              category: 'farmplot', // Ensure category is set\n              output: farmplot.output // Ensure output is set for crop conversion\n            });\n          });\n        }\n      });\n    }\n    \n    GlobalGridStateTilesAndResources.setResources(updatedResources);\n    setResources(updatedResources);\n    \n    // Re-initialize FarmState with the updated resources\n    farmState.initializeFarmState(updatedResources);\n\n    // Calculate which skills were applied for each harvested type using shared utility\n    const harvestSkillsInfo = {};\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([cropType, data]) => {\n        if (data) {\n          const skillInfo = calculateSkillMultiplier(cropType, currentPlayer.skills || [], masterSkills);\n          if (skillInfo.hasSkills) {\n            harvestSkillsInfo[cropType] = skillInfo;\n          }\n        }\n      });\n    }\n    \n    // Transform harvest results to simple format for shared formatter\n    const harvestResults = {};\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (data && typeof data.quantity !== 'undefined') {\n          harvestResults[type] = data.quantity;\n        }\n      });\n    }\n    \n    \n    // Transform replant info\n    const replantInfo = {};\n    if (results.replanted) {\n      Object.entries(results.replanted).forEach(([type, data]) => {\n        replantInfo[type] = data.count;\n      });\n    }\n\n    // Calculate warehouse ingredient drops based on number of non-Wheat plots harvested (not skill-modified quantities)\n    // Exclude Wheat to prevent exploit\n    let numPlotsHarvestedExcludingWheat = 0;\n    if (results.harvested) {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (type !== 'Wheat' && data && data.positions && Array.isArray(data.positions)) {\n          numPlotsHarvestedExcludingWheat += data.positions.length;\n        }\n      });\n    }\n    \n    console.log(' Calculating warehouse drops for', numPlotsHarvestedExcludingWheat, 'non-Wheat plots harvested');\n    const warehouseDropsArray = calculateBulkWarehouseDrops(numPlotsHarvestedExcludingWheat, {\n      masterResources,\n      globalTuning,\n      selectWeightedRandomItem,\n      playerId: currentPlayer.playerId\n    });\n    \n    // Aggregate warehouse drops by type\n    const aggregatedWarehouseDrops = aggregateWarehouseDrops(warehouseDropsArray);\n    console.log(' Aggregated warehouse drops:', aggregatedWarehouseDrops);\n\n    // Add warehouse ingredients to inventory if any were found\n    if (warehouseDropsArray.length > 0) {\n      try {\n        for (const drop of warehouseDropsArray) {\n          const warehouseGained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: drop.type,\n            quantity: drop.quantity,\n            inventory: response.data.inventory?.warehouse || [],\n            backpack: response.data.inventory?.backpack || [],\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus: () => {}, // No status updates during bulk operation\n            masterResources,\n            globalTuning,\n          });\n\n          if (warehouseGained) {\n            console.log(` Added warehouse ingredient: ${drop.type} x${drop.quantity}`);\n            \n            // Track quest progress for warehouse ingredients\n            await trackQuestProgress(currentPlayer, 'Collect', drop.type, drop.quantity, setCurrentPlayer);\n          } else {\n            console.warn(` Failed to add warehouse ingredient: ${drop.type} x${drop.quantity} (inventory full?)`);\n          }\n        }\n      } catch (error) {\n        console.error(' Error adding warehouse ingredients to inventory:', error);\n      }\n    }\n\n    // Track quest progress for harvested items\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (data && data.quantity) {\n          trackQuestProgress({\n            questProgressCategory: 'collect',\n            itemName: type,\n            quantity: data.quantity,\n            currentPlayer,\n            setCurrentPlayer,\n            masterResources\n          });\n        }\n      });\n    }\n\n    // Track quest progress for seeds used in replanting\n    Object.entries(results.seedsUsed || {}).forEach(([type, quantity]) => {\n      trackQuestProgress({\n        questProgressCategory: 'spend',\n        itemName: type,\n        quantity: quantity,\n        currentPlayer,\n        setCurrentPlayer,\n        masterResources\n      });\n    });\n    \n    // Return results object for modal display instead of status message\n    return {\n      success: true,\n      harvestResults,\n      replantInfo,\n      harvestSkillsInfo,\n      warehouseDrops: aggregatedWarehouseDrops,\n      seedsUsed: results.seedsUsed || {},\n      statusMessage: formatCollectionResults('harvest', harvestResults, harvestSkillsInfo, replantInfo, strings, getLocalizedString)\n    };\n  } else {\n    return { success: false, error: strings[448] || 'Bulk harvest failed' };\n  }\n  } catch (error) {\n    console.error(' Bulk harvest error:', error);\n    return { \n      success: false, \n      error: error.response?.data?.message || error.message || 'Bulk harvest failed' \n    };\n  }\n}\n\n// Function to prepare crops for the modal\nexport function prepareBulkHarvestData(resources, masterResources) {\n  // Group crops by type\n  const cropCounts = {};\n  \n  const readyCrops = resources.filter(res => {\n    // Check if this resource is a crop\n    const isCrop = isACrop(res.type, masterResources);\n    \n    \n    return isCrop;\n  });\n\n  readyCrops.forEach((crop) => {\n    if (!cropCounts[crop.type]) {\n      const baseCrop = masterResources.find(r => r.type === crop.type);\n      const farmplot = masterResources.find(r => \n        r.category === 'farmplot' && r.output === crop.type\n      );\n      cropCounts[crop.type] = {\n        count: 0,\n        symbol: baseCrop?.symbol || '',\n        replantRequires: farmplot?.requires\n      };\n    }\n    cropCounts[crop.type].count++;\n  });\n\n  // Convert to array format\n  const result = Object.entries(cropCounts).map(([type, data]) => ({\n    type,\n    count: data.count,\n    symbol: data.symbol,\n    replantRequires: data.replantRequires\n  }));\n  \n  return result;\n}","import { deriveWarehouseAndBackpackCapacity, calculateSkillMultiplier, isCurrency } from '../../Utils/InventoryManagement';\n\n/**\n * Calculate total capacity needed for bulk harvest operation\n * @param {Array} selectedTypes - Array of crop types to harvest\n * @param {Array} resources - Current grid resources\n * @param {Array} masterResources - Master resource definitions\n * @param {Object} masterSkills - Master skill definitions\n * @param {Object} currentPlayer - Current player data\n * @param {Object} globalTuning - Global tuning configuration\n * @returns {Object} Capacity check results\n */\nexport async function calculateBulkHarvestCapacity(\n  selectedTypes, \n  resources, \n  masterResources, \n  masterSkills, \n  currentPlayer,\n  globalTuning\n) {\n  let totalCapacityNeeded = 0;\n  const harvestDetails = [];\n  \n  // Get player's current inventory usage (exclude currencies from capacity calculations)\n  const currentWarehouseUsage = (currentPlayer.inventory || [])\n    .filter(item => !isCurrency(item.type))\n    .reduce((sum, item) => sum + (item.quantity || 0), 0);\n  const currentBackpackUsage = (currentPlayer.backpack || [])\n    .filter(item => !isCurrency(item.type))\n    .reduce((sum, item) => sum + (item.quantity || 0), 0);\n  \n  // Get total capacities with skills using the existing function\n  const capacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n  const warehouseCapacity = capacities.warehouse || 0;\n  const backpackCapacity = capacities.backpack || 0;\n  \n  const totalCapacity = warehouseCapacity + backpackCapacity;\n  const currentTotalUsage = currentWarehouseUsage + currentBackpackUsage;\n  const availableSpace = totalCapacity - currentTotalUsage;\n  \n  \n  // Calculate yield for each crop type\n  for (const cropType of selectedTypes) {\n    const crops = resources.filter(res => res.type === cropType);\n    if (crops.length === 0) continue;\n    \n    const baseCrop = masterResources.find(r => r.type === cropType);\n    if (!baseCrop) continue;\n    \n    // Use shared utility for skill calculations\n    const skillInfo = calculateSkillMultiplier(cropType, currentPlayer.skills || [], masterSkills);\n    \n    const baseYield = baseCrop.qtycollected || 1;\n    const yieldPerCrop = Math.floor(baseYield * skillInfo.multiplier);\n    const totalYield = crops.length * yieldPerCrop;\n    \n    harvestDetails.push({\n      type: cropType,\n      count: crops.length,\n      baseYield,\n      skillMultiplier: skillInfo.multiplier,\n      skillInfo,\n      yieldPerCrop,\n      totalYield,\n      positions: crops.map(c => ({ x: c.x, y: c.y })),\n      symbol: baseCrop.symbol || ''\n    });\n    \n    totalCapacityNeeded += totalYield;\n  }\n  \n  // Calculate seeds needed for replanting\n  const replantDetails = [];\n  const seedsNeeded = {};\n  \n  for (const detail of harvestDetails) {\n    // Find the farmplot that produces this crop\n    const farmplot = masterResources.find(r => \n      r.category === 'farmplot' && r.output === detail.type\n    );\n    \n    if (farmplot) {\n      // Check if this farmplot requires seeds (has ingredient cost)\n      for (let i = 1; i <= 4; i++) {\n        const ingredientType = farmplot[`ingredient${i}`];\n        const ingredientQty = farmplot[`ingredient${i}qty`];\n        \n        if (ingredientType && ingredientQty) {\n          const totalNeeded = ingredientQty * detail.count;\n          seedsNeeded[ingredientType] = (seedsNeeded[ingredientType] || 0) + totalNeeded;\n        }\n      }\n      \n      replantDetails.push({\n        farmplotType: farmplot.type,\n        cropType: detail.type,\n        count: detail.count,\n        positions: detail.positions,\n        growtime: farmplot.growtime || 60\n      });\n    }\n  }\n  \n  // Check if player has enough seeds\n  const hasEnoughSeeds = {};\n  let canReplantAll = true;\n  \n  Object.entries(seedsNeeded).forEach(([seedType, needed]) => {\n    const inInventory = currentPlayer.inventory?.find(item => item.type === seedType)?.quantity || 0;\n    const inBackpack = currentPlayer.backpack?.find(item => item.type === seedType)?.quantity || 0;\n    const totalHas = inInventory + inBackpack;\n    \n    hasEnoughSeeds[seedType] = {\n      needed,\n      has: totalHas,\n      enough: totalHas >= needed\n    };\n    \n    if (totalHas < needed) {\n      canReplantAll = false;\n    }\n  });\n  \n  return {\n    canHarvest: availableSpace >= totalCapacityNeeded,\n    totalCapacityNeeded,\n    availableSpace,\n    currentTotalUsage,\n    totalCapacity,\n    warehouseCapacity,\n    backpackCapacity,\n    harvestDetails,\n    replantDetails,\n    seedsNeeded,\n    hasEnoughSeeds,\n    canReplantAll\n  };\n}\n\n/**\n * Build operations array for bulk harvest API call\n * @param {Object} capacityCheck - Results from calculateBulkHarvestCapacity\n * @param {Object} selectedReplantTypes - Which crops to replant\n * @returns {Array} Operations array for API\n */\nexport function buildBulkHarvestOperations(capacityCheck, selectedReplantTypes) {\n  const operations = [];\n  \n  // Group by crop type for efficiency\n  capacityCheck.harvestDetails.forEach(detail => {\n    const shouldReplant = selectedReplantTypes[detail.type] || false;\n    \n    operations.push({\n      cropType: detail.type,\n      positions: detail.positions,\n      replant: shouldReplant,\n      expectedYield: detail.totalYield\n    });\n  });\n  \n  return operations;\n}\n\n","import React from 'react';\nimport Modal from '../../UI/Modal';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/SharedButtons.css';\nimport './BulkHarvestResultsModal.css';\n\n/**\n * Modal to display results of bulk harvest operation\n * Shows harvested crops, replanted seeds, warehouse ingredients, and skills applied\n */\nexport function BulkHarvestResultsModal({ \n  isOpen, \n  onClose, \n  results,\n  strings,\n  masterResources\n}) {\n  if (!isOpen || !results) return null;\n\n  const { \n    harvestResults = {}, \n    replantInfo = {}, \n    harvestSkillsInfo = {}, \n    warehouseDrops = {},\n    seedsUsed = {}\n  } = results;\n\n  // Check if we have any content to show\n  const hasHarvestResults = Object.keys(harvestResults).length > 0;\n  const hasReplantInfo = Object.keys(replantInfo).length > 0;\n  const hasWarehouseDrops = Object.keys(warehouseDrops).length > 0;\n  const hasSkillsApplied = Object.keys(harvestSkillsInfo).length > 0;\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={onClose} \n      title={strings[356] || \"Bulk Harvest Results\"} \n      size=\"medium\"\n      className=\"bulk-harvest-results-modal\"\n    >\n      <div className=\"bulk-harvest-results-content\">\n        \n        {/* Harvested Crops Section */}\n        {hasHarvestResults && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header crops\">\n               {strings[357] || \"Crops Harvested\"}\n            </h3>\n            <div className=\"crop-rows\">\n              {Object.entries(harvestResults).map(([cropType, quantity]) => {\n                const skillInfo = harvestSkillsInfo[cropType];\n                const hasSkillBonus = skillInfo && skillInfo.hasSkills;\n                \n                // Find the crop symbol from masterResources\n                const cropResource = masterResources?.find(r => r.type === cropType);\n                const cropSymbol = cropResource?.symbol || '';\n                \n                return (\n                  <div key={cropType} className=\"crop-row\">\n                    <span className=\"crop-symbol\">{cropSymbol}</span>\n                    <span className=\"crop-name\">{getLocalizedString(cropType, strings)}</span>\n                    <span className=\"crop-quantity\">+{quantity}</span>\n                    {hasSkillBonus && (\n                      <span className=\"crop-skills\">\n                        Skills applied ({skillInfo.multiplier}x): {skillInfo.skills.join(', ')}\n                      </span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Replanted Seeds Section */}\n        {hasReplantInfo && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header replanting\">\n               {strings[358] || \"Crops Replanted\"}\n            </h3>\n            <div className=\"replant-rows\">\n              {Object.entries(replantInfo).map(([cropType, count]) => {\n                // Find the crop symbol from masterResources\n                const cropResource = masterResources?.find(r => r.type === cropType);\n                const cropSymbol = cropResource?.symbol || '';\n                const seedsUsedForCrop = seedsUsed[cropType];\n                \n                return (\n                  <div key={cropType} className=\"replant-row\">\n                    <span className=\"replant-symbol\">{cropSymbol}</span>\n                    <span className=\"replant-name\">{getLocalizedString(cropType, strings)}</span>\n                    <span className=\"replant-quantity\">{count} plots</span>\n                    {seedsUsedForCrop && (\n                      <span className=\"replant-seeds-used\">\n                        {strings[361] || \"Seeds used\"}: -{seedsUsedForCrop}\n                      </span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Warehouse Ingredients Section */}\n        {hasWarehouseDrops && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header warehouse\">\n               {strings[359] || \"Warehouse Ingredients Found\"}\n            </h3>\n            <div className=\"results-grid-warehouse\">\n              {Object.entries(warehouseDrops).map(([ingredientType, data]) => (\n                <div key={ingredientType} className=\"result-item warehouse\">\n                  <div className=\"result-item-label\">\n                    <span className=\"result-item-name\">\n                      {data.symbol} {getLocalizedString(ingredientType, strings)}\n                    </span>\n                  </div>\n                  <span className=\"result-item-quantity warehouse\">+{data.quantity}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Close Button - using shared button styles */}\n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', marginTop: '20px' }}>\n          <button \n            onClick={onClose}\n            className=\"btn-basic btn-success\"\n            style={{ fontSize: '16px', padding: '10px 20px' }}\n          >\n            {strings[360] || \"Continue\"}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default BulkHarvestResultsModal;","import React, { useState } from 'react';\nimport Modal from '../../UI/Modal';\nimport { handleNPCClick } from '../NPCs/NPCUtils';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport '../../UI/SharedButtons.css';\n\n// Component for the bulk animal collection selection modal\nexport function BulkAnimalModal({ \n  isOpen, \n  onClose, \n  animals, \n  onExecute,\n  strings \n}) {\n  const [selectedAnimalTypes, setSelectedAnimalTypes] = useState({});\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && animals.length > 0) {\n      // Select all animals by default\n      const defaultSelection = {};\n      animals.forEach(animal => {\n        defaultSelection[animal.type] = true;\n      });\n      setSelectedAnimalTypes(defaultSelection);\n    }\n  }, [isOpen, animals]);\n\n  const handleToggleAnimal = (animalType) => {\n    setSelectedAnimalTypes(prev => ({\n      ...prev,\n      [animalType]: !prev[animalType]\n    }));\n  };\n\n  const handleExecute = () => {\n    onExecute();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[319] || \"Select Animals to Collect\"} size=\"medium\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>           \n        <div className=\"shared-buttons\" style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal-small\"\n            onClick={() => {\n              const allSelected = {};\n              animals.forEach(animal => {\n                allSelected[animal.type] = true;\n              });\n              setSelectedAnimalTypes(allSelected);\n            }}\n          >\n            {strings[316] || 'Select All'}\n          </button>\n          <button \n            className=\"btn-basic btn-danger btn-modal-small\"\n            onClick={() => setSelectedAnimalTypes({})}\n          >\n            {strings[317] || 'Deselect All'}\n          </button>\n        </div>\n        \n        <div style={{ marginBottom: '20px' }}>\n          {animals.map((animal, index) => (\n            <div key={animal.type} style={{ \n              display: 'flex', \n              alignItems: 'center', \n              marginBottom: '10px',\n              padding: '5px',\n              backgroundColor: index % 2 === 0 ? 'transparent' : '#f0f0f0'\n            }}>\n              <input\n                type=\"checkbox\"\n                checked={selectedAnimalTypes[animal.type] || false}\n                onChange={(e) => {\n                  setSelectedAnimalTypes(prev => ({\n                    ...prev,\n                    [animal.type]: e.target.checked\n                  }));\n                }}\n                style={{ marginRight: '10px' }}\n              />\n              <span>{animal.symbol} {getLocalizedString(animal.type, strings)} ({animal.count})</span>\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal\"\n            onClick={handleExecute}\n            disabled={Object.values(selectedAnimalTypes).every(selected => !selected)}\n          >\n            {strings[318] || 'Collect Selected'}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk animal collection\nexport async function executeBulkAnimalCollect({\n  selectedAnimalTypes,\n  gridId,\n  currentPlayer,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  strings\n}) {\n  // Get selected animal types\n  const selectedTypes = Object.keys(selectedAnimalTypes).filter(type => selectedAnimalTypes[type]);\n  \n  if (selectedTypes.length === 0) {\n    return 'No animals selected for collection.';\n  }\n\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const animalsToCollect = npcs.filter(npc => \n    npc.state === 'processing' && selectedTypes.includes(npc.type)\n  );\n\n  const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n  const successfulCollects = {};\n  const animalSkillsInfo = {};\n\n  // Process each animal\n  for (const npc of animalsToCollect) {\n    const result = await handleNPCClick(\n      npc,\n      npc.position.y,\n      npc.position.x,\n      setInventory,\n      setBackpack,  \n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      TILE_SIZE,\n      masterResources,\n      masterSkills,\n      gridId,\n      () => {}, // setModalContent (not used here)\n      () => {}, // setIsModalOpen (not used here)\n      updateStatus,\n      () => {}, // openPanel (not used here)\n      () => {}, // setActiveStation (not used here)\n      strings\n    );\n\n    // Check if collection was successful\n    if (result && result.type === 'success' && result.collectedItem) {\n      const { collectedItem, collectedQuantity, skillsApplied } = result;\n      \n      // Track successful collects\n      successfulCollects[collectedItem] = (successfulCollects[collectedItem] || 0) + collectedQuantity;\n      \n      // Track skill info for this item type - use what server provided\n      if (!animalSkillsInfo[collectedItem] && skillsApplied && skillsApplied.length > 0) {\n        // The server already tells us which skills were applied\n        // We need to calculate the multiplier from the quantity\n        // Each animal gives base 1, so multiplier = collectedQuantity / 1\n        const multiplier = collectedQuantity;\n        \n        animalSkillsInfo[collectedItem] = {\n          skills: skillsApplied,\n          multiplier: multiplier,\n          hasSkills: true\n        };\n      }\n    }\n    \n    await wait(100); // avoid overloading server\n  }\n\n  // Small delay to ensure all state updates have propagated\n  await wait(100);\n  \n  // Refresh player data from server, including fresh inventory\n  await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer, false);\n\n  // Use shared formatter for status message\n  if (Object.keys(successfulCollects).length > 0) {\n    const statusMessage = formatCollectionResults('animal', successfulCollects, animalSkillsInfo, null, strings, getLocalizedString);\n    return statusMessage;\n  } else {\n    return 'Failed to collect from any animals.';\n  }\n}\n\n// Function to prepare animal data for the modal\nexport function prepareBulkAnimalData(gridId, masterResources) {\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const processingAnimals = npcs.filter(npc => npc.state === 'processing');\n  \n  // Count how many of each animal type is ready\n  const animalCounts = {};\n  processingAnimals.forEach((npc) => {\n    animalCounts[npc.type] = (animalCounts[npc.type] || 0) + 1;\n  });\n\n  // Create array of available animals with counts and symbols\n  return Object.entries(animalCounts).map(([animalType, count]) => {\n    const resourceDef = masterResources.find(res => res.type === animalType);\n    return {\n      type: animalType,\n      count,\n      symbol: resourceDef?.symbol || ''\n    };\n  });\n}","import React, { useState } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport Modal from '../../UI/Modal';\nimport { canAfford, spendIngredients, gainIngredients, calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults, formatRestartResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport '../../UI/SharedButtons.css';\n\n// Component for the bulk crafting selection modal\nexport function BulkCraftingModal({ \n  isOpen, \n  onClose, \n  stationGroups, \n  onExecute,\n  hasBulkRestartCraft,\n  strings,\n  masterResources,\n  inventory,\n  backpack \n}) {\n  const [selectedGroups, setSelectedGroups] = useState([]);\n  const [selectedRestartStations, setSelectedRestartStations] = useState({});\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && stationGroups.length > 0) {\n      // Select all station groups by default\n      setSelectedGroups(stationGroups);\n      \n      // Select all restart options by default (if bulk restart skill is available)\n      if (hasBulkRestartCraft) {\n        const defaultRestartSelection = {};\n        stationGroups.forEach(group => {\n          if (group.canRestart) {\n            const key = `${group.stationType}-${group.craftedItem}`;\n            defaultRestartSelection[key] = true;\n          }\n        });\n        setSelectedRestartStations(defaultRestartSelection);\n      }\n    }\n  }, [isOpen, stationGroups, hasBulkRestartCraft]);\n\n  const handleToggleGroup = (group) => {\n    setSelectedGroups(prev => {\n      const isSelected = prev.some(g => \n        g.stationType === group.stationType && g.craftedItem === group.craftedItem\n      );\n      \n      if (isSelected) {\n        // If unchecking collect, also uncheck restart\n        const key = `${group.stationType}-${group.craftedItem}`;\n        setSelectedRestartStations(restartPrev => ({\n          ...restartPrev,\n          [key]: false\n        }));\n        \n        return prev.filter(g => \n          !(g.stationType === group.stationType && g.craftedItem === group.craftedItem)\n        );\n      } else {\n        return [...prev, group];\n      }\n    });\n  };\n\n  const handleToggleRestart = (group) => {\n    const key = `${group.stationType}-${group.craftedItem}`;\n    setSelectedRestartStations(prev => {\n      const newValue = !prev[key];\n      // If checking restart, also check collect\n      if (newValue) {\n        setSelectedGroups(groupsPrev => {\n          const isAlreadySelected = groupsPrev.some(g => \n            g.stationType === group.stationType && g.craftedItem === group.craftedItem\n          );\n          if (!isAlreadySelected) {\n            return [...groupsPrev, group];\n          }\n          return groupsPrev;\n        });\n      }\n      return {\n        ...prev,\n        [key]: newValue\n      };\n    });\n  };\n\n  const handleExecute = () => {\n    onExecute(selectedGroups, selectedRestartStations);\n  };\n\n  const isGroupSelected = (group) => {\n    return selectedGroups.some(g => \n      g.stationType === group.stationType && g.craftedItem === group.craftedItem\n    );\n  };\n\n  if (!isOpen) return null;\n\n  const getRestartLabel = (group) => {\n    if (!hasBulkRestartCraft) {\n      return strings[345] || 'Requires skill';\n    }\n    if (!group.canRestart) {\n      return strings[346] || 'Locked';\n    }\n    if (!group.affordable) {\n      return null;  // Don't show text for insufficient ingredients\n    }\n    return null;\n  };\n\n  const isRestartDisabled = (group) => {\n    return !hasBulkRestartCraft || !group.canRestart || !group.affordable;\n  };\n\n  // Calculate total ingredient needs for a group\n  const calculateGroupNeeds = (group) => {\n    if (!group.recipe || !group.stationCount) return null;\n    \n    const needs = {};\n    \n    // Calculate needs for each ingredient\n    for (let i = 1; i <= 4; i++) {\n      const ingredientType = group.recipe[`ingredient${i}`];\n      const ingredientQty = group.recipe[`ingredient${i}qty`];\n      \n      if (ingredientType && ingredientQty) {\n        const totalNeeded = ingredientQty * group.stationCount;\n        const inventoryQty = inventory?.find(item => item.type === ingredientType)?.quantity || 0;\n        const backpackQty = backpack?.find(item => item.type === ingredientType)?.quantity || 0;\n        const totalAvailable = inventoryQty + backpackQty;\n        \n        needs[ingredientType] = {\n          needed: totalNeeded,\n          available: totalAvailable,\n          symbol: masterResources.find(r => r.type === ingredientType)?.symbol || ''\n        };\n      }\n    }\n    \n    return needs;\n  };\n\n  const selectAll = () => {\n    setSelectedGroups(stationGroups);\n  };\n\n  const selectNone = () => {\n    setSelectedGroups([]);\n    // When deselecting all collections, also deselect all restarts\n    setSelectedRestartStations({});\n  };\n\n  const selectAllRestarts = () => {\n    const allRestartSelection = {};\n    const groupsToSelect = [];\n    stationGroups.forEach(group => {\n      if (group.canRestart && group.affordable) {\n        const key = `${group.stationType}-${group.craftedItem}`;\n        allRestartSelection[key] = true;\n        // Also select the group for collection\n        if (!isGroupSelected(group)) {\n          groupsToSelect.push(group);\n        }\n      }\n    });\n    setSelectedRestartStations(prev => ({\n      ...prev,\n      ...allRestartSelection\n    }));\n    setSelectedGroups(prev => [...prev, ...groupsToSelect]);\n  };\n\n  const selectNoneRestarts = () => {\n    setSelectedRestartStations({});\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[341] || \"Select Crafting Stations to Collect:\"} size=\"large\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>\n        <div style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px' }}>\n            <button \n              className=\"btn-basic btn-success btn-modal-small\"\n              onClick={selectAll}\n            >\n              {strings[316] || 'Select All'}\n            </button>\n            <button \n              className=\"btn-basic btn-neutral btn-modal-small\"\n              onClick={selectNone}\n            >\n              {strings[317] || 'Deselect All'}\n            </button>\n          </div>\n          \n          {hasBulkRestartCraft && (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', marginLeft: 'auto', marginRight: '20px' }}>\n              <button \n                className=\"btn-basic btn-success btn-modal-small\"\n                onClick={selectAllRestarts}\n              >\n                {strings[316] || 'Select All'}\n              </button>\n              <button \n                className=\"btn-basic btn-neutral btn-modal-small\"\n                onClick={selectNoneRestarts}\n              >\n                {strings[317] || 'Deselect All'}\n              </button>\n            </div>\n          )}\n        </div>\n        \n        <div style={{ display: 'flex', marginBottom: '10px', fontSize: '14px', fontWeight: 'bold' }}>\n          <div style={{ width: '60px', textAlign: 'center' }}>{strings[346] || 'Collect?'}</div>\n          <div style={{ width: '200px', textAlign: 'left', paddingLeft: '10px' }}>{strings[476] || 'Station'}</div>\n          <div style={{ width: '270px', textAlign: 'left' }}>{strings[161] || 'Item'}</div>\n          {hasBulkRestartCraft && (\n            <div style={{ width: '80px', textAlign: 'center' }}>{strings[475]}</div>\n          )}\n          <div style={{ width: '150px', textAlign: 'center' }}>{strings[177]}</div>\n        </div>\n        \n        <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n          {stationGroups.map((group, index) => {\n            const key = `${group.stationType}-${group.craftedItem}`;\n            const needs = calculateGroupNeeds(group);\n            return (\n              <div key={index} style={{ display: 'flex', alignItems: 'center', marginBottom: '8px', padding: '5px', borderBottom: '1px solid #eee' }}>\n                <div style={{ width: '60px', textAlign: 'center' }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={isGroupSelected(group)}\n                    onChange={() => handleToggleGroup(group)}\n                    style={{ width: '20px' }}\n                  />\n                </div>\n                <div style={{ width: '200px', textAlign: 'left', fontWeight: 'bold', paddingLeft: '10px' }}>\n                  {group.stationSymbol} {getLocalizedString(group.stationType, strings)}\n                </div>\n                <div style={{ width: '270px', textAlign: 'left' }}>\n                  {group.craftedSymbol} {getLocalizedString(group.craftedItem, strings)} ({group.stationCount})\n                </div>\n                {hasBulkRestartCraft ? (() => {\n                  const restartLabel = getRestartLabel(group);\n                  return (\n                    <div style={{ marginLeft: '0px', width: '80px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedRestartStations[key] || false}\n                        onChange={() => !isRestartDisabled(group) && handleToggleRestart(group)}\n                        disabled={isRestartDisabled(group)}\n                        style={{ \n                          width: '20px',\n                          opacity: isRestartDisabled(group) ? 0.5 : 1,\n                          cursor: isRestartDisabled(group) ? 'not-allowed' : 'pointer'\n                        }}\n                        title={restartLabel || ''}\n                      />\n                      {restartLabel && (\n                        <span style={{ fontSize: '11px', color: 'red', marginTop: '2px' }}>\n                          {restartLabel}\n                        </span>\n                      )}\n                    </div>\n                  );\n                })() : null}\n                {/* Needs column */}\n                <div style={{ width: '150px', textAlign: 'center', fontSize: '12px' }}>\n                  {needs && Object.entries(needs).map(([type, data], idx) => {\n                    const color = data.available >= data.needed ? 'green' : 'red';\n                    return (\n                      <div key={idx} style={{ color }}>\n                        {data.symbol} {data.needed}/{data.available}\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal\"\n            onClick={handleExecute}\n            disabled={selectedGroups.length === 0}\n          >\n            {strings[318] || 'Collect'}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk crafting collection\nexport async function executeBulkCrafting({\n  selectedGroups,\n  selectedRestartStations,\n  hasBulkRestartCraft,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  setResources,\n  gridId,\n  masterResources,\n  masterSkills,\n  strings,\n  updateStatus,\n  globalTuning\n}) {\n  if (selectedGroups.length === 0) {\n    return 'No crafting stations selected for collection.';\n  }\n\n  // Flatten all selected stations\n  const stationsToCollect = selectedGroups.flatMap(group => group.stations);\n  \n  // Prepare batch data for all stations\n  const batchStations = stationsToCollect.map(station => {\n    const key = `${station.type}-${station.craftedItem}`;\n    const shouldRestart = hasBulkRestartCraft && selectedRestartStations[key];\n    \n    // Find the recipe if we need to restart\n    let restartRecipe = null;\n    if (shouldRestart) {\n      const stationGroup = selectedGroups.find(g => \n        g.stationType === station.type && g.craftedItem === station.craftedItem\n      );\n      if (stationGroup && stationGroup.recipe && stationGroup.affordable) {\n        restartRecipe = stationGroup.recipe;\n      }\n    }\n    \n    return {\n      x: station.x,\n      y: station.y,\n      type: station.type,\n      craftedItem: station.craftedItem,\n      transactionId: `bulk-craft-collect-${Date.now()}-${Math.random()}`,\n      shouldRestart: shouldRestart && restartRecipe !== null,\n      restartRecipe: restartRecipe\n    };\n  });\n  \n  const transactionId = `bulk-craft-collect-${currentPlayer._id}-${Date.now()}`;\n  const transactionKey = `bulk-craft-collect-${gridId}`;\n  \n  // Make single API call for both collection and restart\n  \n  try {\n    const response = await axios.post(`${API_BASE}/api/crafting/collect-bulk`, {\n      playerId: currentPlayer.playerId || currentPlayer._id,\n      gridId,\n      stations: batchStations,\n      transactionId,\n      transactionKey\n    });\n    \n    if (response.data.success && response.data.results) {\n      const results = response.data.results;\n      let updatedResources = [...GlobalGridStateTilesAndResources.getResources()];\n      \n      // Track successful collections and applied skills\n      const successfulCollects = {};\n      const successfulRestarts = {};\n      const appliedSkillsInfo = {};\n      \n      // Process each result and build a map of station updates\n      const stationUpdates = {};\n      \n      for (const result of results) {\n        if (result.collected || result.success) {\n          const { station, collectedItem, craftedItem, isNPC } = result;\n          const itemCollected = collectedItem || craftedItem;\n          const key = `${station.x}-${station.y}`;\n          \n          if (result.restarted && result.newCraftEnd) {\n            // Restarted - update with new craft state\n            stationUpdates[key] = { \n              craftEnd: result.newCraftEnd, \n              craftedItem: result.newCraftedItem || itemCollected \n            };\n          } else {\n            // Just collected - clear craft state\n            stationUpdates[key] = { \n              craftEnd: undefined, \n              craftedItem: undefined \n            };\n          }\n          \n          // Calculate skill info\n          const stationType = station.stationType || station.type;\n          const playerBuffs = (currentPlayer.skills || [])\n            .filter((item) => {\n              const resourceDetails = masterResources.find((res) => res.type === item.type);\n              const isSkill = resourceDetails?.category === 'skill' || resourceDetails?.category === 'upgrade';\n              const appliesToStation = (masterSkills?.[item.type]?.[stationType] || 1) > 1;\n              return isSkill && appliesToStation;\n            })\n            .map((buffItem) => buffItem.type);\n          \n          // Calculate skill multiplier\n          const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n            const buffValue = masterSkills?.[buff]?.[stationType] || 1;\n            return multiplier * buffValue;\n          }, 1);\n          \n          // Base quantity is 1 per crafting station (matching individual crafting)\n          const baseQtyCollected = 1;\n          const finalQtyCollected = baseQtyCollected * skillMultiplier;\n          \n          // Handle NPC spawning\n          if (isNPC) {\n            const craftedResource = masterResources.find(res => res.type === itemCollected);\n            if (craftedResource) {\n              NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: station.x, y: station.y });\n            }\n          } else {\n            // Server doesn't add items - client handles with skill buffs\n            // Track successful collects with skill bonuses\n            successfulCollects[itemCollected] = (successfulCollects[itemCollected] || 0) + finalQtyCollected;\n            \n            // Track skills applied for this item type (only need to do once per item type)\n            if (!appliedSkillsInfo[itemCollected] && playerBuffs.length > 0) {\n              appliedSkillsInfo[itemCollected] = {\n                skills: playerBuffs,\n                multiplier: skillMultiplier,\n                hasSkills: true\n              };\n            }\n          }\n          \n          // Track restart info\n          if (result.restarted) {\n            const restartedItem = result.newCraftedItem || result.restartedItem || itemCollected;\n            if (restartedItem) {\n              successfulRestarts[restartedItem] = (successfulRestarts[restartedItem] || 0) + 1;\n            }\n          }\n        }\n      }\n      \n      // Now apply all station updates in one pass using map pattern (like single crafting)\n      updatedResources = updatedResources.map(res => {\n        const key = `${res.x}-${res.y}`;\n        if (stationUpdates[key]) {\n          return { ...res, ...stationUpdates[key] };\n        }\n        return res;\n      });\n      \n      // Update inventory from server response if provided\n      if (response.data.inventory) {\n        // Update local inventory with what server says we have after spending for restarts\n        setInventory(response.data.inventory.warehouse || response.data.inventory);\n        setBackpack(response.data.inventory.backpack || []);\n        setCurrentPlayer(prev => ({\n          ...prev,\n          inventory: response.data.inventory.warehouse || response.data.inventory,\n          backpack: response.data.inventory.backpack || []\n        }));\n      }\n      \n      // NOW update global resources with all changes (collections + restarts) - ONLY ONCE\n      // Just like single crafting does it - simple and clean\n      GlobalGridStateTilesAndResources.setResources(updatedResources);\n      setResources(updatedResources);\n      \n      // Use fresh inventory state from server response\n      const currentInventory = response.data.inventory?.warehouse || inventory;\n      const currentBackpack = response.data.inventory?.backpack || backpack;\n      \n      // Add collected items to inventory with skills applied\n      for (const [collectedItem, quantity] of Object.entries(successfulCollects)) {\n        await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer: {\n            ...currentPlayer,\n            inventory: currentInventory,\n            backpack: currentBackpack\n          },\n          resource: collectedItem,\n          quantity: quantity,\n          inventory: currentInventory,\n          backpack: currentBackpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n        \n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, quantity, setCurrentPlayer);\n      }\n      \n      // Refresh player state to ensure everything is in sync\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer, false);\n      \n      // Check if we have any successful operations\n      const hasCollections = Object.keys(successfulCollects).length > 0;\n      const hasRestarts = Object.keys(successfulRestarts).length > 0;\n      const totalProcessed = results.filter(r => r.collected || r.success).length;\n      \n      if (hasCollections || hasRestarts) {\n        const parts = [];\n        \n        if (hasCollections) {\n          parts.push(formatCollectionResults('craft', successfulCollects, appliedSkillsInfo, null, strings, getLocalizedString));\n        }\n        \n        if (hasRestarts) {\n          parts.push(formatRestartResults(successfulRestarts, 'craft', strings, getLocalizedString));\n        }\n        \n        return parts.join(' | ');\n      } else if (totalProcessed > 0) {\n        // Items were processed but maybe all were NPCs\n        return `Collected from ${totalProcessed} crafting station${totalProcessed > 1 ? 's' : ''}.`;\n      } else {\n        return 'Failed to collect any crafted items.';\n      }\n    } else {\n      return 'Failed to collect crafted items.';\n    }\n  } catch (error) {\n    console.error(' Bulk crafting error:', error);\n    return error.response?.data?.message || error.message || 'Bulk crafting failed';\n  }\n}\n\n// Function to prepare crafting station data for the modal\nexport function prepareBulkCraftingData(masterResources, inventory, backpack, currentPlayer, hasRequiredSkill) {\n  const now = Date.now();\n  const resources = GlobalGridStateTilesAndResources.getResources() || [];\n  \n  // Find all crafting stations with completed crafts\n  const readyStations = resources.filter(res => {\n    // Check if this is a crafting station\n    const stationDef = masterResources.find(r => r.type === res.type);\n    if (!stationDef || stationDef.category !== 'crafting') return false;\n    \n    // Check if it has a completed craft\n    return res.craftEnd && res.craftEnd <= now && res.craftedItem;\n  });\n\n  // Group stations by type and crafted item\n  const stationGroups = {};\n  readyStations.forEach(station => {\n    const key = `${station.type}-${station.craftedItem}`;\n    if (!stationGroups[key]) {\n      const stationResource = masterResources.find(r => r.type === station.type);\n      const craftedResource = masterResources.find(r => r.type === station.craftedItem);\n      // Find the recipe that produces this item from this station\n      const recipe = masterResources.find(r => \n        r.source === station.type && r.type === station.craftedItem\n      );\n      stationGroups[key] = {\n        stationType: station.type,\n        stationSymbol: stationResource?.symbol || '',\n        craftedItem: station.craftedItem,\n        craftedSymbol: craftedResource?.symbol || '',\n        stations: [],\n        recipe: recipe,\n        canRestart: !!recipe && hasRequiredSkill(recipe?.requires),\n        affordable: recipe ? canAfford(recipe, inventory, backpack, 1) : false\n      };\n    }\n    stationGroups[key].stations.push(station);\n  });\n\n  // Convert to array and add counts\n  const groupsArray = Object.values(stationGroups).map(group => ({\n    ...group,\n    stationCount: group.stations.length\n  }));\n  \n  // Sort by station type first (alphabetically), then by crafted item (alphabetically)\n  groupsArray.sort((a, b) => {\n    // First compare station types\n    const stationCompare = a.stationType.localeCompare(b.stationType);\n    if (stationCompare !== 0) return stationCompare;\n    \n    // If same station type, compare crafted items\n    return a.craftedItem.localeCompare(b.craftedItem);\n  });\n  \n  return groupsArray;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport Modal from '../../UI/Modal';\nimport ProgressModal from '../../UI/ProgressModal';\nimport '../../UI/ResourceButton.css';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate, gainIngredients, spendIngredients } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleDooberClick, handleSourceConversion } from '../../ResourceClicking'; // adjust path if necessary\nimport FloatingTextManager from '../../UI/FloatingText';\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs\";\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useNPCOverlay } from '../../UI/NPCOverlayContext';\nimport { useBulkOperation } from '../../UI/BulkOperationContext';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { BulkHarvestModal, executeBulkHarvest, prepareBulkHarvestData } from './BulkHarvest';\nimport BulkHarvestResultsModal from './BulkHarvestResultsModal';\nimport { BulkAnimalModal, executeBulkAnimalCollect, prepareBulkAnimalData } from './BulkAnimalCollect';\nimport { BulkCraftingModal, executeBulkCrafting, prepareBulkCraftingData } from './BulkCrafting';\n\nconst FarmHandPanel = ({\n  onClose,\n  npc,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  resources,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterSkills, // Added as prop\n  currentSeason,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const [stationDetails, setStationDetails] = useState(null);\n  const [workerSkills, setFarmhandSkills] = useState([]);\n  const [workerUpgrades, setFarmhandUpgrades] = useState([]);\n  const [isHarvestModalOpen, setIsHarvestModalOpen] = useState(false);\n  const [availableCrops, setAvailableCrops] = useState([]);\n  const [bulkHarvestResults, setBulkHarvestResults] = useState(null);\n  const [isResultsModalOpen, setIsResultsModalOpen] = useState(false);\n  const [isAnimalModalOpen, setIsAnimalModalOpen] = useState(false);\n  const [selectedAnimalTypes, setSelectedAnimalTypes] = useState({});\n  const [availableAnimals, setAvailableAnimals] = useState([]);\n  const [isCraftingModalOpen, setIsCraftingModalOpen] = useState(false);\n  const [selectedCraftingStations, setSelectedCraftingStations] = useState({});\n  const [selectedRestartStations, setSelectedRestartStations] = useState({});\n  const [availableCraftingStations, setAvailableCraftingStations] = useState([]);\n  const skills = currentPlayer.skills || [];\n  const hasBulkReplant = skills.some(skill => skill.type === 'Bulk Replant');\n  const hasBulkRestartCraft = skills.some(skill => skill.type === 'Bulk Restart Craft');\n  const [bulkProgressModal, setBulkProgressModal] = useState({ isOpen: false, message: '' });\n  const { setBusyOverlay, clearNPCOverlay } = useNPCOverlay();\n  const { startBulkOperation, endBulkOperation } = useBulkOperation();\n  \n  // Shared function for executing bulk operations with progress modal\n  async function executeBulkOperation(operationName, operationId, workerNPC, asyncOperation) {\n    let pendingStatusMessage = null;\n    \n    // Show progress modal\n    setBulkProgressModal({ \n      isOpen: true, \n      message: strings[477] || 'Processing...'\n    });\n    \n    try {\n      // Run the async operation\n      pendingStatusMessage = await asyncOperation();\n    } catch (error) {\n      console.error(`${operationName} failed:`, error);\n      pendingStatusMessage = error.message || `Failed to complete ${operationName}.`;\n    } finally {\n      // Close modal and cleanup\n      setBulkProgressModal({ isOpen: false, message: '' });\n      if (workerNPC) clearNPCOverlay(workerNPC.id);\n      endBulkOperation(operationId);\n      \n      // Show the status message\n      if (pendingStatusMessage) {\n        updateStatus(pendingStatusMessage);\n      }\n    }\n  }\n  \n  // Determine which features to show based on NPC type\n  const npcType = npc?.type || stationType; // Use NPC type from the npc object, fallback to stationType\n  const showBulkHarvest = ['Farmer', 'Farm Hand'].includes(npcType);\n  const showBulkReplant = ['Farmer', 'Farm Hand'].includes(npcType) && hasBulkReplant;\n  const showBulkAnimalCollect = ['Farmer', 'Rancher'].includes(npcType);\n  const showLogging = ['Farmer', 'Lumberjack'].includes(npcType);\n  const showCropPurchase = ['Farmer', 'Farm Hand'].includes(npcType);\n  const showBulkCrafting = ['Farmer', 'Crafter'].includes(npcType);\n  \n  // Helper function to check if player has required skill (same logic as FarmingPanel)\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n  \n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  useEffect(() => {\n    try {\n      const farmOutputs = masterResources\n        .filter((res) => res.category === 'farmplot')\n        .map((res) => res.output)\n        .filter(Boolean);\n\n      const filteredRecipes = masterResources.filter((res) => {\n        // Check if resource is in farmOutputs and not Oak Tree\n        if (!farmOutputs.includes(res.type) || res.type === 'Oak Tree') return false;\n        \n        // Check seasonal restriction\n        if (res.season && currentSeason && res.season !== currentSeason) {\n          return false;\n        }\n        \n        return true;\n      });\n      setRecipes(filteredRecipes);\n\n      const stationResource = masterResources.find((res) => res.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n    } catch (error) {\n      console.error('Error loading worker offers:', error);\n    }\n  }, [stationType, masterResources]);\n\n  useEffect(() => {\n    const ownedTypes = currentPlayer.skills?.map(skill => skill.type) || [];\n    \n    // Get skills from multiple sources based on NPC type\n    let validSources = ['Farm Hand']; // Always include Farm Hand skills\n    if (npcType === 'Crafter' || npcType === 'Farmer') {\n      validSources.push('Crafter'); // Include Crafter skills for Crafter and Farmer NPCs\n    }\n    if (npcType === 'Rancher' || npcType === 'Farmer') {\n      validSources.push('Rancher'); // Include Rancher skills for Rancher and Farmer NPCs\n    }\n    \n    let skills = masterResources.filter(res =>\n      (res.category === 'skill' || res.category === 'upgrade') &&\n      validSources.includes(res.source) &&\n      !ownedTypes.includes(res.type)\n    );\n    \n    // Filter skills based on NPC type\n    if (npcType === 'Farm Hand') {\n      skills = skills.filter(res => ['Bulk Harvest', 'Bulk Replant'].includes(res.type));\n    } else if (npcType === 'Rancher') {\n      skills = skills.filter(res => res.type === 'Bulk Animal Collect');\n    } else if (npcType === 'Lumberjack') {\n      skills = skills.filter(res => ['Logging', 'Better Logging'].includes(res.type));\n    } else if (npcType === 'Crafter') {\n      skills = skills.filter(res => ['Bulk Crafting', 'Bulk Restart Craft'].includes(res.type));\n    }\n    // For 'Farmer', show all skills from all valid sources\n    \n    setFarmhandSkills(skills.filter(res => res.category === 'skill'));\n    setFarmhandUpgrades(skills.filter(res => res.category === 'upgrade'));\n  }, [masterResources, currentPlayer, npcType]);\n\n  const handleTrade = async (resource) => {\n    setErrorMessage('');\n    const cost = (resource.maxprice || 100) * 10;\n\n    const recipe = {\n      ingredient1: 'Money',\n      ingredient1qty: cost,\n      type: resource.type,\n    };\n\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n\n    const spent = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spent) {\n      setErrorMessage('Not enough money.');\n      return;\n    }\n\n    const gained = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: resource.type,\n      quantity: 1,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n    if (!gained) {\n      setErrorMessage('Not enough space to carry that item.');\n      return;\n    }\n\n    updateStatus(`Bought 1 ${resource.type} for ${cost} Money.`);\n  };\n\n  const handlePurchaseSkill = async (resource) => {\n    setErrorMessage('');\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n\n    const spent = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: resource,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spent) {\n      setErrorMessage('Not enough ingredients.');\n      return;\n    }\n\n    const updatedSkills = [...(currentPlayer.skills || []), { type: resource.type, category: resource.category, quantity: 1 }];\n    await axios.post(`${API_BASE}/api/update-skills`, {\n      playerId: currentPlayer.playerId,\n      skills: updatedSkills,\n    });\n\n    await trackQuestProgress(currentPlayer, 'Gain skill with', resource.type, 1, setCurrentPlayer);\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    updateStatus(`${resource.type} acquired.`);\n  };\n\n  function handleBulkAnimalCollect() {\n    \n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const processingAnimals = npcs.filter(npc => npc.state === 'processing');\n    \n\n    if (processingAnimals.length === 0) {\n      updateStatus('No animals are ready to collect.');\n      return;\n    }\n    \n    // Find the appropriate worker NPC to apply busy overlay (Farmer or Rancher)\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Count how many of each animal type is ready\n    const animalCounts = {};\n    processingAnimals.forEach((npc) => {\n      animalCounts[npc.type] = (animalCounts[npc.type] || 0) + 1;\n    });\n\n    // Create array of available animals with counts and symbols\n    const animalsWithDetails = Object.entries(animalCounts).map(([animalType, count]) => {\n      const resourceDef = masterResources.find(res => res.type === animalType);\n      return {\n        type: animalType,\n        count,\n        symbol: resourceDef?.symbol || ''\n      };\n    });\n\n    setAvailableAnimals(animalsWithDetails);\n    \n    // Select all animals by default\n    const defaultSelection = {};\n    animalsWithDetails.forEach(animal => {\n      defaultSelection[animal.type] = true;\n    });\n    setSelectedAnimalTypes(defaultSelection);\n    \n    setIsAnimalModalOpen(true);\n  }\n\n  async function executeSelectiveAnimalCollect() {\n    setIsAnimalModalOpen(false);\n    onClose();\n    setErrorMessage('');\n    \n    // Find the appropriate worker NPC to apply busy overlay (Farmer or Rancher)\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-animal-collect-${Date.now()}`;\n    startBulkOperation('bulk-animal-collect', operationId);\n\n    // Execute bulk operation with shared function\n    await executeBulkOperation('bulk-animal-collect', operationId, workerNPC, async () => {\n      return await executeBulkAnimalCollect({\n        selectedAnimalTypes,\n        gridId,\n        currentPlayer,\n        setCurrentPlayer,\n        setInventory,\n        setBackpack,\n        setResources,\n        updateStatus,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        strings\n      });\n    });\n    \n    onClose();\n  }\n\n\n\n  async function handleLogging() {\n    console.log(' Logging initiated ');\n    onClose();\n    setErrorMessage('');\n\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n    \n    // Find the appropriate worker NPC to apply busy overlay (Lumberjack or Farmer)\n    let npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Lumberjack'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-logging-${Date.now()}`;\n    startBulkOperation('bulk-logging', operationId);\n\n    try {\n      // Step 1: Determine how many trees we can chop\n      const loggingSkills = (currentPlayer.skills || []).filter(\n        (skill) => ['Logging', 'Better Logging'].includes(skill.type)\n      );\n      const maxTrees = loggingSkills.reduce((sum, skill) => {\n        const resourceDef = masterResources.find(res => res.type === skill.type);\n        return sum + (resourceDef?.qtycollected || 0);\n      }, 0);\n\n      if (maxTrees === 0) {\n        updateStatus(\"No logging skills available.\");\n        return;\n      }\n\n      // Step 2: Find the center position for tree selection (Lumberjack  Farmer  Player)\n      const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n      const lumberjackNPC = npcs.find(npc => npc.type === 'Lumberjack');\n      const farmerNPC = npcs.find(npc => npc.type === 'Farmer' || npc.type === 'Farm Hand');\n      \n      let centerPos;\n      let centerType;\n      \n      if (lumberjackNPC) {\n        centerPos = lumberjackNPC.position;\n        centerType = \"Lumberjack\";\n      } else if (farmerNPC) {\n        centerPos = farmerNPC.position;\n        centerType = \"Farmer\";\n      } else {\n        // Use player position as fallback\n        const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n        if (playerData && playerData.position) {\n          centerPos = playerData.position;\n          centerType = \"Player\";\n        } else {\n          // Ultimate fallback to (0,0) if no player position found\n          centerPos = { x: 0, y: 0 };\n          centerType = \"Default\";\n        }\n      }\n      \n      console.log(` Using ${centerType} position as center: (${centerPos.x}, ${centerPos.y})`);\n\n      // Step 3: Get all trees from resources and calculate distances from center position\n      const treeResources = resources\n        .filter(res => res.type === 'Oak Tree')\n        .map(tree => ({\n          ...tree,\n          distance: Math.sqrt(\n            Math.pow(tree.x - centerPos.x, 2) + \n            Math.pow(tree.y - centerPos.y, 2)\n          )\n        }))\n        .sort((a, b) => a.distance - b.distance); // Sort by distance from center\n\n      if (treeResources.length === 0) {\n        updateStatus(strings[437] || 'No trees available to chop.');\n        return;\n      }\n\n      // Select the closest trees up to maxTrees limit\n      const treesToChop = treeResources.slice(0, maxTrees);\n      console.log(` Found ${treeResources.length} trees, will chop ${treesToChop.length} closest to Lumberjack`);\n      const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n      // ---- Two-phase processing ----\n      const choppedTreePositions = [];\n\n      // Phase 1: Chop trees and remember positions\n      for (const tree of treesToChop) {\n        await handleSourceConversion(\n          tree,\n          tree.y,\n          tree.x,\n          resources,\n          setResources,\n          safeInventory,\n          setInventory,\n          safeBackpack,\n          setBackpack,\n          gridId,\n          FloatingTextManager.addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          masterResources,\n          () => {}, // setModalContent\n          () => {}, // setIsModalOpen\n          updateStatus,\n          strings\n        );\n        choppedTreePositions.push({ x: tree.x, y: tree.y });\n        await wait(100);\n      }\n\n      await wait(300); // give state time to update\n\n      // Phase 2: Click doobers at chopped positions\n      setTimeout(async () => {\n        for (const pos of choppedTreePositions) {\n          // Get the most up-to-date resources state\n          const latestResources = typeof setResources === 'function'\n            ? await new Promise(resolve => {\n                setResources(prev => {\n                  resolve(prev);\n                  return prev;\n                });\n              })\n            : resources;\n          const wood = latestResources.find(\n            res => res.x === pos.x && res.y === pos.y && res.category === 'doober'\n          );\n          console.log(' Found wood doober at', pos, ':', wood);\n          if (wood) {\n            console.log('Calling handleDooberClick');\n            await handleDooberClick(\n              wood,\n              wood.y,\n              wood.x,\n              resources,\n              setResources,\n              setInventory,\n              setBackpack,\n              safeInventory,\n              safeBackpack,\n              currentPlayer.skills,\n              gridId,\n              FloatingTextManager.addFloatingText,\n              TILE_SIZE,\n              currentPlayer,\n              setCurrentPlayer,\n              updateStatus,\n              masterResources,\n              masterSkills,\n              strings,\n              null, // openPanel\n              globalTuning\n            );\n            await wait(100);\n          } else {\n            console.warn(' No doober found at position:', pos);\n          }\n        }\n        updateStatus(` Logging complete: ${treesToChop.length} trees chopped and collected.`);\n      }, 50);\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    } catch (error) {\n      console.error('Logging failed:', error);\n      setErrorMessage('Failed to auto-chop trees.');\n    } finally {\n      // End bulk operation tracking\n      endBulkOperation(operationId);\n      \n      // Clear busy overlay when operation completes\n      const npcsCleanup = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n      const workerNPCCleanup = npcsCleanup.find(npc => npc.action === 'worker' && ['Farmer', 'Lumberjack'].includes(npc.type));\n      if (workerNPCCleanup) {\n        clearNPCOverlay(workerNPCCleanup.id);\n      }\n    }\n  }\n\n\n  async function handleBulkHarvest() {\n    // First, force FarmState to process any pending seeds\n    const farmState = await import('../../FarmState').then(m => m.default);\n    await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n    \n    // Stop FarmState timer to prevent conversions during modal\n    farmState.stopSeedTimer();\n    \n    // Wait a moment for state updates to propagate\n    await new Promise(resolve => setTimeout(resolve, 200));\n    \n    // Now get fresh resources from global state\n    const freshResources = GlobalGridStateTilesAndResources.getResources();\n    const crops = prepareBulkHarvestData(freshResources, masterResources);\n\n    if (crops.length === 0) {\n      updateStatus(strings[344] || 'No crops ready for harvest.');\n      // Restart FarmState timer if no crops\n      farmState.initializeFarmState(freshResources);\n      farmState.startSeedTimer({ gridId, setResources, masterResources });\n      return;\n    }\n    \n    setAvailableCrops(crops);\n    setIsHarvestModalOpen(true);\n  }\n  \n  // Function to get fresh crop data at any time\n  const getFreshCropData = React.useCallback(async () => {\n    // Force sync before getting data\n    const farmState = await import('../../FarmState').then(m => m.default);\n    await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n    await new Promise(resolve => setTimeout(resolve, 100));\n    \n    const freshResources = GlobalGridStateTilesAndResources.getResources();\n    return prepareBulkHarvestData(freshResources, masterResources);\n  }, [gridId, setResources, masterResources]);\n \n  async function executeSelectiveHarvest(selectedCropTypes, selectedReplantTypes) {\n    setIsHarvestModalOpen(false);\n    setErrorMessage('');\n\n    // Find the Farmer NPC to apply busy overlay\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const farmerNPC = npcs.find(npc => npc.action === 'worker');\n    if (farmerNPC) {\n      setBusyOverlay(farmerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-harvest-${Date.now()}`;\n    startBulkOperation('bulk-harvest', operationId);\n\n    try {\n      // Execute bulk operation with shared function\n      await executeBulkOperation('bulk-harvest', operationId, farmerNPC, async () => {\n        const result = await executeBulkHarvest({\n          selectedCropTypes,\n          selectedReplantTypes,\n          resources: GlobalGridStateTilesAndResources.getResources(),  // Always use fresh resources\n          masterResources,\n          masterSkills,\n          currentPlayer,\n          setCurrentPlayer,\n          setInventory,\n          setBackpack,\n          setResources,\n          gridId,\n          showBulkReplant,\n          strings,\n          refreshPlayerAfterInventoryUpdate,\n          globalTuning\n        });\n\n        // Handle the new results format\n        if (result.success) {\n          // Store results for modal display\n          setBulkHarvestResults(result);\n          // Show results modal after a brief delay\n          setTimeout(() => {\n            setIsResultsModalOpen(true);\n          }, 500);\n          // Return status message for any fallback displays\n          return result.statusMessage;\n        } else {\n          // Return error message\n          return result.error;\n        }\n      });\n    } finally {\n      // Always restart FarmState timer after harvest\n      const farmState = await import('../../FarmState').then(m => m.default);\n      const currentResources = GlobalGridStateTilesAndResources.getResources();\n      farmState.initializeFarmState(currentResources);\n      farmState.startSeedTimer({ gridId, setResources, masterResources });\n    }\n  }\n\n\n  function handleBulkCrafting() {\n    console.log(' Opening selective crafting modal');\n    \n    const stationGroups = prepareBulkCraftingData(masterResources, inventory, backpack, currentPlayer, hasRequiredSkill);\n    \n    if (stationGroups.length === 0) {\n      updateStatus(strings[466] || 'No crafting stations ready to collect.');\n      return;\n    }\n    \n    const stationsWithDetails = stationGroups;\n    setAvailableCraftingStations(stationsWithDetails);\n    \n    // Select all stations by default\n    const defaultSelection = {};\n    stationsWithDetails.forEach(group => {\n      defaultSelection[`${group.stationType}-${group.craftedItem}`] = true;\n    });\n    setSelectedCraftingStations(defaultSelection);\n    \n    // If player has Bulk Restart Craft skill, pre-select restart options only if player has enough ingredients\n    if (hasBulkRestartCraft) {\n      const defaultRestartSelection = {};\n      const playerInventory = {};\n      \n      // Combine inventory and backpack\n      [...(inventory || []), ...(backpack || [])].forEach(item => {\n        playerInventory[item.type] = (playerInventory[item.type] || 0) + item.quantity;\n      });\n      \n      stationsWithDetails.forEach(group => {\n        const craftedResource = masterResources.find(r => r.type === group.craftedItem);\n        if (craftedResource) {\n          // Check if player has all ingredients\n          let hasAllIngredients = true;\n          for (let i = 1; i <= 5; i++) {\n            const ingredientType = craftedResource[`ingredient${i}`];\n            const ingredientQty = craftedResource[`ingredient${i}qty`] || 1;\n            if (ingredientType) {\n              const needed = ingredientQty * group.count;\n              const has = playerInventory[ingredientType] || 0;\n              if (has < needed) {\n                hasAllIngredients = false;\n                break;\n              }\n            }\n          }\n          \n          // Only pre-select if player has all ingredients\n          if (hasAllIngredients) {\n            defaultRestartSelection[`${group.stationType}-${group.craftedItem}`] = true;\n          }\n        }\n      });\n      setSelectedRestartStations(defaultRestartSelection);\n    } else {\n      setSelectedRestartStations({});\n    }\n    \n    setIsCraftingModalOpen(true);\n  }\n\n  async function executeSelectiveCrafting(selectedGroups, selectedRestartStations) {\n    setIsCraftingModalOpen(false);\n    setErrorMessage('');\n    \n    // Find the appropriate worker NPC to apply busy overlay\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Crafter'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-crafting-${Date.now()}`;\n    startBulkOperation('bulk-crafting', operationId);\n\n    // Execute bulk operation with shared function\n    await executeBulkOperation('bulk-crafting', operationId, workerNPC, async () => {\n      return await executeBulkCrafting({\n        selectedGroups,\n        selectedRestartStations,\n        hasBulkRestartCraft,\n        currentPlayer,\n        setCurrentPlayer,\n        inventory,\n        setInventory,\n        backpack,\n        setBackpack,\n        setResources,\n        gridId,\n        masterResources,\n        masterSkills,\n        strings,\n        updateStatus,\n        globalTuning\n      });\n    });\n    \n    onClose();\n  }\n\n  async function restartCrafting(station, recipe, strings) {\n    if (!recipe) {\n      console.log(`No recipe found for restarting craft at station (${station.x}, ${station.y})`);\n      return false;\n    }\n\n    // Check affordability using the same logic as CraftingStation\n    const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n    if (!affordable) {\n      console.log(`Cannot afford to restart ${recipe.type} at station (${station.x}, ${station.y})`);\n      return false;\n    }\n\n    // Check skill requirements\n    const requirementsMet = !recipe.requires || currentPlayer.skills?.some((owned) => owned.type === recipe.requires);\n    if (!requirementsMet) {\n      console.log(`Missing required skill ${recipe.requires} to restart ${recipe.type}`);\n      return false;\n    }\n\n    // Call crafting API directly\n    const transactionId = `bulk-restart-${Date.now()}-${Math.random()}`;\n    const transactionKey = `crafting-start-${recipe.type}-${station.x}-${station.y}`;\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: station.x,\n        stationY: station.y,\n        recipe,\n        transactionId,\n        transactionKey\n      });\n      \n      if (response.data.success) {\n        // Update global state with new craft\n        const { craftEnd, craftedItem, inventory: newInventory, backpack: newBackpack } = response.data;\n        \n        // Update inventory from server response\n        if (newInventory) {\n          setInventory(newInventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory: newInventory }));\n        }\n        if (newBackpack) {\n          setBackpack(newBackpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack: newBackpack }));\n        }\n        \n        // Update the specific station resource in global state\n        const updatedResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === station.x && res.y === station.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedResources);\n        setResources(updatedResources);\n        \n        FloatingTextManager.addFloatingText(404, station.x, station.y, TILE_SIZE);\n        // Status update will be handled in bulk after all operations complete\n        console.log(` Restarted crafting ${recipe.type} at station (${station.x}, ${station.y})`);\n        return true;\n      }\n    } catch (error) {\n      console.error(`Failed to restart crafting at station (${station.x}, ${station.y}):`, error);\n      if (error.response?.status === 400) {\n        console.log('Not enough ingredients to restart crafting');\n      }\n    }\n    \n    return false;\n  }\n\n  const getSkillTooltip = (skillType) => {\n    switch (skillType) {\n      case 'Bulk Harvest':\n        return strings[427]; // \"Purchase the Farm Hand's Bulk Harvest skill in order to harvest all crops at once.\"\n      case 'Bulk Animal Collect':\n        return strings[431]; // Add a new string in your strings file if needed\n      case 'Logging':\n        return strings[432]; // Add a new string in your strings file if needed\n      case 'Better Logging':\n        return strings[433]; // Add a new string in your strings file if needed\n      case 'Bulk Crafting':\n        return strings[464]; // Add a new string in your strings file if needed\n      case 'Bulk Restart Craft':\n        return strings[468] || 'Automatically restart crafting after collection'; // Add a new string in your strings file if needed\n      default:\n        return '';\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1023\" title={npc?.symbol ? `${npc.symbol} ${npcType}` : npcType} panelName=\"FarmHandPanel\">\n      <div className=\"standard-panel\">\n\n        {showBulkHarvest && skills?.some(item => item.type === 'Bulk Harvest') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Harvest', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[428]}\n              onClick={handleBulkHarvest}\n            />\n          </div>\n        )}\n        {showBulkAnimalCollect && skills?.some(item => item.type === 'Bulk Animal Collect') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Animal Collect', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[434]}\n              onClick={handleBulkAnimalCollect}\n            />\n          </div>\n        )}\n        {showLogging && skills?.some(item => item.type === 'Logging') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Logging', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[435]}\n              onClick={handleLogging}\n            />\n          </div>\n        )}\n        {showBulkCrafting && skills?.some(item => item.type === 'Bulk Crafting') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Crafting', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[465]}\n              onClick={handleBulkCrafting}\n            />\n          </div>\n        )}\n\n        {workerSkills.length > 0 && (\n          <>\n            <h3>{strings[430]}</h3>\n\n            {workerSkills.map((resource) => {\n              const affordable = canAfford(resource, inventory, 1, backpack);\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = resource[`ingredient${i}`];\n                const qty = resource[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n                const playerQty = (inventory.find((item) => item.type === type)?.quantity || 0) +\n                                  (backpack.find((item) => item.type === type)?.quantity || 0);\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${type} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const details = `Costs:<div>${formattedCosts}</div>`;\n\n              return (\n                <ResourceButton\n                  key={resource.type}\n                  symbol={resource.symbol}\n                  name={resource.type}\n                  className=\"resource-button\"\n                  details={details}\n                  onClick={() => handlePurchaseSkill(resource)}\n                  disabled={!affordable}\n                  info={getSkillTooltip(resource.type) ? <div>{getSkillTooltip(resource.type)}</div> : undefined}\n                />\n              );\n            })}\n          </>\n        )}\n\n        {showCropPurchase && (\n          <>\n            <h3>{strings[426]}</h3>\n            {recipes?.length > 0 ? (\n              recipes.map((resource) => {\n                const cost = (resource.maxprice || 100) * 10;\n                const playerMoney = (inventory.find((item) => item.type === 'Money')?.quantity || 0) +\n                                    (backpack.find((item) => item.type === 'Money')?.quantity || 0);\n                const affordable = playerMoney >= cost;\n                const details = `${strings[347]}  ${cost}`;\n                return (\n                  <ResourceButton\n                    key={resource.type}\n                    symbol={resource.symbol}\n                    name={resource.type}\n                    className=\"resource-button\"\n                    details={details}\n                    disabled={!affordable}\n                    onClick={() => handleTrade(resource)}\n                  />\n                );\n              })\n            ) : <p>{strings[423]}</p>}\n          </>\n        )}\n\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n      </div>\n      \n      {/* Selective Harvest Modal */}\n\n      <BulkHarvestModal\n        isOpen={isHarvestModalOpen}\n        onClose={async () => {\n          setIsHarvestModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker');\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n          \n          // Restart FarmState timer\n          const farmState = await import('../../FarmState').then(m => m.default);\n          const currentResources = GlobalGridStateTilesAndResources.getResources();\n          farmState.initializeFarmState(currentResources);\n          farmState.startSeedTimer({ gridId, setResources, masterResources });\n        }}\n        crops={availableCrops}\n        getFreshCrops={getFreshCropData}\n        onExecute={executeSelectiveHarvest}\n        showBulkReplant={showBulkReplant}\n        hasRequiredSkill={hasRequiredSkill}\n        strings={strings}\n        currentSeason={currentSeason}\n        masterResources={masterResources}\n      />\n      \n      {/* Selective Animal Collect Modal */}\n\n      <BulkAnimalModal\n        isOpen={isAnimalModalOpen}\n        onClose={() => {\n          setIsAnimalModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n        }}\n        animals={availableAnimals}\n        onExecute={() => executeSelectiveAnimalCollect()}\n        strings={strings}\n      />\n      \n      {/* Selective Crafting Modal */}\n\n      <BulkCraftingModal\n        isOpen={isCraftingModalOpen}\n        onClose={() => {\n          setIsCraftingModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Crafter'].includes(npc.type));\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n        }}\n        stationGroups={availableCraftingStations}\n        onExecute={executeSelectiveCrafting}\n        hasBulkRestartCraft={hasBulkRestartCraft}\n        strings={strings}\n        masterResources={masterResources}\n        inventory={inventory}\n        backpack={backpack}\n      />\n      \n      {/* Bulk Operation Progress Modal */}\n\n      <ProgressModal\n        isOpen={bulkProgressModal.isOpen}\n        title={strings[478] || \"Processing...\"}\n        message={bulkProgressModal.message}\n      />\n\n      {/* Bulk Harvest Results Modal */}\n      <BulkHarvestResultsModal\n        isOpen={isResultsModalOpen}\n        onClose={() => {\n          setIsResultsModalOpen(false);\n          setBulkHarvestResults(null);\n        }}\n        results={bulkHarvestResults}\n        strings={strings}\n        masterResources={masterResources}\n      />\n    </Panel>\n  );\n\n\n};\n\nexport default React.memo(FarmHandPanel);","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport '../../UI/ResourceButton.css';\nimport ResourceButton from '../../UI/ResourceButton';\nimport { canAfford, hasRoomFor } from '../../Utils/InventoryManagement';\nimport { spendIngredients, gainIngredients, refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useStrings } from '../../UI/StringsContext';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport '../../UI/SharedButtons.css';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport './ScrollStation.css'; // Import for shared station panel styles\n\nconst ShopStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterTrophies,\n  isDeveloper,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const [stationDetails, setStationDetails] = useState(null);\n  const [fetchTrigger, setFetchTrigger] = useState(0);\n\n  const hasRequirement = (requirement) => {\n    return (\n      !requirement ||\n      currentPlayer.skills?.some(skill => skill.type === requirement) ||\n      currentPlayer.powers?.some(power => power.type === requirement)\n    );\n  };\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  useEffect(() => {\n    if (!masterResources || !stationType) return;\n\n    const filteredRecipes = masterResources.filter((resource) =>\n      resource.source === stationType &&\n      (!currentPlayer.powers || !currentPlayer.powers.some(p => p.type === resource.type))\n    );\n    setRecipes(filteredRecipes);\n\n    const stationResource = masterResources.find((resource) => resource.type === stationType);\n    setStationEmoji(stationResource?.symbol || '');\n    setStationDetails(stationResource);\n  }, [stationType, fetchTrigger, masterResources]);\n\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handlePurchase(modifiedRecipe);\n  };\n\n  const handlePurchase = async (recipe) => {\n    setErrorMessage('');\n    if (!recipe) {\n      setErrorMessage('Invalid recipe selected.');\n      return;\n    }\n\n    // For non-power items, check if there's room before spending money\n    if (recipe.category !== \"power\") {\n      const quantity = recipe.qtycollected || 1;\n      const hasRoom = hasRoomFor({\n        resource: recipe.type,\n        quantity: quantity,\n        currentPlayer,\n        inventory: inventory,\n        backpack: backpack,\n        masterResources,\n        globalTuning\n      });\n      \n      if (!hasRoom) {\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const isMoney = recipe.type === \"Money\";\n        const isGem = recipe.type === \"Gem\";\n        \n        if (!isMoney && !isGem && !isHomestead) {\n          // Check if player has backpack skill\n          const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n          if (!hasBackpackSkill) {\n            updateStatus(19); // Missing backpack\n          } else {\n            updateStatus(21); // Backpack full\n          }\n        } else {\n          updateStatus(20); // Warehouse full\n        }\n        return;\n      }\n    }\n\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!success) return;\n\n    // Refresh player to update money display after any purchase\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    const tradedQty = 1;\n\n    if (recipe.category === \"power\") {\n      const updatedPowers = [...(currentPlayer.powers || [])];\n      const powerIndex = updatedPowers.findIndex(p => p.type === recipe.type);\n      if (powerIndex >= 0) {\n        updatedPowers[powerIndex].quantity += tradedQty;\n      } else {\n        updatedPowers.push({ type: recipe.type, quantity: tradedQty });\n      }\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId: currentPlayer.playerId,\n        powers: updatedPowers,\n      });\n      setCurrentPlayer(prev => ({\n        ...prev,\n        powers: updatedPowers,\n      }));\n      // Helper functions to categorize powers\n      const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n      const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n      const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n      \n      // Only update combat stats for magic enhancements (not weapons/armor)\n      if (isMagicEnhancement(recipe)) {\n        const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer.playerId];\n        if (gridPlayer) {\n          const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n          const statUpdates = {};\n          \n          // Check for combat attributes on this power\n          combatAttributes.forEach(attr => {\n            if (typeof recipe[attr] === 'number') {\n              const oldValue = gridPlayer[attr] || 0;\n              const newValue = oldValue + recipe[attr];\n              statUpdates[attr] = newValue;\n              console.log(` Updated ${attr} for player ${currentPlayer.playerId}: ${oldValue} -> ${newValue}`);\n            }\n          });\n          \n          // Update all modified stats at once\n          if (Object.keys(statUpdates).length > 0) {\n            await playersInGridManager.updatePC(gridId, currentPlayer.playerId, statUpdates);\n          }\n        }\n      } else {\n        // Weapons and armor don't update combat stats until equipped\n        console.log(`${recipe.type} added to inventory - equip in Combat Panel to apply stats`);\n        \n        // Send notification for newly purchased equipment\n        showNotification('Message', {\n          title: strings[7004] || 'Note:',\n          message: strings[7017] || 'Equip in Combat Panel to use'\n        });\n      }\n    }\n    else {\n      const gainSuccess = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: recipe.type,\n        quantity: recipe.qtycollected || 1,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      if (!gainSuccess) {\n        console.warn(`Failed to gain ${recipe.type}`);\n        return;\n      }\n    }\n\n    await trackQuestProgress(currentPlayer, 'Buy', recipe.type, tradedQty, setCurrentPlayer);\n\n    updateStatus(`${strings[80]} ${recipe.type}.`);\n    \n    // Award Mariner trophy if purchased a Boat\n    if (recipe.type === 'Boat' && currentPlayer?.playerId) {\n      earnTrophy(currentPlayer.playerId, 'Mariner', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n    }\n    \n    setFetchTrigger(prev => prev + 1);\n  };\n\n  const handleSellStation = async () => {\n    try {\n      const success = await handleProtectedSelling({\n        currentPlayer,\n        stationType,\n        currentStationPosition,\n        gridId,\n        setResources,\n        setInventory,\n        setCurrentPlayer,\n        updateStatus,\n        onClose,\n      });\n      \n      if (success) {\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error selling station:', error);\n      updateStatus('Failed to sell station');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1025\" title={`${stationEmoji} ${stationType}`} panelName=\"ShopStation\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n          {/*  Conditional TENT text for the Store */}\n          {stationType === \"Store\" && (\n            <p style={{ fontWeight: \"bold\", color: \"#4CAF50\" }}>\n              {strings[\"410\"]}\n            </p>\n          )}\n          {recipes?.length > 0 ? (\n            recipes.map((recipe) => {\n              const affordable = canAfford(recipe, inventory, backpack, 1);\n              const meetsRequirement = hasRequirement(recipe.requires);\n              \n              // Handle multiple combat attributes for powers\n              let outputSummary = null;\n              if (recipe.category === 'power') {\n                const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                const effects = [];\n                \n                combatAttributes.forEach(attr => {\n                  if (typeof recipe[attr] === 'number') {\n                    const label = strings[attr] || attr;\n                    effects.push(`${recipe[attr] > 0 ? '+' : ''}${recipe[attr]} ${label}`);\n                  }\n                });\n                \n                \n                if (effects.length > 0) {\n                  outputSummary = <span style={{ color: 'blue' }}>{effects.join(', ')}</span>;\n                }\n              }\n\n              // Format costs in UI standard style\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${type} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = meetsRequirement ? 'green' : 'red';\n\n              // Build details string with multiple combat attributes for powers\n              let effectsHtml = '';\n              if (recipe.category === 'power') {\n                const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                const effects = [];\n                \n                combatAttributes.forEach(attr => {\n                  if (typeof recipe[attr] === 'number') {\n                    const label = strings[attr] || attr;\n                    effects.push(`${recipe[attr] > 0 ? '+' : ''}${recipe[attr]} ${label}`);\n                  }\n                });\n                \n                \n                if (effects.length > 0) {\n                  effectsHtml = `<span style=\"color: blue;\">${effects.join(', ')}</span><br>`;\n                }\n              }\n\n              const details =\n                effectsHtml +\n                (recipe.requires ? `<span style=\"color: ${skillColor};\">Requires: ${recipe.requires}</span><br>` : '') +\n                `Costs:<div>${formattedCosts}</div>`;\n\n              let infoContent = null;\n              \n              // Special tooltip content for Tent and Boat at General Store\n              if (stationType === \"Store\" || stationType === \"General Store\") {\n                if (recipe.type === \"Tent\") {\n                  infoContent = <div>{strings[81]}</div>; // \"Pitching a tent in Town or the Valley prevents you from being attacked.\"\n                } else if (recipe.type === \"Boat\") {\n                  infoContent = <div>{strings[82]}</div>; // \"A boat will allow you to travel by water.\"\n                }\n              }\n              \n              // For other items (like powers), show combat attributes\n              if (!infoContent && outputSummary) {\n                infoContent = (\n                  <div style={{ marginBottom: '4px' }}>\n                    <strong>{outputSummary}</strong>\n                  </div>\n                );\n              }\n              \n              const info = infoContent ? (\n                <div className=\"info-content\">\n                  {infoContent}\n                </div>\n              ) : null;\n              \n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={recipe.type}\n                  className=\"resource-button\"\n                  details={details}\n                  info={info} \n                  disabled={!affordable || !meetsRequirement}\n                  onClick={() => handlePurchase(recipe)}\n                  // Gem purchase props - don't pass gemCost to allow dynamic calculation\n                  gemCost={null}\n                  onGemPurchase={(recipe.gemcost && (!affordable || !meetsRequirement)) ? handleGemPurchase : null}\n                  resource={recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                >\n                </ResourceButton>\n              );\n            })\n          ) : <p>{strings[423]}</p>}\n\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n        \n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-danger\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[490]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(ShopStation);","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport '../../UI/ResourceButton.css'; \nimport ResourceButton from '../../UI/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport '../../UI/SharedButtons.css';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { getRandomScrollReveal, getRevealDisplayString, canAffordReveal } from './ScrollReveal';\nimport { gainSkillOrPower } from '../../Utils/SkillPowerManagement';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport './ScrollStation.css';\n\nconst ScrollStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n  const [scrollCount, setScrollCount] = useState(0);\n  const [revealedItemQty, setRevealedItemQty] = useState(1);\n  const [isCollecting, setIsCollecting] = useState(false);\n\n   //  Check for active crafting timers or revealed items\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n\n    const checkStation = () => {\n      const station = GlobalGridStateTilesAndResources.getResources()?.find(\n        (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n      );\n      \n\n      if (station && station.craftEnd && station.craftedItem) {\n          // Check if this is a revealed item (craftEnd in the past)\n          const now = Date.now();\n          const isRevealed = station.craftEnd < now;\n          \n          setCraftedItem(station.craftedItem);\n          setRevealedItemQty(station.qty || 1);\n          \n          if (isRevealed) {\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n              setCraftingCountdown(0);\n              setActiveTimer(false);\n          } else {\n              // Normal crafting timer\n              setIsCrafting(true);\n              setActiveTimer(true);\n              \n              const remainingTime = Math.max(0, Math.floor((station.craftEnd - now) / 1000));\n              setCraftingCountdown(remainingTime);\n              \n              if (remainingTime === 0) {\n                  setIsCrafting(false);\n                  setIsReadyToCollect(true);\n              }\n          }\n      } else {\n          // Only reset if we actually had something before\n          if (craftedItem || isCrafting || isReadyToCollect) {\n            setCraftedItem(null);\n            setIsCrafting(false);\n            setIsReadyToCollect(false);\n            setCraftingCountdown(null);\n            setActiveTimer(false);\n            setRevealedItemQty(1);\n          }\n      }\n    };\n\n    // Initial check\n    checkStation();\n\n    // Set up interval to check for updates\n    const timer = setInterval(checkStation, 1000);\n    return () => clearInterval(timer);\n  }, [stationType, currentStationPosition, craftedItem, isCrafting, isReadyToCollect]); // Include state to ensure fresh closures\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Calculate scroll count from inventory and backpack\n  useEffect(() => {\n    const allItems = [...(inventory || []), ...(backpack || [])];\n    const scrolls = allItems.find(item => item.type === 'Scroll');\n    setScrollCount(scrolls?.quantity || 0);\n  }, [inventory, backpack]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => {\n        // Check if resource source matches station type\n        if (resource.source !== stationType) return false;\n        \n        // Check seasonal restriction\n        if (resource.season && currentSeason && resource.season !== currentSeason) {\n          return false;\n        }\n        \n        return true;\n      });\n      \n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);\n        \n        console.log('Existing NPC types on grid:', existingNPCTypes);\n        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n  \n  // Generate skill bonus message\n  const getSkillBonusMessage = () => {\n    // Find all skills that apply to this station\n    const applicableSkills = Object.entries(masterSkills || {})\n      .filter(([skillName, stations]) => {\n        return stations && typeof stations === 'object' && stations[stationType] > 1;\n      })\n      .map(([skillName, stations]) => ({\n        skillName,\n        multiplier: stations[stationType],\n        hasSkill: currentPlayer.skills?.some(item => item.type === skillName)\n      }));\n    \n    if (applicableSkills.length === 0) return null;\n    \n    // Separate owned and unowned skills\n    const ownedSkills = applicableSkills.filter(skill => skill.hasSkill);\n    const unownedSkills = applicableSkills.filter(skill => !skill.hasSkill);\n    \n    // Calculate combined multiplier for owned skills\n    const combinedMultiplier = ownedSkills.reduce((total, skill) => total * skill.multiplier, 1);\n    \n    let messages = [];\n    \n    // Message for owned skills\n    if (ownedSkills.length > 0) {\n      if (ownedSkills.length === 1) {\n        // Single skill: \"Your [skill] Skill increases the base output of this station by [X].\"\n        messages.push(`${strings[805]}${getLocalizedString(ownedSkills[0].skillName, strings)}${strings[806]}${ownedSkills[0].multiplier}x.`);\n      } else {\n        // Multiple skills: list them with their multipliers and show combined effect\n        const skillsList = ownedSkills\n          .map(skill => `${getLocalizedString(skill.skillName, strings)} (${skill.multiplier}x)`)\n          .join(' & ');\n        messages.push(`Your ${skillsList} skills combine to increase output by ${combinedMultiplier}x.`);\n      }\n    }\n    \n    // Message for unowned skills\n    if (unownedSkills.length > 0) {\n      unownedSkills.forEach(skill => {\n        const skillResource = allResources.find(res => res.type === skill.skillName);\n        const skillSource = skillResource?.source || 'Skill Shop';\n        // \"Acquire the [skill] Skill at the [source] to increase the output of this station by [X]x.\"\n        messages.push(`${strings[801]}${getLocalizedString(skill.skillName, strings)}${strings[802]}${getLocalizedString(skillSource, strings)}${strings[803]}${skill.multiplier}x.`);\n      });\n    }\n    \n    return messages.join(' ');\n  };\n\n  const skillMessage = getSkillBonusMessage();\n\n\n  // Handle reveal scroll - spend scroll and start crafting random item\n  const handleRevealScroll = async (transactionId, transactionKey) => {\n    \n    if (scrollCount === 0) {\n      updateStatus(strings[820] || 'You need at least 1 scroll to reveal');\n      return;\n    }\n\n    try {\n      // First, spend the scroll\n      const spentSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        recipe: { ingredient1: 'Scroll', ingredient1qty: 1 },\n        inventory: currentPlayer.inventory,  \n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n      });\n\n      if (!spentSuccess) {\n        updateStatus(strings[820] || 'Failed to spend scroll');\n        return;\n      }\n\n      // Generate random reward\n      const reward = getRandomScrollReveal(masterResources);\n      const rewardDisplay = getRevealDisplayString(reward, masterResources);\n      \n      // Get the Reveal Scroll resource to get crafttime\n      const revealScrollResource = masterResources.find(r => r.type === 'Reveal Scroll');\n      const craftTime = revealScrollResource?.crafttime || 30; // Default 30 seconds\n\n      // Now start crafting the revealed item using standard craft API\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe: {\n          type: reward.type,\n          crafttime: craftTime,\n          // No ingredients since we already spent the scroll\n        },\n        qty: reward.quantity,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response if provided\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update station resource in global state with qty\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem, qty: reward.quantity }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftedItem(craftedItem);\n        setRevealedItemQty(reward.quantity);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Update status\n        FloatingTextManager.addFloatingText(strings[829], currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n\n        // Track quest progress for scroll spending\n        await trackQuestProgress(currentPlayer, 'Spend', 'Scroll', 1, setCurrentPlayer);\n\n      }\n    } catch (error) {\n      console.error('Error in scroll reveal process:', error);\n      updateStatus(strings[830]);\n    }\n  };\n\n  // Handle collection of revealed items (reuse standard collect logic)\n  const handleCollectReveal = async (transactionId, transactionKey) => {\n    \n    if (!craftedItem || isCollecting) { \n      console.error(\" No revealed item to collect or already collecting.\"); \n      return; \n    }\n\n    setIsCollecting(true);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        const { collectedItem, isNPC } = response.data;\n        const collectedQty = revealedItemQty || 1;\n\n        // Find the revealed item in master resources to check its category\n        const revealedResource = allResources.find(res => res.type === collectedItem);\n        \n        // Handle collection based on item category\n        if (isNPC) {\n          // Spawn NPC\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: currentStationPosition.x, y: currentStationPosition.y });\n          }\n          FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        } else if (revealedResource && (revealedResource.category === 'skill' || revealedResource.category === 'power' || revealedResource.category === 'upgrade')) {\n          // Check if player already has this skill/power/upgrade\n          const alreadyOwned = revealedResource.category === 'skill' \n            ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n            : currentPlayer.powers?.some(power => power.type === collectedItem);\n          \n          if (alreadyOwned) {\n            // Player already has this item - show special message\n            updateStatus(strings[828] || 'You already have this');\n            \n            // Still create floating text to show what was attempted\n            const displayName = getLocalizedString(collectedItem, strings);\n            const categoryEmoji = revealedResource.category === 'skill' ? '' : \n                                revealedResource.category === 'power' ? '' : '';\n            FloatingTextManager.addFloatingText(`${categoryEmoji} ${displayName} (Already Owned)`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n          } else {\n            // Handle skills, powers, and upgrades\n            const success = await gainSkillOrPower({\n              item: revealedResource,\n              currentPlayer,\n              setCurrentPlayer,\n              updateStatus,\n              strings,\n              gridId,\n              quantity: collectedQty\n            });\n            \n            if (!success) {\n              console.error(' Failed to add skill/power to player.');\n              setIsCollecting(false);\n              return;\n            }\n            \n            // Create floating text\n            const displayName = getLocalizedString(collectedItem, strings);\n            const categoryEmoji = revealedResource.category === 'skill' ? '' : \n                                revealedResource.category === 'power' ? '' : '';\n            FloatingTextManager.addFloatingText(`${categoryEmoji} ${displayName}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n            \n            // Handle combat stats updates for powers (mimic ShopStation logic)\n            if (revealedResource.category === 'power') {\n              // Helper functions to categorize powers\n              const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n              const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n              const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n              \n              if (isMagicEnhancement(revealedResource)) {\n                // Update combat stats for magic enhancements\n                const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer._id];\n                if (gridPlayer) {\n                  const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                  const statUpdates = {};\n                  \n                  // Check for combat attributes on this power\n                  combatAttributes.forEach(attr => {\n                    if (typeof revealedResource[attr] === 'number') {\n                      const oldValue = gridPlayer[attr] || 0;\n                      const newValue = oldValue + revealedResource[attr];\n                      statUpdates[attr] = newValue;\n                      console.log(` Updated ${attr} for player ${currentPlayer._id}: ${oldValue} -> ${newValue}`);\n                    }\n                  });\n                  \n                  // Update all modified stats at once\n                  if (Object.keys(statUpdates).length > 0) {\n                    await playersInGridManager.updatePC(gridId, currentPlayer._id, statUpdates);\n                  }\n                }\n              } else {\n                // Weapons and armor require equipping - send notification\n                showNotification('Message', {\n                  title: strings[7001] || 'Tip',\n                  message: strings[7017] || 'Equip in Combat Panel to use'\n                });\n              }\n            }\n          }\n        } else {\n          // Handle regular doobers - add to inventory\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: collectedQty,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          if (!gained) {\n            console.error(' Failed to add revealed item to inventory.');\n            setIsCollecting(false);\n            return;\n          }\n          \n          FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        }\n\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQty, setCurrentPlayer);\n\n        // Clear station state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined, qty: 1 }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n        setRevealedItemQty(1);\n\n        // Update status - only if we're not dealing with already owned skills/powers\n        if (!(revealedResource && (revealedResource.category === 'skill' || revealedResource.category === 'power' || revealedResource.category === 'upgrade') && \n            (revealedResource.category === 'skill' \n              ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n              : currentPlayer.powers?.some(power => power.type === collectedItem)))) {\n          updateStatus(`${strings[469] || 'Collected'} ${collectedQty}x ${getLocalizedString(collectedItem, strings)}`);\n        }\n\n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Award Scroll Revealer trophy for successful scroll reveals\n        if (currentPlayer?.playerId) {\n          earnTrophy(currentPlayer.playerId, 'Scroll Revealer', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n        }\n\n        // Clear collecting state after a brief delay\n        setTimeout(() => {\n          setIsCollecting(false);\n        }, 100);\n      } else {\n        setIsCollecting(false);\n      }\n    } catch (error) {\n      console.error('Error collecting revealed item:', error);\n      updateStatus(' Failed to collect item');\n      setIsCollecting(false);\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1036\" title={strings[1136] || 'Ancient Temple'} panelName=\"ScrollStation\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n\n        {/* Scroll count display */}\n\n        <div style={{\n          padding: '10px',\n          textAlign: 'center',\n          fontSize: '16px',\n          fontWeight: 'bold',\n         }}>\n          {strings[825]}: <br></br>{scrollCount}  {scrollCount > 1 ? strings[826] : strings[827]}\n        </div>\n\n\n        {skillMessage && (\n          <div style={{ \n            marginBottom: '15px', \n            padding: '10px', \n            backgroundColor: '#f0f0f0', \n            borderRadius: '5px',\n            fontStyle: 'italic'\n          }}>\n            {skillMessage}\n          </div>\n        )}\n\n        {/* Show crafting item if active, otherwise show Reveal Scroll button */}\n\n        {craftedItem && (isCrafting || isReadyToCollect) ? (\n          // Show animated scroll reveal or dramatic collect interface\n          isCrafting ? (\n            // Animated scroll emoji during crafting\n            <div className=\"scroll-reveal-animation\">\n              <div className=\"scroll-emoji\"></div>\n              <div className=\"scroll-revealing-text\">Revealing Scroll...</div>\n              <div className=\"scroll-countdown-text\">{formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}</div>\n            </div>\n          ) : (\n            // Use standard ResourceButton for collect state\n            (() => {\n              const revealedResource = masterResources.find(r => r.type === craftedItem);\n              const rarity = revealedResource?.scrollchance || 'common';\n              const rarityText = typeof rarity === 'string' ? rarity.toUpperCase() : 'COMMON';\n              \n              return (\n                <ResourceButton\n                  symbol={revealedResource?.symbol || ''}\n                  name={`\\n${getLocalizedString(craftedItem, strings)}${revealedItemQty > 1 ? ` (${revealedItemQty})` : ''}`}\n                  className={`resource-button scroll-collect-button rarity-${typeof rarity === 'string' ? rarity : 'common'} ${isCollecting ? 'collecting' : 'ready'}`}\n                  details={rarityText} \n                  disabled={!isReadyToCollect || isCollecting}\n                  isTransactionMode={isReadyToCollect && !isCollecting}\n                  transactionKey={isReadyToCollect ? `scroll-collect-${craftedItem}-${currentStationPosition.x}-${currentStationPosition.y}` : undefined}\n                  onTransactionAction={isReadyToCollect ? handleCollectReveal : undefined}\n                />\n              );\n            })()\n          )\n        ) : scrollCount > 0 && !isCollecting ? (\n          // Show reveal scroll button when not crafting and not collecting\n          <ResourceButton\n            name={strings[831]}\n            className=\"resource-button\"\n            details={`${strings[461]} 1x  ${strings[827]}`}\n            disabled={false}\n            isTransactionMode={true}\n            transactionKey={`scroll-reveal-${currentStationPosition.x}-${currentStationPosition.y}`}\n            onTransactionAction={handleRevealScroll}\n          />\n        ) : null}\n        \n        {/* Show message when no scrolls */}\n        {scrollCount === 0 && !craftedItem && (\n          <p style={{ textAlign: 'center', padding: '20px', color: '#666' }}>\n            {strings[832]}\n          </p>\n        )}\n\n        </div>\n        \n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-danger\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(ScrollStation);","import axios from 'axios';\nimport API_BASE from '../config';\nimport { refreshPlayerAfterInventoryUpdate } from './InventoryManagement';\nimport { trackQuestProgress } from '../GameFeatures/Quests/QuestGoalTracker';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\nimport { incrementFTUEStep } from '../GameFeatures/FTUE/FTUE';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { getLocalizedString } from './stringLookup';\n\n/**\n * Shared utility for adding skills, upgrades, or powers to a player\n * Handles all the necessary API calls and state updates\n * \n * @param {Object} params - Parameters object\n * @param {Object} params.item - The skill/upgrade/power resource object to add\n * @param {Object} params.currentPlayer - Current player object\n * @param {Function} params.setCurrentPlayer - Function to update player state\n * @param {Function} params.updateStatus - Function to update status bar\n * @param {Object} params.strings - Localized strings object\n * @param {string} params.gridId - Current grid ID (needed for combat stats)\n * @param {number} params.quantity - Quantity to add (default 1)\n * @returns {Promise<boolean>} - Success status\n */\nexport async function gainSkillOrPower({\n  item,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  strings,\n  gridId,\n  quantity = 1\n}) {\n  try {\n    if (!item || !item.type || !item.category) {\n      console.error('Invalid item provided to gainSkillOrPower:', item);\n      return false;\n    }\n\n    console.log(` Adding ${item.category}: ${item.type} x${quantity}`);\n\n    // Handle different categories\n    if (item.category === 'skill' || item.category === 'upgrade') {\n      // Skills and upgrades are stored together in the skills array\n      const currentSkills = currentPlayer.skills || [];\n      const updatedSkills = [...currentSkills];\n      \n      // Check if already owned\n      const existingIndex = updatedSkills.findIndex(s => s.type === item.type);\n      if (existingIndex >= 0) {\n        // Update quantity if already owned\n        updatedSkills[existingIndex].quantity = (updatedSkills[existingIndex].quantity || 1) + quantity;\n      } else {\n        // Add new skill/upgrade\n        updatedSkills.push({ \n          type: item.type, \n          category: item.category, \n          quantity: quantity \n        });\n      }\n\n      // Update on server\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId: currentPlayer.playerId,\n        skills: updatedSkills\n      });\n\n      // Update local state\n      setCurrentPlayer(prev => ({\n        ...prev,\n        skills: updatedSkills\n      }));\n\n      // Track quest progress\n      await trackQuestProgress(currentPlayer, 'Gain skill with', item.type, quantity, setCurrentPlayer);\n      \n      // Earn trophy for skills\n      if (item.category === 'skill') {\n        await earnTrophy(currentPlayer.playerId, 'Skill Builder', 1, currentPlayer, null, setCurrentPlayer);\n      }\n\n      // Check for FTUE progress (Axe skill)\n      if (currentPlayer.firsttimeuser === true && item.type === 'Axe') {\n        console.log(' First-time user acquired Axe skill, advancing FTUE step');\n        await incrementFTUEStep(currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n      }\n\n    } else if (item.category === 'power') {\n      // Powers are stored separately\n      const currentPowers = currentPlayer.powers || [];\n      const updatedPowers = [...currentPowers];\n      \n      // Check if already owned\n      const existingIndex = updatedPowers.findIndex(p => p.type === item.type);\n      if (existingIndex >= 0) {\n        updatedPowers[existingIndex].quantity = (updatedPowers[existingIndex].quantity || 1) + quantity;\n      } else {\n        updatedPowers.push({ \n          type: item.type, \n          quantity: quantity \n        });\n      }\n\n      // Update on server\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId: currentPlayer.playerId,\n        powers: updatedPowers\n      });\n\n      // Update local state\n      setCurrentPlayer(prev => ({\n        ...prev,\n        powers: updatedPowers\n      }));\n\n      // Handle combat stat modifications if the power has output\n      if (item.output && typeof item.qtycollected === 'number') {\n        if (item.output === 'range') {\n          // Range is stored on the player document\n          const updatedRange = (currentPlayer.range || 0) + item.qtycollected;\n          \n          await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { range: updatedRange }\n          });\n\n          // Update local player state and localStorage\n          const updatedPlayer = {\n            ...currentPlayer,\n            range: updatedRange\n          };\n          setCurrentPlayer(updatedPlayer);\n          localStorage.setItem('player', JSON.stringify(updatedPlayer));\n          \n          console.log(` Updated range on player document: ${updatedRange}`);\n        } else {\n          // Other combat stats updated in playersInGrid\n          const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer.playerId];\n          if (gridPlayer) {\n            const oldValue = gridPlayer[item.output] || 0;\n            const newValue = oldValue + item.qtycollected;\n            \n            await playersInGridManager.updatePC(gridId, currentPlayer.playerId, {\n              [item.output]: newValue\n            });\n            \n            console.log(` Updated ${item.output} for player ${currentPlayer.playerId}: ${oldValue} -> ${newValue}`);\n          }\n        }\n      }\n\n    } else {\n      console.error('Unknown item category:', item.category);\n      return false;\n    }\n\n    // Refresh player data to ensure consistency\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    return true;\n\n  } catch (error) {\n    console.error('Error in gainSkillOrPower:', error);\n    updateStatus(`Failed to acquire ${item.type}`);\n    return false;\n  }\n}\n\n/**\n * Check if player has a specific skill, upgrade, or power\n * @param {Object} player - Player object\n * @param {string} requirementType - Type of skill/upgrade/power to check for\n * @returns {boolean}\n */\nexport function hasSkillOrPower(player, requirementType) {\n  if (!requirementType) return true;\n  \n  return (\n    player.skills?.some(skill => skill.type === requirementType) ||\n    player.powers?.some(power => power.type === requirementType)\n  );\n}","/**\n * ScrollReveal.js\n * Helper functions for determining random scroll reveal outcomes\n */\n\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\n\n/**\n * Determines the random doober reward from revealing a scroll\n * @param {Array} masterResources - Master resource list\n * @param {Object} playerStats - Optional player stats for future scaling\n * @param {number} rollCount - Number of internal rolls to make (default: 3)\n * @returns {Object} { type: string, quantity: number }\n */\nexport function getRandomScrollReveal(masterResources, playerStats = null, rollCount = 3) {\n  // Filter resources that can be obtained from scrolls - any item with scrollchance defined\n  const scrollableItems = masterResources.filter(item => item.scrollchance);\n\n  if (scrollableItems.length === 0) {\n    console.warn('No scrollable items found in masterResources, using fallback');\n    return { type: 'Wood', quantity: 10 };\n  }\n\n  // Use the shared utility to select a weighted random item\n  // Scrolls are always level 1 for now (no level multiplier)\n  const selectedItem = selectWeightedRandomItem(scrollableItems, 1);\n  \n  if (selectedItem) {\n    const quantity = selectedItem.scrollqty || 1;\n    console.log(` Scroll reveal: ${selectedItem.type} x${quantity} (rarity: ${selectedItem.scrollchance})`);\n    \n    return {\n      type: selectedItem.type,\n      quantity: quantity\n    };\n  }\n  \n  // Fallback (shouldn't reach here)\n  const fallbackItem = scrollableItems[0];\n  return { \n    type: fallbackItem.type, \n    quantity: fallbackItem.scrollqty || 1 \n  };\n}\n\n/**\n * Get display name for scroll reveal result\n * @param {Object} reveal - The reveal result from getRandomScrollReveal\n * @param {Array} masterResources - Master resource list\n * @returns {string} Display string like \"5x Wood\"\n */\nexport function getRevealDisplayString(reveal, masterResources) {\n  const resource = masterResources.find(r => r.type === reveal.type);\n  const symbol = resource?.symbol || '';\n  return `${reveal.quantity}x ${symbol} ${reveal.type}`;\n}\n\n/**\n * Check if player can afford to reveal a scroll\n * @param {Object} recipe - The Reveal Scroll recipe\n * @param {Array} inventory - Player inventory\n * @param {Array} backpack - Player backpack\n * @returns {boolean}\n */\nexport function canAffordReveal(recipe, inventory, backpack) {\n  const playerItems = [...(inventory || []), ...(backpack || [])];\n  \n  // Check each ingredient requirement\n  for (let i = 1; i <= 5; i++) {\n    const ingredientType = recipe[`ingredient${i}`];\n    const ingredientQty = recipe[`ingredient${i}qty`] || 1;\n    \n    if (ingredientType) {\n      const playerQty = playerItems\n        .filter(item => item.type === ingredientType)\n        .reduce((sum, item) => sum + item.quantity, 0);\n        \n      if (playerQty < ingredientQty) {\n        return false;\n      }\n    }\n  }\n  \n  return true;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport TransactionButton from '../../UI/TransactionButton';\nimport { formatCountdown } from '../../UI/Timers';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport { selectWeightedRandomItem, getDropQuantity } from '../../Economy/DropRates';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport { getPersonalizedPetRewards } from '../../Utils/WarehouseMaterials';\nimport '../../UI/SharedButtons.css';\nimport '../../UI/ResourceButton.css'; \nimport './PetPanel.css';\n\n// Helper function to get a random reward from pets source with rarity weighting\nconst getRandomPetReward = (masterResources, petRewardRarity = 1, playerId) => {\n  // Get all resources with source === 'pets'\n  const petRewards = masterResources.filter(res => res.source === 'pets');\n  \n  if (petRewards.length === 0) {\n    console.warn('No pet rewards found in masterResources');\n    return null;\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedRewards = getPersonalizedPetRewards(petRewards, playerId);\n  \n  // Use the shared drop rate utility with pet reward rarity multiplier\n  // Higher rarity pets have better drop rates (rarity 2 = 2x rates, rarity 5 = 5x rates)\n  const selectedReward = selectWeightedRandomItem(personalizedRewards, petRewardRarity);\n  \n  if (!selectedReward) {\n    return null;\n  }\n  \n  // Determine quantity based on rarity using shared utility\n  const quantity = getDropQuantity(selectedReward.scrollchance || 'common');\n  \n  return {\n    type: selectedReward.type,\n    quantity,\n    rarity: selectedReward.scrollchance || 'common'\n  };\n};\n\nconst PetPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  petResource, // The specific pet resource that was clicked\n  currentPetPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const { updateStatus } = useContext(StatusBarContext);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [rewardItem, setRewardItem] = useState(null);\n  const [feedingCountdown, setFeedingCountdown] = useState(null);\n  const [isFeeding, setIsFeeding] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [revealedRewardQty, setRevealedRewardQty] = useState(1);\n  const [revealedRewardRarity, setRevealedRewardRarity] = useState('common');\n  const [isCollecting, setIsCollecting] = useState(false);\n  const [canAffordFeeding, setCanAffordFeeding] = useState(false);\n\n  // Get pet details from the resource\n  const petName = petResource?.type || 'Pet';\n  const petSymbol = petResource?.symbol || '=\u0015';\n  const feedIngredient = petResource?.output || 'Milk'; // What the pet needs to be fed\n  const feedQuantity = petResource?.qtycollected || 1; // How much of the ingredient is needed\n  const feedingTime = petResource?.crafttime || 60; // How long the pet takes to find rewards\n\n  // Check if we can afford to feed the pet\n  useEffect(() => {\n    const checkAffordability = () => {\n      const affordable = canAfford(\n        { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n        [...(inventory || []), ...(backpack || [])]\n      );\n      setCanAffordFeeding(affordable);\n    };\n    \n    checkAffordability();\n  }, [inventory, backpack, feedIngredient, feedQuantity]);\n\n  // Check for active feeding timer or ready rewards\n  useEffect(() => {\n    if (!petResource || !currentPetPosition) return;\n\n    const checkPetState = () => {\n      const pet = GlobalGridStateTilesAndResources.getResources()?.find(\n        (res) => res.x === currentPetPosition.x && res.y === currentPetPosition.y\n      );\n      \n      if (pet && pet.craftEnd && pet.craftedItem) {\n        // Check if this is a revealed reward (craftEnd in the past)\n        const now = Date.now();\n        const isRevealed = pet.craftEnd < now;\n        \n        setRewardItem(pet.craftedItem);\n        setRevealedRewardQty(pet.qty || 1);\n        setRevealedRewardRarity(pet.rarity || 'common');\n        \n        if (isRevealed) {\n          setIsFeeding(false);\n          setIsReadyToCollect(true);\n          setFeedingCountdown(0);\n          setActiveTimer(false);\n        } else {\n          // Pet is still searching for rewards\n          setIsFeeding(true);\n          setActiveTimer(true);\n          \n          const remainingTime = Math.max(0, Math.floor((pet.craftEnd - now) / 1000));\n          setFeedingCountdown(remainingTime);\n          \n          if (remainingTime === 0) {\n            setIsFeeding(false);\n            setIsReadyToCollect(true);\n          }\n        }\n      } else {\n        // Only reset if we actually had something before\n        if (rewardItem || isFeeding || isReadyToCollect) {\n          setRewardItem(null);\n          setIsFeeding(false);\n          setIsReadyToCollect(false);\n          setFeedingCountdown(null);\n          setActiveTimer(false);\n          setRevealedRewardQty(1);\n          setRevealedRewardRarity('common');\n        }\n      }\n    };\n\n    // Initial check\n    checkPetState();\n\n    // Set up interval to check for updates\n    const timer = setInterval(checkPetState, 1000);\n    return () => clearInterval(timer);\n  }, [petResource, currentPetPosition, rewardItem, isFeeding, isReadyToCollect]);\n\n  // Handle feeding the pet\n  const handleFeedPet = async (transactionId, transactionKey) => {\n    if (!canAffordFeeding) {\n      updateStatus(`You need ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)} to feed ${getLocalizedString(petName, strings)}`);\n      return;\n    }\n\n    try {\n      // First, spend the feed ingredients\n      const spentSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        recipe: { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n        inventory: currentPlayer.inventory,\n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n      });\n\n      if (!spentSuccess) {\n        updateStatus(`Failed to feed ${getLocalizedString(petName, strings)}`);\n        return;\n      }\n\n      // Generate random reward using pet's qtycollected for better drop rates\n      const petRewardRarity = petResource?.qtycollected || 1; // Default to rarity 1 if not specified\n      const reward = getRandomPetReward(masterResources, petRewardRarity, currentPlayer.playerId);\n      \n      if (!reward) {\n        console.error('Failed to generate pet reward');\n        updateStatus('Something went wrong while feeding the pet');\n        return;\n      }\n\n      // Start the feeding timer using standard craft API\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentPetPosition.x,\n        stationY: currentPetPosition.y,\n        recipe: {\n          type: reward.type,\n          crafttime: feedingTime,\n          // No ingredients since we already spent them\n        },\n        qty: reward.quantity,\n        rarity: reward.rarity, // Store rarity for display\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response if provided\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update pet resource in global state with qty and rarity\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentPetPosition.x && res.y === currentPetPosition.y\n            ? { ...res, craftEnd, craftedItem, qty: reward.quantity, rarity: reward.rarity }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setRewardItem(craftedItem);\n        setRevealedRewardQty(reward.quantity);\n        setRevealedRewardRarity(reward.rarity);\n        setFeedingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsFeeding(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Update status\n        const feedMessage = `Fed ${getLocalizedString(petName, strings)} ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)}`;\n        FloatingTextManager.addFloatingText(feedMessage, currentPetPosition.x, currentPetPosition.y, TILE_SIZE);\n        updateStatus(`${getLocalizedString(petName, strings)}${strings[8014] || ' is searching for treasures...'}`);\n\n        // Track quest progress for feeding pets\n        await trackQuestProgress(currentPlayer, 'Feed', petName, 1, setCurrentPlayer);\n      }\n    } catch (error) {\n      console.error('Error in pet feeding process:', error);\n      updateStatus(`Failed to feed ${getLocalizedString(petName, strings)}`);\n    }\n  };\n\n  // Handle collection of pet rewards\n  const handleCollectReward = async (transactionId, transactionKey) => {\n    if (!rewardItem || isCollecting) {\n      console.error(\"L No reward to collect or already collecting.\");\n      return;\n    }\n\n    setIsCollecting(true);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentPetPosition.x,\n        stationY: currentPetPosition.y,\n        craftedItem: rewardItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        const { collectedItem, isNPC } = response.data;\n        const collectedQty = revealedRewardQty || 1;\n\n        // Find the reward item in master resources to check its category\n        const rewardResource = masterResources.find(res => res.type === collectedItem);\n        \n        const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: collectedQty,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n        });\n\n        if (!gained) {\n            console.error('L Failed to add pet reward to inventory.');\n            setIsCollecting(false);\n            return;\n        }\n        \n        FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentPetPosition.x, currentPetPosition.y, TILE_SIZE);\n\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQty, setCurrentPlayer);\n\n        // Clear pet state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentPetPosition.x && res.y === currentPetPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined, qty: 1, rarity: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setRewardItem(null);\n        setFeedingCountdown(null);\n        setIsReadyToCollect(false);\n        setRevealedRewardQty(1);\n        setRevealedRewardRarity('common');\n\n        // Update status - only if we're not dealing with already owned skills/powers\n        if (!(rewardResource && (rewardResource.category === 'skill' || rewardResource.category === 'power' || rewardResource.category === 'upgrade') && \n            (rewardResource.category === 'skill' \n              ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n              : currentPlayer.powers?.some(power => power.type === collectedItem)))) {\n          updateStatus(`${getLocalizedString(petName, strings)} found ${collectedQty}x ${getLocalizedString(collectedItem, strings)}!`);\n        }\n\n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Clear collecting state after a brief delay\n        setTimeout(() => {\n          setIsCollecting(false);\n        }, 100);\n      } else {\n        setIsCollecting(false);\n      }\n    } catch (error) {\n      console.error('Error collecting pet reward:', error);\n      updateStatus('L Failed to collect reward');\n      setIsCollecting(false);\n    }\n  };\n\n  // Handle selling the pet for a refund\n  const handleSellPet = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType: petResource?.type || petName, // Use pet resource type\n      currentStationPosition: currentPetPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n\n  return (\n    <Panel onClose={onClose} title={getLocalizedString(petName, strings)} panelName=\"PetPanel\">\n      <div className=\"pet-panel-container\">\n        <div className=\"pet-panel-content\">\n\n          {/* Pet display */}\n          <div className=\"pet-display\">{petSymbol}</div>\n\n          {/* Pet info */}\n          <div className=\"pet-info\">\n\n            <p className=\"pet-status\">\n              {isFeeding ? (\n                `${getLocalizedString(petName, strings)}${strings[8014] || ' is searching for treasures...'}`\n              ) : isReadyToCollect ? (\n                `${getLocalizedString(petName, strings)}${strings[8016] || ' has found something!'}`\n              ) : (\n                <>\n                  {strings[8010] || 'This pet is hungry.'}<br/>\n                  {strings[8011] || 'Feed'} {feedQuantity}x {getLocalizedString(feedIngredient, strings)}{strings[8012] || ' to send it searching.'}\n                </>\n              )}\n            </p>\n          </div>\n\n          {/* Show feeding/collection state */}\n          {rewardItem && (isFeeding || isReadyToCollect) ? (\n            // Show animated pet searching or reward collection interface\n            isFeeding ? (\n              // Animated pet searching\n              <div className=\"pet-searching\">\n                <div className=\"pet-searching-countdown\">{formatCountdown(Date.now() + feedingCountdown * 1000, Date.now())}</div>\n              </div>\n            ) : (\n              // Use standard ResourceButton for collect state\n              (() => {\n                const rewardResource = masterResources.find(r => r.type === rewardItem);\n                \n                return (\n                  <ResourceButton\n                    symbol={rewardResource?.symbol || ''}\n                    name={`${getLocalizedString(rewardItem, strings)}${revealedRewardQty > 1 ? ` (${revealedRewardQty})` : ''}`}\n                    className={`resource-button pet-collect-button scroll-collect-button rarity-${revealedRewardRarity} ${isCollecting ? 'collecting' : 'ready'}`}\n                    disabled={!isReadyToCollect || isCollecting}\n                    isTransactionMode={isReadyToCollect && !isCollecting}\n                    transactionKey={isReadyToCollect ? `pet-collect-${rewardItem}-${currentPetPosition.x}-${currentPetPosition.y}` : undefined}\n                    onTransactionAction={isReadyToCollect ? handleCollectReward : undefined}\n                  />\n                );\n              })()\n            )\n          ) : !isCollecting ? (\n            // Show feed pet button when not feeding and not collecting\n            <ResourceButton\n              name={`${strings[8011] || 'Feed'} ${getLocalizedString(petName, strings)}`}\n              className=\"resource-button\"\n              details={`${strings[461] || 'Requires'} ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)}`}\n              ingredientDetails={getIngredientDetails(\n                { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n                masterResources\n              )}\n              disabled={!canAffordFeeding}\n              isValid={canAffordFeeding}\n              isTransactionMode={canAffordFeeding}\n              transactionKey={canAffordFeeding ? `pet-feed-${petName}-${currentPetPosition.x}-${currentPetPosition.y}` : undefined}\n              onTransactionAction={canAffordFeeding ? handleFeedPet : undefined}\n            />\n          ) : null}\n\n        </div>\n        \n        {/* Sell/refund button - only on homesteads */}\n        {currentPlayer.location.gtype === 'homestead' && (\n          <div className=\"pet-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellPet}\n                transactionKey={`sell-refund-${petName}-${currentPetPosition.x}-${currentPetPosition.y}-${gridId}`}\n              >\n                {strings[425] || 'Sell for refund'}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(PetPanel);","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport './AnimalStall.css';\n\nconst AnimalStall = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  isDeveloper,\n}) => {\n\n  const [stallDetails, setStallDetails] = useState(null);\n  const [outputDetails, setOutputDetails] = useState(null);\n  const strings = useStrings();\n\n  console.log('Inside Animal Stall:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const stallResource = masterResources.find((res) => res.type === stationType);\n    setStallDetails(stallResource);\n  }, [stationType, masterResources]);\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n  \n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1011\" titleKey=\"1111\" panelName=\"AnimalStall\" >\n      <div className=\"animalstall-panel-container\">\n        <div className=\"animalstall-panel-content\">\n          <h2>\n              {stallDetails?.symbol || ''} {stationType}\n          </h2>\n        </div>\n\n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"animalstall-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(AnimalStall);\n","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nconst CropPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  currentResource,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) => {\n  const [isActionCoolingDown, setIsActionCoolingDown] = useState(false);\n  const COOLDOWN_DURATION = 2000;\n  const [cropDetails, setCropDetails] = useState(null);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n  const strings = useStrings();\n\n  console.log('--------Inside Crop Panel:', { stationType, currentStationPosition, currentResource });\n\n  useEffect(() => {\n    const cropResource = masterResources.find((res) => res.type === stationType);\n    setCropDetails(cropResource);\n  }, [stationType, masterResources]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Function to generate countdown text like the tooltip\n  const getCropStatusText = () => {\n    if (!currentResource || !currentResource.growEnd) return \"Unknown status\";\n    \n    const remainingTime = Math.max(0, currentResource.growEnd - currentTime);\n    \n    if (remainingTime <= 0) {\n      return \"Ready for harvest!\";\n    }\n    \n    const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n    \n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n    \n    return `${parts.join(' ')} remaining`;\n  };\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async () => {\n    if (isActionCoolingDown) return;\n    setIsActionCoolingDown(true);\n    setTimeout(() => {\n      setIsActionCoolingDown(false);\n    }, COOLDOWN_DURATION);\n\n    const ingredients = [];\n    for (let i = 1; i <= 3; i++) {\n      const ingredientType = cropDetails[`ingredient${i}`];\n      const ingredientQty = cropDetails[`ingredient${i}qty`];\n      if (ingredientType && ingredientQty) {\n        ingredients.push({ type: ingredientType, quantity: ingredientQty });\n      }\n    }\n    if (!ingredients.length) { console.error('No ingredients found for refund.'); return; }\n\n    try {\n      for (const { type, quantity } of ingredients) {\n        const success = await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: type,\n          quantity,\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n        if (!success) return;\n      }\n\n      // Remove the crop resource from the grid\n      await updateGridResource(\n        gridId,\n        { type: null, x: currentStationPosition.x, y: currentStationPosition.y },\n        setResources,\n        true\n      );\n\n      setResources(prevResources =>\n        prevResources.filter(res => !(res.x === currentStationPosition.x && res.y === currentStationPosition.y))\n      );\n\n      const totalRefund = ingredients\n        .filter((item) => item.type === \"Money\")\n        .reduce((sum, item) => sum + item.quantity, 0);\n\n      console.log(`Sold ${stationType} successfully for ${totalRefund} Money.`);\n      updateStatus(439);\n      onClose();\n    } catch (error) {\n      console.error('Error selling the stall:', error);\n    }\n  };\n  \n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1030\" titleKey=\"1130\" panelName=\"CropPanel\" >\n      <div className=\"standard-panel\">\n        <h2>\n            {cropDetails?.symbol || ''} {stationType}\n        </h2>\n\n        {/* Show crop growth status */}\n        <p>\n          {getCropStatusText()}\n        </p>\n\n        {currentPlayer.location.gtype === 'homestead' && (\n          <>\n            <hr />\n              <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-success\" onClick={handleSellStation} disabled={isActionCoolingDown}>\n                  {strings[438]}\n                </button>\n              </div>\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(CropPanel);\n","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/TransactionButton';\nimport './DecoPanel.css';\n\nconst DecoPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  isDeveloper,\n}) => {\n  const [resourceDetails, setResourceDetails] = useState(null);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const strings = useStrings();\n\n  console.log('Inside Deco Panel:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const availableResource = masterResources.find((res) =>\n      res.type === stationType &&\n      (isHomestead || res.passable !== false)\n    );\n    setResourceDetails(availableResource);\n  }, [stationType, masterResources, isHomestead]);\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n  \n\n  return (\n    <Panel onClose={onClose} titleKey=\"1128\" panelName=\"DecoPanel\" >\n      <div className=\"deco-panel-container\">\n        <div className=\"deco-panel-content\">\n          <h2>\n              {resourceDetails?.symbol || ''} {getLocalizedString(stationType, strings)}\n          </h2>\n        </div>\n\n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"deco-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(DecoPanel);\n","import React, { useState, useMemo } from 'react';\nimport { getLocalizedString } from '../Utils/stringLookup';\nimport TransactionButton from './TransactionButton';\nimport { useStrings } from './StringsContext';\nimport './TradingInventoryModal.css';\n\nconst TradingInventoryModal = ({\n  isOpen,\n  onClose,\n  inventory,\n  resourceData,\n  amounts,\n  handleAmountChange,\n  handleAddToSlot,\n  getSlotConfig,\n  selectedSlotIndex,\n  transactionKeyPrefix = 'add-to-trade-slot'\n}) => {\n  const strings = useStrings();\n  const [sortField, setSortField] = useState('name');\n  const [sortDirection, setSortDirection] = useState('asc');\n\n  // Sort inventory data\n  const sortedInventory = useMemo(() => {\n    const filtered = inventory.filter(item => item.type !== 'Money' && item.type !== 'Gem');\n    \n    return filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortField) {\n        case 'name':\n          aValue = getLocalizedString(a.type, strings).toLowerCase();\n          bValue = getLocalizedString(b.type, strings).toLowerCase();\n          break;\n        case 'quantity':\n          aValue = a.quantity;\n          bValue = b.quantity;\n          break;\n        case 'price':\n          const aResource = resourceData.find(res => res.type === a.type);\n          const bResource = resourceData.find(res => res.type === b.type);\n          aValue = aResource?.maxprice || 0;\n          bValue = bResource?.maxprice || 0;\n          break;\n        case 'amount':\n          aValue = amounts[a.type] || 0;\n          bValue = amounts[b.type] || 0;\n          break;\n        default:\n          return 0;\n      }\n      \n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [inventory, resourceData, amounts, strings, sortField, sortDirection]);\n\n  const handleSort = (field) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (field) => {\n    if (sortField !== field) return '';\n    return sortDirection === 'asc' ? '' : '';\n  };\n\n  if (!isOpen) return null;\n\n  const slotConfig = getSlotConfig(selectedSlotIndex);\n\n  return (\n    <div className=\"inventory-modal wider\">\n      <button className=\"close-button\" onClick={onClose}></button>\n      \n      <h2>{strings[160]}</h2>\n      \n      <p className=\"trading-modal-subtitle\">\n        {slotConfig.maxAmount} {strings[158]}\n      </p>\n      \n      <div className=\"inventory-modal-container\">\n        <div className=\"inventory-modal-header\">\n          <table>\n            <thead>\n              <tr>\n                <th onClick={() => handleSort('name')} className=\"sortable-header\">\n                  {strings[161]} {getSortIcon('name')}\n                </th>\n                <th onClick={() => handleSort('quantity')} className=\"sortable-header\">\n                  {strings[162]} {getSortIcon('quantity')}\n                </th>\n                <th onClick={() => handleSort('price')} className=\"sortable-header\">\n                  {strings[163]} {getSortIcon('price')}\n                </th>\n                <th onClick={() => handleSort('amount')} className=\"sortable-header\">\n                  {strings[164]} {getSortIcon('amount')}\n                </th>\n                <th></th>\n              </tr>\n            </thead>\n          </table>\n        </div>\n        \n        <div className=\"inventory-modal-scroll\">\n          <table>\n            <tbody>\n              {sortedInventory.map((item) => {\n                const resourceDetails = resourceData.find((res) => res.type === item.type);\n                const price = resourceDetails?.maxprice || 'N/A';\n\n                return (\n                  <tr key={item.type}>\n                    <td>{resourceDetails?.symbol} {getLocalizedString(item.type, strings)}</td>\n                    <td>{item.quantity}</td>\n                    <td> {price}</td>\n                    <td>\n                      <div className=\"amount-input\">\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, (amounts[item.type] || 0) - 1)\n                          }\n                          disabled={(amounts[item.type] || 0) <= 0}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"number\"\n                          value={amounts[item.type] || 0}\n                          onChange={(e) =>\n                            handleAmountChange(item.type, parseInt(e.target.value, 10) || 0)\n                          }\n                        />\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, (amounts[item.type] || 0) + 1)\n                          }\n                          disabled={(amounts[item.type] || 0) >= Math.min(item.quantity, slotConfig.maxAmount)}\n                        >\n                          +\n                        </button>\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, Math.min(item.quantity, slotConfig.maxAmount))\n                          }\n                          style={{ marginLeft: '4px' }}\n                        >\n                          {strings[165]}\n                        </button>\n                      </div>\n                    </td>\n                    <td>\n                      <TransactionButton\n                        className=\"add-button\"\n                        onAction={(transactionId, transactionKey) => \n                          handleAddToSlot(transactionId, transactionKey, item.type)\n                        }\n                        transactionKey={`${transactionKeyPrefix}-${item.type}`}\n                        disabled={\n                          !(amounts[item.type] > 0 && amounts[item.type] <= item.quantity)\n                        }\n                      >\n                        {strings[166]}\n                      </TransactionButton>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TradingInventoryModal;","import React, { useState, useEffect } from 'react';\nimport Modal from '../../UI/Modal';\nimport TransactionButton from '../../UI/TransactionButton';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/SharedButtons.css';\nimport './GlobalMarketModal.css';\n\n/**\n * Global Market Modal - Shows all players in settlement with items for sale\n * Displays one user per row with their tradestall slots and buy buttons\n */\nfunction GlobalMarketModal({ \n  isOpen, \n  onClose, \n  currentPlayer, \n  onBuyItem,\n  masterResources,\n  globalTuning \n}) {\n  const strings = useStrings();\n  const [settlementPlayers, setSettlementPlayers] = useState([]);\n  const [playerTradeStalls, setPlayerTradeStalls] = useState({});\n  const [resourceData, setResourceData] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Fetch all players and their trade stalls when modal opens\n  useEffect(() => {\n    if (!isOpen || !currentPlayer?.location?.s) return;\n\n    const fetchGlobalMarketData = async () => {\n      setIsLoading(true);\n      try {\n        // Fetch players in settlement\n        const settlementResponse = await axios.get(`${API_BASE}/api/players-in-settlement`, {\n          params: { settlementId: currentPlayer.location.s },\n        });\n        const players = settlementResponse.data.players || [];\n        setSettlementPlayers(players);\n\n        // Fetch resource data for symbols\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        setResourceData(resourcesResponse.data);\n\n        // Fetch trade stalls for all players in parallel\n        const tradeStallPromises = players.map(player => \n          axios.get(`${API_BASE}/api/player-trade-stall`, {\n            params: { playerId: player.playerId },\n          }).then(response => ({\n            playerId: player.playerId,\n            tradeStall: response.data.tradeStall || []\n          })).catch(error => ({\n            playerId: player.playerId,\n            tradeStall: []\n          }))\n        );\n\n        const tradeStallResults = await Promise.all(tradeStallPromises);\n        const tradeStallsData = {};\n        tradeStallResults.forEach(result => {\n          tradeStallsData[result.playerId] = result.tradeStall;\n        });\n\n        setPlayerTradeStalls(tradeStallsData);\n      } catch (error) {\n        console.error('Error fetching global market data:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchGlobalMarketData();\n  }, [isOpen, currentPlayer?.location?.s]);\n\n  // Filter players who have items for sale (excluding current player)\n  const getPlayersWithItems = () => {\n    return settlementPlayers.filter(player => {\n      // Exclude current player from the list\n      if (player.playerId === currentPlayer.playerId) {\n        return false;\n      }\n      \n      const stall = playerTradeStalls[player.playerId];\n      return stall && stall.some(slot => \n        slot?.resource && \n        slot?.amount > 0 && \n        !slot?.boughtBy // Not sold - that's all we need to check\n      );\n    }).sort((a, b) => {\n      // Sort by username alphabetically\n      return a.username.localeCompare(b.username);\n    });\n  };\n\n  // Get symbol for a resource type\n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n\n  // Handle buying an item - delegates to parent component\n  const handleBuyItem = async (playerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      await onBuyItem(playerId, slotIndex, transactionId, transactionKey);\n      \n      // Refresh the trade stall data for this player after purchase\n      const response = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId },\n      });\n      \n      setPlayerTradeStalls(prev => ({\n        ...prev,\n        [playerId]: response.data.tradeStall || []\n      }));\n    } catch (error) {\n      console.error('Error in global market buy:', error);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  const playersWithItems = getPlayersWithItems();\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={onClose} \n      title={strings[362] || \"Global Market\"} \n      size=\"large\"\n      className=\"global-market-modal\"\n    >\n      <div className=\"global-market-content\">\n        {isLoading ? (\n          <div className=\"loading-container\">\n            <div className=\"loading-text\">{strings[98] || \"Loading...\"}</div>\n          </div>\n        ) : playersWithItems.length === 0 ? (\n          <div className=\"no-items-container\">\n            <div className=\"no-items-text\">{strings[363] || \"No items currently available for purchase\"}</div>\n          </div>\n        ) : (\n          <div className=\"players-list\">\n            {playersWithItems.map(player => {\n              const stall = playerTradeStalls[player.playerId] || [];\n              const availableSlots = stall.filter(slot => \n                slot?.resource && \n                slot?.amount > 0 && \n                !slot?.boughtBy // Show all unsold items, regardless of timer\n              );\n\n              return (\n                <div key={player.playerId} className=\"player-row\">\n                  <div className=\"player-info\">\n                    <div className=\"player-username\">{player.username}</div>\n                    <div className=\"player-items-count\">\n                      {availableSlots.length} {strings[364] || \"items available\"}\n                    </div>\n                  </div>\n                  \n                  <div className=\"player-slots\">\n                    {availableSlots.map((slot, slotIndex) => {\n                      // Find the actual slot index in the full stall\n                      const actualSlotIndex = stall.findIndex(s => s === slot);\n                      const totalCost = slot.amount * slot.price;\n                      \n                      return (\n                        <div key={actualSlotIndex} className=\"slot-item\">\n                          <div className=\"slot-info\">\n                            <div className=\"slot-item-name\">\n                              {slot.amount}x {getSymbol(slot.resource)} {getLocalizedString(slot.resource, strings)}\n                            </div>\n                          </div>\n                          \n                          <div className=\"slot-button\">\n                            <div className=\"shared-buttons\">\n                              <TransactionButton\n                                className=\"btn-basic btn-success\"\n                                transactionKey={`global-market-buy-${player.playerId}-${actualSlotIndex}`}\n                                onAction={(transactionId, transactionKey) => \n                                  handleBuyItem(player.playerId, actualSlotIndex, transactionId, transactionKey)\n                                }\n                              >\n                                {strings[365] || \"Buy\"} {totalCost}\n                              </TransactionButton>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n      \n      <div className=\"global-market-footer\">\n        <div className=\"shared-buttons\">\n          <button \n            onClick={onClose}\n            className=\"btn-basic btn-neutral\"\n          >\n            {strings[366] || \"Close\"}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default GlobalMarketModal;","import API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel'; // Use Panel instead of Modal\nimport TransactionButton from '../../UI/TransactionButton';\nimport TradingInventoryModal from '../../UI/TradingInventoryModal';\nimport axios from 'axios';\nimport './TradeStall.css';\nimport '../../UI/Modal.css';\nimport '../../UI/SharedButtons.css';\nimport { spendIngredients, gainIngredients, refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { handlePurchase } from '../../Store/Store';\nimport GlobalMarketModal from './GlobalMarketModal';\n\nfunction TradeStall({ onClose, inventory, setInventory, backpack, setBackpack, currentPlayer, setCurrentPlayer, globalTuning, setModalContent, setIsModalOpen, masterResources }) {\n\n  const strings = useStrings();\n  const [tradeSlots, setTradeSlots] = useState([]);\n  const [selectedSlotIndex, setSelectedSlotIndex] = useState(null);\n  const [amounts, setAmounts] = useState({}); // Store amounts per resource\n  const [totalSellValue, setTotalSellValue] = useState(0);\n  const [resourceData, setResourceData] = useState([]); // Store resource data\n  const { updateStatus } = useContext(StatusBarContext);\n  const [isLoadingInitial, setIsLoadingInitial] = useState(true); // Loading state for initial data fetch\n  const [isGlobalMarketOpen, setIsGlobalMarketOpen] = useState(false); // Global Market modal state\n\n  const tradeStallSlotConfig = globalTuning?.tradeStallSlots || [];\n  \n  // Get slot-specific configuration\n  const getSlotConfig = (slotIndex) => {\n    const config = tradeStallSlotConfig.find(slot => slot.slotIndex === slotIndex);\n    return config || {\n      maxAmount: 50,\n      sellWaitTime: currentPlayer.firsttimeuser ? 5000 : 300000,\n      unlocked: slotIndex === 0,\n      unlockCost: 0,\n      requiresGoldPass: false\n    };\n  };\n  \n  const isSlotUnlocked = (slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    const config = getSlotConfig(slotIndex);\n    \n    // If slot doesn't exist\n    if (!slot) {\n      return false;\n    }\n    \n    // Handle backward compatibility - if locked field is undefined\n    if (slot.locked === undefined) {\n      // For backward compatibility: slots with items are considered unlocked\n      if (slot.resource && slot.amount > 0) {\n        return true;\n      }\n      // Otherwise, only first slot is unlocked by default\n      return slotIndex === 0;\n    }\n    \n    // If slot is explicitly locked\n    if (slot.locked === true) {\n      // Check if it's a Gold Pass slot and user has Gold Pass\n      if (config.requiresGoldPass && currentPlayer.accountStatus === 'Gold') {\n        return true; // Gold Pass overrides the locked state\n      }\n      return false;\n    }\n    \n    return true; // If not locked, it's unlocked\n  };\n  \n  const handleUnlockSlot = async (slotIndex) => {\n    const config = getSlotConfig(slotIndex);\n    if (!config || config.requiresGoldPass) return;\n    \n    try {\n      // First, use spendIngredients to handle the wood cost properly\n      const tempRecipe = { \n        ingredient1: 'Wood', \n        ingredient1qty: config.unlockCost \n      };\n      \n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: tempRecipe,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {}, // No-op\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) {\n        console.warn('Not enough Wood to unlock this slot.');\n        updateStatus(`${strings[177]} ${config.unlockCost} ${getSymbol('Wood')} ${strings[176]} ${strings[178]}`);\n        return;\n      }\n      \n      // If wood was spent successfully, update only this specific slot\n      const updatedSlots = tradeSlots.map((slot, index) => {\n        if (index === slotIndex) {\n          return {\n            ...slot,\n            locked: false\n          };\n        }\n        return slot;\n      });\n      \n      // Update the trade stall on the server\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: currentPlayer.playerId,\n        tradeStall: updatedSlots\n      });\n      \n      // Update local state\n      setTradeSlots(updatedSlots);\n      setCurrentPlayer({\n        ...currentPlayer,\n        tradeStall: updatedSlots\n      });\n      \n      // Refresh player data to ensure consistency\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      \n      // Re-fetch trade stall data to ensure UI is in sync\n      await fetchDataForViewedPlayer(true); // Skip inventory fetch since it was just updated\n      \n      updateStatus(`${strings[170]}`);\n    } catch (error) {\n      console.error('Error unlocking slot:', error);\n      updateStatus('Failed to unlock slot');\n    }\n  };\n\n\n  // Lift fetchDataForViewedPlayer out of useEffect for reuse\n  const fetchDataForViewedPlayer = async (skipInventoryFetch = false) => {\n    try {\n      if (!skipInventoryFetch) {\n        setIsLoadingInitial(true);\n      }\n      // Fetch resource data (e.g., for prices)\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      setResourceData(resourcesResponse.data);\n\n      // Only fetch inventory if not skipping (to avoid overwriting during collections)\n      if (!skipInventoryFetch) {\n        const currentInventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(currentInventoryResponse.data.inventory || []);\n      }\n\n      // Fetch trade stall data for the current player\n      const tradeStallResponse = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId: currentPlayer.playerId },\n      });\n\n      // Always show all 6 slots\n      const serverSlots = tradeStallResponse.data.tradeStall || [];\n      \n      // Ensure we have exactly 6 slots from server, preserve existing slot data\n      const allSlots = Array.from({ length: 6 }, (_, index) => {\n        const existingSlot = serverSlots.find(slot => slot && slot.slotIndex === index);\n        if (existingSlot) {\n          // Preserve all existing slot data including locked state\n          return existingSlot;\n        }\n        // Only create default locked slot if it doesn't exist on server\n        return {\n          slotIndex: index,\n          locked: true,\n          resource: null,\n          amount: 0,\n          price: 0,\n          sellTime: null,\n          boughtBy: null,\n          boughtFor: null\n        };\n      });\n      \n      setTradeSlots(allSlots);\n\n      // Calculate total sell value for current player's stall\n      const total = allSlots.reduce((sum, slot) => {\n        if (slot?.resource && slot?.amount && slot?.price && !slot?.boughtBy) {\n          return sum + slot.amount * slot.price;\n        }\n        return sum;\n      }, 0);\n      setTotalSellValue(total);\n    } catch (error) {\n      console.error('Error fetching TradeStall data:', error);\n    } finally {\n      setIsLoadingInitial(false);\n    }\n  };\n\n  useEffect(() => {\n    // Only fetch data for current player's own trade stall\n    fetchDataForViewedPlayer();\n  }, [currentPlayer?.playerId]); // Only depend on current player\n  \n  // Handle buying from global market\n  const handleGlobalMarketBuy = async (playerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      // Re-fetch latest data to confirm availability\n      const tradeStallResponse = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId },\n      });\n      const latestSlots = tradeStallResponse.data.tradeStall || [];\n      const currentSlot = latestSlots[slotIndex];\n      \n      if (!currentSlot || currentSlot.boughtBy) {\n        updateStatus(155); // Item was already purchased\n        return;\n      }\n\n      const totalCost = currentSlot.amount * currentSlot.price;\n      const currentMoney = inventory.find((item) => item.type === 'Money')?.quantity || 0;\n\n      if (totalCost > currentMoney) {\n        console.warn('Not enough money to complete the purchase.');\n        updateStatus(152);\n        return;\n      }\n\n      // Use the same purchase logic as the original handleBuy\n      const tempRecipe = { ingredient1: 'Money', ingredient1qty: totalCost };\n\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: tempRecipe,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) {\n        console.warn('Not enough Money to buy this item.');\n        return;\n      }\n\n      await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: currentSlot.resource,\n        quantity: currentSlot.amount,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Update the seller's TradeStall to mark the slot as purchased\n      const updatedSlots = [...latestSlots];\n      updatedSlots[slotIndex] = {\n        ...currentSlot,\n        sellTime: null,\n        boughtBy: currentPlayer.username,\n        boughtFor: totalCost,\n      };\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: playerId,\n        tradeStall: updatedSlots,\n      });\n\n      updateStatus(22); // Purchase successful\n    } catch (error) {\n      console.error('Error processing global market purchase:', error);\n      throw error;\n    }\n  };\n  \n  // Auto-set max Wheat amount for FTUE users at step 3 or less\n  useEffect(() => {\n    if (selectedSlotIndex !== null && currentPlayer.firsttimeuser === true && currentPlayer.ftuestep <= 3) {\n      // Find wheat in inventory\n      const wheatItem = inventory.find(item => item.type === 'Wheat');\n      if (wheatItem) {\n        const slotConfig = getSlotConfig(selectedSlotIndex);\n        const maxAmount = Math.min(wheatItem.quantity, slotConfig.maxAmount);\n        setAmounts(prev => ({\n          ...prev,\n          'Wheat': maxAmount\n        }));\n      }\n    }\n  }, [selectedSlotIndex, currentPlayer.firsttimeuser, currentPlayer.ftuestep, inventory]);\n\n  const handleSlotClick = (index) => {\n    const slot = tradeSlots[index];\n    const isEmpty = !slot?.resource;\n    const slotUnlocked = isSlotUnlocked(index);\n    const config = getSlotConfig(index);\n    \n    console.log('Slot clicked:', index, 'Is unlocked:', slotUnlocked, 'Is empty:', isEmpty);\n\n    // If slot is locked\n    if (!slotUnlocked) {\n      if (config.requiresGoldPass && currentPlayer.accountStatus !== 'Gold') {\n        // Gold Pass required - do nothing, button will handle it\n        return;\n      } else if (!config.requiresGoldPass) {\n        // Regular unlock with wood - do nothing, button will handle it\n        return;\n      }\n    }\n    \n    // Only allow slot clicks for empty, unlocked slots\n    if (isEmpty && slotUnlocked) {\n      setSelectedSlotIndex(index); // Open inventory modal\n      // Reset amounts when opening modal to prevent quantity persistence bug\n      setAmounts({});\n    }\n    // All other clicks do nothing\n  };\n  \n\n  \n  \n  const handleAmountChange = (type, value) => {\n    const resourceInInventory = inventory.find((item) => item.type === type);\n    const inventoryAmount = resourceInInventory ? resourceInInventory.quantity : 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    const maxAmount = Math.min(inventoryAmount, slotConfig.maxAmount);\n  \n    setAmounts((prev) => ({\n      ...prev,\n      [type]: Math.min(Math.max(0, value), maxAmount), // Ensure value is within 0 and maxAmount\n    }));\n  };\n\n  const handleAddToSlot = async (transactionId, transactionKey, resource) => {\n    let amount = amounts[resource] || 0;\n    const resourceInInventory = inventory.find((item) => item.type === resource);\n\n    if (selectedSlotIndex === null || amount <= 0 || !resourceInInventory || amount > resourceInInventory.quantity) {\n      console.warn('Invalid amount or resource exceeds available quantity.');\n      return;\n    }\n    \n    // Get slot configuration and enforce max amount limit\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    if (amount > slotConfig.maxAmount) {\n      amount = slotConfig.maxAmount;\n      console.log(`Amount adjusted to slot limit: ${amount} (max: ${slotConfig.maxAmount})`);\n    }\n\n    // Check if selling all of a crop item\n    if (amount === resourceInInventory.quantity && isACrop(resource, masterResources)) {\n      // Check if the plot for this crop has a cost\n      const plotResource = masterResources.find(res => res.output === resource && res.category === 'farmplot');\n      const plotHasCost = plotResource && plotResource.ingredient1qty > 0;\n      \n      // Only show confirmation if the plot has a cost (e.g., Corn Plot costs 1 Corn)\n      if (plotHasCost) {\n        // Show confirmation modal using standard modal system\n        setModalContent({\n        title: ' Warning',\n        message: `This will leave you with 0 ${resource}, so you will not be able to plant ${resource} again.`,\n        message2: 'Are you sure?',\n        size: 'small',\n        onClose: () => setIsModalOpen(false),\n        children: (\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n            <button\n              className=\"btn-basic btn-neutral\"\n              onClick={() => setIsModalOpen(false)}\n            >\n              Cancel\n            </button>\n            <button \n              className=\"btn-basic btn-danger\"\n              onClick={async () => {\n                setIsModalOpen(false);\n                // Re-check slot limit in case it changed\n                const slotConfig = getSlotConfig(selectedSlotIndex);\n                const finalAmount = Math.min(amount, slotConfig.maxAmount);\n                await performAddToSlot(transactionId, transactionKey, resource, finalAmount);\n              }}\n            >\n              {strings[168]}\n            </button>\n          </div>\n        ),\n      });\n      setIsModalOpen(true);\n      return;\n      }\n    }\n\n    // Continue with normal add to slot\n    await performAddToSlot(transactionId, transactionKey, resource, amount);\n  };\n\n  const performAddToSlot = async (transactionId, transactionKey, resource, amount) => {\n    const resourceDetails = resourceData.find((item) => item.type === resource);\n    const price = resourceDetails?.maxprice || 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n\n    const updatedSlots = [...tradeSlots];\n    // Update the specific slot with the new item, preserving slotIndex\n    updatedSlots[selectedSlotIndex] = { \n      slotIndex: selectedSlotIndex,\n      resource, \n      amount, \n      price, \n      sellTime: Date.now() + slotConfig.sellWaitTime,\n      boughtBy: null,\n      boughtFor: null\n    };\n\n    try {\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: currentPlayer.playerId,\n        tradeStall: updatedSlots,\n      });\n\n      await axios.post(`${API_BASE}/api/update-inventory`, {\n        playerId: currentPlayer.playerId,\n        inventory: inventory.map((item) =>\n          item.type === resource\n            ? { ...item, quantity: item.quantity - amount }\n            : item\n        ).filter((item) => item.quantity > 0),\n      });\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      const refreshedInventory = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(refreshedInventory.data.inventory);\n\n      setTradeSlots(updatedSlots);\n      setSelectedSlotIndex(null);\n      calculateTotalSellValue(updatedSlots);\n    } catch (error) {\n      console.error('Error adding item to Trade Stall:', error);\n      throw error; // Re-throw to let TransactionButton handle the error state\n    }\n  };\n\n  \n  // Protected function to sell items to game using transaction system\n  const handleSellSingle = async (transactionId, transactionKey, slotIndex) => {\n    console.log(` [PROTECTED SELL] Starting protected sell for slot ${slotIndex}`);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/trade-stall/sell-to-game`, {\n        playerId: currentPlayer.playerId,\n        slotIndex,\n        transactionId,\n        transactionKey: `${transactionKey}-${slotIndex}`\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        if (response.data.tradeStall) {\n          setTradeSlots(response.data.tradeStall);\n          // Also update currentPlayer to trigger UI updates\n          setCurrentPlayer(prev => ({\n            ...prev,\n            tradeStall: response.data.tradeStall\n          }));\n        }\n        if (response.data.inventory) {\n          setInventory(response.data.inventory);\n          // Also update currentPlayer's inventory to trigger UI updates\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        // Track quest progress for selling this item\n        await trackQuestProgress(currentPlayer, 'Sell', response.data.resource, response.data.amount, setCurrentPlayer);\n        \n        updateStatus(`${strings[141]} ${response.data.amount}x ${getLocalizedString(response.data.resource, strings)} ( ${response.data.sold}).`);\n        \n        // Refresh trade stall data to ensure consistency\n        await fetchDataForViewedPlayer(true); // Skip inventory fetch to preserve server state\n      }\n    } catch (error) {\n      console.error('Error in protected sell:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to sell item');\n      }\n    }\n  };\n\n  const calculateTotalSellValue = (slots) => {\n    console.log('Inside calculateTotalSetllValue; Current Inventory:', inventory);\n    const total = slots.reduce((sum, slot) => {\n      if (slot?.amount && slot?.price) {\n        return sum + slot.amount * slot.price;\n      }\n      return sum;\n    }, 0);\n    setTotalSellValue(total);\n  };\n\n  \n  \n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n  \n  // Protected function to collect payment from a bought slot using transaction system\n  const handleCollectPayment = async (transactionId, transactionKey, slotIndex) => {\n    console.log(` [PROTECTED COLLECTION] Starting protected collection for slot ${slotIndex}`);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/trade-stall/collect-payment`, {\n        playerId: currentPlayer.playerId,\n        slotIndex,\n        transactionId,\n        transactionKey: `${transactionKey}-${slotIndex}`\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        if (response.data.tradeStall) {\n          setTradeSlots(response.data.tradeStall);\n        }\n        if (response.data.inventory) {\n          setInventory(response.data.inventory);\n          // Force update currentPlayer to trigger UI refresh\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory,\n            tradeStall: response.data.tradeStall\n          }));\n        }\n\n        // Track quest progress for selling this item\n        await trackQuestProgress(currentPlayer, 'Sell', response.data.resource, response.data.amount, setCurrentPlayer);\n        \n        updateStatus(` Collected ${response.data.collected}.`);\n        \n        // Refresh trade stall data to ensure consistency\n        await fetchDataForViewedPlayer(true); // Skip inventory fetch to preserve server state\n      }\n    } catch (error) {\n      console.error('Error in protected collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect payment');\n      }\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"TradeStall\">\n\n      {/* GLOBAL MARKET BUTTON */}\n\n        <div className=\"shared-buttons\" style={{ margin: '2px 0' }}>\n          <button \n            className=\"btn-basic btn-success\"\n            onClick={() => setIsGlobalMarketOpen(true)}\n          >\n             {strings[362] || \"Global Market\"}\n          </button>\n        </div>\n\n      {/* SEPARATOR AND HEADER */}\n      <div style={{ margin: '16px 0' }}>\n        <hr style={{ border: 'none', borderTop: '1px solid #ddd', margin: '0 0 12px 0' }} />\n        <h3 style={{ textAlign: 'center', margin: '0', fontSize: '16px', fontWeight: 'bold', color: '#333' }}>\n          {strings[367] || \"Your Trade Slots:\"}\n        </h3>\n      </div>\n\n      {/* LOADING INDICATOR */}\n      {isLoadingInitial ? (\n        <div style={{ textAlign: 'center', padding: '40px', fontSize: '1.2rem' }}>\n          {strings[98]}\n        </div>\n      ) : (\n        <>\n          {/* TRADE STALL SLOTS */}\n          <div className=\"trade-stall-slots shared-buttons\">\n        {tradeSlots.map((slot, index) => {\n          // Check if we should hide this slot for FTUE users\n          if (currentPlayer.firsttimeuser === true && currentPlayer.ftuestep <= 3 && index > 0) {\n            return null; // Don't render slots after the first one for new players at step 3 or less\n          }\n          const isOwnStall = true; // Always viewing own stall now\n          const isEmpty = !slot?.resource;\n          const isPurchased = slot?.boughtBy;\n          const isReadyToSell = slot?.sellTime && slot.sellTime <= Date.now();\n          const hasTimer = slot?.sellTime && slot.sellTime > Date.now();\n          const slotUnlocked = isSlotUnlocked(index);\n          const config = getSlotConfig(index);\n          \n          return (\n            <React.Fragment key={index}>\n              <div className=\"trade-slot-container\">\n                {/* 1. SLOT DISPLAY */}\n                <div\n                  className={`trade-slot btn-basic ${isEmpty && slotUnlocked ? 'btn-neutral' : ''} ${!isEmpty && !isPurchased && !isReadyToSell ? 'filled' : ''} ${isPurchased ? 'btn-collect' : ''} ${!slotUnlocked && index >= 4 ? 'locked gold-slot btn-gold' : !slotUnlocked ? 'locked' : ''} ${isReadyToSell && !isPurchased ? 'btn-sell' : ''}`}\n                  onClick={() => {\n                    if (isOwnStall && isEmpty && slotUnlocked) {\n                      handleSlotClick(index);\n                    } else if (isOwnStall && isPurchased) {\n                      // Handle collect payment\n                      handleCollectPayment(`collect-${Date.now()}`, 'collect-payment', index);\n                    } else if (isOwnStall && isReadyToSell && !isPurchased) {\n                      // Handle sell to game\n                      handleSellSingle(`sell-${Date.now()}`, 'sell-to-game', index);\n                    }\n                  }}\n                >\n                  {(index >= 4 && currentPlayer.accountStatus !== 'Gold' && isOwnStall) ? (\n                    // Always show Gold Pass required for slots 5-6 for non-Gold users\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div className=\"trade-slot-lock-text\">{strings[171]}</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : (!slotUnlocked && isOwnStall) ? (\n                    // Show unlock UI for locked slots on own stall\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : isEmpty ? (\n                    <div className=\"trade-slot-empty-text\">\n                      <div> {strings[156]}</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"trade-slot-content\">\n                      <div className=\"trade-slot-item-name\">\n                        {`${slot.amount}x ${getSymbol(slot.resource)} ${getLocalizedString(slot.resource, strings)}`}\n                      </div>\n                      {isPurchased && (\n                        <>\n                          <div className=\"trade-slot-status\">\n                            {strings[157]} {slot.boughtBy}\n                          </div>\n                          <div className=\"trade-slot-status\">\n                            {strings[318]} {slot.boughtFor}\n                          </div>\n                        </>\n                      )}\n                      {hasTimer && !isPurchased && (\n                        <div className=\"trade-slot-status timer\">\n                          {formatCountdown(slot.sellTime, Date.now())}\n                        </div>\n                      )}\n                      {isReadyToSell && !isPurchased && (\n                        <div className=\"trade-slot-status ready\">\n                          {strings[167]} {slot.amount * slot.price}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                {/* 2. BUTTON CONTAINER */}\n                {(index >= 4 && currentPlayer.accountStatus !== 'Gold' && isOwnStall) ? (\n                  // Show Gold Pass purchase button for slots 5-6\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button \n                        className=\"btn-basic btn-gold\"\n                        style={{ width: '100%' }}\n                        onClick={() => handlePurchase(1, currentPlayer, updateStatus)}\n                      >\n                        {strings[9061]}\n                      </button>\n                    </div>\n                  </div>\n                ) : (!slotUnlocked && isOwnStall) ? (\n                  // Show unlock button for locked non-Gold Pass slots\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button \n                        className=\"btn-basic btn-neutral\"\n                        style={{ width: '100%' }}\n                        onClick={() => handleUnlockSlot(index)}\n                      >\n                        {strings[175]} {config.unlockCost} {getSymbol('Wood')} {strings[176]}\n                      </button>\n                    </div>\n                  </div>\n                ) : null}\n              </div>\n            </React.Fragment>\n          );\n        })}\n      </div>\n        </>\n      )}\n\n{/* TRADING INVENTORY MODAL */}\n      <TradingInventoryModal\n        isOpen={selectedSlotIndex !== null}\n        onClose={() => setSelectedSlotIndex(null)}\n        inventory={inventory}\n        resourceData={resourceData}\n        amounts={amounts}\n        handleAmountChange={handleAmountChange}\n        handleAddToSlot={handleAddToSlot}\n        getSlotConfig={getSlotConfig}\n        selectedSlotIndex={selectedSlotIndex}\n        transactionKeyPrefix=\"add-to-trade-slot\"\n      />\n\n      {/* GLOBAL MARKET MODAL */}\n      <GlobalMarketModal\n        isOpen={isGlobalMarketOpen}\n        onClose={() => setIsGlobalMarketOpen(false)}\n        currentPlayer={currentPlayer}\n        onBuyItem={handleGlobalMarketBuy}\n        masterResources={masterResources}\n        globalTuning={globalTuning}\n      />\n\n    </Panel>\n  );\n};\n\nexport default TradeStall;","import API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport TransactionButton from '../../UI/TransactionButton';\nimport TradingInventoryModal from '../../UI/TradingInventoryModal';\nimport axios from 'axios';\nimport './TradeStall.css';\nimport '../../UI/Modal.css';\nimport '../../UI/SharedButtons.css';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\n\nfunction Outpost({ onClose, backpack, setBackpack, currentPlayer, setCurrentPlayer, gridId, setModalContent, setIsModalOpen, isDeveloper, stationType, currentStationPosition, setResources, setInventory, TILE_SIZE, globalTuning }) {\n  const strings = useStrings();\n  const [tradeSlots, setTradeSlots] = useState([]);\n  const [selectedSlotIndex, setSelectedSlotIndex] = useState(null);\n  const [amounts, setAmounts] = useState({}); // Store amounts per resource\n  const [resourceData, setResourceData] = useState([]); // Store resource data\n  const { updateStatus } = useContext(StatusBarContext);\n  const [masterResources, setMasterResources] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n\n  // Use Trading Post configuration from globalTuning\n  const OUTPOST_SLOTS = 4;\n  \n  // Get slot-specific configuration\n  const getSlotConfig = (slotIndex) => {\n    const slotConfig = globalTuning?.tradeStallSlots?.find(slot => slot.slotIndex === slotIndex);\n    return slotConfig || {\n      maxAmount: 50,\n      sellWaitTime: 300000\n    };\n  };\n\n  // Initialize trade slots structure\n  useEffect(() => {\n    const initSlots = [];\n    for (let i = 0; i < OUTPOST_SLOTS; i++) {\n      initSlots.push({\n        slotIndex: i,\n        resource: null,\n        amount: 0,\n        price: 0,\n        sellTime: null,\n        boughtBy: null,\n        boughtFor: null,\n        sellerUsername: null,\n        sellerId: null\n      });\n    }\n    setTradeSlots(initSlots);\n  }, []);\n\n  // Fetch data on component mount\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsLoading(true);\n      try {\n        // Fetch resource data for prices\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        setResourceData(resourcesResponse.data);\n        setMasterResources(resourcesResponse.data);\n\n        // Fetch grid data to get outpost trade stall\n        const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n        \n        if (gridResponse.data.outpostTradeStall && Array.isArray(gridResponse.data.outpostTradeStall)) {\n          setTradeSlots(gridResponse.data.outpostTradeStall);\n        }\n        // Otherwise keep the default slots initialized in the previous useEffect\n      } catch (error) {\n        console.error('Error fetching Outpost data:', error);\n        updateStatus('Failed to load Outpost data');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [gridId]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n\n  const handleSlotClick = (index) => {\n    const slot = tradeSlots[index];\n    const isEmpty = !slot?.resource;\n    \n    // Only allow adding items to empty slots\n    if (isEmpty) {\n      setSelectedSlotIndex(index);\n      // Reset amounts when opening modal to prevent quantity persistence bug\n      setAmounts({});\n    }\n  };\n\n  const handleAmountChange = (type, value) => {\n    const resourceInBackpack = backpack.find((item) => item.type === type);\n    const backpackAmount = resourceInBackpack ? resourceInBackpack.quantity : 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    const maxAmount = Math.min(backpackAmount, slotConfig.maxAmount);\n\n    setAmounts((prev) => ({\n      ...prev,\n      [type]: Math.min(Math.max(0, value), maxAmount),\n    }));\n  };\n\n  const handleAddToSlot = async (transactionId, transactionKey, resource) => {\n    let amount = amounts[resource] || 0;\n    const resourceInBackpack = backpack.find((item) => item.type === resource);\n\n    if (selectedSlotIndex === null || amount <= 0 || !resourceInBackpack || amount > resourceInBackpack.quantity) {\n      console.warn('Invalid amount or resource exceeds available quantity.');\n      return;\n    }\n    \n    // Get slot configuration and enforce max amount limit\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    if (amount > slotConfig.maxAmount) {\n      amount = slotConfig.maxAmount;\n      console.log(`Amount adjusted to slot limit: ${amount} (max: ${slotConfig.maxAmount})`);\n    }\n\n    // Check if selling all of a crop item\n    if (amount === resourceInBackpack.quantity && isACrop(resource, masterResources)) {\n      const plotResource = masterResources.find(res => res.output === resource && res.category === 'farmplot');\n      const plotHasCost = plotResource && plotResource.ingredient1qty > 0;\n      \n      if (plotHasCost) {\n        setModalContent({\n          title: ' Warning',\n          message: `This will leave you with 0 ${resource}, so you will not be able to plant ${resource} again.`,\n          message2: 'Are you sure?',\n          size: 'small',\n          onClose: () => setIsModalOpen(false),\n          children: (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n              <button\n                className=\"btn-basic btn-neutral\"\n                onClick={() => setIsModalOpen(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn-basic btn-success\"\n                onClick={() => {\n                  setIsModalOpen(false);\n                  performAddToSlot(transactionId, transactionKey, resource, amount);\n                }}\n              >\n                Proceed\n              </button>\n            </div>\n          ),\n        });\n        setIsModalOpen(true);\n        return;\n      }\n    }\n    \n    await performAddToSlot(transactionId, transactionKey, resource, amount);\n  };\n\n  const performAddToSlot = async (transactionId, transactionKey, resource, amount) => {\n    const resourceDetails = resourceData.find((item) => item.type === resource);\n    const price = resourceDetails?.minprice || 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n\n    try {\n      // Update grid's outpost trade stall\n      const response = await axios.post(`${API_BASE}/api/outpost/add-item`, {\n        gridId,\n        slotIndex: selectedSlotIndex,\n        resource,\n        amount,\n        price,\n        sellTime: Date.now() + slotConfig.sellWaitTime,\n        sellerUsername: currentPlayer.username,\n        sellerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update backpack\n        const updatedBackpack = backpack.map(item =>\n          item.type === resource\n            ? { ...item, quantity: item.quantity - amount }\n            : item\n        ).filter(item => item.quantity > 0);\n        \n        setBackpack(updatedBackpack);\n        setCurrentPlayer(prev => ({\n          ...prev,\n          backpack: updatedBackpack\n        }));\n        \n        setSelectedSlotIndex(null);\n        updateStatus(`Added ${amount}x ${resource} to Outpost`);\n      }\n    } catch (error) {\n      console.error('Error adding item to Outpost:', error);\n      updateStatus('Failed to add item to Outpost');\n      throw error;\n    }\n  };\n\n  const handleBuyItem = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || !slot.resource || slot.boughtBy) return;\n\n    const totalCost = slot.amount * slot.price;\n    const currentMoney = currentPlayer.inventory?.find(item => item.type === 'Money')?.quantity || 0;\n    \n    if (totalCost > currentMoney) {\n      updateStatus(152); // Not enough money\n      return;\n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/buy-item`, {\n        gridId,\n        slotIndex,\n        buyerId: currentPlayer.playerId,\n        buyerUsername: currentPlayer.username,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money and purchased item)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(`Bought ${slot.amount}x ${slot.resource} for ${totalCost}`);\n      }\n    } catch (error) {\n      console.error('Error buying from Outpost:', error);\n      updateStatus('Failed to buy item');\n      throw error;\n    }\n  };\n\n  const handleCollectPayment = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || slot.sellerId !== currentPlayer.playerId || !slot.boughtBy) return;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/collect-payment`, {\n        gridId,\n        slotIndex,\n        playerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(` Collected ${slot.boughtFor}.`);\n      }\n    } catch (error) {\n      console.error('Error collecting payment:', error);\n      updateStatus('Failed to collect payment');\n      throw error;\n    }\n  };\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose\n    });\n  };\n\n  const handleSellToGame = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || !slot.resource || slot.sellerId !== currentPlayer.playerId) return;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/sell-to-game`, {\n        gridId,\n        slotIndex,\n        playerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(` Sold ${response.data.amount}x ${response.data.resource} for ${response.data.sold}.`);\n      }\n    } catch (error) {\n      console.error('Error selling to game:', error);\n      updateStatus('Failed to sell item');\n      throw error;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"OutpostPanel\">\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n          {strings[98]} {/* Loading... */}\n        </div>\n      </Panel>\n    );\n  }\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"OutpostPanel\">\n      \n      {/* Outpost header */}\n      <div className=\"outpost-header\">\n        {strings?.[179] || 'Outpost'}\n      </div>\n\n      {/* Trade slots */}\n      <div className=\"trade-stall-slots shared-buttons\">\n        {tradeSlots.slice(0, OUTPOST_SLOTS).map((slot, index) => {\n          const isEmpty = !slot?.resource;\n          const isPurchased = slot?.boughtBy;\n          const isOwnItem = slot?.sellerId === currentPlayer.playerId;\n          const isReadyToSell = slot?.sellTime && slot.sellTime <= currentTime && isOwnItem;\n          const hasTimer = slot?.sellTime && slot.sellTime > currentTime;\n\n          return (\n            <div key={index} className=\"trade-slot-container\">\n              <div\n                className={`trade-slot btn-basic ${isEmpty ? 'btn-neutral' : ''} ${!isEmpty && !isPurchased && !isReadyToSell ? 'filled' : ''} ${isPurchased && isOwnItem ? 'btn-collect' : ''} ${isReadyToSell && isOwnItem ? 'btn-sell' : ''}`}\n                onClick={() => {\n                  if (isEmpty) {\n                    handleSlotClick(index);\n                  } else if (isPurchased && isOwnItem) {\n                    // Handle collect payment\n                    handleCollectPayment(`collect-${Date.now()}`, 'collect-payment', index);\n                  } else if (isReadyToSell && isOwnItem) {\n                    // Handle sell to game\n                    handleSellToGame(`sell-${Date.now()}`, 'sell-to-game', index);\n                  }\n                }}\n              >\n                {isEmpty ? (\n                  <div className=\"trade-slot-empty-text\">\n                    <div> {strings[156]}</div>\n                    <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                      {strings[173]} {getSlotConfig(index).maxAmount}\n                    </div>\n                    <div style={{ fontSize: '0.8rem' }}>\n                      {formatDuration(getSlotConfig(index).sellWaitTime / 1000)} {strings[174]}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"trade-slot-content\">\n                    <div className=\"trade-slot-item-name\">\n                      {`${slot.amount}x ${getSymbol(slot.resource)} ${getLocalizedString(slot.resource, strings)}`}\n                    </div>\n                    {slot.sellerUsername && (\n                      <div style={{ fontSize: '0.75rem', color: '#666' }}>\n                        {slot.sellerUsername}\n                      </div>\n                    )}\n                    {isPurchased && (\n                      <>\n                        <div className=\"trade-slot-status\">\n                          {strings[157]} {slot.boughtBy}\n                        </div>\n                        {isOwnItem && (\n                          <div className=\"trade-slot-status\">\n                            {strings[318]} {slot.boughtFor}\n                          </div>\n                        )}\n                      </>\n                    )}\n                    {hasTimer && !isPurchased && (\n                      <div className=\"trade-slot-status timer\">\n                        {formatCountdown(slot.sellTime, currentTime)}\n                      </div>\n                    )}\n                    {isReadyToSell && !isPurchased && (\n                      <div className=\"trade-slot-status ready\">\n                        {strings[167]} {slot.amount * slot.price}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              {/* Action buttons - only show for buy actions and non-own items */}\n              {!isEmpty && !isOwnItem && !isPurchased && (\n                <div className=\"trade-button-container\">\n                  <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                    <TransactionButton\n                      className=\"btn-basic btn-success\"\n                      style={{ width: '100%' }}\n                      onAction={(transactionId, transactionKey) => handleBuyItem(transactionId, transactionKey, index)}\n                      transactionKey={`outpost-buy-${index}`}\n                    >\n                      Buy {slot.amount * slot.price}\n                    </TransactionButton>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* TRADING INVENTORY MODAL */}\n      <TradingInventoryModal\n        isOpen={selectedSlotIndex !== null}\n        onClose={() => setSelectedSlotIndex(null)}\n        inventory={backpack || []}\n        resourceData={resourceData}\n        amounts={amounts}\n        handleAmountChange={handleAmountChange}\n        handleAddToSlot={handleAddToSlot}\n        getSlotConfig={getSlotConfig}\n        selectedSlotIndex={selectedSlotIndex}\n        transactionKeyPrefix=\"outpost-add\"\n      />\n      \n      {/* Sell for Refund button - only visible for developers */}\n      {isDeveloper && (\n        <>\n          <br />\n          <div className=\"shared-buttons\">\n            <TransactionButton \n              className=\"btn-basic btn-success\" \n              onAction={handleSellStation}\n              transactionKey={`sell-refund-${stationType}-${currentStationPosition?.x}-${currentStationPosition?.y}-${gridId}`}\n            >\n              {strings[425] || 'Sell for Refund'}\n            </TransactionButton>\n          </div>\n        </>\n      )}\n    </Panel>\n  );\n}\n\nexport default React.memo(Outpost);","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect, useContext } from 'react';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport Modal from '../../UI/Modal';\nimport TransactionButton from '../../UI/TransactionButton';\nimport '../../UI/SharedButtons.css';\nimport './Mailbox.css';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { loadMasterResources } from '../../Utils/TuningManager';\nimport { updateBadge } from '../../Utils/appUtils';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction Mailbox({ \n  onClose, \n  inventory,\n  setInventory, \n  backpack, \n  setBackpack,\n  currentPlayer, \n  setCurrentPlayer, \n  resources,\n  updateStatus,\n  masterResources,\n}) {\n  const strings = useStrings();\n  const [templates, setTemplates] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [markedReadIds, setMarkedReadIds] = useState([]);\n  const gridId = currentPlayer?.location?.g;\n  const [visibleMessages, setVisibleMessages] = useState(currentPlayer?.messages || []);\n\n  useEffect(() => {\n    if (Array.isArray(currentPlayer?.messages)) {\n      setVisibleMessages(currentPlayer.messages);\n    }\n  }, [currentPlayer?.messages]);\n \n  useEffect(() => {\n  const fetchTemplatesAndMessages = async () => {\n    try {\n      const response = await fetch(`${API_BASE}/api/messages`);\n      const templates = await response.json();\n      setTemplates(templates);\n      updateBadge(currentPlayer, () => {}, 'mailbox', false); //  Clear badge\n      setLoading(false);\n      const res = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}`);\n      const freshMessages = res.data.messages || [];\n      const unreadMessages = freshMessages.filter(msg => !msg.read);\n\n      if (unreadMessages.length > 0) {\n        const updatedMessages = freshMessages.map(msg =>\n          !msg.read ? { ...msg, read: true } : msg\n        );\n        // Save only to the DB  don't update local state yet\n        await axios.post(`${API_BASE}/api/update-player-messages`, {\n          playerId: currentPlayer.playerId,\n          messages: updatedMessages,\n        });\n        // Track which ones we updated\n        setMarkedReadIds(unreadMessages.map(msg => msg.messageId));\n      }\n      // Still show original messages (not visually marked as read yet)\n      setCurrentPlayer(prev => ({ ...prev, messages: freshMessages }));\n      setVisibleMessages(freshMessages);\n\n    } catch (err) {\n      console.error(\" Error fetching or updating mailbox data:\", err);\n    }\n  };\n  fetchTemplatesAndMessages();\n}, []);\n\n\n  // Protected function to collect mailbox rewards using transaction system\n  const handleCollect = async (transactionId, transactionKey, messageIndex) => {\n    console.log(` [PROTECTED MAILBOX] Starting protected collection for message ${messageIndex}`);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/mailbox/collect-rewards`, {\n        playerId: currentPlayer.playerId,\n        messageIndex,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { messages, inventory, backpack, skills, powers, relocations, collectedItems } = response.data;\n        \n        // Update all player data from server response\n        setCurrentPlayer(prev => ({\n          ...prev,\n          messages: messages || prev.messages,\n          inventory: inventory || prev.inventory,\n          backpack: backpack || prev.backpack,\n          skills: skills || prev.skills,\n          powers: powers || prev.powers,\n          relocations: relocations !== undefined ? relocations : prev.relocations\n        }));\n\n        // Update local state\n        if (inventory) setInventory(inventory);\n        if (backpack) setBackpack(backpack);\n        setVisibleMessages(messages || []);\n\n        // Handle quest progress tracking for skills\n        if (skills && collectedItems) {\n          for (const item of collectedItems) {\n            const match = item.match(/(\\d+)\\s+(.+)/);\n            if (match) {\n              const [, qty, skillType] = match;\n              if (skills.some(s => s.type === skillType)) {\n                await trackQuestProgress(currentPlayer, 'Gain skill with', skillType, parseInt(qty), setCurrentPlayer);\n              }\n            }\n          }\n        }\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        const template = templates.find(t => t.id === currentPlayer.messages[messageIndex]?.messageId);\n        updateStatus(`Collected rewards: ${collectedItems.join(', ')}`);\n      }\n    } catch (error) {\n      console.error('Error in protected mailbox collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect rewards');\n      }\n    }\n  };\n\n  const getSymbol = (type) => {\n    return resources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n\nconst renderRewards = (rewards) => {\n  if (!rewards || rewards.length === 0) return null;\n  return (\n    <div className=\"reward-summary\">\n      {rewards.map((r, idx) => (\n        <span key={idx} className=\"reward-item\">\n          {getSymbol(r.item)} {r.qty} {r.item}\n        </span>\n      ))}\n    </div>\n  );\n};\n\n  // Prevent error if player or messages are not loaded\n  if (!currentPlayer || !Array.isArray(currentPlayer.messages)) {\n    return (\n      <Modal onClose={onClose} title={strings[1606]} message=\"No messages available.\" />\n    );\n  }\n\n  const deleteMessage = async (playerId, messageIndex) => {\n    try {\n      const updatedMessages = [...currentPlayer.messages];\n      updatedMessages.splice(messageIndex, 1); // Remove the one at this index only\n    \n      await axios.post(`${API_BASE}/api/update-player-messages`, {\n        playerId,\n        messages: updatedMessages,\n      });\n  \n      setCurrentPlayer((prev) => ({\n        ...prev,\n        messages: updatedMessages,\n      }));\n  \n      updateStatus(1607);\n    } catch (error) {\n      console.error(\" Error deleting message:\", error);\n      updateStatus(\" Failed to delete message.\");\n    }\n  };\n\n  const handleClose = () => {\n    console.log(\" Closing mailbox\");\n    setMarkedReadIds([]); // clear visual state\n    onClose();            // call parent-provided close\n  };\n\n\n  return (\n    <Modal onClose={handleClose} title={strings[1606]} className=\"mailbox-modal\">\n      {loading && visibleMessages.length === 0 ? (\n        <p>{strings[1601]}</p>\n      ) : visibleMessages.length === 0 ? (\n        <p>{strings[1602]}</p>\n      ) : (\n        [...visibleMessages].reverse().map((msg, index) => {\n          const template = templates.find((t) => t.id === msg.messageId);\n\n          if (!template) {\n            console.warn(` No template found for messageId: ${msg.messageId}`);\n            return null;\n          }\n\n          const rewards = (msg.rewards && msg.rewards.length > 0)\n            ? msg.rewards\n            : template.rewards;\n\n          return (\n            <div key={index} className=\"mailbox-message\">\n              {/* Left side: message content */}\n              <div className=\"message-left\">\n                <h3>\n                  {template.title}\n                  {(!msg.read || markedReadIds.includes(msg.messageId)) && (\n                    <span className=\"unread-tag\"></span>\n                  )}\n                </h3>\n                <p className=\"message-body\">{template.body}</p>\n                <p className=\"mailbox-timestamp\">\n                  {strings[1603]}: {new Date(msg.timestamp).toLocaleString()}\n                </p>\n              </div>\n\n              {/* Right side: reward line + buttons */}\n              <div className=\"message-actions\">\n                {rewards?.length > 0 && renderRewards(rewards)}\n\n                <div className=\"shared-buttons\" style={{ display: 'flex', gap: '8px' }}>\n                  {rewards?.length > 0 && (\n                    <TransactionButton\n                      className=\"btn-basic btn-success btn-modal-small\"\n                      transactionKey={`mailbox-collect-${msg.messageId}-${visibleMessages.length - 1 - index}`}\n                      onAction={(transactionId, transactionKey) => handleCollect(transactionId, transactionKey, visibleMessages.length - 1 - index)}\n                    >\n                      {strings[1604]} \n                    </TransactionButton>\n                  )}\n                  <button\n                    className=\"btn-basic btn-neutral btn-modal-small\"\n                    style={{ width: '40px', backgroundColor: '#e0e0e0' }}\n                    title=\"Delete\"\n                    onClick={() => {\n                      if (window.confirm(\"Are you sure you want to delete this message?\")) {\n                        deleteMessage(currentPlayer.playerId, index);\n                      }\n                    }}\n                  >\n                    \n                  </button>\n                </div>\n              </div>\n            </div>\n          );\n        })\n      )}                      \n      <p>{strings[1605]}</p>\n    </Modal>\n  );\n}\n\nexport default Mailbox;","// src/GameFeatures/Seasons/OffSeasonModal.js\nimport React, { useState, useEffect } from 'react';\nimport Modal from '../../UI/Modal';\nimport { useStrings } from '../../UI/StringsContext';\nimport { formatCountdown } from '../../UI/Timers';\nimport axios from 'axios';\nimport API_BASE from '../../config';\n\nfunction OffSeasonModal({ onClose, currentPlayer }) {\n  const strings = useStrings();\n  const [countdown, setCountdown] = useState(\"...\");\n  const [seasons, setSeasons] = useState([]);\n  const [seasonData, setSeasonData] = useState({ type: \"Unknown\", phase: \"Unknown\", endTime: null });\n  const [richestCitizens, setRichestCitizens] = useState([]);\n  const [secondsLeft, setSecondsLeft] = useState(null);\n\n  // Load timers from localStorage\n  useEffect(() => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    const data = storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n    setSeasonData(data);\n  }, []);\n\n  // Fetch tuning data (seasons.json)\n  useEffect(() => {\n    const fetchSeasons = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/tuning/seasons`);\n        setSeasons(response.data);\n      } catch (err) {\n        console.error(\" Failed to load season tuning:\", err);\n      }\n    };\n\n    fetchSeasons();\n  }, []);\n\n  // Update live countdown\n  useEffect(() => {\n    const update = () => {\n      const now = new Date();\n      const end = new Date(seasonData.endTime);\n      setCountdown(formatCountdown(end, now));\n    };\n\n    update();\n    const interval = setInterval(update, 1000);\n    return () => clearInterval(interval);\n  }, [seasonData]);\n\n    // Calculate raw seconds remaining (for refresh trigger)\n    useEffect(() => {\n      const interval = setInterval(() => {\n        const now = Date.now();\n        const end = new Date(seasonData.endTime).getTime();\n        const diff = Math.floor((end - now) / 1000);\n        setSecondsLeft(diff);\n      }, 1000);\n      return () => clearInterval(interval);\n    }, [seasonData]);\n\n  //  Force refresh when 20 seconds remain\n  useEffect(() => {\n    if (secondsLeft === 20) {\n      console.warn(\" Forcing refresh  countdown reached 10s\");\n      window.location.reload();\n    }\n  }, [secondsLeft]);\n\n\n  useEffect(() => {\n    const fetchSeasonWinners = async () => {\n      try {\n        if (!currentPlayer?.frontierId) return;\n\n        const response = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n        const seasonLog = response.data?.seasonlog || [];\n        const currentSeasonNumber = response.data?.seasons?.seasonNumber;\n\n        const lastSeason = seasonLog.find(entry => entry.seasonnumber === currentSeasonNumber);\n        const winners = lastSeason?.seasonwinners || [];\n\n        setRichestCitizens(winners.map((w, i) => ({\n          username: w.username,\n          netWorth: w.networth\n        })));\n      } catch (error) {\n        console.error(\" Error fetching season winners:\", error);\n      }\n    };\n\n    fetchSeasonWinners();\n  }, [currentPlayer]);\n\n\n\n\n  const currentIndex = seasons.findIndex(s => s.seasonType === seasonData.type);\n  const previousIndex = (currentIndex - 1 + seasons.length) % seasons.length;\n  \n  const previousSeason = currentIndex >= 0\n    ? seasons[previousIndex]\n    : { seasonType: \"Unknown\" };\n    \n  const title = ` ${previousSeason.seasonType}  ${seasonData.type}`;\n  const message = strings[\"5035\"];   // \"We are between seasons!\"\n  const message2 = strings[\"5036\"]; // \"Valley View is temporarily unavailable while we reset the season.\"\n\n  return (\n    <Modal\n      isOpen={true}\n      onClose={onClose}\n      title={title}\n      message={message}\n      message2={message2}\n      size=\"standard\"\n    >\n      <h2><strong>{seasonData.type} begins in:</strong> {countdown}</h2>\n\n        <h3> Results from {previousSeason.seasonType}</h3>\n        {richestCitizens.length > 0 ? (\n        richestCitizens.map((c, i) => (\n            <p key={i}>{i + 1}. <strong>{c.username}</strong>  Net Worth: {c.netWorth}</p>\n        ))\n        ) : (\n        <p>No data available.</p>\n        )}\n        <br />\n\n\n      <ul style={{ paddingLeft: \"1.5rem\", marginBottom: \"1rem\" }}>\n        <p> Sending players home</p>\n        <p> Resetting towns and valleys</p>\n        <p> Nerfing money accounts</p>\n        <p> Sending out rewards</p>\n      </ul>\n\n\n      <br />\n    </Modal>\n  );\n}\n\nexport default OffSeasonModal;","import API_BASE from '../config';\nimport React, { useEffect, useState, useContext } from 'react';\nimport axios from 'axios';\nimport Modal from './Modal';\nimport './TownNews.css';\nimport { StatusBarContext } from './StatusBar/StatusBar';\nimport { useStrings } from './StringsContext';\nimport { formatCountdown } from './Timers';\nimport { getMayorUsername } from '../GameFeatures/Government/GovUtils';\n\nfunction TownNews({ onClose, currentPlayer, setCurrentPlayer }) {\n    const strings = useStrings();\n    // Settlement data\n    const [settlementName, setSettlementName] = useState(\"\");\n    const [mayor, setMayor] = useState(\"\");\n    const [taxRate, setTaxRate] = useState(0);\n\n    // Timer states\n    const [electionPhase, setElectionPhase] = useState(\"\");\n    const [trainPhase, setTrainPhase] = useState(\"\");\n    const [bankPhase, setBankPhase] = useState(\"\");\n    \n    // Offer states\n    const [currentTrainOffers, setCurrentTrainOffers] = useState([]);\n    const [nextTrainOffers, setNextTrainOffers] = useState([]);\n    const [bankOffers, setBankOffers] = useState([]);\n    \n    // Countdown timers\n    const [trainTimer, setTrainTimer] = useState(\"\");\n    const [electionTimer, setElectionTimer] = useState(\"\");\n    const [bankTimer, setBankTimer] = useState(\"\");\n\n    // Simplify to just show unique items\n    const formatOffers = (offers) => {\n        if (!offers?.length) return \"no items\";\n        const uniqueItems = [...new Set(offers.map(offer => offer.itemBought))];\n        return uniqueItems.join(\", \");\n    };\n\n    const fetchTownData = async () => {\n        try { \n            // Fetch settlement data\n            const settlementResponse = await axios.get(\n                `${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n            const settlement = settlementResponse.data;\n            \n            console.log(\"Settlement data fetched:\", settlement);\n            setSettlementName(settlement.displayName);\n            setTaxRate(settlement.taxrate);\n\n            const mayorName = await getMayorUsername(currentPlayer.settlementId);\n            console.log(\" Mayor:\", mayorName);\n            setMayor(mayorName);\n\n            // Get current train offers\n            setCurrentTrainOffers(settlement.currentoffers);\n            setNextTrainOffers(settlement.nextoffers);\n\n            // Get Bank offers from frontier\n            const frontierResponse = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n            setBankOffers(frontierResponse.data.bank?.offers || []);\n\n            // Get phases and timers from localStorage\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            setBankPhase(storedTimers.bank?.phase || \"\");\n            setTrainPhase(storedTimers.train?.phase || \"\");\n            setElectionPhase(storedTimers.elections?.phase || \"\");\n\n            // Update timers\n            const now = Date.now();\n            setTrainTimer(formatCountdown(storedTimers.train?.endTime, now));\n            setElectionTimer(formatCountdown(storedTimers.elections?.endTime, now));\n            setBankTimer(formatCountdown(storedTimers.bank?.endTime, now));\n\n        } catch (error) {\n            console.error('Error fetching town data:', error);\n        }\n    };\n \n    // Initial fetch and timer updates\n    useEffect(() => {\n        fetchTownData();\n        const interval = setInterval(fetchTownData, 1000);\n        return () => clearInterval(interval);\n    }, [currentPlayer]);\n\n    return (\n        <Modal \n            onClose={onClose} \n            className=\"modal-TownNews\"\n            size=\"standard\"\n        >\n            <h3>{strings[\"1501\"]} \"{settlementName || \"...\"}\"</h3>\n            \n            {mayor ? (\n                /* The current mayor is */\n                <p>{strings[\"1502\"]} {mayor}{strings[\"1503\"]} {taxRate}%.</p>  \n            ) : (\n                /* No mayor */\n                <> <p>{strings[\"1512\"]} {strings[\"1515\"]} {taxRate}%.</p>  </>\n            )}\n            \n            <h4>{strings[\"1504\"]}</h4>\n\n            {/* Election Updates */}\n            {electionPhase === \"Campaigning\" && (\n                <p>{strings[\"1505\"]}</p>\n            )}\n            {electionPhase === \"Voting\" && (\n                <p>{strings[\"1506\"]} {strings[\"10121\"]} {electionTimer}</p>\n\n            )}\n            {electionPhase === \"Counting\" && (\n                <p>{strings[\"1518\"]} {electionTimer}.</p>\n            )}\n\n            {/* Modified Train Updates */}\n            {trainPhase === \"arriving\" && (\n                <p>{strings[\"1507\"]} {formatOffers(currentTrainOffers)}.</p>\n            )}\n            {trainPhase === \"departing\" && (\n                <p>{strings[\"1513\"]} {trainTimer}. {strings[\"1514\"]} {formatOffers(nextTrainOffers)}.</p>\n            )}\n            {trainPhase === \"loading\" && (\n                <>\n                    <p>{strings[\"1509\"]} {formatOffers(currentTrainOffers)}. {strings[\"1517\"]} {trainTimer}.</p>\n                </>\n            )}\n\n            {/* Bank Updates */}\n            {bankPhase === \"active\" && (\n                <p>{strings[\"1516\"]} {formatOffers(bankOffers)}. {strings[10124]}{bankTimer}</p>\n            )}\n            {bankPhase === \"refreshing\" && (\n                <p>{strings[\"1511\"]}</p>\n            )}\n        </Modal>\n    );\n}\n\nexport default TownNews;","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panel';\nimport { formatCountdown } from '../../UI/Timers';\nimport '../../UI/Modal.css';\nimport '../../UI/SharedButtons.css';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction SeasonPanel({ onClose, currentPlayer, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const [countdown, setCountdown] = useState(\"\");\n  const [topCitizens, setTopCitizens] = useState([]);\n  const [topSettlementName, setTopSettlementName] = useState(\"\");\n  const [seasonCycle, setSeasonCycle] = useState([]);\n  const [highestWealth, setHighestWealth] = useState(0);\n  const [settlementMap, setSettlementMap] = useState({});\n\n\n  //  Fetch season data from local storage\n  const getSeasonData = () => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    return storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n  };\n\n  const getNextSeason = (currentSeason) => {\n    if (!seasonCycle.length || !currentSeason) return \"Unknown\";\n    const currentIndex = seasonCycle.findIndex(s => s.seasonType === currentSeason);\n    const nextIndex = (currentIndex + 1) % seasonCycle.length;\n    return seasonCycle[nextIndex]?.seasonType || \"Unknown\";\n  };\n  \n  useEffect(() => {\n    const fetchSeasonCycle = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/tuning/seasons`);\n        setSeasonCycle(response.data);\n      } catch (error) {\n        console.error(\" Failed to fetch season cycle\", error);\n      }\n    };\n  \n    fetchSeasonCycle();\n  }, []);\n\n  //  Compute real-time countdown from local timer state\n  useEffect(() => {\n    const updateCountdown = () => {\n      const seasonData = getSeasonData();\n      const now = new Date();\n      const end = new Date(seasonData?.endTime);\n      setCountdown(formatCountdown(end, now));\n    };\n  \n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n\n  //  Fetch top 3 wealthiest citizens across the frontier and leading settlement\n  useEffect(() => {\n    const fetchTopCitizensAndSettlement = async () => {\n      if (!currentPlayer || !currentPlayer.frontierId) {\n        console.warn(\" currentPlayer or frontierId is not available yet.\");\n        return;\n      }\n      try {\n        console.log(\" Fetching top citizens and leading settlement for frontier:\", currentPlayer.frontierId);\n        \n        // Fetch all players in this frontier with developer status\n        const response = await axios.get(`${API_BASE}/api/players-by-frontier-with-dev-status/${currentPlayer.frontierId}`);\n        const players = response.data;\n\n        const settlementRes = await axios.get(`${API_BASE}/api/settlements`);\n        const settlements = settlementRes.data;\n        const settlementMap = settlements.reduce((acc, s) => {\n          acc[s._id] = s.displayName || s.name || \"Unknown Settlement\";\n          return acc;\n        }, {});\n        setSettlementMap(settlementMap);\n\n        // Group players by settlementId and sum their net worths, excluding developers\n        const settlementWealthMap = {};\n        players.forEach(player => {\n          if (player.isDeveloper) return; // Skip developers\n          const settlementId = player.settlementId || \"unknown\";\n          const netWorth = player.netWorth || 0;\n          if (!settlementWealthMap[settlementId]) {\n            settlementWealthMap[settlementId] = { totalNetWorth: 0, settlementName: settlementMap[settlementId] || \"Unknown Settlement\" };\n          }\n          settlementWealthMap[settlementId].totalNetWorth += netWorth;\n        });\n\n        // Find the settlement with highest total net worth\n        let leadingSettlementId = null;\n        let highestWealth = -1;\n        for (const [settlementId, data] of Object.entries(settlementWealthMap)) {\n          if (data.totalNetWorth > highestWealth) {\n            highestWealth = data.totalNetWorth;\n            leadingSettlementId = settlementId;\n          }\n        }\n        const leadingSettlementName = leadingSettlementId && settlementWealthMap[leadingSettlementId] ? settlementWealthMap[leadingSettlementId].settlementName : \"No data available\";\n        // Add logic to retrieve population using derived calculation:\n        let leadingSettlementPopulation = \"Unknown\";\n        if (leadingSettlementId && settlements) {\n          const matching = settlements.find(s => s._id === leadingSettlementId);\n          if (matching) {\n            leadingSettlementPopulation = calculateSettlementPopulation(matching);\n          }\n        }\n        // store population into settlementMap with a compound key to retrieve later\n        if (leadingSettlementName) {\n          settlementMap[leadingSettlementName + \"_pop\"] = leadingSettlementPopulation;\n        }\n        setHighestWealth(highestWealth);\n\n        // Sort all players by net worth and take top 3, excluding developers\n        const topPlayers = players\n          .filter(player => !player.isDeveloper)\n          .map(player => ({\n            username: player.username,\n            netWorth: player.netWorth || 0\n          }))\n          .sort((a, b) => b.netWorth - a.netWorth)\n          .slice(0, 3);\n\n        setTopCitizens(topPlayers);\n        setTopSettlementName(leadingSettlementName);\n      } catch (error) {\n        console.error(\" Error fetching top citizens and settlement:\", error);\n      }\n    };\n\n    fetchTopCitizensAndSettlement(); \n  }, [currentPlayer]); // Runs when `currentPlayer` updates\n\n\n    //  Get current season data from local storage\n  const seasonData = getSeasonData();\n  const nextSeasonType = getNextSeason(seasonData?.type);\n\n\n  // Function to show season rules in modal\n  const handleShowSeasonRules = () => {\n    const rulesContent = (\n      <div style={{ textAlign: 'left', paddingLeft: '20px', paddingRight: '20px' }}>\n        {/* Header 1 - string 15002 */}\n        <p>{strings[15001]}</p>\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15002]}</h3>\n        <ol style={{ paddingLeft: '40px' }}>\n          <li>{strings[15003]}</li>\n          <li>{strings[15004]}</li>\n          <li>{strings[15005]}</li>\n          <li>{strings[15006]}</li>\n        </ol>\n        \n        {/* Header 2 - string 15007 */}\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15007]}</h3>\n        <ol start=\"7\" style={{ paddingLeft: '40px' }}>\n          <li>{strings[15008]}</li>\n          <li>{strings[15009]}</li>\n          <li>{strings[15010]}</li>\n          <li>{strings[15011]}</li>\n          <li>{strings[15012]}</li>\n          <li>{strings[15013]}</li>\n          <li>{strings[15014]}</li>\n          <li>{strings[15015]}</li>\n          <li>{strings[15016]}</li>\n          <li>{strings[15017]}</li>\n        </ol>\n        \n        {/* Header 3 - string 15018 */}\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15018]}</h3>\n        <ol start=\"17\" style={{ paddingLeft: '40px' }}>\n          <li>{strings[15019]}</li>\n          <li>{strings[15020]}</li>\n          <li>{strings[15021]}</li>\n          <li>{strings[15022]}</li>\n        </ol>\n      </div>\n    );\n\n    setModalContent({\n      title: \"Season Rules\",\n      size: \"large\",\n      custom: rulesContent,\n    });\n    setIsModalOpen(true);\n  };\n\n  // New: Function to fetch and open season log\n  const handleShowSeasonLog = async () => {\n    if (!currentPlayer?.frontierId) { \n      console.warn(\" Cannot show season log: frontierId missing.\");\n      return;\n    }\n\n    console.log(\" Fetching season log for frontier:\", currentPlayer.frontierId);\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/frontier/${currentPlayer.frontierId}/seasonlog`);\n      const seasonlog = response.data.seasonlog || [];\n\n      const seasonLogTable = (\n        <table className=\"season-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>Season</th>\n              <th style={{ padding: \"6px 12px\" }}>Date</th>\n              <th style={{ padding: \"6px 12px\" }}>Top Settlement</th>\n              <th style={{ padding: \"6px 12px\" }}>Top Players by Net Worth</th>\n              <th style={{ padding: \"6px 12px\" }}>Grids Reset</th>\n              <th style={{ padding: \"6px 12px\" }}>Players Relocated</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...seasonlog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>#{entry.seasonnumber} {entry.seasontype}</td>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.winningsettlement}</td>\n                <td style={{ padding: \"6px 12px\", whiteSpace: \"pre-line\" }}>\n                  {entry.seasonwinners.map(w => `${w.username}: ${w.networth.toLocaleString()}`).join('\\n')}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.gridsreset}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.playersrelocated}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: \"Season Log\",\n        size: \"large\",\n        message: seasonlog.length === 0 ? \"No season history found.\" : undefined,\n        custom: seasonLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch season log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load season log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1015\" titleKey=\"1115\" panelName=\"SeasonPanel\">\n      {seasonData?.phase === \"onSeason\" ? (\n        <>\n          <h2>{strings[3053]} {seasonData?.type || strings[3054]}</h2>\n          <p>{strings[3055]}</p> \n          <h2>{countdown}</h2>\n        </>\n      ) : (\n        <>\n          <h2>{strings[3056]}</h2>\n        </>\n      )}\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\"\n          onClick={handleShowSeasonRules}\n        >\n          {strings[15000]}\n        </button>\n      </div>\n\n\n      <p>{strings[3057]}</p>\n      <h3>{strings[3058]}</h3>\n      <p>{strings[3051]}</p>\n      {topCitizens.length > 0 ? (\n        <div>\n          {topCitizens.map((citizen, index) => (\n            <p key={index}>\n              {index + 1}. <strong>{citizen.username}</strong> : {citizen.netWorth.toLocaleString()}\n            </p>\n          ))}\n        </div>\n      ) : (\n        <p>{strings[3052]}</p>\n      )}\n\n      <h3>{strings[3059]}</h3>\n      {topSettlementName ? (\n        <>\n          <p><strong>{topSettlementName}</strong></p>\n          <p>{strings[3060]} {highestWealth.toLocaleString()}</p>\n          <p>{strings[3061]} {settlementMap[topSettlementName + \"_pop\"]?.toLocaleString() || strings[3062]}</p>\n        </>\n      ) : (\n        <p>{strings[3063]}</p>\n      )}\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\"\n          onClick={handleShowSeasonLog}\n        >\n          {strings[3064]}\n        </button>\n      </div>\n    </Panel>\n  );\n}\n\nexport default SeasonPanel;","import API_BASE from '../../config.js';\nimport ChangeIconModal from '../../UI/ChangeIconModal';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { usePanelContext } from '../../UI/PanelContext';\nimport { spendIngredients } from '../../Utils/InventoryManagement';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs.js';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport RelationshipCard from '../Relationships/RelationshipCard';\nimport '../Relationships/Relationships.css';\nimport socket from '../../socketManager';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\nconst SocialPanel = ({\n  onClose,\n  pcData,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  updateStatus,\n  masterInteractions,\n  masterTrophies,\n  isDeveloper,\n  controllerUsername,\n  setControllerUsername,\n}) => {\n  const [tentCount, setTentCount] = useState(0);\n  const [boatCount, setBoatCount] = useState(0);\n  const [isCamping, setIsCamping] = useState(false);\n  const [isInBoat, setIsInBoat] = useState(false);\n  const [displayedPCData, setDisplayedPCData] = useState(pcData);\n  const [showChangeIconModal, setShowChangeIconModal] = useState(false);\n\n  console.log('made it to SocialPanel; pc = ', pcData);\n\n  useEffect(() => {\n    if (!pcData) return;\n    \n    //  Update displayed data when viewing other players\n    if (pcData.username !== currentPlayer.username) {\n      const gridId = currentPlayer?.location?.g;\n      if (!gridId) return;\n      \n      const NPCsInGrid = playersInGridManager.getPlayersInGrid(gridId);\n      const latestData = NPCsInGrid[pcData.playerId];\n      if (latestData) {\n          setIsCamping(latestData.iscamping || false);\n          setIsInBoat(latestData.isinboat || false);\n          setDisplayedPCData(prev => ({\n            ...prev,\n            iscamping: latestData.iscamping,\n            isinboat: latestData.isinboat,\n            hp: latestData.hp,\n            username: latestData.username,\n          }));\n      }\n    }\n}, [pcData, currentPlayer]);\n\n\n  useEffect(() => {\n    if (!pcData) {\n      console.warn(\"SocialPanel was opened with missing pcData.\");\n      setDisplayedPCData({ username: \"Unknown\", hp: 0, iscamping: false });\n      return;\n    }\n\n    //  Check if the selected PC is the current player\n    if (pcData.username === currentPlayer.username) {\n      // Update displayed data with current player's latest state\n      setDisplayedPCData({\n        ...pcData,\n        iscamping: currentPlayer.iscamping || false,\n        isinboat: currentPlayer.isinboat || false,\n        hp: currentPlayer.hp || pcData.hp\n      });\n      \n      setIsCamping(currentPlayer.iscamping || false);\n      setIsInBoat(currentPlayer.isinboat || false);\n\n      //  Get tent count from Backpack\n      const tentsInBackpack = currentPlayer.backpack?.find(item => item.type === \"Tent\")?.quantity || 0;\n      setTentCount(tentsInBackpack);\n\n      //  Get boat count from Backpack\n      const boatsInBackpack = currentPlayer.backpack?.find(item => item.type === \"Boat\")?.quantity || 0;\n      setBoatCount(boatsInBackpack);\n    } else {\n      setDisplayedPCData(pcData);\n    }\n  }, [pcData, currentPlayer, currentPlayer.iscamping, currentPlayer.isinboat]);\n\n  //  Handle Pitching a Tent\n  const handlePitchTent = async () => {\n    console.log(\" handlePitchTent called; tentCount = \", tentCount);\n    if (tentCount <= 0) return;\n\n    // Optimistically update UI immediately\n    setIsCamping(true);\n    setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n    setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n    \n    // Optimistically reduce tent count\n    setTentCount(prev => prev - 1);\n\n    try {\n      // First update the camping status\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { iscamping: true },\n      });\n\n      if (!response.data.success) {\n        // Revert all optimistic updates if server update failed\n        setIsCamping(false);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n        setTentCount(prev => prev + 1);\n        return;\n      }\n\n      // Then spend the tent\n      const fakeRecipe = { ingredient1: \"Tent\", ingredient1qty: 1 };\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: fakeRecipe,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!success) {\n        // Revert camping status if we couldn't spend the tent\n        await axios.post(`${API_BASE}/api/update-profile`, {\n          playerId: currentPlayer.playerId,\n          updates: { iscamping: false },\n        });\n        setIsCamping(false);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n        setTentCount(prev => prev + 1);\n        return;\n      }\n\n      console.log(' iscamping: updated profile successfully');\n      updateStatus(28);\n      \n      // Award Adventurer trophy for first time camping\n      if (currentPlayer?.playerId) {\n        earnTrophy(currentPlayer.playerId, 'Adventurer', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      }\n      \n      // Update PlayersInGrid directly\n      const gridId = currentPlayer?.location?.g;\n      if (gridId) {\n        playersInGridManager.updatePC(gridId, currentPlayer.playerId, { iscamping: true });\n      }\n    } catch (error) {\n      console.error(\" Error pitching tent:\", error);\n      updateStatus(29);\n      // Revert all optimistic updates on error\n      setIsCamping(false);\n      setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n      setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n      setTentCount(prev => prev + 1);\n    }\n  };\n\n  \n\n  //  Handle Putting Away a Tent\n  const handlePutAwayTent = async () => {\n    // Optimistically update UI immediately\n    setIsCamping(false);\n    setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n    setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n    \n    // Optimistically increase tent count (getting tent back)\n    setTentCount(prev => prev + 1);\n\n    try {\n      //  Update camping status in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { iscamping: false },\n      });\n\n      if (response.data.success) {\n        updateStatus(30);\n\n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { iscamping: false });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsCamping(true);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n        setTentCount(prev => prev - 1);\n      }\n    } catch (error) {\n      console.error(\" Error putting away tent:\", error);\n      updateStatus(29);\n      // Revert optimistic update on error\n      setIsCamping(true);\n      setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n      setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n      setTentCount(prev => prev - 1);\n    }\n};\n\n  //  Handle Getting in Boat\n  const handleGetInBoat = async () => {\n    console.log(\" handleGetInBoat called; boatCount = \", boatCount);\n    if (boatCount <= 0) return;\n\n    // Optimistically update UI immediately\n    setIsInBoat(true);\n    setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n    setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n\n    try {\n      // Note: Unlike tent, we don't consume the boat item\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { isinboat: true },\n      });\n\n      if (response.data.success) {\n        console.log(' isinboat: updated profile successfully; response = ', response);\n        updateStatus(\"You got in your boat.\"); // TODO: Add proper string ID\n        \n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { isinboat: true });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsInBoat(false);\n        setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n        setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n      }\n    } catch (error) {\n      console.error(\" Error getting in boat:\", error);\n      updateStatus(\"Failed to get in boat.\"); // TODO: Add proper string ID\n      // Revert optimistic update on error\n      setIsInBoat(false);\n      setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n      setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n    }\n  };\n\n  //  Handle Getting out of Boat\n  const handleGetOutOfBoat = async () => {\n    // Optimistically update UI immediately\n    setIsInBoat(false);\n    setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n    setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n\n    try {\n      //  Update boat status in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { isinboat: false },\n      });\n\n      if (response.data.success) {\n        updateStatus(\"You got out of your boat.\"); // TODO: Add proper string ID\n        \n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { isinboat: false });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsInBoat(true);\n        setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n        setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n      }\n    } catch (error) {\n      console.error(\" Error getting out of boat:\", error);\n      updateStatus(\"Failed to get out of boat.\"); // TODO: Add proper string ID\n      // Revert optimistic update on error\n      setIsInBoat(true);\n      setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n      setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n    }\n};\n\n  //  Handle Remove from GridState (Debug)\n  const handleRemoveFromGridState = async () => {\n    if (!pcData || !pcData.playerId) {\n      console.error(\" Cannot remove: No player data\");\n      updateStatus(\"Failed to remove player from grid state\");\n      return;\n    }\n\n    const gridId = currentPlayer?.location?.g;\n    if (!gridId) {\n      console.error(\" Cannot remove: No grid ID found\");\n      updateStatus(\"Failed to remove player from grid state\");\n      return;\n    }\n\n    const playerId = pcData.playerId;\n    \n    console.log(` Removing player ${pcData.username} (${playerId}) from grid ${gridId}`);\n    \n    try {\n      // Step 1: Remove from database first\n      console.log(' Calling /remove-single-pc to remove player from database...');\n      const response = await axios.post(`${API_BASE}/api/remove-single-pc`, {\n        gridId: gridId,\n        playerId: playerId,\n      });\n      \n      if (!response.data.success) {\n        throw new Error('Failed to remove player from database');\n      }\n      \n      console.log(` Successfully removed player ${pcData.username} from database`);\n      \n      // Step 2: Remove from local state\n      playersInGridManager.removePC(gridId, playerId);\n      console.log(` Successfully removed player ${pcData.username} from local grid state`);\n      \n      // Step 3: Force NPCController transfer if the removed player was the controller\n      // Check if the removed player was the controller\n      if (controllerUsername === pcData.username) {\n        console.log(` Removed player ${pcData.username} was the NPCController, clearing controller`);\n        // Clear the controller username locally first\n        if (setControllerUsername) {\n          setControllerUsername(null);\n        }\n      }\n      \n      if (socket) {\n        console.log(` Forcing NPCController reassignment after removing ${pcData.username}`);\n        // Tell the server to remove this player and reassign controller\n        // Using existing socket events that the server already handles\n        socket.emit('leave-grid', { \n          gridId: gridId,\n          playerId: playerId,\n          username: pcData.username\n        });\n        \n        // Request fresh player list from server to ensure state consistency\n        setTimeout(() => {\n          console.log(' Requesting current players from server after removal');\n          socket.emit('request-current-grid-players', { gridId });\n        }, 50);\n        \n        // If they were the controller, request to become the new controller\n        if (controllerUsername === pcData.username) {\n          setTimeout(() => {\n            socket.emit('request-npc-controller', { gridId: gridId });\n          }, 100);\n        }\n      }\n      \n      updateStatus(`Removed ${pcData.username} from grid${controllerUsername === pcData.username ? ' and cleared NPC control' : ''}`);\n      \n      // Close the panel since the player is no longer in the grid\n      if (pcData.username !== currentPlayer.username) {\n        onClose();\n      }\n    } catch (error) {\n      console.error(\" Error removing player from grid state:\", error);\n      updateStatus(\"Failed to remove player from grid state\");\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1014\" titleKey=\"1114\" panelName=\"SocialPanel\">\n        <div className=\"panel-content\">\n        <h2>{displayedPCData.username}{displayedPCData.username === currentPlayer.username && \" (You)\"}</h2>\n        <h3> HP: {displayedPCData.hp}</h3>\n\n<br/>\n        {displayedPCData.username === currentPlayer.username && (\n          <div className=\"shared-buttons\">\n            <button \n              className=\"btn-basic btn-success\" \n              onClick={() => setShowChangeIconModal(true)}\n            >\n              {currentPlayer.icon || ''} Change Avatar\n            </button>\n          </div>\n        )}\n        \n        {/* Show camping/boat status for other players */}\n        {displayedPCData.username !== currentPlayer.username && (\n          <>\n            {displayedPCData.iscamping && (\n              <h3 style={{ fontWeight: \"bold\", color: \"#4CAF50\" }}> Camping.</h3>\n            )}\n            {displayedPCData.isinboat && (\n              <h3 style={{ fontWeight: \"bold\", color: \"#2196F3\" }}> In a boat.</h3>\n            )}\n          </>\n        )}\n\n        {/* Show RelationshipCard only for other players */}\n        {/* TODO: Relationship feature is in progress - temporarily commented out\n        {displayedPCData.username !== currentPlayer.username && (\n          <RelationshipCard\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            targetName={displayedPCData.username}\n            targetType=\"player\"\n            showActions={true}\n            compact={false}\n            masterInteractions={masterInteractions}\n            updateStatus={updateStatus}\n            onRelationshipChange={(interaction, success) => {\n              // Additional handling if needed after interaction completes\n            }}\n          />\n        )}\n        */}\n\n        {/* Debug button for developers to remove player from grid state */}\n        {isDeveloper && displayedPCData.username !== currentPlayer.username && (\n          <div className=\"shared-buttons\">\n            <button \n              className=\"btn-basic btn-danger\" \n              onClick={handleRemoveFromGridState}\n            >\n               Remove from GridState (dev only)\n            </button>\n          </div>\n        )}\n        \n\n        {/*  Show camping and boat buttons only for current player */}\n        {displayedPCData.username === currentPlayer.username && (\n          <>\n            {/* Tent functionality */}\n            <br /><br />\n            {isCamping ? (\n              <h3 style={{ fontWeight: \"bold\", color: \"#4CAF50\" }}> Camping.</h3>\n            ) : (\n              <p> You have <strong>{tentCount}</strong> tents.</p>\n            )}\n            \n            {isCamping ? (\n              <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-success\" onClick={handlePutAwayTent}> Put Away Tent</button>\n              </div>\n            ) : (\n              <div className=\"shared-buttons\">\n                <button \n                  className=\"btn-basic btn-success\" \n                  disabled={isInBoat}\n                  onClick={() => {\n                    if (tentCount <= 0) {\n                      console.warn(\" No tents found. Button press ignored.\");\n                      updateStatus(27); // \"You don't have a tent.\"\n                    } else {\n                      handlePitchTent();\n                    }\n                  }}\n                >\n                   Pitch Tent\n                </button>\n              </div>\n            )}\n<br />\n\n            {/* Boat functionality */}\n            {isInBoat ? (\n              <h3 style={{ fontWeight: \"bold\", color: \"#2196F3\" }}> In a boat.</h3>\n            ) : (\n              <p> You have <strong>{boatCount}</strong> boats.</p>\n            )}\n            \n            {isInBoat ? (\n              <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-success\" onClick={handleGetOutOfBoat}> Get Out of Boat</button>\n              </div>\n            ) : (\n              <div className=\"shared-buttons\">\n                <button \n                  className=\"btn-basic btn-success\" \n                  disabled={isCamping}\n                  onClick={() => {\n                    if (boatCount <= 0) {\n                      console.warn(\" No boats found. Button press ignored.\");\n                      updateStatus(\"You don't have a boat.\"); // TODO: Add proper string ID\n                    } else {\n                      handleGetInBoat();\n                    }\n                  }}\n                >\n                   Get in Boat\n                </button>\n              </div>\n            )}\n\n          </>\n        )}\n\n        </div>\n      {showChangeIconModal && (\n        <ChangeIconModal\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          currentIcon={currentPlayer.icon}\n          playerId={currentPlayer.playerId}\n          onClose={() => setShowChangeIconModal(false)}\n          onSave={(newIcon) => {\n            setDisplayedPCData(prev => ({ ...prev, icon: newIcon }));\n            setShowChangeIconModal(false);\n          }}\n        />\n      )}\n    </Panel>\n  );\n};\n\nexport default React.memo(SocialPanel);","import './CombatPanel.css';\nimport API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panel';\nimport axios from 'axios';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport '../../UI/ResourceButton.css'; //  Ensure the correct path\nimport '../../UI/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nconst CombatPanel = ({ onClose, currentPlayer, setCurrentPlayer, masterResources, masterSkills, TILE_SIZE }) => {\n  const strings = useStrings();\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const { updateStatus } = useContext(StatusBarContext);\n  const [fetchTrigger, setFetchTrigger] = useState(0);\n  const [playerStats, setPlayerStats] = useState({});\n  \n  // Equipment state\n  const getEquippedWeapon = () => currentPlayer.settings?.equippedWeapon || null;\n  const getEquippedArmor = () => currentPlayer.settings?.equippedArmor || null;\n  \n  // Helper functions to categorize powers\n  const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n  const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n  const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n  \n  // Check if player is in a valid location for equipment changes\n  const canChangeEquipment = () => {\n    const gridType = currentPlayer.location.gtype;\n    return gridType === 'homestead' || gridType === 'town';\n  };\n\n  // Equipment change handlers\n  const handleEquipWeapon = async (weaponType) => {\n    if (!canChangeEquipment()) {\n      updateStatus(strings[520] || 'Cannot change equipment in this location');\n      return;\n    }\n\n    try {\n      const updatedSettings = {\n        ...currentPlayer.settings,\n        equippedWeapon: weaponType\n      };\n      \n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { settings: updatedSettings }\n      });\n      \n      // Update player state first\n      const updatedPlayer = {\n        ...currentPlayer,\n        settings: updatedSettings\n      };\n      setCurrentPlayer(updatedPlayer);\n      \n      // Wait a moment for state to settle, then refresh with updated player data\n      setTimeout(() => {\n        refreshCombatStatsWithPlayer(updatedPlayer);\n        // Also force immediate update of displayed stats\n        const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n        if (stats) {\n          setPlayerStats(stats);\n        }\n      }, 100);\n      \n      updateStatus(weaponType ? `Equipped ${weaponType}` : 'Unequipped weapon');\n    } catch (error) {\n      console.error('Error equipping weapon:', error);\n      updateStatus('Failed to equip weapon');\n    }\n  };\n  \n  const handleEquipArmor = async (armorType) => {\n    if (!canChangeEquipment()) {\n      updateStatus(strings[520] || 'Cannot change equipment in this location');\n      return;\n    }\n\n    try {\n      const updatedSettings = {\n        ...currentPlayer.settings,\n        equippedArmor: armorType\n      };\n      \n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { settings: updatedSettings }\n      });\n      \n      // Update player state first\n      const updatedPlayer = {\n        ...currentPlayer,\n        settings: updatedSettings\n      };\n      setCurrentPlayer(updatedPlayer);\n      \n      // Wait a moment for state to settle, then refresh with updated player data\n      setTimeout(() => {\n        refreshCombatStatsWithPlayer(updatedPlayer);\n        // Also force immediate update of displayed stats\n        const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n        if (stats) {\n          setPlayerStats(stats);\n        }\n      }, 100);\n      \n      updateStatus(armorType ? `Equipped ${armorType}` : 'Unequipped armor');\n    } catch (error) {\n      console.error('Error equipping armor:', error);\n      updateStatus('Failed to equip armor');\n    }\n  };\n\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n      if (stats) {\n        setPlayerStats(stats);\n      }\n    }, 500); // Poll every 500ms\n\n    return () => clearInterval(interval);\n  }, [currentPlayer._id, currentPlayer.location.g]);\n\n  // --- Stat helpers ---\n\n  const getPlayerStats = () => {\n    return playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id] || {};\n  };\n  const getStatBreakdown = (stat) => {\n    const total = playerStats?.[stat] || 0;\n    // Handle special case for maxhp -> baseMaxhp (capital M)\n    let basePropertyName;\n    if (stat === 'maxhp') {\n      basePropertyName = 'baseMaxhp';\n    } else if (stat === 'hp') {\n      basePropertyName = 'baseHp';\n    } else {\n      // For other stats: damage -> baseDamage, attackrange -> baseAttackrange, etc.\n      basePropertyName = `base${stat.charAt(0).toUpperCase() + stat.slice(1)}`;\n    }\n    const base = currentPlayer[basePropertyName] || 0;\n    const modifier = total - base;\n    return { base, modifier, total };\n  };\n\n  const hp = getStatBreakdown('hp');\n  const maxhp = getStatBreakdown('maxhp');\n  const damage = getStatBreakdown('damage');\n  const armorclass = getStatBreakdown('armorclass');\n  const attackbonus = getStatBreakdown('attackbonus');\n  const attackrange = getStatBreakdown('attackrange');\n  const speed = getStatBreakdown('speed');\n\n\n\n  // Refresh function that uses current player data (for button)\n  const handleRefreshCombatStats = () => {\n    refreshCombatStatsWithPlayer(currentPlayer);\n  };\n\n  // Core refresh function that accepts player data parameter (to avoid race conditions)\n  const refreshCombatStatsWithPlayer = (playerData) => {\n    const gridId = playerData.location.g;\n    const playerId = playerData._id;\n\n    const baseStats = {\n      hp: playerData.baseHp || 0,  // Add hp calculation\n      maxhp: playerData.baseMaxhp || 0,\n      damage: playerData.baseDamage || 0,\n      armorclass: playerData.baseArmorclass || 0,\n      attackbonus: playerData.baseAttackbonus || 0,\n      attackrange: playerData.baseAttackrange || 0,\n      speed: playerData.baseSpeed || 0,\n    };\n\n    const powers = playerData.powers || [];\n    const powerBonuses = {\n      hp: 0, maxhp: 0, damage: 0, armorclass: 0, attackbonus: 0, attackrange: 0, speed: 0,\n    };\n\n    const equippedWeapon = playerData.settings?.equippedWeapon || null;\n    const equippedArmor = playerData.settings?.equippedArmor || null;\n\n    powers.forEach(power => {\n      const res = masterResources.find(r => r.type === power.type);\n      if (res && res.category === 'power') {\n        const powerQty = power.quantity || 0;\n        \n        // Only count equipped weapons and armor, or all magic enhancements\n        const shouldCount = isMagicEnhancement(res) || \n                           (isWeapon(res) && power.type === equippedWeapon) ||\n                           (isArmor(res) && power.type === equippedArmor);\n        \n        if (shouldCount) {\n          // Check for multiple combat attributes on the power\n          Object.keys(powerBonuses).forEach(stat => {\n            if (typeof res[stat] === 'number') {\n              powerBonuses[stat] += powerQty * res[stat];\n            }\n          });\n        }\n      }\n    });\n\n    const finalStats = {};\n    Object.keys(baseStats).forEach(stat => {\n      finalStats[stat] = baseStats[stat] + (powerBonuses[stat] || 0);\n    });\n\n    // Special handling for HP - use current HP if available, otherwise use max HP\n    const currentPCStats = getPlayerStats();\n    if (currentPCStats?.hp !== undefined) {\n      finalStats.hp = currentPCStats.hp; // Keep current HP value\n    } else if (!finalStats.hp || finalStats.hp === 0) {\n      finalStats.hp = finalStats.maxhp; // Set HP to max if not already set\n    }\n\n    finalStats.playerId = playerId;\n    finalStats.username = playerData.username;\n    finalStats.position = playerData.position || {};\n    finalStats.icon = playerData.icon || \"\";\n    finalStats.iscamping = playerData.iscamping || false;\n    finalStats.isinboat = playerData.isinboat || false;\n    finalStats.lastUpdated = new Date().toISOString();\n\n    const pc = getPlayerStats();\n    const pcPosition = pc?.position;\n    finalStats.position = (pcPosition && typeof pcPosition.x === 'number' && typeof pcPosition.y === 'number')\n      ? pcPosition : { x: 0, y: 0 }; // Fallback\n      \n    playersInGridManager.updatePC(gridId, playerId, finalStats);\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1024\" titleKey=\"1124\" panelName=\"CombatPanel\">\n      <div className=\"standard-panel\">\n      {isContentLoading ? (\n          <p>Loading...</p>\n        ) : (\n          <>\n            <div className=\"combat-stats\">\n              <h3>{strings[10112]} <span className=\"stat-total\">{hp.total}</span></h3><br/>\n              <h4>{strings[550]}: <span className=\"stat-total blue-text\">{maxhp.modifier !== 0 ? maxhp.total : maxhp.base}</span><br></br>\n                {\"  (\"} {maxhp.base} + <span className=\"stat-total blue-text\">{maxhp.modifier}</span> {\")\"} </h4>\n              <h4>{strings[551]}: <span className=\"stat-total blue-text\">{armorclass.modifier !== 0 ? armorclass.total : armorclass.base}</span><br></br>\n                {\"  (\"} {armorclass.base} + <span className=\"stat-total blue-text\">{armorclass.modifier}</span> {\")\"}</h4>\n              <h4>{strings[552]}: <span className=\"stat-total blue-text\">{attackbonus.modifier !== 0 ? attackbonus.total : attackbonus.base}</span><br></br>\n                {\"  (\"} {attackbonus.base} + <span className=\"stat-total blue-text\">{attackbonus.modifier}</span> {\")\"}</h4>\n              <h4>{strings[553]}: <span className=\"stat-total blue-text\">{damage.modifier !== 0 ? damage.total : damage.base}</span><br></br>\n                {\"  (\"} {damage.base} + <span className=\"stat-total blue-text\">{damage.modifier}</span> {\")\"}</h4>\n              <h4>{strings[555]}: <span className=\"stat-total blue-text\">{attackrange.modifier !== 0 ? attackrange.total : attackrange.base}</span><br></br>\n                {\"  (\"} {attackrange.base} + <span className=\"stat-total blue-text\">{attackrange.modifier}</span> {\")\"} </h4>\n              <h4>{strings[554]}: <span className=\"stat-total blue-text\">{speed.modifier !== 0 ? speed.total : speed.base}</span><br></br>\n                {\"  (\"} {speed.base} + <span className=\"stat-total blue-text\">{speed.modifier}</span> {\")\"}</h4>\n            </div>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-success\" onClick={handleRefreshCombatStats}> Fix Combat Stats</button>\n            </div>\n            <br></br>\n\n            <div className=\"combat-equip\">\n              <h3>{strings[522]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isArmor(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isArmor(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    const isEquipped = power.type === getEquippedArmor();\n                    const stats = [];\n                    \n                    const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = (power.quantity || 0) * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    return (\n                      <div key={`armor-${index}`} className=\"equipment-item\">\n                        <input\n                          type=\"checkbox\"\n                          checked={isEquipped}\n                          onChange={() => handleEquipArmor(isEquipped ? null : power.type)}\n                          className=\"equipment-checkbox\"\n                          disabled={!canChangeEquipment()}\n                        />\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br/>\n                          {stats.map((stat, statIndex) => (\n                            <div key={statIndex} className=\"equipment-stat\">\n                              {stat}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[523]}</p>\n              )}\n              \n              <br></br>\n              <h3>{strings[524]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isWeapon(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isWeapon(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    const isEquipped = power.type === getEquippedWeapon();\n                    const stats = [];\n                    \n                    const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = (power.quantity || 0) * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    return (\n                      <div key={`weapon-${index}`} className=\"equipment-item\">\n                        <input\n                          type=\"checkbox\"\n                          checked={isEquipped}\n                          onChange={() => handleEquipWeapon(isEquipped ? null : power.type)}\n                          className=\"equipment-checkbox\"\n                          disabled={!canChangeEquipment()}\n                        />\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br/>\n                          {stats.map((stat, statIndex) => (\n                            <div key={statIndex} className=\"equipment-stat\">\n                              {stat}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[525]}</p>\n              )}\n            </div>\n\n            <div className=\"combat-powers\">\n              <h3>{strings[526]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isMagicEnhancement(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isMagicEnhancement(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    if (!resource) return null;\n\n                    const powerQty = power.quantity || 0;\n                    const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    \n                    // Collect all combat stats this power provides\n                    const stats = [];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = powerQty * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    \n                    return (\n                      <div key={`magic-${index}`} className=\"magic-enhancement-item\">\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br />\n                          {stats.length > 0 ? (\n                            stats.map((stat, statIndex) => (\n                              <div key={statIndex} className=\"equipment-stat\">\n                                {stat}\n                              </div>\n                            ))\n                          ) : (\n                            <div className=\"no-combat-effects\">\n                              (No combat effects)\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[527]}</p>\n              )}\n              <br></br>\n              <h3>{strings[528]}</h3>\n              <h4>{strings[556]}: {currentPlayer.iscamping ? strings[558] : strings[559]}</h4>\n              <h4>{strings[557]}: {currentPlayer.isinboat ? strings[558] : strings[559]}</h4>\n            </div>\n          </>\n        )}\n      </div>\n      <br />\n    </Panel>\n  );\n};\n\nexport default React.memo(CombatPanel);","import React, { memo } from 'react';\nimport Panel from './Panel'; \nimport { handlePurchase } from '../Store/Store';\nimport './SharedButtons.css'; \nimport { useStrings } from './StringsContext';\n\n\nconst GoldBenefitsPanel = memo(({ currentPlayer, updateStatus, onClose }) => {\n  \n  const strings = useStrings();\n  const isGold = currentPlayer.accountStatus === 'Gold';\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1027\" titleKey=\"1127\" panelName=\"GoldBenefitsPanel\">\n      <div className=\"panel-content\">\n\n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n          {isGold ? (\n            <p>{strings[9060]}</p>\n          ) : (\n            <button className=\"btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(1, currentPlayer, updateStatus)}>{strings[9061]}</button>\n          )}\n        </div>\n<br />\n        <h2>{strings[9050]}</h2>\n        <p>{strings[9051]}</p>\n        <p>{strings[9052]}</p>\n        <p>{strings[9053]}</p>\n        <p>{strings[9054]}</p>\n        <p>{strings[9055]}</p>\n        <p>{strings[9056]}</p>\n        <p>{strings[9057]}</p>\n        <p>{strings[9058]}</p>\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default GoldBenefitsPanel;\n","export function shareToNetwork(network, url) {\n  let shareUrl = '';\n\n  switch (network) {\n    case 'facebook':\n      shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;\n      break;\n    case 'twitter':\n      shareUrl = `https://twitter.com/intent/tweet?text=Come+play+Valley+View!&url=${encodeURIComponent(url)}`;\n      break;\n    case 'reddit':\n      shareUrl = `https://www.reddit.com/submit?url=${encodeURIComponent(url)}&title=Check+out+Valley+View!`;\n      break;\n    default:\n      console.warn('Unsupported network:', network);\n      return;\n  }\n\n  window.open(shareUrl, '_blank', 'noopener,noreferrer');\n}\n\nexport function copyToClipboard(text) {\n  navigator.clipboard.writeText(text)\n    .then(() => alert(' Link copied to clipboard!'))\n    .catch(() => alert(' Failed to copy link.'));\n}","import React from 'react';\nimport { shareToNetwork, copyToClipboard } from '../Utils/share';\nimport { useStrings } from './StringsContext';\nimport './Modal.css';\nimport './ShareModal.css';\nimport './SharedButtons.css';\n\nfunction ShareModal({ onClose }) {\n\n  const strings = useStrings();\n  const url = window.location.href;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"share-modal\">\n        <h2> Share Valley View</h2>\n        <p>{strings[95]}</p>\n        \n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic facebook-btn btn-modal\" onClick={() => shareToNetwork('facebook', url)}>Facebook</button>\n          <button className=\"btn-basic twitter-btn btn-modal\" onClick={() => shareToNetwork('twitter', url)}>Twitter / X</button>\n          <button className=\"btn-basic reddit-btn btn-modal\" onClick={() => shareToNetwork('reddit', url)}>Reddit</button>\n        </div>\n\n        <div className=\"copy-link\">\n          <input type=\"text\" readOnly value={url} />\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-modal-small\" onClick={() => copyToClipboard(url)}> Copy</button>\n          </div>\n        </div>\n\n        <div className=\"discord-section\">\n          <p>and</p>\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic discord-btn btn-modal\"\n              onClick={() => window.open('https://discord.gg/mQgRP2K9', '_blank')}\n            >\n              Join our Discord\n            </button>\n          </div>\n        </div>\n\n<br />\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-modal btn-success\" onClick={onClose}>{strings[796]}</button>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\nexport default ShareModal;","import React, { useState, useEffect } from 'react';\n\nconst CowboyAnimation = () => {\n  const [position, setPosition] = useState({ x: 100, y: 100 });\n  const [targetPosition, setTargetPosition] = useState({ x: 100, y: 100 });\n  const [duration, setDuration] = useState(0);\n  const speed = 100; // pixels per second\n\n  useEffect(() => {\n    const moveToNewPosition = () => {\n      // Pick a random direction (0: up, 1: right, 2: down, 3: left)\n      const direction = Math.floor(Math.random() * 4);\n      \n      // Calculate distance to travel (random between 100-300 pixels)\n      const distance = 100 + Math.random() * 200;\n      \n      // Calculate new position based on direction\n      let newX = position.x;\n      let newY = position.y;\n      \n      switch (direction) {\n        case 0: // up\n          newY = Math.max(50, position.y - distance);\n          break;\n        case 1: // right\n          newX = Math.min(950, position.x + distance);\n          break;\n        case 2: // down\n          newY = Math.min(550, position.y + distance);\n          break;\n        case 3: // left\n          newX = Math.max(50, position.x - distance);\n          break;\n      }\n      \n      // Calculate animation duration based on actual distance and speed\n      const actualDistance = Math.sqrt(\n        Math.pow(newX - position.x, 2) + Math.pow(newY - position.y, 2)\n      );\n      const animationDuration = actualDistance / speed; // in seconds\n      \n      setDuration(animationDuration);\n      setTargetPosition({ x: newX, y: newY });\n      setPosition({ x: newX, y: newY });\n    };\n\n    // Start movement every 5 seconds + animation duration\n    const timer = setTimeout(moveToNewPosition, 1000 + (duration * 1000));\n    \n    return () => clearTimeout(timer);\n  }, [position, duration]);\n\n  return (\n    <div\n      className=\"cowboy-emoji\"\n      style={{\n        position: 'absolute',\n        left: `${targetPosition.x}px`,\n        top: `${targetPosition.y}px`,\n        fontSize: '28px',\n        transition: duration > 0 ? `all ${duration}s linear` : 'none',\n        zIndex: 10,\n        userSelect: 'none'\n      }}\n    >\n      \n    </div>\n  );\n};\n\nexport default CowboyAnimation;","import './App.css';\nimport './GameFeatures/Chat/Chat.css';\nimport './VFX/VFX.css';\nimport './UI/SharedButtons.css';\nimport axios from 'axios';\nimport API_BASE from './config.js';\nimport Chat from './GameFeatures/Chat/Chat';\nimport React, { useContext, useState, useEffect, useLayoutEffect, memo, useMemo, useCallback, useRef, act } from 'react';\nimport { registerNotificationClickHandler } from './UI/Notifications/Notifications';\nimport { initializeGrid } from './AppInit';\nimport { loadMasterSkills, loadMasterResources, loadMasterInteractions, loadGlobalTuning, loadMasterTraders, loadMasterTrophies, loadMasterWarehouse } from './Utils/TuningManager';\nimport { RenderTiles } from './Render/RenderTiles';\nimport { RenderResources } from './Render/RenderResources';\nimport { RenderNPCs } from './Render/RenderNPCs';\nimport { RenderPCs } from './Render/RenderPCs';\nimport { RenderDynamicElements, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus } from './Render/RenderDynamicElements';\nimport { handleResourceClick } from './ResourceClicking';\nimport { isMobile } from './Utils/appUtils';\nimport { useUILock } from './UI/UILockContext';\nimport questCache from './Utils/QuestCache';\n\nimport socket from './socketManager';\nimport {\n  socketListenForPCJoinAndLeave,\n  socketListenForPCstateChanges,\n  socketListenForNPCStateChanges,\n  socketListenForResourceChanges,\n  socketListenForTileChanges,\n  socketListenForNPCControllerStatus,\n  socketListenForSeasonReset,\n  socketListenForPlayerConnectedAndDisconnected,\n  socketListenForConnectAndDisconnect,\n  socketListenForChatMessages,\n  socketListenForBadgeUpdates,\n  socketListenForStoreBadgeUpdates,\n} from './socketManager';\n\nimport farmState from './FarmState';\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport FTUE from './GameFeatures/FTUE/FTUE';\n\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport { usePlayersInGrid, useGridStatePCUpdate } from './GridState/GridStatePCContext';\nimport NPCsInGridManager from './GridState/GridStateNPCs.js';\nimport { useGridState, useGridStateUpdate } from './GridState/GridStateContext';\nimport npcController from './GridState/NPCController';\n\nimport SettlementView from './ZoomedOut/SettlementView';\nimport FrontierView from './ZoomedOut/FrontierView';\n\nimport Modal from './UI/Modal';\nimport LanguagePickerModal from './UI/LanguagePickerModal';\nimport { useStrings } from './UI/StringsContext';\nimport LANGUAGE_OPTIONS from './UI/Languages.json';\n\nimport ProfilePanel from './Authentication/ProfilePanel';\nimport LoginPanel from './Authentication/LoginPanel';\nimport DebugPanel from './Utils/debug';\nimport InventoryPanel from './GameFeatures/Inventory/InventoryPanel';\nimport WarehousePanel from './GameFeatures/Inventory/WarehousePanel';\nimport TrophyPanel from './GameFeatures/Trophies/TrophyPanel.js';\nimport HowToPanel from './UI/HowToPanel';\nimport HowToMoneyPanel from './UI/HowToMoneyPanel';\nimport HowToGemsPanel from './UI/HowToGemsPanel';\nimport QuestPanel from './GameFeatures/Quests/QuestPanel';\nimport NPCPanel from './GameFeatures/NPCs/NPCsPanel.js';\nimport BuildPanel from './GameFeatures/Build/BuildPanel';\nimport BuyPanel from './GameFeatures/Buy/BuyPanel';\nimport PetsPanel from './GameFeatures/Pets/PetsPanel';\nimport BuyDecoPanel from './GameFeatures/Deco/BuyDecoPanel';\nimport FarmingPanel from './GameFeatures/Farming/FarmingPanel';\nimport ToolsPanel from './GameFeatures/Farming/ToolsPanel';\nimport SkillsPanel from './GameFeatures/Skills/SkillsPanel';\nimport GovPanel from './GameFeatures/Government/GovPanel';\nimport BankPanel from './GameFeatures/Trading/Bank';\nimport KentPanel from './GameFeatures/Trading/Kent';\nimport TrainPanel from './GameFeatures/Trading/Train';\nimport NewTrainPanel from './GameFeatures/Trading/NewTrain';\nimport CarnivalPanel from './GameFeatures/Carnival/Carnival';\nimport CourthousePanel from './GameFeatures/Government/Courthouse';\nimport { getMayorUsername } from './GameFeatures/Government/GovUtils';\nimport CraftingStation from './GameFeatures/Crafting/CraftingStation';\nimport FarmHouse from './GameFeatures/Crafting/FarmHouse';\nimport FarmHandPanel from './GameFeatures/FarmHands/FarmHand.js';\nimport ShopStation from './GameFeatures/Crafting/ShopStation';\nimport ScrollStation from './GameFeatures/Crafting/ScrollStation';\nimport PetPanel from './GameFeatures/Pets/PetPanel';\nimport AnimalStall from './GameFeatures/FarmAnimals/AnimalStall';\nimport AnimalPanel from './GameFeatures/FarmAnimals/FarmAnimals.js';\nimport CropPanel from './GameFeatures/Farming/CropPanel.js';\nimport DecoPanel from './GameFeatures/Deco/DecoPanel';\nimport TradeStall from './GameFeatures/Trading/TradeStall';\nimport Outpost from './GameFeatures/Trading/Outpost';\nimport Mailbox from './GameFeatures/Mailbox/Mailbox';\nimport Store from './Store/Store';\nimport OffSeasonModal from './GameFeatures/Seasons/OffSeasonModal.js';\nimport TownNews from './UI/TownNews.js';\nimport SeasonPanel from './GameFeatures/Seasons/SeasonPanel';\nimport SocialPanel from './GameFeatures/Social/SocialPanel';\nimport CombatPanel from './GameFeatures/Combat/CombatPanel';\nimport GoldBenefitsPanel from './UI/GoldBenefitsPanel';\nimport ShareModal from './UI/ShareModal';\n\nimport { usePanelContext } from './UI/PanelContext';\nimport { useModalContext } from './UI/ModalContext';\nimport { checkDeveloperStatus, updateBadge, getBadgeState } from './Utils/appUtils';\nimport { useBulkOperation } from './UI/BulkOperationContext';\nimport FloatingTextManager from './UI/FloatingText';\nimport StatusBar from './UI/StatusBar/StatusBar';\nimport { StatusBarContext } from './UI/StatusBar/StatusBar';\nimport { formatCountdown } from './UI/Timers';\nimport CowboyAnimation from './UI/CowboyAnimation';\n\nimport { fetchGridData, updateGridStatus } from './Utils/GridManagement';\nimport { handleKeyMovement, handleKeyDown as handleMovementKeyDown, handleKeyUp as handleMovementKeyUp, centerCameraOnPlayer, centerCameraOnPlayerFast } from './PlayerMovement';\nimport { mergeResources, mergeTiles, enrichResourceFromMaster } from './Utils/ResourceHelpers.js';\nimport { fetchHomesteadOwner, calculateDistance } from './Utils/worldHelpers.js';\nimport { getDerivedRange } from './Utils/worldHelpers';\nimport { handlePlayerDeath } from './Utils/playerManagement';\n\nfunction App() {\n\n  const appInstanceId = Math.floor(Math.random() * 10000);\n//console.log(` App mounted. Instance ID: ${appInstanceId}`);\n\nuseEffect(() => {\n  const id = Math.floor(Math.random() * 10000);\n  console.log(` App mounted. Instance ID: ${id}`);\n  console.trace();\n}, []);\n\nuseEffect(() => {\n  const appEl = document.getElementById('root');\n  console.log(\" App mounted. Parent contents:\", appEl?.innerHTML?.slice(0, 200));\n  return () => {\n    console.log(\" App unmounted.\");\n  };\n}, []);\n\n\n  const strings = useStrings();\n  const { uiLocked } = useUILock();\n  const [isDeveloper, setIsDeveloper] = useState(false);\n  const [isMayor, setIsMayor] = useState(false);\n  const [useCanvasTiles, setUseCanvasTiles] = useState(true);\n  const [useCanvasResources, setUseCanvasResources] = useState(false);\n  const [useCanvasNPCs, setUseCanvasNPCs] = useState(false);\n  const [useCanvasPCs, setUseCanvasPCs] = useState(false);\n  const [useCanvasDynamicElements, setUseCanvasDynamicElements] = useState(false);\n  const { activeModal, setActiveModal, openModal, closeModal } = useModalContext();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [modalContent, setModalContent] = useState({ title: '', message: '', message2: '' });\n  const { updateStatus } = useContext(StatusBarContext);\n  const bulkOperationContext = useBulkOperation();\n\n  // Mobile device detection: Show modal if on mobile\n  useEffect(() => {\n    if (isMobile()) {\n      setModalContent({\n        title: 'Unsupported Device',\n        size: 'small',\n        children: (\n          <div style={{ fontSize: '1rem', textAlign: 'center', padding: '1rem' }}>\n             This game is intended for desktop browsers only.<br /><br />\n            Please revisit on a laptop or desktop computer.\n          </div>\n        ),\n        onClose: () => {},\n      });\n      setIsModalOpen(true);\n    }\n  }, []);\n  const openMailbox = () => openModal && openModal('Mailbox');\n\n  // Store purchase fulfillment effect\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const purchaseSuccess = params.get(\"purchase\");\n    const playerId = params.get(\"playerId\");\n    const offerId = params.get(\"offerId\");\n\n    if (purchaseSuccess === \"success\" && playerId && offerId) {\n      console.log(\" Processing store purchase via App.js effect:\", { playerId, offerId });\n\n      axios.post(`${API_BASE}/api/purchase-store-offer`, {\n        playerId, offerId\n      }).then(() => {\n        console.log(\" Purchase reward sent successfully.\");\n\n        /// If Gold Pass was purchased, show modal and panel\n        if (String(offerId) === \"1\") {\n          updateStatus && updateStatus(\" Congratulations on purchasing a Gold Pass!\");\n          // Re-fetch player to get updated accountStatus\n          axios.get(`${API_BASE}/api/player/${playerId}`).then((playerResponse) => {            \n          openPanel('GoldBenefitsPanel');\n          setModalContent({\n              title: strings[\"5060\"],\n              message: strings[\"5061\"],\n              message2: strings[\"5062\"],\n              size: \"small\",\n            });\n          setIsModalOpen(true);\n          }).catch((err) => {\n            console.error(\" Failed to refresh player data after Gold purchase:\", err);\n          });\n        /// If anything else was purchased, open Mailbox\n        } else {\n          updateStatus && updateStatus(\" Purchase successful! Check your Inbox.\");\n          openMailbox && openMailbox();\n        }\n      }).catch((err) => {\n        console.error(\" Failed to fulfill purchase:\", err);\n        updateStatus && updateStatus(\" Purchase may not have been fulfilled. Contact support if missing.\");\n      });\n\n      // Clean up the URL to remove query params\n      const url = new URL(window.location.href);\n      url.search = \"\";\n      window.history.replaceState({}, document.title, url.toString());\n    }\n  }, []);\n\n  // Server connectivity check: periodically ping server and show modal if down\n  useEffect(() => {\n    let interval;\n    let serverPreviouslyDown = false;\n    const checkServer = async () => {\n      try {\n        // await axios.get(`${API_BASE}/api/ping`);\n        // Always close modal if server is reachable\n        if (modalContent?.title === strings[10000]) {\n          setIsModalOpen(false);\n        }\n        // If it was previously down, reload the page\n        if (serverPreviouslyDown) { window.location.reload(); }\n      } catch (err) {\n        console.warn(\" Server unreachable:\", err.message);\n        if (!serverPreviouslyDown) {\n          setModalContent({\n            title: strings[10000],\n            message: strings[10001],\n            message2: strings[10002],\n          });\n          setIsModalOpen(true);\n          serverPreviouslyDown = true;\n        }\n      }\n    };\n    interval = setInterval(checkServer, 2000);\n    return () => clearInterval(interval);\n  }, []);\n\n\n  useEffect(() => {\n    const checkInitialSeasonPhase = async () => {\n      console.log(\"Checking for on or off Season on app start\");\n      const raw = localStorage.getItem(\"timers\");\n      if (!raw) { console.warn(\"No timers in localStorage yet.\"); return; }\n      let storedTimers = null;\n      try {\n        storedTimers = JSON.parse(raw);\n      } catch (err) {\n        console.warn(\"Malformed timers in localStorage:\", err);\n        return;\n      }\n      if (storedTimers?.seasons?.phase === \"offSeason\") {\n        console.log(\" Initial local phase is offSeason, confirming with server...\");\n        try {\n          const res = await axios.get(`${API_BASE}/api/get-global-season-phase`);\n          const serverPhase = res.data?.phase;\n          setIsOffSeason(serverPhase === \"offSeason\");\n          console.log(serverPhase === \"offSeason\" ? \" Server confirms offSeason\" : \" Server says it's not offSeason\");\n        } catch (error) {\n          console.error(\" Error confirming season with server:\", error);\n        }\n      }\n    };\n    checkInitialSeasonPhase();\n  }, []);\n\n    //  Fetch season data from local storage\n  const getSeasonData = () => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    return storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n  };\n  const seasonData = getSeasonData();\n  const [currentPlayer, setCurrentPlayer] = useState(null); // Ensure this is defined\n\n  // Sync canvas resources setting with player data\n  useEffect(() => {\n    if (currentPlayer?.settings?.renderSVGResources !== undefined) {\n      setUseCanvasResources(currentPlayer.settings.renderSVGResources);\n    }\n  }, [currentPlayer?.settings?.renderSVGResources]);\n\n  // Initialize gridId with localStorage (do not depend on currentPlayer here)\n  const [gridId, setGridId] = useState(() => {\n    const storedGridId = localStorage.getItem('gridId');\n    return storedGridId || null;\n  });\n  const [resources, setResources] = useState([]);\n  const [tileTypes, setTileTypes] = useState([]);\n  const [grid, setGrid] = useState([]);\n  const [masterResources, setMasterResources] = useState([]);\n  const [isMasterResourcesReady, setIsMasterResourcesReady] = useState([]);\n  const [masterSkills, setMasterSkills] = useState([]);\n  const [masterWarehouse, setMasterWarehouse] = useState([]);\n  const [globalTuning, setGlobalTuning] = useState(null);\n  const [masterInteractions, setMasterInteractions] = useState([]);\n  const [masterTraders, setMasterTraders] = useState([]);\n  const [masterTrophies, setMasterTrophies] = useState([]);\n\n  // Check if player is mayor for authoritative mayor display\n  useEffect(() => {\n    const checkMayorStatus = async () => {\n      let isPlayerMayor = false;\n      if (currentPlayer?.location?.gtype === 'town' && currentPlayer?.location?.s) {\n        try {\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n        } catch (error) {\n          console.error('Error checking mayor status in App.js:', error);\n        }\n      }\n      setIsMayor(isPlayerMayor);\n    };\n\n    if (currentPlayer) {\n      checkMayorStatus();\n    }\n  }, [currentPlayer?.location?.s, currentPlayer?.username]);\n\n// Synchronize tiles with GlobalGridStateTilesAndResources -- i did this so NPCs have knowledge of tiles and resources as they change\nuseEffect(() => {\n  // Always update, even if tileTypes is empty array\n  if (tileTypes !== undefined && tileTypes !== null) {\n    GlobalGridStateTilesAndResources.setTiles(tileTypes);\n    console.log('GlobalGridStateTilesAndResources tiles updated:', tileTypes);\n  }\n}, [tileTypes]);\n// Synchronize resources with GlobalGridStateTilesAndResources -- i did this so NPCs have knowledge of tiles and resources as they change\nuseEffect(() => {\n  // Always update, even if resources is empty array (important for grid transitions!)\n  if (resources !== undefined && resources !== null) {\n    // Defensive cleanup: Check for crops with invalid growEnd fields\n    let cleanedResources = resources;\n    const invalidCrops = resources.filter(res => {\n      // Check if this is a crop (output of a farmplot) with growEnd\n      if (res.growEnd && masterResources) {\n        const isCrop = masterResources.some(mr => \n          mr.category === 'farmplot' && mr.output === res.type\n        );\n        return isCrop;\n      }\n      return false;\n    });\n    \n    if (invalidCrops.length > 0) {\n      console.warn(` Found ${invalidCrops.length} crops with invalid growEnd fields, cleaning up...`);\n      invalidCrops.forEach(crop => {\n        console.log(`  - ${crop.type} at (${crop.x}, ${crop.y}) has growEnd=${crop.growEnd}`);\n      });\n      cleanedResources = resources.map(res => {\n        // If this is one of the invalid crops, remove growEnd\n        const needsCleanup = invalidCrops.some(ic => ic.x === res.x && ic.y === res.y);\n        if (needsCleanup) {\n          const { growEnd, ...cleanedRes } = res;\n          console.log(` Cleaned crop ${res.type} at (${res.x}, ${res.y})`);\n          return cleanedRes;\n        }\n        return res;\n      });\n      setResources(cleanedResources);\n    }\n    \n    GlobalGridStateTilesAndResources.setResources(cleanedResources);\n    //console.log('GlobalGridStateTilesAndResources resources updated:', cleanedResources);\n  }\n}, [resources, masterResources]);\n\nconst [zoomLevel, setZoomLevel] = useState('close'); // Default zoom level\nconst TILE_SIZES = globalTuning?.closerZoom ? {\n  closer: globalTuning.closerZoom,\n  close: globalTuning.closeZoom,\n  far: globalTuning.farZoom\n} : { closer: 50, close: 30, far: 16 }; // Use globalTuning or fallback to defaults\nconst activeTileSize = TILE_SIZES[zoomLevel]; // Get the active TILE_SIZE\nconst [isRelocating, setIsRelocating] = useState(null);\n\nconst [visibleSettlementId, setVisibleSettlementId] = useState(null);\nuseEffect(() => {\n  // currentPlayer may be null on first render, so initialize only when available\n  if (currentPlayer?.location?.s) {\n    setVisibleSettlementId(currentPlayer.location.s);\n  }\n}, [currentPlayer]);\n\n// Maintain camera position during zoom transitions\nuseLayoutEffect(() => {\n  if (zoomLevel && zoomLevel !== 'settlement' && zoomLevel !== 'frontier' && currentPlayer?.location?.g && currentPlayer?._id) {\n    const gridId = currentPlayer.location.g;\n    const playerIdStr = String(currentPlayer._id);\n    const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n    \n    if (playerPos && activeTileSize) {\n      // Use fast centering without animation to prevent jump\n      centerCameraOnPlayerFast(playerPos, activeTileSize);\n    }\n  }\n}, [zoomLevel, activeTileSize]);\n\n// Track the last shown FTUE step to detect changes\nconst [lastShownFTUEStep, setLastShownFTUEStep] = useState(null);\n\nconst [inventory, setInventory]  = useState({});\nconst [backpack, setBackpack] = useState({});\nconst [playerPosition, setPlayerPosition] = useState(null);\n\nconst NPCsInGrid = useGridState();\nconst setGridState = useGridStateUpdate();\nuseEffect(() => {\n  NPCsInGridManager.registerSetGridState(setGridState);\n}, [setGridState]);\n\nconst playersInGrid = usePlayersInGrid();\nconst setPlayersInGrid = useGridStatePCUpdate();\nuseEffect(() => {\n  playersInGridManager.registerSetPlayersInGrid(setPlayersInGrid);\n}, [setPlayersInGrid]);\nuseEffect(() => {\n  playersInGridManager.registerTileSize(activeTileSize);\n}, [activeTileSize]);\n\nconst [isLoginPanelOpen, setisLoginPanelOpen] = useState(false);\nconst [isOffSeason, setIsOffSeason] = useState(false); // Track if it's off-season\nconst { activePanel, openPanel, closePanel } = usePanelContext();\nconst { closeAllPanels } = usePanelContext(); \nconst [activeQuestGiver, setActiveQuestGiver] = useState(null);\nconst [activeSocialPC, setActiveSocialPC] = useState(null);\nconst [activeStation, setActiveStation] = useState(null);\nconst [showShareModal, setShowShareModal] = useState(false);\nconst [showFTUE, setShowFTUE] = useState(false);\n\n// Register notification click handlers\nuseEffect(() => {\n  registerNotificationClickHandler('Trophy', (data) => {\n    openPanel('TrophyPanel');\n  });\n  \n  registerNotificationClickHandler('To Do', (data) => {\n    openPanel('QuestPanel');\n  });\n}, [openPanel]);\n\nuseEffect(() => {\n  const storedPlayer = localStorage.getItem('player');\n  if (!storedPlayer) {\n    console.log('[Watcher] No stored player found  showing login panel.');\n    setisLoginPanelOpen(true);\n    openPanel(\"LoginPanel\");\n    setShowKeyArt(true);\n  }\n}, [activePanel]);\n\nconst handleNPCPanel = (npc) => {\n  console.log('App.js: Handling an NPC Panel:', npc, npc.action);\n  switch (npc.action) {\n    case 'quest':\n    case 'trade':\n    case 'heal': {\n      setActiveQuestGiver(npc);  // Set the active quest giver globally\n      if (npc.type==='Kent') {\n        openPanel('KentPanel');  \n      } else {\n        openPanel('NPCPanel');  \n      }\n      break;\n    }\n    case 'worker': {\n      setActiveQuestGiver(npc);  // Set the active quest giver globally\n      // Set activeStation data for NPC-based access to ensure gridId is available\n      setActiveStation({\n        type: npc.type, // Use the actual NPC type (Farmer, Farm Hand, Rancher, Lumberjack)\n        position: npc.position,\n        gridId: currentPlayer.location?.g\n      });\n      openPanel('FarmHandPanel');  \n      break;\n    }\n    default: { break; }\n  }\n};\n\nconst handlePCClick = (pc) => {\n  console.log('App.js: Opening SocialPanel for PC:', pc);\n  setActiveSocialPC(pc);  // Set the active clicked PC globally\n  openPanel('SocialPanel');  // Open the panel\n};\n\nconst [hoverTooltip, setHoverTooltip] = useState(null);\n\n\nconst [controllerUsername, setControllerUsername] = useState(null); // Add state for controller username\nconst [isSocketConnected, setIsSocketConnected] = useState(false);\nconst [connectedPlayers, setConnectedPlayers] = useState(() => new Set());\nconst [chatMessages, setChatMessages] = useState({});\nconst [badgeState, setBadgeState] = useState({ chat: false, store: false, mailbox: false });\n\n//Forgot why we did this:\nconst memoizedGrid = useMemo(() => grid, [grid]);\nconst memoizedTileTypes = useMemo(() => tileTypes, [tileTypes]);\n\nconst memoizedResources = useMemo(() => resources, [resources]);\n\nconst [showKeyArt, setShowKeyArt] = useState(false);\n\n\n/////////// APP INITIALIZATION /////////////////////////\n\n// Flags to track initialization\nlet isInitializing = false; // Declare inside useEffect to avoid global persistence\nconst [isAppInitialized, setIsAppInitialized] = useState(false);\n\n// Central INITIALIZATION for player and grid data //////////////////////////////////////////////////////\n\n// --- SOCKET \"connect\" LISTENER: Register before other listeners\n// This effect runs once at mount to set up socket.on('connect') as early as possible\nuseEffect(() => {\n  if (!socket) return;\n  // Remove any previous connect listeners to avoid duplicate logs\n  socket.off('connect', socket.__vvgame_connect_listener);\n  const connectListener = () => {\n    console.log(' Socket connected!');\n    if (currentPlayer?.playerId) {\n      console.log(' Rejoining playerId room:', currentPlayer.playerId);\n      socket.emit('join-player-room', currentPlayer.playerId);\n    }\n  };\n  socket.on('connect', connectListener);\n  // Save a reference for cleanup\n  socket.__vvgame_connect_listener = connectListener;\n  return () => {\n    socket.off('connect', connectListener);\n    delete socket.__vvgame_connect_listener;\n  };\n  // Depend on currentPlayer so we can re-emit join-player-room if playerId changes\n}, [socket, currentPlayer]);\n\nuseEffect(() => {\n  let cleanupBadges = null;\n\n  const initializeAppWrapper = async () => {\n    console.log(' App initialization begun.');\n    if (isInitializing) {\n      console.log('Initialization is already in progress. Skipping.');\n      return;\n    }\n    isInitializing = true;\n\n    try {\n      // Step 1. Load tuning data\n      console.log(' 1 InitAppWrapper; Merging player data and initializing inventory...');\n      const [skills, resources, globalTuningData, interactions, traders, trophies, warehouse] = await Promise.all([loadMasterSkills(), loadMasterResources(), loadGlobalTuning(), loadMasterInteractions(), loadMasterTraders(), loadMasterTrophies(), loadMasterWarehouse()]);\n      setMasterResources(resources);\n      setMasterSkills(skills);\n      setGlobalTuning(globalTuningData);\n      setMasterInteractions(interactions);\n      setMasterTraders(traders);\n      setMasterTrophies(trophies);\n      setMasterWarehouse(warehouse);\n      setIsMasterResourcesReady(true); //  Mark ready\n\n      // Step 2. Fetch stored player from localStorage\n      console.log(' 2 InitAppWrapper; getting local player...');\n      const storedPlayer = localStorage.getItem('player');\n\n      if (!storedPlayer) {\n        console.log('No stored player found, showing login screen.');\n        setisLoginPanelOpen(true);    \n        openPanel(\"LoginPanel\");  \n        setShowKeyArt(true);  //  NEW STATE FLAG TO TRIGGER IMAGE\n        return;\n      }\n      const parsedPlayer = JSON.parse(storedPlayer);\n\n      // 2.1 Fetch the full player data from the server\n      console.log(' 2.1 InitAppWrapper; fetching player from server...');\n      const response = await axios.get(`${API_BASE}/api/player/${parsedPlayer.playerId}`);\n      const DBPlayerData = response.data;\n      if (!DBPlayerData || !DBPlayerData.playerId) {\n        console.error('Invalid full player data from server:', DBPlayerData);\n        setisLoginPanelOpen(true);\n        return;\n      }\n      \n      // 2.2 Update lastActive timestamp for app initialization\n      console.log(' 2.2 InitAppWrapper; updating lastActive timestamp...');\n      try {\n        await axios.post(`${API_BASE}/api/update-last-active`, {\n          playerId: parsedPlayer.playerId\n        });\n      } catch (error) {\n        console.warn('Failed to update lastActive:', error);\n        // Don't block app initialization if this fails\n      }\n\n      // Step 2.5: Check for stale gridId (e.g. after offSeason relocation)\n      console.log(' 2.5 InitAppWrapper; checking for stale gridId after relocation...');\n      const storedGridId = localStorage.getItem(\"gridId\");\n      const resolvedGridId = DBPlayerData.location?.g;\n      if (storedGridId && resolvedGridId && storedGridId !== resolvedGridId) {\n        console.warn(\" Detected stale gridId from localStorage. Updating to new home grid.\");\n        localStorage.setItem(\"gridId\", resolvedGridId);\n        setGridId(resolvedGridId); //  Use setter to update React state\n      }\n\n      // Step 3. Combine local and server data, prioritizing newer info from the server\n      console.log(' 3 InitAppWrapper; Merging player data and initializing inventory...');\n      let updatedPlayerData = { ...parsedPlayer, ...DBPlayerData };\n      setCurrentPlayer(updatedPlayerData);\n      if (updatedPlayerData?.username) {\n        const isDev = await checkDeveloperStatus(updatedPlayerData.username);\n        setIsDeveloper(isDev);\n      }\n      setInventory(DBPlayerData.inventory || []);  // Initialize inventory properly\n      setBackpack(DBPlayerData.backpack || []);\n\n      // Step 4. Determine initial gridId from player or storage\n      console.log(' 4. Determining local gridId...');\n      const initialGridId = parsedPlayer?.location?.g || localStorage.getItem('gridId');\n      if (!initialGridId) {\n        console.error('No gridId found. Unable to initialize grid.');\n        return;\n      }\n      setGridId(initialGridId);\n      localStorage.setItem('gridId', initialGridId); // Save to local storage\n\n      // 4.5. Open the socket\n      socket.connect();\n      // Join the grid for grid-based updates\n      socket.emit('join-grid', { gridId: initialGridId, playerId: DBPlayerData.playerId });\n      console.log(\" Connected to socket and joined grid:\", initialGridId);\n      socket.emit('player-joined-grid', {\n        gridId: initialGridId,\n        playerId: DBPlayerData.playerId,\n        username: DBPlayerData.username,\n        playerData: DBPlayerData,\n      });\n      // Join the player room for personal updates\n      socket.emit('join-player-room', { playerId: DBPlayerData.playerId });\n      console.log(` Joined socket room for playerId: ${DBPlayerData.playerId}`);\n      socket.emit('set-username', { username: DBPlayerData.username });\n      \n      // Request current NPCController status to clear any stale controller data\n      console.log(` Requesting current NPCController for grid: ${initialGridId}`);\n      socket.emit('request-npc-controller', { gridId: initialGridId });\n\n      // Step 5. Initialize grid tiles, resources\n      console.log(' 5 InitAppWrapper; Initializing grid tiles and resources...');\n      await initializeGrid(\n        activeTileSize,\n        initialGridId,\n        setGrid,\n        setResources,\n        setTileTypes,\n        updateStatus,\n        DBPlayerData,\n        masterResources\n      );\n\n      // Step 6. Initialize NPCs\n      console.log(' 6 InitAppWrapper; Initializing NPC NPCsInGrid...');\n      await NPCsInGridManager.initializeGridState(initialGridId);\n      const freshNPCState = NPCsInGridManager.getNPCsInGrid(initialGridId);\n      console.log('initializedState (NPCs): ',freshNPCState);\n\n      // Step 7. Initialize PCs\n      console.log(' 7 InitAppWrapper; Initializing playersInGrid...');\n      await playersInGridManager.initializePlayersInGrid(initialGridId);\n      const freshPCState = playersInGridManager.getPlayersInGrid(initialGridId);\n      const playerId = String(parsedPlayer.playerId);\n      const playerPosition = freshPCState?.[playerId]?.position;\n      console.log('Player position from playersInGrid:', playerPosition);\n      if (playerPosition) {\n        centerCameraOnPlayer(playerPosition, activeTileSize);\n      }\n\n      // Step 8. Resolve player location \n      console.log(' 8 InitAppWrapper; Resolving player location...');\n      const playerIdStr = DBPlayerData._id.toString();\n      let gridPlayer = freshPCState?.[playerIdStr];\n\n      // Step A: Detect location mismatch or missing from NPCsInGrid\n      const isLocationMismatch = DBPlayerData.location?.g !== initialGridId;\n      const isMissingFromGrid = !gridPlayer;\n\n      console.log('isLocationMismatch = ', isLocationMismatch);\n      console.log('isMissingFromGrid = ', isMissingFromGrid);\n\n      if (isMissingFromGrid && gridId === DBPlayerData.location.g) {\n        console.warn(\" Player not in correct NPCsInGrid or missing entirely. Repositioning...\");\n        const targetPosition = { x: 0, y: 0 };\n        console.warn('InitAppWrapper: adding PC to NPCsInGrid');\n        await playersInGridManager.addPlayer(gridId, DBPlayerData.playerId, DBPlayerData);\n        // Refresh the NPCsInGrid and React state\n        console.warn('InitAppWrapper: refreshing NPCsInGrid');\n        setPlayersInGrid((prev) => ({\n          ...prev,\n          [gridId]: playersInGridManager.getPlayersInGrid(gridId),\n        }));\n        const gridPlayer = playersInGridManager.getPlayersInGrid(gridId)?.[playerIdStr];\n        console.log('Refreshed gridPlayer:', gridPlayer);\n        // Update gridId and storage to match actual grid\n        console.warn('InitAppWrapper: adding PC to NPCsInGrid');\n        setGridId(gridId);\n        localStorage.setItem(\"gridId\", gridId);\n        // Update player's in-memory and stored location\n        DBPlayerData.location = {\n          ...DBPlayerData.location,\n          x: targetPosition.x,\n          y: targetPosition.y,\n          g: gridId,\n        };\n\n        console.log(\" Player repositioned into NPCsInGrid:\", gridPlayer);\n      } else {\n        console.log(' Player found in local NPCsInGrid.');\n      }\n\n      // Step 11: Update local storage with final player state\n      console.log(' 11 InitAppWrapper: updating localStorage with player data');\n      updatedPlayerData = {\n        ...DBPlayerData,\n        location: {\n          ...DBPlayerData.location,\n          x: gridPlayer?.position?.x || 3,\n          y: gridPlayer?.position?.y || 3,\n          g: DBPlayerData.location.g,\n        },\n      };\n\n      setCurrentPlayer(updatedPlayerData);\n      localStorage.setItem('player', JSON.stringify(updatedPlayerData));\n      console.log(` LocalStorage updated with combat stats:`, updatedPlayerData);\n\n      // Step 12: Check for death flag and show modal if needed\n      if (updatedPlayerData.settings?.hasDied) {\n        console.log(\" Player died last session. Showing death modal.\");\n        setModalContent({\n          title: strings[\"5001\"],\n          message: strings[\"5002\"],\n          message2: strings[\"5003\"],\n          size: \"small\",\n        });\n        setIsModalOpen(true);\n\n        // Clear the flag in DB\n        await axios.post(`${API_BASE}/api/update-profile`, {\n          playerId: updatedPlayerData.playerId,\n          updates: { settings: { ...updatedPlayerData.settings, hasDied: false } },\n        });\n\n        // Clear the flag in localStorage\n        updatedPlayerData.settings.hasDied = false;\n        localStorage.setItem('player', JSON.stringify(updatedPlayerData));\n      }\n\n      // Step 13: Check for buttons that need to be badged\n      const storedBadges = getBadgeState(updatedPlayerData);\n      setBadgeState(storedBadges); //  apply localStorage state to UI immediately\n\n      //  Badge the mailbox if any messages are unread\n      const hasUnreadMail = (updatedPlayerData.messages || []).some(msg => !msg.read);\n      if (hasUnreadMail) {\n        updateBadge(updatedPlayerData, setBadgeState, 'mailbox', true); //  Use your helper\n      }\n\n      cleanupBadges = socketListenForBadgeUpdates(updatedPlayerData, setBadgeState, updateBadge);\n\n      console.log(' App initialization complete.');\n\n      //setShowTimers(true);    // default \"Happening In Town\" details open (true) or closed (flase)\n\n      const zoom = localStorage.getItem(\"initialZoomLevel\");\n      if (zoom) {\n        setZoomLevel(zoom);\n        localStorage.removeItem(\"initialZoomLevel\");\n      }\n\n      setIsAppInitialized(true);\n      \n      // Store FTUE info but don't show yet - wait for grid to load\n      if (updatedPlayerData.firsttimeuser === true && updatedPlayerData.ftuestep !== undefined && updatedPlayerData.ftuestep >= 0) {\n        console.log(' FTUE step detected for first-time user:', updatedPlayerData.ftuestep, ', will show after grid loads');\n        // Don't show FTUE yet - let the grid load first\n      }\n\n    } catch (error) {\n      console.error('Error during app initialization:', error);\n      \n      // If player not found (404), clear local storage and show login panel\n      if (error.response?.status === 404) {\n        console.log('Player not found (possibly deleted). Clearing local storage and showing login panel.');\n        localStorage.removeItem(\"player\");\n        localStorage.removeItem(\"playerId\");\n        setCurrentPlayer(null);\n        setisLoginPanelOpen(true);\n      } else {\n        updateStatus(error.code === 'ERR_NETWORK' ? 1 : 0);  // Handle other errors\n      }\n    }\n  };\n\n\n  initializeAppWrapper();\n\n  return () => {\n    cleanupBadges?.();\n  };\n}, []);  // Only run once when the component mounts\n\n\n// Establish UI BADGING (Chat, Mailbox, Store) //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!currentPlayer?.username) return;\n  // Load badge state from localStorage\n  const stored = localStorage.getItem(`badges_${currentPlayer.username}`);\n  if (stored) {\n    setBadgeState(JSON.parse(stored));\n  }\n  // Set up badge socket listener\n  const cleanupBadges = socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge);\n  // Clean up on unmount or player change\n  return () => {\n    cleanupBadges?.();\n  };\n}, [currentPlayer, socket]);\n\n// Watch for ftuestep changes to show FTUE modal\nuseEffect(() => {\n  // Only process FTUE if player is explicitly a first-time user\n  if (currentPlayer?.firsttimeuser === true && currentPlayer?.ftuestep !== undefined && currentPlayer.ftuestep >= 0) {\n    // Only show modal if this is a different step than last shown AND it's a forward progression\n    if (currentPlayer.ftuestep !== lastShownFTUEStep && \n        (lastShownFTUEStep === null || currentPlayer.ftuestep > lastShownFTUEStep)) {\n      \n      // Check if app is initialized and grid has loaded\n      const gridLoaded = isAppInitialized && tileTypes.length > 0 && resources.length > 0;\n      \n      if (gridLoaded) {\n        console.log(' FTUE step changed to:', currentPlayer.ftuestep, ', showing FTUE (grid loaded)');\n        // Close any open panels before showing FTUE modal to ensure clean state\n        closePanel();\n        setActiveStation(null); // Clear active station to prevent panels from re-opening\n        setShowFTUE(true);\n        setLastShownFTUEStep(currentPlayer.ftuestep);\n      } else {\n        console.log(' FTUE step changed to:', currentPlayer.ftuestep, ', but waiting for grid to load');\n      }\n    }\n  }\n}, [currentPlayer?.ftuestep, lastShownFTUEStep, isAppInitialized, tileTypes.length, resources.length, closePanel]);\n\n// Also check when grid loads to show pending FTUE\nuseEffect(() => {\n  if (currentPlayer?.firsttimeuser === true && \n      currentPlayer?.ftuestep !== undefined && \n      currentPlayer.ftuestep >= 0 &&\n      !showFTUE &&\n      isAppInitialized && \n      tileTypes.length > 0 && \n      resources.length > 0) {\n    \n    // If we have a pending FTUE step that hasn't been shown yet\n    if (currentPlayer.ftuestep !== lastShownFTUEStep) {\n      console.log(' Grid loaded, showing pending FTUE step:', currentPlayer.ftuestep);\n      // Close any open panels before showing FTUE modal to ensure clean state\n      closePanel();\n      setActiveStation(null); // Clear active station to prevent panels from re-opening\n      setShowFTUE(true);\n      setLastShownFTUEStep(currentPlayer.ftuestep);\n    }\n  }\n}, [isAppInitialized, tileTypes.length, resources.length, currentPlayer, lastShownFTUEStep, showFTUE, closePanel]);\n\n\n// FARM STATE - Farming Seed Timer Management //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (gridId && masterResources) {\n    farmState.initializeFarmState(resources); //  Works for seeds\n    farmState.startSeedTimer({gridId,setResources,masterResources});\n  }\n  return () => { farmState.stopSeedTimer(); };\n}, [gridId, resources, masterResources]);  \n\n\n\n//  NPC Management Loop\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping NPC management.'); return; }\n  //console.log(' NPC Management Loop started for gridId:', gridId);\n\n  const interval = setInterval(() => {\n    const currentGridNPCs = NPCsInGrid?.[gridId]?.npcs;\n    if (!currentGridNPCs) {\n      console.warn('No NPCs in NPCsInGrid for gridId:', gridId);\n      return;\n    }\n    const isController = controllerUsername === currentPlayer?.username;\n\n    if (isController) {\n      Object.values(currentGridNPCs).forEach((npc) => {\n        if (typeof npc.update !== 'function') {\n          console.warn(` Skipping NPC without update() method:`, npc);\n          return;\n        }\n        \n        // Verify NPC belongs to current grid before updating\n        if (npc.gridId && npc.gridId !== gridId) {\n          console.warn(` NPC ${npc.id} (${npc.type}) has gridId ${npc.gridId} but is being updated in grid ${gridId}. Skipping.`);\n          return;\n        }\n        \n        //console.log(`[ NPC LOOP] Controller running update() for NPC ${npc.id}, state=${npc.state}`);\n        npc.update(Date.now(), NPCsInGrid[gridId], gridId, activeTileSize);\n      });\n      \n      // Trigger React state update after all NPCs have been updated\n      // This ensures Canvas mode re-renders with new positions\n      const updatedGridState = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (updatedGridState?.npcs) {\n        NPCsInGridManager.setAllNPCs(gridId, updatedGridState.npcs);\n        console.log(' NPC update loop: Triggered state update, sample NPC:', \n          Object.values(updatedGridState.npcs)[0] ? {\n            id: Object.values(updatedGridState.npcs)[0].id,\n            pos: `${Object.values(updatedGridState.npcs)[0].position?.x},${Object.values(updatedGridState.npcs)[0].position?.y}`\n          } : 'none'\n        );\n      }\n    } else {\n      //console.log(' Not the NPC controller. Skipping NPC updates.');\n    }\n  }, 1000);\n\n  return () => clearInterval(interval);\n}, [isAppInitialized, gridId, NPCsInGrid, currentPlayer, activeTileSize, controllerUsername]);\n\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//  PC Management Loop: Check for player death & lava //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC management.'); return; }\n\n  const interval = setInterval(async () => {\n    if (playersInGrid && gridId && currentPlayer?._id) {\n      const playerId = String(currentPlayer._id);\n      const playerPC = playersInGrid?.[gridId]?.pcs?.[playerId];\n      const col = playerPC?.position?.x;\n      const row = playerPC?.position?.y;\n      const onTileType = tileTypes?.[row]?.[col];\n\n      if (playerPC?.hp <= 0 && currentPlayer) {\n        console.log(\" Player is dead. Handling death...\");\n        await handlePlayerDeath(\n          currentPlayer,\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setResources,\n          setTileTypes,\n          activeTileSize,\n          updateStatus,\n          setModalContent,\n          setIsModalOpen,\n          closeAllPanels\n        );\n        setModalContent({\n          title: strings[\"5001\"],\n          message: strings[\"5002\"],\n          message2: strings[\"5003\"],\n          size: \"small\",\n        });\n        setIsModalOpen(true);\n\n      } else {\n        //  Check for lava tile\n        if (onTileType === \"l\") {\n          const lavaDamage = 2;\n          playersInGrid[gridId].pcs[playerId].hp -= lavaDamage;\n          FloatingTextManager.addFloatingText(`- ${lavaDamage}  HP`, col, row, activeTileSize);\n          console.log(\" Player is standing on lava. Applying 2 damage.\");\n        }\n\n      }\n    }\n  }, 1000);\n  return () => clearInterval(interval);\n// Add dependencies for resources, setResources, setInventory, setBackpack, inventory, backpack, masterResources, masterSkills\n}, [\n  isAppInitialized,\n  gridId,\n  playersInGrid,\n  currentPlayer,\n  activeTileSize,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  masterResources,\n  masterSkills,\n]);\n\n//  PC Management Loop: Check for low health //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC Health Check.'); return; }\n\n  const interval = setInterval(async () => {\n      if (playersInGrid && gridId && currentPlayer?._id) {\n        const playerId = String(currentPlayer._id);\n        const playerPC = playersInGrid?.[gridId]?.pcs?.[playerId];\n        const col = playerPC?.position?.x;\n        const row = playerPC?.position?.y;\n\n      if (playerPC?.hp <= (currentPlayer.baseMaxhp/2) && currentPlayer.location.gtype === 'homestead') {\n          const healing = 2;\n          playersInGrid[gridId].pcs[playerId].hp += healing;\n          FloatingTextManager.addFloatingText(`+ ${healing}  HP`, col, row, activeTileSize);\n        }\n    }\n  }, 10000);\n  return () => clearInterval(interval);\n}, [\n  isAppInitialized,\n  gridId,\n  playersInGrid,\n  currentPlayer,\n  activeTileSize,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  masterResources,\n  masterSkills,\n]);\n\n/////// TIMERS & SEASONS //////////////////////////////////////////////////////\n\n// TIMERS Step 1: Global State for Timers\nconst [timers, setTimers] = useState(() => {\n  // Load from local storage (if available)\n  const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n  return storedTimers || {\n    seasons: { phase: \"\", endTime: null, type: \"\" },\n    elections: { phase: \"\", endTime: null },\n    train: { phase: \"\", endTime: null },\n    carnival: { phase: \"\", endTime: null },\n    taxes: { phase: \"\", endTime: null },  \n    bank: { phase: \"\", endTime: null },  \n  }; \n});\nconst [countdowns, setCountdowns] = useState({ seasons: \"\", elections: \"\", train: \"\", carnival: \"\", taxes: \"\", bank: \"\" });\n\n// TIMERS Step 2: Initialize Timers on app start/refresh; run once\nuseEffect(() => {\n  //console.log(\" currentPlayer = \",currentPlayer);\n\n  if (!currentPlayer?.settlementId) return;\n  const initializeTimers = async () => {\n      await fetchTimersData();\n      console.log(\" Timers initialized:\", timers);\n  };\n  initializeTimers();\n  const interval = setInterval(fetchTimersData, 60 * 1000); //  Refresh every 60s; DO WE NEED THIS??\n  return () => clearInterval(interval);\n}, [currentPlayer]); //  Runs when currentPlayer is updated\n\n// TIMERS Step 3: Fetch initial timers from the server\nconst fetchTimersData = async () => {\n  //console.log(\" Fetching initial timers from the server...\");\n  \n  if (!currentPlayer) { console.warn(\" No player loaded  skipping fetchTimersData.\"); return; }\n  if (!currentPlayer?.settlementId || !currentPlayer?.frontierId) return;\n\n  try {\n    const res = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n    const frontierData = res.data;\n    const updatedTimers = {\n      seasons: {\n        type: frontierData.seasons?.seasonType || \"Unknown\",\n        phase: frontierData.seasons?.phase || \"Unknown\",\n        endTime: frontierData.seasons?.endTime ? new Date(frontierData.seasons.endTime).getTime() : null,\n      },\n      elections: {\n        phase: frontierData.elections?.phase || \"Unknown\",\n        endTime: frontierData.elections?.endTime ? new Date(frontierData.elections.endTime).getTime() : null,\n      },\n      train: {\n        phase: frontierData.train?.phase || \"Unknown\",\n        endTime: frontierData.train?.endTime ? new Date(frontierData.train.endTime).getTime() : null,\n      },\n      carnival: {\n        phase: frontierData.carnival?.phase || \"Unknown\",\n        endTime: frontierData.carnival?.endTime ? new Date(frontierData.carnival.endTime).getTime() : null,\n      },\n      taxes: {\n        phase: frontierData.taxes?.phase || \"Unknown\",\n        endTime: frontierData.taxes?.endTime ? new Date(frontierData.taxes.endTime).getTime() : null,\n      },\n      bank: {\n        phase: frontierData.bank?.phase || \"Unknown\",\n        endTime: frontierData.bank?.endTime ? new Date(frontierData.bank.endTime).getTime() : null,\n      }\n    };\n\n    setTimers(updatedTimers);\n    localStorage.setItem(\"timers\", JSON.stringify(updatedTimers)); // Save to local storage\n    console.log(\" Current Time:\", Date.now());\n    \n  } catch (error) {\n    console.error(\" Error fetching timers data:\", error);\n  }\n};\n\n// TIMERS Step 4: Update countdown timers\nuseEffect(() => {\n  const updateCountdowns = () => {\n    // Guard against uninitialized timers\n    if (!timers || !timers.carnival) {\n      console.log(\"Timers not yet initialized, skipping countdown update\");\n      return;\n    }\n    \n    const now = Date.now(); // Get current timestamp\n\n    setCountdowns({\n      seasons: timers.seasons?.endTime ? formatCountdown(timers.seasons.endTime, now) : \"--:--:--\",\n      elections: timers.elections?.endTime ? formatCountdown(timers.elections.endTime, now) : \"--:--:--\",\n      train: timers.train?.endTime ? formatCountdown(timers.train.endTime, now) : \"--:--:--\",\n      carnival: timers.carnival?.endTime ? formatCountdown(timers.carnival.endTime, now) : \"--:--:--\",\n      taxes: timers.taxes?.endTime ? formatCountdown(timers.taxes.endTime, now) : \"--:--:--\",\n      bank: timers.bank?.endTime ? formatCountdown(timers.bank.endTime, now) : \"--:--:--\",\n    });\n  };\n\n  updateCountdowns(); // Run immediately\n  const interval = setInterval(updateCountdowns, 1000); // Update UI every second\n\n  return () => clearInterval(interval); // Cleanup on unmount\n}, [timers]); // Runs when timers update\n\n\n// TIMERS Step 5: Check Phase Transitions (LOCAL)\nuseEffect(() => {\n  const checkPhaseTransitions = async () => {\n    //console.log(\"checkPhaseTransitions;  season = \",timers.seasons.phase);\n    const now = Date.now();\n    let shouldFetchNewTimers = false;\n    // console.log(\" Checking season timer... now =\", new Date(now).toLocaleTimeString(), \n    //   \"| endTime =\", new Date(timers.seasons.endTime).toLocaleTimeString()\n    // );\n    if (timers.seasons.endTime && now >= timers.seasons.endTime) {\n      console.log(\" Season phase ended.\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.elections.endTime && now >= timers.elections.endTime) {\n      console.log(\" Election phase ended. Fetching new election data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.train.endTime && now >= timers.train.endTime) {\n      console.log(\" Train cycle ended. Fetching new train data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.carnival.endTime && now >= timers.carnival.endTime) {\n      console.log(\" Carnival cycle ended. Fetching new carnival data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.taxes.endTime && now >= timers.taxes.endTime) {\n      console.log(\" Tax cycle ended. Fetching new tax data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.bank.endTime && now >= timers.bank.endTime) {\n      console.log(\" Bank cycle ended. Fetching new bank timer...\");\n      shouldFetchNewTimers = true;\n    }\n    if (shouldFetchNewTimers) {\n      console.log(\" A phase has ended! Fetching updated timers...\");\n      await fetchTimersData();\n      const updatedPhase = JSON.parse(localStorage.getItem(\"timers\"))?.seasons?.phase;\n      if (updatedPhase === \"offSeason\") {\n        setIsOffSeason(true);\n        console.log(\" OffSeason detected immediately after fetch.\");\n      }\n    }\n  };\n\n  if (timers.seasons.phase === \"offSeason\") { \n    setIsOffSeason(true);\n  } else {\n    setIsOffSeason(false); \n  }\n\n  const interval = setInterval(checkPhaseTransitions, 1000); //  Check every 1s\n  return () => clearInterval(interval);\n}, [timers]); // Runs when timers update\n\n\nconst previousPhaseRef = useRef(timers.seasons?.phase);\n\n//  Refresh client when offSeason ends\nuseEffect(() => {\n  const currentPhase = timers.seasons?.phase;\n  if (\n    previousPhaseRef.current === \"offSeason\" &&\n    currentPhase === \"onSeason\"\n  ) {\n    console.warn(\" offSeason ended  forcing full app reload.\");\n    window.location.reload();\n  }\n  previousPhaseRef.current = currentPhase;\n}, [timers.seasons?.phase]);\n\n\n\n/////////// SOCKET LISTENERS /////////////////////////\n\n//  SOCKET LISTENER: Real-time updates for PC join and leave\nuseEffect(() => {\n  socketListenForPCJoinAndLeave(gridId, currentPlayer, isMasterResourcesReady, setPlayersInGrid, controllerUsername, setControllerUsername);\n}, [socket, gridId, isMasterResourcesReady, currentPlayer, controllerUsername]);\n\n//  SOCKET LISTENER: PCs: Real-time updates for GridState (PC sync)\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC socket changes.'); return; }  \n  socketListenForPCstateChanges(activeTileSize, gridId, currentPlayer, setPlayersInGrid, localPlayerMoveTimestampRef);\n}, [socket, gridId, currentPlayer]);\n\n//  SOCKET LISTENER: NPCs:  Real-time updates for GridStateNPC snc\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping NPC socket changes.'); return; }  \n  socketListenForNPCStateChanges(activeTileSize, gridId, setGridState, npcController);\n}, [socket, gridId, isAppInitialized]);\n\n//  SOCKET LISTENER: Real-time updates for resources\nuseEffect(() => {\n  socketListenForResourceChanges(activeTileSize, gridId, isMasterResourcesReady, setResources, masterResources, enrichResourceFromMaster);\n}, [socket, gridId, isMasterResourcesReady]); //  Add isMasterResourcesReady as a dependency\n\n//  SOCKET LISTENER: Real-time updates for tiles\nuseEffect(() => {\n  socketListenForTileChanges(gridId, setTileTypes, mergeTiles);\n}, [socket, gridId]);\n\n// Add socket event listeners for NPC controller status\nuseEffect(() => {\n  socketListenForNPCControllerStatus(gridId, currentPlayer, setControllerUsername);\n}, [socket, gridId, currentPlayer]);\n\n//  SOCKET LISTENER: Force refresh on season reset\nuseEffect(() => {\n  socketListenForSeasonReset();\n}, [socket]);\n\nuseEffect(() => {\n  if (!socket || !currentPlayer || !gridId) return;\n  socketListenForConnectAndDisconnect(gridId, currentPlayer, setIsSocketConnected);\n}, [socket, currentPlayer, gridId]);\n\nuseEffect(() => {\n  if (!socket || !gridId) return;\n  const cleanup = socketListenForPlayerConnectedAndDisconnected(gridId, setConnectedPlayers);\n  return cleanup;\n}, [socket, gridId]);\n\n//  SOCKET LISTENER: Real-time updates for mailbox badge\nuseEffect(() => {\n  if (!socket || !currentPlayer?.playerId) return;\n  const cleanup = socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge);\n  return cleanup;\n}, [socket, currentPlayer]);\n\n//  SOCKET LISTENER: Real-time chat messages\nuseEffect(() => {\n  if (!socket || !currentPlayer) return;\n  const cleanup = socketListenForChatMessages(setChatMessages); //  Must pass correct setter\n  return cleanup;\n}, [socket, currentPlayer]);\n\n\n/////////// HANDLE ZOOMING & RESIZING /////////////////////////\n\nconst zoomIn = async () => {\n  const gridId = currentPlayer?.location?.g;\n  if (!gridId || !currentPlayer?._id) { console.warn(\"No valid gridId or playerId found for currentPlayer.\"); return; }\n  const playerIdStr = String(currentPlayer._id);\n  const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n  if (currentPlayer.iscamping) { updateStatus(32); return; }\n  \n  if (zoomLevel === 'frontier') {\n    setZoomLevel('settlement'); // Zoom into the settlement view\n    updateStatus(12); // \"Settlement view.\"\n  } else if (zoomLevel === 'settlement') {\n    centerCameraOnPlayerFast(playerPos, TILE_SIZES.far); \n    setZoomLevel('far'); // Zoom into the grid view\n    const { username, gridType } = await fetchHomesteadOwner(gridId);\n\n    if (gridType === 'town') {\n      updateStatus(14);\n    } else if ([\"valley0\", 'valley1', 'valley2', 'valley3'].includes(gridType)) {\n      updateStatus(16);\n    } else if (gridType === 'homestead') {\n      if (username) {\n        await updateGridStatus(gridType, username, updateStatus, currentPlayer, currentPlayer.location.g);\n      } else {\n        updateStatus('This homestead is unoccupied.');\n      }\n    } else {\n      console.warn(`Unexpected gridType: ${gridType}`);\n      updateStatus('Unknown location.');\n    }\n\n  } else if (zoomLevel === 'far') {\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.close);\n    }, 50); // Allow brief render before scrolling\n    setZoomLevel('close'); // Zoom into a detailed view\n  } else if (zoomLevel === 'close') {\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.closer);\n    }, 50); // Allow brief render before scrolling\n    setZoomLevel('closer');\n  }\n};\n\nconst zoomOut = () => {\n  const gridId = currentPlayer?.location?.g;\n  if (!gridId || !currentPlayer?._id) { console.warn(\"No valid gridId or playerId found for currentPlayer.\"); return; }\n  const playerIdStr = String(currentPlayer._id);\n  const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n\n  if (currentPlayer.iscamping) { updateStatus(32); return; }\n  if (zoomLevel === 'closer') {\n    setZoomLevel('close');\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.close);\n    }, 50); // Allow brief render before scrolling\n  } else if (zoomLevel === 'close') {\n    setZoomLevel('far'); // Zoom out to grid view\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.far);\n    }, 50); // Allow brief render before scrolling\n  } else if (zoomLevel === 'far') {\n    setZoomLevel('settlement'); // Zoom out to settlement view\n    updateStatus(12); // \"Settlement view.\"\n  } else if (zoomLevel === 'settlement') {\n    setZoomLevel('frontier'); // Zoom out to frontier view\n    updateStatus(13); // \"Frontier view.\"\n  }\n};\n\n/////////// HANDLE KEY MOVEMENT /////////////////////////\n\nconst localPlayerMoveTimestampRef = useRef(0);\n\nuseEffect(() => {\n  const handleKeyDown = (event) => {\n    if (activeModal) { return; } // Keyboard input disabled while modal is open\n    if (isOffSeason) { return; } // Keyboard input disabled while offseason\n    if (zoomLevel === 'frontier' || zoomLevel === 'settlement') { return; }  // Prevent input if zoomed out\n    const activeElement = document.activeElement;\n    if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) { return; } // Prevent movement if a text input is focused\n    \n    \n    if ([\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(event.key)) { event.preventDefault(); }  // Prevent the browser from scrolling when using arrow keys\n\n    handleMovementKeyDown(event, currentPlayer, activeTileSize, masterResources,\n        setCurrentPlayer, \n        setGridId, \n        setGrid, \n        setTileTypes, \n        setResources, \n        updateStatus, \n        closeAllPanels,\n        localPlayerMoveTimestampRef,\n        bulkOperationContext,\n        strings\n    );\n  };\n  \n  const handleKeyUp = (event) => {\n    // Handle key release for diagonal movement\n    handleMovementKeyUp(event);\n  };\n  \n  window.addEventListener('keydown', handleKeyDown); \n  window.addEventListener('keyup', handleKeyUp);\n  return () => {\n    window.removeEventListener('keydown', handleKeyDown); \n    window.removeEventListener('keyup', handleKeyUp);\n  };\n}, [currentPlayer, masterResources, activeTileSize, activeModal, zoomLevel]);\n\n\n\n//////////// HANDLE CLICKING /////////////////////////\n\nlet isProcessing = false; // Guard against duplicate clicks\n\nconst handleTileClick = useCallback(async (rowIndex, colIndex) => {\n  if (isProcessing) return; // Skip if still processing\n  isProcessing = true;\n\n  // Find resource including multi-tile resources\n  const resource = resources.find((res) => {\n    const range = res.range || 1;\n    // Check if the clicked tile falls within the resource's range\n    // Resource is anchored at lower-left (res.x, res.y)\n    return colIndex >= res.x && colIndex < res.x + range &&\n           rowIndex <= res.y && rowIndex > res.y - range;\n  });\n  console.log(' handleTileClick invoked with:', { rowIndex, colIndex, resource });\n\n  //  Prevent interaction on another player's homestead\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n  if (resource && currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {\n    const isFriend = false; //  Future: replace with actual friend-checking logic\n    const alwaysBlocked = ['Mailbox', 'Trade Stall', 'Warehouse'];\n    const isForbiddenStation = resource?.category === 'station' && alwaysBlocked.includes(resource?.type);\n    const isSafe = resource?.category === 'npc' || resource?.category === 'travel'; // Expand as needed\n    if (isForbiddenStation || (!isSafe && !isFriend)) {\n      console.warn(\" Blocked interaction on another player's homestead.\");\n      updateStatus(90);\n      isProcessing = false;\n      return;\n    }\n  }\n\n  // Validate `gridId` and `username`\n  if (!gridId || typeof gridId !== 'string') { console.error('Invalid gridId:', gridId); return; }\n  if (!currentPlayer?.username || typeof currentPlayer.username !== 'string') { console.error('Invalid username:', currentPlayer?.username); return; }\n  //  Get player position from playersInGrid\n  if (!currentPlayer?._id) { console.error('No player ID found'); return; }\n  const playerPos = playersInGridManager.getPlayerPosition(gridId, String(currentPlayer._id));\n  const targetPos = { x: colIndex, y: rowIndex };\n  if (!playerPos || typeof playerPos.x === 'undefined' || typeof playerPos.y === 'undefined') {\n      console.error(\" Player position is invalid in NPCsInGrid; playerPos: \", playerPos);\n      isProcessing = false;\n      return;\n  }\n  // If clicking a resource, check range before interacting (except NPCs)\n//  if (resource && resource.category !== 'npc' && !isOnOwnHomestead) {\n  if (resource && resource.category !== 'npc') {\n    const distance = calculateDistance(playerPos, targetPos);\n    const playerRange = getDerivedRange(currentPlayer, masterResources);    \n    if (distance > playerRange) {\n      FloatingTextManager.addFloatingText(24, targetPos.x, targetPos.y, activeTileSize);\n      isProcessing = false;\n      return;\n    }\n  }\n  if (resource) {\n    console.log('App.js: Resource clicked:', resource);\n    if (resource.category === 'npc') { } // handled in RenderDynamic\n    else if (resource.category === 'travel') {\n      // Check if any bulk operation is active\n      if (bulkOperationContext?.isAnyBulkOperationActive?.()) {\n        const activeOps = bulkOperationContext.getActiveBulkOperations();\n        updateStatus(470);\n        return;\n      }\n      \n      // Handle clickable signposts\n      const { handleTransitSignpost } = await import('./GameFeatures/Transit/Transit');\n      await handleTransitSignpost(\n        currentPlayer,\n        resource.type,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        setResources,\n        updateStatus,\n        activeTileSize,\n        currentPlayer.skills,\n        closeAllPanels,\n        bulkOperationContext,\n        masterResources,\n        strings,\n        masterTrophies\n      );\n    }\n    else if (resource.category === 'training') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('SkillsPanel'); \n    }\n    else if (resource.category === 'crafting') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      switch (resource.type) {\n        case 'Ancient Temple':\n          openPanel('ScrollStation'); \n          break;\n        default:\n          openPanel('CraftingStation');\n          break;\n      }\n    } \n    else if (resource.category === 'farmhouse') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('FarmHouse');\n    } \n    else if (resource.category === 'shop') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('ShopStation');\n    } \n    else if (resource.category === 'stall') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('AnimalStall');\n    } \n    else if (resource.category === 'farmplot') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, resource: resource });\n      openPanel('CropPanel');\n    } \n    else if (resource.category === 'deco') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('DecoPanel');\n    } \n    else if (resource.category === 'pet') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('PetPanel');\n    } \n    else if (resource.category === 'station') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      switch (resource.type) {\n        case 'Courthouse':\n          openPanel('Courthouse'); break;\n        case 'Trade Stall':\n        case 'Trade':\n        case 'Trading Post':\n          openPanel('TradeStall'); \n          break;\n        case 'Outpost':\n          openPanel('OutpostPanel'); \n          break;\n        case 'Mailbox':\n          openModal('Mailbox'); break;\n        case 'Warehouse':\n          openPanel('WarehousePanel'); break;\n        case 'Train':\n//          openPanel('TrainPanel'); break;\n          openPanel('NewTrainPanel'); break;\n        case 'Carnival':\n          openPanel('CarnivalPanel'); break;\n        case 'Bank':\n          openPanel('BankPanel'); break;\n        case 'Worker Slot':\n          // Find the Farm House on the grid\n          const farmHouse = resources.find(res => res.type === 'Farm House' && res.category === 'farmhouse');\n          if (farmHouse) {\n            // Set the Farm House as the active station\n            setActiveStation({\n              type: 'Farm House', \n              position: { x: farmHouse.x, y: farmHouse.y }, \n              gridId: gridId\n            });\n            openPanel('FarmHouse');\n          } else {\n            console.warn('Farm House not found on grid');\n            updateStatus('Farm House not found');\n          }\n          break;\n        default:\n          console.warn(`Unhandled station type: ${resource.type}`);\n      }\n    } else {\n      // Pass to handleResourceClick for all other resources\n      // Use resource's anchor position for multi-tile resources\n      handleResourceClick(\n        resource,\n        resource.y,  // Use resource's actual y position\n        resource.x,  // Use resource's actual x position\n        resources,\n        setResources,\n        setInventory,\n        setBackpack,\n        inventory,\n        backpack,\n        FloatingTextManager.addFloatingText,\n        gridId,\n        activeTileSize,\n        tileTypes,\n        currentPlayer,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        updateStatus,\n        masterResources,\n        masterSkills,\n        setModalContent,\n        setIsModalOpen,\n        closeAllPanels,\n        strings,\n        bulkOperationContext,\n        openPanel,\n        masterTrophies,\n        globalTuning\n      ).finally(() => {\n        isProcessing = false; // Reset flag after processing\n      });\n    }\n  } else {\n    console.log('isTeleportEnabled:', currentPlayer?.settings?.isTeleportEnabled);\n  \n    if (currentPlayer?.settings?.isTeleportEnabled) {\n      const targetPosition = { x: colIndex, y: rowIndex };\n      console.log(' Player teleporting to grid position:', targetPosition);\n  \n      // Update currentPlayer state\n      const updatedPlayer = {\n        ...currentPlayer,\n        position: targetPosition\n      };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n  \n      // Multiplayer sync  update PC in grid\n      if (currentPlayer?._id) {\n        playersInGridManager.updatePC(gridId, currentPlayer._id, {\n          position: targetPosition\n        });\n      }\n    }\n  }\n  isProcessing = false; // Reset flag here\n\n}, [resources, gridId, inventory, currentPlayer, playerPosition, activeTileSize]);\n  \n\n  \n//////////// HANDLE LOGIN and LOGOUT /////////////////////////\n\nconst handleLogout = () => {\n  console.log('Logging out user...');\n  NPCsInGridManager.stopGridStateUpdates();  // Clear all states\n  setCurrentPlayer(null);\n  setInventory({});\n  setPlayerPosition({ x: 0, y: 0 });\n  setGrid([]); // Clear the grid\n  setResources([]); // Clear resources\n  setTileTypes([]); // Clear tile types\n  setGridId(null); // Clear gridId\n  localStorage.removeItem('gridId'); // Remove gridId from local storage\n  localStorage.removeItem('player');  // Remove player data from local storage\n  window.location.reload();  // Force a state reset by triggering the login modal\n  console.log('Player has logged out, and state has been reset.');\n};\n\nconst handleLoginSuccess = async (player) => {\n  console.log('Handling login success for player:', player);  // Store player data in localStorage\n  localStorage.setItem('player', JSON.stringify(player));  // Reload the app (triggers full initialization)\n  window.location.reload();\n};\n\n\n  /////////////// HANDLE INACTIVITY for controller relinquishment and refresh //////////////\n\n  useEffect(() => {\n    let lastActivity = Date.now();\n    const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes\n    const REFRESH_TIMEOUT = 20 * 60 * 1000; // 20 minutes\n    const updateActivity = () => { lastActivity = Date.now(); };\n\n    const checkStaleness = () => {\n      const now = Date.now();\n      const inactiveTime = now - lastActivity;\n      if (inactiveTime >= REFRESH_TIMEOUT) {\n        console.warn(' Inactive too long. Showing refresh modal.');\n        setModalContent({\n          title: strings[\"70\"],\n          message: strings[\"71\"],\n          message2: strings[\"72\"],\n          size: \"small\",\n          onClose: () => setIsModalOpen(false),\n          children: (\n            <div style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n              <div className=\"shared-buttons\">\n                <button\n                  className=\"btn-basic btn-success\"\n                  onClick={() => {\n                    setIsModalOpen(false);\n                    window.location.reload();\n                  }}\n                >\n                  {strings[\"73\"]}\n                </button>\n              </div>\n            </div>\n          ),\n        });\n        setIsModalOpen(true);\n\n        // Set a backup auto-refresh after 30 seconds\n        setTimeout(() => {\n          console.warn(\" Auto-refreshing due to inactivity...\");\n          window.location.reload();\n        }, 30000);\n\n      } else if (inactiveTime >= INACTIVITY_LIMIT) {\n        console.warn(' Inactive for a while. Releasing controller role.');\n        if (controllerUsername === currentPlayer?.username) {\n          socket.emit('relinquish-npc-controller', { gridId });\n        }\n      }\n    };\n\n    window.addEventListener('mousemove', updateActivity);\n    window.addEventListener('keydown', updateActivity);\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'visible') {\n        // When tab becomes visible, check if we've been inactive too long BEFORE updating activity\n        const now = Date.now();\n        const inactiveTime = now - lastActivity;\n        console.log(` Tab became visible. Inactive for ${Math.floor(inactiveTime / 60000)} minutes`);\n        \n        // Check staleness FIRST before updating activity\n        if (inactiveTime >= REFRESH_TIMEOUT) {\n          console.warn(' Was inactive too long while tab was hidden. Showing refresh modal.');\n          checkStaleness();\n          // Don't update activity - let the modal show\n          return;\n        }\n        \n        // Only update activity if we haven't exceeded timeout\n        updateActivity();\n      }\n    });\n\n    const interval = setInterval(checkStaleness, 60000); // check every minute\n\n    return () => {\n      window.removeEventListener('mousemove', updateActivity);\n      window.removeEventListener('keydown', updateActivity);\n      clearInterval(interval);\n    };\n  }, [currentPlayer, controllerUsername, gridId]);\n\n\n  ///////////////// FOR THE PANELS:\n\n  const [showTimers, setShowTimers] = useState(false);\n  const [showStats, setShowStats] = useState(false); // Toggle for combat stats UI\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n\n  // Chat panel slideout state\n  const [isChatOpen, setIsChatOpen] = useState(false);\n  const [isChatClosing, setIsChatClosing] = useState(false);\n  \n  const handleCloseChat = () => {\n    setIsChatClosing(true);\n    setTimeout(() => {\n      setIsChatOpen(false);\n      setIsChatClosing(false);\n    }, 300); // Match the animation duration\n  };\n\n\n  ///////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////\n  /////////////// RENDERING THE APP /////////////////////////\n  ///////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////\n\n  // Extract NPCs and PCs for the current grid\n  const npcs = React.useMemo(() => {\n    const npcArray = Object.values(NPCsInGrid?.[gridId]?.npcs || {});\n    return npcArray;\n  }, [NPCsInGrid, gridId]);\n  \n  const pcs = Object.values(playersInGrid?.[gridId]?.pcs || {});\n\nreturn (\n    <>\n    <FloatingTextManager />\n\n{/* //////////////////////  Header  //////////////////////// */}\n\n    <header className=\"app-header\">\n            \n        <div className=\"header-controls-left\">\n\n  <h1 style={{ transform: 'translateX(30px)', marginRight: '20px' }}>{strings[0]}</h1>\n\n        {currentPlayer?.accountStatus === 'Gold' && (\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-header btn-gold\" onClick={() => openPanel('ProfilePanel')}>{currentPlayer.icon} {currentPlayer.username}</button>\n          </div>\n        )}\n        {currentPlayer?.accountStatus === 'Free' && (\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-header\" onClick={() => openPanel('ProfilePanel')}>{currentPlayer.icon} {currentPlayer.username}</button>\n          </div>\n        )}\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-header\" disabled={!currentPlayer} onClick={() => openPanel('InventoryPanel')}>{strings[10103]} </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-header\"\n            onClick={() => openPanel('HowToMoneyPanel')}\n          >\n             {Array.isArray(currentPlayer?.inventory)\n              ? (currentPlayer.inventory.find((item) => item.type === \"Money\")?.quantity || 0).toLocaleString()\n              : \"...\"}\n          </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-header\"\n            onClick={() => openPanel('HowToGemsPanel')}\n          >\n             {Array.isArray(currentPlayer?.inventory)\n              ? (currentPlayer.inventory.find((item) => item.type === \"Gem\")?.quantity || 0).toLocaleString()\n              : \"...\"}\n          </button>\n        </div>\n        <div className=\"nav-button-wrapper\">\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-header\" disabled={!currentPlayer} onClick={() => openModal('Mailbox')}>{strings[10105]}</button>\n          </div>\n          {badgeState.mailbox && <div className=\"badge-dot\" />}\n        </div>\n        <div className=\"nav-button-wrapper\">\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-header btn-gold\" disabled={!currentPlayer} onClick={() => setActiveModal(\"Store\")}>{strings[10104]}</button>\n          </div>\n          {badgeState.store && <div className=\"badge-dot\" />}\n        </div>\n\n      </div>\n        <div className=\"header-controls-right\">\n            <div className=\"nav-button-wrapper\">\n              <div className=\"shared-buttons\">\n                <button className=\"btn-basic btn-header\" disabled={!currentPlayer} onClick={() => setIsChatOpen(prev => !prev)}>{strings[10107]}</button>\n              </div>\n              {badgeState.chat && <div className=\"badge-dot\" />}\n            </div>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-header\" onClick={() => setShowShareModal(true)}>{strings[10106]}</button>\n            </div>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-header\" disabled={!currentPlayer} onClick={() => setActiveModal('LanguagePicker')}>\n                 {LANGUAGE_OPTIONS.find(l => l.code === currentPlayer?.language)?.label || 'Language'}\n              </button>\n            </div>\n        </div>\n    </header>\n    \n    <div className=\"status-bar-wrapper\"> <StatusBar /> </div>\n\n    {/* Chat Slideout Panel */}\n    {isChatOpen && currentPlayer && (\n      <div className={`chat-panel-slideout ${isChatClosing ? 'closing' : ''}`}>\n        <Chat\n          currentGridId={currentPlayer.location?.g}\n          currentSettlementId={currentPlayer.location?.s}\n          currentFrontierId={currentPlayer.frontierId}\n          currentPlayer={currentPlayer}\n          onClose={handleCloseChat}\n        />\n      </div>\n    )}\n\n\n{/* //////////////// Left Side Navigation Column ///////////////// */}\n\n    <div className=\"nav-column\">\n\n        <div className=\"zoom-controls\">\n          <div className=\"zoom-button-container\">\n            <button className=\"zoom-button zoom-in\" disabled={!currentPlayer} onClick={zoomIn}><span>+</span></button>\n            <button className=\"zoom-button zoom-out\" disabled={!currentPlayer} onClick={zoomOut}><span></span></button>\n          </div>\n        </div>\n\n      <button className={`nav-button ${!activePanel ? 'selected' : ''}`} title={strings[12009]} onClick={() => closePanel()}></button>\n      <button className={`nav-button ${activePanel === 'QuestPanel' ? 'selected' : ''}`} title={strings[12004]} disabled={!currentPlayer} onClick={() => openPanel('QuestPanel')}></button>\n\n      <button \n        className={`nav-button ${activePanel === 'FarmingPanel' ? 'selected' : ''}`} title={strings[12001]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('FarmingPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'ToolsPanel' ? 'selected' : ''}`} title={strings[12012]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead) {updateStatus(90);return;}\n          openPanel('ToolsPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'BuyPanel' ? 'selected' : ''}`} title={strings[12003]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('BuyPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'BuildPanel' ? 'selected' : ''}`} title={strings[12002]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('BuildPanel');\n        }}\n      ></button>\n      <button className={`nav-button ${activePanel === 'SkillsPanel' ? 'selected' : ''}`} title={strings[12005]} disabled={!currentPlayer} onClick={() => {\n          setActiveStation(null); //  Reset activeStation\n          openPanel(\"SkillsPanel\"); //  Open the panel normally\n        }}></button>\n\n      {!currentPlayer?.firsttimeuser && isOnOwnHomestead && (\n        <button \n          className={`nav-button ${activePanel === 'PetsPanel' ? 'selected' : ''}`} title={strings[12014]} disabled={!currentPlayer} \n          onClick={() => {\n            if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n            if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n            openPanel('PetsPanel');\n          }}\n        ></button>\n      )}\n\n      {!currentPlayer?.firsttimeuser && (\n        <button \n          className={`nav-button ${activePanel === 'BuyDecoPanel' ? 'selected' : ''}`} title={strings[12011]} disabled={!currentPlayer} \n          onClick={() => {\n            if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n            // Check if on another player's homestead\n            if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n            openPanel('BuyDecoPanel');\n          }}\n        ></button>\n      )}\n\n      {!currentPlayer?.firsttimeuser && (\n        <button className={`nav-button ${activePanel === 'CombatPanel' ? 'selected' : ''}`} title={strings[12006]} disabled={!currentPlayer} onClick={() => openPanel('CombatPanel')}></button>\n      )}\n      {!currentPlayer?.firsttimeuser && (\n        <button className={`nav-button ${activePanel === 'GovPanel' ? 'selected' : ''}`} title={strings[12007]} onClick={() => openPanel('GovPanel')}></button>\n      )}\n\n      <button className={`nav-button ${activePanel === 'TrophyPanel' ? 'selected' : ''}`} title={strings[12013]} onClick={() => openPanel('TrophyPanel')}></button>\n\n      {isDeveloper && (\n        <button className={`nav-button ${activePanel === 'DebugPanel' ? 'selected' : ''}`} title=\"Debug\" onClick={() => openPanel('DebugPanel')}>\n          \n        </button>\n      )}\n    </div>\n\n    <div className=\"app-container\">\n\n\n{/* ///////////////////  Base Panel  ///////////////////// */}\n\n    <div className=\"base-panel\">\n \n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openPanel('HowToPanel')}>{strings[10109]} AWSD</button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openPanel('HowToPanel')}>{strings[10110]}</button>\n      </div>\n      <br/>\n\n      {/* Add Role display if player has one */}\n      {isMayor && (\n        <> <h2 className=\"player-role\"> {strings[10111]} </h2>\n          <br />\n        </>\n      )}\n\n      {/* Hit Points */}\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openPanel('CombatPanel')}>{strings[10112]} <strong>{currentPlayer?._id ? playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)]?.hp ?? \"?\" : \"?\"} / {currentPlayer?._id ? playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)]?.maxhp ?? \"?\" : \"?\"}</strong></button>\n      </div>\n      <br />\n\n      {/* Season */}\n      {timers.seasons.phase === \"onSeason\" ? (\n        <>\n          <h2>{strings[10113]} {seasonData?.type || \"[Season unknown]\"}</h2>\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic\" onClick={() => openPanel('SeasonPanel')}>{strings[10114]}<br /><strong>{countdowns.seasons}</strong></button>\n          </div>\n        </>\n      ) : (\n        <>\n          <h2>{strings[10113]} {seasonData?.type || \"[Season unknown]\"}</h2>\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic\" onClick={() => openPanel('SeasonPanel')}>{strings[10115]}<br /><strong>{countdowns.seasons}</strong></button>\n          </div>\n        </>\n      )}\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openModal('TownNews')}>{strings[10125]}</button>\n      </div>\n\n      <br />\n      <br />\n      <br />\n\n      <h2>{strings[96]}</h2>\n      <div className=\"shared-buttons\">\n        <button\n          className=\"btn-basic\"\n          onClick={() => window.open('https://discord.gg/SZMw4vpUJV', '_blank')}\n        >\n          Join Discord Server\n        </button>\n      </div>\n      \n      <div className=\"shared-buttons\">\n        <button\n          className=\"btn-basic\"\n          onClick={() => window.location.href = 'mailto:valleyviewgamedev@gmail.com'}\n        >\n          {strings[97]}\n        </button>\n      </div>\n\n      <br />\n      <h3>{strings[10126]}</h3>\n      <div>\n      {playersInGrid?.[gridId]?.pcs && typeof playersInGrid[gridId].pcs === 'object' ? (\n          Object.entries(playersInGrid[gridId].pcs).length === 0 ? (\n            <h4 style={{ color: \"white\" }}>{strings[10127]}</h4>\n          ) : (\n            Object.entries(playersInGrid[gridId].pcs).map(([playerId, pc]) => (\n              <p key={playerId} style={{ color: \"white\" }}>\n                {connectedPlayers.has(playerId) && ' '}\n                <strong>{pc.username}</strong>\n              </p>\n            ))\n          )\n        ) : (\n          <h4 style={{ color: \"white\" }}>{strings[10127]}</h4>\n        )}\n        <h4 style={{ color: \"white\" }}>\n          {controllerUsername \n            ? ` ${controllerUsername}` \n            : \"There is no NPCController\"}\n        </h4>\n      </div>\n      <br />\n    </div>\n\n      \n{/* //////////////////// Game Board //////////////////// */}\n\n    <div className=\"homestead\">\n\n      {showKeyArt && (\n        <div className=\"keyart-wrapper\">\n          <img\n            src=\"/assets/images/ValleyViewLoadScreen.png\"\n            alt=\"Valley View Key Art\"\n            className=\"keyart-image\"\n          />\n          <CowboyAnimation />\n        </div>\n      )}\n\n      {zoomLevel === 'far' || zoomLevel === 'closer' || zoomLevel === 'close' ? (\n      <>\n        {/* Layer 1: Tiles */}\n        <RenderTiles\n          grid={memoizedGrid}\n          tileTypes={memoizedTileTypes}\n          TILE_SIZE={activeTileSize}\n          handleTileClick={handleTileClick}\n          useCanvasTiles={useCanvasTiles}\n        />\n        \n        {/* Layer 2: Resources */}\n        <RenderResources\n          resources={memoizedResources}\n          masterResources={masterResources}\n          globalTuning={globalTuning}\n          TILE_SIZE={activeTileSize}\n          handleTileClick={handleTileClick}\n          currentPlayer={currentPlayer}\n          strings={strings}\n          badgeState={badgeState}\n          electionPhase={timers.elections.phase}\n          useCanvasResources={useCanvasResources}\n        />\n        \n        {/* Layer 3: NPCs */}\n        <RenderNPCs\n          npcs={npcs}\n          TILE_SIZE={activeTileSize}\n          currentPlayer={currentPlayer}\n          globalTuning={globalTuning}\n          gridId={currentPlayer?.location?.g}\n          onNPCClick={handleNPCPanel}\n          checkQuestNPCStatus={checkQuestNPCStatus}\n          checkTradeNPCStatus={checkTradeNPCStatus}\n          checkKentNPCStatus={checkKentNPCStatus}\n          strings={strings}\n          masterResources={masterResources}\n          playersInGrid={playersInGrid}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          setResources={setResources}\n          setCurrentPlayer={setCurrentPlayer}\n          masterSkills={masterSkills}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          masterTrophies={masterTrophies}\n          useCanvasNPCs={useCanvasNPCs}\n        />\n        \n        {/* Layer 4: PCs */}\n        <RenderPCs\n          pcs={pcs}\n          TILE_SIZE={activeTileSize}\n          currentPlayer={currentPlayer}\n          onPCClick={handlePCClick}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          masterResources={masterResources}\n          strings={strings}\n          useCanvasPCs={useCanvasPCs}\n        />\n        \n        {/* Layer 5: Dynamic Elements (tooltips, overlays, VFX) */}\n        <RenderDynamicElements\n          TILE_SIZE={activeTileSize}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          onNPCClick={handleNPCPanel}  // Pass the callback\n          onPCClick={handlePCClick}  // Pass the callback\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          masterTrophies={masterTrophies}\n          setHoverTooltip={setHoverTooltip}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen} \n          updateStatus={updateStatus}\n          strings={strings}\n          useCanvasResources={useCanvasResources}\n          useCanvasDynamicElements={useCanvasDynamicElements}\n          resources={memoizedResources}\n          npcs={npcs}\n          pcs={pcs}\n          grid={memoizedGrid}\n          tileTypes={memoizedTileTypes}\n          setHoverTooltip={setHoverTooltip}\n        /> \n        {/* <RenderVFX \n          toggleVFX={currentPlayer?.settings?.toggleVFX}\n          // Placeholder for VFX\n          TILE_SIZE={activeTileSize}\n        /> */}\n\n        </>\n      ) : null}\n\n{/* //////////////////  ZOOM OUTS  ///////////////////*/}\n\n    {/* Settlement zoom view */}\n    {zoomLevel === 'settlement' && (\n      <SettlementView\n        currentPlayer={currentPlayer}\n        isDeveloper={isDeveloper}\n        setZoomLevel={setZoomLevel}\n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        setCurrentPlayer={setCurrentPlayer}\n        setGridId={setGridId}\n        setGrid={setGrid}\n        setResources={setResources}\n        setTileTypes={setTileTypes}\n        TILE_SIZE={activeTileSize}\n        masterResources={masterResources}\n        closeAllPanels={closeAllPanels}\n        visibleSettlementId={visibleSettlementId}\n        setVisibleSettlementId={setVisibleSettlementId}\n        onClose={() => setZoomLevel('far')}\n      />\n    )}\n    {zoomLevel === 'frontier' && (\n      <FrontierView\n        currentPlayer={currentPlayer}\n        isDeveloper={isDeveloper}\n        setZoomLevel={setZoomLevel} \n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        setCurrentPlayer={setCurrentPlayer}\n        setGridId={setGridId}              \n        setGrid={setGrid}            \n        setResources={setResources}  \n        setTileTypes={setTileTypes}\n        masterResources={masterResources}\n        masterTrophies={masterTrophies}\n        TILE_SIZE={activeTileSize}\n        closeAllPanels={closeAllPanels}\n        visibleSettlementId={visibleSettlementId}\n        setVisibleSettlementId={setVisibleSettlementId}\n        onClose={() => setZoomLevel('settlement')}\n      />\n    )}\n    </div>\n\n{/* ///////////////////// MODALS ////////////////////// */}\n\n      {showShareModal && (\n        <ShareModal onClose={() => setShowShareModal(false)} />\n      )}\n      \n      {showFTUE && (\n        <FTUE \n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          onClose={() => setShowFTUE(false)}\n          openPanel={openPanel}\n          setActiveQuestGiver={setActiveQuestGiver}\n          gridId={gridId}\n          setActiveStation={setActiveStation}\n          masterResources={masterResources}\n          setResources={setResources}\n          TILE_SIZE={activeTileSize}\n        />\n      )}\n\n      <Modal \n        isOpen={isModalOpen} \n        onClose={() => {\n          if (modalContent?.onClose) {\n            modalContent.onClose();\n          } else {\n            setIsModalOpen(false);\n          }\n        }}\n        title={modalContent.title} \n        message={modalContent.message} \n        message2={modalContent.message2} \n        size={modalContent.size || \"standard\"}\n      >\n        {modalContent.children}\n        {modalContent.custom}\n      </Modal>\n\n      {activeModal === 'Mailbox' && (\n        <Mailbox\n          onClose={closeModal}  //  This sets activeModal = null\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activeModal === 'TownNews' && (\n        <TownNews\n          onClose={closeModal}  //  This sets activeModal = null\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n        />\n      )}\n      {activeModal === 'LanguagePicker' && (\n        <LanguagePickerModal\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          onClose={() => setActiveModal(null)}\n          onSave={() => setActiveModal(null)}\n        />\n      )}\n      {activeModal === \"Store\" && (\n        <Store\n          onClose={({ openMailbox } = {}) => {\n            setActiveModal(null);\n            if (openMailbox) {\n              setTimeout(() => setActiveModal(\"Mailbox\"), 100);\n            }\n          }}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n          setModalContent={setModalContent}\n \t        setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {isOffSeason && (\n        <OffSeasonModal\n          currentPlayer={currentPlayer}\n          timers={timers}\n        />\n      )}\n\n{/* ///////////////////// PANELS ////////////////////// */}\n\n      {activePanel === 'ProfilePanel' && (\n        <ProfilePanel\n        onClose={closePanel}\n        currentPlayer={currentPlayer}\n        setCurrentPlayer={setCurrentPlayer}\n        handleLogout={handleLogout}\n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        zoomLevel={zoomLevel}\n        setZoomLevel={setZoomLevel} \n       />\n      )}\n      {activePanel === 'LoginPanel' && (\n        <LoginPanel\n          onClose={closePanel}\n          setCurrentPlayer={(player) => {\n            setCurrentPlayer(player);\n            closePanel(); \n          }}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel} \n          onLoginSuccess={async (username, password) => {\n            await handleLoginSuccess(username, password);\n          }}\n        />\n      )}\n      {activePanel === 'DebugPanel' && (\n        <DebugPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setResources={setResources}\n          currentGridId={currentPlayer?.location?.g}\n          updateStatus={updateStatus}\n          TILE_SIZE={activeTileSize}\n          setGrid={setGrid}\n          setGridId={setGridId}\n          setTileTypes={setTileTypes}\n          closeAllPanels={closeAllPanels}\n          useCanvasTiles={useCanvasTiles}\n          setUseCanvasTiles={setUseCanvasTiles}\n        />\n      )}\n      {activePanel === 'InventoryPanel' && (\n        <InventoryPanel\n          onClose={closePanel} \n          masterResources={masterResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'WarehousePanel' && (\n        <WarehousePanel\n          onClose={() => openPanel('InventoryPanel')} \n          masterResources={masterResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          stationType={activeStation?.type} \n          globalTuning={globalTuning}\n          masterWarehouse={masterWarehouse}\n          updateStatus={updateStatus}\n        />\n      )}\n      {activePanel === 'TrophyPanel' && (\n        <TrophyPanel\n          onClose={closePanel} \n          masterResources={masterResources}\n          masterTrophies={masterTrophies}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n        />\n      )}\n      {activePanel === 'BankPanel' && (\n        <BankPanel\n          onClose={closePanel} \n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activePanel === 'KentPanel' && (\n        <KentPanel\n          onClose={closePanel} \n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          globalTuning={globalTuning}\n          currentSeason={timers.seasons?.type || \"Unknown\"}\n        />\n      )}\n      {activePanel === 'TrainPanel' && (\n        <TrainPanel\n          onClose={closePanel} \n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'NewTrainPanel' && (\n        <NewTrainPanel\n          onClose={closePanel} \n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          globalTuning={globalTuning}\n          currentSeason={timers.seasons?.type || \"Unknown\"}\n        />\n      )}\n      {activePanel === 'CarnivalPanel' && (\n        <CarnivalPanel\n          onClose={closePanel} \n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'HowToPanel' && (\n        <HowToPanel \n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'HowToMoneyPanel' && (\n        <HowToMoneyPanel \n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'HowToGemsPanel' && (\n        <HowToGemsPanel \n          currentPlayer={currentPlayer}\n          updateStatus={updateStatus}\n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'GoldBenefitsPanel' && (\n        <GoldBenefitsPanel \n          currentPlayer={currentPlayer}\n          updateStatus={updateStatus}\n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'GovPanel' && (\n        <GovPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'Courthouse' && (\n        <CourthousePanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n        />\n      )}\n      {activePanel === 'QuestPanel' && (\n        <QuestPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n        />\n      )}\n      {activePanel === 'SkillsPanel' && (\n        <SkillsPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack} \n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          isDeveloper={isDeveloper}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterSkills={masterSkills}\n          setResources={setResources}\n        />\n      )}\n      {activePanel === 'CombatPanel' && (\n        <CombatPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n        />\n      )}\n      {activePanel === 'CraftingStation' && (\n        <CraftingStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={resources}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          globalTuning={globalTuning}\n        />\n      )}\n      {activePanel === 'FarmHouse' && (\n        <FarmHouse\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          masterTrophies={masterTrophies}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'ShopStation' && (\n        <ShopStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterTrophies={masterTrophies}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'ScrollStation' && (\n        <ScrollStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterTrophies={masterTrophies}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'FarmingPanel' && (\n        <FarmingPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          tiles={grid}\n          tileTypes={tileTypes}\n          setTileTypes={setTileTypes}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          currentSeason={seasonData?.type}\n        />\n      )}\n      {activePanel === 'ToolsPanel' && (\n        <ToolsPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          tiles={grid}\n          tileTypes={tileTypes}\n          setTileTypes={setTileTypes}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'BuildPanel' && (\n        <BuildPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n        />\n      )}\n      {activePanel === 'BuyPanel' && (\n        <BuyPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          NPCsInGrid={NPCsInGrid}\n          globalTuning={globalTuning}\n        />\n      )}\n      {activePanel === 'PetsPanel' && (\n        <PetsPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n        />\n      )}\n      {activePanel === 'BuyDecoPanel' && (\n        <BuyDecoPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n        />\n      )}\n      {activePanel === 'NPCPanel' && (\n        <NPCPanel\n          onClose={closePanel}\n          npcData={activeQuestGiver}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterInteractions={masterInteractions}\n          masterTraders={masterTraders}\n          masterTrophies={masterTrophies}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel}\n          centerCameraOnPlayer={centerCameraOnPlayer}\n        />\n      )}\n      {activePanel === 'FarmHandPanel' && (\n        <FarmHandPanel\n          onClose={closePanel}\n          npc={activeQuestGiver}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={resources}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          currentSeason={seasonData?.type}\n        />\n      )}\n      {activePanel === 'SocialPanel' && (\n        <SocialPanel\n          onClose={closePanel}\n          pcData={activeSocialPC}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          inventory={inventory}\n          setInventory={setInventory}  \n          backpack={backpack}\n          setBackpack={setBackpack} \n          updateStatus={updateStatus}\n          masterInteractions={masterInteractions}\n          masterTrophies={masterTrophies}\n          isDeveloper={isDeveloper}\n          controllerUsername={controllerUsername}\n          setControllerUsername={setControllerUsername}\n        />\n      )}\n      {activePanel === 'AnimalStall' && (\n        <AnimalStall\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'AnimalPanel' && (\n        <AnimalPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          npcId={activeStation?.npcId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activePanel === 'CropPanel' && (\n        <CropPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          currentResource={activeStation?.resource}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activePanel === 'DecoPanel' && (\n        <DecoPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'PetPanel' && (\n        <PetPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          petResource={resources.find(r => r.x === activeStation?.position?.x && r.y === activeStation?.position?.y)}\n          currentPetPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          masterTrophies={masterTrophies}\n          TILE_SIZE={activeTileSize}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'TradeStall' && (\n        <TradeStall\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          globalTuning={globalTuning}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'OutpostPanel' && (\n        <Outpost\n          onClose={closePanel}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={activeStation?.gridId}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          isDeveloper={isDeveloper}\n          stationType={activeStation?.type}\n          currentStationPosition={activeStation?.position}\n          setResources={setResources}\n          setInventory={setInventory}\n          TILE_SIZE={activeTileSize}\n          globalTuning={globalTuning}\n        />\n      )}\n      {activePanel === 'SeasonPanel' && (\n        <SeasonPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n\n      {hoverTooltip && (\n        <div\n          className=\"HoverTooltip\"\n          style={{\n            position: 'fixed',\n            zIndex: 9999,\n            top: hoverTooltip.y,\n            left: hoverTooltip.x,\n            transform: 'translate(-50%, -100%) translateY(-8px)', //  Center horizontally and offset upward\n            pointerEvents: 'none',\n          }}\n          dangerouslySetInnerHTML={{ __html: hoverTooltip.content }}\n        />\n      )}\n      </div>\n\n      {uiLocked && (\n        <div\n          style={{\n            position: 'fixed',\n            inset: 0,\n            zIndex: 9999,\n            backgroundColor: 'rgba(0,0,0,0.0)', // transparent blocker\n            cursor: 'wait',\n          }}\n        />\n      )}\n\n    </>\n  );\n}\n\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport { StringsProvider } from './UI/StringsContext';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { StatusBarProvider } from './UI/StatusBar/StatusBar';\nimport { PanelProvider } from './UI/PanelContext'; \nimport { GridStateProvider } from './GridState/GridStateContext';\nimport { GridStatePCProvider } from './GridState/GridStatePCContext';\nimport { ModalProvider } from './UI/ModalContext';\nimport { UILockProvider } from './UI/UILockContext';\nimport { NPCOverlayProvider } from './UI/NPCOverlayContext';\nimport { BulkOperationProvider } from './UI/BulkOperationContext';\n\nconsole.warn(\" index.js evaluated again  app may remount\");\n\n// Prevent HMR from creating multiple instances\nif (window.__app_initialized__) {\n  console.log(\" App already initialized, preventing HMR remount\");\n  // Don't execute the rest of the file\n} else {\n  window.__app_initialized__ = true;\n\n// Cache the language to prevent provider recreation when player data changes\nlet cachedLanguage = 'en';\ntry {\n  const savedPlayer = localStorage.getItem('player');\n  if (savedPlayer) {\n    const parsedPlayer = JSON.parse(savedPlayer);\n    if (parsedPlayer?.language) {\n      cachedLanguage = parsedPlayer.language;\n    }\n  }\n} catch (e) {\n  console.warn('Failed to parse player data for language:', e);\n}\nconst savedLanguage = cachedLanguage;\nconst rootEl = document.getElementById('root');\nconsole.log(\" root element:\", rootEl);\n\nif (!window.__root_created__) {\n  console.warn(\" Creating React root\");\n  window.__root_created__ = true;\n  window.__root = ReactDOM.createRoot(rootEl);\n} else {\n  console.error(\" React root was already created!\");\n}\n\nif (!window.__app_rendered__) {\n  console.warn(\" Rendering App...\");\n  window.__app_rendered__ = true;\n  window.__root.render(\n    <UILockProvider>\n      <NPCOverlayProvider>\n        <BulkOperationProvider>\n          <StringsProvider language={savedLanguage}>\n            <GridStateProvider>\n              <GridStatePCProvider>\n                <StatusBarProvider>\n                  <PanelProvider>\n                    <ModalProvider>\n                      <App />\n                    </ModalProvider>\n                  </PanelProvider>\n                </StatusBarProvider>\n              </GridStatePCProvider>\n            </GridStateProvider>\n          </StringsProvider>\n        </BulkOperationProvider>\n      </NPCOverlayProvider>\n    </UILockProvider>\n  );\n} else {\n  console.error(\" App already rendered  something is wrong\");\n}\n\n} // Close the main HMR prevention block\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"names":["async","handleProtectedFarmAnimalCollection","npc","row","col","setInventory","setBackpack","setResources","currentPlayer","setCurrentPlayer","TILE_SIZE","masterResources","masterSkills","currentGridId","updateStatus","strings","arguments","length","undefined","globalTuning","inventory","backpack","console","log","id","transactionId","Date","now","Math","random","toString","substr","transactionKey","_NPCsInGridManager$ge","state","grazeEnd","currentNPCState","NPCsInGridManager","warn","type","message","timeSinceGrazeEnd","floor","toISOString","response","axios","post","API_BASE","playerId","gridId","npcId","npcPosition","x","y","data","success","collectedQuantity","collectedItem","skillsApplied","updatedNPC","gained","gainIngredients","resource","quantity","error","FloatingTextManager","addFloatingText","npcsInGrid","animalsAtSamePosition","Object","values","filter","otherNpc","_otherNpc$position","_otherNpc$position2","position","action","map","a","targetStall","otherAnimal","getLocalizedString","skillInfo","calculateSkillMultiplier","skills","formatSingleCollection","hasSkills","trackQuestProgress","_error$response","_error$response2","status","_error$response3","_error$response3$data","_error$response4","errorMessage","errorDetails","includes","currentUsage","capacity","serverStateMatch","match","serverState","otherProcessingAnimal","find","_otherNpc$position3","_otherNpc$position4","loadNPCDefinitions","resources","npcDefinitions","forEach","category","extractXY","location","handleNPCClick","setModalContent","setIsModalOpen","openPanel","setActiveStation","masterTrophies","allAnimalsAtPosition","_otherNpc$position5","_otherNpc$position6","processingAnimalAtSamePosition","handleAttackOnNPC","handleFarmAnimalBehavior","updateThisNPC","this","tiles","GlobalGridStateTilesAndResources","getTiles","getResources","npcs","handleIdleState","currentTime","targetGrassTile","targetTileType","grassTiles","findTileInRange","Array","isArray","tileTypeName","unoccupiedGrassTiles","tile","some","res","_npc$position","_npc$position2","sort","b","calculateDistance","dx","dy","direction","_npc$position3","_npc$position4","isMoving","moved","moveOneTile","_npc$position5","_npc$position6","growTime","fullGridState","stallRetries","failedStalls","findNearestResource","push","triedStall","atStall","nearStall","abs","otherNPCsAtStall","Promise","resolve","setTimeout","handleRoamState","lastProcessingLog","handleQuestGiverBehavior","playersInGridManager","getPlayersInGrid","pc","range","hp","canSeeTarget","targetPosition","lineOfSightTiles","start","end","x0","y0","x1","y1","sx","sy","err","e2","getLineOfSightTiles","handleEnemyBehavior","pcs","call","visiblePCsInRange","getDistance","targetPC","username","pursueTimerStart","_this$targetPC3","_this$targetPC","_this$targetPC2","currentDistance","attackrange","timeSincePursueStart","distance","closestVisiblePC","closestPC","minDistance","Infinity","findClosestVisiblePC","canSeeTargetNow","_this$targetPC5","_this$targetPC4","handlePursueWithLineOfSight","distanceToPlayer","stuckCounter","_this$targetPC6","_this$targetPC7","iscamping","attackbonus","armorclass","damage","amountToMod","newHP","max","updatePC","lastUpdated","speed","pos1","pos2","sqrt","handleHealBehavior","handleSpawnBehavior","npcsObject","playersInGrid","oldPosition","nextspawn","requires","qtycollected","spawnNPC","handleWorkerBehavior","handleTraderBehavior","NPC","constructor","properties","_properties$nextspawn","Error","updateInterval","symbol","output","maxhp","growtime","processingStartTime","assign","update","NPCsInGrid","processState","idleDuration","onTransition","idleTimer","validDirections","dir","getAdjacentTile","isValidTile","randomDirection","roamSteps","currentDirection","directions","N","S","E","W","NE","SE","SW","NW","handlePursueState","playerPosition","onAttackTransition","newDistanceToPlayer","delta","targetX","targetY","socket","connected","emit","newPosition","emitterId","resourceInTile","passable","npcInTile","tileType","startX","startY","potentialTiles","_tiles$y","targetResource","excludePositions","availableResources","pos","aPos","bPos","findAllResources","prototype","attachGrazingBehavior","attachQuestBehavior","attachEnemyBehavior","attachHealBehavior","attachSpawnBehavior","attachFarmerBehavior","attachTraderBehavior","STRINGS_MAP","en","stringsEN","fr","stringsFR","es","stringsES","de","stringsDE","it","stringsIT","pt","stringsPT","ru","stringsRU","no","stringsNO","sv","stringsSV","fi","stringsFI","StringsContext","createContext","StringsProvider","_ref","language","children","selectedStrings","toLowerCase","rawLanguage","normalized","resolvedFile","_jsx","Provider","value","useStrings","useContext","module","exports","renderPositions","pressedKeys","Set","MODIFIER_KEYS","handleKeyDown","event","setGridId","setGrid","setTileTypes","closeAllPanels","localPlayerMoveTimestampRef","bulkOperationContext","key","add","ArrowUp","w","ArrowDown","s","ArrowLeft","A","ArrowRight","d","D","totalDx","totalDy","movement","min","_id","g","currentPosition","round","handleTransitSignpost","canMove","isinboat","tileResource","isTileValidForPlayer","isValidMove","finalPosition","current","centerCameraOnPlayer","processMovement","handleKeyUp","delete","clear","gameContainer","document","querySelector","centerX","window","innerWidth","centerY","innerHeight","maxScrollLeft","scrollWidth","clientWidth","maxScrollTop","scrollHeight","clientHeight","clampedX","clampedY","scrollTo","left","top","behavior","centerCameraOnPlayerFast","addEventListener","hidden","debugMovementKeys","from","resetMovementKeys","masterInteractions","masterTraders","masterWarehouse","loadMasterSkills","get","loadMasterResources","loadGlobalTuning","loadMasterInteractions","loadMasterTraders","loadMasterTrophies","loadMasterWarehouse","f","require","k","Symbol","for","l","m","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","ref","__self","__source","q","c","e","h","defaultProps","$$typeof","props","_owner","Fragment","jsx","jsxs","r","t","u","v","z","iterator","B","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","C","context","refs","updater","F","G","isReactComponent","setState","forceUpdate","H","isPureReactComponent","I","J","K","L","M","O","P","Q","replace","escape","R","next","done","String","keys","join","T","_status","_result","then","default","U","V","transition","ReactCurrentDispatcher","ReactCurrentBatchConfig","X","Children","apply","count","toArray","only","Component","Profiler","PureComponent","StrictMode","Suspense","act","cloneElement","_currentValue","_currentValue2","_threadCount","Consumer","_defaultValue","_globalName","_context","createElement","createFactory","bind","createRef","forwardRef","render","isValidElement","lazy","_payload","_init","memo","compare","startTransition","unstable_act","useCallback","useDebugValue","useDeferredValue","useEffect","useId","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useSyncExternalStore","useTransition","version","formatCollectionResults","operation","results","skillsInfo","replantInfo","parts","label","itemParts","entries","localizedName","skillsStr","multiplier","replantParts","_ref2","itemType","formatRestartResults","restartInfo","_ref3","fn","thisArg","getPrototypeOf","kindOf","cache","create","thing","str","slice","kindOfTest","typeOfTest","isUndefined","isArrayBuffer","isString","isFunction","isNumber","isObject","isPlainObject","val","toStringTag","isDate","isFile","isBlob","isFileList","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","obj","i","allOwnKeys","getOwnPropertyNames","len","findKey","_key","_global","globalThis","self","global","isContextDefined","isTypedArray","TypedArray","Uint8Array","isHTMLForm","prop","isRegExp","reduceDescriptors","reducer","descriptors","getOwnPropertyDescriptors","reducedDescriptors","descriptor","name","ret","defineProperties","isAsyncFn","_setImmediate","setImmediateSupported","postMessageSupported","setImmediate","token","callbacks","source","shift","cb","postMessage","asap","queueMicrotask","process","nextTick","isBuffer","isFormData","kind","FormData","append","isArrayBufferView","result","ArrayBuffer","isView","buffer","isBoolean","isStream","pipe","merge","caseless","assignValue","targetKey","extend","trim","stripBOM","content","charCodeAt","inherits","superConstructor","defineProperty","toFlatObject","sourceObj","destObj","propFilter","merged","endsWith","searchString","lastIndex","indexOf","arr","forEachEntry","pair","matchAll","regExp","matches","exec","hasOwnProp","freezeMethods","enumerable","writable","set","toObjectSet","arrayOrString","delimiter","define","split","toCamelCase","p1","p2","toUpperCase","noop","toFiniteNumber","defaultValue","Number","isFinite","isSpecCompliantForm","toJSONObject","stack","visit","target","reducedValue","isThenable","catch","AxiosError","code","config","request","captureStackTrace","utils","toJSON","description","number","fileName","lineNumber","columnNumber","customProps","axiosError","cause","isVisitable","removeBrackets","renderKey","path","dots","concat","predicates","test","formData","options","TypeError","metaTokens","indexes","option","visitor","defaultVisitor","useBlob","Blob","convertValue","Buffer","JSON","stringify","isFlatArray","el","index","exposedHelpers","build","pop","encode","charMap","encodeURIComponent","AxiosURLSearchParams","params","_pairs","toFormData","encoder","_encode","buildURL","url","serialize","serializeFn","serializedParams","hashmarkIndex","handlers","use","fulfilled","rejected","synchronous","runWhen","eject","silentJSONParsing","forcedJSONParsing","clarifyTimeoutError","isBrowser","classes","URLSearchParams","protocols","hasBrowserEnv","_navigator","navigator","hasStandardBrowserEnv","product","hasStandardBrowserWebWorkerEnv","WorkerGlobalScope","importScripts","origin","href","platform","buildPath","isNumericKey","isLast","arrayToObject","parsePropPath","defaults","transitional","transitionalDefaults","adapter","transformRequest","headers","contentType","getContentType","hasJSONContentType","isObjectPayload","formDataToJSON","setContentType","helpers","isNode","toURLEncodedForm","formSerializer","_FormData","env","rawValue","parser","parse","stringifySafely","transformResponse","JSONRequested","responseType","strictJSONParsing","ERR_BAD_RESPONSE","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","maxBodyLength","validateStatus","common","method","ignoreDuplicateOf","$internals","normalizeHeader","header","normalizeValue","matchHeaderValue","isHeaderNameFilter","AxiosHeaders","valueOrRewrite","rewrite","setHeader","_value","_header","_rewrite","lHeader","setHeaders","rawHeaders","parsed","line","substring","parseHeaders","tokens","tokensRE","parseTokens","has","matcher","deleted","deleteHeader","normalize","format","char","formatHeader","_len","targets","asStrings","first","computed","_len2","_key2","accessor","accessors","defineAccessor","accessorName","methodName","arg1","arg2","arg3","configurable","buildAccessors","mapped","headerValue","transformData","fns","isCancel","__CANCEL__","CanceledError","ERR_CANCELED","settle","reject","ERR_BAD_REQUEST","samplesCount","bytes","timestamps","firstSampleTS","head","tail","chunkLength","startedAt","bytesCount","passed","freq","lastArgs","timer","timestamp","threshold","invoke","args","clearTimeout","flush","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","speedometer","throttle","loaded","total","lengthComputable","progressBytes","rate","progress","estimated","progressEventDecorator","throttled","asyncDecorator","isMSIE","URL","protocol","host","port","userAgent","write","expires","domain","secure","cookie","toGMTString","read","RegExp","decodeURIComponent","remove","buildFullPath","baseURL","requestedURL","allowAbsoluteUrls","isRelativeUrl","relativeURL","combineURLs","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","paramsSerializer","timeoutMessage","withCredentials","withXSRFToken","onUploadProgress","onDownloadProgress","decompress","beforeRedirect","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding","configValue","newConfig","auth","btoa","password","unescape","Boolean","isURLSameOrigin","xsrfValue","cookies","XMLHttpRequest","_config","resolveConfig","requestData","requestHeaders","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","unsubscribe","signal","removeEventListener","onloadend","responseHeaders","getAllResponseHeaders","responseText","statusText","open","onreadystatechange","readyState","responseURL","onabort","ECONNABORTED","onerror","ERR_NETWORK","ontimeout","timeoutErrorMessage","ETIMEDOUT","setRequestHeader","upload","cancel","abort","subscribe","aborted","parseProtocol","send","composeSignals","signals","controller","AbortController","reason","streamChunk","chunk","chunkSize","byteLength","readStream","stream","asyncIterator","reader","getReader","trackStream","onProgress","onFinish","iterable","readBytes","_onFinish","ReadableStream","pull","close","loadedBytes","enqueue","return","highWaterMark","isFetchSupported","fetch","Request","Response","isReadableStreamSupported","encodeText","TextEncoder","arrayBuffer","supportsRequestStream","duplexAccessed","hasContentType","body","duplex","supportsResponseStream","resolvers","_","ERR_NOT_SUPPORT","resolveBodyLength","getContentLength","size","_request","getBodyLength","knownAdapters","http","xhr","xhrAdapter","fetchOptions","composedSignal","toAbortSignal","requestContentLength","contentTypeHeader","isCredentialsSupported","credentials","isStreamResponse","responseContentLength","responseData","renderReason","isResolvedHandle","adapters","nameOrAdapter","rejectedReasons","reasons","throwIfCancellationRequested","throwIfRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","formatMessage","opt","desc","opts","ERR_DEPRECATED","spelling","correctSpelling","assertOptions","schema","allowUnknown","ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","Axios","instanceConfig","interceptors","InterceptorManager","configOrUrl","dummy","boolean","function","baseUrl","withXsrfToken","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","unshift","responseInterceptorChain","promise","chain","onFulfilled","onRejected","getUri","generateHTTPMethod","isForm","CancelToken","executor","resolvePromise","_listeners","onfulfilled","_resolve","splice","HttpStatusCode","Continue","SwitchingProtocols","Processing","EarlyHints","Ok","Created","Accepted","NonAuthoritativeInformation","NoContent","ResetContent","PartialContent","MultiStatus","AlreadyReported","ImUsed","MultipleChoices","MovedPermanently","Found","SeeOther","NotModified","UseProxy","Unused","TemporaryRedirect","PermanentRedirect","BadRequest","Unauthorized","PaymentRequired","Forbidden","NotFound","MethodNotAllowed","NotAcceptable","ProxyAuthenticationRequired","RequestTimeout","Conflict","Gone","LengthRequired","PreconditionFailed","PayloadTooLarge","UriTooLong","UnsupportedMediaType","RangeNotSatisfiable","ExpectationFailed","ImATeapot","MisdirectedRequest","UnprocessableEntity","Locked","FailedDependency","TooEarly","UpgradeRequired","PreconditionRequired","TooManyRequests","RequestHeaderFieldsTooLarge","UnavailableForLegalReasons","InternalServerError","NotImplemented","BadGateway","ServiceUnavailable","GatewayTimeout","HttpVersionNotSupported","VariantAlsoNegotiates","InsufficientStorage","LoopDetected","NotExtended","NetworkAuthenticationRequired","createInstance","defaultConfig","instance","Cancel","all","promises","spread","callback","isAxiosError","payload","formToJSON","getAdapter","sortIndex","performance","unstable_now","startTime","expirationTime","priorityLevel","scheduling","isInputPending","MessageChannel","port2","port1","onmessage","unstable_IdlePriority","unstable_ImmediatePriority","unstable_LowPriority","unstable_NormalPriority","unstable_Profiling","unstable_UserBlockingPriority","unstable_cancelCallback","unstable_continueExecution","unstable_forceFrameRate","unstable_getCurrentPriorityLevel","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_requestPaint","unstable_runWithPriority","unstable_scheduleCallback","delay","unstable_shouldYield","unstable_wrapCallback","VFX_TIMING","recentEffects","Map","calculateTileCenter","createCollectEffect","effectKey","lastEffectTime","querySelectorAll","tileElement","tileTop","parseInt","style","tileLeft","rect","getBoundingClientRect","containerRect","width","height","calcX","calcY","particle","createParticleElement","innerText","pointerEvents","zIndex","fontSize","appendChild","requestAnimationFrame","transform","opacity","removeChild","createSourceConversionEffect","requiredSkill","emoji","player","item","_player$activeQuests","activeQuests","questUpdated","updatedQuests","quest","completed","rewardCollected","goalsCompleted","totalGoals","goalAction","goalItem","goalQty","prev","isWallBlocking","checkRange","playerPos","targetPos","playerRange","isAHit","attackRoll","hitRoll","calculateDamage","randomDamageModifier","_playersInGridManager","freshNPC","resourceDetails","enrichedResource","updatedResources","prevResources","updateGridResource","_currentPlayer$active","earnTrophy","questId","goal1","handleAttackOnPC","_playersInGridManager2","_playersInGridManager3","trophyName","progressIncrement","trophyDef","_currentPlayer$trophi","trophies","trophy","isNewMilestone","prevPlayer","updatedTrophies","existingTrophyIndex","findIndex","qty","collected","shouldShowNotification","visible","showNotification","nextMilestone","createRoot","hydrateRoot","pendingUpdates","batchInterval","BATCH_SAVE_INTERVAL","registerSetPlayersInGrid","setter","setPlayersInGridReact","registerTileSize","tileSize","startBatchSaving","setInterval","processPendingUpdates","stopBatchSaving","clearInterval","updates","updatesByGrid","gridUpdates","errors","updated","forceSavePendingUpdates","flushGridPositionUpdates","_ref4","initializePlayersInGrid","playersInGridLastUpdated","getTime","pcData","unloadListenerAdded","getAllPCs","_this$playersInGrid","_this$playersInGrid$g","getPlayerPosition","_this$playersInGrid2","_this$playersInGrid2$","_this$playersInGrid2$2","_this$playersInGrid2$3","setAllPCs","pcsObject","addPlayer","_pcData$settings","_pcData$settings2","modifiers","equippedWeapon","settings","equippedArmor","isWeapon","isArmor","powers","power","powerQty","isMagicEnhancement","attr","getStat","baseKey","modKey","baseHp","baseMaxhp","newPC","icon","addPC","_prev$gridId","_prev$gridId2","updatedGrid","newProperties","_this$playersInGrid$g2","_gridPCs$playerId","gridPCs","currentData","every","updatedPC","animateRemotePC","_prev$gridId3","updateKey","removePC","_this$playersInGrid$g3","_this$playersInGrid$g4","_prev$gridId4","reverseLookupMap","getStringIdByValue","createReverseLookupMap","reverseMap","stringId","REACT_APP_SERVER_URL","to","stepCount","step","currentX","currentY","animate","interpolatedX","interpolatedY","onClose","descriptionKey","panelName","titleKey","title","activePanel","closePanel","usePanelContext","_jsxs","className","onClick","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x2","y2","locationChangeManager","isLocationChangeInProgress","pendingLocationChange","lastCompletedChange","isInProgress","requestLocationChange","changeRequest","completeLocationChange","completedChange","completedAt","pending","retryCallback","failLocationChange","getStatus","inProgress","hasPending","lastCompleted","pendingChange","clearPending","reset","debugLocationChanges","resetLocationChangeManager","broadcast","growEnd","craftEnd","craftedItem","patch","convertTileType","newType","prevTiles","mergeTiles","updatedTiles","changePlayerLocation","fromLocation","toLocation","_bulkOperationContext","_currentPlayer$_id","isAnyBulkOperationActive","_fromGridResponse$dat","_fromGridResponse$dat2","_toGridResponse$data","_toGridResponse$data$","_fromPlayerState$hp","_fromPlayerState$maxh","_fromPlayerState$armo","_fromPlayerState$atta","_ref5","_fromPlayerState$dama","_ref6","_fromPlayerState$spee","_ref7","_fromPlayerState$atta2","_ref8","_fromPlayerState$isca","_ref9","_fromPlayerState$isin","inMemoryFromPlayerState","fromPCs","fromPlayerState","finalHp","finalMaxHp","playerData","locationResponse","gtype","startsWith","trophyResult","updatedPlayer","localStorage","setItem","cleanupError","initializeGrid","freshGridState","freshPCState","setGridStateReact","NPCsInGridLastUpdated","finalX","finalY","findSignpost","signpost","updatedPlayerData","updateGridStatus","fetchGridData","DBPlayerData","gridData","gridType","fetchedGridId","ownerId","combinedGridState","ownerUsername","fetchHomesteadOwner","fetchHomesteadSignpostPosition","signpostTown","fetchTownSignpostPosition","train","gridResponse","playerResponse","pow","getDerivedRange","_currentPlayer$skills","_currentPlayer$locati","baseRange","bonusRangeFromSkills","reduce","sum","skill","master","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","encodePacket","supportsBinary","encodeBlobAsBase64","fileReader","FileReader","onload","readAsDataURL","byteOffset","TEXT_ENCODER","chars","lookup","decodePacket","encodedPacket","binaryType","mapBinary","charAt","decodeBase64Packet","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","arraybuffer","decode","SEPARATOR","fromCharCode","createPacketEncoderStream","TransformStream","packet","encoded","encodePacketToBinary","payloadLength","DataView","setUint8","view","setUint16","setBigUint64","BigInt","TEXT_DECODER","totalLength","chunks","acc","concatChunks","j","Emitter","mixin","on","_callbacks","once","off","removeListener","removeAllListeners","emitReserved","listeners","hasListeners","setTimeoutFn","globalThisShim","Function","pick","NATIVE_SET_TIMEOUT","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","useNativeTimers","clearTimeoutFn","randomString","TransportError","super","Transport","query","forceBase64","onError","doOpen","doClose","packets","onOpen","onData","onPacket","details","pause","onPause","createUri","_hostname","_port","_query","hostname","encodedQuery","Polling","_polling","_poll","doPoll","decodePayload","encodedPayload","encodedPackets","decodedPacket","encodePayload","doWrite","uri","timestampRequests","timestampParam","sid","b64","hasCORS","empty","BaseXHR","isSSL","xd","req","xhrStatus","pollXhr","createRequest","_opts","_method","_uri","_data","_create","_a","xdomain","_xhr","extraHeaders","setDisableHeaderCheck","cookieJar","addCookies","requestTimeout","parseCookies","getResponseHeader","_onLoad","_onError","_index","requestsCount","requests","_cleanup","fromError","attachEvent","unloadHandler","hasXHR2","newRequest","isReactNative","BaseWS","ws","createSocket","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","ev","lastPacket","WebSocketCtor","WebSocket","MozWebSocket","transports","websocket","_packet","webtransport","_transport","WebTransport","transportOptions","closed","ready","createBidirectionalStream","decoderStream","maxPayload","TextDecoder","expectedLength","isBinary","headerArray","getUint16","getUint32","createPacketDecoderStream","MAX_SAFE_INTEGER","readable","pipeThrough","encoderStream","pipeTo","_writer","getWriter","polling","re","src","authority","ipv6uri","pathNames","regx","names","queryKey","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","parsedUri","_transportsByName","transportName","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","closeOnBeforeunload","qs","qry","pairs","_beforeunloadEventListener","_offlineEventListener","_onClose","_cookieJar","createCookieJar","_open","createTransport","EIO","priorWebsocketSuccess","setTransport","_onDrain","_onPacket","onHandshake","_sendPacket","_resetPingTimeout","pingInterval","pingTimeout","_pingTimeoutTimer","upgrading","_getWritablePackets","payloadSize","utf8Length","ceil","_hasPingExpired","hasExpired","msg","compress","cleanupAndClose","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","cleanup","freezeTransport","onTransportClose","onupgrade","_filterUpgrades","upgrades","filteredUpgrades","Socket","o","DEFAULT_TRANSPORTS","withNativeFile","File","hasBinary","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","placeholder","_placeholder","num","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","EVENT","ACK","encodeAsString","encodeAsBinary","BINARY_EVENT","BINARY_ACK","nsp","deconstruction","Decoder","reviver","reconstructor","decodeString","isBinaryEvent","BinaryReconstructor","takeBinaryData","buf","tryParse","isPayloadValid","CONNECT","DISCONNECT","CONNECT_ERROR","destroy","finishedReconstruction","reconPack","binData","freeze","connect","connect_error","disconnect","disconnecting","newListener","io","recovered","receiveBuffer","sendBuffer","_queue","_queueSeq","ids","acks","flags","_autoConnect","disconnected","subEvents","subs","onpacket","active","_readyState","_b","_c","retries","fromQueue","volatile","_addToQueue","ack","_registerAckCallback","isTransportWritable","engine","isConnected","notifyOutgoingListeners","_this","ackTimeout","_len3","_key3","withError","emitWithAck","_len4","_key4","_this2","tryCount","_len5","responseArgs","_key5","_drainQueue","force","_sendConnectPacket","_pid","pid","offset","_lastOffset","_clearAcks","onconnect","onevent","onack","ondisconnect","emitEvent","_anyListeners","sent","_len6","_key6","emitBuffered","subDestroy","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","Backoff","ms","factor","jitter","attempts","duration","rand","deviation","setMin","setMax","setJitter","Manager","nsps","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_parser","decoder","autoConnect","_reconnection","skipReconnect","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","Engine","openSubDestroy","errorSub","onping","ondata","ondecoded","_destroy","_close","onreconnect","attempt","loc","sameNamespace","forceNew","multiplex","socketListenForPCJoinAndLeave","isMasterResourcesReady","setPlayersInGrid","controllerUsername","setControllerUsername","handlePlayerJoinedGrid","joinedGridId","prevState","_prevState$joinedGrid","_prevState$joinedGrid2","existing","incomingTime","localTime","_prevState$joinedGrid3","handlePlayerLeftGrid","leftGridId","_prevState$leftGridId","_prevState$leftGridId2","handleCurrentGridPlayers","receivedGridId","targetGridId","socketListenForPCstateChanges","handlePCSync","gridEntries","incomingPC","currentPlayerId","_prevState$gridId","_prevState$gridId$pcs","_prevState$gridId2","_prevState$gridId2$pc","_prevState$gridId3","localPC","changedFields","damageTaken","updatedState","prevPosition","socketListenForNPCStateChanges","setGridState","npcController","handleNPCSync","isController","isControllingGrid","_NPCsInGridManager$NP","updatedNPCs","liveGrid","incomingNPC","localNPC","rehydrated","handleNPCMoveSync","handleNPCRemoval","_NPCsInGridManager$NP2","socketListenForResourceChanges","enrichResourceFromMaster","handleResourceSync","_ref10","newRes","indexToRemove","enriched","filtered","finalResources","anchorKey","shadowResource","parentAnchorKey","socketListenForTileChanges","handleTileSync","_ref11","socketListenForNPCControllerStatus","_ref12","_ref13","controlledGridId","_ref14","revokedGridId","socketListenForSeasonReset","_ref15","reload","socketListenForConnectAndDisconnect","setIsSocketConnected","handleConnect","handleDisconnect","socketListenForPlayerConnectedAndDisconnected","setConnectedPlayers","handlePlayerConnected","_ref16","handlePlayerDisconnected","_ref17","newSet","handleCurrentConnectedPlayers","_ref18","connectedPlayerIds","socketListenForChatMessages","setMessagesByScope","handleIncomingChatMessage","scope","scopeId","prevMessages","hasUpdate","emitChatMessage","_ref19","socketListenForBadgeUpdates","setBadgeState","updateBadge","handleBadge","_ref20","isMatch","gridTimer","externalSetGridState","pendingPositionUpdates","batchSaveInterval","BATCH_SAVE_DELAY","startBatchSaveTimer","flushPendingPositionUpdates","stopBatchSaveTimer","queuePositionUpdate","npcUpdates","updateNPCPosition","_NPCsInGrid$npcs","registerSetGridState","setterFunction","initializeGridState","hydratedState","lightweightNPC","npcTemplate","hydrated","getNPCsInGrid","npcType","_npcType","addNPC","updatedGridState","setAllNPCs","updateNPC","_NPCsInGrid$npcs2","_NPCsInGrid$npcs3","npcData","removeNPC","saveGridStateNPCs","dehydratedNPCs","startGridTimer","stopGridTimer","stopGridStateUpdates","existingState","isCurrency","resourceType","playerSkills","applicableSkills","_masterSkills$skill$t","buffValue","applySkillMultiplier","baseQuantity","deriveWarehouseAndBackpackCapacity","baseWarehouse","warehouseCapacity","baseBackpack","backpackCapacity","isGold","accountStatus","warehouseBonus","warehouseCapacityGold","backpackBonus","backpackCapacityGold","skillDetails","bonus","warehouse","canAfford","recipe","amount","inv","bp","ingredientType","ingredientQty","backpackItem","inventoryItem","hasRoomFor","isCurrencyItem","isHomestead","maxBackpack","fetchInventoryAndBackpack","_response$data","_response$data2","_response$data3","_response$data4","fetchInventory","_response$data5","refreshPlayerAfterInventoryUpdate","preserveInventory","_merged$location","gridPlayer","_updatedPlayerData$lo","_currentPlayer$locati2","storingInBackpack","_currentPlayer$skills2","isCapacityError","isMissingBackpack","isNetworkError","deltaPayload","_err$response","_err$response2","_err$response3","_err$response4","_err$response4$data","_err$response4$data$e","_err$response5","_err$response5$data","_err$response5$data$e","_err$response6","spendIngredients","updatedInventory","updatedBackpack","deltaChanges","remaining","used","TRANSIT_POSITIONS","_playerData$position$","_playerData$position","_playerData$position$2","_playerData$position2","settlementId","frontierId","hasHorse","gridCoord","signpostPosition","newPlayerPosition","settlement","grids","townGrid","flat","grid","firsttimeuser","newFtueStep","incrementFTUEStep","ftuestep","offsets","currentGrid","frontierTier","frontierIndex","setRow","setCol","gRow","gCol","coord","padStart","decodeCoord","rowOffset","colOffset","newGRow","newGCol","newSetRow","newSetCol","targetSettlement","targetGrid","entryPosition","fromX","fromY","getEntryPosition","aa","ca","da","ea","fa","ha","ia","ja","ka","la","ma","acceptsBooleans","attributeName","attributeNamespace","mustUseProperty","propertyName","sanitizeURL","removeEmptyString","ra","sa","ta","pa","isNaN","qa","oa","removeAttribute","setAttribute","setAttributeNS","xlinkHref","ua","va","wa","ya","za","Aa","Ba","Ca","Da","Ea","Fa","Ga","Ha","Ia","Ja","Ka","La","Ma","Na","Oa","prepareStackTrace","Reflect","construct","displayName","Pa","tag","Qa","Ra","Sa","Ta","nodeName","Va","_valueTracker","getOwnPropertyDescriptor","getValue","setValue","stopTracking","Ua","Wa","checked","Xa","activeElement","Ya","defaultChecked","_wrapperState","initialChecked","Za","initialValue","controlled","ab","bb","db","ownerDocument","eb","fb","selected","defaultSelected","disabled","gb","dangerouslySetInnerHTML","hb","ib","jb","textContent","kb","lb","mb","nb","namespaceURI","innerHTML","valueOf","firstChild","MSApp","execUnsafeLocalFunction","ob","lastChild","nodeType","nodeValue","pb","animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","order","orphans","tabSize","widows","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","qb","rb","sb","setProperty","tb","menuitem","area","base","br","embed","hr","img","input","keygen","link","meta","param","track","wbr","ub","vb","is","wb","xb","srcElement","correspondingUseElement","parentNode","yb","zb","Ab","Bb","Cb","stateNode","Db","Eb","Fb","Gb","Hb","Ib","Jb","Kb","Lb","Mb","Nb","Ob","Pb","Qb","Rb","Sb","Tb","Vb","alternate","Wb","memoizedState","dehydrated","Xb","Zb","child","sibling","Yb","$b","ac","bc","cc","dc","ec","fc","gc","hc","ic","jc","kc","lc","oc","clz32","qc","LN2","rc","sc","tc","uc","pendingLanes","suspendedLanes","pingedLanes","entangledLanes","entanglements","vc","xc","yc","zc","Ac","eventTimes","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Jc","Kc","Lc","Mc","Nc","Oc","Pc","Qc","Rc","Sc","pointerId","Tc","nativeEvent","blockedOn","domEventName","eventSystemFlags","targetContainers","Vc","Wc","priority","isDehydrated","containerInfo","Xc","Yc","dispatchEvent","Zc","$c","ad","bd","cd","dd","ed","fd","gd","hd","Uc","stopPropagation","jd","kd","ld","md","nd","od","keyCode","charCode","pd","qd","rd","_reactName","_targetInst","currentTarget","isDefaultPrevented","defaultPrevented","returnValue","isPropagationStopped","preventDefault","cancelBubble","persist","isPersistent","wd","yd","sd","eventPhase","bubbles","cancelable","timeStamp","isTrusted","td","ud","detail","vd","Ad","screenX","screenY","clientX","clientY","pageX","pageY","ctrlKey","shiftKey","altKey","metaKey","getModifierState","zd","button","buttons","relatedTarget","fromElement","toElement","movementX","movementY","Bd","Dd","dataTransfer","Fd","Hd","animationName","elapsedTime","pseudoElement","Id","clipboardData","Jd","Ld","Md","Esc","Spacebar","Left","Up","Right","Down","Del","Win","Menu","Apps","Scroll","MozPrintableKey","Nd","Od","Alt","Control","Meta","Shift","Pd","Qd","repeat","locale","which","Rd","Td","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","Vd","touches","targetTouches","changedTouches","Xd","Yd","deltaX","wheelDeltaX","deltaY","wheelDeltaY","wheelDelta","deltaZ","deltaMode","Zd","$d","ae","be","documentMode","ce","ee","fe","ge","he","ie","le","color","date","datetime","email","month","search","tel","text","time","week","me","ne","oe","pe","qe","se","te","ue","ve","we","xe","ye","ze","oninput","Ae","detachEvent","Be","Ce","De","Ee","Fe","He","Ie","Je","Ke","node","nextSibling","Le","contains","compareDocumentPosition","Me","HTMLIFrameElement","contentWindow","Ne","contentEditable","Oe","focusedElem","selectionRange","documentElement","selectionStart","selectionEnd","defaultView","getSelection","rangeCount","anchorNode","anchorOffset","focusNode","focusOffset","createRange","setStart","removeAllRanges","addRange","setEnd","element","scrollLeft","scrollTop","focus","Pe","Qe","Re","Se","Te","Ue","Ve","We","animationend","animationiteration","animationstart","transitionend","Xe","Ye","Ze","animation","$e","af","bf","cf","df","ef","ff","gf","hf","lf","mf","nf","Ub","of","pf","qf","rf","sf","capture","passive","tf","uf","parentWindow","vf","wf","na","xa","$a","ba","je","ke","xf","yf","zf","Af","Bf","Cf","Df","Ef","__html","Ff","Gf","Hf","Jf","If","Kf","Lf","Mf","previousSibling","Nf","Of","Pf","Qf","Rf","Sf","Tf","Uf","Vf","Wf","Xf","Yf","contextTypes","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","Zf","childContextTypes","$f","ag","bg","getChildContext","cg","__reactInternalMemoizedMergedChildContext","dg","eg","fg","gg","hg","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","wg","xg","yg","zg","Ag","Bg","elementType","deletions","Cg","pendingProps","overflow","treeContext","retryLane","Dg","mode","Eg","Fg","Gg","memoizedProps","Hg","Ig","Jg","Kg","Lg","_stringRef","Mg","Ng","Og","Pg","Qg","Rg","implementation","Sg","Tg","Ug","Vg","Wg","Xg","Yg","Zg","$g","ah","bh","childLanes","ch","dependencies","firstContext","lanes","dh","eh","memoizedValue","fh","gh","hh","interleaved","ih","jh","kh","updateQueue","baseState","firstBaseUpdate","lastBaseUpdate","shared","effects","lh","mh","eventTime","lane","nh","oh","ph","qh","rh","sh","th","uh","vh","wh","xh","yh","tagName","zh","Ah","Bh","Ch","revealOrder","Dh","Eh","_workInProgressVersionPrimary","Fh","Gh","Hh","Ih","Jh","Kh","Lh","Mh","Nh","Oh","Ph","Qh","Rh","Sh","Th","baseQueue","queue","Uh","Vh","Wh","lastRenderedReducer","hasEagerState","eagerState","lastRenderedState","dispatch","Xh","Yh","Zh","$h","ai","getSnapshot","bi","ci","di","lastEffect","stores","ei","gi","hi","ii","deps","ji","ki","li","mi","ni","oi","pi","qi","ri","si","ti","ui","vi","wi","xi","yi","zi","Ai","Bi","readContext","useMutableSource","unstable_isNewReconciler","identifierPrefix","Ci","Di","Ei","_reactInternals","Fi","shouldComponentUpdate","Gi","contextType","Hi","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","Ii","getDerivedStateFromProps","getSnapshotBeforeUpdate","UNSAFE_componentWillMount","componentWillMount","componentDidMount","Ji","digest","Ki","Li","Mi","WeakMap","Ni","Oi","Pi","Qi","getDerivedStateFromError","componentDidCatch","Ri","componentStack","Si","pingCache","Ti","Ui","Vi","Wi","Xi","Yi","Zi","$i","aj","bj","cj","dj","baseLanes","cachePool","transitions","ej","fj","gj","hj","ij","UNSAFE_componentWillUpdate","componentWillUpdate","componentDidUpdate","jj","kj","pendingContext","lj","zj","Aj","Bj","Cj","mj","nj","oj","fallback","pj","qj","sj","dataset","dgst","tj","uj","_reactRetry","rj","subtreeFlags","vj","wj","isBackwards","rendering","renderingStartTime","last","tailMode","xj","Dj","Ej","Fj","wasMultiple","multiple","suppressHydrationWarning","onclick","createElementNS","autoFocus","createTextNode","Gj","Hj","Ij","Jj","Kj","WeakSet","Lj","Mj","Nj","Pj","Qj","Rj","Sj","Tj","Uj","Vj","insertBefore","_reactRootContainer","Wj","Xj","Yj","Zj","onCommitFiberUnmount","componentWillUnmount","ak","bk","ck","dk","ek","isHidden","fk","gk","display","hk","ik","jk","kk","__reactInternalSnapshotBeforeUpdate","Vk","lk","mk","nk","ok","Y","Z","pk","qk","rk","sk","tk","uk","vk","wk","xk","yk","zk","Ak","Bk","Ck","Dk","callbackNode","expirationTimes","expiredLanes","wc","callbackPriority","ig","Ek","Fk","Gk","Hk","Ik","Jk","Kk","Lk","Mk","Nk","finishedWork","finishedLanes","Pk","timeoutHandle","Qk","Rk","Sk","Tk","Uk","mutableReadLanes","Bc","Oj","onCommitFiberRoot","mc","onRecoverableError","Wk","onPostCommitFiberRoot","Xk","Yk","$k","pendingChildren","al","mutableSourceEagerHydrationData","bl","pendingSuspenseBoundaries","dl","fl","gl","hl","il","yj","Zk","kl","reportError","ll","_internalRoot","ml","nl","ol","pl","rl","ql","unmount","unstable_scheduleHydration","form","sl","usingClientEntryPoint","Events","tl","findFiberByHostInstance","bundleType","rendererPackageName","ul","rendererConfig","overrideHookState","overrideHookStateDeletePath","overrideHookStateRenamePath","overrideProps","overridePropsDeletePath","overridePropsRenamePath","setErrorHandler","setSuspenseHandler","scheduleUpdate","currentDispatcherRef","findHostInstanceByFiber","findHostInstancesForRefresh","scheduleRefresh","scheduleRoot","setRefreshHandler","getCurrentFiber","reconcilerVersion","__REACT_DEVTOOLS_GLOBAL_HOOK__","vl","isDisabled","supportsFiber","inject","createPortal","cl","unstable_strictMode","findDOMNode","flushSync","hydrate","hydratedSources","_getVersion","_source","unmountComponentAtNode","unstable_batchedUpdates","unstable_renderSubtreeIntoContainer","onAction","isProcessing","setIsProcessing","cursor","getIngredientDetails","allResources","ingredients","ingredientResource","existingTiles","newTiles","changed","oldTile","raw","template","getCurrentTileCoordinates","tileX","tileY","isACrop","setTiles","newResources","currentStep","nextStep","FTUEstepsData","addAcceptedQuest","questIndex","questTemplate","newQuest","goal2","goal3","goal1action","goal1item","goal1qty","goal2action","goal2item","goal2qty","goal3action","goal3item","goal3qty","currentActiveQuests","updatedActiveQuests","setActiveQuestGiver","currentStepData","setCurrentStepData","imageLoaded","setImageLoaded","showFeedbackModal","setShowFeedbackModal","positiveReasons","setPositiveReasons","negativeReasons","setNegativeReasons","_currentPlayer$ftueFe","_currentPlayer$ftueFe2","step1Data","hasFeedback","ftueFeedback","positive","negative","stepData","advanceToStep6","image","Image","handleFeedbackSubmit","browserType","getBrowserType","isPositive","browser","completeTutorial","wizardQuestExists","finalActiveQuests","handleAspirationChoice","aspiration","toggleReason","reasonIndex","onChange","bodyKey","alt","actualCurrentStep","hasNextStep","notificationKey","playerAfterQuest5","playerAfterQuest18","continue","farmTimer","farmState","initializeFarmState","addSeed","seed","startSeedTimer","completedSeeds","successfulCount","newCrop","forceProcessPendingSeeds","updatePromises","successfulUpdates","seedPositions","processedSeeds","stopSeedTimer","AnimalPanel","stationType","currentStationPosition","stallDetails","setStallDetails","currentNPC","setCurrentNPC","setCurrentTime","stallResource","updateNPCData","interval","storedInventory","getItem","serverInventory","syncInventory","Panel","remainingTime","getNPCStatusText","TransactionButton","totalRefund","React","notificationRoot","notificationTimer","globalClickHandlers","Notification","onDismiss","renderContent","_Fragment","registerNotificationClickHandler","handler","container","getElementById","ReactDOM","clickHandler","handleDismiss","globalFloatingTexts","globalForceUpdate","tick","setTick","displayText","newId","EDGE_THRESHOLD","gridSize","onAnimationEnd","PanelContext","PanelProvider","setActivePanel","checkDCE","processedResources","loadedResources","rawResource","shadowX","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","chunkId","miniCssF","dataWebpackPrefix","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","doneFns","installedChunks","installedChunkData","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","checkDeveloperStatus","isDeveloper","currentSettlementId","currentFrontierId","messages","setMessages","inputText","setInputText","endRef","_false","json","fetchMessages","_endRef$current","scrollIntoView","handleSend","trimmed","onKeyDown","TILE_ROUNDING_CONFIG","getTileColor","tileColors","unknown","drawGrassTuft","ctx","tuftSeed","save","translate","rotate","fillStyle","beginPath","px","py","drawX","drawY","moveTo","lineTo","closePath","restore","calculateCornerColor","corner","rowIndex","colIndex","tileTypes","_tileTypes","_tileTypes$rowIndex","_tileTypes2","_tileTypes3","_tileTypes$rowIndex2","_tileTypes4","_tileTypes5","_tileTypes$rowIndex3","_tileTypes6","_tileTypes7","_tileTypes$rowIndex4","_tileTypes8","adjacentTiles","priorityOrder","priorityType","createTileTexture","variation","canvas","getContext","roundedCorners","topLeft","topRight","bottomRight","bottomLeft","adjacentChecks","neighbors","check","allNeighborsDifferent","neighbor","_tileTypes$neighbor$r","calculateRoundedCorners","fillRect","cornerSize","radius","quadraticCurveTo","baseX","baseY","lightSeed","lightX","lightY","lightSize","numPatches","patchSeed","PI","arc","RenderTilesCanvas","handleTileClick","canvasRef","textureCache","lastRenderData","getTileTexture","cacheKey","renderTiles","_grid$","rows","cols","clearRect","_tileTypes$rowIndex5","texture","drawImage","handleCanvasClick","_grid$2","imageRendering","RenderTile","tileClass","borderRadius","baseRadius","extendedRadius","topLeftExtended","topRightExtended","bottomRightExtended","bottomLeftExtended","generateBorderRadius","backgroundColor","right","bottom","tufts","numTufts","clipPath","patches","RenderTilesDOM","RenderTiles","useCanvasTiles","svgCache","loadingPromises","ZOOM_TIERS","getBestZoomTier","targetSize","devicePixelRatio","adjustedSize","tier","loadSVG","svgFileName","isOverlay","loadPromise","svgText","createSVGTexture","imageSmoothingEnabled","imageSmoothingQuality","revokeObjectURL","svgBlob","createObjectURL","getSVGTexture","getOverlayTexture","overlayFileName","updateZoomTiers","baseZooms","farZoom","closeZoom","closerZoom","highResVariants","clearCache","getCacheStats","svgFiles","textures","loading","getResourceOverlayStatus","craftingStatus","tradingStatus","badgeState","electionPhase","_craftingStatus$ready","_craftingStatus$inPro","_tradingStatus$ready","resourceKey","isCraftReady","isCraftInProgress","isTradingReady","mailbox","OVERLAY_SVG_MAPPING","OVERLAY_EMOJI_MAPPING","globalAttackCooldown","getNPCCursorClass","setCanvasCursor","cursorClass","CUSTOM_ART_MAPPING","RenderResourcesCanvas","onMouseEnter","onMouseLeave","SVGAssetManager","renderResources","displayWidth","displayHeight","actualWidth","actualHeight","scale","svgResources","renderSingleResource","visibleResources","renderResourceOverlay","customArt","overlayInfo","overlayType","overlaySize","overlayX","overlayY","overlayTexture","craftingReady","craftingInProgress","tradingReady","mailboxBadge","handleCanvasMouseMove","getResourceCursorClass","handleCanvasMouseLeave","onMouseMove","RenderResourcesDOM","alignItems","justifyContent","RenderResources","useCanvasResources","RenderNPCsCanvas","onNPCClick","checkQuestNPCStatus","checkTradeNPCStatus","checkKentNPCStatus","getOverlayContent","setHoverTooltip","canvasAnimations","animationFrameId","renderNPCsRef","startAnimationLoop","hasActiveAnimations","elapsed","currentPos","startPos","hasPositionChanges","currentAnimation","cancelAnimationFrame","getNPCRenderPosition","renderNPCs","renderSingleNPC","renderNPCOverlay","renderPos","renderNPCEmoji","font","textAlign","textBaseline","fillText","interpolatedPos","elementBelow","elementFromPoint","clickEvent","MouseEvent","tooltipContent","localizedNPCType","countdownText","generateNPCTooltipContent","tooltipData","NPCOverlayContext","NPCOverlayProvider","npcOverlays","setNpcOverlays","setNPCOverlay","clickable","overlay","clearNPCOverlay","getNPCOverlay","setBusyOverlay","setQuestOverlay","setAttackOverlay","useNPCOverlay","activeConversations","relationshipOutcomes","addSpeech","speakerId","topic","notifyListeners","removeSpeech","getSpeech","showOutcome","getOutcome","RenderNPCsDOM","NPCRenderer","_currentPlayer$settin","setPosition","prevTileSizeRef","overridePos","tileSizeChanged","showRangeIndicator","rangeOn","border","onMouseDown","handleClick","overlayData","isOnOwnHomestead","_playersInGrid$gridId","_playersInGrid$gridId2","_pcState$speed","pcState","baseSpeed","_currentPlayer$locati3","npcPos","_currentPlayer$locati4","RenderNPCs","useCanvasNPCs","RenderPCsCanvas","onPCClick","RenderPCsDOM","isCurrentPlayer","PCRenderer","isCamping","isInBoat","showRangeIndicators","derivedRange","attackRange","isInHomestead","getCursorClass","_currentPlayer$locati5","isNotSelf","isAttackable","isTown","avatar","RenderPCs","useCanvasPCs","RenderDynamicElementsCanvas","hoverTooltip","generateResourceTooltip","generateNPCTooltip","generatePCTooltip","renderOverlays","HoverTooltip","tooltip","RenderDynamicElementsDOM","hoverTimersRef","handleResourceMouseEnter","resourceEl","closest","resourceX","resourceY","updateTooltip","handleResourceMouseLeave","gridContainer","emojiMapping","padding","setTooltipContent","cacheTime","cacheExpiry","pendingRequest","getQuests","invalidate","getQuestsForNPC","giver","lines","localizedResourceType","days","hours","minutes","seconds","npcQuests","questCache","_currentPlayer$comple","activeQuest","repeatable","completedQuests","hasCompletedQuests","_currentPlayer$active2","tradeResource","_currentPlayer$kentOf","kentOffers","offers","offer","_currentPlayer$invent","_currentPlayer$invent2","_currentPlayer$backpa","_currentPlayer$backpa2","RenderDynamicElements","useCanvasDynamicElements","lockedResources","unlockResource","getPersonalizedWarehouseRarity","_rarityRotation$itemT","rarityGroup","hash","getPlayerRarityGroup","STANDARD_RARITY_TABLE","getRarityChance","rarity","level","baseRarity","rarityScale","selectWeightedRandomItem","items","totalWeight","scrollchance","roll","cumulative","handleResourceClick","_tileTypes$row","_bulkOperationContext2","fetchedInventory","fetchedBackpack","handleDooberClick","handleSourceConversion","activeOps","getActiveBulkOperations","baseQtyCollected","dooberId","_processingDoobers","qtyCollected","_masterSkills$item$ty","isSkill","appliesToResource","buffItem","buff","_masterSkills$buff","gainResult","gridUpdateResponse","collectedItemType","dropped","dropRate","harvestDropRate","toFixed","warehouseIngredients","selectedIngredient","ingredient","added","checkAndDropWarehouseIngredient","pendingKeyResolve","requirement","isSkillOrUpgrade","isKey","usedKey","handleNo","totalOwned","message2","gap","marginTop","ingredient1","ingredient1qty","handleUseKey","originalResource","filteredResources","enrichedNewResource","UILockContext","UILockProvider","uiLocked","setUILocked","GridStatePCContext","GridStatePCUpdateContext","GridStatePCProvider","GridStateContext","GridStateUpdateContext","GridStateProvider","controlledGrids","setupSocketListeners","retryTimeout","setAsController","removeController","joinGrid","leaveGrid","controllerData","StatusBarContext","StatusBarProvider","messageIdRef","newMessage","predefinedMessage","messageObject","StatusBar","displayMessages","setDisplayMessages","slideOffset","setSlideOffset","scrollPosition","setScrollPosition","canScrollRight","setCanScrollRight","prevFirstId","newMessageRef","messagesContainerRef","viewportRef","_messages$","currentFirstId","offsetWidth","containerWidth","viewportWidth","handleScrollLeft","_viewportRef$current","visibility","whiteSpace","handleScrollRight","maxScroll","BulkOperationContext","BulkOperationProvider","activeBulkOperations","setActiveBulkOperations","startBulkOperation","operationType","operationId","endBulkOperation","newState","useBulkOperation","getGridBackgroundColor","setZoomLevel","isRelocating","setIsRelocating","visibleSettlementId","setVisibleSettlementId","settlementGrid","setSettlementGrid","players","setPlayers","setError","NPCsInGrids","setGridStates","playersInGridMap","gridStates","playersArray","playersById","gridIds","gridStateResponse","mergedPlayersInGrid","_gridStateResponse$da","_gridStateResponse$da2","fetchData","playerGridId","playerRow","playerCol","_settlementGrid$row$c","playerTile","block","inline","updatedRect","tileCenterX","tileCenterY","windowCenterX","windowCenterY","scrollX","scrollY","centerCameraOnPlayerGrid","available","fromGridId","targetGridCoord","relocationResponse","processRelocation","_pcs","arrivalX","arrivalY","renderMiniGrid","tileData","settlementTileData","isPlayerHere","owner","ownerIdStr","getTooltip","miniX","miniY","isValleyGrid","playerPCs","playerPC","_playerPCs","_playerPC","cell","tradeStall","stall","boughtBy","_owner2","role","_owner3","_owner3$netWorth","netWorth","toLocaleString","frontierGrid","setFrontierGrid","settlementGrids","setSettlementGrids","checkAndShowFrontierTip","_settlementGrids$tile","frontierTileData","settlementType","flatSettlementGrid","ownedHomestead","isOpen","custom","LanguagePickerModal","onSave","selectedLanguage","setSelectedLanguage","LANGUAGE_OPTIONS","flag","stripePromise","RELEASE_TRAIN","ORIGIN","STRIPE_JS_URL","V3_URL_REGEX","STRIPE_JS_URL_REGEX","EXISTING_SCRIPT_MESSAGE","injectScript","queryString","advancedFraudSignals","headOrBody","stripePromise$1","onErrorListener","onLoadListener","loadScript","Stripe","findScript","_script$parentNode","onLoad","loadCalled","getStripePromise","loadStripe","maybeStripe","isTestKey","runtimeVersionToUrlVersion","expectedVersion","stripe","_registerWrapper","registerWrapper","initStripe","handlePurchase","offerId","redirectToCheckout","sessionId","openMailbox","setOffers","purchaseSuccess","history","replaceState","fetchOffers","Modal","activeOffers","shelflifeDays","created","isOfferExpired","processedIds","offer3","offer4","rewards","_resources$find","price","_resources$find2","offer6","offer7","offer8","_resources$find3","_resources$find4","_resources$find5","_resources$find6","ChangeIconModal","currentIcon","setModalIsOpen","selectedIcon","setSelectedIcon","freeIcons","ICON_OPTIONS","paidIcons","locked","isEmoji","updatedCurrentPlayer","updatePlayerIcon","alert","updatePlayerSettings","newSettings","ModalContext","useModalContext","ModalProvider","activeModal","setActiveModal","openModal","modalName","closeModal","_LANGUAGE_OPTIONS$fin","handleLogout","zoomLevel","setIsDeveloper","hasCheckedDeveloperStatus","showChangeIconModal","setShowChangeIconModal","_res$data","_res$data2","checkDevStatus","setFormData","isSaving","setIsSaving","setErrorMessage","localSettings","setLocalSettings","isStateMachineEnabled","isTeleportEnabled","toggleVFX","renderSVGResources","_settings$isStateMach","_settings$isTeleportE","_settings$toggleVFX","_settings$rangeOn","_settings$renderSVGRe","handleInputChange","handleToggleChange","updatedSettings","roleName","_error$response$data","handleGoldPanelSwitch","confirm","removeItem","relocations","handleLanguage","newIcon","trackAccountCreation","userId","trackGoogleAccountCreation","gtag","currency","user_id","custom_parameters","rdt","trackFacebookAccountCreation","fbq","content_name","ttq","content_id","trackTikTokAccountCreation","setIsLoggedIn","setUsername","setPassword","setLanguage","isSubmitting","setIsSubmitting","onSubmit","frontierName","frontierResponse","frontier","assignedSettlementId","assignedGridCoord","settlementRow","settlements","settlementResponse","availableGrid","registerPayload","assignedGridId","baseAttackbonus","baseArmorclass","baseDamage","baseAttackrange","messageId","mailError","_err$response$data","onLoginSuccess","showCreateAccount","setShowCreateAccount","CreateAccount","htmlFor","required","formatJSON","currentNPCs","currentPCs","_currentPlayer$settin3","_currentPlayer$wareho","_currentPlayer$locati6","_currentPlayer$locati7","_currentPlayer$locati8","setUseCanvasTiles","timers","setTimers","setNPCs","setPCs","setUpdatedNPCs","refreshDebug","setRefreshDebug","singleGridCoord","setSingleGridCoord","toGridCoord","setToGridCoord","usernameToDelete","setUsernameToDelete","messageIdentifier","setMessageIdentifier","performanceMetrics","setPerformanceMetrics","fps","domElementCount","memoryUsage","renderMode","resourcesWithTimers","fetchTimers","timerInterval","prevTimers","growTimeRemaining","craftTimeRemaining","fetchGridStateEntities","frameCount","lastTime","measurePerformance","hasCanvasTiles","hasDOMTiles","memory","usedJSHeapSize","handleGenerateValley","valleyType","frontierData","valleyGrids","settlementData","valleyGrid","generateValleyGrids","marginBottom","fontFamily","margin","_currentPlayer$settin2","newValue","gridTemplateColumns","resetResponse","townGrids","gridError","generateTownGrids","filteredInventory","clearedSkills","clearedPowers","combatStats","command","clearGridState","clearedTrophies","resourcesToAdd","skillResources","skillsResponse","updatedSkills","existingSkill","foundGrid","foundSettlementId","foundFrontierId","createSingleValleyGrid","parsedCoord","coordStr","matchingGridObj","handleTeleport","_username","deleteResponse","handleDeleteAccount","sendMessageToAll","warehouseLevel","GridStateDebugPanel","showActions","warehouseAmounts","setWarehouseAmounts","handleAmountChange","handleDiscardWarehouseItem","passedStrings","contextStrings","sortField","setSortField","sortDirection","setSortDirection","sortedInventory","aValue","bValue","handleSort","field","getSortIcon","_masterResources$find","marginLeft","_inventory$find","_inventory$find2","_inventory$find3","_inventory$find4","_inventory$find5","showBackpackModal","setShowBackpackModal","showWarehouseModal","setShowWarehouseModal","inventorySortField","setInventorySortField","inventorySortDirection","setInventorySortDirection","backpackSortField","setBackpackSortField","backpackSortDirection","setBackpackSortDirection","backpackAmounts","setBackpackAmounts","hasBackpackSkill","finalCapacities","warehouseGoldBonus","backpackGoldBonus","calculateTotalQuantity","handleInventorySort","getInventorySortIcon","handleBackpackSort","getBackpackSortIcon","amounts","setAmounts","maxValue","clampedValue","handleMoveAll","isAtHome","itemsToMove","totalToMove","currentWarehouseUsage","updatedWarehouseInventory","existingIndex","invItem","itemsToKeep","maxHeight","_masterResources$find2","nonTentBoatItems","isAddAllDisabled","_masterResources$find3","isTentAtHome","isBoatAtHome","isTentOrBoatNotHome","spaceAvailable","updatedWarehouse","newQuantity","handleMoveItem","ManageContentsModal","handleDiscardAllWarehouse","calculateGemPurchase","_safeInventory$find","_safeBackpack$find","overrideGemCost","safeInventory","safeBackpack","safeMasterResources","playerGems","ownedSkills","spendingItems","_safeInventory$find2","_safeBackpack$find2","resourceData","playerQty","willSpend","gemCost","missingIngredientCost","_safeInventory$find3","_safeBackpack$find3","missingQty","gemcost","hasEnoughGems","getModifiedRecipe","modifiedRecipe","_safeInventory$find4","_safeBackpack$find4","gemSlot","formatDetailsForDisplay","formatNumber","info","hideInfo","onTransactionAction","isTransactionMode","onGemPurchase","hideGem","showInfo","setShowInfo","tooltipPosition","setTooltipPosition","showGemTooltip","setShowGemTooltip","gemTooltipPosition","setGemTooltipPosition","buttonRef","shouldCalculateGem","gemCalculation","updateTooltipPosition","updateGemTooltipPosition","currentLevel","setCurrentLevel","nextLevel","setNextLevel","needsLevelMigration","setNeedsLevelMigration","migrateLevelToPlayer","handleUpgrade","customRecipe","recipeToUse","newCapacity","newLevel","Level","ResourceButton","setTrophies","setLoading","collecting","setCollecting","fetchTrophies","playerTrophyA","playerTrophyB","isEarnedA","isEarnedB","hasUncollectedRewardA","hasUncollectedRewardB","playerTrophy","isEarned","progressInfo","getProgressInfo","currentProgress","progressArray","lastAchievedMilestone","lastMilestone","milestoneDifference","percentage","hasAchievedAll","hasUncollectedReward","isCollecting","gemReward","prevTrophies","handleCollectReward","offerData","offerMap","flexDirection","QuestButton","goals","reward","rewardqty","goal","QuestGiverButton","buttonText","playerQuests","setPlayerQuests","questTemplates","setQuestTemplates","fetchQuestTemplates","_quest$progress","_quest$progress2","_quest$progress3","textbody","updateRelationship","targetName","_currentPlayer$relati","relationships","rel","relationship","initialScore","updateRelationshipStatus","allCharacters","RelationshipMatrix","metCharacters","met","charName","trophyResponse","trophyError","getRelationshipStatus","relscore","getRelationshipMultiplier","npcName","_currentPlayer$relati4","npcEntry","entry","buff4friend","buff4love","buff4marriage","bonusMessage","married","love","friend","conversationResults","matchingInterests","matchingRandom","totalRounds","playConversation","playerEmoji","npcEmoji","onComplete","interaction","numExchanges","rounds","getCurrentTileSize","gridElement","firstTile","topicContext","playerIcon","npcIcon","roundNum","playerSpeakerId","playerTopicKey","playerTopic","getTopicSymbol","showSpeech","animateCharacter","hideSpeech","npcSpeakerId","npcTopicKey","npcTopic","topicKey","isPlayerTurn","topItems","npcInterests","interest","interests","secretTopics","randomTopics","weatherTopics","speakerType","ConversationManager","characterType","characterElement","playerElements","parseFloat","expectedX","expectedY","npcElements","classList","RelationshipCard","targetType","targetEmoji","onRelationshipChange","compact","checkDistance","onInteractionClick","setRelationship","isInitializing","setIsInitializing","loadOrCreateRelationship","existingRel","newRel","handleInteraction","relationshipCheck","checkOtherRelationships","targetNPC","relbitadd","allowed","_currentPlayer$relati2","existingMarriage","targetRivals","rival","_currentPlayer$relati3","playerRelWithRival","targetNPCEntry","targetLoves","conversationTargetEmoji","targetId","baseChance","chance","modifiedChance","calculateModifiedChance","relstatus","buffField","handleInteractionOutcome","scoreChange","relscoreresult","updatedRel","statusResult","npcReactions","getNPCReactions","newStatus","reactions","npcRelationshipWithTarget","setScore","clearAllStatuses","setStatus","reaction","_statusResult$player$","_statusResult$player$2","scoreResult","statuses","isaninteraction","metResult","finalResult","_scoreResult$player$r","updatedRelWithReactor","statusMessage","negativeReactions","positiveReactions","generateRelationshipStatusMessage","relbitremove","removeResult","statusesToRemove","relscoremin","statusKey","statusItem","scoreColor","score","visibleStatuses","isvisible","availableInteractions","_interaction$relscore","_interaction$relscore2","minScore","maxScore","relscoremax","relbitrequired","blockField","crush","isHealing","healAmount","onHealingComplete","animationTimeoutRef","conversationTimeoutRef","_playerInGridState$po","_playerInGridState$po2","playerInGridState","animatePlayer","allPlayerElements","playerElement","NPCPanel","questList","setQuestList","healRecipes","setHealRecipes","tradeRecipes","setTradeRecipes","setStatusMessage","canQuest","setCanQuest","hasHiddenQuests","setHasHiddenQuests","questThreshold","setQuestThreshold","canTrade","setCanTrade","tradeThreshold","setTradeThreshold","setIsHealing","coolingDownItems","setCoolingDownItems","COOLDOWN_DURATION","devStatus","checkStatus","questInteraction","currentScore","tradeInteraction","timeoutId","fetchQuests","filteredRecipes","trader","trades","trade","resourceDef","gives","tradeqty","requiresArray","requiresSkill","isInCompleted","questsHiddenByRelationship","handleGemPurchase","actionType","handleHeal","handleTrade","itemKey","currentHp","maxHp","healerInGrid","_NPCsInGridManager$ge2","statToMod","updatedValue","modifyPlayerStatsInGridState","newHealerHP","quantityToGive","hasRoom","isMoney","isGem","spendResult","ingredientList","ingredientString","npcResource","_currentPlayer$_id2","_NPCsInGridManager$ge3","npcInGrid","_currentPlayer$_id3","_NPCsInGridManager$ge4","_currentPlayer$_id4","_playersInGridManager4","closerTileSize","_currentPlayer$_id5","_playersInGridManager5","fontStyle","rewardQuantity","updatedCompletedQuests","prevList","handleGetReward","questTitle","acceptedQuest","initialProgress","isQuestCompleted","handleAcceptQuest","HealerInteraction","_currentPlayer$_id6","_playersInGridManager6","_currentPlayer$locati9","_NPCsInGridManager$ge5","affordable","isCoolingDown","healerOutOfHP","totalHeals","_currentPlayer$locati10","_currentPlayer$_id7","_playersInGridManager7","_currentPlayer$locati11","_NPCsInGridManager$ge6","_currentPlayer$locati12","_currentPlayer$_id8","_playersInGridManager8","_NPCsInGridManager$ge7","_currentPlayer$locati13","_currentPlayer$_id9","_playersInGridManager9","_currentPlayer$locati14","_currentPlayer$_id10","_playersInGridManager10","formattedCosts","_backpack$find","ingredientsList","_backpack$find2","_masterResources$find4","storyStringMap","Iago","Juliet","Falstaff","Apothecary","Gertrude","Leontes","Caliban","handleConstructionWithGems","modifiedBuildOptions","buildOptions","handleConstruction","selectedItem","coords","selectedResource","resourceRange","tilesToCheck","occupiedTile","costDetails","costString","debugBefore","getMayorUsername","_settlement$roles","mayorRole","roles","BuildPanel","currentSeason","setBuildOptions","setAllResources","isContentLoading","setIsContentLoading","isMayor","setIsMayor","homeSettlementId","currentLocation","isPlayerMayor","mayorUsername","playerUsername","inventoryResponse","allResourcesData","buildTownResources","validBuildOptions","currentSettlementStr","homeSettlementStr","settlementsMatch","currentSettlement","homeSettlement","season","existingPetOfType","layoutkey","buildTownInFinal","totalOptions","buildTownIncluded","shouldHaveBuildTown","maxTownBuildings","currentTownBuildings","masterResource","mr","requirementsMet","owned","hasRequiredSkill","townBuildingLimitReached","_allResources$find","inventoryQty","backpackQty","skillColor","BuyPanel","buyOptions","setBuyOptions","purchasableItems","playerFTUEStep","maxFarmAnimals","currentFarmAnimals","countFarmAnimals","_NPCsInGrid$gridId","_allResources$find2","farmAnimalLimitReached","PetsPanel","BuyDecoPanel","formatCountdown","endTime","timeDiff","formatDuration","secs","FarmingPanel","farmPlots","setFarmPlots","farmPlotsWithSeasonInfo","isOffSeason","handleFarmPlacementWithCooldown","cooldownTimer","_tiles$tileY","growEndTime","cropName","handleFarmPlotPlacement","ToolsPanel","farmPlotItems","handleTerraformWithCooldown","_tileTypes$tileY","handleTerraform","handleProtectedSelling","resourcesAtPosition","stationX","stationY","refundIngredients","totalMoneyRefund","removedStation","soldResource","_error$response5","_error$response5$data","_error$response4$data","SkillsPanel","entryPoint","setEntryPoint","skillsToAcquire","setSkillsToAcquire","setOwnedSkills","stationEmoji","setStationEmoji","resourcesResponse","serverBackpack","serverSkills","stationResource","availableSkills","canAcquireSkill","fetchResourcesAndInventory","showSellButton","meetsRequirement","attributeModifier","buffText","buffedItems","unlocks","calculateSettlementPopulation","_settlementData$grids","setSettlementData","taxRate","setTaxRate","population","setPopulation","taxLog","setTaxLog","mayor","setMayor","buildingCounts","School","Hospital","Library","taxlog","taxrate","mayorName","fetchGovernmentData","taxLogTable","borderCollapse","reverse","toLocaleDateString","totalcollected","currentmayor","mayortake","bankOffers","setBankOffers","bankTimer","setBankTimer","bankPhase","setBankPhase","coolingDownButtons","setCoolingDownButtons","fetchBankOffers","_response$data$bank","_response$data$bank2","bank","phase","updateCountdown","bankTimerData","handleTradeWithCooldown","buttonIndex","itemBought","qtyBought","itemGiven","qtyGiven","getSymbol","isInHomeSettlement","updateKentOffersAfterTrade","completedOffer","kentOffersWithoutCompleted","removedIndex","updatedOffers","removeCompletedOffer","newOffers","_currentPlayer$kentOf2","playerSkillTypes","isFirstTimeUser","eligibleResources","ingredient2","ingredient3","ingredient4","sourceResource","foundSourceResource","sourceType","sourceRequires","shouldFilter","attackResource","maxOffers","maxKentOffers","currentOfferCount","offersToGenerate","_currentPlayer$kentOf3","allExistingOffers","resourceCounts","randomResource","maxprice","bonusRoll","valleyResources","selectedValleyResource","bonusQuantity","newOffer","generateNewKentOffers","setKentOffers","kentTimer","setKentTimer","kentPhase","setKentPhase","isTrading","setIsTrading","fetchKentOffers","kentData","fallbackKentOffers","wheatResource","generateFallbackKentOffer","updateKentTimer","refreshOffersAndSetTimer","kentRefreshSeconds","kentRefreshTimerSeconds","newEndTime","updatedKentOffers","isKentOnCooldown","_offer$rewards$","_offer$rewards$2","convertedOffer","isLocked","allRewardsSuccess","originalOffer","kentOffer","rewardText","rewardIndex","trainOffers","setTrainOffers","trainPhase","setTrainPhase","trainTimer","setTrainTimer","nextOffers","setNextOffers","trainRewards","setTrainRewards","latestInventory","setLatestInventory","playerUsernames","setPlayerUsernames","currentTrainNumber","setCurrentTrainNumber","fetchTrainOffers","trainTimerData","currentoffers","nextoffers","currentTrain","trainlog","trainnumber","fetchUsernames","playerIds","claimedBy","usernamePromises","usernameMap","showLogicModal","setShowLogicModal","logicModalData","setLogicModalData","logic","trainNumber","handleShowTrainLog","trainLogTable","alloffersfilled","totalwinners","combinedRewards","totalQty","handleShowLogic","logicText","renderOfferSection","_latestInventory$find","isYours","isCompleted","filled","updateOffer","handleFulfill","offerIndex","updatedOffer","handleClaim","claimedByYou","claimedByOthers","allOrdersFilled","renderRewardSection","renderNextShipment","seen","uniqueOffers","generateCompleteTrainData","maxTrainOffers","usedResources","generateNewTrainOffers","_globalTuning$trainRe","seasonKey","seasonalRewards","numSeasonalRewards","usedRewards","availableRewards","randomReward","generateTrainRewards","_currentPlayer$train3","playerTrainNumber","setPlayerTrainNumber","settlementTrainNumber","setSettlementTrainNumber","settlementTrainPhase","setSettlementTrainPhase","currentTrainOffers","setCurrentTrainOffers","currentTrainRewards","setCurrentTrainRewards","nextTrainOffers","setNextTrainOffers","nextTrainRewards","setNextTrainRewards","rewardsDeliveredMessage","setRewardsDeliveredMessage","initializeTrainData","_currentPlayer$train","_currentPlayer$train2","playerTrainNum","lastRewardDelivery","lastRewardDeliveryTrainNumber","checkAndDeliverCurrentTrainRewards","checkForRewardDelivery","_settlementResponse$d","_currentPlayer$train4","currentTrainLog","currentSettlementTrainNumber","currentPlayerTrainNumber","determineTrainDataToShow","settlementTrainNum","settlementPhase","_currentPlayer$train5","_currentPlayer$train6","isPlayerBehind","showCurrentTrainData","advancePlayerToCurrentTrain","_currentPlayer$train7","_currentPlayer$train8","_currentPlayer$train9","_currentPlayer$train10","existingCurrentOffers","existingCurrentRewards","existingNextOffers","existingNextRewards","generateAndSaveTrainData","_currentPlayer$train11","_currentPlayer$train12","neverPurge","updatedMessages","updatedTrainData","rewardSummary","completedCount","_currentPlayer$train15","_currentPlayer$train16","newTrainNumber","_currentPlayer$train13","_currentPlayer$train14","checkAndDeliverPreviousTrainRewards","newCurrentOffers","newCurrentRewards","trainData","nextTrainData","currentTrainData","isLoadingPhaseExpired","loadingExpired","moneyReward","costDisplay","rewardDisplay","updatedCurrentOffers","handleFulfillOffer","carnivalOffers","setCarnivalOffers","carnivalPhase","setCarnivalPhase","carnivalTimer","setCarnivalTimer","carnivalRewards","setCarnivalRewards","currentCarnivalNumber","setCurrentCarnivalNumber","fetchCarnivalOffers","carnivalTimerData","carnival","_response$data$carniv","_response$data2$carni","_response$data3$carni","currentCarnival","carnivallog","carnivalnumber","carnivalNumber","handleShowCarnivalLog","carnivalLogTable","setSettlement","setElectionPhase","countdown","setCountdown","campaignPromises","setCampaignPromises","newPromise","setNewPromise","selectedCandidate","setSelectedCandidate","hasVoted","setHasVoted","votedFor","setVotedFor","candidateList","setCandidateList","tempTaxRate","setTempTaxRate","hoveredCandidate","setHoveredCandidate","tempSettlementName","setTempSettlementName","isModalOpen","modalContent","fetchElectionData","updateTimerAndPhase","electionData","elections","newPhase","populationCount","votes","playerVote","voterId","_settlementData$campa","votedCandidate","candidateId","_settlementData$campa2","uniqueCandidates","maxWidth","electionlog","electionLogTable","_entry$candidates","candidates","electedmayor","candidate","_campaignPromises$fin","getCandidatePromise","calculateGemSpeedupCost","remainingTimeMs","remainingMinutes","CraftingStation","recipes","setRecipes","stationDetails","setStationDetails","activeTimer","setActiveTimer","setCraftedItem","craftingCountdown","setCraftingCountdown","isCrafting","setIsCrafting","isReadyToCollect","setIsReadyToCollect","npcRefreshKey","setNpcRefreshKey","stationRefreshKey","setStationRefreshKey","_GlobalGridStateTiles","station","existingNPCTypes","checkMayorStatus","handleCraft","updatedGlobalResources","handleGemSpeedup","updateResponse","skillMessage","getSkillBonusMessage","skillName","stations","hasSkill","unownedSkills","combinedMultiplier","skillsList","skillResource","skillSource","currentHealers","countHealers","maxHealersAllowed","doctorsPerHospital","healerLimitReached","gemSpeedupCost","craftTimeText","crafttime","minprice","isNPC","updatedStation","finalQtyCollected","craftedResource","handleCollect","FarmHouse","toLocaleTimeString","placementData","workerPlacementData","workerType","offsetX","offsetY","spawnPosition","recipeType","hasInventory","isGemPurchase","frame","setFrame","hourglassFrames","BulkHarvestModal","crops","getFreshCrops","onExecute","showBulkReplant","selectedCropTypes","setSelectedCropTypes","selectedReplantTypes","setSelectedReplantTypes","defaultSelection","crop","defaultReplantSelection","replantRequires","isInSeason","farmplot","allSelected","allReplantSelected","allHarvestSelected","paddingLeft","overflowY","canReplant","borderBottom","handleToggleCrop","cropType","replantPrev","marginRight","cropPrev","freshCrops","validCropTypes","validReplantTypes","executeBulkHarvest","selectedTypes","currentResources","pendingFarmplots","maxAttempts","resourceAtPosition","freshResources","capacityCheck","totalCapacityNeeded","harvestDetails","currentBackpackUsage","capacities","totalCapacity","currentTotalUsage","availableSpace","baseCrop","baseYield","yieldPerCrop","totalYield","skillMultiplier","positions","replantDetails","seedsNeeded","totalNeeded","farmplotType","hasEnoughSeeds","canReplantAll","seedType","needed","totalHas","enough","canHarvest","calculateBulkHarvestCapacity","spaceNeeded","missingSeeds","operations","shouldReplant","replant","expectedYield","buildBulkHarvestOperations","harvestedPositions","harvested","replanted","growTimeMs","stage","harvestSkillsInfo","harvestResults","numPlotsHarvestedExcludingWheat","warehouseDropsArray","numPlotsHarvested","warehouseDrops","personalizedIngredients","calculateBulkWarehouseDrops","aggregatedWarehouseDrops","aggregated","drop","aggregateWarehouseDrops","_response$data$invent","_response$data$invent2","questProgressCategory","itemName","seedsUsed","prepareBulkHarvestData","cropCounts","hasHarvestResults","hasReplantInfo","hasWarehouseDrops","hasSkillBonus","cropResource","cropSymbol","seedsUsedForCrop","BulkAnimalModal","animals","selectedAnimalTypes","setSelectedAnimalTypes","animal","handleExecute","BulkCraftingModal","stationGroups","hasBulkRestartCraft","selectedGroups","setSelectedGroups","selectedRestartStations","setSelectedRestartStations","defaultRestartSelection","group","canRestart","isGroupSelected","isRestartDisabled","selectAll","selectNone","selectAllRestarts","allRestartSelection","groupsToSelect","selectNoneRestarts","needs","stationCount","totalAvailable","calculateGroupNeeds","restartPrev","handleToggleGroup","stationSymbol","craftedSymbol","restartLabel","getRestartLabel","groupsPrev","handleToggleRestart","idx","FarmHandPanel","workerSkills","setFarmhandSkills","workerUpgrades","setFarmhandUpgrades","isHarvestModalOpen","setIsHarvestModalOpen","availableCrops","setAvailableCrops","bulkHarvestResults","setBulkHarvestResults","isResultsModalOpen","setIsResultsModalOpen","isAnimalModalOpen","setIsAnimalModalOpen","availableAnimals","setAvailableAnimals","isCraftingModalOpen","setIsCraftingModalOpen","selectedCraftingStations","setSelectedCraftingStations","availableCraftingStations","setAvailableCraftingStations","hasBulkReplant","bulkProgressModal","setBulkProgressModal","executeBulkOperation","operationName","workerNPC","asyncOperation","pendingStatusMessage","showBulkHarvest","showBulkAnimalCollect","showLogging","showCropPurchase","showBulkCrafting","farmOutputs","ownedTypes","validSources","executeSelectiveAnimalCollect","animalsToCollect","wait","successfulCollects","animalSkillsInfo","executeBulkAnimalCollect","getFreshCropData","getSkillTooltip","skillType","processingAnimals","animalCounts","animalsWithDetails","animalType","maxTrees","lumberjackNPC","farmerNPC","centerPos","centerType","treeResources","tree","treesToChop","choppedTreePositions","wood","workerNPCCleanup","readyStations","stationDef","groupsArray","stationCompare","localeCompare","prepareBulkCraftingData","stationsWithDetails","playerInventory","hasAllIngredients","handlePurchaseSkill","cost","batchStations","flatMap","shouldRestart","restartRecipe","stationGroup","successfulRestarts","appliedSkillsInfo","stationUpdates","itemCollected","restarted","newCraftEnd","newCraftedItem","playerBuffs","appliesToStation","restartedItem","currentInventory","currentBackpack","hasCollections","hasRestarts","totalProcessed","executeBulkCrafting","ProgressModal","BulkHarvestResultsModal","ShopStation","fetchTrigger","setFetchTrigger","updatedPowers","powerIndex","statUpdates","oldValue","_currentPlayer$powers","hasRequirement","outputSummary","effectsHtml","infoContent","ScrollStation","scrollCount","setScrollCount","revealedItemQty","setRevealedItemQty","setIsCollecting","checkStation","isRevealed","scrolls","handleCollectReveal","_currentPlayer$skills3","_currentPlayer$powers2","collectedQty","revealedResource","categoryEmoji","updatedRange","gainSkillOrPower","rarityText","scrollableItems","scrollqty","fallbackItem","getRandomScrollReveal","revealScrollResource","reveal","getRevealDisplayString","craftTime","getRandomPetReward","petRewardRarity","petRewards","personalizedRewards","getPersonalizedPetRewards","selectedReward","quantityRanges","getDropQuantity","PetPanel","petResource","currentPetPosition","rewardItem","setRewardItem","feedingCountdown","setFeedingCountdown","isFeeding","setIsFeeding","revealedRewardQty","setRevealedRewardQty","revealedRewardRarity","setRevealedRewardRarity","canAffordFeeding","setCanAffordFeeding","petName","petSymbol","feedIngredient","feedQuantity","feedingTime","checkAffordability","checkPetState","pet","rewardResource","ingredientDetails","isValid","feedMessage","AnimalStall","outputDetails","setOutputDetails","CropPanel","currentResource","isActionCoolingDown","setIsActionCoolingDown","cropDetails","setCropDetails","getCropStatusText","DecoPanel","setResourceDetails","availableResource","handleAddToSlot","getSlotConfig","selectedSlotIndex","transactionKeyPrefix","aResource","bResource","slotConfig","maxAmount","onBuyItem","settlementPlayers","setSettlementPlayers","playerTradeStalls","setPlayerTradeStalls","setResourceData","isLoading","setIsLoading","tradeStallPromises","tradeStallResults","tradeStallsData","fetchGlobalMarketData","playersWithItems","slot","availableSlots","slotIndex","actualSlotIndex","totalCost","handleBuyItem","tradeSlots","setTradeSlots","setSelectedSlotIndex","totalSellValue","setTotalSellValue","isLoadingInitial","setIsLoadingInitial","isGlobalMarketOpen","setIsGlobalMarketOpen","tradeStallSlotConfig","tradeStallSlots","sellWaitTime","unlocked","unlockCost","requiresGoldPass","isSlotUnlocked","fetchDataForViewedPlayer","skipInventoryFetch","currentInventoryResponse","serverSlots","allSlots","existingSlot","sellTime","boughtFor","wheatItem","performAddToSlot","updatedSlots","refreshedInventory","calculateTotalSellValue","slots","borderTop","isEmpty","isPurchased","isReadyToSell","hasTimer","slotUnlocked","handleSlotClick","handleCollectPayment","sold","handleSellSingle","tempRecipe","handleUnlockSlot","TradingInventoryModal","resourceInInventory","inventoryAmount","plotResource","finalAmount","GlobalMarketModal","latestSlots","currentSlot","Outpost","setMasterResources","_globalTuning$tradeSt","initSlots","sellerUsername","sellerId","outpostTradeStall","isOwnItem","handleSellToGame","buyerId","buyerUsername","resourceInBackpack","backpackAmount","templates","setTemplates","markedReadIds","setMarkedReadIds","visibleMessages","setVisibleMessages","freshMessages","unreadMessages","fetchTemplatesAndMessages","renderRewards","handleClose","messageIndex","collectedItems","_currentPlayer$messag","deleteMessage","seasons","setSeasons","seasonData","setSeasonData","richestCitizens","setRichestCitizens","secondsLeft","setSecondsLeft","storedTimers","fetchSeasons","diff","_response$data2$seaso","seasonLog","seasonlog","currentSeasonNumber","seasonNumber","lastSeason","seasonnumber","winners","seasonwinners","networth","fetchSeasonWinners","currentIndex","seasonType","previousIndex","previousSeason","settlementName","setSettlementName","electionTimer","setElectionTimer","formatOffers","fetchTownData","_frontierResponse$dat","_storedTimers$bank","_storedTimers$train","_storedTimers$electio","_storedTimers$train2","_storedTimers$electio2","_storedTimers$bank2","_settlementMap","topCitizens","setTopCitizens","topSettlementName","setTopSettlementName","seasonCycle","setSeasonCycle","highestWealth","setHighestWealth","settlementMap","setSettlementMap","getSeasonData","fetchSeasonCycle","settlementWealthMap","totalNetWorth","leadingSettlementId","leadingSettlementName","leadingSettlementPopulation","matching","topPlayers","fetchTopCitizensAndSettlement","_seasonCycle$nextInde","nextIndex","getNextSeason","handleShowSeasonRules","rulesContent","paddingRight","citizen","seasonLogTable","seasontype","winningsettlement","gridsreset","playersrelocated","SocialPanel","tentCount","setTentCount","boatCount","setBoatCount","setIsCamping","setIsInBoat","displayedPCData","setDisplayedPCData","latestData","_currentPlayer$backpa3","_currentPlayer$backpa4","tentsInBackpack","boatsInBackpack","fakeRecipe","handlePitchTent","handleGetInBoat","CombatPanel","_currentPlayer$powers3","playerStats","setPlayerStats","canChangeEquipment","stats","getPlayerStats","getStatBreakdown","stat","basePropertyName","modifier","refreshCombatStatsWithPlayer","_playerData$settings","_playerData$settings2","baseStats","powerBonuses","finalStats","currentPCStats","pcPosition","handleRefreshCombatStats","isEquipped","getEquippedArmor","armorType","handleEquipArmor","statIndex","getEquippedWeapon","weaponType","handleEquipWeapon","shareToNetwork","network","shareUrl","readOnly","copyToClipboard","clipboard","writeText","CowboyAnimation","setTargetPosition","setDuration","moveToNewPosition","newX","newY","actualDistance","userSelect","_timers$seasons2","_timers$seasons4","_playersInGrid$gridId14","_playersInGrid$gridId15","_playersInGrid$gridId16","_playersInGrid$gridId17","_playersInGrid$gridId18","_playersInGrid$gridId19","_playersInGrid$gridId20","_playersInGrid$gridId21","_playersInGrid$gridId22","_playersInGrid$gridId23","_currentPlayer$locati20","_currentPlayer$locati21","_timers$seasons5","_timers$seasons6","trace","_appEl$innerHTML","appEl","setUseCanvasResources","setUseCanvasNPCs","setUseCanvasPCs","setUseCanvasDynamicElements","serverPreviouslyDown","_storedTimers","_storedTimers$seasons","serverPhase","setIsOffSeason","checkInitialSeasonPhase","setIsMasterResourcesReady","setMasterSkills","setMasterWarehouse","setGlobalTuning","setMasterInteractions","setMasterTraders","setMasterTrophies","cleanedResources","invalidCrops","cleanedRes","TILE_SIZES","closer","far","activeTileSize","_playersInGrid$gridId3","playerIdStr","lastShownFTUEStep","setLastShownFTUEStep","setPlayerPosition","isLoginPanelOpen","setisLoginPanelOpen","activeQuestGiver","activeSocialPC","setActiveSocialPC","activeStation","showShareModal","setShowShareModal","showFTUE","setShowFTUE","setShowKeyArt","handleNPCPanel","handlePCClick","isSocketConnected","connectedPlayers","chatMessages","setChatMessages","chat","store","memoizedGrid","memoizedTileTypes","memoizedResources","showKeyArt","isAppInitialized","setIsAppInitialized","__vvgame_connect_listener","connectListener","cleanupBadges","_DBPlayerData$locatio","_updatedPlayerData","_parsedPlayer$locatio","_freshPCState$playerI","_DBPlayerData$locatio2","_gridPlayer$position","_gridPlayer$position2","_updatedPlayerData$se","globalTuningData","interactions","traders","storedPlayer","parsedPlayer","storedGridId","resolvedGridId","isDev","initialGridId","freshNPCState","isLocationMismatch","isMissingFromGrid","hasDied","storedBadges","stored","getBadgeState","initializeAppWrapper","_cleanupBadges","currentGridNPCs","_Object$values$0$posi","_Object$values$0$posi2","_playersInGrid$gridId4","_playersInGrid$gridId5","_playerPC$position","_playerPC$position2","onTileType","targetLocation","updatedLocation","restoredHp","properMaxHp","maxhpModifier","filteredBackpack","originalLocation","handlePlayerDeath","lavaDamage","_playersInGrid$gridId6","_playersInGrid$gridId7","_playerPC$position3","_playerPC$position4","healing","taxes","countdowns","setCountdowns","fetchTimersData","initializeTimers","_frontierData$seasons","_frontierData$seasons2","_frontierData$seasons3","_frontierData$electio","_frontierData$electio2","_frontierData$train","_frontierData$train2","_frontierData$carniva","_frontierData$carniva2","_frontierData$taxes","_frontierData$taxes2","_frontierData$bank","_frontierData$bank2","updatedTimers","updateCountdowns","_timers$seasons","_timers$elections","_timers$train","_timers$carnival","_timers$taxes","_timers$bank","shouldFetchNewTimers","_JSON$parse","_JSON$parse$seasons","previousPhaseRef","_timers$seasons3","currentPhase","handleMovementKeyDown","handleMovementKeyUp","isFriend","alwaysBlocked","isForbiddenStation","isSafe","_currentPlayer$settin4","farmHouse","finally","lastActivity","REFRESH_TIMEOUT","updateActivity","checkStaleness","inactiveTime","visibilityState","showTimers","setShowTimers","showStats","setShowStats","isChatOpen","setIsChatOpen","isChatClosing","setIsChatClosing","_NPCsInGrid$gridId2","Chat","handleCloseChat","_playersInGrid$gridId8","_playersInGrid$gridId9","_playersInGrid$gridId10","zoomOut","_playersInGrid$gridId11","_playersInGrid$gridId12","_playersInGrid$gridId13","_currentPlayer$locati15","_currentPlayer$locati16","_currentPlayer$locati17","_currentPlayer$locati18","_currentPlayer$locati19","SettlementView","FrontierView","ShareModal","FTUE","Mailbox","TownNews","Store","OffSeasonModal","ProfilePanel","LoginPanel","handleLoginSuccess","DebugPanel","InventoryPanel","WarehousePanel","TrophyPanel","BankPanel","KentPanel","TrainPanel","NewTrainPanel","CarnivalPanel","HowToPanel","HowToMoneyPanel","HowToGemsPanel","GoldBenefitsPanel","GovPanel","CourthousePanel","QuestPanel","_activeStation$positi","_activeStation$positi2","TradeStall","SeasonPanel","inset","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","__app_initialized__","cachedLanguage","savedPlayer","savedLanguage","rootEl","__root_created__","__root","__app_rendered__","App","reportWebVitals"],"sourceRoot":""}