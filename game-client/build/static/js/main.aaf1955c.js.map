{"version":3,"file":"static/js/main.aaf1955c.js","mappings":"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","sources":["GameFeatures/NPCs/NPCGrazeBehavior.js","GameFeatures/NPCs/NPCQuestBehavior.js","GameFeatures/NPCs/NPCEnemyBehavior.js","GameFeatures/NPCs/NPCHealBehavior.js","GameFeatures/NPCs/NPCSpawnerBehavior.js","GameFeatures/NPCs/NPCWorkerBehavior.js","GameFeatures/NPCs/NPCTraderBehavior.js","GameFeatures/NPCs/AllNPCsShared.js","UI/StringsContext.js","../node_modules/react/index.js","PlayerMovement.js","Utils/TuningManager.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/cjs/react.production.min.js","../node_modules/axios/lib/helpers/bind.js","../node_modules/axios/lib/utils.js","../node_modules/axios/lib/core/AxiosError.js","../node_modules/axios/lib/helpers/toFormData.js","../node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../node_modules/axios/lib/helpers/buildURL.js","../node_modules/axios/lib/core/InterceptorManager.js","../node_modules/axios/lib/defaults/transitional.js","../node_modules/axios/lib/platform/browser/index.js","../node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../node_modules/axios/lib/platform/browser/classes/FormData.js","../node_modules/axios/lib/platform/browser/classes/Blob.js","../node_modules/axios/lib/platform/common/utils.js","../node_modules/axios/lib/platform/index.js","../node_modules/axios/lib/helpers/formDataToJSON.js","../node_modules/axios/lib/defaults/index.js","../node_modules/axios/lib/helpers/toURLEncodedForm.js","../node_modules/axios/lib/helpers/parseHeaders.js","../node_modules/axios/lib/core/AxiosHeaders.js","../node_modules/axios/lib/core/transformData.js","../node_modules/axios/lib/cancel/isCancel.js","../node_modules/axios/lib/cancel/CanceledError.js","../node_modules/axios/lib/core/settle.js","../node_modules/axios/lib/helpers/speedometer.js","../node_modules/axios/lib/helpers/throttle.js","../node_modules/axios/lib/helpers/progressEventReducer.js","../node_modules/axios/lib/helpers/isURLSameOrigin.js","../node_modules/axios/lib/helpers/cookies.js","../node_modules/axios/lib/core/buildFullPath.js","../node_modules/axios/lib/helpers/isAbsoluteURL.js","../node_modules/axios/lib/helpers/combineURLs.js","../node_modules/axios/lib/core/mergeConfig.js","../node_modules/axios/lib/helpers/resolveConfig.js","../node_modules/axios/lib/adapters/xhr.js","../node_modules/axios/lib/helpers/parseProtocol.js","../node_modules/axios/lib/helpers/composeSignals.js","../node_modules/axios/lib/helpers/trackStream.js","../node_modules/axios/lib/adapters/fetch.js","../node_modules/axios/lib/adapters/adapters.js","../node_modules/axios/lib/helpers/null.js","../node_modules/axios/lib/core/dispatchRequest.js","../node_modules/axios/lib/env/data.js","../node_modules/axios/lib/helpers/validator.js","../node_modules/axios/lib/core/Axios.js","../node_modules/axios/lib/cancel/CancelToken.js","../node_modules/axios/lib/helpers/HttpStatusCode.js","../node_modules/axios/lib/axios.js","../node_modules/axios/lib/helpers/spread.js","../node_modules/axios/lib/helpers/isAxiosError.js","../node_modules/scheduler/cjs/scheduler.production.min.js","VFX/VFX.js","GameFeatures/BuildAndBuy.js","GameFeatures/Quests/QuestGoalTracker.js","GameFeatures/Trophies/TrophyUtils.js","GameFeatures/FTUE/FTUEutils.js","Render/SVGAssetManager.js","../node_modules/react-dom/client.js","GridState/PlayersInGrid.js","UI/Panels/PanelContext.js","Utils/stringLookup.js","config.js","Render/RenderAnimatePosition.js","GameFeatures/Farming/Farming.js","../node_modules/react/jsx-runtime.js","Utils/LocationChangeManager.js","Utils/GridManagement.js","Utils/worldHelpers.js","../node_modules/engine.io-parser/build/esm/commons.js","../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../node_modules/engine.io-parser/build/esm/index.js","../node_modules/@socket.io/component-emitter/lib/esm/index.js","../node_modules/engine.io-client/build/esm/globals.js","../node_modules/engine.io-client/build/esm/util.js","../node_modules/engine.io-client/build/esm/transport.js","../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../node_modules/engine.io-client/build/esm/transports/polling.js","../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../node_modules/engine.io-client/build/esm/transports/polling-xhr.js","../node_modules/engine.io-client/build/esm/transports/websocket.js","../node_modules/engine.io-client/build/esm/transports/index.js","../node_modules/engine.io-client/build/esm/transports/webtransport.js","../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../node_modules/engine.io-client/build/esm/socket.js","../node_modules/socket.io-parser/build/esm/is-binary.js","../node_modules/socket.io-parser/build/esm/binary.js","../node_modules/socket.io-parser/build/esm/index.js","../node_modules/socket.io-client/build/esm/on.js","../node_modules/socket.io-client/build/esm/socket.js","../node_modules/socket.io-client/build/esm/contrib/backo2.js","../node_modules/socket.io-client/build/esm/manager.js","../node_modules/socket.io-client/build/esm/index.js","../node_modules/socket.io-client/build/esm/url.js","socketManager.js","GridState/GridStateNPCs.js","Utils/InventoryManagement.js","GameFeatures/Transit/transitConfig.js","GameFeatures/Transit/Transit.js","../node_modules/react-dom/cjs/react-dom.production.min.js","Utils/gridsVisitedUtils.js","Utils/ResourceHelpers.js","GridState/GlobalGridStateTilesAndResources.js","../node_modules/scheduler/index.js","FarmState.js","UI/Notifications/Notifications.js","UI/FloatingText.js","../node_modules/react-dom/index.js","AppInit.js","../webpack/bootstrap","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/load script","../webpack/runtime/make namespace object","../webpack/runtime/publicPath","../webpack/runtime/jsonp chunk loading","Utils/appUtils.js","GameFeatures/Chat/Chat.js","UI/Styles/tileColors.js","Render/RenderTilesCanvas.js","Render/RenderTilesCanvasV2.js","Utils/ResourceOverlayUtils.js","Render/RenderResourcesCanvas.js","Render/RenderResources.js","GameFeatures/Combat/Combat.js","GameFeatures/NPCs/NPCUtils.js","UI/Panels/Panel.js","UI/Buttons/TransactionButton.js","GameFeatures/FarmAnimals/FarmAnimals.js","UI/StatusBar/CollectionFormatters.js","GameFeatures/NPCs/NPCInteractionUtils.js","Utils/CursorUtils.js","Utils/TooltipUtils.js","GameFeatures/Relationships/ConversationManager.js","Render/RenderNPCsCanvas.js","Render/RenderNPCs.js","Render/PCComponent.js","Render/RenderPCsDOM.js","Render/RenderPCs.js","Render/RenderDynamicElementsCanvas.js","Utils/QuestCache.js","Render/RenderDynamicElements.js","Render/CursorTileHighlight.js","Utils/ResourceLockManager.js","Utils/WarehouseMaterials.js","Economy/DropRates.js","ResourceClicking.js","UI/UILockContext.js","UI/Modals/StoryModal.js","GameFeatures/FTUE/FTUE.js","GameFeatures/FTUE/FTUEDoinker.js","GridState/GridStatePCContext.js","GridState/GridStateContext.js","GridState/NPCController.js","UI/StatusBar/StatusBar.js","UI/BulkOperationContext.js","ZoomedOut/ZoomedOut.js","ZoomedOut/RenderVisitedGrid.js","ZoomedOut/SettlementView.js","Utils/Relocation.js","ZoomedOut/FrontierView.js","ZoomedOut/FrontierMiniMap.js","UI/Modals/Modal.js","../node_modules/@stripe/stripe-js/dist/index.mjs","Store/Store.js","UI/Modals/RevivalModal.js","UI/Modals/LevelUpModal.js","UI/Modals/LanguagePickerModal.js","GameFeatures/Government/GovUtils.js","Utils/playerManagement.js","UI/Modals/ChangeIconModal.js","Authentication/ChangeIcon.js","UI/Modals/GoldPassBenefitsModal.js","settings.js","UI/ModalContext.js","Authentication/ProfilePanel.js","Utils/conversionTracking.js","Authentication/CreateAccount.js","Authentication/LoginPanel.js","Utils/GridStateDebug.js","Utils/debug.js","Utils/WorldGeneration.js","GameFeatures/Inventory/ManageContentsModal.js","GameFeatures/Inventory/InventoryPanel.js","Economy/GemCosts.js","UI/Buttons/ResourceButton.js","GameFeatures/Inventory/WarehousePanel.js","GameFeatures/Trophies/TrophyPanel.js","UI/Panels/HowToPanel.js","UI/Panels/HowToMoneyPanel.js","UI/Panels/HowToGemsPanel.js","UI/Buttons/QuestButton.js","GameFeatures/Quests/QuestPanel.js","GameFeatures/Relationships/RelationshipUtils.js","GameFeatures/Relationships/Conversation.js","GameFeatures/Relationships/RelationshipCard.js","GameFeatures/NPCs/HealerInteraction.js","GameFeatures/NPCs/NPCsPanel.js","GameFeatures/Build/BuildPanel.js","GameFeatures/Buy/BuyPanel.js","GameFeatures/Pets/PetsPanel.js","GameFeatures/Deco/BuyDecoPanel.js","UI/Timers.js","GameFeatures/Farming/FarmingPanel.js","GameFeatures/Farming/ToolsPanel.js","Utils/ProtectedSelling.js","GameFeatures/Skills/SkillsPanel.js","Utils/PopulationUtils.js","GameFeatures/Government/GovPanel.js","GameFeatures/Social/HopeQuest.js","GameFeatures/Leaderboard/Leaderboard.js","UI/Panels/LevelLock.js","GameFeatures/Trading/Bank.js","GameFeatures/Trading/KentOfferLogic.js","GameFeatures/Trading/Kent.js","GameFeatures/Trading/TrainOfferLogic.js","GameFeatures/Trading/NewTrain.js","GameFeatures/Carnival/Carnival.js","GameFeatures/Government/Courthouse.js","Economy/EconomyUtils.js","GameFeatures/Crafting/CraftingStation.js","GameFeatures/Crafting/FarmHouse.js","UI/Modals/ProgressModal.js","UI/NPCOverlayContext.js","GameFeatures/FarmHands/BulkHarvest.js","GameFeatures/FarmHands/BulkHarvestUtils.js","GameFeatures/FarmHands/BulkHarvestResultsModal.js","GameFeatures/FarmHands/BulkAnimalCollect.js","GameFeatures/FarmHands/BulkCrafting.js","GameFeatures/FarmHands/FarmHand.js","GameFeatures/Crafting/ShopStation.js","GameFeatures/Crafting/ScrollStation.js","Utils/SkillPowerManagement.js","GameFeatures/Crafting/ScrollReveal.js","GameFeatures/Pets/PetPanel.js","GameFeatures/FarmAnimals/AnimalStall.js","GameFeatures/Farming/CropPanel.js","GameFeatures/Deco/DecoPanel.js","UI/Modals/TradingInventoryModal.js","GameFeatures/Trading/GlobalMarketModal.js","GameFeatures/Trading/TradeStall.js","GameFeatures/Trading/Outpost.js","GameFeatures/Mailbox/Mailbox.js","GameFeatures/Seasons/OffSeasonModal.js","UI/Modals/TownNews.js","GameFeatures/Seasons/SeasonPanel.js","GameFeatures/Eating/Eating.js","GameFeatures/Social/PlayerPanel.js","GameFeatures/Social/SocialPanel.js","GameFeatures/Combat/CombatPanel.js","UI/Panels/GoldBenefitsPanel.js","Utils/share.js","UI/Modals/ShareModal.js","UI/StartScreenAnimation.js","UI/TransitionOverlay.js","UI/useTransitionFade.js","Redirect.js","App.js","reportWebVitals.js","index.js"],"sourcesContent":["import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\n// Behavior handler for farm animals (e.g., cows)\nasync function handleFarmAnimalBehavior(gridId) {\n    // Helper for updating just this NPC\n    const updateThisNPC = async () => {\n        // console.log(`[SAVE] NPC ${this.id}: Updating state to '${this.state}' at position (${this.position.x}, ${this.position.y})`);\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            grazeEnd: this.grazeEnd,\n            position: this.position,\n      });\n    };\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleFarmAnimalBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n    \n    // IMPORTANT: If NPC is in processing state, don't allow any state transitions except to emptystall\n    if (this.state === 'processing') {\n        // Only log periodically to avoid spam\n        if (!this.lastProcessingLog || Date.now() - this.lastProcessingLog > 5000) {\n            //console.log(` NPC ${this.id} is in processing state, waiting for collection. GrazeEnd: ${this.grazeEnd}`);\n            this.lastProcessingLog = Date.now();\n        }\n        return; // Exit early, don't process any state transitions\n    }\n\n    switch (this.state) {\n        case 'idle': {\n//            console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            const idleCompleted = await this.handleIdleState(tiles, resources, npcs, 4, async () => {\n//              console.log(` Retrying after idle for NPC ${this.id}`);\n              // Check if we have grazeEnd to determine next state\n              if (this.grazeEnd && Date.now() >= this.grazeEnd) {\n                this.state = 'stall';\n              } else {\n                this.state = 'hungry';\n              }\n              await updateThisNPC();\n            });\n          \n            if (!idleCompleted) {\n              // Don't continue state processing if we're still idling\n              return;\n            }\n          \n            // If idle completed and `onTransition` fired, the state is now \"stall\"\n            break;\n          }\n\n        case 'hungry': {\n            //console.log(`NPC ${this.id} is in HUNGRY state.`);\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n\n            const currentTime = Date.now();\n            if (this.grazeEnd && currentTime >= this.grazeEnd) {\n                console.log(` Grazing already done  NPC ${this.id} skipping hungry.`);\n                this.state = 'stall';\n                await updateThisNPC();\n                break;\n            }\n\n            //console.log(\"this.targetGrassTile = \", this.targetGrassTile);\n\n            // Find the target grass tile if not already set\n            if (!this.targetGrassTile) {\n                //console.log(`NPC ${this.id} finding nearest grass tile.`);\n                \n                // Determine which tile type to look for based on NPC type\n                const targetTileType = this.type === 'Pig' ? 'd' : 'g'; // Pigs graze on dirt, others on grass\n                \n                // Find all grass/dirt tiles within range\n                const grassTiles = await this.findTileInRange(targetTileType, tiles, resources);\n        \n                if (!Array.isArray(grassTiles) || grassTiles.length === 0) {\n                    const tileTypeName = targetTileType === 'd' ? 'dirt' : 'grass';\n                    console.warn(`No ${tileTypeName} tiles found for NPC ${this.id}. Transitioning to idle.`);\n                    this.state = 'idle'; // Fallback to idle if no valid tiles\n                    break;\n                }\n        \n                // Filter out occupied grass tiles (by resources or other grazing animals)\n                const unoccupiedGrassTiles = grassTiles.filter((tile) => {\n                    // Check if occupied by a resource\n                    if (resources.some((res) => res.x === tile.x && res.y === tile.y)) {\n                        return false;\n                    }\n                    // Check if occupied by another grazing animal\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === tile.x &&\n                        Math.floor(npc.position?.y) === tile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        //console.log(`Grass tile at (${tile.x}, ${tile.y}) is occupied by another animal, skipping`);\n                        return false;\n                    }\n                    return true;\n                });\n        \n                if (unoccupiedGrassTiles.length === 0) {\n                    const tileTypeName = targetTileType === 'd' ? 'dirt' : 'grass';\n                    console.warn(`No unoccupied ${tileTypeName} tiles found for NPC ${this.id}. Transitioning to idle.`);\n                    this.state = 'idle'; // Fallback to idle if no valid tiles\n                    break;\n                }\n        \n                // Sort tiles by distance and select the closest\n                unoccupiedGrassTiles.sort(\n                    (a, b) => calculateDistance(this.position, a) - calculateDistance(this.position, b)\n                );\n                this.targetGrassTile = unoccupiedGrassTiles[0];\n                //console.log(`NPC ${this.id} selected grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}).`);\n            }\n        \n            // Attempt to move toward the target grass tile\n            if (this.targetGrassTile && \n                typeof this.targetGrassTile.x === 'number' && \n                typeof this.targetGrassTile.y === 'number') \n            {\n                const dx = this.targetGrassTile.x - Math.floor(this.position.x);\n                const dy = this.targetGrassTile.y - Math.floor(this.position.y);\n                //console.log(`NPC ${this.id} movement vector: dx=${dx}, dy=${dy}, current position=(${this.position.x}, ${this.position.y}), target=(${this.targetGrassTile.x}, ${this.targetGrassTile.y})`);\n        \n                let direction = null;\n        \n                // Explicitly handle when dx and dy are both 0 (already at the target)\n                if (dx === 0 && dy === 0) {\n                    // Before transitioning to grazing, check if another animal has moved onto our target\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === this.targetGrassTile.x &&\n                        Math.floor(npc.position?.y) === this.targetGrassTile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        console.warn(`Another animal took our target grass tile! Finding new one.`);\n                        this.targetGrassTile = null;\n                        break; // Stay in hungry state and find new tile next update\n                    }\n                   // console.log(`NPC ${this.id} is already at the target grazing tile. Transitioning to grazing.`);\n                    this.state = 'grazing'; // Transition to grazing\n                    this.targetGrassTile = null; // Clear the target\n                    await updateThisNPC(); // Save after transition\n                    break;\n                }\n        \n                // Prioritize diagonal movement if dx and dy are both non-zero\n                if (dx > 0 && dy > 0) direction = 'SE';\n                else if (dx > 0 && dy < 0) direction = 'NE';\n                else if (dx < 0 && dy > 0) direction = 'SW';\n                else if (dx < 0 && dy < 0) direction = 'NW';\n                else if (dx > 0) direction = 'E';\n                else if (dx < 0) direction = 'W';\n                else if (dy > 0) direction = 'S';\n                else if (dy < 0) direction = 'N';\n        \n                //console.log(`NPC ${this.id} determined direction: ${direction}`);\n        \n                if (!direction) {\n                    console.warn(`NPC ${this.id} could not determine direction to grass tile.`);\n                    this.state = 'idle';\n                    this.targetGrassTile = null;\n                    break;\n                }\n        \n                if (!this.isMoving) {\n                    //console.log(`NPC ${this.id} moving one tile toward grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}).`);\n                    this.isMoving = true;\n                    const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n        \n                    // Ensure position snaps to integers after movement\n                    this.position.x = Math.floor(this.position.x);\n                    this.position.y = Math.floor(this.position.y);\n                    this.isMoving = false;\n                    if (!moved) {\n                        console.warn(`NPC ${this.id} is stuck and cannot move toward the grass. Switching to idle.`);\n                        this.targetGrassTile = null;\n                        this.state = 'idle';\n                        await updateThisNPC(); //  Save failure state\n                        break;\n                      }\n                }\n        \n                // Check if NPC has reached the grass tile\n                if (\n                    this.targetGrassTile &&\n                    Math.floor(this.position.x) === this.targetGrassTile.x &&\n                    Math.floor(this.position.y) === this.targetGrassTile.y\n                ) {\n                    // Before transitioning to grazing, check if another animal has moved onto our target\n                    const otherAnimalOnTile = npcs.some(npc => \n                        npc.id !== this.id &&\n                        npc.action === 'graze' &&\n                        Math.floor(npc.position?.x) === this.targetGrassTile.x &&\n                        Math.floor(npc.position?.y) === this.targetGrassTile.y\n                    );\n                    if (otherAnimalOnTile) {\n                        console.warn(`Another animal took our target grass tile! Finding new one.`);\n                        this.targetGrassTile = null;\n                        // Don't transition to grazing, stay hungry and find new tile\n                    } else {\n                        //console.log(`NPC ${this.id} has reached the grass tile at (${this.targetGrassTile.x}, ${this.targetGrassTile.y}). Transitioning to grazing.`);\n                        this.state = 'grazing'; // Transition to grazing\n                        this.targetGrassTile = null; // Clear the target\n                        await updateThisNPC(); // Save after transition\n                    }\n                }\n            }\n            else {\n                    console.warn(` [Hungry] NPC ${this.id} has invalid targetGrassTile. Roaming to unstuck.`);\n                    this.targetGrassTile = null;\n                    this.state = 'roam';\n                    await updateThisNPC();\n                    break;\n            }\n            break;\n        }\n \n          \n        case 'grazing': {\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n            const currentTime = Date.now();\n        \n            //console.log(`grazeEnd: ${this.grazeEnd}, growTime: ${this.growTime}, type: ${this.type}`);\n\n            if (!this.grazeEnd) {\n                this.grazeEnd = currentTime + (this.growTime * 1000); // Calculate grazing end time\n                //console.log('in state = grazing; setting grazeEnd: ',this.grazeEnd);\n                await updateThisNPC();\n            }\n            \n            //  Check if grazing is complete\n            if (currentTime >= this.grazeEnd) {\n                //console.log(` NPC ${this.id} finished grazing. Moving to stall.`);\n                //  Transition to stall\n                this.state = 'stall';\n                await updateThisNPC();\n            }\n            break;\n        }\n\n\n        case 'stall': {\n            //console.log(` [STATE] NPC ${this.id} entering state: ${this.state} grazeEnd: ${this.grazeEnd}`);\n            const fullGridState = NPCsInGridManager.getNPCsInGrid(gridId);\n            \n            // Initialize retry counter and failed stalls list\n            if (!this.stallRetries) this.stallRetries = 0;\n            if (!this.failedStalls) this.failedStalls = [];\n    \n            // Step 1: If no stall is currently assigned, find the nearest available stall\n            if (!this.targetStall) {\n                //console.log(`NPC ${this.id} finding nearest stall.`);\n                this.targetStall = this.findNearestResource('stall', tiles, resources, this.failedStalls);\n                if (!this.targetStall) {\n                    console.log('No availalbe stall, returning to idle.');\n                    this.state = 'idle';\n                    this.stallRetries = 0;\n                    this.failedStalls = [];\n                    break;\n                }\n            }\n        \n            // Step 5: Confirm the stall is still valid before proceeding\n            const stallResource = resources.find(\n                (res) => res.x === this.targetStall.x && res.y === this.targetStall.y\n            );\n            if (!stallResource) {\n                console.warn(`Target stall at (${this.targetStall.x}, ${this.targetStall.y}) is no longer valid. Transitioning to idle.`);\n                this.state = 'idle';\n                this.targetStall = null;\n                break;\n            }\n        \n            // Step 6: Calculate movement direction towards the stall\n            const dx = this.targetStall.x - Math.floor(this.position.x);\n            const dy = this.targetStall.y - Math.floor(this.position.y);\n            let direction = null;\n        \n            //  Prefer diagonals if both dx and dy are non-zero\n            if (dx !== 0 && dy !== 0) {\n                if (dx > 0 && dy > 0) direction = 'SE';\n                else if (dx > 0 && dy < 0) direction = 'NE';\n                else if (dx < 0 && dy > 0) direction = 'SW';\n                else if (dx < 0 && dy < 0) direction = 'NW';\n            } else if (dx !== 0) {\n                direction = dx > 0 ? 'E' : 'W';\n            } else if (dy !== 0) {\n                direction = dy > 0 ? 'S' : 'N';\n            }\n        \n            // Step 7: If a valid movement direction isn't determined, revert to idle state\n            if (!direction &&\n                (   Math.floor(this.position.x) !== this.targetStall.x &&\n                    Math.floor(this.position.y) !== this.targetStall.y )\n                ) {\n                    console.warn(`NPC ${this.id} could not determine direction to stall.`);\n                    this.state = 'idle';\n                    this.targetStall = null;\n                    break;\n                }\n        \n            // Step 8: Move the NPC one tile towards the stall\n            if (!this.isMoving) {\n                this.isMoving = true;\n                const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n                this.position.x = Math.floor(this.position.x);\n                this.position.y = Math.floor(this.position.y);\n                this.isMoving = false;\n                \n                if (!moved) {\n                    this.stallRetries++;\n                    \n                    if (this.stallRetries < 5) {\n                        // Try a different direction or wait\n                        //console.log(`NPC ${this.id} blocked, retry ${this.stallRetries}/5`);\n                    } else {\n                        // Add this stall to failed list and try another\n                        console.warn(`NPC ${this.id} cannot reach stall at (${this.targetStall.x}, ${this.targetStall.y}). Trying alternative.`);\n                        if (!this.failedStalls) this.failedStalls = [];\n                        this.failedStalls.push({ x: this.targetStall.x, y: this.targetStall.y });\n                        this.targetStall = null;\n                        this.stallRetries = 0;\n                        \n                        // Try to find another stall\n                        const alternativeStall = this.findNearestResource('stall', tiles, resources, this.failedStalls);\n                        if (!alternativeStall) {\n                            //console.log('No alternative stalls available, returning to idle.');\n                            this.state = 'idle';\n                            this.failedStalls = [];\n                            this.triedStall = true;\n                        }\n                    }\n                    await updateThisNPC(); //  Save state\n                    break;\n                }\n                \n                await updateThisNPC(); //  Save successful movement\n                }\n        \n            // Step 9: If NPC reaches the stall, transition to processing state\n            const atStall = Math.floor(this.position.x) === this.targetStall.x &&\n                           Math.floor(this.position.y) === this.targetStall.y;\n            const nearStall = Math.abs(Math.floor(this.position.x) - this.targetStall.x) <= 1 &&\n                             Math.abs(Math.floor(this.position.y) - this.targetStall.y) <= 1;\n            \n            // Accept being adjacent to stall if we've tried multiple times\n            if (atStall || (nearStall && this.stallRetries > 2)) {\n            \n                // Check if another animal is already at this position\n                const otherNPCsAtStall = Object.values(fullGridState || {}).filter(otherNpc => \n                    otherNpc.id !== this.id &&\n                    Math.floor(otherNpc.position?.x) === this.targetStall.x &&\n                    Math.floor(otherNpc.position?.y) === this.targetStall.y &&\n                    otherNpc.action === 'graze'\n                );\n                \n                console.log(` NPC ${this.id} reached stall at (${this.targetStall.x}, ${this.targetStall.y}). Other animals at same position: ${otherNPCsAtStall.length}`);\n                \n                if (otherNPCsAtStall.length > 0) {\n                    console.log(` Stall is occupied! Adding to failed list and trying another.`);\n                    if (!this.failedStalls) this.failedStalls = [];\n                    this.failedStalls.push({ x: this.targetStall.x, y: this.targetStall.y });\n                    this.targetStall = null;\n                    this.stallRetries = 0;\n                    // Don't transition to processing - stay in stall state to find another\n                    await updateThisNPC();\n                    break;\n                }\n                \n                //  Keep grazeEnd for server validation - it will be cleared after successful collection\n                // Allow multiple animals to be in processing state at the same stall\n                this.state = 'processing';\n                console.log(` NPC ${this.id} transitioning to processing state. GrazeEnd: ${this.grazeEnd}`);\n                \n                // Save the state change immediately and wait for confirmation\n                try {\n                    await updateThisNPC();\n                    console.log(` NPC ${this.id} state update to 'processing' sent to server`);\n                    \n                    // Wait longer for the update to propagate to the server\n                    await new Promise(resolve => setTimeout(resolve, 500));\n                    \n                    // Verify the update was successful\n                    const updatedNPC = NPCsInGridManager.getNPCsInGrid(gridId)?.[this.id];\n                    if (updatedNPC && updatedNPC.state !== 'processing') {\n                        console.error(` State update verification failed! NPC ${this.id} state is ${updatedNPC.state} instead of 'processing'`);\n                        // Try to update again with longer wait\n                        this.state = 'processing';\n                        await updateThisNPC();\n                        console.log(` Retried state update for NPC ${this.id}`);\n                        await new Promise(resolve => setTimeout(resolve, 500));\n                    } else {\n                        console.log(` Verified NPC ${this.id} is in processing state`);\n                    }\n                } catch (error) {\n                    console.error(` Failed to update NPC ${this.id} to processing state:`, error);\n                }\n                }\n\n            break;\n        }\n \n        case 'processing': {\n            // awaiting handleNPCClick\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            // console.log('Awaiting handleNPCClick');\n            // IMPORTANT: Don't transition out of processing state unless explicitly collected\n            if (this.grazeEnd && Date.now() >= this.grazeEnd) {\n                console.log(` NPC ${this.id} is in processing state and ready for collection. GrazeEnd: ${this.grazeEnd}`);\n                \n                // Check if the animal has been stuck in processing for too long (e.g., over 1 hour past grazeEnd)\n                const timeSinceGrazeEnd = Date.now() - this.grazeEnd;\n                if (timeSinceGrazeEnd > 3600000) { // 1 hour in milliseconds\n                    console.warn(` NPC ${this.id} has been in processing state for ${Math.floor(timeSinceGrazeEnd / 1000)} seconds. Resetting to emptystall.`);\n                    this.state = 'emptystall';\n                    await updateThisNPC();\n                }\n            }\n        break;\n        }\n\n        case 'emptystall': {\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            this.targetStall = null;\n            this.grazeEnd = null; // Clear grazeEnd so cow will go hungry after roaming\n            this.state = 'roam'; // Transition to roam state\n            await updateThisNPC(); // Save after transition\n            break;\n        }\n         \n        case 'roam': {\n\n            // console.log(` [STATE] NPC ${this.id} entering state: ${this.state}`);\n            await this.handleRoamState(tiles, resources, npcs, async () => {\n                //  This is your onTransition logic\n                if (!this.grazeEnd) {\n                  console.log(` NPC ${this.id} has no grazeEnd, transitioning to hungry.`);\n                  this.state = 'hungry';\n                } else {\n                  console.log(` NPC ${this.id} completed roam but grazing NOT done. Going idle.`);\n                  this.state = 'idle';\n                }\n                await updateThisNPC();\n              });\n\n            break;\n          }\n\n        default:\n            console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`);\n            break;\n    }\n}\n\n// Export a function to attach the behavior to the NPC class\nexport function attachGrazingBehavior(NPC) {\n    NPC.prototype.handleFarmAnimalBehavior = handleFarmAnimalBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { calculateDistance } from '../../Utils/worldHelpers';\nimport { isWallBlocking } from '../../Utils/GridManagement';\n\nasync function handleQuestGiverBehavior(gridId) {\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleQuestGiverBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Force state to roam if it's not already (one-time update)\n    if (this.state !== 'roam') {\n        this.state = 'roam';\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    }\n\n    // Check if this NPC is within any PC's range (respecting walls/doors)\n    const pcsInRange = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}).some(pc =>\n        calculateDistance(pc.position, this.position) <= (this.range || 3) &&\n        pc.hp > 0 &&\n        !isWallBlocking(this.position, pc.position)\n    );\n    \n    if (pcsInRange) {\n        // If players are in range, don't move (but stay in roam state)\n        // This creates the effect of the NPC stopping when players approach\n        return;\n    }\n    \n    // Always handle roam state - no more switching\n    await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n    });\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachQuestBehavior(NPC) {\n    NPC.prototype.handleQuestGiverBehavior = handleQuestGiverBehavior;\n}","import GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport FloatingTextManager from \"../../UI/FloatingText\";\n\n/** Helper to get tiles in line of sight between two points using Bresenham's algorithm **/\nfunction getLineOfSightTiles(start, end) {\n    const tiles = [];\n    let x0 = Math.floor(start.x);\n    let y0 = Math.floor(start.y);\n    const x1 = Math.floor(end.x);\n    const y1 = Math.floor(end.y);\n\n    const dx = Math.abs(x1 - x0);\n    const dy = Math.abs(y1 - y0);\n    const sx = x0 < x1 ? 1 : -1;\n    const sy = y0 < y1 ? 1 : -1;\n    let err = dx - dy;\n\n    let prevX = x0;\n    let prevY = y0;\n\n    while (true) {\n        // Don't include the start or end positions\n        if ((x0 !== Math.floor(start.x) || y0 !== Math.floor(start.y)) &&\n            (x0 !== x1 || y0 !== y1)) {\n            tiles.push({ x: x0, y: y0 });\n\n            // Check if we moved diagonally - if so, add the two adjacent tiles\n            // to prevent line of sight going through corners\n            if (prevX !== x0 && prevY !== y0) {\n                tiles.push({ x: prevX, y: y0 }); // Vertical neighbor of previous position\n                tiles.push({ x: x0, y: prevY }); // Horizontal neighbor of current position\n            }\n        }\n\n        if (x0 === x1 && y0 === y1) break;\n\n        prevX = x0;\n        prevY = y0;\n\n        const e2 = 2 * err;\n        if (e2 > -dy) {\n            err -= dy;\n            x0 += sx;\n        }\n        if (e2 < dx) {\n            err += dx;\n            y0 += sy;\n        }\n    }\n\n    return tiles;\n}\n\n/** Helper to check if a position falls within a wall's footprint **/\nfunction isWithinWallFootprint(x, y, wall) {\n    const range = wall.range || 1;\n    // For walls with range > 1, check if (x, y) falls within the footprint\n    // Wall footprint extends from anchor (wall.x, wall.y) down and right\n    return (\n        x >= wall.x &&\n        x < wall.x + range &&\n        y >= wall.y &&\n        y < wall.y + range\n    );\n}\n\n/** Helper to check if NPC can see the target (no walls blocking) **/\nfunction canSeeTarget(npcPosition, targetPosition) {\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const lineOfSightTiles = getLineOfSightTiles(npcPosition, targetPosition);\n\n    // Check each tile in the line of sight for walls or doors\n    for (const tile of lineOfSightTiles) {\n        // Check if this tile is blocked by any wall (including large walls)\n        const wall = resources.find(res =>\n            (res.action === 'wall' || res.action === 'door') &&\n            isWithinWallFootprint(tile.x, tile.y, res)\n        );\n        if (wall) {\n            return false; // Wall or door found blocking the view\n        }\n    }\n\n    return true; // Clear line of sight\n}\n\nconst updateThisNPC = async function(gridId) {\n  await NPCsInGridManager.updateNPC(gridId, this.id, {\n    state: this.state,\n    position: this.position,\n  });\n};\n\nasync function handleEnemyBehavior(gridId, TILE_SIZE) {\n  //console.log(` NPC ${this.id} handling enemy behavior on grid ${gridId}.`);\n  const tiles = GlobalGridStateTilesAndResources.getTiles();\n  const resources = GlobalGridStateTilesAndResources.getResources();\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const pcs = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}); // Get all PCs on the grid\n\n  // Force initial state to roam if not set\n  if (!this.state || this.state === 'idle') {\n    this.state = 'roam';\n    await updateThisNPC.call(this, gridId);\n  }\n \n  // Check for visible PCs at the start of any state (immediate reaction)\n  const visiblePCsInRange = pcs.filter(pc => {\n    if (pc.hp <= 0) return false;\n    const dist = getDistance(this.position, pc.position);\n    if (dist > this.range) return false;\n    return canSeeTarget(this.position, pc.position);\n  });\n  \n  // If we see a PC and we're not already pursuing/attacking, immediately react\n  if (visiblePCsInRange.length > 0 && this.state === 'roam') {\n    const targetPC = visiblePCsInRange[Math.floor(Math.random() * visiblePCsInRange.length)];\n    console.log(` NPC ${this.id} spotted PC ${targetPC.username}! Entering pursue state.`);\n    this.targetPC = targetPC;\n    this.state = 'pursue';\n    this.pursueTimerStart = null;\n    await updateThisNPC.call(this, gridId);\n    return; // Skip the rest of the state processing\n  }\n \n  switch (this.state) {\n\n    case 'idle': {\n      // Idle is ONLY used to get unstuck - always transitions to roam, never back to idle\n      this.pursueTimerStart = null; // Clear pursuit timer\n      await this.handleIdleState(tiles, resources, npcs, 2, async () => {\n        // After idle, always go to roam (never back to idle)\n        this.state = 'roam';\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n      });\n      break;\n    }\n\n    case 'pursue': {\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId); // Refresh position from latest state\n      if (!this.targetPC) {\n        //console.warn(`NPC ${this.id} lost its target. Returning to roam state.`);\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        await updateThisNPC.call(this, gridId); // Save after transition\n        break;\n      }\n      \n      // First check if we can still see the target at all\n      const canStillSeeTarget = canSeeTarget(this.position, this.targetPC.position);\n      if (!canStillSeeTarget) {\n        console.log(` NPC ${this.id} lost sight of ${this.targetPC?.username} during pursuit. Returning to roam.`);\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n      \n      // Check if already in attack range AND can see target before pursuing\n      const currentDistance = getDistance(this.position, this.targetPC.position);\n      if (currentDistance <= this.attackrange) {\n        // Verify line of sight before switching to attack\n        if (canSeeTarget(this.position, this.targetPC.position)) {\n          console.log(`NPC ${this.id} is already in attack range (${currentDistance} <= ${this.attackrange}) and can see target. Switching to attack!`);\n          this.state = 'attack';\n          await updateThisNPC.call(this, gridId);\n          break;\n        } else {\n          console.log(`NPC ${this.id} is in range but can't see ${this.targetPC.username} due to walls. Continuing pursuit.`);\n        }\n      }\n      if (!this.pursueTimerStart) this.pursueTimerStart = Date.now();\n      const timeSincePursueStart = Date.now() - this.pursueTimerStart;\n      const distance = getDistance(this.position, this.targetPC?.position);\n      // Check if there's a closer PC to switch to (that can be seen)\n      const closestVisiblePC = findClosestVisiblePC(this.position, pcs);\n      if (closestVisiblePC && closestVisiblePC.playerId !== this.targetPC.playerId) {\n        const distToCurrent = distance;\n        const distToClosest = getDistance(this.position, closestVisiblePC.position);\n        if (distToCurrent - distToClosest >= 2) {\n          console.log(` NPC ${this.id} switching target from ${this.targetPC.username} to much closer PC ${closestVisiblePC.username}.`);\n          this.targetPC = closestVisiblePC;\n        }\n      }\n      // Give up if: \n      // 1. Target is too far AND we've been chasing for a while, OR\n      // 2. We can't see the target anymore (behind wall)\n      const canSeeTargetNow = canSeeTarget(this.position, this.targetPC.position);\n      \n      if ((distance > this.range * 2 && timeSincePursueStart > 5000) || !canSeeTargetNow) {\n        if (!canSeeTargetNow) {\n          console.log(` NPC ${this.id} lost sight of ${this.targetPC?.username} (wall blocking). Giving up pursuit.`);\n        } else {\n          console.log(` NPC ${this.id} gave up chasing ${this.targetPC?.username} (too far).`);\n        }\n        this.state = 'roam';\n        this.pursueTimerStart = null;\n        this.targetPC = null;\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n      console.log(`NPC ${this.id} is pursuing PC ${this.targetPC.username}.`);\n      \n      // Use a custom pursue handler that checks line of sight\n      const handlePursueWithLineOfSight = async () => {\n        const dx = this.targetPC.position.x - this.position.x;\n        const dy = this.targetPC.position.y - this.position.y;\n\n        let direction = null;\n        if (Math.abs(dx) > Math.abs(dy)) {\n          direction = dx > 0 ? 'E' : 'W';\n        } else if (dy !== 0) {\n          direction = dy > 0 ? 'S' : 'N';\n        }\n        // Add diagonal movement if applicable\n        if (Math.abs(dx) === Math.abs(dy)) {\n          if (dx > 0 && dy > 0) direction = 'SE';\n          else if (dx > 0 && dy < 0) direction = 'NE';\n          else if (dx < 0 && dy > 0) direction = 'SW';\n          else if (dx < 0 && dy < 0) direction = 'NW';\n        } \n        \n        // Check if already in attack range AND can see target BEFORE attempting to move\n        const distanceToPlayer = getDistance(this.position, this.targetPC.position);\n        console.log(` NPC ${this.id} distance to player: ${distanceToPlayer} | range: ${this.attackrange}`);\n        \n        if (distanceToPlayer <= this.attackrange) {\n          if (canSeeTarget(this.position, this.targetPC.position)) {\n            console.log(`NPC ${this.id} can see and attack ${this.targetPC.username}. Transitioning to attack!`);\n            this.state = 'attack';\n            await updateThisNPC.call(this, gridId);\n            return;\n          } else {\n            console.log(`NPC ${this.id} is in range but can't see ${this.targetPC.username} due to walls. Continuing pursuit.`);\n          }\n        }\n        \n        if (!direction) return;\n\n        const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n        if (!moved) {\n          console.log(`NPC ${this.id} could not move in direction ${direction}.`);\n          \n          // If we're stuck, use idle state to pick a random direction\n          if (!this.stuckCounter) this.stuckCounter = 0;\n          this.stuckCounter++;\n          \n          if (this.stuckCounter >= 3) {\n            console.log(`NPC ${this.id} appears stuck after ${this.stuckCounter} failed moves. Using idle to unstick.`);\n            this.state = 'idle';\n            this.stuckCounter = 0;\n            await updateThisNPC.call(this, gridId);\n          }\n        } else {\n          // Reset stuck counter on successful move\n          this.stuckCounter = 0;\n        }\n      };\n      \n      await handlePursueWithLineOfSight();\n      break;\n    }\n\n    case 'attack': {\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId); // Refresh position from latest state\n      this.targetPC = pcs.find(pc => pc.playerId === this.targetPC?.playerId);\n\n      if (!this.targetPC) {\n        //console.warn(`NPC ${this.id} lost its target. Returning to roam state.`);\n        this.pursueTimerStart = null;\n        this.state = 'roam';\n        await updateThisNPC.call(gridId); // Save after transition\n        break;\n      }\n      if (this.targetPC.hp <= 0 || this.targetPC.iscamping) {\n        this.state = 'roam';\n        await updateThisNPC.call(this, gridId);\n        break; //  Skip PCs that are dead or camping\n      }\n      const distanceToTarget = getDistance(this.position, this.targetPC.position);\n      if (distanceToTarget > this.attackrange) {\n        //console.log(`PC ${this.targetPC.username} moved out of attack range. Returning to 'pursue' state.`);\n        this.state = 'pursue';\n        await updateThisNPC.call(this, gridId); // Save after transition\n        break;\n      }\n      \n      // Check line of sight before attacking\n      if (!canSeeTarget(this.position, this.targetPC.position)) {\n        console.log(`NPC ${this.id} lost sight of ${this.targetPC.username} due to walls. Returning to 'pursue' state.`);\n        this.state = 'pursue';\n        await updateThisNPC.call(this, gridId);\n        break;\n      }\n \n      // Perform the attack\n      const attackRoll = Math.floor(Math.random() * 20) + 1;\n      const hitRoll = attackRoll + this.attackbonus;\n      const isAHit = hitRoll >= this.targetPC.armorclass;\n\n      // console.log('attackRoll = ', attackRoll);\n      // console.log('this.attackBonus = ', this.attackbonus)\n      // console.log('this.targetPC = ',this.targetPC);\n      // console.log('this.targetPC.armorclass = ',this.targetPC.armorclass);\n      // console.log('hitRoll = ', hitRoll);\n      // console.log('isAHit = ', isAHit);\n\n      if (!isAHit) {\n        //console.log(`NPC ${this.id} missed the attack on ${this.targetPC.username}.`);\n        FloatingTextManager.addFloatingText(503, this.targetPC.position.x, this.targetPC.position.y, TILE_SIZE);\n        setTimeout(() => {\n          this.state = 'attack'; // Retry attack after waiting\n        }, this.speed);\n      } else {\n        // apply damage\n        const damage = Math.floor(Math.random() * 6) + 1 + this.damage;\n        // Define the stat and amount to modify before calling modifyPlayerStats\n        const amountToMod = -damage;  // Damage is negative\n        \n        try {\n          const newHP = Math.max(0, this.targetPC.hp + amountToMod);\n          FloatingTextManager.addFloatingText(`- ${damage}  HP`, this.targetPC.position.x, this.targetPC.position.y, TILE_SIZE );\n          playersInGridManager.updatePC(gridId, this.targetPC.playerId, {\n            hp: newHP,\n            lastUpdated: Date.now()\n          });\n        } catch (error) {\n          console.error(`Error applying damage to player ${this.targetPC.username}:`, error);\n        }\n      }\n      break;\n    }\n\n    case 'roam': {\n      this.pursueTimerStart = null;\n      await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n      });\n      break;\n    }\n\n    default: {\n      console.warn(`Unhandled state: ${this.state}`);\n      break;\n    }\n  }\n}\n\n/**\n * Finds the closest PC to the given position.\n */\nfunction findClosestPC(npcPosition, pcs) {\n  let closestPC = null;\n  let minDistance = Infinity;\n\n  pcs.forEach((pc) => {\n    if (pc.hp <= 0) return; //  Skip PCs that are dead\n    const distance = getDistance(npcPosition, pc.position);\n    if (distance < minDistance) {\n      minDistance = distance;\n      closestPC = pc;\n    }\n  });\n\n  return closestPC;\n}\n\n/**\n * Helper to find the closest VISIBLE PC to an NPC (no walls blocking)\n */\nfunction findClosestVisiblePC(npcPosition, pcs) {\n  let closestPC = null;\n  let minDistance = Infinity;\n\n  pcs.forEach((pc) => {\n    if (pc.hp <= 0) return; // Skip PCs that are dead\n    const distance = getDistance(npcPosition, pc.position);\n    if (distance < minDistance && canSeeTarget(npcPosition, pc.position)) {\n      minDistance = distance;\n      closestPC = pc;\n    }\n  });\n\n  return closestPC;\n}\n\n/**\n * Calculates the Euclidean distance between two points.\n */\nfunction getDistance(pos1, pos2) {\n  return Math.sqrt((pos1.x - pos2.x) ** 2 + (pos1.y - pos2.y) ** 2);\n}\n\n\nexport function attachEnemyBehavior(NPC) {\n  NPC.prototype.handleEnemyBehavior = handleEnemyBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { calculateDistance } from '../../Utils/worldHelpers';\nimport { isWallBlocking } from '../../Utils/GridManagement';\n\nasync function handleHealBehavior(gridId) {\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleHealerBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Force state to roam if it's not already (one-time update)\n    if (this.state !== 'roam') {\n        this.state = 'roam';\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    }\n\n    // Check if this NPC is within any PC's range (respecting walls/doors)\n    const pcsInRange = Object.values(playersInGridManager.getPlayersInGrid(gridId) || {}).some(pc =>\n        calculateDistance(pc.position, this.position) <= (pc.range || 3) &&\n        pc.hp > 0 &&\n        !isWallBlocking(this.position, pc.position)\n    );\n    \n    if (pcsInRange) {\n        // If players are in range, don't move (but stay in roam state)\n        // This creates the effect of the NPC stopping when players approach\n        return;\n    }\n\n    // Always handle roam state - no more switching\n    await this.handleRoamState(tiles, resources, npcs, () => {\n        // Don't change state - stay in roam\n        // This callback is called after roam completes, but we just continue roaming\n    });\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachHealBehavior(NPC) {\n    NPC.prototype.handleHealBehavior = handleHealBehavior;\n}","import { calculateDistance } from '../../Utils/worldHelpers';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\n\nasync function handleSpawnBehavior(gridId) {\n    const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (!NPCsInGrid) {\n        console.warn(`GridState unavailable for gridId ${gridId}.`);\n        return;\n    }\n\n    const npcsObject = NPCsInGridManager.getNPCsInGrid(gridId); // this *is* the npcs object\n    const npcs = Object.values(npcsObject || {});\n    \n    const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n    const pcs = Object.values(playersInGrid || {});\n\n    //console.log(`[Spawner] Handling spawn behavior for ${this.type} at (${this.position.x}, ${this.position.y}). State: ${this.state}`);\n\n    //  Track position changes\n    const oldPosition = { x: this.position.x, y: this.position.y };\n\n    switch (this.state) {\n        case 'idle': {\n            const pcsInRange = pcs.some(pc => calculateDistance(pc.position, this.position) < this.range);\n            if (pcsInRange) {\n                console.log(`[Spawner] ${this.type} detected PCs nearby. Transitioning to spawn state.`);\n                this.state = 'spawn';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            }\n            break;\n        }\n\n        case 'spawn': {\n            const existingNPCs = npcs.filter(npc => npc.type === this.requires);\n            if (existingNPCs.length >= this.qtycollected) {\n                console.log(`[Spawner] Max ${this.requires} reached (${this.qtycollected}). Returning to idle.`);\n                this.state = 'idle';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n                return;\n            }\n\n            if (!this.nextspawn || Date.now() >= this.nextspawn) {\n                console.log(`[Spawner] Spawning new ${this.requires} at (${this.position.x}, ${this.position.y}).`);\n                //  ENSURE THE SPAWNER AND NPC HAVE SEPARATE POSITION OBJECTS \n                const npcPosition = { x: this.position.x, y: this.position.y }; // NEW OBJECT, NOT A REFERENCE\n\n                await NPCsInGridManager.spawnNPC(gridId, { type: this.requires }, npcPosition);\n\n                this.nextspawn = Date.now() + this.speed * 1000;\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            } else {\n                console.log(`[Spawner] Waiting for next spawn cycle.`);\n            }\n\n            const pcsStillInRange = pcs.some(pc => calculateDistance(pc.position, this.position) < this.range);\n            if (!pcsStillInRange) {\n                console.log(`[Spawner] No PCs nearby. Returning to idle.`);\n                this.state = 'idle';\n                await NPCsInGridManager.updateNPC(gridId, this.id, {\n                    state: this.state,\n                    position: this.position,\n                    nextspawn: this.nextspawn\n                });\n            }\n            break;\n        }\n\n        default:\n            console.warn(`Unhandled state for NPC ${this.id}: ${this.state}`);\n            break;\n    }\n\n    //  Detect movement\n    if (this.position.x !== oldPosition.x || this.position.y !== oldPosition.y) {\n        console.error(`[Spawner] ERROR: Spawner ${this.id} moved from (${oldPosition.x}, ${oldPosition.y}) to (${this.position.x}, ${this.position.y})!`);\n    }\n}\n\n// Attach behavior to the NPC class\nexport function attachSpawnBehavior(NPC) {\n    NPC.prototype.handleSpawnBehavior = handleSpawnBehavior;\n}\n\n","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleWorkerBehavior(gridId) {\n    const updateThisNPC = async () => {\n        // Check if this NPC exists in the grid before updating\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n        if (!npcsInGrid || !npcsInGrid[this.id]) {\n            console.warn(` NPC ${this.id} (${this.type}) attempting to update but not found in grid ${gridId}. This NPC may be orphaned.`);\n            // Stop this NPC from continuing to update\n            if (this.updateInterval) {\n                clearInterval(this.updateInterval);\n                this.updateInterval = null;\n            }\n            return;\n        }\n        \n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    };\n\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleHealerBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    // Worker NPCs don't need to update state - they stay idle\n    // This prevents unnecessary save-single-npc calls\n}\n\n// Attach the quest-giver behavior to the NPC class\nexport function attachFarmerBehavior(NPC) {\n    NPC.prototype.handleWorkerBehavior = handleWorkerBehavior;\n}","import axios from 'axios';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\n\nasync function handleTraderBehavior(gridId) { \n    const updateThisNPC = async () => {\n        await NPCsInGridManager.updateNPC(gridId, this.id, {\n            state: this.state,\n            position: this.position,\n        });\n    };\n\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {}); \n\n    gridId = gridId || this.gridId; // Fallback to npc.gridId if not provided\n\n    //console.log(`handleTraderBehavior: gridId: ${gridId}; NPC ${this.id} is in state: ${this.state}`);\n\n    if (!tiles || !resources) {\n        console.error(`Tiles or resources are missing for NPC ${this.id}.`);\n        return;\n    }\n\n    switch (this.state) {\n        case 'idle': {\n            // Traders stay in place, they don't roam\n            // Just stay idle and wait for players to interact\n            break;\n        }\n\n        default:\n            console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`);\n            break;\n    }\n}\n\n// Attach the trader behavior to the NPC class\nexport function attachTraderBehavior(NPC) {\n    NPC.prototype.handleTraderBehavior = handleTraderBehavior;\n}","import socket from '../../socketManager'; \nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { calculateDistance } from '../../Utils/worldHelpers';\nimport { attachGrazingBehavior } from './NPCGrazeBehavior';\nimport { attachQuestBehavior } from './NPCQuestBehavior';\nimport { attachEnemyBehavior } from './NPCEnemyBehavior';\nimport { attachHealBehavior } from './NPCHealBehavior';\nimport { attachSpawnBehavior } from './NPCSpawnerBehavior';\nimport { attachFarmerBehavior } from './NPCWorkerBehavior';\nimport { attachTraderBehavior } from './NPCTraderBehavior';\n \nclass NPC {\n  constructor(id, type, position, properties, gridId) {\n    //console.log('NPC constructor: properties:', properties);\n    //console.log('NPC constructor: gridId:', gridId);\n    //console.log(`NPC constructor: ID=${id}, type=${type}, grazeEnd=`, properties.grazeEnd);\n\n    if (!properties || typeof properties !== 'object') {\n      console.error(`Invalid properties passed to NPC constructor for type ${type}:`, properties);\n      throw new Error('NPC constructor requires valid properties.');\n    }\n\n    this.updateInterval = properties.updateInterval || 1000; // Default to 1 second updates\n    this.id = id;\n    this.type = type;\n    this.position = {\n      x: Math.floor(position.x),\n      y: Math.floor(position.y),\n    };\n    this.symbol = properties.symbol;\n    this.hp = properties.hp || 0; // Use hp as hunger\n    this.output = properties.output;\n    this.maxhp = properties.maxhp || 0;\n    this.range = properties.range;\n    this.action = properties.action; // High-level behavioral category (e.g., \"graze\")\n    this.state = properties.state || 'idle'; // Use stored state or default to idle\n    this.speed = properties.speed; // Keep speed for combat stats, but do not use for movement animation\n    this.growTime = properties.growtime || 0; // Time to fully graze\n    this.processingStartTime = undefined;\n    this.nextspawn = properties.nextspawn ?? (this.action === 'spawn' ? Date.now() + 5000 : null);\n    this.grazeEnd = properties.grazeEnd || null; // this is preserved from NPCsInGrid\n    this.lastUpdated = Date.now(); // Initialize lastUpdated\n    this.gridId = properties.gridId || gridId; // Use the passed gridId or default to the one in properties\n\n    // Assign additional properties BUT preserve critical fields that were already set\n    // Remove type, id from properties to prevent overwriting with undefined\n    const { type: _type, id: _id, ...safeProperties } = properties;\n    Object.assign(this, safeProperties);\n\n    console.log(` NPC ${this.id} constructed at position (${this.position.x}, ${this.position.y}) with state: ${this.state}`);\n  }\n\n\n/////////////////\n// NPC CORE   ///\n/////////////////\n\nupdate(currentTime, NPCsInGrid, gridId, TILE_SIZE) {\n\n  //console.log(` update() for NPC ${this.id} | currentTime: ${currentTime} | lastUpdated: ${this.lastUpdated} | elapsed: ${currentTime - this.lastUpdated}`);\n  const timeElapsed = currentTime - this.lastUpdated;\n  if (timeElapsed < this.updateInterval) { return; }\n  \n  this.processState(NPCsInGrid, gridId, TILE_SIZE);\n  this.lastUpdated = currentTime;\n}\n\nasync processState(NPCsInGrid, gridId, TILE_SIZE) {\n  \n  //console.log(` processState | NPC ${this.id} | state=${this.state} | action=${this.action} | gridId=${gridId}`);\n  try {\n\n    switch (this.action) {\n\n      case 'graze':\n        await this.handleFarmAnimalBehavior(gridId);\n        break;\n    \n      case 'pet':\n        // Future implementation for Pets\n        // console.log('Pet behavior not implemented yet.');\n        break;\n    \n      case 'quest':\n        await this.handleQuestGiverBehavior(gridId);\n        break;\n    \n      case 'trade':\n        await this.handleTraderBehavior(gridId);\n        break;\n\n      case 'worker':\n        await this.handleWorkerBehavior(gridId);\n        break;\n    \n      case 'heal':\n        await this.handleHealBehavior(gridId);\n        break;\n    \n      case 'attack':\n        await this.handleEnemyBehavior(gridId, TILE_SIZE);\n        break;\n    \n      case 'spawn':\n        await this.handleSpawnBehavior(gridId);\n        break;\n\n      default:\n        console.warn(`Unhandled NPC action: ${this.action}`);\n        break;\n    }\n    } catch (error) {\n      console.error(`Error in NPC ${this.id} processState:`, error);\n    }\n}\n\n\n//////////////////////////////\n// NPC -- SHARED BEHAVIORS //\n/////////////////////////////\n\nasync handleIdleState(tiles, resources, npcs, idleDuration, onTransition = () => {}) {\n  if (!this.idleTimer) this.idleTimer = 0;\n  this.idleTimer++;\n\n  if (this.idleTimer >= idleDuration) {\n    this.idleTimer = 0;\n\n    const directions = ['N', 'S', 'E', 'W', 'NE', 'SE', 'SW', 'NW'];\n    const validDirections = directions.filter((dir) => {\n      const { x, y } = this.getAdjacentTile(dir);\n      return this.isValidTile(x, y, tiles, resources, npcs);\n    });\n\n    if (validDirections.length > 0) {\n      const randomDirection = validDirections[Math.floor(Math.random() * validDirections.length)];\n      const moved = await this.moveOneTile(randomDirection, tiles, resources, npcs);\n      // if (moved) console.log(` NPC ${this.id} moved in idle to (${this.position.x}, ${this.position.y})`);\n    }\n    onTransition(); // callback to re-evaluate state\n    return true; // idle completed\n  }\n  //console.log(` NPC ${this.id} is idling. Timer: ${this.idleTimer}/${idleDuration}`);\n  return false; // still idling\n}\n\n\nasync handleRoamState(tiles, resources, npcs, onTransition = () => {}) {  // Initialize roam step counter and range\n  this.roamSteps = this.roamSteps || 0;\n  const range = this.range || 4; // Default roam range\n\n  // If no initial direction is set, choose one at random\n  if (!this.currentDirection) {\n    const directions = ['N', 'S', 'E', 'W', 'NE', 'SE', 'SW', 'NW'];\n    this.currentDirection = directions[Math.floor(Math.random() * directions.length)];\n    //console.log(`NPC ${this.id} selected initial roam direction: ${this.currentDirection}`);\n  }\n  // Define preferred directions based on the initial direction\n  const preferredDirectionsMap = {\n    N: ['N', 'NE', 'NW'],\n    S: ['S', 'SE', 'SW'],\n    E: ['E', 'NE', 'SE'],\n    W: ['W', 'NW', 'SW'],\n    NE: ['NE', 'N', 'E'],\n    SE: ['SE', 'S', 'E'],\n    SW: ['SW', 'S', 'W'],\n    NW: ['NW', 'N', 'W'],\n  };\n\n  const preferredDirections = preferredDirectionsMap[this.currentDirection] || [this.currentDirection];\n  const validDirections = preferredDirections.filter((direction) => {\n    const { x, y } = this.getAdjacentTile(direction);\n    return this.isValidTile(x, y, tiles, resources, npcs);\n  })\n  if (validDirections.length > 0) {\n    const direction = validDirections[Math.floor(Math.random() * validDirections.length)];\n    await this.moveOneTile(direction, tiles, resources, npcs);\n    this.roamSteps++;\n  } else {\n    this.currentDirection = null;\n    // console.warn(` NPC ${this.id} found no valid roam directions this step.`);\n  }\n\n  // Check if the NPC has completed the roam range\n  if (this.roamSteps >= range || validDirections.length === 0) {\n    //console.log(`NPC ${this.id} completed ${range} roam steps. Transitioning to the next state.`);\n    this.roamSteps = 0; // Reset roam steps\n    this.currentDirection = null; // Reset direction for the next roam\n    onTransition();\n  }\n}\n\nasync handlePursueState(playerPosition, tiles, resources, npcs, pcs, onAttackTransition) {\n\n  const dx = playerPosition.x - this.position.x;\n  const dy = playerPosition.y - this.position.y;\n\n  let direction = null;\n  if (Math.abs(dx) > Math.abs(dy)) {\n    direction = dx > 0 ? 'E' : 'W';\n  } else if (dy !== 0) {\n    direction = dy > 0 ? 'S' : 'N';\n  }\n  // Add diagonal movement if applicable\n  if (Math.abs(dx) === Math.abs(dy)) {\n    if (dx > 0 && dy > 0) direction = 'SE';\n    else if (dx > 0 && dy < 0) direction = 'NE';\n    else if (dx < 0 && dy > 0) direction = 'SW';\n    else if (dx < 0 && dy < 0) direction = 'NW';\n  } \n  \n  // Check if already in attack range BEFORE attempting to move\n  const distanceToPlayer = calculateDistance(this.position, playerPosition);\n  console.log(` NPC ${this.id} distance to player: ${distanceToPlayer} | range: ${this.attackrange}`);\n  if (distanceToPlayer <= this.attackrange) {\n    this.state = 'attack';\n    await onAttackTransition();\n    return;\n  }\n  \n  if (!direction) return;\n\n  const moved = await this.moveOneTile(direction, tiles, resources, npcs);\n  if (!moved) {\n    // If can't move but already in attack range, attack!\n    if (distanceToPlayer <= this.attackrange) {\n      console.log(` NPC ${this.id} blocked but in attack range! Transitioning to attack.`);\n      this.state = 'attack';\n      await onAttackTransition();\n    } else {\n      console.warn(` NPC ${this.id} couldn't move toward target. Stuck? Returning to idle.`);\n      this.state = 'idle';\n      this.pursueTimerStart = null;\n      this.targetPC = null;\n    }\n    return;\n  }\n\n  // Check again after moving\n  const newDistanceToPlayer = calculateDistance(this.position, playerPosition);\n  console.log(` NPC ${this.id} NEW distance to player: ${newDistanceToPlayer} | range: ${this.attackrange}`);\n  if (newDistanceToPlayer <= this.attackrange) {\n    this.state = 'attack';\n    await onAttackTransition();\n  }\n}\n\n/////////////////\n// NPC UTILITY //\n/////////////////\n\nasync moveOneTile(direction, tiles, resources, npcs) {\n\n  if (this.action === 'spawn') {\n    console.warn(`Spawner ${this.id} cannot move!`);\n    return false; //  Prevents spawners from moving at all\n  }\n  const directions = {\n      N: { x: 0, y: -1 },\n      S: { x: 0, y: 1 },\n      E: { x: 1, y: 0 },\n      W: { x: -1, y: 0 },\n      NE: { x: 1, y: -1 },\n      SE: { x: 1, y: 1 },\n      SW: { x: -1, y: 1 },\n      NW: { x: -1, y: -1 },\n  };\n\n  const delta = directions[direction];\n  if (!delta) {\n      console.error(`Invalid direction: ${direction}`);\n      return false;\n  }\n  const targetX = Math.floor(this.position.x + delta.x);\n  const targetY = Math.floor(this.position.y + delta.y);\n\n  // Validate the tile before moving\n  if (!this.isValidTile(targetX, targetY, tiles, resources, npcs)) {\n      console.warn(`NPC ${this.id} cannot move to invalid tile (${targetX}, ${targetY}).`);\n      return false;\n  }\n  //console.log('Tile was valid.');\n  const moveDuration = 1200; // Standard movement speed for all NPCs\n  \n  // Set the target position immediately - CSS transition will handle the animation\n  this.position.x = targetX;\n  this.position.y = targetY;\n  \n  // Use updateNPCPosition for movement-only updates (doesn't save to DB immediately)\n  NPCsInGridManager.updateNPCPosition(this.gridId, this.id, { x: targetX, y: targetY });\n  \n  return new Promise((resolve) => {\n      // Wait for CSS transition to complete before emitting socket event\n      setTimeout(() => {\n          if (socket && socket.connected) {\n            socket.emit('npc-moved', {\n              gridId: this.gridId,\n              npcId: this.id,\n              newPosition: { x: targetX, y: targetY },\n              emitterId: socket.id\n            });\n            //console.log(` Emitting npc-moved for NPC ${this.id} to (${targetX}, ${targetY}) from ${socket.id}`);\n          }\n          resolve(true);\n      }, moveDuration);\n  });\n}\n\ngetAdjacentTile(direction) {\n  const directions = {\n      N: { x: 0, y: -1 },\n      S: { x: 0, y: 1 },\n      E: { x: 1, y: 0 },\n      W: { x: -1, y: 0 },\n      NE: { x: 1, y: -1 },\n      SE: { x: 1, y: 1 },\n      SW: { x: -1, y: 1 },\n      NW: { x: -1, y: -1 },\n  };\n\n  const delta = directions[direction];\n  if (!delta) {\n      console.error(`Invalid direction: ${direction}`);\n      return { x: this.position.x, y: this.position.y };\n  }\n\n  //console.log('getAdjacentTile: x = ',this.position.x + delta.x,' y = ',this.position.y + delta.y);\n  return {\n      x: this.position.x + delta.x,\n      y: this.position.y + delta.y,\n  };\n}\n\nisValidTile(x, y, tiles, resources, npcs) {\n\n    // Round x and y to ensure valid integer indices\n    x = Math.floor(x);\n    y = Math.floor(y);\n\n  // Check if tiles data is valid\n  if (!tiles || !Array.isArray(tiles)) {\n    //console.error('isValidTile; Tiles data is invalid.');\n    return false;\n  }\n  if (!resources || !Array.isArray(resources)) {\n    //console.error('isValidTile; Resources data is invalid or missing.');\n    return false;\n}\n  // Check if tile is out of bounds\n  if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[0].length) {\n    //console.error(`Tile (${x}, ${y}) is out of bounds.`);\n    return false;\n  } else {\n    //console.log(`Tile (${x}, ${y}) is in bounds.`);\n  }\n\n    // **Step 1: Check if NPC is allowed to step on this tile type**\n    const tileType = tiles[y][x]; // Get the tile type at x, y\n    //console.log(`Checking tileType: ${tileType} for NPC ${this.id}`);\n  \n    // Dynamically check if NPC can walk on this tile type\n    // Property name is 'validon' + tileType (e.g., 'validong' for 'g')\n    const validPropertyName = `validon${tileType}`;\n    const canWalkOnTile = this[validPropertyName] === true;\n  \n    if (!canWalkOnTile) {\n    //   console.warn(`NPC ${this.id} cannot step on tile type \"${tileType}\".`);\n      return false;\n    }\n  \n    // **Step 2: Check if there's an impassable resource in this tile**\n    const resourceInTile = resources.find((res) => res.x === x && res.y === y);\n    if (resourceInTile) {\n  \n      if (!resourceInTile.passable) {\n        //console.warn(`Tile (${x}, ${y}) is occupied by an impassable resource.`);\n        return false;\n      }\n    }\n  \n  // Ensure npcs is an array before calling .some()\n  if (!Array.isArray(npcs)) {\n    console.warn(`NPC list is invalid or undefined. Skipping NPC collision check.`);\n    return true;\n  }\n\n  // Check if another NPC is occupying the tile\n  const npcInTile = npcs.find(npc => Math.floor(npc.position.x) === x && Math.floor(npc.position.y) === y && npc.id !== this.id);\n  if (npcInTile) {\n    // Allow farm animals to move through other farm animals\n    const bothGrazingAnimals = this.action === 'graze' && npcInTile.action === 'graze';\n    if (!bothGrazingAnimals) {\n      //console.warn(`Tile (${x}, ${y}) is already occupied by another NPC.`);\n      return false;\n    }\n  }\n\n  //console.log(`Tile (${x}, ${y}) is valid for movement.`);\n  return true;\n}\n\n\n\nasync findTileInRange(tileType, tiles, resources) {\n  const range = Math.floor(this.range || 3); // Ensure integer range\n  const startX = Math.floor(this.position.x);\n  const startY = Math.floor(this.position.y);\n\n  if (!tiles || tiles.length === 0 || !Array.isArray(tiles)) {\n    // console.error('Tiles array is invalid or empty.');\n    return [];\n  }\n\n  const potentialTiles = [];\n  for (let dx = -range; dx <= range; dx++) {\n    for (let dy = -range; dy <= range; dy++) {\n      const x = startX + dx;\n      const y = startY + dy;\n\n      if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[y]?.length) continue;\n\n      if (tiles[y][x] === tileType) {\n        potentialTiles.push({ x, y });\n      }\n    }\n  }\n\n  console.log(`Found ${potentialTiles.length} potential tiles for type \"${tileType}\".`);\n  return potentialTiles;\n}\n\n\nfindNearestResource(targetResource, tiles, resources, excludePositions = []) {\n  //console.log(`Finding nearest ${targetResource} for NPC ${this.id}.`);\n\n  if (!resources || !Array.isArray(resources) || resources.length === 0) {\n    //console.error(`Resources are invalid or empty for NPC ${this.id}.`);\n    return null;\n  }\n  const npcPosition = {\n    x: Math.floor(this.position.x),\n    y: Math.floor(this.position.y),\n  };\n  \n  // Get all NPCs for checking stall occupancy\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(this.gridId) || {});\n  \n  const availableResources = resources.filter((res) => {\n    if (res.category !== targetResource || typeof res.x !== 'number' || typeof res.y !== 'number') {\n      return false;\n    }\n    // Exclude positions that have been tried and failed\n    const isExcluded = excludePositions.some(pos => pos.x === res.x && pos.y === res.y);\n    if (isExcluded) return false;\n    \n    // For stalls, check if another grazing animal is already there\n    if (targetResource === 'stall') {\n      const otherAnimalAtStall = npcs.some(npc => \n        npc.id !== this.id &&\n        npc.action === 'graze' &&\n        Math.floor(npc.position?.x) === res.x &&\n        Math.floor(npc.position?.y) === res.y\n      );\n      if (otherAnimalAtStall) {\n        //console.log(`Stall at (${res.x}, ${res.y}) is occupied, skipping`);\n        return false;\n      }\n    }\n    \n    return true;\n  });\n  if (availableResources.length === 0) {\n    //console.warn(`No available ${targetResource} found for NPC ${this.id}.`);\n    return null;\n  }\n  availableResources.sort((a, b) => {\n    const aPos = { x: Math.floor(a.x), y: Math.floor(a.y) };\n    const bPos = { x: Math.floor(b.x), y: Math.floor(b.y) };\n    return calculateDistance(npcPosition, aPos) - calculateDistance(npcPosition, bPos);\n  });\n  const closestResource = availableResources[0];\n  //console.log(`NPC ${this.id} selected nearest ${targetResource}:`, closestResource);\n  return closestResource;\n}\n\n// Find all resources of a type sorted by distance\nfindAllResources(targetResource, tiles, resources) {\n  if (!resources || !Array.isArray(resources) || resources.length === 0) {\n    return [];\n  }\n  const npcPosition = {\n    x: Math.floor(this.position.x),\n    y: Math.floor(this.position.y),\n  };\n  const availableResources = resources.filter((res) => {\n    return res.category === targetResource && typeof res.x === 'number' && typeof res.y === 'number';\n  });\n  availableResources.sort((a, b) => {\n    const aPos = { x: Math.floor(a.x), y: Math.floor(a.y) };\n    const bPos = { x: Math.floor(b.x), y: Math.floor(b.y) };\n    return calculateDistance(npcPosition, aPos) - calculateDistance(npcPosition, bPos);\n  });\n  return availableResources;\n}\n\n\n}\n\n// Attach behaviors to the NPC prototype\nattachGrazingBehavior(NPC);\nattachQuestBehavior(NPC);\nattachEnemyBehavior(NPC);\nattachHealBehavior(NPC);\nattachSpawnBehavior(NPC);\nattachFarmerBehavior(NPC);\nattachTraderBehavior(NPC);\n\nexport default NPC;","import React, { createContext, useContext } from 'react';\nimport stringsEN from './Strings/stringsEN.json';\nimport stringsFR from './Strings/stringsFR.json';\nimport stringsES from './Strings/stringsES.json';\nimport stringsIT from './Strings/stringsIT.json';\nimport stringsDE from './Strings/stringsDE.json';\nimport stringsPT from './Strings/stringsPT.json';\nimport stringsRU from './Strings/stringsRU.json';\nimport stringsNO from './Strings/stringsNO.json';\nimport stringsSV from './Strings/stringsSV.json';\nimport stringsFI from './Strings/stringsFI.json';\n\nconst STRINGS_MAP = {\n  en: stringsEN,\n  fr: stringsFR,\n  es: stringsES,\n  de: stringsDE,\n  it: stringsIT,\n  pt: stringsPT,\n  ru: stringsRU,\n  no: stringsNO,\n  sv: stringsSV,\n  fi: stringsFI,\n  // Add more languages here as needed\n};\n\nconst StringsContext = createContext(stringsEN); // Default to English\n\nexport const StringsProvider = ({ language = 'en', children }) => {\n  const selectedStrings = STRINGS_MAP[language?.toLowerCase()] || stringsEN;\n\n  console.log(' StringsProvider:', {\n    rawLanguage: language,\n    normalized: language?.toLowerCase(),\n    resolvedFile: selectedStrings,\n  });\n\n  return (\n    <StringsContext.Provider value={selectedStrings}>\n      {children}\n    </StringsContext.Provider>\n  );\n};\n\nexport const useStrings = () => {\n  const ctx = useContext(StringsContext);\n  //console.log(\" useStrings hook called, returning:\", ctx);\n  return ctx;\n};","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","import axios from 'axios';\nimport { animateRemotePC } from './Render/RenderAnimatePosition';\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport NPCsInGridManager from './GridState/GridStateNPCs';\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport FloatingTextManager from \"./UI/FloatingText\";\nimport { handleTransitSignpost } from './GameFeatures/Transit/Transit';\n// Temporary render-only animation state for interpolated player positions\nconst renderPositions = {};\nlet currentAnimationFrame = null;\n\n// Track currently pressed keys for diagonal movement\nconst pressedKeys = new Set();\n\n// Define modifier keys that should be ignored for movement\nconst MODIFIER_KEYS = ['Shift', 'Control', 'Alt', 'Meta', 'CapsLock', 'NumLock', 'ScrollLock'];\n\n// Clear all pressed keys when window loses focus or visibility\nif (typeof window !== 'undefined') {\n  window.addEventListener('blur', () => {\n    pressedKeys.clear();\n  });\n  \n  document.addEventListener('visibilitychange', () => {\n    if (document.hidden) {\n      pressedKeys.clear();\n    }\n  });\n  \n  // Debug function to check stuck keys (accessible from console)\n  window.debugMovementKeys = () => {\n    console.log('Currently pressed keys:', Array.from(pressedKeys));\n    return Array.from(pressedKeys);\n  };\n  \n  // Emergency reset function (accessible from console)\n  window.resetMovementKeys = () => {\n    pressedKeys.clear();\n    console.log('Movement keys reset');\n  };\n}\n\n// Helper function to handle key press events\nexport function handleKeyDown(event, currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null,\n  transitionFadeControl = null) \n{\n  // Ignore modifier keys\n  if (MODIFIER_KEYS.includes(event.key)) {\n    return;\n  }\n  \n  // Add the key to our set of pressed keys\n  pressedKeys.add(event.key);\n  \n  // Process movement immediately (fire and forget - we don't await to keep input responsive)\n  processMovement(currentPlayer, TILE_SIZE, masterResources, \n    setCurrentPlayer, setGridId, setGrid, setTileTypes, setResources, \n    updateStatus, closeAllPanels, localPlayerMoveTimestampRef, bulkOperationContext, strings, transitionFadeControl).catch(err => {\n      console.error('Error processing movement:', err);\n    });\n}\n\n// Helper function to handle key release events\nexport function handleKeyUp(event) {\n  // Remove the key from our set of pressed keys\n  pressedKeys.delete(event.key);\n  \n  // Also clear all keys if a modifier is released (failsafe)\n  if (MODIFIER_KEYS.includes(event.key)) {\n    pressedKeys.clear();\n  }\n}\n\n// Main movement handler that processes diagonal movement\nexport async function handleKeyMovement(event, currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null,\n  transitionFadeControl = null) \n{\n  // For backward compatibility, treat this as a key press\n  handleKeyDown(event, currentPlayer, TILE_SIZE, masterResources, \n    setCurrentPlayer, setGridId, setGrid, setTileTypes, setResources, \n    updateStatus, closeAllPanels, localPlayerMoveTimestampRef, bulkOperationContext, strings, transitionFadeControl);\n}\n\n// Process movement based on all currently pressed keys\nasync function processMovement(currentPlayer, TILE_SIZE, masterResources, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  closeAllPanels,\n  localPlayerMoveTimestampRef,\n  bulkOperationContext,\n  strings = null,\n  transitionFadeControl = null)\n{\n  const directions = {\n    ArrowUp: { dx: 0, dy: -1 },\n    w: { dx: 0, dy: -1 },\n    W: { dx: 0, dy: -1 },\n    ArrowDown: { dx: 0, dy: 1 },\n    s: { dx: 0, dy: 1 },\n    S: { dx: 0, dy: 1 },\n    ArrowLeft: { dx: -1, dy: 0 },\n    a: { dx: -1, dy: 0 },\n    A: { dx: -1, dy: 0 },\n    ArrowRight: { dx: 1, dy: 0 },\n    d: { dx: 1, dy: 0 },\n    D: { dx: 1, dy: 0 },\n  };\n\n  // Calculate combined movement vector from all pressed keys\n  let totalDx = 0;\n  let totalDy = 0;\n  \n  for (const key of pressedKeys) {\n    const movement = directions[key];\n    if (movement) {\n      totalDx += movement.dx;\n      totalDy += movement.dy;\n    }\n  }\n  \n  // If no movement, return\n  if (totalDx === 0 && totalDy === 0) return;\n  \n  // Clamp diagonal movement to -1, 0, or 1\n  totalDx = Math.max(-1, Math.min(1, totalDx));\n  totalDy = Math.max(-1, Math.min(1, totalDy));\n\n  if (currentPlayer.iscamping) {\n    FloatingTextManager.addFloatingText(32, currentPlayer.location.x, currentPlayer.location.y, TILE_SIZE);\n    return;\n  }\n\n  const playerId = currentPlayer._id.toString();\n  const gridId = currentPlayer.location.g;\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  if (!playersInGrid || !playersInGrid[playerId]) return;\n\n  const currentPosition = playersInGrid[playerId].position;\n  const targetX = Math.round(currentPosition.x + totalDx);\n  const targetY = Math.round(currentPosition.y + totalDy);\n\n  // Normal movement validation for all players (boats use existing transit logic)\n  if (!Array.isArray(masterResources)) {\n    console.error('masterResources is not an array:', masterResources);\n    return;\n  }\n  if (!(await isValidMove(targetX, targetY, masterResources,\n    currentPlayer,\n    setCurrentPlayer,\n    setGridId,\n    setGrid,\n    setTileTypes,\n    setResources,\n    updateStatus,\n    TILE_SIZE,\n    closeAllPanels,\n    bulkOperationContext,\n    strings,\n    transitionFadeControl\n  ))) {\n    console.warn(` Player blocked from moving to (${targetX}, ${targetY}).`);\n    return;\n  }\n\n  const finalPosition = { x: targetX, y: targetY };\n  const now = Date.now();\n  \n  // Update the local player movement timestamp to prevent our own broadcasts from overriding\n  if (localPlayerMoveTimestampRef) {\n    localPlayerMoveTimestampRef.current = now;\n  }\n\n  playersInGridManager.updatePC(gridId, playerId, {\n    position: finalPosition,\n    lastUpdated: now,\n  });\n\n  centerCameraOnPlayer(finalPosition, TILE_SIZE);\n}\n\nasync function isValidMove(targetX, targetY, masterResources,\n  currentPlayer,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  closeAllPanels,\n  bulkOperationContext,\n  strings = null,\n  transitionFadeControl = null\n ) {  // Function to check if movement is valid\n  const tiles = GlobalGridStateTilesAndResources.getTiles();\n  const resources = GlobalGridStateTilesAndResources.getResources();\n  \n\n  if (!Array.isArray(resources)) {\n    console.warn(' Movement blocked: resources is not an array yet.', resources);\n    return false;\n  }\n\n  // 1 **Check if the target is out of bounds**\n  if (targetX < 0 || targetY < 0 || targetX > 63 || targetY > 63) {\n//  console.warn(` Movement blocked: (${targetX}, ${targetY}) is out of bounds.`);\n    const direction =\n      targetX < 0 ? \"Signpost W\" :\n      targetX > 63 ? \"Signpost E\" :\n      targetY < 0 ? \"Signpost N\" :\n      targetY > 63 ? \"Signpost S\" :\n      null;\n    if (!direction) { console.warn(` Invalid movement direction from (${targetX}, ${targetY}).`); return false; }\n\n    console.log(` Attempting directional travel via: ${direction}`);\n    \n    //  Start fade transition IMMEDIATELY for responsive feel\n    if (transitionFadeControl?.startTransition) {\n      console.log(' [IMMEDIATE FADE] Starting fade transition for boundary crossing');\n      transitionFadeControl.startTransition();\n    }\n    \n    const skills = currentPlayer.skills;\n\n    handleTransitSignpost(\n      currentPlayer,\n      direction,\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      updateStatus,\n      TILE_SIZE,\n      skills,\n      closeAllPanels,\n      bulkOperationContext,\n      null, // masterResources not available\n      strings,\n      null,  // masterTrophies not available in PlayerMovement\n      transitionFadeControl\n    );\n    return false; // Prevent normal movement handling\n  };\n\n  // 2 **Check if tile is valid for movement (using existing isValidTile function)**\n  const canMove = await isTileValidForPlayer(targetX, targetY, tiles, resources, masterResources, currentPlayer, updateStatus, strings, TILE_SIZE);\n  if (!canMove) {\n    console.warn(` Movement blocked: Tile (${targetX}, ${targetY}) is not passable.`);\n  }\n  return canMove;\n}\n\n\nexport function centerCameraOnPlayer(position, TILE_SIZE, retryCount = 0) {\n  const gameContainer = document.querySelector(\".homestead\");\n  if (!gameContainer) {\n    // Container not ready yet, retry after a short delay (Safari fix)\n    if (retryCount < 5) {\n      requestAnimationFrame(() => centerCameraOnPlayer(position, TILE_SIZE, retryCount + 1));\n    }\n    return;\n  }\n\n  // Guard against undefined position during network delays\n  if (!position || typeof position.x !== 'number' || typeof position.y !== 'number') {\n    console.warn(' [CAMERA] Cannot center camera - invalid position:', position);\n    return;\n  }\n\n  const LEFT_PANEL_WIDTH = 300;  // Scaled with zoom level\n  const HEADER_HEIGHT = 200;     // Same\n\n  const centerX = position.x * TILE_SIZE - (window.innerWidth - LEFT_PANEL_WIDTH) / 2;\n  const centerY = position.y * TILE_SIZE - (window.innerHeight - HEADER_HEIGHT) / 2;\n\n  // Clamp scroll positions so we don't scroll beyond the container's bounds\n  const maxScrollLeft = gameContainer.scrollWidth - gameContainer.clientWidth;\n  const maxScrollTop = gameContainer.scrollHeight - gameContainer.clientHeight;\n\n  // Safari fix: If container hasn't laid out yet (scroll dimensions are 0), retry\n  if (maxScrollLeft <= 0 && maxScrollTop <= 0 && centerX > 0 && retryCount < 10) {\n    console.log(` [CAMERA] Container not ready, retrying... (attempt ${retryCount + 1})`);\n    requestAnimationFrame(() => centerCameraOnPlayer(position, TILE_SIZE, retryCount + 1));\n    return;\n  }\n\n  const clampedX = Math.max(0, Math.min(centerX, maxScrollLeft));\n  const clampedY = Math.max(0, Math.min(centerY, maxScrollTop));\n\n  gameContainer.scrollTo({\n    left: clampedX,\n    top: clampedY,\n    behavior: \"smooth\",\n  });\n\n  //console.log(` Camera centered on player at (${position.x}, ${position.y})`);\n}\n\n\nexport function centerCameraOnPlayerFast(position, TILE_SIZE, retryCount = 0) {\n  const gameContainer = document.querySelector(\".homestead\");\n  if (!gameContainer) {\n    // Container not ready yet, retry after a short delay (Safari fix)\n    if (retryCount < 5) {\n      requestAnimationFrame(() => centerCameraOnPlayerFast(position, TILE_SIZE, retryCount + 1));\n    }\n    return;\n  }\n\n  // Guard against undefined position during network delays\n  if (!position || typeof position.x !== 'number' || typeof position.y !== 'number') {\n    console.warn(' [CAMERA FAST] Cannot center camera - invalid position:', position);\n    return;\n  }\n\n  const LEFT_PANEL_WIDTH = 300;  // Scaled with zoom level\n  const HEADER_HEIGHT = 200;     // Same\n\n  const centerX = position.x * TILE_SIZE - (window.innerWidth - LEFT_PANEL_WIDTH) / 2;\n  const centerY = position.y * TILE_SIZE - (window.innerHeight - HEADER_HEIGHT) / 2;\n\n  // Clamp scroll positions so we don't scroll beyond the container's bounds\n  const maxScrollLeft = gameContainer.scrollWidth - gameContainer.clientWidth;\n  const maxScrollTop = gameContainer.scrollHeight - gameContainer.clientHeight;\n\n  // Safari fix: If container hasn't laid out yet (scroll dimensions are 0), retry\n  if (maxScrollLeft <= 0 && maxScrollTop <= 0 && centerX > 0 && retryCount < 10) {\n    console.log(` [CAMERA FAST] Container not ready, retrying... (attempt ${retryCount + 1})`);\n    requestAnimationFrame(() => centerCameraOnPlayerFast(position, TILE_SIZE, retryCount + 1));\n    return;\n  }\n\n  const clampedX = Math.max(0, Math.min(centerX, maxScrollLeft));\n  const clampedY = Math.max(0, Math.min(centerY, maxScrollTop));\n\n  gameContainer.scrollTo({\n    left: clampedX,\n    top: clampedY,\n  });\n\n  console.log(` Camera centered on player at (${position.x}, ${position.y})`);\n}\n\nexport async function isTileValidForPlayer(x, y, tiles, resources, masterResources, currentPlayer = null, updateStatus = null, strings = null, TILE_SIZE = null) {\n  x = Math.floor(x);\n  y = Math.floor(y);\n  // Check if tile is out of bounds\n  if (x < 0 || y < 0 || y >= tiles.length || x >= tiles[0].length) {\n    console.warn(` Tile (${x}, ${y}) is out of bounds.`);\n    return false;\n  }\n  // Get the tile type\n  const tileType = tiles[y][x];\n  // Ensure the tile type exists\n  if (!tileType) { console.warn(` Invalid tile at (${x}, ${y}) - No tileType found.`); return false; }\n\n  // **Special case: If player is in boat, they can only move on water tiles**\n  if (currentPlayer?.isinboat) {\n    if (tileType === 'w') {\n      console.log(` Boat player can move to water tile (${x}, ${y})`);\n      return true;\n    } else {\n      console.warn(` Boat player cannot move to non-water tile (${x}, ${y}): ${tileType}`);\n      return false;\n    }\n  }\n\n  // **Step 1: Check if tile itself is passable using masterResources (normal players)**\n  const tileResource = masterResources.find(resource => resource.type === tileType);\n\n  if (!tileResource || !tileResource.passable) {\n    console.warn(` Tile (${x}, ${y}) is not passable according to masterResources.`);\n    return false;\n  }\n  // **Step 2: Check for an impassable resource in this tile**\n  \n  const resourceInTile = resources.find(res => res.x === x && res.y === y);\n  \n  \n  if (resourceInTile) {\n    // Check if passable is explicitly false (not just falsy)\n    if (resourceInTile.passable === false) {\n      // Check if it's a door\n      if (resourceInTile.action === 'door') {\n        // Import the canPassThroughDoor function dynamically\n        const { canPassThroughDoor } = await import('./GameFeatures/Doors/Doors');\n        if (canPassThroughDoor(resourceInTile, currentPlayer, updateStatus, strings, TILE_SIZE)) {\n          console.log(` Player has access - allowing passage through door at (${x}, ${y})`);\n          return true;\n        }\n        // If canPassThroughDoor returned false, it already showed the message\n        return false;\n      }\n\n      console.warn(` Tile (${x}, ${y}) contains an impassable resource (${resourceInTile.type}).`);\n      return false;\n    }\n  }\n\n  // **Step 3: Check if there's an impassable NPC in this tile**\n  if (currentPlayer?.location?.g) {\n    const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentPlayer.location.g);\n    if (npcsInGrid) {\n      const npcInTile = Object.values(npcsInGrid).find(npc =>\n        Math.floor(npc.position?.x) === x && Math.floor(npc.position?.y) === y\n      );\n      if (npcInTile && npcInTile.passable === false) {\n        console.warn(` Tile (${x}, ${y}) contains an impassable NPC (${npcInTile.type}).`);\n        return false;\n      }\n    }\n  }\n\n  //  If all checks pass, movement is allowed\n  return true;\n}\n\n// Export renderPositions at the end to avoid initialization issues\nexport { renderPositions };","import API_BASE from '../config';\nimport axios from 'axios';\n\nlet masterSkills = null;\nlet masterResources = null;\nlet globalTuning = null;\nlet masterInteractions = null;\nlet masterTraders = null;\nlet masterTrophies = null;\nlet masterWarehouse = null;\nlet masterXPLevels = null;\n/**\n * Fetch and cache skillsTuning.json\n */\nexport async function loadMasterSkills() {\n  if (!masterSkills) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/skills-tuning`);\n      masterSkills = response.data;\n      console.log('Skills tuning loaded:', masterSkills);\n    } catch (error) {\n      console.error('Error fetching master skills:', error);\n      masterSkills = {};\n    }\n  }\n  return masterSkills;\n}\n\n/**\n * Fetch and cache resources.json\n */\nexport async function loadMasterResources() {\n  if (!masterResources) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/resources`);\n      masterResources = response.data;\n      console.log('Master resources loaded:', masterResources);\n    } catch (error) {\n      console.error('Error fetching master resources:', error);\n      masterResources = [];\n    }\n  }\n  return masterResources;\n}\n\n\n/**\n * Fetch and cache globalTuning.json\n */\nexport async function loadGlobalTuning() {\n  if (!globalTuning) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/global-tuning`);\n      globalTuning = response.data;\n      console.log('Global tuning loaded:', globalTuning);\n    } catch (error) {\n      console.error('Error fetching global tuning:', error);\n      globalTuning = {};\n    }\n  }\n  return globalTuning;\n}\n\n/**\n * Fetch and cache interactions.json\n */\nexport async function loadMasterInteractions() {\n  if (!masterInteractions) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/interactions`);\n      masterInteractions = response.data;\n      console.log('Master interactions loaded:', masterInteractions);\n    } catch (error) {\n      console.error('Error fetching master interactions:', error);\n      masterInteractions = [];\n    }\n  }\n  return masterInteractions;\n}\n\n/**\n * Fetch and cache traders.json\n */\nexport async function loadMasterTraders() {\n  if (!masterTraders) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/traders`);\n      masterTraders = response.data;\n      console.log('Master traders loaded:', masterTraders);\n    } catch (error) {\n      console.error('Error fetching master traders:', error);\n      masterTraders = [];\n    }\n  }\n  return masterTraders;\n}\n\n/**\n * Fetch and cache trophies.json\n */\nexport async function loadMasterTrophies() {\n  if (!masterTrophies) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/trophies`);\n      masterTrophies = response.data;\n      console.log('Master trophies loaded:', masterTrophies);\n    } catch (error) {\n      console.error('Error fetching master trophies:', error);\n      masterTrophies = [];\n    }\n  }\n  return masterTrophies;\n}\n\n/**\n * Fetch and cache warehouse.json\n */\nexport async function loadMasterWarehouse() {\n  if (!masterWarehouse) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/warehouse`);\n      masterWarehouse = response.data;\n      console.log('Master warehouse loaded:', masterWarehouse);\n    } catch (error) {\n      console.error('Error fetching master warehouse:', error);\n      masterWarehouse = [];\n    }\n  }\n  return masterWarehouse;\n}\n\n/**\n * Fetch and cache xpLevels.json\n */\nexport async function loadMasterXPLevels() {\n  if (!masterXPLevels) {\n    try {\n      const response = await axios.get(`${API_BASE}/api/xp-levels`);\n      masterXPLevels = response.data;\n      console.log('Master XP levels loaded:', masterXPLevels);\n    } catch (error) {\n      console.error('Error fetching master XP levels:', error);\n      masterXPLevels = [];\n    }\n  }\n  return masterXPLevels;\n}\n\n/**\n * Clear cached data (optional, for debugging or forced reloads).\n */\nexport function clearTuningCache() {\n  masterSkills = null;\n  masterResources = null;\n  masterTraders = null;\n  masterTrophies = null;\n  masterWarehouse = null;\n  masterXPLevels = null;\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};function X(){throw Error(\"act(...) is not supported in production builds of React.\");}\nexports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;exports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;\nexports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;exports.act=X;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=X;exports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};\nexports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};exports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};\nexports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};exports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.3.1\";\n","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(Symbol.toStringTag in val) && !(Symbol.iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[Symbol.iterator];\n\n  const iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[Symbol.toStringTag] === 'FormData' && thing[Symbol.iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isHeaders(header)) {\n      for (const [key, value] of header.entries()) {\n        setHeader(value, key, rewrite);\n      }\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn.apply(null, args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure) {\n      const cookie = [name + '=' + encodeURIComponent(value)];\n\n      utils.isNumber(expires) && cookie.push('expires=' + new Date(expires).toGMTString());\n\n      utils.isString(path) && cookie.push('path=' + path);\n\n      utils.isString(domain) && cookie.push('domain=' + domain);\n\n      secure === true && cookie.push('secure');\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n      return (match ? decodeURIComponent(match[3]) : null);\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000);\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop , caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop , caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop , caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b , prop) => mergeDeepProperties(headersToObject(a), headersToObject(b),prop, true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let {data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth} = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  let contentType;\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // Let the browser set it\n    } else if ((contentType = headers.getContentType()) !== false) {\n      // fix semicolon duplication issue for ReactNative FormData implementation\n      const [type, ...tokens] = contentType ? contentType.split(';').map(token => token.trim()).filter(Boolean) : [];\n      headers.setContentType([type || 'multipart/form-data', ...tokens].join('; '));\n    }\n  }\n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst isFetchSupported = typeof fetch === 'function' && typeof Request === 'function' && typeof Response === 'function';\nconst isReadableStreamSupported = isFetchSupported && typeof ReadableStream === 'function';\n\n// used only inside the fetch adapter\nconst encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n    ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n    async (str) => new Uint8Array(await new Response(str).arrayBuffer())\n);\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst supportsRequestStream = isReadableStreamSupported && test(() => {\n  let duplexAccessed = false;\n\n  const hasContentType = new Request(platform.origin, {\n    body: new ReadableStream(),\n    method: 'POST',\n    get duplex() {\n      duplexAccessed = true;\n      return 'half';\n    },\n  }).headers.has('Content-Type');\n\n  return duplexAccessed && !hasContentType;\n});\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst supportsResponseStream = isReadableStreamSupported &&\n  test(() => utils.isReadableStream(new Response('').body));\n\n\nconst resolvers = {\n  stream: supportsResponseStream && ((res) => res.body)\n};\n\nisFetchSupported && (((res) => {\n  ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n    !resolvers[type] && (resolvers[type] = utils.isFunction(res[type]) ? (res) => res[type]() :\n      (_, config) => {\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n  });\n})(new Response));\n\nconst getBodyLength = async (body) => {\n  if (body == null) {\n    return 0;\n  }\n\n  if(utils.isBlob(body)) {\n    return body.size;\n  }\n\n  if(utils.isSpecCompliantForm(body)) {\n    const _request = new Request(platform.origin, {\n      method: 'POST',\n      body,\n    });\n    return (await _request.arrayBuffer()).byteLength;\n  }\n\n  if(utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n    return body.byteLength;\n  }\n\n  if(utils.isURLSearchParams(body)) {\n    body = body + '';\n  }\n\n  if(utils.isString(body)) {\n    return (await encodeText(body)).byteLength;\n  }\n}\n\nconst resolveBodyLength = async (headers, body) => {\n  const length = utils.toFiniteNumber(headers.getContentLength());\n\n  return length == null ? getBodyLength(body) : length;\n}\n\nexport default isFetchSupported && (async (config) => {\n  let {\n    url,\n    method,\n    data,\n    signal,\n    cancelToken,\n    timeout,\n    onDownloadProgress,\n    onUploadProgress,\n    responseType,\n    headers,\n    withCredentials = 'same-origin',\n    fetchOptions\n  } = resolveConfig(config);\n\n  responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n  let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n  let request;\n\n  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n  });\n\n  let requestContentLength;\n\n  try {\n    if (\n      onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n      (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n    ) {\n      let _request = new Request(url, {\n        method: 'POST',\n        body: data,\n        duplex: \"half\"\n      });\n\n      let contentTypeHeader;\n\n      if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n        headers.setContentType(contentTypeHeader)\n      }\n\n      if (_request.body) {\n        const [onProgress, flush] = progressEventDecorator(\n          requestContentLength,\n          progressEventReducer(asyncDecorator(onUploadProgress))\n        );\n\n        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n      }\n    }\n\n    if (!utils.isString(withCredentials)) {\n      withCredentials = withCredentials ? 'include' : 'omit';\n    }\n\n    // Cloudflare Workers throws when credentials are defined\n    // see https://github.com/cloudflare/workerd/issues/902\n    const isCredentialsSupported = \"credentials\" in Request.prototype;\n    request = new Request(url, {\n      ...fetchOptions,\n      signal: composedSignal,\n      method: method.toUpperCase(),\n      headers: headers.normalize().toJSON(),\n      body: data,\n      duplex: \"half\",\n      credentials: isCredentialsSupported ? withCredentials : undefined\n    });\n\n    let response = await fetch(request);\n\n    const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n    if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n      const options = {};\n\n      ['status', 'statusText', 'headers'].forEach(prop => {\n        options[prop] = response[prop];\n      });\n\n      const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n        responseContentLength,\n        progressEventReducer(asyncDecorator(onDownloadProgress), true)\n      ) || [];\n\n      response = new Response(\n        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n          flush && flush();\n          unsubscribe && unsubscribe();\n        }),\n        options\n      );\n    }\n\n    responseType = responseType || 'text';\n\n    let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n    !isStreamResponse && unsubscribe && unsubscribe();\n\n    return await new Promise((resolve, reject) => {\n      settle(resolve, reject, {\n        data: responseData,\n        headers: AxiosHeaders.from(response.headers),\n        status: response.status,\n        statusText: response.statusText,\n        config,\n        request\n      })\n    })\n  } catch (err) {\n    unsubscribe && unsubscribe();\n\n    if (err && err.name === 'TypeError' && /fetch/i.test(err.message)) {\n      throw Object.assign(\n        new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n        {\n          cause: err.cause || err\n        }\n      )\n    }\n\n    throw AxiosError.from(err, err && err.code, config, request);\n  }\n});\n\n\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: fetchAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nconst renderReason = (reason) => `- ${reason}`;\n\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    const rejectedReasons = {};\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      let id;\n\n      adapter = nameOrAdapter;\n\n      if (!isResolvedHandle(nameOrAdapter)) {\n        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n        if (adapter === undefined) {\n          throw new AxiosError(`Unknown adapter '${id}'`);\n        }\n      }\n\n      if (adapter) {\n        break;\n      }\n\n      rejectedReasons[id || '#' + i] = adapter;\n    }\n\n    if (!adapter) {\n\n      const reasons = Object.entries(rejectedReasons)\n        .map(([id, state]) => `adapter ${id} ` +\n          (state === false ? 'is not supported by the environment' : 'is not available in the build')\n        );\n\n      let s = length ?\n        (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n        'as no adapter specified';\n\n      throw new AxiosError(\n        `There is no suitable adapter to dispatch the request ` + s,\n        'ERR_NOT_SUPPORT'\n      );\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.8.4\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig;\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","// Configure animation durations (in milliseconds)\nconst VFX_TIMING = {\n    COLLECT_DURATION: 500,      // Doober collection poof animation\n    SWIPE_DURATION: 1000,        // Source conversion swipe animation (was 400)\n    FADE_DURATION: 400,         // How long fade-out takes\n};\n\n// Track recent effects to prevent duplicates\nconst recentEffects = new Map();\n\nconst createParticleElement = (char, x, y) => {\n    const particle = document.createElement('div');\n    particle.innerText = char;\n    particle.style.position = 'absolute';\n    particle.style.left = `${x}px`;\n    particle.style.top = `${y}px`;\n    particle.style.pointerEvents = 'none';\n    particle.style.zIndex = '1000';\n    particle.style.fontSize = '12px';\n    return particle;\n};\n\n// Add this utility function\nexport const calculateTileCenter = (x, y, TILE_SIZE) => {\n    const centerX = (x * TILE_SIZE) + (TILE_SIZE / 2) - 6;\n    const centerY = (y * TILE_SIZE) + (TILE_SIZE / 2) - 6;\n    return { centerX, centerY };\n};\n\nexport const createCollectEffect = (x, y, TILE_SIZE) => {\n    const gameContainer = document.querySelector('.homestead');\n    if (!gameContainer) return;\n    \n    // Debounce duplicate effects at the same location\n    const effectKey = `collect-${x}-${y}`;\n    const now = Date.now();\n    const lastEffectTime = recentEffects.get(effectKey);\n    \n    if (lastEffectTime && (now - lastEffectTime) < 100) {\n        console.log('Skipping duplicate collect effect at', x, y);\n        return;\n    }\n    \n    recentEffects.set(effectKey, now);\n    \n    // Clean up old entries after 1 second\n    setTimeout(() => {\n        recentEffects.delete(effectKey);\n    }, 1000);\n    \n    // Try to find the actual tile element to get its real position\n    const tiles = gameContainer.querySelectorAll('.tile');\n    let tileElement = null;\n    \n    // Find the tile at position (x, y) by checking computed positions\n    tiles.forEach(tile => {\n        const tileTop = parseInt(tile.style.top) / TILE_SIZE;\n        const tileLeft = parseInt(tile.style.left) / TILE_SIZE;\n        if (Math.round(tileLeft) === x && Math.round(tileTop) === y) {\n            tileElement = tile;\n        }\n    });\n    \n    let centerX, centerY;\n    \n    if (tileElement) {\n        // Use the actual tile's position for accurate placement\n        const rect = tileElement.getBoundingClientRect();\n        const containerRect = gameContainer.getBoundingClientRect();\n        centerX = rect.left - containerRect.left + (rect.width / 2) - 6;\n        centerY = rect.top - containerRect.top + (rect.height / 2) - 6;\n    } else {\n        // Fallback to calculated position\n        const { centerX: calcX, centerY: calcY } = calculateTileCenter(x, y, TILE_SIZE);\n        centerX = calcX;\n        centerY = calcY;\n    }\n    \n    console.log('createCollectEffect at grid(', x, ',', y, ') -> screen(', centerX, ',', centerY, ')');\n\n    const directions = [\n        { dx: -1, dy: -1, startX: -2, startY: -2 }, \n        { dx: 1, dy: -1, startX: 2, startY: -2 },  \n        { dx: -1, dy: 1, startX: -2, startY: 2 },   \n        { dx: 1, dy: 1, startX: 2, startY: 2 }     \n    ];\n\n    directions.forEach(dir => {\n        // Position particle at tile center + small initial offset\n        const particle = createParticleElement('', \n            centerX + dir.startX, \n            centerY + dir.startY\n        );\n        gameContainer.appendChild(particle);\n\n        // Animate outward from center\n        particle.style.transition = 'all 0.5s ease-out';\n        requestAnimationFrame(() => {\n            particle.style.transform = `translate(${dir.dx * 20}px, ${dir.dy * 20}px)`;\n            particle.style.opacity = '0';\n        });\n\n        setTimeout(() => {\n            gameContainer.removeChild(particle);\n        }, VFX_TIMING.COLLECT_DURATION);\n    });\n};\n \nexport const createSourceConversionEffect = (x, y, TILE_SIZE, requiredSkill) => {\n    const gameContainer = document.querySelector('.homestead');\n    if (!gameContainer) return;\n    console.log('createSourceConversionEffect called with x:', x, 'y:', y, 'requiredSkill:', requiredSkill);\n    // Determine emoji based on required skill\n    const emoji = requiredSkill?.includes('Axe') ? '' : \n                 requiredSkill?.includes('Pickaxe') ? '' : \n                 requiredSkill?.includes('Golden Key') ? '' : \n                  requiredSkill?.includes('Skeleton Key') ? '' : \n                '';\n\n    const { centerX, centerY } = calculateTileCenter(x, y, TILE_SIZE);\n    \n    const particle = document.createElement('div');\n    particle.innerText = emoji;\n    particle.style.position = 'absolute';\n    particle.style.left = `${centerX - TILE_SIZE/2 + 5}px`; // Added OFFSET\n    particle.style.top = `${centerY - TILE_SIZE/2 - 4}px`;\n    particle.style.pointerEvents = 'none';\n    particle.style.zIndex = '1000';\n    particle.style.fontSize = '28px';\n    gameContainer.appendChild(particle);\n\n    particle.style.transition = `all ${VFX_TIMING.SWIPE_DURATION}ms cubic-bezier(0.2, 0, 0, 1)`; // More forceful start, gentle end\n    requestAnimationFrame(() => {\n        particle.style.transform = `translate(-${TILE_SIZE}px, ${TILE_SIZE}px)`;\n        particle.style.opacity = '0';\n    });\n\n    setTimeout(() => {\n        gameContainer.removeChild(particle);\n    }, VFX_TIMING.SWIPE_DURATION); // Match the new animation duration\n};\n","import API_BASE from '../config';\nimport axios from 'axios';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients } from '../Utils/InventoryManagement';\nimport { updateGridResource } from '../Utils/GridManagement';\nimport { addResourceToGrid } from '../Utils/worldHelpers';\nimport FloatingTextManager from '../UI/FloatingText';\nimport { trackQuestProgress } from './Quests/QuestGoalTracker';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { getCurrentTileCoordinates, enrichResourceFromMaster } from '../Utils/ResourceHelpers';\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { createCollectEffect } from '../VFX/VFX';\n\nexport const handleConstructionWithGems = async (params) => {\n  // Wrapper function that uses a modified recipe if provided\n  if (params.modifiedRecipe) {\n    // Replace the selected resource in buildOptions with the modified recipe\n    const modifiedBuildOptions = params.buildOptions.map(item =>\n      item.type === params.modifiedRecipe.type ? params.modifiedRecipe : item\n    );\n    return handleConstruction({\n      ...params,\n      buildOptions: modifiedBuildOptions,\n    });\n  }\n  return handleConstruction(params);\n};\n\nexport const handleConstruction = async ({\n  TILE_SIZE,\n  selectedItem,\n  buildOptions,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  updateStatus,\n  overridePosition, // Optional: { x, y } for cursor mode placement\n}) => {\n  if (!currentPlayer) {\n    console.warn('Current Player not provided; inventory changes will not be saved.');\n    return false;\n  }\n  if (!selectedItem) {\n    console.warn('Invalid building selection.');\n    return false;\n  }\n  // **Get player position dynamically **\n  const playerId = currentPlayer._id.toString();  // Convert ObjectId to string\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  const player = playersInGrid?.[playerId];\n  const playerPosition = player?.position;  // Use grid-relative coordinates directly (no scaling)\n\n  // Use override position if provided (cursor mode), otherwise use player position\n  let x, y;\n  if (overridePosition) {\n    x = overridePosition.x;\n    y = overridePosition.y;\n  } else {\n    const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n    if (!coords) return false;\n    x = coords.tileX;\n    y = coords.tileY;\n  }\n\n  console.log('playerPosition = ', playerPosition);\n  console.log('x = ', x, \" y = \", y);\n\n  // Ensure valid player position\n  if (!playerPosition || x == null || y == null) {\n    console.warn('Player position is invalid.');\n    return false;\n  }\n\n  const selectedResource = buildOptions.find((item) => item.type === selectedItem);\n\n  // Check if this is a multi-tile resource\n  const resourceRange = selectedResource.range || 1;\n  console.log(` Building ${selectedItem} with range ${resourceRange}`);\n\n  // Skip tile occupation check for NPCs since they don't occupy grid tiles\n  if (selectedResource.category !== 'npc') {\n    // For multi-tile resources, check all required tiles\n    // Using player position as lower-left anchor\n    const tilesToCheck = [];\n    for (let dx = 0; dx < resourceRange; dx++) {\n      for (let dy = 0; dy < resourceRange; dy++) {\n        tilesToCheck.push({ x: x + dx, y: y - dy });\n      }\n    }\n\n    console.log(' Tiles to check for placement:', tilesToCheck);\n\n    // Check if any of the required tiles are occupied\n    const occupiedTile = tilesToCheck.find(tile => \n      resources.some(res => res.x === tile.x && res.y === tile.y)\n    );\n\n    if (occupiedTile) {\n      console.warn(`Cannot build ${selectedItem} - tile at (${occupiedTile.x}, ${occupiedTile.y}) is occupied.`);\n      FloatingTextManager.addFloatingText(306, x, y, TILE_SIZE);\n      return false; // Exit before deducting inventory\n    }\n  }\n\n  const success = await spendIngredients({\n    playerId: currentPlayer.playerId,\n    recipe: selectedResource,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n  });\n  if (!success) {\n    FloatingTextManager.addFloatingText(305, playerPosition.x, playerPosition.y, TILE_SIZE);\n    return false;\n  }\n  // refreshPlayerAfterInventoryUpdate is already called inside spendIngredients\n\n  console.log('selectedResource.action=', selectedResource.action);\n\n  // Calculate total cost for status message\n  const costDetails = [];\n  for (let i = 1; i <= 4; i++) {\n    const ingredientType = selectedResource[`ingredient${i}`];\n    const ingredientQty = selectedResource[`ingredient${i}qty`];\n    if (ingredientType && ingredientQty) {\n      costDetails.push(`${ingredientQty} ${ingredientType}`);\n    }\n  }\n  const costString = costDetails.length > 0 ? costDetails.join(', ') : 'free';\n\n  if (selectedResource.category === 'npc') {\n    // Spawning NPC at the target position (cursor position if in cursor mode, otherwise player position)\n    const spawnPosition = overridePosition ? { x, y } : playerPosition;\n    NPCsInGridManager.spawnNPC(gridId, selectedResource, spawnPosition);\n    console.log('Spawned NPC:', gridId, selectedResource, spawnPosition);\n\n    // Show VFX and floating text for NPC purchase\n    createCollectEffect(x, y, TILE_SIZE);\n    FloatingTextManager.addFloatingText(300, x, y, TILE_SIZE);\n    \n    // Show status message with purchase details\n    updateStatus(`${selectedResource.type} purchased for ${costString}.`);\n    \n    // Track quest progress for \"Buy\" actions\n    await trackQuestProgress(currentPlayer, 'Buy', selectedResource.type, 1, setCurrentPlayer);\n\n  } else {\n    console.log('Placing resource on the grid:', selectedItem);\n    const debugBefore = resources.find(res => res.x === x && res.y === y);\n    console.log(' Existing resource at location before setResources:', debugBefore);\n\n    const rawResource = { type: selectedItem, x, y };\n    const enriched = enrichResourceFromMaster(rawResource, buildOptions); // buildOptions contains masterResources\n    \n    // Ensure range is included for multi-tile resources\n    if (resourceRange > 1) {\n      enriched.range = resourceRange;\n      enriched.anchorKey = `${selectedItem}_${x}_${y}`;\n    }\n    \n    let finalResources = [...resources, enriched];\n\n    console.log(' Preparing resource update with:', enriched);\n    \n    try {\n      // Create shadow placeholders for multi-tile objects in LOCAL STATE ONLY\n      if (resourceRange > 1) {\n        \n        for (let dx = 0; dx < resourceRange; dx++) {\n          for (let dy = 0; dy < resourceRange; dy++) {\n            // Skip the anchor tile (0,0)\n            if (dx === 0 && dy === 0) continue;\n            \n            const shadowX = x + dx;\n            const shadowY = y - dy;\n            const shadowResource = {\n              type: 'shadow',\n              x: shadowX,\n              y: shadowY,\n              parentAnchorKey: enriched.anchorKey,\n              passable: enriched.passable // Inherit passable property from parent\n              // No symbol - renders as empty/invisible\n            };\n            \n            \n            // Add shadow to final resources array (LOCAL STATE ONLY - NOT SAVED TO DB)\n            finalResources.push(shadowResource);\n          }\n        }\n      }\n      \n      // Update local state ONCE with all resources (main + shadows)\n      console.log(' Updating local state with all resources');\n      GlobalGridStateTilesAndResources.setResources(finalResources);\n      setResources(finalResources);\n      \n      // Update ONLY the main resource in DB (NOT shadows)\n      await updateGridResource(gridId, rawResource, true);\n\n      // Show VFX and floating text for resource placement\n      createCollectEffect(x, y, TILE_SIZE);\n      FloatingTextManager.addFloatingText(300, playerPosition.x, playerPosition.y, TILE_SIZE);\n      \n      // Show status message with purchase details\n      updateStatus(`${selectedItem} purchased for ${costString}.`);\n      \n      // Track quest progress sequentially to avoid conflicts\n      await trackQuestProgress(currentPlayer, 'Build', selectedItem, 1, setCurrentPlayer);\n      await trackQuestProgress(currentPlayer, 'Buy', selectedItem, 1, setCurrentPlayer);\n      return true; // Success\n    } catch (error) {\n      console.error('Error placing resource on grid:', error);\n      return false;\n    }\n  }\n  return true; // Success (for NPC category)\n};","import API_BASE from '../../config';\nimport axios from 'axios';\n\n/**\n * Updates quest progress for a given player.\n * @param {Object} player - Current player object.\n * @param {String} action - Action performed (e.g., \"Skill\", \"Craft\").\n * @param {String} item - Item associated with the action (e.g., \"Horse\", \"Axe\").\n * @param {Number} quantity - Quantity of the item affected.\n * @param {Function} setCurrentPlayer - State updater for the current player.\n */\nexport async function trackQuestProgress(player, action, item, quantity, setCurrentPlayer) {\n  if (!player?.activeQuests?.length) return;\n\n  console.log(\"At trackQuestProgress; action = \",action);\n\n  let questUpdated = false;\n\n  const updatedQuests = player.activeQuests.map((quest) => {\n    if (quest.completed || quest.rewardCollected) return quest; // Skip completed or rewarded quests\n\n    const progress = { ...quest.progress };\n    let goalsCompleted = 0; // Tracks how many goals are completed\n    let totalGoals = 0;     // Tracks total defined goals\n\n    for (let i = 1; i <= 3; i++) {\n      const goalAction = quest[`goal${i}action`];\n      const goalItem = quest[`goal${i}item`];\n      const goalQty = quest[`goal${i}qty`];\n\n      if (!goalAction || !goalItem || !goalQty) continue; // Skip undefined goals\n      totalGoals++; // Count this as a valid goal\n\n      if (goalAction === action && goalItem === item) {\n        progress[`goal${i}`] = Math.min((progress[`goal${i}`] || 0) + quantity, goalQty); // Increment progress\n      }\n\n      // Check if the goal is completed\n      if (progress[`goal${i}`] >= goalQty) goalsCompleted++;\n    }\n\n    // Mark quest as completed if all goals are done\n    if (goalsCompleted === totalGoals && totalGoals > 0) {\n      quest.completed = true;\n    }\n\n    quest.progress = progress;\n    questUpdated = true;\n\n    return quest;\n  });\n\n  if (questUpdated) {\n    try {\n      console.log(\"Saving updated player quests; updatedQuests = \", updatedQuests);\n      const response = await axios.post(`${API_BASE}/api/update-player-quests`, {\n        playerId: player.playerId,\n        activeQuests: updatedQuests,\n      });\n      if (typeof setCurrentPlayer === 'function') {\n        // Only update quest-related fields to avoid overwriting inventory changes\n        setCurrentPlayer(prev => ({\n          ...prev,\n          activeQuests: response.data.player.activeQuests || updatedQuests\n        }));\n      }    \n      } catch (error) {\n      console.error('Error updating quest progress:', error);\n    }\n  }\n}","import axios from 'axios';\nimport API_BASE from '../../config';\nimport { showNotification } from '../../UI/Notifications/Notifications';\n\n/**\n * Earns a trophy for the player\n * @param {string} playerId - The player's ID\n * @param {string} trophyName - The name of the trophy to earn (must match trophies.json)\n * @param {number} progressIncrement - For Progress trophies, the amount to increment (default 1)\n * @param {Object} currentPlayer - The current player object (optional, for Event trophy checking)\n * @param {Array} masterTrophies - The master trophies list (optional, for Event trophy checking)\n * @param {Function} setCurrentPlayer - Function to update local player state (optional)\n * @returns {Promise<Object>} The result of the API call\n */\nexport async function earnTrophy(playerId, trophyName, progressIncrement = 1, currentPlayer = null, masterTrophies = null, setCurrentPlayer = null) {\n    try {\n        // If we have currentPlayer and masterTrophies, check if this is an Event trophy that's already earned\n        if (currentPlayer && masterTrophies) {\n            const trophyDef = masterTrophies.find(t => t.name === trophyName);\n            if (trophyDef && trophyDef.type === 'Event') {\n                // Check if player already has this Event trophy\n                const hasEventTrophy = currentPlayer.trophies?.some(t => t.name === trophyName);\n                if (hasEventTrophy) {\n                    console.log(` Player already has Event trophy: ${trophyName}`);\n                    return { success: false, message: 'Trophy already earned' };\n                }\n            }\n        }\n        \n        const response = await axios.post(`${API_BASE}/api/earn-trophy`, {\n            playerId,\n            trophyName,\n            progressIncrement\n        });\n        \n        if (response.data.success) {\n            const { trophy, isNewMilestone } = response.data;\n            \n            // Update local player state with the new trophy\n            if (setCurrentPlayer && currentPlayer && isNewMilestone) {\n                setCurrentPlayer(prevPlayer => {\n                    const updatedTrophies = [...(prevPlayer.trophies || [])];\n                    \n                    // Check if trophy already exists (for Progress trophies)\n                    const existingTrophyIndex = updatedTrophies.findIndex(t => t.name === trophyName);\n                    \n                    if (existingTrophyIndex !== -1) {\n                        // Update existing trophy\n                        updatedTrophies[existingTrophyIndex] = {\n                            ...updatedTrophies[existingTrophyIndex],\n                            progress: trophy.progress,\n                            qty: trophy.qty,\n                            collected: false, // Reset collected status for new milestone\n                            timestamp: new Date()\n                        };\n                    } else {\n                        // Add new trophy\n                        updatedTrophies.push({\n                            name: trophyName,\n                            progress: trophy.progress,\n                            qty: trophy.qty,\n                            collected: false,\n                            timestamp: new Date()\n                        });\n                    }\n                    \n                    console.log(` Local player state updated with trophy: ${trophyName}`);\n                    return {\n                        ...prevPlayer,\n                        trophies: updatedTrophies\n                    };\n                });\n            }\n            \n            if (isNewMilestone) {\n                console.log(` Trophy milestone earned: ${trophyName}`, trophy);\n                \n                // Check if trophy is visible before showing notification\n                let shouldShowNotification = true;\n                if (masterTrophies) {\n                    const trophyDef = masterTrophies.find(t => t.name === trophyName);\n                    if (trophyDef && trophyDef.visible === false) {\n                        shouldShowNotification = false;\n                        console.log(` Trophy notification suppressed for hidden trophy: ${trophyName}`);\n                    }\n                }\n                \n                // Show trophy notification only for new milestones and visible trophies\n                if (shouldShowNotification) {\n                    showNotification('Trophy', trophy);\n                }\n            } else {\n                console.log(` Trophy progress: ${trophyName} - ${trophy.progress}/${trophy.nextMilestone}`);\n            }\n            \n            return response.data;\n        }\n        \n        return response.data;\n    } catch (error) {\n        console.error('Error earning trophy:', error);\n        return { success: false, error: error.message };\n    }\n}","import axios from 'axios';\nimport API_BASE from '../../config';\nimport FTUEstepsData from './FTUEsteps.json';\n\n// Export function to get current FTUE step from DB and sync with local state\nexport const getFTUEStep = async (playerId, currentPlayer, setCurrentPlayer) => {\n  try {\n    // Fetch player data from DB\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const dbFtueStep = response.data.ftuestep;\n\n    // Update local state if different from DB\n    if (currentPlayer && currentPlayer.ftuestep !== dbFtueStep) {\n      console.log(' Syncing FTUE step from DB:', dbFtueStep);\n      setCurrentPlayer(prev => ({\n        ...prev,\n        ftuestep: dbFtueStep\n      }));\n    }\n\n    return dbFtueStep || 0;\n  } catch (error) {\n    console.error('Error fetching FTUE step:', error);\n    return currentPlayer?.ftuestep || 0;\n  }\n};\n\n// Export function to try advancing FTUE by trigger key\n// Only advances if the player is at the step immediately before the trigger's step\nexport const tryAdvanceFTUEByTrigger = async (triggerKey, playerId, currentPlayer, setCurrentPlayer) => {\n  // Only process for first-time users\n  if (!currentPlayer?.firsttimeuser) {\n    return currentPlayer?.ftuestep || 0;\n  }\n\n  // Find the step that has this trigger\n  const triggerStep = FTUEstepsData.find(step => step.trigger === triggerKey);\n  if (!triggerStep) {\n    console.log(` No FTUE step found with trigger: ${triggerKey}`);\n    return currentPlayer?.ftuestep || 0;\n  }\n\n  const currentStep = currentPlayer?.ftuestep || 0;\n  const expectedStep = triggerStep.step - 1; // Player should be at the step before\n\n  // Only advance if player is at the expected step\n  if (currentStep !== expectedStep) {\n    console.log(` Trigger \"${triggerKey}\" requires step ${expectedStep}, but player is at step ${currentStep}. Skipping.`);\n    return currentStep;\n  }\n\n  console.log(` Trigger \"${triggerKey}\" matched! Advancing from step ${currentStep} to ${triggerStep.step}`);\n  return incrementFTUEStep(playerId, currentPlayer, setCurrentPlayer);\n};\n\n// Export function to increment FTUE step in both DB and local state\nexport const incrementFTUEStep = async (playerId, currentPlayer, setCurrentPlayer) => {\n  try {\n    const currentStep = currentPlayer?.ftuestep || 0;\n    const nextStep = currentStep + 1;\n\n    // Check if the next step exists in the data\n    const nextStepExists = FTUEstepsData.some(step => step.step === nextStep);\n\n    if (!nextStepExists) {\n      console.log(' No more FTUE steps available after step', currentStep);\n      return currentStep;\n    }\n\n    // Update DB\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: { ftuestep: nextStep }\n    });\n\n    if (response.data.success) {\n      // Update local state - this will trigger the modal via the useEffect in App.js\n      setCurrentPlayer(prev => ({\n        ...prev,\n        ftuestep: nextStep\n      }));\n\n      console.log(' FTUE step incremented to:', nextStep);\n      return nextStep;\n    }\n\n    return currentStep;\n  } catch (error) {\n    console.error('Error incrementing FTUE step:', error);\n    return currentPlayer?.ftuestep || 0;\n  }\n};\n\n// Export function to add an accepted quest to player data\nexport const addAcceptedQuest = async (playerId, currentPlayer, setCurrentPlayer, questIndex) => {\n  try {\n    // Fetch quest template from API\n    const response = await axios.get(`${API_BASE}/api/quests`);\n    const questTemplates = response.data || [];\n\n    // Find the specific quest template by index\n    const questTemplate = questTemplates.find(q => q.index === questIndex);\n    if (!questTemplate) {\n      console.error(` Quest template not found for index: ${questIndex}`);\n      return currentPlayer;\n    }\n\n    // Create the quest object following the activeQuests format\n    const newQuest = {\n      questId: questTemplate.title, // Use title from template\n      startTime: Date.now(),\n      symbol: questTemplate.symbol || '',\n      progress: {\n        goal1: 0,\n        goal2: 0,\n        goal3: 0\n      },\n      completed: false,\n      rewardCollected: false,\n      // Add goal fields from template\n      goal1action: questTemplate.goal1action || null,\n      goal1item: questTemplate.goal1item || null,\n      goal1qty: questTemplate.goal1qty || null,\n      goal2action: questTemplate.goal2action || null,\n      goal2item: questTemplate.goal2item || null,\n      goal2qty: questTemplate.goal2qty || null,\n      goal3action: questTemplate.goal3action || null,\n      goal3item: questTemplate.goal3item || null,\n      goal3qty: questTemplate.goal3qty || null\n    };\n\n    // Get current active quests\n    const currentActiveQuests = currentPlayer?.activeQuests || [];\n\n    // Check if quest already exists\n    const questExists = currentActiveQuests.some(q => q.questId === questTemplate.title);\n    if (questExists) {\n      console.log(` Quest \"${questTemplate.title}\" already exists in active quests`);\n      return currentPlayer;\n    }\n\n    // Add new quest to active quests\n    const updatedActiveQuests = [...currentActiveQuests, newQuest];\n\n    // Update database\n    const updateResponse = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: { activeQuests: updatedActiveQuests }\n    });\n\n    if (updateResponse.data.success) {\n      // Update local state\n      const updatedPlayer = {\n        ...currentPlayer,\n        activeQuests: updatedActiveQuests\n      };\n      setCurrentPlayer(updatedPlayer);\n\n      console.log(` Quest \"${questTemplate.title}\" added to active quests`);\n      return updatedPlayer;\n    }\n\n    return currentPlayer;\n  } catch (error) {\n    console.error('Error adding accepted quest:', error);\n    return currentPlayer;\n  }\n};\n\n// Export function to complete the FTUE tutorial\nexport const completeTutorial = async (playerId, currentPlayer, setCurrentPlayer, onClose) => {\n  try {\n    // First check if the Wizard quest (index=1) has already been added\n    const currentActiveQuests = currentPlayer?.activeQuests || [];\n    const wizardQuestExists = currentActiveQuests.some(q => q.questId === \"Find the Wizard in the Valley\");\n\n    let finalActiveQuests = currentActiveQuests;\n\n    if (!wizardQuestExists) {\n      console.log(' Adding completed Wizard quest before completing tutorial');\n\n      // Add the quest with index=1\n      const updatedPlayer = await addAcceptedQuest(playerId, currentPlayer, setCurrentPlayer, 1);\n\n      // Mark it as completed\n      if (updatedPlayer.activeQuests && updatedPlayer.activeQuests.length > 0) {\n        const questIndex = updatedPlayer.activeQuests.findIndex(q => q.questId === \"Find the Wizard in the Valley\");\n        if (questIndex !== -1) {\n          updatedPlayer.activeQuests[questIndex].completed = true;\n          finalActiveQuests = updatedPlayer.activeQuests;\n\n          // Save the completed quest\n          await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: playerId,\n            updates: { activeQuests: finalActiveQuests }\n          });\n        }\n      }\n    } else {\n      console.log(' Wizard quest already exists, skipping addition');\n    }\n\n\n    // Update the player's firsttimeuser flag to false and remove ftuestep\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: playerId,\n      updates: {\n        firsttimeuser: false,\n        ftuestep: null  // This will remove the field from the document\n      }\n    });\n\n    if (response.data.success) {\n      // Update local player state\n      setCurrentPlayer(prev => {\n        const updated = {\n          ...prev,\n          firsttimeuser: false,\n          activeQuests: finalActiveQuests\n        };\n        delete updated.ftuestep;  // Remove ftuestep from local state\n        return updated;\n      });\n\n      // Close the tutorial\n      if (onClose) onClose();\n    }\n  } catch (error) {\n    console.error('Error completing tutorial:', error);\n    // Close anyway to not block the user\n    if (onClose) onClose();\n  }\n};\n\n// Export function to handle feedback submission (saves feedback only, does not advance step)\nexport const handleFeedbackSubmit = async (isPositive, playerId, currentPlayer, setCurrentPlayer, positiveReasons, negativeReasons) => {\n  try {\n    // Detect browser type\n    const getBrowserType = () => {\n      const userAgent = navigator.userAgent;\n      if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) return 'Chrome';\n      if (userAgent.includes('Firefox')) return 'Firefox';\n      if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) return 'Safari';\n      if (userAgent.includes('Edg')) return 'Edge';\n      if (userAgent.includes('Opera') || userAgent.includes('OPR')) return 'Opera';\n      return 'Unknown';\n    };\n\n    const browserType = getBrowserType();\n\n    // Save feedback to database (do not advance step - let caller handle that)\n    // Use dot notation to preserve existing ftueFeedback fields (like diagnostics from account creation)\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: playerId,\n      updates: {\n        'ftueFeedback.positive': isPositive ? positiveReasons : [],\n        'ftueFeedback.negative': !isPositive ? negativeReasons : [],\n        'ftueFeedback.browser': browserType\n      }\n    });\n\n    if (response.data.success) {\n      // Update local state with feedback only, preserving existing ftueFeedback fields\n      setCurrentPlayer(prev => ({\n        ...prev,\n        ftueFeedback: {\n          ...prev.ftueFeedback,\n          positive: isPositive ? positiveReasons : [],\n          negative: !isPositive ? negativeReasons : [],\n          browser: browserType\n        }\n      }));\n      return true;\n    }\n    return false;\n  } catch (error) {\n    console.error('Error saving FTUE feedback:', error);\n    return false;\n  }\n};\n","// SVG Asset Manager - handles loading and caching SVG assets for canvas rendering\n\nclass SVGAssetManager {\n  constructor() {\n    this.svgCache = new Map(); // SVG string cache\n    this.textureCache = new Map(); // Rendered bitmap cache\n    this.loadingPromises = new Map(); // Prevent duplicate loads\n    \n    // Default zoom tiers (will be updated from globalTuning)\n    this.ZOOM_TIERS = [16, 34, 50, 68, 100, 150]; // fallback values\n  }\n\n  // Get the best zoom tier for a target size with high-DPI support\n  getBestZoomTier(targetSize) {\n    // Account for device pixel ratio for crisp rendering\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    const adjustedSize = targetSize * Math.max(devicePixelRatio, 1.5); // Always render at least 1.5x for sharpness\n    \n    return this.ZOOM_TIERS.find(tier => tier >= adjustedSize) || this.ZOOM_TIERS[this.ZOOM_TIERS.length - 1];\n  }\n\n  // Load SVG file (with caching) - supports different directories\n  async loadSVG(svgFileName, isOverlay = false) {\n    const cacheKey = isOverlay ? `overlay-${svgFileName}` : svgFileName;\n    \n    if (this.svgCache.has(cacheKey)) {\n      return this.svgCache.get(cacheKey);\n    }\n\n    // Prevent duplicate loading\n    if (this.loadingPromises.has(cacheKey)) {\n      return this.loadingPromises.get(cacheKey);\n    }\n\n    const directory = isOverlay ? '/assets/overlays/' : '/assets/resources/';\n    const loadPromise = fetch(`${directory}${svgFileName}`)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(`Failed to load SVG: ${svgFileName}`);\n        }\n        return response.text();\n      })\n      .then(svgText => {\n        this.svgCache.set(cacheKey, svgText);\n        this.loadingPromises.delete(cacheKey);\n        return svgText;\n      })\n      .catch(error => {\n        console.warn(`SVG asset not found: ${svgFileName}`, error);\n        this.loadingPromises.delete(cacheKey);\n        return null;\n      });\n\n    this.loadingPromises.set(cacheKey, loadPromise);\n    return loadPromise;\n  }\n\n  // Create high-quality texture from SVG at specific size\n  async createSVGTexture(svgText, size) {\n    return new Promise((resolve) => {\n      const canvas = document.createElement('canvas');\n      canvas.width = canvas.height = size;\n      const ctx = canvas.getContext('2d');\n      \n      // Enable better rendering quality\n      ctx.imageSmoothingEnabled = true;\n      ctx.imageSmoothingQuality = 'high';\n\n      // Create image from SVG\n      const img = new Image();\n      img.onload = () => {\n        // Render SVG at high quality\n        ctx.drawImage(img, 0, 0, size, size);\n        resolve(canvas);\n        \n        // Clean up object URL\n        URL.revokeObjectURL(img.src);\n      };\n      img.onerror = () => {\n        console.warn('Failed to render SVG to canvas');\n        URL.revokeObjectURL(img.src);\n        resolve(null);\n      };\n\n      // Convert SVG to data URL\n      const svgBlob = new Blob([svgText], { type: 'image/svg+xml;charset=utf-8' });\n      const url = URL.createObjectURL(svgBlob);\n      img.src = url;\n    });\n  }\n\n  // Get or create cached texture for SVG asset\n  async getSVGTexture(svgFileName, targetSize, isOverlay = false) {\n    // Use exact targetSize for cache key to match existing zoom system (16, 34, 50)\n    // Don't try to be smart with zoom tiers - trust the existing App.js zoom system\n    const cacheKey = `${isOverlay ? 'overlay-' : ''}${svgFileName}-${targetSize}`;\n\n    //console.log(` [SVG MANAGER] Requesting texture for ${svgFileName} at targetSize ${targetSize}, cacheKey: ${cacheKey}`);\n\n    // Return cached texture if available\n    if (this.textureCache.has(cacheKey)) {\n      //console.log(` [SVG MANAGER] Found cached texture for ${cacheKey}`);\n      return this.textureCache.get(cacheKey);\n    }\n\n    try {\n      //console.log(` [SVG MANAGER] Creating new texture for ${svgFileName}`);\n      // Load SVG and create texture\n      const svgText = await this.loadSVG(svgFileName, isOverlay);\n      if (!svgText) {\n        console.warn(` [SVG MANAGER] No SVG text loaded for ${svgFileName}`);\n        return null;\n      }\n\n      const texture = await this.createSVGTexture(svgText, targetSize);\n      if (texture) {\n        this.textureCache.set(cacheKey, texture);\n        //console.log(` [SVG MANAGER] Successfully created and cached texture for ${cacheKey}`);\n      } else {\n        console.warn(` [SVG MANAGER] Failed to create texture for ${svgFileName}`);\n      }\n      return texture;\n    } catch (error) {\n      console.error(` [SVG MANAGER] Error creating SVG texture for ${svgFileName}:`, error);\n      return null;\n    }\n  }\n\n  // Get overlay texture (convenience method)\n  async getOverlayTexture(overlayFileName, targetSize) {\n    return this.getSVGTexture(overlayFileName, targetSize, true);\n  }\n\n  // Update zoom tiers from globalTuning\n  updateZoomTiers(globalTuning) {\n    if (!globalTuning) {\n      console.warn('No globalTuning provided, using default zoom tiers');\n      return;\n    }\n    \n    // Extract zoom values from globalTuning\n    const baseZooms = [\n      globalTuning.farZoom || 16,\n      globalTuning.closeZoom || 34, \n      globalTuning.closerZoom || 50\n    ];\n    \n    // Add higher resolution variants for crisp rendering\n    const highResVariants = baseZooms.map(zoom => [\n      zoom * 1.5, // 1.5x for sharpness\n      zoom * 2,   // 2x for high-DPI\n      zoom * 3    // 3x for very high-DPI\n    ]).flat();\n    \n    // Combine and sort unique values\n    this.ZOOM_TIERS = [...new Set([...baseZooms, ...highResVariants])].sort((a, b) => a - b);\n    \n    console.log('Updated SVG zoom tiers from globalTuning:', this.ZOOM_TIERS);\n  }\n\n  // Clear cache (useful for development/testing)\n  clearCache() {\n    this.svgCache.clear();\n    this.textureCache.clear();\n    this.loadingPromises.clear();\n  }\n\n  // Get cache stats for debugging\n  getCacheStats() {\n    return {\n      svgFiles: this.svgCache.size,\n      textures: this.textureCache.size,\n      loading: this.loadingPromises.size\n    };\n  }\n}\n\n// Export singleton instance\nexport default new SVGAssetManager();","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import API_BASE from '../config';\nimport socket from '../socketManager';\nimport axios from 'axios';\nimport { animateRemotePC } from '../Render/RenderAnimatePosition';\nimport { loadMasterResources } from '../Utils/TuningManager';\n\nclass GridStatePCManager {\n    constructor() {\n      this.playersInGrid = {}; // Store PC states in memory\n      this.pendingUpdates = {}; // Track pending position updates\n      this.batchInterval = null; // Interval for batch saving\n      this.BATCH_SAVE_INTERVAL = 5000; // Save positions every 5 seconds\n    }\n \n    registerSetPlayersInGrid(setter) {\n      this.setPlayersInGridReact = setter;\n    }\n    registerTileSize(tileSize) {\n      this.tileSize = tileSize;\n    }\n    \n    // Start the batch save interval\n    startBatchSaving() {\n      if (this.batchInterval) return; // Already running\n      \n      this.batchInterval = setInterval(() => {\n        this.processPendingUpdates();\n      }, this.BATCH_SAVE_INTERVAL);\n      console.log(' Started batch saving interval');\n    }\n    \n    // Stop the batch save interval\n    stopBatchSaving() {\n      if (this.batchInterval) {\n        clearInterval(this.batchInterval);\n        this.batchInterval = null;\n      }\n      // Save any remaining updates\n      this.processPendingUpdates();\n    }\n    \n    // Process all pending position updates\n    async processPendingUpdates() {\n      const updates = Object.entries(this.pendingUpdates);\n      if (updates.length === 0) return;\n      \n      console.log(` Processing ${updates.length} pending PC position updates`);\n      \n      // Group updates by gridId for batch processing\n      const updatesByGrid = {};\n      for (const [key, data] of updates) {\n        if (!updatesByGrid[data.gridId]) {\n          updatesByGrid[data.gridId] = {};\n        }\n        updatesByGrid[data.gridId][data.playerId] = data.pc;\n      }\n      \n      // Clear pending updates first\n      this.pendingUpdates = {};\n      \n      // Process batch updates for each grid\n      for (const [gridId, gridUpdates] of Object.entries(updatesByGrid)) {\n        try {\n          const response = await axios.post(`${API_BASE}/api/batch-update-pc-positions`, {\n            gridId: gridId,\n            updates: gridUpdates,\n            timestamp: Date.now()\n          });\n          \n          if (response.data.errors && response.data.errors.length > 0) {\n            console.warn(` Batch update had ${response.data.errors.length} errors:`, response.data.errors);\n          }\n          \n          console.log(` Batch updated ${response.data.updated} PC positions for grid ${gridId}`);\n        } catch (error) {\n          console.error(` Failed to batch save positions for grid ${gridId}:`, error);\n          // Re-add all failed updates back to pending\n          for (const [playerId, pc] of Object.entries(gridUpdates)) {\n            const key = `${gridId}-${playerId}`;\n            this.pendingUpdates[key] = {\n              gridId,\n              playerId,\n              pc,\n              lastUpdated: pc.lastUpdated\n            };\n          }\n        }\n      }\n      \n      if (Object.keys(this.pendingUpdates).length === 0) {\n        console.log(` All PC position updates saved successfully`);\n      }\n    }\n    \n    // Force save all pending updates immediately\n    async forceSavePendingUpdates() {\n      await this.processPendingUpdates();\n    }\n    \n    // Flush all position updates for a specific grid\n    async flushGridPositionUpdates(gridId) {\n      // Filter updates for the specific grid\n      const gridUpdates = Object.entries(this.pendingUpdates)\n        .filter(([key, data]) => data.gridId === gridId);\n      \n      if (gridUpdates.length === 0) return;\n      \n      console.log(` Flushing ${gridUpdates.length} PC position updates for grid ${gridId}`);\n      \n      // Remove these updates from pending\n      gridUpdates.forEach(([key]) => {\n        delete this.pendingUpdates[key];\n      });\n      \n      // Process just these updates\n      const updates = {};\n      gridUpdates.forEach(([key, data]) => {\n        updates[data.playerId] = data.pc;\n      });\n      \n      try {\n        const response = await axios.post(`${API_BASE}/api/batch-update-pc-positions`, {\n          gridId: gridId,\n          updates: updates,\n          timestamp: Date.now()\n        });\n        \n        console.log(` Flushed ${response.data.updated} PC positions for grid ${gridId}`);\n      } catch (error) {\n        console.error(` Failed to flush PC positions for grid ${gridId}:`, error);\n        // Re-add failed updates back to pending\n        gridUpdates.forEach(([key, data]) => {\n          this.pendingUpdates[key] = data;\n        });\n      }\n    }\n    /**\n     * Initialize the playersInGrid for a specific gridId.\n     */\n    async initializePlayersInGrid(gridId) {\n\n      console.log(' Fetching playersInGrid for gridId:', gridId);\n      if (!gridId) {\n        console.error('initializePlayersInGrid: gridId is undefined.');\n        return;\n      }\n    \n      try {\n        const response = await axios.get(`${API_BASE}/api/load-grid-state/${gridId}`);\n        const {\n          playersInGrid = { pcs: {}, lastUpdated: 0 },\n        } = response.data;\n    \n        // Build a consolidated local state with independent timestamps\n        const state = {\n          pcs: playersInGrid.pcs || {},\n          playersInGridLastUpdated: new Date(playersInGrid.lastUpdated || 0).getTime(),\n        };\n        const pcs = state.pcs || {};\n        console.log('Fetched PC NPCsInGrid:', state);\n    \n        // Normalize PC format\n        Object.keys(pcs).forEach((playerId) => {\n          const pcData = pcs[playerId];\n          pcs[playerId] = {\n            ...pcData,\n            position: pcData.position || { x: 0, y: 0 },\n          };\n        });\n    \n        this.playersInGrid[gridId] = state;\n    \n        this.setPlayersInGridReact((prev) => ({\n          ...prev,\n          [gridId]: {\n            pcs: pcs,\n            playersInGridLastUpdated: Date.now(),\n          },\n        }));\n\n        console.log(` Initialized playersInGrid for gridId ${gridId}:`, pcs);\n        \n        // Start batch saving for position updates\n        this.startBatchSaving();\n        \n        // Save positions before page unload\n        if (!this.unloadListenerAdded) {\n          window.addEventListener('beforeunload', () => {\n            console.log(' Page unloading, saving pending positions...');\n            // Use synchronous XMLHttpRequest for beforeunload\n            const updates = Object.entries(this.pendingUpdates);\n            if (updates.length > 0) {\n              // Group updates by gridId for batch processing\n              const updatesByGrid = {};\n              for (const [key, data] of updates) {\n                if (!updatesByGrid[data.gridId]) {\n                  updatesByGrid[data.gridId] = {};\n                }\n                updatesByGrid[data.gridId][data.playerId] = data.pc;\n              }\n              \n              // Send batch updates for each grid\n              for (const [gridId, gridUpdates] of Object.entries(updatesByGrid)) {\n                const xhr = new XMLHttpRequest();\n                xhr.open('POST', `${API_BASE}/api/batch-update-pc-positions`, false); // false = synchronous\n                xhr.setRequestHeader('Content-Type', 'application/json');\n                xhr.send(JSON.stringify({\n                  gridId: gridId,\n                  updates: gridUpdates,\n                  timestamp: Date.now()\n                }));\n              }\n            }\n          });\n          this.unloadListenerAdded = true;\n        }\n        \n        // Request fresh player list from server after loading DB state\n        // This will override any stale data with current server state\n        console.log(' Requesting current players from server for grid:', gridId);\n        if (socket && socket.emit) {\n          socket.emit('request-current-grid-players', { gridId });\n        }\n      } catch (error) {\n        console.error(' Error fetching playersInGrid:', error);\n      }\n    }\n    \n    getPlayersInGrid(gridId) {\n      const playersInGrid = this.playersInGrid[gridId];\n      if (!playersInGrid) {\n        console.warn(` No PC state found for gridId: ${gridId}`);\n        return {};\n      }\n      return playersInGrid.pcs;\n    }\n\n    getAllPCs(gridId) {\n      return this.playersInGrid?.[gridId]?.pcs || {};\n    }\n    getPlayerPosition(gridId, playerId) {\n      return this.playersInGrid?.[gridId]?.pcs?.[playerId]?.position || null;\n    }\n\n    setAllPCs(gridId, pcsObject) {\n      this.playersInGrid[gridId] = {\n        pcs: pcsObject || {},\n        playersInGridLastUpdated: Date.now(),\n      };\n    \n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: this.playersInGrid[gridId],\n        }));\n      }\n    }\n    \n    async addPlayer(gridId, playerId, pcData) {\n    // Add a new PC to the playersInGrid for a given gridId and playerId.\n    // This is only run on app initialization, IF the saved currentPlayer cannot be found in the playersInGrid.\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = {\n          pcs: {},\n          playersInGridLastUpdated: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n      const masterResources = await loadMasterResources();\n\n      // Compute modifiers from powers - support multiple attributes per power\n      // Only count equipped weapons/armor + all magic enhancements\n      const modifiers = {};\n      const equippedWeapon = pcData.settings?.equippedWeapon || null;\n      const equippedArmor = pcData.settings?.equippedArmor || null;\n      \n      // Helper functions to categorize powers\n      const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n      const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n      const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n      \n      (pcData.powers || []).forEach(power => {\n        const resource = masterResources.find(r => r.type === power.type);\n        if (resource && resource.category === 'power') {\n          const powerQty = power.quantity || 0;\n          \n          // Only count equipped weapons and armor, or all magic enhancements\n          const shouldCount = isMagicEnhancement(resource) || \n                             (isWeapon(resource) && power.type === equippedWeapon) ||\n                             (isArmor(resource) && power.type === equippedArmor);\n          \n          if (shouldCount) {\n            // Combat stat attributes to check for\n            const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n            \n            combatAttributes.forEach(attr => {\n              if (typeof resource[attr] === 'number') {\n                const value = powerQty * resource[attr];\n                modifiers[attr] = (modifiers[attr] || 0) + value;\n              }\n            });\n            \n          }\n        }\n      });\n\n      const getStat = (baseKey, modKey) => (pcData[baseKey] || 0) + (modifiers[modKey] || 0);\n\n      console.log(' [HP DEBUG] addPlayer - Base stat calculation:');\n      console.log('  pcData.baseHp:', pcData.baseHp);\n      console.log('  pcData.baseMaxhp:', pcData.baseMaxhp);\n      console.log('  modifiers.hp:', modifiers.hp);\n      console.log('  modifiers.maxhp:', modifiers.maxhp);\n      console.log('  getStat(\"baseHp\", \"hp\"):', getStat('baseHp', 'hp'));\n      console.log('  getStat(\"baseMaxhp\", \"maxhp\"):', getStat('baseMaxhp', 'maxhp'));\n\n      const newPC = {\n        playerId,\n        username: pcData.username,\n        type: 'pc',\n        icon: pcData.icon,\n        position: pcData.position || { x: 0, y: 0 },\n        hp: getStat('baseHp', 'hp'),\n        maxhp: getStat('baseMaxhp', 'maxhp'),\n        armorclass: getStat('baseArmorclass', 'armorclass'),\n        attackbonus: getStat('baseAttackbonus', 'attackbonus'),\n        damage: getStat('baseDamage', 'damage'),\n        attackrange: getStat('baseAttackrange', 'attackrange'),\n        speed: getStat('baseSpeed', 'speed'),\n        iscamping: pcData.iscamping || false,\n        isinboat: pcData.isinboat || false,\n        lastUpdated: now,\n      };\n\n      this.playersInGrid[gridId].pcs[playerId] = newPC;\n\n      // Save to server\n      try {\n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId,\n          playerId,\n          pc: newPC,\n          lastUpdated: now,\n        });\n        console.log(` Added and saved new PC ${playerId} to server.`);\n      } catch (error) {\n        console.error(` Failed to add PC ${playerId}:`, error);\n      }\n\n      // Emit to other clients\n      if (socket && socket.emit) {\n        socket.emit('update-NPCsInGrid-PCs', {\n          gridId,\n          pcs: { [playerId]: newPC },\n          playersInGridLastUpdated: now,\n        });\n      }\n\n      // Note: Caller should update React context using setPlayersInGrid if needed\n    }\n\n\n    // Add a new lightweight PC (from grid.playersInGrid schema) to the local in-memory playersInGrid\n    async addPC(gridId, playerId, pcData) {\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = {\n          pcs: {},\n          playersInGridLastUpdated: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n      \n      console.log(' [HP DEBUG] addPC - Incoming PC data:');\n      console.log('  pcData.hp:', pcData.hp);\n      console.log('  pcData.maxhp:', pcData.maxhp);\n      console.log('  playerId:', playerId);\n      \n      const newPC = {\n        playerId: pcData.playerId,\n        username: pcData.username,\n        type: 'pc', // Always set type to 'pc' - pcData may be a Player document without this field\n        icon: pcData.icon,\n        position: pcData.position || { x: 0, y: 0 },\n        hp: pcData.hp ?? 25, // Fallback for undefined combat stats from socket sync\n        maxhp: pcData.maxhp ?? 25,\n        armorclass: pcData.armorclass ?? 10,\n        attackbonus: pcData.attackbonus ?? 0,\n        damage: pcData.damage ?? 1,\n        attackrange: pcData.attackrange ?? 1,\n        speed: pcData.speed ?? 1,\n        iscamping: pcData.iscamping || false,\n        isinboat: pcData.isinboat || false,\n        lastUpdated: now,\n      };\n\n      this.playersInGrid[gridId].pcs[playerId] = newPC;\n\n      // Also update React state if setter is registered\n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: {\n              ...(prev[gridId]?.pcs || {}),\n              [playerId]: newPC,\n            },\n          },\n        }));\n      }\n\n      // Save to database immediately for location changes to prevent inconsistency\n      try {\n        console.log(' [DEBUG] Attempting to save PC to database:', {\n          gridId,\n          playerId,\n          pcData: {\n            ...newPC,\n            // Validate critical fields before sending\n            hasValidPosition: newPC.position && typeof newPC.position.x === 'number' && typeof newPC.position.y === 'number',\n            hasValidIcon: newPC.icon && typeof newPC.icon === 'string',\n            hasValidType: newPC.type === 'pc',\n            hasValidUsername: newPC.username && typeof newPC.username === 'string',\n            hasValidCombatStats: typeof newPC.hp === 'number' && typeof newPC.maxhp === 'number'\n          }\n        });\n        \n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId,\n          playerId,\n          pc: newPC,\n          lastUpdated: now,\n        });\n        console.log(` Added PC ${playerId} to grid ${gridId} and database`);\n      } catch (error) {\n        console.error(` Failed to save PC ${playerId} to database:`, {\n          error: error.message,\n          status: error.response?.status,\n          statusText: error.response?.statusText,\n          data: error.response?.data,\n          pcData: newPC,\n          gridId,\n          playerId\n        });\n        // Remove from local state if database save fails\n        delete this.playersInGrid[gridId].pcs[playerId];\n        if (this.setPlayersInGridReact) {\n          this.setPlayersInGridReact(prev => {\n            const updatedGrid = { ...(prev[gridId]?.pcs || {}) };\n            delete updatedGrid[playerId];\n            return {\n              ...prev,\n              [gridId]: {\n                ...(prev[gridId] || {}),\n                pcs: updatedGrid,\n              },\n            };\n          });\n        }\n        throw error; // Re-throw to let changePlayerLocation handle the error\n      }\n    }\n\n    // Update local state only - NO database call\n    // Use this for socket sync events where the sender already saved to DB\n    updatePCLocal(gridId, playerId, pcData) {\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = {\n          pcs: {},\n          playersInGridLastUpdated: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n\n      const newPC = {\n        playerId: pcData.playerId || playerId,\n        username: pcData.username,\n        type: 'pc',\n        icon: pcData.icon,\n        position: pcData.position || { x: 0, y: 0 },\n        hp: pcData.hp ?? 25,\n        maxhp: pcData.maxhp ?? 25,\n        armorclass: pcData.armorclass ?? 10,\n        attackbonus: pcData.attackbonus ?? 0,\n        damage: pcData.damage ?? 1,\n        attackrange: pcData.attackrange ?? 1,\n        speed: pcData.speed ?? 1,\n        iscamping: pcData.iscamping || false,\n        isinboat: pcData.isinboat || false,\n        lastUpdated: pcData.lastUpdated || now,\n      };\n\n      this.playersInGrid[gridId].pcs[playerId] = newPC;\n\n      // Also update React state if setter is registered\n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: {\n              ...(prev[gridId]?.pcs || {}),\n              [playerId]: newPC,\n            },\n          },\n        }));\n      }\n\n      console.log(` Updated PC ${playerId} locally (no DB call)`);\n      return newPC;\n    }\n\n\n    // Update an existing PC in the playersInGrid for a given gridId and playerId.\n    async updatePC(gridId, playerId, newProperties) {\n      const gridPCs = this.playersInGrid[gridId]?.pcs;\n      if (!gridPCs || !gridPCs[playerId]) {\n        console.error(`Cannot update PC ${playerId}. No NPCsInGrid or PC found for gridId: ${gridId}`);\n        return;\n      }\n    \n      const currentData = gridPCs[playerId];\n      \n      const keysToCompare = Object.keys(newProperties).filter(key => key !== 'lastUpdated');\n      const isSame = keysToCompare.every(key => {\n        const a = currentData[key];\n        const b = newProperties[key];\n        return JSON.stringify(a) === JSON.stringify(b);\n      });\n\n      if (isSame) {\n        return; // Skip update if no changes\n      }\n    \n      const oldPosition = gridPCs[playerId]?.position;\n      const now = Date.now();\n      const updatedPC = {\n        ...gridPCs[playerId],\n        ...newProperties,\n        lastUpdated: now,\n      };\n      const newPosition = updatedPC.position; //  and derive newPosition from updatedPC\n\n      this.playersInGrid[gridId].pcs[playerId] = updatedPC;\n    \n      // Emit to other clients\n      if (socket && socket.emit) {\n        const payload = {\n          [gridId]: {\n            pcs: { [playerId]: updatedPC },\n            playersInGridLastUpdated: now,\n          },\n          emitterId: socket.id,\n        };\n    \n        socket.emit('update-NPCsInGrid-PCs', payload);\n      }\n    \n      if (\n        this.tileSize &&\n        oldPosition &&\n        newPosition &&\n        (oldPosition.x !== newPosition.x || oldPosition.y !== newPosition.y)\n      ) {\n        animateRemotePC(playerId, oldPosition, newPosition, this.tileSize);\n      }\n\n      //  Also update React state if setter is registered\n      if (this.setPlayersInGridReact) {\n        this.setPlayersInGridReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: {\n              ...(prev[gridId]?.pcs || {}),\n              [playerId]: updatedPC,\n            },\n          },\n        }));\n      }\n\n        // Add to pending updates for batch saving instead of immediate save\n        const updateKey = `${gridId}-${playerId}`;\n        this.pendingUpdates[updateKey] = {\n          gridId,\n          playerId,\n          pc: updatedPC,\n          lastUpdated: now\n        };\n        \n        // Start batch saving if not already running\n        if (!this.batchInterval) {\n          this.startBatchSaving();\n        }\n    }\n\n\n  // Remove a PC from the playersInGrid for a given gridId and playerId.\n  async removePC(gridId, playerId) {\n    // Clear any pending updates for this player FIRST to prevent race conditions\n    // where batch update could re-add the player after removal\n    const pendingKey = `${gridId}-${playerId}`;\n    if (this.pendingUpdates[pendingKey]) {\n      console.log(` Clearing pending update for ${playerId} in grid ${gridId} before removal`);\n      delete this.pendingUpdates[pendingKey];\n    }\n\n    if (!this.playersInGrid[gridId]?.pcs?.[playerId]) {\n      console.warn(` Cannot remove PC ${playerId}; not found in grid ${gridId}.`);\n      return;\n    }\n\n    delete this.playersInGrid[gridId].pcs[playerId];\n\n    // Also update React state if setter is registered\n    if (this.setPlayersInGridReact) {\n      this.setPlayersInGridReact(prev => {\n        const updatedGrid = { ...(prev[gridId]?.pcs || {}) };\n        delete updatedGrid[playerId];\n\n        return {\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            pcs: updatedGrid,\n          },\n        };\n      });\n    }\n\n    // Remove from database immediately for location changes to prevent ghost PCs\n    try {\n      await axios.post(`${API_BASE}/api/remove-single-pc`, {\n        gridId,\n        playerId,\n      });\n      console.log(` Removed PC ${playerId} from grid ${gridId} and database`);\n    } catch (error) {\n      console.error(` Failed to remove PC ${playerId} from database:`, error);\n      // Re-add the player back to local state if database removal fails\n      if (!this.playersInGrid[gridId]) {\n        this.playersInGrid[gridId] = { pcs: {}, playersInGridLastUpdated: Date.now() };\n      }\n      // Note: We would need the original player data to restore, which we don't have here\n      // This is an edge case that should be handled by proper error handling in changePlayerLocation\n    }\n  }\n\n  }\n    \n\n    const playersInGridManager = new GridStatePCManager();\n    export default playersInGridManager;\n    export const { initializePlayersInGrid } = playersInGridManager;","import React, { createContext, useContext, useState } from 'react';\n\nconst PanelContext = createContext();\n\nexport const PanelProvider = ({ children }) => {\n  const [activePanel, setActivePanel] = useState(null);\n\n  const openPanel = (panelName) => {\n    setActivePanel(panelName);\n  };\n  const closePanel = () => {\n    setActivePanel(null);\n  };\n  return (\n    <PanelContext.Provider value={{ activePanel, openPanel, closePanel, closeAllPanels: closePanel }}>\n      {children}\n    </PanelContext.Provider>\n  );\n};\nexport const usePanelContext = () => {\n  return useContext(PanelContext);\n};\n","import stringsEN from '../UI/Strings/stringsEN.json';\n\n// Create a reverse lookup map: value -> key\nconst createReverseLookupMap = () => {\n  const reverseMap = {};\n  Object.entries(stringsEN).forEach(([key, value]) => {\n    reverseMap[value] = key;\n  });\n  return reverseMap;\n};\n\n// Cached reverse lookup map\nlet reverseLookupMap = null;\n\n/**\n * Looks up a string value in stringsEN.json and returns its key (ID)\n * This allows server-side strings to be mapped to localized client strings\n * @param {string} value - The string value to look up\n * @returns {string|null} - The string ID/key if found, null otherwise\n */\nexport const getStringIdByValue = (value) => {\n  if (!reverseLookupMap) {\n    reverseLookupMap = createReverseLookupMap();\n  }\n  \n  return reverseLookupMap[value] || null;\n};\n\n/**\n * Helper function for use in React components\n * Returns the localized string from the provided strings object\n * @param {string} value - The string value to look up\n * @param {object} strings - The localized strings object from useStrings()\n * @returns {string} - The localized string if found, original value otherwise\n */\nexport const getLocalizedString = (value, strings) => {\n  // Handle undefined strings object\n  if (!strings) {\n    console.warn('getLocalizedString: strings object is undefined, returning original value');\n    return value;\n  }\n  \n  const stringId = getStringIdByValue(value);\n  if (stringId && strings[stringId]) {\n    return strings[stringId];\n  }\n  // Fallback to original value if not found\n  return value;\n};","const API_BASE = process.env.REACT_APP_SERVER_URL || 'http://localhost:3001';\n\nexport default API_BASE;","import { renderPositions } from '../PlayerMovement';\n\nexport function animateRemotePC(playerId, from, to, TILE_SIZE, stepCount = 10) {\n  let step = 0;\n\n  //console.log('animateRemotePC', playerId, from, to, 'steps:', stepCount);\n  \n  const currentX = from.x * TILE_SIZE;\n  const currentY = from.y * TILE_SIZE;\n  const targetX = to.x * TILE_SIZE;\n  const targetY = to.y * TILE_SIZE;\n\n  function animate() {\n    if (step >= stepCount) {\n      delete renderPositions[playerId];\n      return;\n    }\n\n    const interpolatedX = currentX + ((targetX - currentX) / stepCount) * step;\n    const interpolatedY = currentY + ((targetY - currentY) / stepCount) * step;\n\n    renderPositions[playerId] = {\n      x: interpolatedX / TILE_SIZE,\n      y: interpolatedY / TILE_SIZE,\n    };\n\n    step++;\n    requestAnimationFrame(animate);\n  }\n\n  animate();\n}","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { addResourceToGrid } from '../../Utils/worldHelpers';\nimport { convertTileType, updateGridResource } from '../../Utils/GridManagement';\nimport { validateTileType, enrichResourceFromMaster } from '../../Utils/ResourceHelpers';\nimport { refreshPlayerAfterInventoryUpdate, spendIngredients } from '../../Utils/InventoryManagement';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport farmState from '../../FarmState';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getCurrentTileCoordinates } from '../../Utils/ResourceHelpers';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { tryAdvanceFTUEByTrigger } from '../FTUE/FTUEutils';\nimport { createCollectEffect } from '../../VFX/VFX';\n\n/**\n * Determines the appropriate error string for an invalid planting attempt.\n * Checks all validon[x] fields to find which tile types ARE valid.\n * - If exactly 1 tile type is valid, returns the specific error string for that tile.\n * - If multiple or zero valid tile types, returns the default \"Can't plant here\" (304).\n *\n * Tile type to string mapping:\n * - d (dirt)  303 \"Must plant on dirt\"\n * - z (moss)  307 \"Must plant on moss\"\n * - n (sand)  308 \"Must plant on sand\"\n * - fallback  304 \"Can't plant here\"\n */\nconst getPlantingErrorString = (farmplotItem) => {\n  // Map of tile type codes to their specific error strings\n  const tileTypeToString = {\n    'd': 303, // dirt\n    'z': 307, // moss\n    'n': 308, // sand\n  };\n\n  // All possible validon fields to check\n  const validonFields = ['g', 'd', 's', 'p', 'w', 'l', 'n', 'o', 'x', 'y', 'z'];\n\n  // Find all tile types that are valid for this farmplot\n  const validTileTypes = validonFields.filter(tileCode => {\n    const fieldName = `validon${tileCode}`;\n    return farmplotItem[fieldName] === true;\n  });\n\n  // If exactly one valid tile type and we have a specific string for it\n  if (validTileTypes.length === 1 && tileTypeToString[validTileTypes[0]]) {\n    return tileTypeToString[validTileTypes[0]];\n  }\n\n  // Otherwise return default \"Can't plant here\"\n  return 304;\n};\n\nexport const handleFarmPlotPlacement = async ({\n  selectedItem,\n  TILE_SIZE,\n  resources,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n  overridePosition, // Optional: { x, y } to plant at a specific tile instead of player position\n}) => {\n  try {\n    console.log(masterResources);\n\n    let tileX, tileY;\n    if (overridePosition) {\n      // Use the override position (from cursor mode click)\n      tileX = overridePosition.x;\n      tileY = overridePosition.y;\n    } else {\n      // Use player's current position\n      const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n      if (!coords) return false;\n      tileX = coords.tileX;\n      tileY = coords.tileY;\n    }\n\n    const tileOccupied = resources.find((res) => res.x === tileX && res.y === tileY);\n    if (tileOccupied) {\n      FloatingTextManager.addFloatingText(304, tileX, tileY, TILE_SIZE); // \"Occupied\"\n      return false;\n    }\n\n    // Use local tile data instead of async server call for instant response\n    const tiles = GlobalGridStateTilesAndResources.getTiles();\n    const tileType = tiles?.[tileY]?.[tileX];\n\n    // Check if the tile type is valid for this farmplot using validon[x] fields\n    const validonField = `validon${tileType}`;\n    const isValidTile = selectedItem[validonField] === true;\n\n    if (!tileType || !isValidTile) {\n      // Determine appropriate error message based on valid tile types for this farmplot\n      const errorStringId = getPlantingErrorString(selectedItem);\n      FloatingTextManager.addFloatingText(errorStringId, tileX, tileY, TILE_SIZE);\n      return false;\n    }\n\n    const didSpend = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: selectedItem,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!didSpend) {\n      FloatingTextManager.addFloatingText(305, tileX, tileY, TILE_SIZE); // \"Missing ingredients\"\n      return false;\n    }\n\n    // Timer setup\n    const growEndTime = Date.now() + (selectedItem.growtime || 0) * 1000;\n    console.log(` Planting ${selectedItem.type}: growtime = ${selectedItem.growtime}, growEndTime = ${growEndTime}, secondsFromNow = ${(growEndTime - Date.now()) / 1000}`);\n\n    // Lookup from masterResources for enrichment\n    console.log(\" Attempting to plant:\", selectedItem.type, \"at\", tileX, tileY);\n    const enrichedNewResource = enrichResourceFromMaster(\n      {\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n      },\n      masterResources\n    );\n    console.log(\" Enriched resource before setResources:\", enrichedNewResource);\n\n    // Optimistically update local client state\n    const existing = GlobalGridStateTilesAndResources.getResources() || [];\n    GlobalGridStateTilesAndResources.setResources([...existing, enrichedNewResource]);\n    console.log(\" Global resources after planting:\", GlobalGridStateTilesAndResources.getResources());\n    setResources([...existing, enrichedNewResource]);\n\n    // Update server and all clients\n    const gridUpdateResponse = await updateGridResource(\n      gridId,\n      {\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n      },\n      true\n    );\n\n    if (gridUpdateResponse?.success) {\n      farmState.addSeed({\n        type: selectedItem.type,\n        x: tileX,\n        y: tileY,\n        growEnd: growEndTime,\n        output: selectedItem.output, //  required for crop conversion\n      });\n\n      // Show VFX and floating text for planting\n      createCollectEffect(tileX, tileY, TILE_SIZE);\n      FloatingTextManager.addFloatingText(302, tileX, tileY, TILE_SIZE); // \"Planted!\"\n\n      // Track quest progress for \"Plant\" actions\n      // Use the output (crop) name instead of the plot name for quest tracking\n      const cropName = selectedItem.output || selectedItem.type;\n      await trackQuestProgress(currentPlayer, 'Plant', cropName, 1, setCurrentPlayer);\n\n      // Try to advance FTUE if this is the player's first crop planted\n      await tryAdvanceFTUEByTrigger('PlantedFirstCrop', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n\n      return true; // Success!\n    } else {\n      throw new Error('Server update failed.');\n    }\n  } catch (error) {\n    console.error(' Error in handleFarmPlotPlacement:', error);\n    return false;\n  }\n};\n\n\n\nexport const handleTerraform = async ({ TILE_SIZE, actionType, tileType, gridId, currentPlayer, tileTypes, setTileTypes, overridePosition, isDeveloper }) => {\n\n  console.log(\"handleTerraform;  currentPlayer = \",currentPlayer);\n\n  if (!currentPlayer?.location) {\n    console.error(\" handleTerraform: Missing currentPlayer location.\");\n    return false;\n  }\n\n  // Use override position if provided (cursor mode), otherwise use player position\n  let tileX, tileY;\n  if (overridePosition) {\n    tileX = overridePosition.x;\n    tileY = overridePosition.y;\n  } else {\n    const coords = getCurrentTileCoordinates(gridId, currentPlayer);\n    if (!coords) return false;\n    tileX = coords.tileX;\n    tileY = coords.tileY;\n  }\n\n  const tile = tileTypes?.[tileY]?.[tileX];\n  console.log(\"tile at \",tileY,\", \",tileX,\" = \",tile);\n\n  if (!tile) {\n    console.error(\" handleTerraform: Could not find tile at given coordinates.\");\n    return false;\n  }\n  if (tile === 'l' && !isDeveloper) {\n      FloatingTextManager.addFloatingText(320, tileX, tileY, TILE_SIZE);\n    return false;\n  }\n  if (tile === 'w' && !isDeveloper) {\n      FloatingTextManager.addFloatingText(320, tileX, tileY, TILE_SIZE); // Same message as lava for now\n    return false;\n  }\n\n  let newType;\n\n  // If tileType is directly provided, use it (new dynamic approach)\n  if (tileType) {\n    newType = tileType;\n  } else {\n    // Legacy: Determine the new tile type based on the action (for backwards compatibility)\n    switch (actionType) {\n      case \"till\":\n        newType = \"d\";\n        break;\n      case \"plantGrass\":\n        newType = \"g\";\n        break;\n      case \"pave\":\n        newType = \"p\";\n        break;\n      case \"stone\":\n        newType = \"s\";\n        break;\n      case \"cobblestone\":\n        newType = \"x\";\n        break;\n      case \"water\":\n        newType = \"w\";\n        break;\n      default:\n        console.error(` handleTerraform: Unknown actionType \"${actionType}\"`);\n        return false;\n    }\n  }\n\n  console.log(` handleTerraform: Changing tile at (${tileX}, ${tileY}) to \"${newType}\"`);\n\n  // Call convertTileType to update the tile in the database and emit the change\n  await convertTileType(gridId, tileX, tileY, newType, setTileTypes);\n\n  // Show VFX for terraforming\n  createCollectEffect(tileX, tileY, TILE_SIZE);\n  return true; // Success\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * LocationChangeManager - Prevents concurrent location changes and HP data loss\n * \n * This manager ensures that only one location change can happen at a time,\n * preventing race conditions that cause HP to reset to 25 during rapid grid transitions.\n */\nclass LocationChangeManager {\n  constructor() {\n    this.isLocationChangeInProgress = false;\n    this.pendingLocationChange = null;\n    this.lastCompletedChange = null;\n  }\n\n  /**\n   * Check if a location change is currently in progress\n   */\n  isInProgress() {\n    return this.isLocationChangeInProgress;\n  }\n\n  /**\n   * Request permission to start a location change\n   * @param {Object} changeRequest - The location change request details\n   * @returns {Promise<boolean>} - True if permission granted, false if blocked\n   */\n  async requestLocationChange(changeRequest) {\n    // If already in progress, queue this request\n    if (this.isLocationChangeInProgress) {\n      console.log(' Location change blocked - operation already in progress');\n      \n      // Store the most recent request (overwrite any pending)\n      this.pendingLocationChange = {\n        ...changeRequest,\n        timestamp: Date.now()\n      };\n      \n      return false;\n    }\n\n    // Grant permission and mark as in progress\n    this.isLocationChangeInProgress = true;\n    this.pendingLocationChange = null;\n    \n    console.log(' Location change permission granted');\n    return true;\n  }\n\n  /**\n   * Mark location change as completed successfully\n   * @param {Object} completedChange - Details of the completed change\n   */\n  completeLocationChange(completedChange) {\n    this.isLocationChangeInProgress = false;\n    this.lastCompletedChange = {\n      ...completedChange,\n      completedAt: Date.now()\n    };\n    \n    console.log(' Location change completed successfully');\n    \n    // Process any pending change after a brief delay to ensure state is stable\n    if (this.pendingLocationChange) {\n      const pending = this.pendingLocationChange;\n      this.pendingLocationChange = null;\n      \n      console.log(' Processing queued location change after completion');\n      \n      // Use setTimeout to ensure current call stack completes before processing\n      setTimeout(() => {\n        if (pending.retryCallback) {\n          pending.retryCallback();\n        }\n      }, 100);\n    }\n  }\n\n  /**\n   * Mark location change as failed and allow retry\n   * @param {Error} error - The error that caused the failure\n   */\n  failLocationChange(error) {\n    console.error(' Location change failed:', error);\n    this.isLocationChangeInProgress = false;\n    \n    // Don't process pending changes on failure - let user retry manually\n    if (this.pendingLocationChange) {\n      console.log(' Discarding pending location change due to failure');\n      this.pendingLocationChange = null;\n    }\n  }\n\n  /**\n   * Get the status of location changes\n   */\n  getStatus() {\n    return {\n      inProgress: this.isLocationChangeInProgress,\n      hasPending: !!this.pendingLocationChange,\n      lastCompleted: this.lastCompletedChange,\n      pendingChange: this.pendingLocationChange\n    };\n  }\n\n  /**\n   * Clear any pending location changes (useful for cleanup)\n   */\n  clearPending() {\n    this.pendingLocationChange = null;\n    console.log(' Cleared pending location changes');\n  }\n\n  /**\n   * Force reset the manager state (emergency use only)\n   */\n  reset() {\n    this.isLocationChangeInProgress = false;\n    this.pendingLocationChange = null;\n    this.lastCompletedChange = null;\n    console.warn(' LocationChangeManager force reset');\n  }\n}\n\n// Create singleton instance\nconst locationChangeManager = new LocationChangeManager();\n\n// Development tools - make available in console for debugging\nif (typeof window !== 'undefined') {\n  window.locationChangeManager = locationChangeManager;\n  window.debugLocationChanges = () => {\n    console.log('Location Change Manager Status:', locationChangeManager.getStatus());\n    return locationChangeManager.getStatus();\n  };\n  window.resetLocationChangeManager = () => {\n    locationChangeManager.reset();\n    console.log('Location Change Manager reset');\n  };\n}\n\nexport default locationChangeManager;","import API_BASE from '../config';\nimport axios from 'axios';\nimport { initializeGrid } from '../AppInit';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport socket from '../socketManager'; //  At top of file if not already present\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { mergeResources, mergeTiles } from './ResourceHelpers';\nimport { centerCameraOnPlayer } from '../PlayerMovement';\nimport { closePanel } from '../UI/Panels/PanelContext';\nimport { fetchHomesteadOwner } from './worldHelpers';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\nimport { showNotification } from '../UI/Notifications/Notifications';\nimport locationChangeManager from './LocationChangeManager';\nimport SVGAssetManager from '../Render/SVGAssetManager';\nimport { isGridVisited } from './gridsVisitedUtils';\n\nexport const updateGridResource = async (\n  gridId,\n  resource,\n  broadcast = true\n) => {\n  //console.log('UPDATE GRID RESOURCE; resource = ', resource);\n\n  try {\n    const { x, y, growEnd, craftEnd, craftedItem, type } = resource;\n    \n    //  1. Flat payload  no \"newResource\" key\n    const payload = {\n      resource: {\n        type,\n        x,\n        y,\n        ...(growEnd !== undefined && { growEnd }),\n        ...(craftEnd !== undefined && { craftEnd }),\n        ...(craftedItem !== undefined && { craftedItem }),\n      },\n      broadcast, // optional - depending on your server usage\n    };\n    //console.log('UPDATE GRID RESOURCE; payload = ', payload);\n\n    //  2. Update the database\n    const response = await axios.patch(`${API_BASE}/api/update-grid/${gridId}`, payload);\n    if (!response.data.success) throw new Error('Failed DB update');\n\n    //  3. Emit to other clients\n    if (broadcast && socket && socket.emit) {\n      socket.emit('update-resource', {\n        gridId,\n        updatedResources: [resource?.type === null ? { x, y, type: null } : resource],\n      });\n    }\n\n    return { success: true };\n  } catch (error) {\n    console.error(' Error in updateGridResource:', error);\n    return { success: false };\n  }\n};\n\n\nexport const convertTileType = async (gridId, x, y, newType, setTileTypes = null) => {\n  try {\n    //console.log(`Converting tile at (${x}, ${y}) to type: ${newType}`);\n\n    // Update the tile in the database\n    const response = await axios.patch(`${API_BASE}/api/update-tile/${gridId}`, {\n      x,\n      y,\n      newType,\n    });\n\n    if (response.data.success) {\n      //console.log(` Tile at (${x}, ${y}) successfully updated to ${newType} in the database.`);\n\n      //  Immediately update local state optimistically\n      if (setTileTypes) {\n        setTileTypes((prevTiles) => {\n          const updated = mergeTiles(prevTiles, [{ x, y, type: newType }]);\n          console.log(\" Optimistically updated tileTypes (emitter):\", updated);\n          return updated;\n        });\n      }\n\n      //console.log('newType before emitter:', newType);\n      // Emit the change to all connected clients via the socket\n      socket.emit('update-tile', {\n        gridId,\n        updatedTiles: [{ x, y, type: newType }],\n      });\n    } else {\n      console.error(` Failed to update tile at (${x}, ${y}):`, response.data.message);\n    }\n  } catch (error) {\n    console.error(` Error converting tile at (${x}, ${y}):`, error);\n  }\n};\n\nexport const changePlayerLocation = async (\n  currentPlayer,\n  fromLocation,\n  toLocation,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  TILE_SIZE,\n  closeAllPanels, //  Add this prop\n  updateStatus,\n  bulkOperationContext, //  Add bulk operation context\n  masterResources = null, //  Add masterResources for combat stat calculations\n  strings = null, //  Add strings for notifications\n  masterTrophies = null, //  Add masterTrophies for trophy visibility checks\n  transitionFadeControl = null //  Add transition fade control\n) => {\n\n  console.log(' [GRID TRANSITION] Starting transactional grid change...');\n  \n  // Start fade to black immediately when location change is detected\n  if (transitionFadeControl?.startTransition) {\n    transitionFadeControl.startTransition();\n  }\n  \n  // Check if any bulk operation is active\n  if (bulkOperationContext?.isAnyBulkOperationActive?.()) {\n    if (updateStatus) {\n      updateStatus(470); // \"Bulk operation in progress\"\n    }\n    return false;\n  }\n\n  //  NEW: Check if location change is already in progress\n  const playerId = currentPlayer._id?.toString() || currentPlayer.playerId;\n  \n  const changeRequest = {\n    from: fromLocation,\n    to: toLocation,\n    playerId: playerId,\n    timestamp: Date.now()\n  };\n\n  const canProceed = await locationChangeManager.requestLocationChange(changeRequest);\n  if (!canProceed) {\n    console.log(' Location change blocked - another change in progress');\n    if (updateStatus) {\n      updateStatus('Location change in progress, please wait...');\n    }\n    return false;\n  }\n\n  // ================================\n  // PHASE 1: PREPARATION\n  // ================================\n  console.log(' [PHASE 1] PREPARATION - Disabling interaction and showing loading');\n\n  \n  // Close all panels before transition\n  if (closeAllPanels) {\n    closeAllPanels();\n  }\n  \n  // Store current state for rollback if needed\n  const rollbackState = {\n    gridId: fromLocation.g,\n    tiles: GlobalGridStateTilesAndResources.getTiles(),\n    resources: GlobalGridStateTilesAndResources.getResources(),\n    playerState: playersInGridManager.getPlayersInGrid(fromLocation.g)?.[playerId]\n  };\n\n  if (!fromLocation || !toLocation) {\n    console.error(' Invalid fromLocation or toLocation');\n    locationChangeManager.failLocationChange(new Error('Invalid locations'));\n    return false;\n  }\n\n  try {\n    // ================================\n    // PHASE 2: CLEANUP\n    // ================================\n    console.log(' [PHASE 2] CLEANUP - Removing from old grid and flushing updates');\n    \n    if (updateStatus) {\n      updateStatus('Leaving ...');\n    }\n\n    // Get player state before removal for stat preservation\n    const inMemoryFromPlayerState = playersInGridManager.getPlayersInGrid(fromLocation.g)?.[playerId];\n    const fromGridResponse = await axios.get(`${API_BASE}/api/load-grid-state/${fromLocation.g}`);\n    const fromPCs = fromGridResponse.data?.playersInGrid?.pcs || {};\n    const fromPlayerState = inMemoryFromPlayerState || fromPCs[playerId] || {};\n    \n    console.log(' [CLEANUP] Preserving player state:', fromPlayerState);\n\n    // Flush all pending updates BEFORE removing player\n    console.log(' [CLEANUP] Flushing pending position updates...');\n    await Promise.all([\n      NPCsInGridManager.flushGridPositionUpdates(fromLocation.g),\n      playersInGridManager.flushGridPositionUpdates(fromLocation.g)\n    ]);\n    \n    // Stop all timers and intervals for the old grid to prevent memory accumulation\n    console.log(' [CLEANUP] Stopping all timers and intervals for old grid...');\n    try {\n      NPCsInGridManager.stopGridTimer();\n      playersInGridManager.stopBatchSaving();\n      console.log(' [CLEANUP] Timers stopped successfully');\n    } catch (timerError) {\n      console.warn(' [CLEANUP] Error stopping timers:', timerError);\n    }\n\n    // Remove player from old grid with immediate DB persistence\n    console.log(' [CLEANUP] Removing player from old grid...');\n    await playersInGridManager.removePC(fromLocation.g, playerId);\n\n    // Emit socket events for leaving\n    socket.emit('player-left-grid', {\n      gridId: fromLocation.g,\n      playerId: playerId,\n      username: currentPlayer.username,\n    });\n    socket.emit('leave-grid', fromLocation.g);\n    \n    // ================================\n    // PHASE 3: LOAD NEW DATA\n    // ================================\n    console.log(' [PHASE 3] LOAD - Loading new grid data completely');\n    \n    if (updateStatus) {\n      updateStatus('Loading ...');\n    }\n\n    // Load grid state data\n    console.log(' [LOAD] Fetching grid state data...');\n    const toGridResponse = await axios.get(`${API_BASE}/api/load-grid-state/${toLocation.g}`);\n    \n    // Pre-load grid data to validate it exists, but don't apply to state yet\n    console.log(' [LOAD] Pre-loading grid data for validation...');\n    const gridDataResponse = await axios.get(`${API_BASE}/api/load-grid/${toLocation.g}`);\n    const newTilesData = gridDataResponse.data?.tiles || [];\n    const newResourcesData = gridDataResponse.data?.resources || [];\n\n    // Extract region from the new grid for region transition notifications\n    const toRegion = gridDataResponse.data?.region || null;\n    const fromRegion = currentPlayer.location?.region || null;\n    console.log(` [LOAD] Region transition check: from \"${fromRegion || 'none'}\" to \"${toRegion || 'none'}\"`);\n\n    const toPCs = toGridResponse.data?.playersInGrid?.pcs || {};\n    \n    // Prepare player data with preserved combat stats\n    const now = Date.now();\n    \n    console.log(' [LOAD] Preparing player data with preserved stats...');\n    console.log('  fromPlayerState.hp:', fromPlayerState.hp);\n    console.log('  fromPlayerState.maxhp:', fromPlayerState.maxhp);\n    \n    const finalHp = fromPlayerState.hp ?? currentPlayer.hp ?? 25;\n    const finalMaxHp = fromPlayerState.maxhp ?? currentPlayer.maxhp ?? 25;\n    \n    const playerData = {\n      playerId: playerId,\n      type: 'pc',\n      username: currentPlayer.username,\n      position: { x: toLocation.x, y: toLocation.y },\n      icon: currentPlayer.icon || '',\n      hp: finalHp,\n      maxhp: finalMaxHp,\n      armorclass: fromPlayerState.armorclass ?? currentPlayer.armorclass ?? 10,\n      attackbonus: fromPlayerState.attackbonus ?? currentPlayer.attackbonus ?? 0,\n      damage: fromPlayerState.damage ?? currentPlayer.damage ?? 1,\n      speed: fromPlayerState.speed ?? currentPlayer.speed ?? 1,\n      attackrange: fromPlayerState.attackrange ?? currentPlayer.attackrange ?? 1,\n      iscamping: fromPlayerState.iscamping ?? currentPlayer.iscamping ?? false,\n      isinboat: fromPlayerState.isinboat ?? currentPlayer.isinboat ?? false,\n      lastUpdated: now,\n    };\n    \n    // ================================\n    // PHASE 4: VALIDATION\n    // ================================\n    console.log(' [PHASE 4] VALIDATION - Verifying all data loaded successfully');\n    \n    if (updateStatus) {\n      updateStatus('Validating ...');\n    }\n    \n    // Validate that all required data was loaded\n    const validationChecks = {\n      tiles: Array.isArray(newTilesData) && newTilesData.length > 0,\n      resources: Array.isArray(newResourcesData),\n      gridState: toGridResponse.data && typeof toGridResponse.data === 'object',\n      playerData: playerData && \n                  typeof playerData.playerId === 'string' && \n                  typeof playerData.username === 'string' &&\n                  playerData.playerId.length > 0 &&\n                  playerData.username.length > 0\n    };\n    \n    console.log(' [VALIDATION] Data validation results:', validationChecks);\n    console.log(' [VALIDATION] Player data details:', {\n      playerId: playerData.playerId,\n      username: playerData.username,\n      type: typeof playerData.playerId,\n      valid: validationChecks.playerData\n    });\n    \n    const allValid = Object.values(validationChecks).every(check => check === true);\n    if (!allValid) {\n      throw new Error(`Validation failed: ${JSON.stringify(validationChecks)}`);\n    }\n    \n    console.log(' [VALIDATION] All data validation checks passed');\n    \n    // ================================\n    // PHASE 5: COMMIT STATE ATOMICALLY\n    // ================================\n    console.log(' [PHASE 5] COMMIT - Atomically swapping to new grid state');\n    \n    if (updateStatus) {\n      updateStatus('Entering ...');\n    }\n    \n    // Step 1: Join socket room first (ensure socket is connected)\n    if (socket.connected) {\n      socket.emit('join-grid', { gridId: toLocation.g, playerId: playerId });\n      console.log(' Emitted join-grid for grid transition:', toLocation.g);\n    } else {\n      console.warn(' Socket not connected during grid transition, waiting...');\n      await new Promise((resolve) => {\n        socket.once('connect', () => {\n          socket.emit('join-grid', { gridId: toLocation.g, playerId: playerId });\n          console.log(' Emitted join-grid after reconnect:', toLocation.g);\n          resolve();\n        });\n      });\n    }\n    \n    // Step 2: Add player to new grid database\n    console.log(' [COMMIT] Adding player to new grid database...');\n    await playersInGridManager.addPC(toLocation.g, playerId, playerData);\n    \n    // Step 3: Update player location in database\n    console.log(' [COMMIT] Updating player location in database...');\n    const locationResponse = await axios.post(`${API_BASE}/api/update-player-location`, {\n      playerId: playerId,\n      location: toLocation,\n    });\n\n    if (!locationResponse.data.success) {\n      throw new Error(`Failed to update player location: ${locationResponse.data.error}`);\n    }\n    \n    // Step 4: HYPOTHESIS TEST - Don't clear SVG cache to see if that's causing the issue\n    console.log(' [COMMIT] HYPOTHESIS TEST: Keeping SVG cache (not clearing)');\n    \n    // Step 5: ATOMICALLY COMMIT ALL STATE CHANGES\n    console.log(' [COMMIT] Atomically committing all state changes...');\n    \n    // Clear old state first\n    setGrid([]);\n    setResources([]);\n    setTileTypes([]);\n    GlobalGridStateTilesAndResources.setTiles([]);\n    GlobalGridStateTilesAndResources.setResources([]);\n    \n    // Small delay to ensure clearing completes\n    await new Promise(resolve => setTimeout(resolve, 10));\n    \n    // Update grid ID and player state first\n    setGridId(toLocation.g);\n    \n    const updatedPlayer = {\n      ...currentPlayer,\n      location: locationResponse.data.player.location,\n      // Preserve any other fields that may have been updated (e.g., homesteadGridCoord from handlePlayerDeath)\n      ...(locationResponse.data.player.homesteadGridCoord && { homesteadGridCoord: locationResponse.data.player.homesteadGridCoord }),\n    };\n    setCurrentPlayer(updatedPlayer);\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n    \n    // Now properly initialize the grid with tiles and resources using the correct function\n    console.log(' [COMMIT] Initializing grid with proper tile loading...');\n    await initializeGrid(TILE_SIZE, toLocation.g, setGrid, setResources, setTileTypes, updateStatus, updatedPlayer);\n    \n    console.log(' [COMMIT] State successfully committed with proper grid initialization');\n\n    //  CHECK: First time visiting valley - award trophy and show notification\n    if (toLocation.gtype && toLocation.gtype.startsWith('valley') && strings) {\n      // Check if player has \"Explore the Valley\" trophy\n      const hasValleyTrophy = currentPlayer.trophies?.some(trophy => trophy.name === \"Explore the Valley\");\n      \n      if (!hasValleyTrophy) {\n        console.log(' First time visiting valley - awarding \"Explore the Valley\" trophy');\n        \n        try {\n          // Award the trophy\n          const trophyResult = await earnTrophy(playerId, \"Explore the Valley\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          \n          if (trophyResult.success) {\n            // Show notification\n            showNotification('Message', {\n              title: strings[7002],\n              message: strings[7021]\n            });\n            \n            console.log(' Valley trophy awarded and notification shown');\n          } else {\n            console.warn(' Failed to award valley trophy:', trophyResult.error);\n          }\n        } catch (error) {\n          console.error(' Error awarding valley trophy:', error);\n        }\n      }\n    }\n\n    //  CHECK: Region transition notification\n    if (strings && fromRegion !== toRegion) {\n      // Regions are different - show a notification\n      if (toRegion) {\n        // Entering a new region\n        console.log(` Player entering region: ${toRegion}`);\n        showNotification('Travel', {\n          title: strings[10185] || 'Elsinore',\n          message: `${strings[10182] || 'You are entering '}${toRegion}.`\n        });\n      } else if (fromRegion) {\n        // Leaving a region (toRegion is null/undefined)\n        console.log(` Player leaving region: ${fromRegion}`);\n        showNotification('Travel', {\n          title: strings[10185] || 'Elsinore',\n          message: `${strings[10183] || 'You are leaving '}${fromRegion}.`\n        });\n      }\n    }\n\n    // ================================\n    // PHASE 6: FINALIZATION\n    // ================================\n    console.log(' [PHASE 6] FINALIZATION - Completing grid transition');\n    \n    // Initialize NPCs and PCs for the new grid\n    console.log(' [FINALIZATION] Initializing NPCs and PCs...');\n    try {\n      await NPCsInGridManager.initializeGridState(toLocation.g);\n      await playersInGridManager.initializePlayersInGrid(toLocation.g);  \n      \n      const freshGridState = NPCsInGridManager.getNPCsInGrid(toLocation.g);\n      const freshPCState = playersInGridManager.getPlayersInGrid(toLocation.g);\n\n      // Verify that our player exists in the fresh PC state\n      if (!freshPCState || !freshPCState[playerId]) {\n        console.warn(' [FINALIZATION] Player not found in fresh PC state, forcing re-add...');\n        \n        // Re-add the player to ensure they appear\n        await playersInGridManager.addPC(toLocation.g, playerId, playerData);\n        \n        // Get the updated state\n        const updatedPCState = playersInGridManager.getPlayersInGrid(toLocation.g);\n        \n        playersInGridManager.setPlayersInGridReact({ [toLocation.g]: {\n          pcs: updatedPCState,\n          playersInGridLastUpdated: Date.now(),\n        }});\n        \n        console.log(' [FINALIZATION] Player force-added to grid');\n      } else {\n        playersInGridManager.setPlayersInGridReact({ [toLocation.g]: {\n          pcs: freshPCState,\n          playersInGridLastUpdated: Date.now(),\n        }});\n      }\n\n      NPCsInGridManager.setGridStateReact({ [toLocation.g]: {\n        npcs: freshGridState,\n        NPCsInGridLastUpdated: Date.now(),\n      }});\n      \n      console.log(' [FINALIZATION] NPCs and PCs initialized successfully');\n    } catch (err) {\n      console.error(' [FINALIZATION] Error initializing NPCs/PCs:', err);\n      throw new Error(`Failed to initialize grid entities: ${err.message}`);\n    }\n    \n    // Handle signpost finding if needed\n    let finalX = toLocation.x;\n    let finalY = toLocation.y;\n\n    if (toLocation.findSignpost) {\n      console.log(` [FINALIZATION] Looking for ${toLocation.findSignpost}...`);\n      const currentResources = GlobalGridStateTilesAndResources.getResources();\n      const signpost = currentResources.find(res => res.type === toLocation.findSignpost);\n\n      if (signpost) {\n        finalX = signpost.x;\n        finalY = signpost.y;\n\n        // Apply directional offset so player doesn't spawn on top of the signpost\n        // The offset moves the player one tile away from the signpost in the appropriate direction\n        const signpostType = toLocation.findSignpost;\n        const signpostOffsets = {\n          'Signpost NE': { x: -1, y: 1 },\n          'Signpost E':  { x: -1, y: 0 },\n          'Signpost SE': { x: -1, y: -1 },\n          'Signpost S':  { x: 0,  y: -1 },\n          'Signpost SW': { x: 1,  y: -1 },\n          'Signpost W':  { x: 1,  y: 0 },\n          'Signpost NW': { x: 1,  y: 1 },\n          'Signpost N':  { x: 0,  y: 1 },\n          'Signpost Home': { x: 0, y: 1 }, // Keep existing behavior for town signpost\n        };\n\n        const offset = signpostOffsets[signpostType];\n        if (offset) {\n          finalX += offset.x;\n          finalY += offset.y;\n          console.log(` [FINALIZATION] Applied offset for ${signpostType}: (${offset.x}, ${offset.y}) -> final position (${finalX}, ${finalY})`);\n        }\n\n        const updatedPlayerData = {\n          ...playerData,\n          position: { x: finalX, y: finalY }\n        };\n        \n        playersInGridManager.updatePC(toLocation.g, playerId, updatedPlayerData);\n        \n        await axios.post(`${API_BASE}/api/save-single-pc`, {\n          gridId: toLocation.g,\n          playerId: playerId,\n          pc: updatedPlayerData,\n          lastUpdated: Date.now(),\n        });\n        \n        socket.emit('player-moved', {\n          gridId: toLocation.g,\n          playerId: playerId,\n          position: { x: finalX, y: finalY },\n          username: currentPlayer.username,\n        });\n        \n        console.log(` [FINALIZATION] Player positioned at signpost (${finalX}, ${finalY})`);\n      } else {\n        console.log(` [FINALIZATION] ${toLocation.findSignpost} not found, using default position`);\n      }\n    }\n    \n    // Center camera immediately after grid initialization, before verification delays\n    const centerCameraWithRetry = async (position, attempts = 0) => {\n      if (typeof position.x !== 'number' || typeof position.y !== 'number') {\n        console.warn(' [GRID TRANSITION] Cannot center camera - invalid coordinates:', position);\n        return;\n      }\n      \n      try {\n        centerCameraOnPlayer(position, TILE_SIZE);\n        console.log(` [GRID TRANSITION] Camera centered on (${position.x}, ${position.y})`);\n      } catch (error) {\n        if (attempts < 3) {\n          console.warn(` [GRID TRANSITION] Camera centering failed, retrying in 100ms (attempt ${attempts + 1}/3):`, error);\n          setTimeout(() => centerCameraWithRetry(position, attempts + 1), 100);\n        } else {\n          console.error(` [GRID TRANSITION] Camera centering failed after 3 attempts:`, error);\n        }\n      }\n    };\n    \n    // Center camera immediately\n    if (typeof finalX === 'number' && typeof finalY === 'number') {\n      await centerCameraWithRetry({ x: finalX, y: finalY });\n    } else {\n      console.warn(' [GRID TRANSITION] Cannot center camera - invalid final coordinates:', { finalX, finalY });\n    }\n    \n    // Note: Server verification removed to improve transition performance\n    // The race condition was rare and fallback values now handle incomplete data\n    // Clean up dead player if needed\n    if (currentPlayer.hp <= 0) {\n      console.log(' [FINALIZATION] Verifying dead player cleanup...');\n      try {\n        await axios.post(`${API_BASE}/api/remove-single-pc`, {\n          gridId: fromLocation.g,\n          playerId: playerId,\n        });\n        console.log(' [FINALIZATION] Dead player cleanup verified');\n      } catch (cleanupError) {\n        console.warn(' [FINALIZATION] Cleanup verification failed:', cleanupError);\n      }\n    }\n\n    // Emit socket events for new grid\n    socket.emit('set-username', { username: currentPlayer.username });\n    socket.emit('request-npc-controller', { gridId: toLocation.g });\n    \n    //  [DEBUG] Log playerData being emitted for socket debugging\n    console.log(' [GRID MGMT DEBUG] Emitting player-joined-grid with data:', {\n      gridId: toLocation.g,\n      playerId: playerId,\n      username: currentPlayer.username,\n      playerDataKeys: playerData ? Object.keys(playerData) : 'undefined',\n      playerDataHP: playerData?.hp,\n      playerDataMaxHP: playerData?.maxhp,\n      playerDataArmorClass: playerData?.armorclass,\n      playerDataAttackBonus: playerData?.attackbonus,\n      fullPlayerData: playerData\n    });\n    \n    socket.emit('player-joined-grid', {\n      gridId: toLocation.g,\n      playerId: playerId,\n      username: currentPlayer.username,\n      playerData,\n    });\n    \n    if (updateStatus && toLocation.gtype) {\n      await updateGridStatus(toLocation.gtype, null, updateStatus, currentPlayer, toLocation.g);\n    }\n\n    console.log(' [GRID TRANSITION] Transactional grid change completed successfully');\n    \n    // End fade transition - fade back to normal view\n    if (transitionFadeControl?.endTransition) {\n      transitionFadeControl.endTransition();\n    }\n    \n    // Mark location change as completed\n    locationChangeManager.completeLocationChange({\n      from: fromLocation,\n      to: toLocation,\n      playerId: playerId,\n      success: true\n    });\n\n    // Track visited grid (only make API call if not already visited)\n    console.log(` [GRIDS_VISITED] Checking visit tracking - gridCoord: ${toLocation.gridCoord}, type: ${typeof toLocation.gridCoord}`);\n    if (typeof toLocation.gridCoord === 'number' && toLocation.gridCoord >= 0) {\n      const alreadyVisited = isGridVisited(currentPlayer.gridsVisited, toLocation.gridCoord);\n      console.log(` [GRIDS_VISITED] Grid ${toLocation.gridCoord} alreadyVisited: ${alreadyVisited}, hasGridsVisited: ${!!currentPlayer.gridsVisited}`);\n      if (!alreadyVisited) {\n        console.log(` [GRIDS_VISITED] Making API call to mark grid ${toLocation.gridCoord} as visited for player ${playerId}`);\n        try {\n          const visitResponse = await axios.post(`${API_BASE}/api/mark-grid-visited`, {\n            playerId: playerId,\n            gridCoord: toLocation.gridCoord\n          });\n          console.log(` [GRIDS_VISITED] API response:`, visitResponse.data);\n          if (visitResponse.data.success && visitResponse.data.gridsVisited) {\n            // Update local player state with new gridsVisited data\n            const playerWithVisited = {\n              ...updatedPlayer,\n              gridsVisited: visitResponse.data.gridsVisited\n            };\n            setCurrentPlayer(playerWithVisited);\n            localStorage.setItem('player', JSON.stringify(playerWithVisited));\n            console.log(` [GRIDS_VISITED]  Marked grid ${toLocation.gridCoord} as visited`);\n          }\n        } catch (visitError) {\n          console.warn(' [GRIDS_VISITED]  Failed to mark grid as visited:', visitError);\n          // Non-critical error, don't fail the location change\n        }\n      } else {\n        console.log(` [GRIDS_VISITED] Grid ${toLocation.gridCoord} was already visited, skipping API call`);\n      }\n    } else {\n      console.log(` [GRIDS_VISITED] Skipping visit tracking - gridCoord invalid`);\n    }\n\n    return true;\n  } catch (error) {\n    console.error(' Location change error:', error);\n    \n    // End fade transition even on error to restore visibility\n    if (transitionFadeControl?.endTransition) {\n      transitionFadeControl.endTransition();\n    }\n    \n    //  NEW: Mark location change as failed\n    locationChangeManager.failLocationChange(error);\n    \n    throw error;\n  } \n};\n\n\n\n\nexport async function fetchGridData(gridId, updateStatus, DBPlayerData) {\n  try {\n    //console.log(`Fetching grid data for gridId: ${gridId}`);\n\n    // 1) Fetch the grid data (which now has separate playersInGrid and NPCsInGrid)\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data || {};\n    const { gridType, _id: fetchedGridId, ownerId, playersInGrid, NPCsInGrid } = gridData;\n\n    console.log('Fetched grid data:', gridData);\n\n    // 2) Combine playersInGrid and NPCsInGrid into a single NPCsInGrid\n    const combinedGridState = {\n      pcs: playersInGrid?.pcs || {},\n      npcs: NPCsInGrid?.npcs || {},\n    };\n\n    return { ...gridData, NPCsInGrid: combinedGridState }; // Return the full grid data with combined NPCsInGrid\n  } catch (error) {\n    console.error('Error fetching grid data:', error);\n    if (updateStatus) updateStatus('Failed to load grid data');\n    return {};\n  }\n}\n\n\n\n\n// Separate function for status updates\nexport async function updateGridStatus(gridType, ownerUsername, updateStatus, currentPlayer = null, gridId = null) {\n  if (!updateStatus) return;\n\n  console.log(\" UPDATING GRID STATUS message\");\n  switch (gridType) {\n    case 'homestead':\n      // If we have currentPlayer and gridId, check if it's their homestead\n      if (currentPlayer && gridId) {\n        const { username } = await fetchHomesteadOwner(gridId);\n        if (username === currentPlayer.username) {\n          updateStatus(112); // \"You're home.\"\n          return;\n        }\n        ownerUsername = username;\n      }\n      updateStatus(`Welcome to ${ownerUsername || 'Unknown'}'s homestead.`);\n      break;\n    case 'town':\n      updateStatus(14); // Town view\n      break;\n    case 'valley0':\n    case 'valley1':\n    case 'valley2':\n    case 'valley3':\n      updateStatus(16);\n      break;\n    case 'settlement':\n      updateStatus(12); // Settlement view\n      break;\n    case 'frontier':\n      updateStatus(13); // Frontier view\n      break;\n    default:\n      //updateStatus(0); // Default status\n      break;\n  }\n}\n\n/** Helper to get tiles in line of sight between two points using Bresenham's algorithm **/\nexport function getLineOfSightTiles(start, end) {\n    const tiles = [];\n    let x0 = Math.floor(start.x);\n    let y0 = Math.floor(start.y);\n    const x1 = Math.floor(end.x);\n    const y1 = Math.floor(end.y);\n\n    const dx = Math.abs(x1 - x0);\n    const dy = Math.abs(y1 - y0);\n    const sx = x0 < x1 ? 1 : -1;\n    const sy = y0 < y1 ? 1 : -1;\n    let err = dx - dy;\n\n    let prevX = x0;\n    let prevY = y0;\n\n    while (true) {\n        // Don't include the start or end positions\n        if ((x0 !== Math.floor(start.x) || y0 !== Math.floor(start.y)) &&\n            (x0 !== x1 || y0 !== y1)) {\n            tiles.push({ x: x0, y: y0 });\n\n            // Check if we moved diagonally - if so, add the two adjacent tiles\n            // to prevent line of sight going through corners\n            if (prevX !== x0 && prevY !== y0) {\n                tiles.push({ x: prevX, y: y0 }); // Vertical neighbor of previous position\n                tiles.push({ x: x0, y: prevY }); // Horizontal neighbor of current position\n            }\n        }\n\n        if (x0 === x1 && y0 === y1) break;\n\n        prevX = x0;\n        prevY = y0;\n\n        const e2 = 2 * err;\n        if (e2 > -dy) {\n            err -= dy;\n            x0 += sx;\n        }\n        if (e2 < dx) {\n            err += dx;\n            y0 += sy;\n        }\n    }\n\n    return tiles;\n}\n\n/** Helper to check if a position falls within a wall's footprint **/\nfunction isWithinWallFootprint(x, y, wall) {\n    const range = wall.range || 1;\n    // For walls with range > 1, check if (x, y) falls within the footprint\n    // Wall footprint extends from anchor (wall.x, wall.y) down and right\n    return (\n        x >= wall.x &&\n        x < wall.x + range &&\n        y >= wall.y &&\n        y < wall.y + range\n    );\n}\n\n/** Helper to check if there's a wall blocking line of sight **/\nexport function isWallBlocking(start, end) {\n    const resources = GlobalGridStateTilesAndResources.getResources();\n    const lineOfSightTiles = getLineOfSightTiles(start, end);\n\n    // Check each tile in the line of sight for walls\n    for (const tile of lineOfSightTiles) {\n        // Check if this tile is blocked by any wall (including large walls)\n        const wall = resources.find(res =>\n            (res.action === 'wall' || res.action === 'door') &&\n            isWithinWallFootprint(tile.x, tile.y, res)\n        );\n        if (wall) {\n            return true; // Wall found blocking the path\n        }\n    }\n\n    return false; // No walls blocking\n}\n","import API_BASE from '../config';\nimport axios from 'axios';\nimport { loadMasterResources } from './TuningManager';\n\n/**\n * Fetches the Signpost Town position from a homestead grid\n * @param {string} gridId - The homestead grid ID\n * @returns {Promise<{x: number, y: number}>} The x,y coordinates of Signpost Town, or default {x: 1, y: 1}\n */\nexport const fetchHomesteadSignpostPosition = async (gridId) => {\n  try {\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data;\n    \n    if (gridData.resources && Array.isArray(gridData.resources)) {\n      const signpostTown = gridData.resources.find(res => res.type === \"Signpost Town\");\n      if (signpostTown) {\n        console.log(` Found Signpost Town at (${signpostTown.x}, ${signpostTown.y}) on homestead grid ${gridId}`);\n        return { x: signpostTown.x, y: signpostTown.y };\n      } else {\n        console.log(` Signpost Town not found on homestead grid ${gridId}, using default (1, 1)`);\n      }\n    }\n  } catch (error) {\n    console.error(` Error fetching homestead grid data for grid ${gridId}:`, error);\n  }\n  \n  // Return default position if not found or error\n  return { x: 1, y: 1 };\n};\n\n/**\n * Fetches the Signpost Home position from a town grid (for arrival via signpost)\n * Returns position offset by one tile to the left of Signpost Home\n * @param {string} gridId - The town grid ID\n * @returns {Promise<{x: number, y: number}>} The x,y coordinates (offset -1 x from Signpost Home), or default {x: 0, y: 0}\n */\nexport const fetchTownSignpostPosition = async (gridId) => {\n  try {\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const gridData = gridResponse.data;\n\n    if (gridData.resources && Array.isArray(gridData.resources)) {\n      const signpostHome = gridData.resources.find(res => res.type === \"Signpost Home\");\n      if (signpostHome) {\n        console.log(` Found Signpost Home at (${signpostHome.x}, ${signpostHome.y}) on town grid ${gridId}, placing player at (${signpostHome.x - 1}, ${signpostHome.y})`);\n        return { x: signpostHome.x - 1, y: signpostHome.y };\n      } else {\n        console.log(` Signpost Home not found on town grid ${gridId}, using default (0, 0)`);\n      }\n    }\n  } catch (error) {\n    console.error(` Error fetching town grid data for grid ${gridId}:`, error);\n  }\n\n  // Return default position if not found or error\n  return { x: 0, y: 0 };\n};\n \nexport const fetchHomesteadOwner = async (gridId) => {\n  try {\n    console.log(`Fetching homestead owner for gridId: ${gridId}`);\n\n    //  Step 1: Fetch grid details (to get `ownerId`)\n    const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n    const { ownerId = null, gridType = null } = gridResponse.data;\n\n    console.log(\"ownerId =\",ownerId);\n\n    if (!ownerId) {\n      console.log(\" This homestead is unoccupied.\");\n      return { username: null, gridType };\n    }\n\n    //  Step 2: Fetch player document using `ownerId`\n    const playerResponse = await axios.get(`${API_BASE}/api/player/${ownerId._id}`);\n    const { username = null } = playerResponse.data;\n \n    if (username) {\n      console.log(` Homestead belongs to: ${username}`);\n      return { username, gridType };\n    } else {\n      console.warn(\" Owner's player document not found!\");\n      return { username: null, gridType };\n    }\n\n  } catch (error) {\n    console.error(' Error fetching homestead owner:', error);\n    return { username: null, gridType: null }; // Return defaults in case of an error\n  }\n};\n\n \nexport const addResourceToGrid = async (resources, newResource) => {\n  try {\n    const masterResources = await loadMasterResources();\n    console.log('masterResources:', masterResources);\n    console.log('current resources:', resources);\n    console.log('newResource:', newResource);\n\n    if (!Array.isArray(masterResources)) {\n      console.error('Failed to load masterResources or incorrect format:', masterResources);\n      return resources;\n    }\n\n    // Extract `type` from `newResource` payload\n    const resourceType = newResource?.type || newResource?.newResource;\n    if (!resourceType) {\n      console.error('[addResourceToGrid] Invalid resource payload:', newResource);\n      return resources;\n    }\n\n    // Find the resource template to get the symbol\n    const resourceTemplate = masterResources.find((template) => template.type === resourceType);\n\n    // Enrich only with the basics\n    const enrichedResource = {\n      ...resourceTemplate, // Use the full template from masterResources\n      type: resourceType, // Keep type\n      x: newResource.x,   // Keep x\n      y: newResource.y,   // Keep y\n      growEnd: newResource.growEnd, // Keep growEnd\n    };\n\n    console.log('Enriched resource:', enrichedResource);\n\n    // Ensure no duplicates exist at the same x, y position\n    return [\n      ...resources.filter((res) => !(res.x === newResource.x && res.y === newResource.y)),\n      enrichedResource, // Add the enriched resource\n    ];\n  } catch (error) {\n    console.error('Error enriching resource:', error);\n    return resources; // Return unmodified resources on error\n  }\n};\n\n\n// Inline function to calculate Euclidean distance safely\nexport const calculateDistance = (pos1, pos2) => {\n  if (!pos1 || !pos2 || typeof pos1.x === 'undefined' || typeof pos1.y === 'undefined' || typeof pos2.x === 'undefined' || typeof pos2.y === 'undefined') {\n    console.warn(\"Skipping distance calculation due to invalid position:\", { pos1, pos2 });\n    return Infinity;\n  }\n  return Math.sqrt(Math.pow(pos1.x - pos2.x, 2) + Math.pow(pos1.y - pos2.y, 2));\n};\n\n\n// Calculates the derived range based on base range + bonus from skill metadata\nexport const getDerivedRange = (currentPlayer, masterResources) => {\n  if (!currentPlayer || !Array.isArray(masterResources)) return 1;\n\n  const baseRange = currentPlayer.range || 1;\n\n  const bonusRangeFromSkills = currentPlayer.skills?.reduce((sum, skill) => {\n    const master = masterResources.find(r => r.type === skill.type);\n    if (master?.output === 'range' && typeof master.qtycollected === 'number') {\n      return sum + master.qtycollected;\n    }\n    return sum;\n  }, 0) || 0;\n\n  const gridType = currentPlayer?.location?.gtype;\n  const totalRange = gridType === 'homestead'\n    ? baseRange + bonusRangeFromSkills + 5\n    : baseRange + bonusRangeFromSkills;\n\n  return totalRange;\n};","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\",\n    \"connect_error\",\n    \"disconnect\",\n    \"disconnecting\",\n    \"newListener\",\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","import NPC from './GameFeatures/NPCs/AllNPCsShared';\nimport FloatingTextManager from './UI/FloatingText';\nimport NPCsInGridManager from './GridState/GridStateNPCs';\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport { io } from 'socket.io-client';\nimport { animateRemotePC } from './Render/RenderAnimatePosition';\nimport { createCollectEffect } from './VFX/VFX';\n\n// VERSION MARKER - If you see this log, the new socket code is loaded\nconsole.log(' socketManager.js loaded - VERSION 2 with join-grid fix');\n\nconst socket = io('https://vvgame-server.onrender.com', {\n  transports: ['websocket'],\n  autoConnect: false, // Don't connect until explicitly told to\n});\n\nexport function socketListenForPCJoinAndLeave(gridId, currentPlayer, isMasterResourcesReady, setPlayersInGrid, controllerUsername, setControllerUsername) {\n\n  console.log(\" useEffect for PC join & leave running. gridId:\", gridId, \"socket:\", !!socket);\n  console.log(\"   isMasterResourcesReady = \", isMasterResourcesReady);\n\n  if (!gridId || !currentPlayer || !isMasterResourcesReady) return;\n\nconst handlePlayerJoinedGrid = ({ gridId: joinedGridId, playerId, username, playerData, emitterId }) => {\n  if (emitterId === socket.id) {\n    console.log(' Ignoring player-joined event from self.');\n    return; // Ignore updates emitted by this client\n  }\n  \n  // Handle case where server sends undefined gridId\n  if (!joinedGridId) {\n    console.warn(` Received player-joined event with undefined gridId for ${username}. Assuming they joined current grid.`);\n    // If gridId is undefined, assume they joined the current grid\n    joinedGridId = gridId;\n  }\n  \n  // Only process if the player joined the current grid\n  if (joinedGridId !== gridId) {\n    console.log(` Player ${username} joined grid ${joinedGridId} (not current grid ${gridId})`);\n    return;\n  }\n  \n  console.log(` Player ${username} joined current grid ${gridId} with data:`, playerData);\n  \n  //  [DEBUG] Log received playerData structure for debugging\n  console.log(' [SOCKET DEBUG] Received player-joined-sync data:', {\n    playerId,\n    username,\n    playerDataKeys: playerData ? Object.keys(playerData) : 'undefined',\n    playerDataHP: playerData?.hp,\n    playerDataMaxHP: playerData?.maxhp,\n    playerDataArmorClass: playerData?.armorclass,\n    playerDataAttackBonus: playerData?.attackbonus,\n    fullPlayerData: playerData\n  });\n  \n  setPlayersInGrid(prevState => {\n    const existing = prevState[joinedGridId]?.pcs?.[playerId];\n    const incomingTime = new Date(playerData?.lastUpdated).getTime() || 0;\n    const localTime = new Date(existing?.lastUpdated).getTime() || 0;\n\n    if (!existing || incomingTime > localTime) {\n      console.log(` Inserting or updating PC ${playerId} from player-joined-sync.`);\n\n      //  Update memory manager locally only - NO database call\n      // The sender already saved to DB, we just need to sync local state\n      if (playersInGridManager.updatePCLocal) {\n        playersInGridManager.updatePCLocal(joinedGridId, playerId, playerData);\n      } else {\n        console.warn(' playersInGridManager.updatePCLocal is not defined.');\n      }\n\n      return {\n        ...prevState,\n        [joinedGridId]: {\n          ...prevState[joinedGridId],\n          pcs: {\n            ...(prevState[joinedGridId]?.pcs || {}),\n            [playerId]: playerData,\n          },\n        },\n      };\n    }\n\n    console.log(` Skipping player-joined-sync for ${playerId}; local is newer.`);\n    return prevState;\n  });\n};\n\n  const handlePlayerLeftGrid = ({ gridId: leftGridId, playerId, username, emitterId }) => {\n    console.log(` [SOCKET] Received player-left-sync event:`, { leftGridId, playerId, username, emitterId, currentGrid: gridId });\n\n    if (emitterId === socket.id) {\n      console.log(' Ignoring player-left event from self.');\n      return; // Ignore updates emitted by this client\n    }\n\n    // Handle case where server sends undefined gridId\n    if (!leftGridId) {\n      console.warn(` Received player-left event with undefined gridId for ${username}. Checking if they're in current grid.`);\n      // If gridId is undefined, check if the player is actually in our current grid and remove them\n      leftGridId = gridId; // Assume they left the current grid\n    }\n\n    // Only process if the player left the current grid\n    if (leftGridId !== gridId) {\n      console.log(` Player ${username} left grid ${leftGridId} (not current grid ${gridId})`);\n      return;\n    }\n    \n    console.log(` Player ${username} left current grid ${gridId}`);\n    //  Remove from memory manager\n    if (playersInGridManager.removePC) {\n      playersInGridManager.removePC(leftGridId, playerId);\n    } else {\n      console.warn(' playersInGridManager.removePC is not defined.');\n    }\n\n    setPlayersInGrid(prevState => {\n      if (!prevState[leftGridId]?.pcs) {\n        console.warn(` No players found in grid ${leftGridId} when trying to remove ${username}`);\n        return prevState;\n      }\n      \n      if (!prevState[leftGridId].pcs[playerId]) {\n        console.warn(` Player ${username} (${playerId}) not found in grid ${leftGridId} when trying to remove`);\n        return prevState;\n      }\n      \n      console.log(` Removing player ${username} (${playerId}) from grid ${leftGridId}`);\n      const updatedGrid = { ...prevState[leftGridId]?.pcs };\n      delete updatedGrid[playerId];\n      \n      // Check if removed player was the controller\n      if (controllerUsername === username && setControllerUsername) {\n        console.log(` Removed player ${username} was the NPCController, clearing controller`);\n        setControllerUsername(null);\n      }\n      \n      return {\n        ...prevState,\n        [leftGridId]: {\n          ...prevState[leftGridId],\n          pcs: updatedGrid,\n        },\n      };\n    });\n  };\n\n  const handleCurrentGridPlayers = ({ gridId: receivedGridId, pcs }) => {\n    console.log(` Received current PCs for grid ${receivedGridId}:`, pcs);\n    \n    // HP Debug logging for server data\n    Object.entries(pcs || {}).forEach(([playerId, pcData]) => {\n      // console.log(` [HP DEBUG] handleCurrentGridPlayers - Server data for ${playerId}:`);\n      // console.log('  pcData.hp:', pcData.hp);\n      // console.log('  pcData.maxhp:', pcData.maxhp);\n    });\n    \n    // Always process PC updates during transitions\n    // The state management will handle which grid is current\n    console.log(` Processing PC list for grid ${receivedGridId} (current grid: ${gridId})`);\n    \n    // If this update is for a different grid, it might be a transition in progress\n    const targetGridId = receivedGridId;\n    \n    // Replace the entire pcs object with server's authoritative list\n    setPlayersInGrid(prev => ({\n      ...prev,\n      [targetGridId]: {\n        ...prev[targetGridId],\n        pcs: pcs || {}, // Complete replacement, not a merge\n      },\n    }));\n    \n    // Also update the memory manager with the complete list\n    if (playersInGridManager.setAllPCs) {\n      playersInGridManager.setAllPCs(targetGridId, pcs || {});\n    }\n    \n    // Check if the current controller is in the player list\n    if (controllerUsername && setControllerUsername) {\n      const controllerStillInGrid = Object.values(pcs || {}).some(pc => pc.username === controllerUsername);\n      if (!controllerStillInGrid) {\n        console.log(` NPCController ${controllerUsername} is not in the current player list, clearing controller`);\n        setControllerUsername(null);\n      }\n    }\n  };\n\n  console.log(\" [NPCsInGrid join/leave] Subscribing to PC and NPC join/leave sync events for grid:\", gridId);\n  socket.on('player-joined-sync', handlePlayerJoinedGrid);\n  socket.on('player-left-sync', handlePlayerLeftGrid);\n  socket.on('current-grid-players', handleCurrentGridPlayers);\n\n  return () => {\n    socket.off('player-joined-sync', handlePlayerJoinedGrid);\n    socket.off('player-left-sync', handlePlayerLeftGrid);\n    socket.off('current-grid-players', handleCurrentGridPlayers);\n  };\n\n};\n\n//  SOCKET LISTENER: PCs: Real-time updates for GridState (PC sync)\nexport function socketListenForPCstateChanges(TILE_SIZE, gridId, currentPlayer, setPlayersInGrid, localPlayerMoveTimestampRef, setConnectedPlayers) {\n\n  console.log(\" useEffect for PC & NPC grid-state-sync running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!gridId) return;\n\n  // Updated handlePCSync to fully overwrite local PC with incoming PC if newer\n  const handlePCSync = (payload) => {\n    //console.log(\" Received sync-PCs payload:\", JSON.stringify(payload, null, 2));\n  \n    // Extract gridId and gridData first to check player ID\n    const gridEntries = Object.entries(payload).filter(([key]) => key !== 'emitterId');\n    if (gridEntries.length === 0) {\n      console.warn(\" No grid data found in sync-PCs payload:\", payload);\n      return;\n    }\n  \n    const [gridId, gridData] = gridEntries[0];\n    const { pcs, playersInGridLastUpdated } = gridData || {};\n    if (!pcs || typeof pcs !== 'object') {\n      console.warn(\" Invalid sync-PCs payload (missing pcs):\", payload);\n      return;\n    }\n  \n    const [playerId, incomingPC] = Object.entries(pcs)[0];\n    \n    // CRITICAL: Check if this is the local player FIRST, before any other checks\n    const currentPlayerId = currentPlayer?._id || currentPlayer?.playerId;\n    if (currentPlayer && playerId === String(currentPlayerId)) {\n      console.log(` Blocking socket sync for own player (${playerId}) - should never update local player from socket`);\n      return;\n    }\n    \n    // Then check emitterId to avoid processing our own emissions\n    const { emitterId } = payload;\n    const mySocketId = socket.id;\n    if (emitterId === mySocketId) {\n      console.log(` Skipping sync-PCs from self (emitterId = socket.id)`);\n      return;\n    }\n    const incomingTime = new Date(incomingPC?.lastUpdated).getTime();\n  \n    setPlayersInGrid((prevState) => {\n      const localPC = prevState[gridId]?.pcs?.[playerId];\n      const localTime = new Date(localPC?.lastUpdated).getTime() || 0;\n\n      // --- Begin changed fields logging and floating text (like NPCs) ---\n      const changedFields = Object.keys(incomingPC).filter(key => {\n        if (key === 'lastUpdated') return false;\n        return JSON.stringify(incomingPC[key]) !== JSON.stringify(localPC?.[key]);\n      });\n\n      if (changedFields.length > 0) {\n        console.log(` PC ${playerId} changed fields: ${changedFields.join(', ')}`);\n        // Show floating damage text if HP was reduced\n        if (changedFields.includes('hp') && localPC?.hp && incomingPC?.hp < localPC.hp) {\n          const damageTaken = localPC.hp - incomingPC.hp;\n          FloatingTextManager.addFloatingText(`- ${damageTaken}  HP`, incomingPC.position.x, incomingPC.position.y, TILE_SIZE);\n        }\n      }\n      // --- End changed fields logging and floating text ---\n\n      if (incomingTime <= localTime) {\n        console.log(` Skipping stale update for PC ${playerId}.`);\n        return prevState;\n      }\n\n      // Safety check: Make sure the grid and player still exist locally before updating\n      if (!prevState[gridId]?.pcs?.[playerId]) {\n        console.log(` Skipping update for PC ${playerId} - no longer in local grid ${gridId}`);\n        return prevState;\n      }\n\n      console.log(` Updating PC ${playerId} from socket event.`);\n\n      // Mark this player as connected since they're actively sending updates\n      if (setConnectedPlayers) {\n        setConnectedPlayers(prev => {\n          if (!prev.has(playerId)) {\n            console.log(` Marking player ${playerId} as connected (received state update)`);\n            return new Set(prev).add(playerId);\n          }\n          return prev;\n        });\n      }\n\n      // Update React state directly (primary source of truth)\n      const updatedState = {\n        ...prevState,\n        [gridId]: {\n          ...prevState[gridId],\n          pcs: {\n            ...prevState[gridId].pcs,\n            [playerId]: {\n              ...prevState[gridId].pcs[playerId],\n              ...incomingPC\n            }\n          }\n        }\n      };\n      \n      // Also update memory manager for consistency (but don't rely on it)\n      try {\n        playersInGridManager.updatePC(gridId, playerId, incomingPC);\n      } catch (error) {\n        console.warn(` Memory manager update failed for PC ${playerId}:`, error.message);\n      }\n\n      const prevPosition = localPC?.position;\n      const newPosition = incomingPC?.position;\n      if (\n        prevPosition &&\n        newPosition &&\n        (prevPosition.x !== newPosition.x || prevPosition.y !== newPosition.y)\n      ) {\n        animateRemotePC(playerId, prevPosition, newPosition, TILE_SIZE);\n      }\n\n      // Add playersInGridLastUpdated to our updatedState\n      updatedState[gridId].playersInGridLastUpdated = playersInGridLastUpdated || prevState[gridId]?.playersInGridLastUpdated;\n\n      // console.log(\" Pre-state before merge:\", JSON.stringify(prevState, null, 2));\n      // console.log(\" Incoming update for:\", playerId, \"with data:\", incomingPC);\n      // console.log(\" setPlayersInGrid payload:\", JSON.stringify(updatedState, null, 2));\n\n      return updatedState;\n    });\n  };\n\n  console.log(\" Subscribing to PC sync events for grid:\", gridId);\n  socket.on(\"sync-PCs\", handlePCSync);\n\n  return () => {\n    console.log(\" Unsubscribing from PC sync events for grid:\", gridId);\n    socket.off(\"sync-PCs\", handlePCSync);\n  };\n};\n\n\n//  SOCKET LISTENER: NPCs:  Real-time updates for GridStateNPC snc\nexport function socketListenForNPCStateChanges(TILE_SIZE, gridId, setGridState, npcController) {\n  //console.log(\" useEffect for NPC grid-state-sync running. gridId:\", gridId, \"socket:\", !!socket);\n  if (!gridId) return;\n\n  const handleNPCSync = (payload) => {\n    //console.log(' Received sync-NPCs payload:');\n  \n    const { emitterId } = payload;\n    const mySocketId = socket.id;\n    if (emitterId === mySocketId) {\n      console.log(` Skipping sync-NPCs from self (emitterId = socket.id)`);\n      return;\n    }\n  \n    // Extract gridId and gridData (we only expect one grid per payload)\n    const gridEntries = Object.entries(payload).filter(([key]) => key !== 'emitterId');\n    if (gridEntries.length === 0) {\n      console.warn(\" No grid data found in sync-NPCs payload:\", payload);\n      return;\n    }\n  \n    const [gridId, gridData] = gridEntries[0];\n    const { npcs, NPCsInGridLastUpdated } = gridData || {};\n    if (!npcs || typeof npcs !== 'object') {\n      console.warn(\" Invalid sync-NPCs payload (missing npcs):\", payload);\n      return;\n    }\n  \n    const isController = npcController.isControllingGrid(gridId);\n    console.log('IsNPCController:', isController);\n  \n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      const liveGrid = NPCsInGridManager.NPCsInGrid?.[gridId];\n  \n      Object.entries(npcs).forEach(([npcId, incomingNPC]) => {\n        if (!incomingNPC) {\n          //console.log(`   Received null NPC ${npcId}; removing from local state.`);\n          delete updatedNPCs[npcId];\n          if (liveGrid?.npcs) {\n            delete liveGrid.npcs[npcId];\n            //console.log(` Removed NPC ${npcId} from live NPCsInGrid`);\n          } else {\n            console.warn(` liveGrid.npcs missing for gridId ${gridId}`);\n          }\n          return;\n        }\n\n        const localNPC = updatedNPCs[npcId];\n        const incomingTime = new Date(incomingNPC.lastUpdated).getTime();\n        const localTime = localNPC?.lastUpdated ? new Date(localNPC.lastUpdated).getTime() : 0;\n\n        if (incomingTime > localTime) {\n          // Broadly log which attributes changed\n          const changedFields = Object.keys(incomingNPC).filter(key => {\n            if (key === 'lastUpdated') return false;\n            return JSON.stringify(incomingNPC[key]) !== JSON.stringify(localNPC?.[key]);\n          });\n          if (changedFields.length > 0) {\n            console.log(` NPC ${npcId} changed fields: ${changedFields.join(', ')}`);\n            // Show floating damage text if HP was reduced\n            if (changedFields.includes('hp') && localNPC?.hp && incomingNPC?.hp < localNPC.hp) {\n              const damageTaken = localNPC.hp - incomingNPC.hp;\n              FloatingTextManager.addFloatingText(`- ${damageTaken}  HP`, incomingNPC.position.x, incomingNPC.position.y, TILE_SIZE);\n            }\n          }\n\n          //console.log(`   Updating NPC ${npcId} from emitter ${emitterId}: ${incomingNPC.state}`);\n\n          const rehydrated = new NPC(\n            incomingNPC.id,\n            incomingNPC.type,\n            incomingNPC.position,\n            incomingNPC,\n            incomingNPC.gridId || gridId\n          );\n\n          updatedNPCs[npcId] = rehydrated;\n\n          if (liveGrid?.npcs) {\n            liveGrid.npcs[npcId] = rehydrated;\n            //console.log(` Rehydrated NPC ${npcId} into live NPCsInGrid`);\n          } else {\n            console.warn(` liveGrid.npcs missing for gridId ${gridId}`);\n          }\n        } else {\n          console.log(`   Skipped NPC ${npcId}, newer or same version already present.`);\n        }\n      });\n  \n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n  // Add handler for npc-moved-sync\n  const handleNPCMoveSync = ({ npcId, newPosition, emitterId }) => {\n    //console.log(' handleNPCMoveSync invoked.');\n    //console.log(' Received npc-moved-sync event:', { npcId, newPosition, emitterId });\n\n    if (!npcId || !newPosition) return;\n    \n    // Skip if this is the controller receiving their own broadcast\n    if (emitterId && emitterId === socket.id) {\n      console.log(` Skipping NPC animation for own broadcast (NPC ${npcId})`);\n      return;\n    }\n\n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      const existing = updatedNPCs[npcId];\n      //console.log(' SETTING GridState for existing:', existing);\n      if (existing) {\n        // Cache previous position BEFORE rehydration\n        const prevPosition = existing?.position;\n        //  Rehydrate if needed\n        const rehydrated = existing instanceof NPC\n          ? existing\n          : new NPC(\n              existing.id,\n              existing.type,\n              existing.position,\n              existing,\n              existing.gridId || gridId\n            );\n        //console.log(' Rehydrated NPC:', rehydrated);\n        // Animate movement if position changed\n        if (\n          prevPosition &&\n          newPosition &&\n          (prevPosition.x !== newPosition.x || prevPosition.y !== newPosition.y)\n        ) {\n          console.log('Calling animateRemotePC for NPC', npcId, prevPosition, newPosition);\n          animateRemotePC(npcId, prevPosition, newPosition, TILE_SIZE, 30); // More steps for smoother NPC movement\n        }\n        // Assign new position AFTER animation call\n        rehydrated.position = newPosition;\n        updatedNPCs[npcId] = rehydrated;\n        //  Also patch live memory state for controller\n        if (rehydrated instanceof NPC) {\n          NPCsInGridManager.NPCsInGrid[gridId].npcs[npcId] = rehydrated;\n        } else {\n          console.warn(` Tried to inject non-NPC instance into live NPCsInGrid for ${npcId}`);\n        }\n      }\n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n    // Add handler for npc-removal-sync\n  const handleNPCRemoval = ({ gridId, npcId }) => {\n    //console.log(` Received remove-NPC for ${npcId} in grid ${gridId}`);\n    setGridState(prevState => {\n      const updatedNPCs = { ...prevState.npcs };\n      delete updatedNPCs[npcId];\n      const liveGrid = NPCsInGridManager.NPCsInGrid?.[gridId];\n      if (liveGrid?.npcs) {\n        delete liveGrid.npcs[npcId];\n        console.log(` Removed NPC ${npcId} from live NPCsInGrid (remove-NPC event)`);\n      }\n      return {\n        ...prevState,\n        npcs: updatedNPCs,\n      };\n    });\n  };\n\n  //console.log(\" Subscribing to NPC sync events for grid:\", gridId);\n  socket.on(\"sync-NPCs\", handleNPCSync);\n  socket.on(\"npc-moved-sync\", handleNPCMoveSync); // main handler\n  socket.on(\"remove-NPC\", handleNPCRemoval);\n\n  return () => {\n    //console.log(\" Unsubscribing from NPC sync events for grid:\", gridId);\n    socket.off(\"sync-NPCs\", handleNPCSync);\n    socket.off(\"npc-moved-sync\", handleNPCMoveSync);\n    socket.off(\"remove-NPC\", handleNPCRemoval);\n  };\n}\n\n\n//  SOCKET LISTENER: Real-time updates for resources\nexport function socketListenForResourceChanges(TILE_SIZE, gridId, isMasterResourcesReady, setResources, masterResources, enrichResourceFromMaster) {\n\n  //console.log(\" useEffect for resource-sync running. gridId:\", gridId, \"socket:\", !!socket);\n  \n  // Wait until masterResources is ready\n  if (!gridId || !socket || !isMasterResourcesReady) {\n    console.warn('Master Resources not ready or missing gridId/socket.');\n    return; //  Don't process until ready\n  }\n  const handleResourceSync = ({ updatedResources }) => {\n    //console.log(\" Real-time tile/resource update received!\", updatedResources);\n\n    if (updatedResources?.length) {\n      setResources((prevResources) => {\n        if (!masterResources?.length) {\n          console.warn(` Skipping resource enrichment; masterResources not yet ready`);\n          return prevResources; // Do nothing until master data is populated\n        }\n        const updated = [...prevResources];\n        updatedResources.forEach((newRes) => {\n          if (!newRes || typeof newRes.x !== 'number' || typeof newRes.y !== 'number') {\n            console.warn(\" Skipping invalid socket resource:\", newRes);\n            return;\n          }\n\n          //  HANDLE RESOURCE REMOVAL\n          if (newRes.type === null) {\n            //console.log(` Removing resource at (${newRes.x}, ${newRes.y})`);\n            const indexToRemove = updated.findIndex(\n              (res) => res.x === newRes.x && res.y === newRes.y\n            );\n            //console.log('TILE_SIZE:', TILE_SIZE);\n            createCollectEffect(newRes.x, newRes.y, TILE_SIZE);\n\n            if (indexToRemove !== -1) {\n              updated.splice(indexToRemove, 1);\n            }\n            return; // Skip enrichment\n          }\n  \n          //  NORMAL ENRICHMENT PATH\n          const resourceTemplate = masterResources.find(r => r.type === newRes.type);\n          if (!resourceTemplate) {\n            console.warn(` No matching resource template found for ${newRes.type}`);\n          }\n          const enriched = enrichResourceFromMaster(newRes, masterResources);\n          //console.log(' LISTENER: enriched resource = ', enriched);\n          const filtered = updated.filter(r => !(r.x === newRes.x && r.y === newRes.y));\n          filtered.push(enriched);\n          updated.splice(0, updated.length, ...filtered);\n        });\n\n        // Now recreate shadow tiles for all multi-tile resources\n        // This also handles removal - any old shadow tiles not recreated will be gone\n        const finalResources = [...updated];\n        updated.forEach((resource) => {\n          if (resource.range && resource.range > 1) {\n            const anchorKey = resource.anchorKey || `${resource.type}-${resource.x}-${resource.y}`;\n            for (let dx = 0; dx < resource.range; dx++) {\n              for (let dy = 0; dy < resource.range; dy++) {\n                if (dx === 0 && dy === 0) continue; // Skip anchor\n                \n                const shadowX = resource.x + dx;\n                const shadowY = resource.y - dy;\n                const shadowResource = {\n                  type: 'shadow',\n                  x: shadowX,\n                  y: shadowY,\n                  parentAnchorKey: anchorKey,\n                  passable: resource.passable // Inherit from anchor\n                };\n                finalResources.push(shadowResource);\n              }\n            }\n          }\n        });\n        \n        return finalResources;\n      });\n    }\n  };\n\n  console.log(\" [resources] Subscribing to real-time updates for grid:\", gridId);\n  socket.on(\"resource-sync\", handleResourceSync);\n\n  return () => {\n    socket.off(\"resource-sync\", handleResourceSync);\n  };\n};\n\n//  SOCKET LISTENER: Real-time updates for tiles\nexport function socketListenForTileChanges(gridId, setTileTypes, mergeTiles) {\n\n  //console.log(\" useEffect for tile-sync running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!gridId || !socket) {\n    console.warn('Missing gridId or socket.');\n    return;\n  }\n\n  const handleTileSync = ({ updatedTiles }) => {\n    //console.log(\" Real-time tile update received!\", updatedTiles);\n\n    updatedTiles.forEach(tile => {\n      //console.log(\" Tile type in update:\", tile.type); // Add this\n    });\n\n    if (updatedTiles?.length) {\n      setTileTypes((prev) => {\n        const merged = mergeTiles(prev, updatedTiles); // Merge updated tiles into the current state\n        return merged;\n      });\n    }\n  };\n\n  console.log(\" [tiles] Subscribing to real-time tile updates for grid:\", gridId);\n  socket.on(\"tile-sync\", handleTileSync);\n\n  return () => {\n    console.log(\" Unsubscribing from tile-sync for grid:\", gridId);\n    socket.off(\"tile-sync\", handleTileSync);\n  };\n};\n\n// Add socket event listeners for NPC controller status\nexport function socketListenForNPCControllerStatus(gridId, currentPlayer, setControllerUsername) {\n\n  console.log(\" useEffect for npc-controller running. gridId:\", gridId, \"socket:\", !!socket);\n\n  if (!socket || !currentPlayer) return;\n\n  // Send username to server when joining grid\n  if (gridId) {\n    socket.emit('set-username', { username: currentPlayer.username });\n  }\n\n  socket.on('npc-controller-update', ({ controllerUsername }) => {\n    setControllerUsername(controllerUsername);\n  });\n\n  socket.on('npc-controller-assigned', ({ gridId: controlledGridId }) => {\n    console.log(` Assigned as NPC controller for grid ${controlledGridId}`);\n  });\n\n  socket.on('npc-controller-revoked', ({ gridId: revokedGridId }) => {\n    console.log(` Revoked as NPC controller for grid ${revokedGridId}`);\n  });\n\n  return () => {\n    socket.off('npc-controller-update');\n    socket.off('npc-controller-assigned');\n    socket.off('npc-controller-revoked');\n  };\n\n};\n\n\n//  SOCKET LISTENER: Force refresh on season reset\nexport function socketListenForSeasonReset() {\n\n  if (!socket) return;\n\n  socket.on(\"force-refresh\", ({ reason }) => {\n    console.warn(` Server requested refresh: ${reason}`);\n    window.location.reload();\n  });\n\n  return () => {\n    socket.off(\"force-refresh\");\n  };\n};\n\n//  SOCKET LISTENER: Player Connect and Disconnect\nexport function socketListenForConnectAndDisconnect(gridId, currentPlayer, setIsSocketConnected) {\n  const handleConnect = () => {\n    console.log(' Socket connected/reconnected!');\n    setIsSocketConnected(true);\n\n    // CRITICAL: Re-join grid room on reconnection (socket loses room membership on disconnect)\n    if (gridId && currentPlayer?._id) {\n      console.log(` Re-joining grid room: ${gridId}`);\n      socket.emit('join-grid', { gridId, playerId: currentPlayer._id });\n      socket.emit('join-player-room', { playerId: currentPlayer._id });\n      if (currentPlayer?.username) {\n        socket.emit('set-username', { username: currentPlayer.username });\n      }\n    }\n\n    // Emit presence info\n    socket.emit('player-connected', { playerId: currentPlayer._id, gridId });\n  };\n\n  const handleDisconnect = () => {\n    console.warn(' Socket disconnected.');\n    setIsSocketConnected(false);\n    // Notify others of disconnect\n    socket.emit('player-disconnected', { playerId: currentPlayer._id, gridId });\n  };\n\n  socket.on('connect', handleConnect);\n  socket.on('disconnect', handleDisconnect);\n\n  return () => {\n    socket.off('connect', handleConnect);\n    socket.off('disconnect', handleDisconnect);\n  };\n};\n\n//  SOCKET LISTENER: Listen for announcement that a player is connected/disconnected (I THINK ??)\nexport function socketListenForPlayerConnectedAndDisconnected(gridId, setConnectedPlayers) {\n  if (!socket || !gridId) return;\n\n  console.log(\" useEffect for player-connected/disconnected running. gridId:\", gridId);\n\n  //  Request current connection state on init\n  console.log(\" Requesting connected players list on startup.\");\n  socket.emit('request-connected-players', { gridId });\n\n  const handlePlayerConnected = ({ playerId }) => {\n    console.log(` Player connected: ${playerId}`);\n    setConnectedPlayers(prev => new Set(prev).add(playerId));\n  };\n\n  const handlePlayerDisconnected = ({ playerId }) => {\n    console.log(` Player disconnected: ${playerId}`);\n    setConnectedPlayers(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(playerId);\n      return newSet;\n    });\n  };\n\n  const handleCurrentConnectedPlayers = ({ connectedPlayerIds }) => {\n    console.log(\" Received full list of currently connected players:\", connectedPlayerIds);\n    setConnectedPlayers(new Set(connectedPlayerIds));\n  };\n\n  socket.on('player-connected', handlePlayerConnected);\n  socket.on('player-disconnected', handlePlayerDisconnected);\n  // Listen for the correct event name as emitted by the server\n  socket.on('connected-players', handleCurrentConnectedPlayers);\n\n  return () => {\n    socket.off('player-connected', handlePlayerConnected);\n    socket.off('player-disconnected', handlePlayerDisconnected);\n    socket.off('connected-players', handleCurrentConnectedPlayers);\n  };\n}\n\n\nexport function socketListenForChatMessages(setMessagesByScope) {\n  if (!socket) return;\n\n  const handleIncomingChatMessage = (msg) => {\n    console.log(\" Incoming chat message:\", msg);\n    const { scope, scopeId } = msg;\n    setMessagesByScope(prev => {\n      const prevMessages = prev[scopeId] || [];\n      return {\n        ...prev,\n        [scopeId]: [...prevMessages, msg],\n      };\n    });\n    //  Emit badge update for chat to all players in this scope\n    const badgePayload = {\n      playerId: null, // null means broadcast to all clients\n      username: null,\n      hasUpdate: true,\n    };\n    socket.emit('chat-badge-update', badgePayload);\n  };\n  socket.on('receive-chat-message', handleIncomingChatMessage);\n  return () => {\n    socket.off('receive-chat-message', handleIncomingChatMessage);\n  };\n}\n\nexport function emitChatMessage({ playerId, username, message, scope, scopeId }) {\n  if (!socket) return;\n  socket.emit('send-chat-message', {\n    playerId,\n    username,\n    message,\n    scope,\n    scopeId,\n    emitterId: socket.id //  Add this\n  });\n}\n\n\n\n//  SOCKET LISTENER: Consolidated badge updates (mailbox, store, chat, etc)\nexport function socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge) {\n  console.log(\" socketListenForBadgeUpdates called with player:\", currentPlayer?.username);\n\n  if (!socket || !currentPlayer) return;\n\n  const handleBadge = ({ type, playerId, username, hasUpdate }) => {\n    console.log(\" handleBadge invoked with:\", { type, playerId, username, hasUpdate });\n    console.log(\" SOCKET LISTENER: Received badge update:\", { type, playerId, username, hasUpdate });\n    console.log(\" Comparing currentPlayer._id:\", currentPlayer._id, \"to incoming:\", playerId);\n    \n    const isMatch =\n      type === 'chat' ? true :\n      (playerId && String(currentPlayer._id) === String(playerId)) ||\n      (username && currentPlayer.username === username);\n\n    console.log(\" isMatch:\", isMatch, \"for currentPlayer:\", currentPlayer.username);\n    if (!isMatch) return;\n\n    console.log(` Badge update received for ${type}.`);\n    updateBadge(currentPlayer, setBadgeState, type, hasUpdate);\n  };\n\n  socket.on('mailbox-badge-update', (data) => handleBadge({ ...data, type: 'mailbox' }));\n  socket.on('store-badge-update', (data) => handleBadge({ ...data, type: 'store' }));\n  socket.on('chat-badge-update', (data) => handleBadge({ ...data, type: 'chat' }));\n\n  return () => {\n    socket.off('mailbox-badge-update');\n    socket.off('store-badge-update');\n    socket.off('chat-badge-update');\n  };\n}\n\n// Utility to clear the chat badge for the current player\nexport function clearChatBadge(currentPlayer, setBadgeState, updateBadge) {\n  if (!currentPlayer) return;\n  updateBadge(currentPlayer, setBadgeState, 'chat', false);\n}\n\nexport default socket;\n","import API_BASE from '../config';\nimport socket from '../socketManager'; \nimport axios from 'axios';\nimport NPC from '../GameFeatures/NPCs/AllNPCsShared';\nimport { loadMasterResources } from '../Utils/TuningManager';\n\nlet gridTimer = null; // For periodic grid updates\nlet externalSetGridState = null;\n\nlet lastGridStateTimestamp = 0;\nexport const updateLastGridStateTimestamp = (timestamp) => {\n  if (timestamp > lastGridStateTimestamp) {\n    lastGridStateTimestamp = timestamp;\n  }\n};\nexport const getLastGridStateTimestamp = () => lastGridStateTimestamp;\n\nclass GridStateManager {\n  constructor() {\n    this.NPCsInGrid = {}; // Store grid states in memory\n    this.pendingPositionUpdates = new Map(); // Map<gridId, Map<npcId, {position, timestamp}>>\n    this.batchSaveInterval = null;\n    this.BATCH_SAVE_DELAY = 10000; // 10 seconds\n    console.log('GridStateManager instance created.');\n    \n    // Start batch save timer\n    this.startBatchSaveTimer();\n  }\n\n  /**\n   * Start the batch save timer\n   */\n  startBatchSaveTimer() {\n    if (this.batchSaveInterval) return; // Already running\n    \n    this.batchSaveInterval = setInterval(() => {\n      this.flushPendingPositionUpdates();\n    }, this.BATCH_SAVE_DELAY);\n    \n    console.log(' Batch save timer started (10s interval)');\n  }\n\n  /**\n   * Stop the batch save timer\n   */\n  stopBatchSaveTimer() {\n    if (this.batchSaveInterval) {\n      clearInterval(this.batchSaveInterval);\n      this.batchSaveInterval = null;\n      console.log(' Batch save timer stopped');\n    }\n  }\n\n  /**\n   * Queue a position update for batch saving\n   */\n  queuePositionUpdate(gridId, npcId, position) {\n    if (!this.pendingPositionUpdates.has(gridId)) {\n      this.pendingPositionUpdates.set(gridId, new Map());\n    }\n    \n    const gridUpdates = this.pendingPositionUpdates.get(gridId);\n    gridUpdates.set(npcId, {\n      position: { x: position.x, y: position.y },\n      timestamp: Date.now()\n    });\n    \n    //console.log(` Queued position update for NPC ${npcId} at (${position.x}, ${position.y})`);\n  }\n\n  /**\n   * Flush all pending position updates to the database\n   */\n  async flushPendingPositionUpdates() {\n    if (this.pendingPositionUpdates.size === 0) return;\n    \n    console.log(` Flushing batch position updates for ${this.pendingPositionUpdates.size} grids`);\n    \n    // Process each grid's updates\n    for (const [gridId, npcUpdates] of this.pendingPositionUpdates) {\n      if (npcUpdates.size === 0) continue;\n      \n      try {\n        // Convert Map to object for API\n        const updates = {};\n        for (const [npcId, update] of npcUpdates) {\n          updates[npcId] = update.position;\n        }\n        \n        // Send batch update to server\n        await axios.post(`${API_BASE}/api/batch-update-npc-positions`, {\n          gridId,\n          updates,\n          timestamp: Date.now()\n        });\n        \n        console.log(` Batch saved ${npcUpdates.size} NPC positions for grid ${gridId}`);\n        \n        // Clear the updates for this grid\n        npcUpdates.clear();\n      } catch (error) {\n        console.error(` Failed to batch save positions for grid ${gridId}:`, error);\n        // Keep the updates to retry next time\n      }\n    }\n    \n    // Clean up empty grid entries\n    for (const [gridId, npcUpdates] of this.pendingPositionUpdates) {\n      if (npcUpdates.size === 0) {\n        this.pendingPositionUpdates.delete(gridId);\n      }\n    }\n  }\n\n  /**\n   * Force flush position updates for a specific grid\n   * Used when player leaves a grid to ensure all updates are saved\n   */\n  async flushGridPositionUpdates(gridId) {\n    const npcUpdates = this.pendingPositionUpdates.get(gridId);\n    if (!npcUpdates || npcUpdates.size === 0) return;\n    \n    try {\n      // Convert Map to object for API\n      const updates = {};\n      for (const [npcId, update] of npcUpdates) {\n        updates[npcId] = update.position;\n      }\n      \n      // Send batch update to server\n      await axios.post(`${API_BASE}/api/batch-update-npc-positions`, {\n        gridId,\n        updates,\n        timestamp: Date.now()\n      });\n      \n      console.log(` Force batch saved ${npcUpdates.size} NPC positions for grid ${gridId}`);\n      \n      // Clear the updates for this grid\n      npcUpdates.clear();\n      this.pendingPositionUpdates.delete(gridId);\n    } catch (error) {\n      console.error(` Failed to force batch save positions for grid ${gridId}:`, error);\n    }\n  }\n\n  /**\n   * Update ONLY the position of an NPC without saving to database\n   * Used for movement to reduce server load\n   */\n  async updateNPCPosition(gridId, npcId, position) {\n    //console.log(` Updating position for NPC ${npcId} to (${position.x}, ${position.y})`);\n    \n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid || !NPCsInGrid.npcs?.[npcId]) {\n      console.error(`Cannot update position for NPC ${npcId}. Not found in grid ${gridId}`);\n      return;\n    }\n    \n    const npc = NPCsInGrid.npcs[npcId];\n    const now = Date.now();\n    \n    // Update position in memory\n    npc.position = { x: position.x, y: position.y };\n    npc.lastUpdated = now;\n    \n    // Queue for batch save instead of immediate save\n    this.queuePositionUpdate(gridId, npcId, position);\n    \n    // Still emit socket for real-time sync with other players\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npcId]: { ...npc, position } },\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n    \n    // Update React state - force timestamp update\n    NPCsInGrid.NPCsInGridLastUpdated = now;\n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          ...NPCsInGrid,\n          NPCsInGridLastUpdated: now,\n        },\n      }));\n    }\n  }\n\n  registerSetGridState(setterFunction) {\n    externalSetGridState = setterFunction;\n  }\n\n  /**\n   * Initialize the NPCsInGrid for a specific gridId.\n   */\n  async initializeGridState(gridId) {\n\n    console.log(' Initialize NPCsInGrid for gridId:', gridId);\n    if (!gridId) {\n      console.error('initializeGridState: gridId is undefined.');\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/load-grid-state/${gridId}`);\n      const {\n        NPCsInGrid = { npcs: {}, lastUpdated: 0 },\n      } = response.data;\n\n      // Build a consolidated local state with independent timestamps\n      const hydratedState = {\n        npcs: NPCsInGrid.npcs || {},\n        NPCsInGridLastUpdated: new Date(NPCsInGrid.lastUpdated || 0).getTime(),\n      };\n      const npcs = hydratedState.npcs || {};\n      console.log('Fetched NPCsInGrid:', hydratedState);\n\n      // Load master resources\n      const masterResources = await loadMasterResources();\n\n      // Rehydrate NPCs\n      if (npcs) {\n        Object.keys(npcs).forEach((npcId) => {\n          const lightweightNPC = npcs[npcId];\n          const npcTemplate = masterResources.find((res) => res.type === lightweightNPC.type);\n          if (!npcTemplate) {\n            console.warn(` Missing template for NPC type: ${lightweightNPC.type}`);\n            console.log('Master resources:', masterResources.map(res => res.type));\n          }\n          const hydrated = new NPC(\n            npcId,\n            lightweightNPC.type,\n            lightweightNPC.position,\n            { ...npcTemplate, ...lightweightNPC },\n            gridId\n          );\n\n          console.log('   Hydrated NPC instance:', hydrated);\n\n          NPCsInGrid.npcs[npcId] = hydrated;\n        });\n      }\n\n      this.NPCsInGrid[gridId] = NPCsInGrid;\n\n      if (this.setGridStateReact) {\n        console.log(' Syncing initialized NPCs to React state for gridId:', gridId);\n        this.setGridStateReact(prev => ({\n          ...prev,\n          [gridId]: {\n            ...(prev[gridId] || {}),\n            ...NPCsInGrid,\n          },\n        }));\n      }\n\n      console.log(` Initialized and enriched NPCsInGrid for gridId ${gridId}:`, NPCsInGrid);\n    } catch (error) {\n      console.error('Error fetching NPCsInGrid:', error);\n    }\n  }\n\n  /**\n   * Get the NPCsInGrid for a specific gridId.\n   */\n  getNPCsInGrid(gridId) {\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid) {\n      console.warn(` No NPCsInGrid found for gridId: ${gridId}`);\n      return { npcs: {} }; // Only return NPCs\n    }\n    return NPCsInGrid.npcs;\n  }\n\n  /**\n   * Spawn a new NPC and immediately save the updated NPCsInGrid to the DB.\n   */\n  async spawnNPC(gridId, npcType, position) {\n    // DEBUG: Log input parameters for spawnNPC\n    console.log('spawnNPC called with:', { gridId, npcType, position });\n    if (typeof npcType === 'object' && npcType?.type) {\n      npcType = npcType.type; // Extract the type string\n    }\n    if (typeof npcType !== 'string') {\n      console.error('Invalid npcType. Expected a string but got:', npcType);\n      return;\n    }\n    const masterResources = await axios.get(`${API_BASE}/api/resources`);\n    const npcTemplate = masterResources.data.find((res) => res.type === npcType && res.category === 'npc');\n    if (!npcTemplate) {\n      console.error(`NPC template not found for type: ${npcType}`);\n      return;\n    }\n\n    const npcId = `${Date.now()}`;\n\n    let lightweightNPC;\n\n    if (npcTemplate.action === 'graze') {\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'idle',\n        position,\n        hp: 0,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n      };\n    } else if (npcTemplate.action === 'spawn') {  // Ensure spawners track nextspawn\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'hungry',\n        position,\n        hp: npcTemplate.maxhp,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n        nextspawn: Date.now() + npcTemplate.speed * 1000, // Ensure nextspawn is explicitly set\n      };\n    } else {\n      lightweightNPC = {\n        id: npcId,\n        type: npcType,\n        action: npcTemplate.action,\n        state: 'idle',\n        position,\n        hp: npcTemplate.maxhp,\n        maxhp: npcTemplate.maxhp,\n        lastUpdated: Date.now(),\n      };\n    }\n    console.log('Creating lightweightNPC:', lightweightNPC);\n\n    // Ensure NPC is properly instantiated as an `NPC` class object before adding\n    const npc = new NPC(\n      npcId,\n      npcType,\n      position,\n      { ...npcTemplate, ...lightweightNPC },\n      gridId // Include gridId\n    );\n    this.addNPC(gridId, npc);\n\n    console.log(`Successfully added NPC to NPCsInGrid. NPC ID: ${npcId}`);\n\n    const updatedGridState = this.getNPCsInGrid(gridId);\n    this.setAllNPCs(gridId, updatedGridState);\n  }\n\n  /**\n   * Add an NPC to the NPCsInGrid using per-NPC save model.\n   */\n  async addNPC(gridId, npc) {\n    console.log(`Adding NPC to NPCsInGrid for gridId: ${gridId}. NPC:`, npc);\n    let NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid) {\n      console.warn(` No NPCsInGrid found for gridId: ${gridId}. Initializing new entry.`);\n      NPCsInGrid = { npcs: {}, NPCsInGridLastUpdated: Date.now() };\n      this.NPCsInGrid[gridId] = NPCsInGrid;\n    }\n    if (!NPCsInGrid.npcs) NPCsInGrid.npcs = {};\n\n    const now = Date.now();\n    npc.lastUpdated = now;\n\n    NPCsInGrid.npcs[npc.id] = npc;\n\n    try {\n      await axios.post(`${API_BASE}/api/save-single-npc`, {\n        gridId,\n        npcId: npc.id,\n        npc,\n        lastUpdated: now,\n      });\n      console.log(` Saved single NPC ${npc.id} to server.`);\n    } catch (error) {\n      console.error(` Failed to save single NPC ${npc.id}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npc.id]: npc }, // or [npc.id]: npc in addNPC\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      console.log(\" Emitting update-NPCsInGrid-NPCs with payload:\", JSON.stringify(payload, null, 2));\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n  }\n\n  /**\n   * Update an NPC in the NPCsInGrid using the per-NPC save model.\n   */\n  async updateNPC(gridId, npcId, newProperties) {\n    //console.log(`++ Updating NPC ${npcId} for gridId: ${gridId}`);\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    const existing = NPCsInGrid?.npcs?.[npcId];\n\n    if (!NPCsInGrid || !NPCsInGrid.npcs?.[npcId]) {\n      console.error(`Cannot update NPC ${npcId}. No NPCsInGrid or NPC found for gridId: ${gridId}`);\n      return;\n    }\n\n    if (!(existing instanceof NPC)) {\n      console.error(` Skipping updateNPC for ${npcId}  not an instance of NPC:`, existing);\n      return;\n    }\n  \n    const now = Date.now();\n    const npc = NPCsInGrid.npcs[npcId]; // already an instance of NPC\n    Object.assign(npc, newProperties);\n    npc.lastUpdated = now;\n\n    //console.log(`[ NPCsInGridManager.updateNPC] NPC ${npcId} updated with:`, newProperties);\n\n    try {\n      // Send only the essential properties to the server\n      const npcData = {\n        id: npc.id,\n        type: npc.type,\n        position: npc.position,\n        state: npc.state,\n        hp: npc.hp,\n        maxhp: npc.maxhp,\n        grazeEnd: npc.grazeEnd,\n        lastUpdated: npc.lastUpdated,\n        action: npc.action,\n        gridId: npc.gridId\n      };\n\n      // For spawner NPCs, include spawner-specific properties\n      if (npc.action === 'spawn') {\n        npcData.requires = npc.requires;\n        npcData.qtycollected = npc.qtycollected;\n        npcData.range = npc.range;\n        npcData.nextspawn = npc.nextspawn;\n      }\n\n      //console.log(` Saving NPC ${npcId} to server with state: ${npcData.state}`);\n      \n      await axios.post(`${API_BASE}/api/save-single-npc`, {\n        gridId,\n        npcId,\n        npc: npcData,\n        lastUpdated: now,\n      });\n      //console.log(` Saved single NPC ${npcId} to server with state: ${npcData.state}`);\n    } catch (error) {\n      console.error(` Failed to save single NPC ${npcId}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      const payload = {\n        [gridId]: {\n          npcs: { [npcId]: npc }, // or [npc.id]: npc in addNPC\n          NPCsInGridLastUpdated: now,\n        },\n        emitterId: socket.id,\n      };\n      //console.log(\" Emitting update-NPCsInGrid-NPCs with payload:\", JSON.stringify(payload, null, 2));\n      socket.emit('update-NPCsInGrid-NPCs', payload);\n    }\n    \n    // Update React state to trigger re-renders - force timestamp update\n    NPCsInGrid.NPCsInGridLastUpdated = now;\n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          ...NPCsInGrid,\n          NPCsInGridLastUpdated: now,\n        },\n      }));\n    }\n  }\n\n\n  /**\n   * Remove an NPC from the NPCsInGrid using the per-NPC save model.\n   */\n  async removeNPC(gridId, npcId) {\n    console.log(`Removing NPC ${npcId} from gridId: ${gridId}`);\n    const NPCsInGrid = this.NPCsInGrid[gridId];\n    if (!NPCsInGrid || !NPCsInGrid.npcs) {\n      console.error(`Cannot remove NPC. No NPCsInGrid or NPCs found for gridId: ${gridId}`);\n      return;\n    }\n\n    // Clear any pending position updates for this NPC to prevent race condition\n    const gridUpdates = this.pendingPositionUpdates.get(gridId);\n    if (gridUpdates) {\n      gridUpdates.delete(npcId);\n      console.log(` Cleared pending position update for removed NPC ${npcId}`);\n    }\n\n    delete NPCsInGrid.npcs[npcId];\n    this.setAllNPCs(gridId, NPCsInGrid.npcs); //  Update React state after deletion\n\n    try {\n      await axios.post(`${API_BASE}/api/remove-single-npc`, {\n        gridId,\n        npcId,\n      });\n      console.log(` Removed single NPC ${npcId} from server.`);\n    } catch (error) {\n      console.error(` Failed to remove single NPC ${npcId}:`, error);\n    }\n\n    if (socket && socket.emit) {\n      socket.emit('remove-NPC', {\n        gridId,\n        npcId,\n        emitterId: socket.id,\n      });\n      console.log(` Emitted NPC removal for ${npcId}`);\n    }\n  }\n\n  /**\n   * Save only NPCs in the NPCsInGrid to the database.\n   * This version dehydrates live NPC instances into plain objects and matches the PC saving structure.\n   */\n  async saveGridStateNPCs(gridId) {\n    //console.log(' saveGridStateNPCs called with gridId:', gridId);\n    try {\n      const NPCsInGrid = this.NPCsInGrid[gridId];\n      if (!NPCsInGrid || !NPCsInGrid.npcs) {\n        console.warn(` No NPCs to save for grid ${gridId}`);\n        return;\n      }\n\n      // Update local NPC timestamp\n      const now = Date.now();\n      NPCsInGrid.NPCsInGridLastUpdated = now;\n\n      // Dehydrate the NPCs to simple objects\n      const dehydratedNPCs = {};\n      Object.entries(NPCsInGrid.npcs).forEach(([id, npc]) => {\n        dehydratedNPCs[id] = {\n          id: npc.id,\n          type: npc.type,\n          position: npc.position,\n          state: npc.state,\n          hp: npc.hp,\n          maxhp: npc.maxhp,\n          grazeEnd: npc.grazeEnd,\n          lastUpdated: npc.lastUpdated,\n        };\n      });\n\n      const payload = {\n        gridId,\n        npcs: dehydratedNPCs,\n        NPCsInGridLastUpdated: now,\n      };\n\n      //console.log(' Payload for saving NPCs:', payload);\n\n      // Save to server\n      await axios.post(`${API_BASE}/api/save-grid-state-npcs`, payload);\n      //console.log(`  Saved NPCs for grid ${gridId}`);\n\n      // Emit updated NPCs to other clients\n      if (socket && socket.emit) {\n        console.log(` Emitting NPC grid-state for grid ${gridId}`);\n        socket.emit('update-NPCsInGrid-NPCs', {\n          gridId,\n          npcs: dehydratedNPCs,\n          NPCsInGridLastUpdated: now,\n        });\n      }\n    } catch (error) {\n      console.error(` Error saving NPCs for grid ${gridId}:`, error);\n    }\n  }\n\n  /**\n   * Start periodic updates for NPCs in the NPCsInGrid.\n   */\n  startGridTimer(gridId) {\n    if (gridTimer) clearInterval(gridTimer);\n\n    gridTimer = setInterval(() => {\n      const NPCsInGrid = this.NPCsInGrid[gridId];\n      if (!NPCsInGrid) return;\n\n      const { npcs } = NPCsInGrid;\n      const now = Date.now();\n\n      Object.values(npcs || {}).forEach((npc) => {\n        if (npc instanceof NPC && typeof npc.update === 'function') {\n          //console.log(`Calling update() for NPC ID: ${npc.id}`);\n          npc.update(now, NPCsInGrid); // Let each NPC handle its own updates\n        } else {\n          console.error(`NPC ID: ${npc.id} is not a valid NPC instance or missing update method. NPC:`, npc);\n        }\n      });\n\n      console.log(`Processed NPC updates for gridId ${gridId}.`);\n    }, 1000);\n  }\n\n  /**\n   * Stop periodic updates for NPCs.\n   */\n  stopGridTimer() {\n    if (gridTimer) clearInterval(gridTimer);\n    gridTimer = null;\n  }\n\n  // Stop updates or clear grid state\n  stopGridStateUpdates() {\n    if (this.updateInterval) {\n      clearInterval(this.updateInterval); // Clear periodic updates\n      this.updateInterval = null;\n      //console.log('Grid state updates stopped.');\n    }\n    \n    // Flush any pending position updates before clearing\n    this.flushPendingPositionUpdates();\n    \n    // Stop the batch save timer\n    this.stopBatchSaveTimer();\n    \n    this.NPCsInGrid = {}; // Clear in-memory grid states\n    this.pendingPositionUpdates.clear(); // Clear pending updates\n  }\n\n  registerSetGridState(setter) {\n    this.setGridStateReact = setter;\n  }\n\n  setAllNPCs(gridId, npcsObject) {\n    //console.log('Setting all NPCs for gridId:', gridId, '; NPCs object:', npcsObject);\n  \n    // Safely get or create the current state\n    const existingState = this.NPCsInGrid[gridId] || {};\n    const lastUpdated = existingState.NPCsInGridLastUpdated || Date.now();\n  \n    this.NPCsInGrid[gridId] = {\n      ...existingState,\n      npcs: npcsObject || {},\n      NPCsInGridLastUpdated: lastUpdated,\n    };\n  \n    if (this.setGridStateReact) {\n      this.setGridStateReact(prev => ({\n        ...prev,\n        [gridId]: {\n          ...(prev[gridId] || {}),\n          npcs: npcsObject || {},\n          NPCsInGridLastUpdated: Date.now(), // Force update timestamp\n        },\n      }));\n    }\n  }\n\n}\n\nconst NPCsInGridManager = new GridStateManager();\n\n// Export individual methods for direct use\nexport const {\n  initializeGridState,\n  getNPCsInGrid,\n  addNPC,\n  updateNPC,\n  updateNPCPosition,\n  removeNPC, \n  registerSetGridState,\n  setAllNPCs,\n  flushPendingPositionUpdates,\n  flushGridPositionUpdates,\n} = NPCsInGridManager;\n\n// Default export for the entire manager\nexport default NPCsInGridManager;","import API_BASE from '../config';\nimport axios from 'axios';\nimport playersInGridManager from '../GridState/PlayersInGrid';\n\n// Helper function to check if an item is a currency (doesn't count against inventory)\nexport const isCurrency = (resourceType) => {\n  return resourceType === 'Money' || \n         resourceType === 'Gem' || \n         resourceType === 'Home Deed' ||\n         resourceType === 'Town Key' ||\n         resourceType === 'Skeleton Key' ||\n         resourceType === 'Golden Key' ||\n         resourceType === 'Dungeon Key' ||\n         resourceType === 'Mirror Key' ||\n         resourceType === 'Yellow Heart' ||\n         resourceType === 'Green Heart' ||\n         resourceType === 'Purple Heart';\n};\n\n/**\n * Calculate skill multiplier for a specific resource type\n * @param {String} resourceType - The resource type to check skills for\n * @param {Array} playerSkills - Player's skills array\n * @param {Object} masterSkills - Master skills definitions\n * @returns {Object} Object containing multiplier, applicable skills, and whether skills apply\n */\nexport function calculateSkillMultiplier(resourceType, playerSkills, masterSkills) {\n  const applicableSkills = [];\n  let multiplier = 1;\n  \n  // Find all skills that buff this resource type\n  playerSkills.forEach(skill => {\n    const buffValue = masterSkills?.[skill.type]?.[resourceType];\n    if (buffValue && buffValue > 1) {\n      applicableSkills.push(skill.type);\n      multiplier *= buffValue;\n    }\n  });\n  \n  return {\n    multiplier,\n    skills: applicableSkills,\n    hasSkills: applicableSkills.length > 0\n  };\n}\n\n/**\n * Apply skill multiplier to a base quantity\n * @param {Number} baseQuantity - Base quantity before skills\n * @param {Number} multiplier - Skill multiplier\n * @returns {Number} Final quantity after applying skills\n */\nexport function applySkillMultiplier(baseQuantity, multiplier) {\n  return Math.floor(baseQuantity * multiplier);\n}\n\n/**\n * Derives the total warehouse and backpack capacity based on player skills and master resources.\n * @param {object} currentPlayer - The player object including skills and base capacities.\n * @param {Array} masterResources - Array of all master resource definitions.\n * @param {object} globalTuning - Global tuning configuration object.\n * @returns {object} - { warehouse: number, backpack: number }\n */\n\nexport function deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning) {\n  const baseWarehouse = currentPlayer?.warehouseCapacity || 0;\n  const baseBackpack = currentPlayer?.backpackCapacity || 0;\n  const isGold = currentPlayer?.accountStatus === \"Gold\";\n  \n  // Get Gold bonuses from globalTuning parameter\n  const warehouseBonus = isGold ? (globalTuning?.warehouseCapacityGold || 100000) : 0;\n  const backpackBonus = isGold ? (globalTuning?.backpackCapacityGold || 5000) : 0;\n\n  return (currentPlayer?.skills || []).reduce(\n    (acc, skill) => {\n      const skillDetails = masterResources?.find(res => res.type === skill.type);\n      if (skillDetails) {\n        const bonus = skillDetails.qtycollected || 0;\n        if (skillDetails.output === 'warehouseCapacity') {\n          acc.warehouse += bonus;\n        } else if (skillDetails.output === 'backpackCapacity') {\n          acc.backpack += bonus;\n        }\n      }\n      return acc;\n    },\n    { warehouse: baseWarehouse + warehouseBonus, backpack: baseBackpack + backpackBonus }\n  );\n}\n\n\n\nexport const canAfford = (recipe, inventory = [], backpack = [], amount = 1) => {\n  if (!recipe) return false;\n  const inv = Array.isArray(inventory) ? inventory : [];\n  const bp = Array.isArray(backpack) ? backpack : [];\n  // Check up to 10 ingredients to support all recipes\n  for (let i = 1; i <= 10; i++) {\n    const ingredientType = recipe[`ingredient${i}`];\n    const ingredientQty = recipe[`ingredient${i}qty`] * amount;\n    if (ingredientType && ingredientQty >= 0) {\n      const backpackItem = bp.find((item) => item.type === ingredientType);\n      const inventoryItem = inv.find((item) => item.type === ingredientType);\n      const totalQty = (backpackItem?.quantity || 0) + (inventoryItem?.quantity || 0);\n      if (totalQty < ingredientQty) { return false; }\n    }\n  }\n  return true;\n};\n\n/**\n * Checks if there's room to store a resource without actually adding it\n * @param {object} params - Parameters for checking capacity\n * @returns {boolean} - True if there's room, false otherwise\n */\nexport const hasRoomFor = ({\n  resource,\n  quantity,\n  currentPlayer,\n  inventory,\n  backpack,\n  masterResources,\n  globalTuning\n}) => {\n  const isCurrencyItem = isCurrency(resource);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n  \n  \n  // Currencies always have room\n  if (isCurrencyItem) return true;\n  \n  // Check backpack skill if storing in backpack\n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      return false;\n    }\n  }\n  \n  // Check capacity\n  const target = isHomestead ? inventory : backpack;\n  \n  const { warehouse, backpack: maxBackpack } = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources || [], globalTuning);\n  const capacity = isHomestead ? warehouse : maxBackpack;\n  \n  const totalItems = target\n    .filter(item => item && !isCurrency(item.type) && typeof item.quantity === 'number')\n    .reduce((acc, item) => acc + item.quantity, 0);\n    \n  return totalItems + quantity <= capacity;\n};\n\n\nexport async function fetchInventoryAndBackpack(playerId) {\n  if (!playerId) {\n    console.error('No playerId provided for fetching inventory and backpack');\n    return { inventory: [], backpack: [] };\n  }\n  try {\n    const response = await axios.get(`${API_BASE}/api/inventory/${playerId}`);\n    return {\n      inventory: response.data?.inventory || [],\n      backpack: response.data?.backpack || [],\n      warehouseCapacity: response.data?.warehouseCapacity || 0,\n      backpackCapacity: response.data?.backpackCapacity || 0,\n    };\n  } catch (error) {\n    console.error('Error fetching inventory and backpack:', error);\n    return { inventory: [], backpack: [] };\n  }\n}\n\nexport async function fetchInventory(playerId) {\n  if (!playerId) {\n    console.error('No playerId provided for fetching inventory');\n    return [];\n  }\n  try {\n    const response = await axios.get(`${API_BASE}/api/inventory/${playerId}`);\n    return response.data?.inventory || [];\n  } catch (error) {\n    console.error('Error fetching inventory:', error);\n    return [];\n  }\n}\n\n \n/**\n * Refreshes the player's state after an inventory update.\n * Ensures that the latest inventory and other properties are reflected in the UI.\n * @param {string} playerId - The player's ID.\n * @param {Function} setCurrentPlayer - Function to update the currentPlayer state.\n * @param {boolean} preserveInventory - If true, preserves local inventory/backpack state\n */\nexport async function refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, preserveInventory = true) {\n  try {\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const updatedPlayerData = response.data;\n    \n    console.log(' [HP DEBUG] refreshPlayerAfterInventoryUpdate - Server player data:');\n    console.log('  updatedPlayerData.hp:', updatedPlayerData.hp);\n    console.log('  updatedPlayerData.maxhp:', updatedPlayerData.maxhp);\n    console.log('  updatedPlayerData.baseHp:', updatedPlayerData.baseHp);\n    console.log('  updatedPlayerData.baseMaxhp:', updatedPlayerData.baseMaxhp);\n    \n    // If preserveInventory is true, keep the current inventory and backpack\n    if (preserveInventory) {\n      setCurrentPlayer(currentPlayer => {\n        const merged = {\n          ...updatedPlayerData,\n          inventory: currentPlayer.inventory,\n          backpack: currentPlayer.backpack\n        };\n        \n        // Pull latest location from playersInGridManager if available\n        const gridPlayer = playersInGridManager.getPlayersInGrid(merged.location?.g)?.[playerId];\n        if (gridPlayer) {\n          merged.location = {\n            ...merged.location,\n            x: gridPlayer.position.x,\n            y: gridPlayer.position.y,\n          };\n        }\n        \n        return merged;\n      });\n    } else {\n      // Original behavior - full replacement\n      // Pull latest location from playersInGridManager if available\n      const gridPlayer = playersInGridManager.getPlayersInGrid(updatedPlayerData.location?.g)?.[playerId];\n      if (gridPlayer) {\n        updatedPlayerData.location = {\n          ...updatedPlayerData.location,\n          x: gridPlayer.position.x,\n          y: gridPlayer.position.y,\n        };\n      }\n      setCurrentPlayer(updatedPlayerData);\n    }\n  } catch (error) {\n    console.error('Error refreshing player:', error);\n  }\n}\n\n\n\n////////////////////////////////////////\nexport async function gainIngredients({\n  playerId,\n  currentPlayer,\n  resource,\n  quantity,\n  inventory,\n  backpack,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) {\n  const isCurrencyItem = isCurrency(resource);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n\n  const target = isCurrencyItem || isHomestead ? [...inventory] : [...backpack];\n\n  //  Backpack skill check if storing in backpack\n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      if (updateStatus) updateStatus(19); // Missing backpack\n      return {\n        success: false,\n        isCapacityError: true, // Treat missing backpack as a capacity issue for rollback purposes\n        isMissingBackpack: true, // Specific flag for missing backpack\n        isNetworkError: false,\n        error: new Error('Missing backpack skill')\n      };\n    }\n  }\n    \n  //  Capacity check\n  if (!isCurrencyItem) {\n    const { warehouse, backpack: maxBackpack } = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources || [], globalTuning);\n    const capacity = isHomestead ? warehouse : maxBackpack;\n    const totalItems = target\n      .filter(item => item && !isCurrency(item.type) && typeof item.quantity === 'number')\n      .reduce((acc, item) => acc + item.quantity, 0);\n    if (totalItems + quantity > capacity) {\n      if (updateStatus) updateStatus(isHomestead ? 20 : 21); // 20 = warehouse full, 21 = backpack full\n      return {\n        success: false,\n        isCapacityError: true,\n        isNetworkError: false,\n        error: new Error(isHomestead ? 'Warehouse full' : 'Backpack full')\n      };\n    }\n  }\n\n  //  Apply gain\n  const index = target.findIndex((item) => item.type === resource);\n  if (index >= 0) {\n    target[index].quantity += quantity;\n  } else {\n    target.push({ type: resource, quantity });\n  }\n\n  // Prepare delta payload for update-inventory-delta endpoint, including explicit target\n  const deltaPayload = {\n    playerId,\n    delta: [{\n      type: resource,\n      quantity: quantity,\n      target: storingInBackpack ? 'backpack' : 'inventory'\n    }]\n  };\n\n  try {\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, deltaPayload);\n    \n    setInventory(isCurrencyItem || isHomestead ? target : inventory);\n    setBackpack(!isCurrencyItem && !isHomestead ? target : backpack);\n    \n    // Update currentPlayer with new inventory to ensure UI updates properly\n    setCurrentPlayer(prev => ({\n      ...prev,\n      inventory: isCurrencyItem || isHomestead ? target : inventory,\n      backpack: !isCurrencyItem && !isHomestead ? target : backpack\n    }));\n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n    return true;\n  } catch (err) {\n    console.error(\" Error gaining ingredient:\", err);\n    console.error(\"Error details:\", {\n      status: err.response?.status,\n      data: err.response?.data,\n      message: err.message,\n      resource,\n      quantity,\n      target: storingInBackpack ? 'backpack' : 'inventory'\n    });\n    \n    // Check if this is a real conflict vs a temporary error\n    const isCapacityError = err.response?.status === 400 && \n      (err.response?.data?.error?.includes('capacity') || \n       err.response?.data?.error?.includes('full'));\n    \n    const isNetworkError = !err.response || err.response?.status >= 500;\n    \n    // Return error details so caller can decide whether to rollback\n    return {\n      success: false,\n      isCapacityError,\n      isNetworkError,\n      error: err\n    };\n  }\n}\n\n\n////////////////////////////////////////\nexport async function spendIngredients({\n  playerId,\n  recipe,\n  inventory,\n  backpack,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  updateStatus,\n}) {\n  let updatedInventory = [...inventory];\n  let updatedBackpack = [...backpack];\n\n  if (!canAfford(recipe, inventory, backpack, 1)) { updateStatus(4); return false; }\n\n  // Build delta changes array\n  const deltaChanges = [];\n  \n  // Deduct ingredients with new logic (support up to 10 ingredients)\n  for (let i = 1; i <= 10; i++) {\n    const type = recipe?.[`ingredient${i}`];\n    const qty = recipe?.[`ingredient${i}qty`];\n    if (type && qty) {\n      let remaining = qty;\n      \n      // First deduct from backpack\n      const backpackItem = updatedBackpack.find((item) => item.type === type);\n      if (backpackItem) {\n        const used = Math.min(remaining, backpackItem.quantity);\n        backpackItem.quantity -= used;\n        remaining -= used;\n        deltaChanges.push({ type, quantity: -used, target: 'backpack' });\n        if (backpackItem.quantity <= 0) {\n          updatedBackpack.splice(updatedBackpack.indexOf(backpackItem), 1);\n        }\n      }\n      \n      // Then deduct from inventory if needed\n      if (remaining > 0) {\n        const inventoryItem = updatedInventory.find((item) => item.type === type);\n        if (inventoryItem) {\n          const used = Math.min(remaining, inventoryItem.quantity);\n          inventoryItem.quantity -= used;\n          deltaChanges.push({ type, quantity: -used, target: 'inventory' });\n          if (inventoryItem.quantity <= 0) {\n            updatedInventory.splice(updatedInventory.indexOf(inventoryItem), 1);\n          }\n        }\n      }\n      \n    }\n  }\n\n  try {\n    // Use delta update endpoint to avoid race conditions\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n      playerId,\n      delta: deltaChanges\n    });\n    \n    setInventory(updatedInventory);\n    setBackpack(updatedBackpack);\n    \n    // Update currentPlayer with new inventory to ensure UI updates properly\n    setCurrentPlayer(prev => ({\n      ...prev,\n      inventory: updatedInventory,\n      backpack: updatedBackpack\n    }));\n    \n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n    \n    // Return object that's backward compatible (truthy) but also includes updated arrays\n    const result = { success: true, updatedInventory, updatedBackpack };\n    // Make the object truthy for backward compatibility\n    result.valueOf = () => true;\n    return result;\n\n  } catch (err) {\n    console.error(\" Error spending ingredients:\", err);\n    return false;\n  }\n}","// Mapping of signpost directions to entrance positions on the destination grid\nconst TRANSIT_POSITIONS = {\n  N: { x: 31, y: 63 },   // Enter from south edge, middle\n  NE: { x: 0, y: 63 },   // Enter from southwest corner\n  E: { x: 0, y: 31 },    // Enter from west edge, middle\n  SE: { x: 0, y: 0 },    // Enter from northwest corner\n  S: { x: 31, y: 0 },    // Enter from north edge, middle\n  SW: { x: 63, y: 0 },   // Enter from northeast corner\n  W: { x: 63, y: 30 },   // Enter from east edge, middle\n  NW: { x: 63, y: 63 },  // Enter from southeast corner\n};\n\n// Get the opposite direction for entrance position\nconst OPPOSITE_DIRECTION = {\n  N: \"S\",\n  NE: \"SW\",\n  E: \"W\",\n  SE: \"NW\",\n  S: \"N\",\n  SW: \"NE\",\n  W: \"E\",\n  NW: \"SE\"\n};\n\nexport function getEntryPosition(direction) {\n  return TRANSIT_POSITIONS[direction] || { x: 0, y: 0 }; // Default to center if unknown\n}\n\nexport function getOppositeEntryPosition(direction) {\n  const oppositeDir = OPPOSITE_DIRECTION[direction];\n  return TRANSIT_POSITIONS[oppositeDir] || { x: 0, y: 0 };\n}\n","import API_BASE from \"../../config\";\nimport axios from \"axios\";\nimport { changePlayerLocation } from \"../../Utils/GridManagement\";\nimport { getEntryPosition } from './transitConfig';\nimport playersInGridManager from \"../../GridState/PlayersInGrid\";\nimport { fetchHomesteadOwner, fetchHomesteadSignpostPosition, fetchTownSignpostPosition } from \"../../Utils/worldHelpers\";\nimport { updateGridStatus } from \"../../Utils/GridManagement\";\nimport FloatingTextManager from \"../../UI/FloatingText\";\nimport { earnTrophy } from \"../Trophies/TrophyUtils\";\nimport { tryAdvanceFTUEByTrigger } from \"../FTUE/FTUEutils\";\n\nexport async function handleTransitSignpost(\n  currentPlayer,\n  resourceType,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  skills,\n  closeAllPanels,\n  bulkOperationContext,\n  masterResources,\n  strings = null,\n  masterTrophies = null,\n  transitionFadeControl = null\n) {\n  try {\n    if (typeof updateStatus !== \"function\") {\n      console.warn(\" updateStatus is not a function:\", updateStatus);\n    }\n    console.log(\"Handling transit for resource:\", resourceType);\n    \n    //  Start fade transition IMMEDIATELY for responsive feel (both signpost and keyboard movement)\n    if (transitionFadeControl?.startTransition) {\n      console.log(' [IMMEDIATE FADE] Starting fade transition for signpost travel');\n      console.log(' [DEBUG] transitionFadeControl object:', transitionFadeControl);\n      transitionFadeControl.startTransition();\n    } else {\n      console.warn(' [DEBUG] transitionFadeControl not available or missing startTransition method');\n      console.log(' [DEBUG] transitionFadeControl value:', transitionFadeControl);\n    }\n    \n    console.log(\" currentPlayer before checking skills:\", currentPlayer);\n    console.log(\" currentPlayer.skills:\", currentPlayer.skills);\n\n    // 1) Handle special signposts (no Horse skill required for Town/Home)\n    const { g: currentGridId, s: settlementId, f: frontierId } = currentPlayer.location;\n    \n    // Check if this is Signpost Town or Signpost Home (no Horse required)\n    const isSpecialSignpost = resourceType === \"Signpost Town\" || resourceType === \"Signpost Home\" || resourceType === \"Signpost Town Home\";\n    \n    // 2) For non-special signposts, ensure the player has the Horse skill\n    if (!isSpecialSignpost) {\n        skills = currentPlayer.skills.length ? currentPlayer.skills : await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`).then(res => res.data.skills || []);\n\n        console.log('skillResponse.data: ', skills);\n        console.log('currentPlayer = ',currentPlayer.username);\n        \n        const hasHorse = skills.some((item) => item.type === \"Horse\" && item.quantity > 0);\n        console.log('hasHorse: ', hasHorse);\n        if (!hasHorse) { \n            updateStatus(15);\n            // Add floating text at player's current position using PlayersInGrid\n            const playersInGrid = playersInGridManager.getPlayersInGrid(currentGridId);\n            if (playersInGrid && playersInGrid[currentPlayer.playerId]) {\n                const position = playersInGrid[currentPlayer.playerId].position;\n                FloatingTextManager.addFloatingText(91, position.x, position.y, TILE_SIZE);\n            }\n            // End fade transition since travel failed due to missing Horse skill\n            if (transitionFadeControl?.endTransition) {\n                transitionFadeControl.endTransition();\n            }\n            return; \n        }\n    }\n\n    // Signpost Home\n    if (resourceType === \"Signpost Home\") {\n      // First check if player has Home Deed in backpack or inventory (warehouse)\n      const hasHomeDeedInBackpack = currentPlayer.backpack?.some(item => item.type === \"Home Deed\" && item.quantity > 0);\n      const hasHomeDeedInInventory = currentPlayer.inventory?.some(item => item.type === \"Home Deed\" && item.quantity > 0);\n\n      if (!hasHomeDeedInBackpack && !hasHomeDeedInInventory) {\n        updateStatus(109);\n        // End fade transition since travel failed\n        if (transitionFadeControl?.endTransition) {\n          transitionFadeControl.endTransition();\n        }\n        return;\n      }\n\n      // Then check if player has Horse skill (required to travel home)\n      const playerSkills = currentPlayer.skills?.length ? currentPlayer.skills : await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`).then(res => res.data.skills || []);\n      const hasHorse = playerSkills.some((item) => item.type === \"Horse\" && item.quantity > 0);\n\n      if (!hasHorse) {\n        updateStatus(15);\n        // Add floating text at player's current position\n        const playersInGrid = playersInGridManager.getPlayersInGrid(currentGridId);\n        if (playersInGrid && playersInGrid[currentPlayer.playerId]) {\n          const position = playersInGrid[currentPlayer.playerId].position;\n          FloatingTextManager.addFloatingText(91, position.x, position.y, TILE_SIZE);\n        }\n        // End fade transition since travel failed due to missing Horse skill\n        if (transitionFadeControl?.endTransition) {\n          transitionFadeControl.endTransition();\n        }\n        return;\n      }\n\n      console.log(\" Traveling to homestead:\", {\n        gridId: currentPlayer.gridId,\n        settlementId: currentPlayer.settlementId,\n        gridCoord: currentPlayer.gridCoord,\n      });\n\n      // Fetch the homestead grid data to find Signpost Town location\n      try {\n        const signpostPosition = await fetchHomesteadSignpostPosition(currentPlayer.gridId);\n\n        // Get the homestead's actual gridCoord from the player's stored homesteadGridCoord\n        const homesteadGridCoord = currentPlayer.homesteadGridCoord;\n\n        // Place player at x+1 offset from Signpost Town\n        const newPlayerPosition = {\n          x: signpostPosition.x + 1,\n          y: signpostPosition.y,\n          g: currentPlayer.gridId,      // The player's homestead grid\n          s: currentPlayer.settlementId,\n          f: currentPlayer.location.f,\n          gtype: \"homestead\",\n          gridCoord: homesteadGridCoord,\n        };\n        \n        updateStatus(101);\n        await changePlayerLocation(\n          currentPlayer,\n          currentPlayer.location,   // fromLocation\n          newPlayerPosition,        // toLocation\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          TILE_SIZE,\n          closeAllPanels,\n          updateStatus,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies,\n          transitionFadeControl\n        );\n\n        // Check if this is the player's first time traveling to homestead\n        const hasTraveledToHomesteadTrophy = currentPlayer.trophies?.some(\n          t => t.type === \"TraveledToHomestead\" && t.progress > 0\n        );\n        if (!hasTraveledToHomesteadTrophy && currentPlayer?.playerId) {\n          console.log(\" First time traveling to homestead - awarding trophy and advancing FTUE\");\n          await earnTrophy(currentPlayer.playerId, \"TraveledToHomestead\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          // Try to advance FTUE if player is at the correct step for FirstHomesteadVisit\n          await tryAdvanceFTUEByTrigger('FirstHomesteadVisit', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n        }\n\n      } catch (error) {\n        console.error(\" Error traveling home:\", error);\n        if (error.message && error.message.includes('Failed to remove player from previous grid')) {\n          updateStatus(\"Failed to leave current location. Please try again.\");\n        } else {\n          updateStatus(\"Error traveling home\");\n        }\n      }\n      \n      return;\n    }\n\n    // Signpost Town Home or Signpost Town\n    if (resourceType === \"Signpost Town Home\" || resourceType === \"Signpost Town\") {\n      const isPlayerOwnedTown = resourceType === \"Signpost Town Home\";\n      const targetSettlementId = isPlayerOwnedTown ? currentPlayer.settlementId : settlementId;\n      \n      console.log(isPlayerOwnedTown \n        ? \"Signpost Town Home clicked. Finding the first town grid in the player's owned settlement.\"\n        : \"Signpost Town clicked. Finding the first town grid in the settlement.\");\n\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${targetSettlementId}`);\n      const settlement = settlementResponse.data;\n      if (!settlement || !settlement.grids) { \n        updateStatus(104); \n        if (transitionFadeControl?.endTransition) {\n          transitionFadeControl.endTransition();\n        }\n        return; \n      }\n\n      // Find any sub-grid with gridType = town\n      const townGrid = settlement.grids.flat().find((grid) => grid.gridType === \"town\" && grid.gridId);\n      if (!townGrid) { \n        updateStatus(104); \n        if (transitionFadeControl?.endTransition) {\n          transitionFadeControl.endTransition();\n        }\n        return; \n      }\n\n      console.log(\"Found town grid:\", townGrid);\n\n      // Fetch the town grid data to find Signpost Home location\n      try {\n        const signpostPosition = await fetchTownSignpostPosition(townGrid.gridId);\n        \n        const newPlayerPosition = {\n          x: signpostPosition.x,\n          y: signpostPosition.y,\n          g: townGrid.gridId,\n          s: targetSettlementId,\n          f: frontierId,\n          gtype: \"town\",\n          gridCoord: townGrid.gridCoord,\n        };\n        \n        updateStatus(102);\n        \n        await changePlayerLocation(\n          currentPlayer,\n          currentPlayer.location,   // fromLocation\n          newPlayerPosition,        // toLocation\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          TILE_SIZE,\n          closeAllPanels,\n          updateStatus,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies,\n          transitionFadeControl\n        );\n        \n      } catch (error) {\n        console.error(` Error traveling to ${isPlayerOwnedTown ? \"player's town\" : \"town\"}:`, error);\n        if (error.message && error.message.includes('Failed to remove player from previous grid')) {\n          updateStatus(\"Failed to leave current location. Please try again.\");\n        } else {\n          updateStatus(\"Error traveling to town\");\n        }\n      }\n      \n      return;\n    }\n\n    // 3) Regular signpost => Move directionally\n    console.log(\"Regular Signpost clicked. Calculating transit options dynamically.\");\n    const direction = resourceType.replace(\"Signpost \", \"\");\n    const offsets = {\n      N:  [-1,  0],\n      S:  [ 1,  0],\n      E:  [ 0,  1],\n      W:  [ 0, -1],\n      NE: [-1,  1],\n      SE: [ 1,  1],\n      SW: [ 1, -1],\n      NW: [-1, -1],\n    };\n\n    // 4) Fetch the current Settlement\n    const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n    const settlement = settlementResponse.data;\n    if (!settlement || !settlement.grids) {\n      console.error(\"Settlement data is invalid or missing grids.\"); \n      updateStatus(105); \n      if (transitionFadeControl?.endTransition) {\n        transitionFadeControl.endTransition();\n      }\n      return; \n    }\n\n      // Find the sub-grid doc matching currentGridId\n    console.log(` [TRANSIT DEBUG] Looking for currentGridId: ${currentGridId} in settlement`);\n    console.log(` [TRANSIT DEBUG] Settlement has ${settlement.grids.length} rows`);\n    console.log(` [TRANSIT DEBUG] Total grids in settlement: ${settlement.grids.flat().length}`);\n\n    const currentGrid = settlement.grids.flat().find((grid) => grid.gridId === currentGridId);\n\n    if (!currentGrid) {\n      console.error(\" Current grid not found in settlement.\");\n      console.error(` currentGridId type: ${typeof currentGridId}`);\n      console.error(` currentGridId value: ${currentGridId}`);\n      console.error(` Sample gridIds from settlement:`, settlement.grids.flat().slice(0, 5).map(g => ({\n        gridId: g.gridId,\n        type: typeof g.gridId,\n        match: g.gridId === currentGridId,\n        toString: g.gridId?.toString(),\n        stringMatch: g.gridId?.toString() === currentGridId.toString()\n      })));\n\n      updateStatus(105);\n      if (transitionFadeControl?.endTransition) {\n        transitionFadeControl.endTransition();\n      }\n      return;\n    }\n\n    console.log(` [TRANSIT DEBUG] Found current grid in settlement: ${currentGrid.gridId}, type: ${currentGrid.gridType}, gridCoord: ${currentGrid.gridCoord}`);\n\n      // 5) Decode the current gridCoord to get gRow/gCol\n    if (!currentGrid.gridCoord) {\n      console.error(\"No gridCoord found on current grid.\"); updateStatus(105); return; }\n\n    updateStatus(103); // \"Travelling ...\"\n\n    const { \n      frontierTier, frontierIndex, \n      setRow, setCol, gRow, gCol\n    } = decodeCoord(currentGrid.gridCoord); // Implement decodeCoord to match your system\n\n    // 6) Apply signpost offsets to sub-grid row/col\n    const [rowOffset, colOffset] = offsets[direction] || [0, 0];\n\n    let newGRow = gRow + rowOffset;\n    let newGCol = gCol + colOffset;\n    let newSetRow = setRow;\n    let newSetCol = setCol;\n\n    // 7) Check if crossing the local 8x8 sub-grid boundary\n    if (newGRow < 0) {\n      newGRow = 7;\n      newSetRow -= 1;\n    } else if (newGRow > 7) {\n      newGRow = 0;\n      newSetRow += 1;\n    }\n\n    if (newGCol < 0) {\n      newGCol = 7;\n      newSetCol -= 1;\n    } else if (newGCol > 7) {\n      newGCol = 0;\n      newSetCol += 1;\n    }\n\n    // 8) Verify we can still stay in bounds of the settlement array (0..7 for setRow/setCol)\n    if (newSetRow < 0 || newSetRow > 7 || newSetCol < 0 || newSetCol > 7) {\n      updateStatus(106); // \"Can't travel beyond frontier\"\n      return;\n    }\n\n    // 9) Fetch the new settlement if setRow/setCol changed\n    //    If your server has an endpoint like get-settlement-by-coords/:row/:col, do that:\n    const targetSettlementResponse = await axios.get(\n      `${API_BASE}/api/get-settlement-by-coords/${newSetRow}/${newSetCol}`\n    );\n    const targetSettlement = targetSettlementResponse.data;\n    if (!targetSettlement || !targetSettlement.grids) {\n      console.warn(\"Target settlement not found or invalid.\");\n      updateStatus(105);\n      return;\n    }\n \n    // 10) Find the sub-grid at newGRow/newGCol\n    const targetGrid = targetSettlement.grids[newGRow][newGCol];\n    console.log('targetGrid = ',targetGrid);\n    if (!targetGrid?.gridId) {\n      console.log(' [TRAVEL FAILED] No valid grid found - ending fade transition');\n      updateStatus(18);\n      \n      // End fade transition since travel failed\n      if (transitionFadeControl?.endTransition) {\n        transitionFadeControl.endTransition();\n      }\n      \n      return;\n    }\n\n    // 11) Get the entry position based on the direction traveled\n    // First, try to find the opposite signpost in the destination grid\n    let entryPosition;\n    const playerId = currentPlayer._id?.toString();\n    const gridId = currentPlayer.location?.g;\n    const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    const fromX = playerData?.position?.x ?? 0;\n    const fromY = playerData?.position?.y ?? 0;\n    console.log(\"Current player position:\", { x: fromX, y: fromY });\n    console.log(\"Direction:\", direction);\n\n    // Map of opposite directions\n    const oppositeDirections = {\n      NE: 'SW', SW: 'NE',\n      E: 'W', W: 'E',\n      SE: 'NW', NW: 'SE',\n      S: 'N', N: 'S'\n    };\n\n    const oppositeDirection = oppositeDirections[direction];\n    const oppositeSignpostType = `Signpost ${oppositeDirection}`;\n\n    // Try to fetch the opposite signpost position from the destination grid\n    let oppositeSignpostFound = false;\n    try {\n      const gridResourcesResponse = await axios.get(`${API_BASE}/api/load-grid/${targetGrid.gridId}`);\n      const gridResources = gridResourcesResponse.data.resources || [];\n\n      // Look for the opposite signpost in the destination grid\n      const oppositeSignpost = gridResources.find(res => res.type === oppositeSignpostType);\n\n      if (oppositeSignpost && oppositeSignpost.x !== undefined && oppositeSignpost.y !== undefined) {\n        // Apply directional offset so player spawns next to signpost, not on top of it\n        // The offset moves the player one tile away from the signpost in the appropriate direction\n        const signpostOffsets = {\n          'Signpost NE': { x: -1, y: 1 },\n          'Signpost E':  { x: -1, y: 0 },\n          'Signpost SE': { x: -1, y: -1 },\n          'Signpost S':  { x: 0,  y: -1 },\n          'Signpost SW': { x: 1,  y: -1 },\n          'Signpost W':  { x: 1,  y: 0 },\n          'Signpost NW': { x: 1,  y: 1 },\n          'Signpost N':  { x: 0,  y: 1 },\n        };\n        const offset = signpostOffsets[oppositeSignpostType] || { x: 0, y: 0 };\n\n        entryPosition = {\n          x: oppositeSignpost.x + offset.x,\n          y: oppositeSignpost.y + offset.y\n        };\n        oppositeSignpostFound = true;\n        console.log(` Found opposite signpost ${oppositeSignpostType} at (${oppositeSignpost.x}, ${oppositeSignpost.y}), applying offset (${offset.x}, ${offset.y}) -> entry position (${entryPosition.x}, ${entryPosition.y})`);\n      }\n    } catch (error) {\n      console.warn(\"Could not fetch opposite signpost position:\", error);\n    }\n\n    // If no opposite signpost found, use position-based logic\n    if (!oppositeSignpostFound) {\n      if ([\"E\", \"W\"].includes(direction)) {\n        // Preserve row (Y) when moving left/right\n        entryPosition = {\n          x: direction === \"E\" ? 0 : 63,\n          y: fromY\n        };\n        console.log(\"No opposite signpost found. Preserving row (Y) for E/W direction:\", entryPosition);\n      } else if ([\"N\", \"S\"].includes(direction)) {\n        // Preserve column (X) when moving up/down\n        entryPosition = {\n          x: fromX,\n          y: direction === \"N\" ? 63 : 0\n        };\n        console.log(\"No opposite signpost found. Preserving column (X) for N/S direction:\", entryPosition);\n      } else {\n        // Fallback to existing logic for diagonals and non-cardinal directions\n        entryPosition = getEntryPosition(direction);\n        console.log(\"No opposite signpost found. Using default entry position for diagonal:\", entryPosition);\n      }\n    }\n\n    // 12) Finally, update the player location\n    const newPlayerPosition = {\n      x: entryPosition.x,\n      y: entryPosition.y,\n      g: targetGrid.gridId,\n      s: targetSettlement._id,\n      f: frontierId,\n      gtype: targetGrid.gridType,\n      gridCoord: targetGrid.gridCoord,\n    };\n \n    await changePlayerLocation(\n      currentPlayer,\n      currentPlayer.location,   // fromLocation\n      newPlayerPosition,        // toLocation\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      TILE_SIZE,\n      closeAllPanels,\n      updateStatus,\n      bulkOperationContext,\n      masterResources,\n      strings,\n      masterTrophies,\n      transitionFadeControl\n    );\n\n    console.log(`Player moved to grid ID: ${targetGrid.gridId}`);\n  } catch (error) {\n    console.error(\"Error handling transit:\", error.message || error);\n    updateStatus(\"Error during travel.\");\n  }\n}\n\n// Example decode function (adjust to match your chosen gridCoord structure)\nfunction decodeCoord(coord) {\n  const str = coord.toString().padStart(8, '0');\n  return {\n    frontierTier:  parseInt(str.slice(0, 2), 10), // first 2 digits\n    frontierIndex: parseInt(str.slice(2, 4), 10), // next 2 digits\n    setRow:        parseInt(str.slice(4, 5), 10), // next 1 digit\n    setCol:        parseInt(str.slice(5, 6), 10), // next 1 digit\n    gRow:          parseInt(str.slice(6, 7), 10), // next 1 digit\n    gCol:          parseInt(str.slice(7, 8), 10), // last 1 digit\n  };\n}\n","/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),ca=require(\"scheduler\");function p(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var da=new Set,ea={};function fa(a,b){ha(a,b);ha(a+\"Capture\",b)}\nfunction ha(a,b){ea[a]=b;for(a=0;a<b.length;a++)da.add(b[a])}\nvar ia=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,la=\n{},ma={};function oa(a){if(ja.call(ma,a))return!0;if(ja.call(la,a))return!1;if(ka.test(a))return ma[a]=!0;la[a]=!0;return!1}function pa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction qa(a,b,c,d){if(null===b||\"undefined\"===typeof b||pa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var z={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){z[a]=new v(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];z[b]=new v(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){z[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){z[a]=new v(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){z[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){z[a]=new v(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){z[a]=new v(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){z[a]=new v(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){z[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(ra,\nsa);z[b]=new v(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)});\nz.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction ta(a,b,c,d){var e=z.hasOwnProperty(b)?z[b]:null;if(null!==e?0!==e.type:d||!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1])qa(b,c,e,d)&&(c=null),d||null===e?oa(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c)))}\nvar ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for(\"react.element\"),wa=Symbol.for(\"react.portal\"),ya=Symbol.for(\"react.fragment\"),za=Symbol.for(\"react.strict_mode\"),Aa=Symbol.for(\"react.profiler\"),Ba=Symbol.for(\"react.provider\"),Ca=Symbol.for(\"react.context\"),Da=Symbol.for(\"react.forward_ref\"),Ea=Symbol.for(\"react.suspense\"),Fa=Symbol.for(\"react.suspense_list\"),Ga=Symbol.for(\"react.memo\"),Ha=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");Symbol.for(\"react.debug_trace_mode\");\nvar Ia=Symbol.for(\"react.offscreen\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.cache\");Symbol.for(\"react.tracing_marker\");var Ja=Symbol.iterator;function Ka(a){if(null===a||\"object\"!==typeof a)return null;a=Ja&&a[Ja]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var A=Object.assign,La;function Ma(a){if(void 0===La)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);La=b&&b[1]||\"\"}return\"\\n\"+La+a}var Na=!1;\nfunction Oa(a,b){if(!a||Na)return\"\";Na=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(l){var d=l}Reflect.construct(a,[],b)}else{try{b.call()}catch(l){d=l}a.call(b.prototype)}else{try{throw Error();}catch(l){d=l}a()}}catch(l){if(l&&d&&\"string\"===typeof l.stack){for(var e=l.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h]){var k=\"\\n\"+e[g].replace(\" at new \",\" at \");a.displayName&&k.includes(\"<anonymous>\")&&(k=k.replace(\"<anonymous>\",a.displayName));return k}while(1<=g&&0<=h)}break}}}finally{Na=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Ma(a):\"\"}\nfunction Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma(\"Lazy\");case 13:return Ma(\"Suspense\");case 19:return Ma(\"SuspenseList\");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return\"\"}}\nfunction Qa(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ya:return\"Fragment\";case wa:return\"Portal\";case Aa:return\"Profiler\";case za:return\"StrictMode\";case Ea:return\"Suspense\";case Fa:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case Ca:return(a.displayName||\"Context\")+\".Consumer\";case Ba:return(a._context.displayName||\"Context\")+\".Provider\";case Da:var b=a.render;a=a.displayName;a||(a=b.displayName||\nb.name||\"\",a=\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");return a;case Ga:return b=a.displayName||null,null!==b?b:Qa(a.type)||\"Memo\";case Ha:b=a._payload;a=a._init;try{return Qa(a(b))}catch(c){}}return null}\nfunction Ra(a){var b=a.type;switch(a.tag){case 24:return\"Cache\";case 9:return(b.displayName||\"Context\")+\".Consumer\";case 10:return(b._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return a=b.render,a=a.displayName||a.name||\"\",b.displayName||(\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return b;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Qa(b);case 8:return b===za?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";\ncase 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(\"function\"===typeof b)return b.displayName||b.name||null;if(\"string\"===typeof b)return b}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"string\":case \"undefined\":return a;case \"object\":return a;default:return\"\"}}\nfunction Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function ab(a,b){b=b.checked;null!=b&&ta(a,\"checked\",b,!1)}\nfunction bb(a,b){ab(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?cb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&cb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction db(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction cb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var eb=Array.isArray;\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(p(91));return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(p(92));if(eb(c)){if(1<c.length)throw Error(p(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}function kb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}\nfunction lb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?kb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar mb,nb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(\"http://www.w3.org/2000/svg\"!==a.namespaceURI||\"innerHTML\"in a)a.innerHTML=b;else{mb=mb||document.createElement(\"div\");mb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction ob(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,\nzoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(pb).forEach(function(a){qb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);pb[b]=pb[a]})});function rb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||pb.hasOwnProperty(a)&&pb[a]?(\"\"+b).trim():b+\"px\"}\nfunction sb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=rb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ub(a,b){if(b){if(tb[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(p(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(p(60));if(\"object\"!==typeof b.dangerouslySetInnerHTML||!(\"__html\"in b.dangerouslySetInnerHTML))throw Error(p(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(p(62));}}\nfunction vb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var wb=null;function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(p(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(){}var Ib=!1;function Jb(a,b,c){if(Ib)return a(b,c);Ib=!0;try{return Gb(a,b,c)}finally{if(Ib=!1,null!==zb||null!==Ab)Hb(),Fb()}}\nfunction Kb(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(p(231,b,typeof c));return c}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,\"passive\",{get:function(){Lb=!0}});window.addEventListener(\"test\",Mb,Mb);window.removeEventListener(\"test\",Mb,Mb)}catch(a){Lb=!1}function Nb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0;Pb=a}};function Tb(a,b,c,d,e,f,g,h,k){Ob=!1;Pb=null;Nb.apply(Sb,arguments)}\nfunction Ub(a,b,c,d,e,f,g,h,k){Tb.apply(this,arguments);if(Ob){if(Ob){var l=Pb;Ob=!1;Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=l)}}function Vb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&4098)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Wb(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p(188));}\nfunction Yb(a){var b=a.alternate;if(!b){b=Vb(a);if(null===b)throw Error(p(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Xb(e),a;if(f===d)return Xb(e),b;f=f.sibling}throw Error(p(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(p(189));}}if(c.alternate!==d)throw Error(p(190));}if(3!==c.tag)throw Error(p(188));return c.stateNode.current===c?a:b}function Zb(a){a=Yb(a);return null!==a?$b(a):null}function $b(a){if(5===a.tag||6===a.tag)return a;for(a=a.child;null!==a;){var b=$b(a);if(null!==b)return b;a=a.sibling}return null}\nvar ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&\"function\"===typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,a,void 0,128===(a.current.flags&128))}catch(b){}}\nvar oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){a>>>=0;return 0===a?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;\nfunction tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;\ndefault:return a}}function uc(a,b){var c=a.pendingLanes;if(0===c)return 0;var d=0,e=a.suspendedLanes,f=a.pingedLanes,g=c&268435455;if(0!==g){var h=g&~e;0!==h?d=tc(h):(f&=g,0!==f&&(d=tc(f)))}else g=c&~e,0!==g?d=tc(g):0!==f&&(d=tc(f));if(0===d)return 0;if(0!==b&&b!==d&&0===(b&e)&&(e=d&-d,f=b&-b,e>=f||16===e&&0!==(f&4194240)))return b;0!==(d&4)&&(d|=c&16);b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-oc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction vc(a,b){switch(a){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}\nfunction wc(a,b){for(var c=a.suspendedLanes,d=a.pingedLanes,e=a.expirationTimes,f=a.pendingLanes;0<f;){var g=31-oc(f),h=1<<g,k=e[g];if(-1===k){if(0===(h&c)||0!==(h&d))e[g]=vc(h,b)}else k<=b&&(a.expiredLanes|=h);f&=~h}}function xc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function yc(){var a=rc;rc<<=1;0===(rc&4194240)&&(rc=64);return a}function zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction Ac(a,b,c){a.pendingLanes|=b;536870912!==b&&(a.suspendedLanes=0,a.pingedLanes=0);a=a.eventTimes;b=31-oc(b);a[b]=c}function Bc(a,b){var c=a.pendingLanes&~b;a.pendingLanes=b;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=b;a.mutableReadLanes&=b;a.entangledLanes&=b;b=a.entanglements;var d=a.eventTimes;for(a=a.expirationTimes;0<c;){var e=31-oc(c),f=1<<e;b[e]=0;d[e]=-1;a[e]=-1;c&=~f}}\nfunction Cc(a,b){var c=a.entangledLanes|=b;for(a=a.entanglements;c;){var d=31-oc(c),e=1<<d;e&b|a[d]&b&&(a[d]|=b);c&=~e}}var C=0;function Dc(a){a&=-a;return 1<a?4<a?0!==(a&268435455)?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction Sc(a,b){switch(a){case \"focusin\":case \"focusout\":Lc=null;break;case \"dragenter\":case \"dragleave\":Mc=null;break;case \"mouseover\":case \"mouseout\":Nc=null;break;case \"pointerover\":case \"pointerout\":Oc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Pc.delete(b.pointerId)}}\nfunction Tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a={blockedOn:b,domEventName:c,eventSystemFlags:d,nativeEvent:f,targetContainers:[e]},null!==b&&(b=Cb(b),null!==b&&Fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction Uc(a,b,c,d,e){switch(b){case \"focusin\":return Lc=Tc(Lc,a,b,c,d,e),!0;case \"dragenter\":return Mc=Tc(Mc,a,b,c,d,e),!0;case \"mouseover\":return Nc=Tc(Nc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Oc.set(f,Tc(Oc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Pc.set(f,Tc(Pc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Vc(a){var b=Wc(a.target);if(null!==b){var c=Vb(b);if(null!==c)if(b=c.tag,13===b){if(b=Wb(c),null!==b){a.blockedOn=b;Ic(a.priority,function(){Gc(c)});return}}else if(3===b&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction Xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=Yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null===c){c=a.nativeEvent;var d=new c.constructor(c.type,c);wb=d;c.target.dispatchEvent(d);wb=null}else return b=Cb(c),null!==b&&Fc(b),a.blockedOn=c,!1;b.shift()}return!0}function Zc(a,b,c){Xc(a)&&c.delete(b)}function $c(){Jc=!1;null!==Lc&&Xc(Lc)&&(Lc=null);null!==Mc&&Xc(Mc)&&(Mc=null);null!==Nc&&Xc(Nc)&&(Nc=null);Oc.forEach(Zc);Pc.forEach(Zc)}\nfunction ad(a,b){a.blockedOn===b&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}\nfunction bd(a){function b(b){return ad(b,a)}if(0<Kc.length){ad(Kc[0],a);for(var c=1;c<Kc.length;c++){var d=Kc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Lc&&ad(Lc,a);null!==Mc&&ad(Mc,a);null!==Nc&&ad(Nc,a);Oc.forEach(b);Pc.forEach(b);for(c=0;c<Qc.length;c++)d=Qc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Qc.length&&(c=Qc[0],null===c.blockedOn);)Vc(c),null===c.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;\nfunction ed(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=1,fd(a,b,c,d)}finally{C=e,cd.transition=f}}function gd(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=4,fd(a,b,c,d)}finally{C=e,cd.transition=f}}\nfunction fd(a,b,c,d){if(dd){var e=Yc(a,b,c,d);if(null===e)hd(a,b,d,id,c),Sc(a,d);else if(Uc(e,a,b,c,d))d.stopPropagation();else if(Sc(a,d),b&4&&-1<Rc.indexOf(a)){for(;null!==e;){var f=Cb(e);null!==f&&Ec(f);f=Yc(a,b,c,d);null===f&&hd(a,b,d,id,c);if(f===e)break;e=f}null!==e&&d.stopPropagation()}else hd(a,b,d,null,c)}}var id=null;\nfunction Yc(a,b,c,d){id=null;a=xb(d);a=Wc(a);if(null!==a)if(b=Vb(a),null===b)a=null;else if(c=b.tag,13===c){a=Wb(b);if(null!==a)return a;a=null}else if(3===c){if(b.stateNode.current.memoizedState.isDehydrated)return 3===b.tag?b.stateNode.containerInfo:null;a=null}else b!==a&&(a=null);id=a;return null}\nfunction jd(a){switch(a){case \"cancel\":case \"click\":case \"close\":case \"contextmenu\":case \"copy\":case \"cut\":case \"auxclick\":case \"dblclick\":case \"dragend\":case \"dragstart\":case \"drop\":case \"focusin\":case \"focusout\":case \"input\":case \"invalid\":case \"keydown\":case \"keypress\":case \"keyup\":case \"mousedown\":case \"mouseup\":case \"paste\":case \"pause\":case \"play\":case \"pointercancel\":case \"pointerdown\":case \"pointerup\":case \"ratechange\":case \"reset\":case \"resize\":case \"seeked\":case \"submit\":case \"touchcancel\":case \"touchend\":case \"touchstart\":case \"volumechange\":case \"change\":case \"selectionchange\":case \"textInput\":case \"compositionstart\":case \"compositionend\":case \"compositionupdate\":case \"beforeblur\":case \"afterblur\":case \"beforeinput\":case \"blur\":case \"fullscreenchange\":case \"focus\":case \"hashchange\":case \"popstate\":case \"select\":case \"selectstart\":return 1;case \"drag\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"mousemove\":case \"mouseout\":case \"mouseover\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"scroll\":case \"toggle\":case \"touchmove\":case \"wheel\":case \"mouseenter\":case \"mouseleave\":case \"pointerenter\":case \"pointerleave\":return 4;\ncase \"message\":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}\nfunction od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}A(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=A({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&\"CompositionEvent\"in window,be=null;ia&&\"documentMode\"in document&&(be=document.documentMode);var ce=ia&&\"TextEvent\"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(ia){var xe;if(ia){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));Jb(re,b)}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge;\nfunction Ie(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var e=c[d];if(!ja.call(b,e)||!He(a[e],b[e]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Ke(a,b){var c=Je(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Je(c)}}function Le(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Le(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Me(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nfunction Oe(a){var b=Me(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&c&&c.ownerDocument&&Le(c.ownerDocument.documentElement,c)){if(null!==d&&Ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(a=(b=c.ownerDocument||document)&&b.defaultView||window,a.getSelection){a=a.getSelection();var e=c.textContent.length,f=Math.min(d.start,e);d=void 0===d.end?f:Math.min(d.end,e);!a.extend&&f>d&&(e=d,d=f,f=e);e=Ke(c,f);var g=Ke(c,\nd);e&&g&&(1!==a.rangeCount||a.anchorNode!==e.node||a.anchorOffset!==e.offset||a.focusNode!==g.node||a.focusOffset!==g.offset)&&(b=b.createRange(),b.setStart(e.node,e.offset),a.removeAllRanges(),f>d?(a.addRange(b),a.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),a.addRange(b)))}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});\"function\"===typeof c.focus&&c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}\nvar Pe=ia&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nfunction Ve(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var We={animationend:Ve(\"Animation\",\"AnimationEnd\"),animationiteration:Ve(\"Animation\",\"AnimationIteration\"),animationstart:Ve(\"Animation\",\"AnimationStart\"),transitionend:Ve(\"Transition\",\"TransitionEnd\")},Xe={},Ye={};\nia&&(Ye=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),\"TransitionEvent\"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var b=We[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Ye)return Xe[a]=b[c];return a}var $e=Ze(\"animationend\"),af=Ze(\"animationiteration\"),bf=Ze(\"animationstart\"),cf=Ze(\"transitionend\"),df=new Map,ef=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");\nfunction ff(a,b){df.set(a,b);fa(b,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,\"on\"+kf)}ff($e,\"onAnimationEnd\");ff(af,\"onAnimationIteration\");ff(bf,\"onAnimationStart\");ff(\"dblclick\",\"onDoubleClick\");ff(\"focusin\",\"onFocus\");ff(\"focusout\",\"onBlur\");ff(cf,\"onTransitionEnd\");ha(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);ha(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ha(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);\nha(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);fa(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));fa(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));fa(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);fa(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));fa(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));\nfa(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var lf=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),mf=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(lf));\nfunction nf(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Ub(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a;}\nfunction D(a,b){var c=b[of];void 0===c&&(c=b[of]=new Set);var d=a+\"__bubble\";c.has(d)||(pf(b,a,2,!1),c.add(d))}function qf(a,b,c){var d=0;b&&(d|=4);pf(c,a,d,b)}var rf=\"_reactListening\"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0;da.forEach(function(b){\"selectionchange\"!==b&&(mf.has(b)||qf(b,!1,a),qf(b,!0,a))});var b=9===a.nodeType?a:a.ownerDocument;null===b||b[rf]||(b[rf]=!0,qf(\"selectionchange\",!1,b))}}\nfunction pf(a,b,c,d){switch(jd(b)){case 1:var e=ed;break;case 4:e=gd;break;default:e=fd}c=e.bind(null,b,c,a);e=void 0;!Lb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction hd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=Wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Jb(function(){var d=f,e=xb(c),g=[];\na:{var h=df.get(a);if(void 0!==h){var k=td,n=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":n=\"focus\";k=Fd;break;case \"focusout\":n=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case $e:case af:case bf:k=Hd;break;case cf:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var t=0!==(b&4),J=!t&&\"scroll\"===a,x=t?null!==h?h+\"Capture\":null:h;t=[];for(var w=d,u;null!==\nw;){u=w;var F=u.stateNode;5===u.tag&&null!==F&&(u=F,null!==x&&(F=Kb(w,x),null!=F&&t.push(tf(w,F,u))));if(J)break;w=w.return}0<t.length&&(h=new k(h,n,null,c,e),g.push({event:h,listeners:t}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&c!==wb&&(n=c.relatedTarget||c.fromElement)&&(Wc(n)||n[uf]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(n=c.relatedTarget||c.toElement,k=d,n=n?Wc(n):null,null!==\nn&&(J=Vb(n),n!==J||5!==n.tag&&6!==n.tag))n=null}else k=null,n=d;if(k!==n){t=Bd;F=\"onMouseLeave\";x=\"onMouseEnter\";w=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)t=Td,F=\"onPointerLeave\",x=\"onPointerEnter\",w=\"pointer\";J=null==k?h:ue(k);u=null==n?h:ue(n);h=new t(F,w+\"leave\",k,c,e);h.target=J;h.relatedTarget=u;F=null;Wc(e)===d&&(t=new t(x,w+\"enter\",n,c,e),t.target=u,t.relatedTarget=J,F=t);J=F;if(k&&n)b:{t=k;x=n;w=0;for(u=t;u;u=vf(u))w++;u=0;for(F=x;F;F=vf(F))u++;for(;0<w-u;)t=vf(t),w--;for(;0<u-w;)x=\nvf(x),u--;for(;w--;){if(t===x||null!==x&&t===x.alternate)break b;t=vf(t);x=vf(x)}t=null}else t=null;null!==k&&wf(g,h,k,t,!1);null!==n&&null!==J&&wf(g,J,n,t,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var na=ve;else if(me(h))if(we)na=Fe;else{na=De;var xa=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(na=Ee);if(na&&(na=na(a,d))){ne(g,na,c,e);break a}xa&&xa(a,h,d);\"focusout\"===a&&(xa=h._wrapperState)&&\nxa.controlled&&\"number\"===h.type&&cb(h,\"number\",h.value)}xa=d?ue(d):window;switch(a){case \"focusin\":if(me(xa)||\"true\"===xa.contentEditable)Qe=xa,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var $a;if(ae)b:{switch(a){case \"compositionstart\":var ba=\"onCompositionStart\";break b;case \"compositionend\":ba=\"onCompositionEnd\";\nbreak b;case \"compositionupdate\":ba=\"onCompositionUpdate\";break b}ba=void 0}else ie?ge(a,c)&&(ba=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(ba=\"onCompositionStart\");ba&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==ba?\"onCompositionEnd\"===ba&&ie&&($a=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),xa=oe(d,ba),0<xa.length&&(ba=new Ld(ba,a,null,c,e),g.push({event:ba,listeners:xa}),$a?ba.data=$a:($a=he(c),null!==$a&&(ba.data=$a))));if($a=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),\n0<d.length&&(e=new Ld(\"onBeforeInput\",\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=$a)}se(g,b)})}function tf(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Kb(a,c),null!=f&&d.unshift(tf(a,f,e)),f=Kb(a,b),null!=f&&d.push(tf(a,f,e)));a=a.return}return d}function vf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction wf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Kb(c,f),null!=k&&g.unshift(tf(c,k,h))):e||(k=Kb(c,f),null!=k&&g.push(tf(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}var xf=/\\r\\n?/g,yf=/\\u0000|\\uFFFD/g;function zf(a){return(\"string\"===typeof a?a:\"\"+a).replace(xf,\"\\n\").replace(yf,\"\")}function Af(a,b,c){b=zf(b);if(zf(a)!==b&&c)throw Error(p(425));}function Bf(){}\nvar Cf=null,Df=null;function Ef(a,b){return\"textarea\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}\nvar Ff=\"function\"===typeof setTimeout?setTimeout:void 0,Gf=\"function\"===typeof clearTimeout?clearTimeout:void 0,Hf=\"function\"===typeof Promise?Promise:void 0,Jf=\"function\"===typeof queueMicrotask?queueMicrotask:\"undefined\"!==typeof Hf?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a;})}\nfunction Kf(a,b){var c=b,d=0;do{var e=c.nextSibling;a.removeChild(c);if(e&&8===e.nodeType)if(c=e.data,\"/$\"===c){if(0===d){a.removeChild(e);bd(b);return}d--}else\"$\"!==c&&\"$?\"!==c&&\"$!\"!==c||d++;c=e}while(c);bd(b)}function Lf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break;if(8===b){b=a.data;if(\"$\"===b||\"$!\"===b||\"$?\"===b)break;if(\"/$\"===b)return null}}return a}\nfunction Mf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of=\"__reactFiber$\"+Nf,Pf=\"__reactProps$\"+Nf,uf=\"__reactContainer$\"+Nf,of=\"__reactEvents$\"+Nf,Qf=\"__reactListeners$\"+Nf,Rf=\"__reactHandles$\"+Nf;\nfunction Wc(a){var b=a[Of];if(b)return b;for(var c=a.parentNode;c;){if(b=c[uf]||c[Of]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Mf(a);null!==a;){if(c=a[Of])return c;a=Mf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[Of]||a[uf];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(p(33));}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}\nfunction E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,b){Tf++;Sf[Tf]=a.current;a.current=b}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,b){var c=a.type.contextTypes;if(!c)return Vf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}\nfunction Zf(a){a=a.childContextTypes;return null!==a&&void 0!==a}function $f(){E(Wf);E(H)}function ag(a,b,c){if(H.current!==Vf)throw Error(p(168));G(H,b);G(Wf,c)}function bg(a,b,c){var d=a.stateNode;b=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in b))throw Error(p(108,Ra(a)||\"Unknown\",e));return A({},c,d)}\nfunction cg(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf;Xf=H.current;G(H,a);G(Wf,Wf.current);return!0}function dg(a,b,c){var d=a.stateNode;if(!d)throw Error(p(169));c?(a=bg(a,b,Xf),d.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf);G(Wf,c)}var eg=null,fg=!1,gg=!1;function hg(a){null===eg?eg=[a]:eg.push(a)}function ig(a){fg=!0;hg(a)}\nfunction jg(){if(!gg&&null!==eg){gg=!0;var a=0,b=C;try{var c=eg;for(C=1;a<c.length;a++){var d=c[a];do d=d(!0);while(null!==d)}eg=null;fg=!1}catch(e){throw null!==eg&&(eg=eg.slice(a+1)),ac(fc,jg),e;}finally{C=b,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg=\"\";function tg(a,b){kg[lg++]=ng;kg[lg++]=mg;mg=a;ng=b}\nfunction ug(a,b,c){og[pg++]=rg;og[pg++]=sg;og[pg++]=qg;qg=a;var d=rg;a=sg;var e=32-oc(d)-1;d&=~(1<<e);c+=1;var f=32-oc(b)+e;if(30<f){var g=e-e%5;f=(d&(1<<g)-1).toString(32);d>>=g;e-=g;rg=1<<32-oc(b)+e|c<<e|d;sg=f+a}else rg=1<<f|c<<e|d,sg=a}function vg(a){null!==a.return&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;\nfunction Ag(a,b){var c=Bg(5,null,null,0);c.elementType=\"DELETED\";c.stateNode=b;c.return=a;b=a.deletions;null===b?(a.deletions=[c],a.flags|=16):b.push(c)}\nfunction Cg(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,xg=a,yg=Lf(b.firstChild),!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,xg=a,yg=null,!0):!1;case 13:return b=8!==b.nodeType?null:b,null!==b?(c=null!==qg?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:b,treeContext:c,retryLane:1073741824},c=Bg(18,null,null,0),c.stateNode=b,c.return=a,a.child=c,xg=a,yg=\nnull,!0):!1;default:return!1}}function Dg(a){return 0!==(a.mode&1)&&0===(a.flags&128)}function Eg(a){if(I){var b=yg;if(b){var c=b;if(!Cg(a,b)){if(Dg(a))throw Error(p(418));b=Lf(c.nextSibling);var d=xg;b&&Cg(a,b)?Ag(d,c):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p(418));a.flags=a.flags&-4097|2;I=!1;xg=a}}}function Fg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;xg=a}\nfunction Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var b;(b=3!==a.tag)&&!(b=5!==a.tag)&&(b=a.type,b=\"head\"!==b&&\"body\"!==b&&!Ef(a.type,a.memoizedProps));if(b&&(b=yg)){if(Dg(a))throw Hg(),Error(p(418));for(;b;)Ag(a,b),b=Lf(b.nextSibling)}Fg(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(p(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){yg=Lf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}yg=\nnull}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null;I=!1}function Jg(a){null===zg?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;\nfunction Lg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(p(309));var d=c.stateNode}if(!d)throw Error(p(147,a));var e=d,f=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===f)return b.ref;b=function(a){var b=e.refs;null===a?delete b[f]:b[f]=a};b._stringRef=f;return b}if(\"string\"!==typeof a)throw Error(p(284));if(!c._owner)throw Error(p(290,a));}return a}\nfunction Mg(a,b){a=Object.prototype.toString.call(b);throw Error(p(31,\"[object Object]\"===a?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":a));}function Ng(a){var b=a._init;return b(a._payload)}\nfunction Og(a){function b(b,c){if(a){var d=b.deletions;null===d?(b.deletions=[c],b.flags|=16):d.push(c)}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Pg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return b.flags|=1048576,c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags|=2,c):d;b.flags|=2;return c}function g(b){a&&\nnull===b.alternate&&(b.flags|=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Qg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){var f=c.type;if(f===ya)return m(a,b,c.props.children,d,c.key);if(null!==b&&(b.elementType===f||\"object\"===typeof f&&null!==f&&f.$$typeof===Ha&&Ng(f)===b.type))return d=e(b,c.props),d.ref=Lg(a,b,c),d.return=a,d;d=Rg(c.type,c.key,c.props,null,a.mode,d);d.ref=Lg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||\nb.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=Sg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Tg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b&&\"\"!==b||\"number\"===typeof b)return b=Qg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case va:return c=Rg(b.type,b.key,b.props,null,a.mode,c),\nc.ref=Lg(a,null,b),c.return=a,c;case wa:return b=Sg(b,a.mode,c),b.return=a,b;case Ha:var d=b._init;return q(a,d(b._payload),c)}if(eb(b)||Ka(b))return b=Tg(b,a.mode,c,null),b.return=a,b;Mg(a,b)}return null}function r(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c&&\"\"!==c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case va:return c.key===e?k(a,b,c,d):null;case wa:return c.key===e?l(a,b,c,d):null;case Ha:return e=c._init,r(a,\nb,e(c._payload),d)}if(eb(c)||Ka(c))return null!==e?null:m(a,b,c,d,null);Mg(a,c)}return null}function y(a,b,c,d,e){if(\"string\"===typeof d&&\"\"!==d||\"number\"===typeof d)return a=a.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case va:return a=a.get(null===d.key?c:d.key)||null,k(b,a,d,e);case wa:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e);case Ha:var f=d._init;return y(a,b,c,f(d._payload),e)}if(eb(d)||Ka(d))return a=a.get(c)||null,m(b,a,d,e,null);Mg(b,d)}return null}\nfunction n(e,g,h,k){for(var l=null,m=null,u=g,w=g=0,x=null;null!==u&&w<h.length;w++){u.index>w?(x=u,u=null):x=u.sibling;var n=r(e,u,h[w],k);if(null===n){null===u&&(u=x);break}a&&u&&null===n.alternate&&b(e,u);g=f(n,g,w);null===m?l=n:m.sibling=n;m=n;u=x}if(w===h.length)return c(e,u),I&&tg(e,w),l;if(null===u){for(;w<h.length;w++)u=q(e,h[w],k),null!==u&&(g=f(u,g,w),null===m?l=u:m.sibling=u,m=u);I&&tg(e,w);return l}for(u=d(e,u);w<h.length;w++)x=y(u,e,w,h[w],k),null!==x&&(a&&null!==x.alternate&&u.delete(null===\nx.key?w:x.key),g=f(x,g,w),null===m?l=x:m.sibling=x,m=x);a&&u.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function t(e,g,h,k){var l=Ka(h);if(\"function\"!==typeof l)throw Error(p(150));h=l.call(h);if(null==h)throw Error(p(151));for(var u=l=null,m=g,w=g=0,x=null,n=h.next();null!==m&&!n.done;w++,n=h.next()){m.index>w?(x=m,m=null):x=m.sibling;var t=r(e,m,n.value,k);if(null===t){null===m&&(m=x);break}a&&m&&null===t.alternate&&b(e,m);g=f(t,g,w);null===u?l=t:u.sibling=t;u=t;m=x}if(n.done)return c(e,\nm),I&&tg(e,w),l;if(null===m){for(;!n.done;w++,n=h.next())n=q(e,n.value,k),null!==n&&(g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);I&&tg(e,w);return l}for(m=d(e,m);!n.done;w++,n=h.next())n=y(m,e,w,n.value,k),null!==n&&(a&&null!==n.alternate&&m.delete(null===n.key?w:n.key),g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);a&&m.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function J(a,d,f,h){\"object\"===typeof f&&null!==f&&f.type===ya&&null===f.key&&(f=f.props.children);if(\"object\"===typeof f&&null!==f){switch(f.$$typeof){case va:a:{for(var k=\nf.key,l=d;null!==l;){if(l.key===k){k=f.type;if(k===ya){if(7===l.tag){c(a,l.sibling);d=e(l,f.props.children);d.return=a;a=d;break a}}else if(l.elementType===k||\"object\"===typeof k&&null!==k&&k.$$typeof===Ha&&Ng(k)===l.type){c(a,l.sibling);d=e(l,f.props);d.ref=Lg(a,l,f);d.return=a;a=d;break a}c(a,l);break}else b(a,l);l=l.sibling}f.type===ya?(d=Tg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Rg(f.type,f.key,f.props,null,a.mode,h),h.ref=Lg(a,d,f),h.return=a,a=h)}return g(a);case wa:a:{for(l=f.key;null!==\nd;){if(d.key===l)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=Sg(f,a.mode,h);d.return=a;a=d}return g(a);case Ha:return l=f._init,J(a,d,l(f._payload),h)}if(eb(f))return n(a,d,f,h);if(Ka(f))return t(a,d,f,h);Mg(a,f)}return\"string\"===typeof f&&\"\"!==f||\"number\"===typeof f?(f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):\n(c(a,d),d=Qg(f,a.mode,h),d.return=a,a=d),g(a)):c(a,d)}return J}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(a){var b=Wg.current;E(Wg);a._currentValue=b}function bh(a,b,c){for(;null!==a;){var d=a.alternate;(a.childLanes&b)!==b?(a.childLanes|=b,null!==d&&(d.childLanes|=b)):null!==d&&(d.childLanes&b)!==b&&(d.childLanes|=b);if(a===c)break;a=a.return}}\nfunction ch(a,b){Xg=a;Zg=Yg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(dh=!0),a.firstContext=null)}function eh(a){var b=a._currentValue;if(Zg!==a)if(a={context:a,memoizedValue:b,next:null},null===Yg){if(null===Xg)throw Error(p(308));Yg=a;Xg.dependencies={lanes:0,firstContext:a}}else Yg=Yg.next=a;return b}var fh=null;function gh(a){null===fh?fh=[a]:fh.push(a)}\nfunction hh(a,b,c,d){var e=b.interleaved;null===e?(c.next=c,gh(b)):(c.next=e.next,e.next=c);b.interleaved=c;return ih(a,d)}function ih(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}var jh=!1;function kh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}\nfunction lh(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mh(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}\nfunction nh(a,b,c){var d=a.updateQueue;if(null===d)return null;d=d.shared;if(0!==(K&2)){var e=d.pending;null===e?b.next=b:(b.next=e.next,e.next=b);d.pending=b;return ih(a,c)}e=d.interleaved;null===e?(b.next=b,gh(d)):(b.next=e.next,e.next=b);d.interleaved=b;return ih(a,c)}function oh(a,b,c){b=b.updateQueue;if(null!==b&&(b=b.shared,0!==(c&4194240))){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nfunction ph(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction qh(a,b,c,d){var e=a.updateQueue;jh=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var m=a.alternate;null!==m&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==g&&(null===h?m.firstBaseUpdate=l:h.next=l,m.lastBaseUpdate=k))}if(null!==f){var q=e.baseState;g=0;m=l=k=null;h=f;do{var r=h.lane,y=h.eventTime;if((d&r)===r){null!==m&&(m=m.next={eventTime:y,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,\nnext:null});a:{var n=a,t=h;r=b;y=c;switch(t.tag){case 1:n=t.payload;if(\"function\"===typeof n){q=n.call(y,q,r);break a}q=n;break a;case 3:n.flags=n.flags&-65537|128;case 0:n=t.payload;r=\"function\"===typeof n?n.call(y,q,r):n;if(null===r||void 0===r)break a;q=A({},q,r);break a;case 2:jh=!0}}null!==h.callback&&0!==h.lane&&(a.flags|=64,r=e.effects,null===r?e.effects=[h]:r.push(h))}else y={eventTime:y,lane:r,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===m?(l=m=y,k=q):m=m.next=y,g|=r;\nh=h.next;if(null===h)if(h=e.shared.pending,null===h)break;else r=h,h=r.next,r.next=null,e.lastBaseUpdate=r,e.shared.pending=null}while(1);null===m&&(k=q);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=m;b=e.shared.interleaved;if(null!==b){e=b;do g|=e.lane,e=e.next;while(e!==b)}else null===f&&(e.shared.lanes=0);rh|=g;a.lanes=g;a.memoizedState=q}}\nfunction sh(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(p(191,e));e.call(d)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(a){if(a===th)throw Error(p(174));return a}\nfunction yh(a,b){G(wh,b);G(vh,a);G(uh,th);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:lb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=lb(b,a)}E(uh);G(uh,b)}function zh(){E(uh);E(vh);E(wh)}function Ah(a){xh(wh.current);var b=xh(uh.current);var c=lb(b,a.type);b!==c&&(G(vh,a),G(uh,c))}function Bh(a){vh.current===a&&(E(uh),E(vh))}var L=Uf(0);\nfunction Ch(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&128))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var Dh=[];\nfunction Eh(){for(var a=0;a<Dh.length;a++)Dh[a]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321));}function Mh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Nh(a,b,c,d,e,f){Hh=f;M=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;Fh.current=null===a||null===a.memoizedState?Oh:Ph;a=c(d,e);if(Jh){f=0;do{Jh=!1;Kh=0;if(25<=f)throw Error(p(301));f+=1;O=N=null;b.updateQueue=null;Fh.current=Qh;a=c(d,e)}while(Jh)}Fh.current=Rh;b=null!==N&&null!==N.next;Hh=0;O=N=M=null;Ih=!1;if(b)throw Error(p(300));return a}function Sh(){var a=0!==Kh;Kh=0;return a}\nfunction Th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===O?M.memoizedState=O=a:O=O.next=a;return O}function Uh(){if(null===N){var a=M.alternate;a=null!==a?a.memoizedState:null}else a=N.next;var b=null===O?M.memoizedState:O.next;if(null!==b)O=b,N=a;else{if(null===a)throw Error(p(310));N=a;a={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null};null===O?M.memoizedState=O=a:O=O.next=a}return O}\nfunction Vh(a,b){return\"function\"===typeof b?b(a):b}\nfunction Wh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=N,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){f=e.next;d=d.baseState;var h=g=null,k=null,l=f;do{var m=l.lane;if((Hh&m)===m)null!==k&&(k=k.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),d=l.hasEagerState?l.eagerState:a(d,l.action);else{var q={lane:m,action:l.action,hasEagerState:l.hasEagerState,\neagerState:l.eagerState,next:null};null===k?(h=k=q,g=d):k=k.next=q;M.lanes|=m;rh|=m}l=l.next}while(null!==l&&l!==f);null===k?g=d:k.next=h;He(d,b.memoizedState)||(dh=!0);b.memoizedState=d;b.baseState=g;b.baseQueue=k;c.lastRenderedState=d}a=c.interleaved;if(null!==a){e=a;do f=e.lane,M.lanes|=f,rh|=f,e=e.next;while(e!==a)}else null===e&&(c.lanes=0);return[b.memoizedState,c.dispatch]}\nfunction Xh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(dh=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function Yh(){}\nfunction Zh(a,b){var c=M,d=Uh(),e=b(),f=!He(d.memoizedState,e);f&&(d.memoizedState=e,dh=!0);d=d.queue;$h(ai.bind(null,c,d,a),[a]);if(d.getSnapshot!==b||f||null!==O&&O.memoizedState.tag&1){c.flags|=2048;bi(9,ci.bind(null,c,d,e,b),void 0,null);if(null===Q)throw Error(p(349));0!==(Hh&30)||di(c,b,e)}return e}function di(a,b,c){a.flags|=16384;a={getSnapshot:b,value:c};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.stores=[a]):(c=b.stores,null===c?b.stores=[a]:c.push(a))}\nfunction ci(a,b,c,d){b.value=c;b.getSnapshot=d;ei(b)&&fi(a)}function ai(a,b,c){return c(function(){ei(b)&&fi(a)})}function ei(a){var b=a.getSnapshot;a=a.value;try{var c=b();return!He(a,c)}catch(d){return!0}}function fi(a){var b=ih(a,1);null!==b&&gi(b,a,1,-1)}\nfunction hi(a){var b=Th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:a};b.queue=a;a=a.dispatch=ii.bind(null,M,a);return[b.memoizedState,a]}\nfunction bi(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function ji(){return Uh().memoizedState}function ki(a,b,c,d){var e=Th();M.flags|=a;e.memoizedState=bi(1|b,c,void 0,void 0===d?null:d)}\nfunction li(a,b,c,d){var e=Uh();d=void 0===d?null:d;var f=void 0;if(null!==N){var g=N.memoizedState;f=g.destroy;if(null!==d&&Mh(d,g.deps)){e.memoizedState=bi(b,c,f,d);return}}M.flags|=a;e.memoizedState=bi(1|b,c,f,d)}function mi(a,b){return ki(8390656,8,a,b)}function $h(a,b){return li(2048,8,a,b)}function ni(a,b){return li(4,2,a,b)}function oi(a,b){return li(4,4,a,b)}\nfunction pi(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function qi(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return li(4,4,pi.bind(null,b,a),c)}function ri(){}function si(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction ti(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function ui(a,b,c){if(0===(Hh&21))return a.baseState&&(a.baseState=!1,dh=!0),a.memoizedState=c;He(c,b)||(c=yc(),M.lanes|=c,rh|=c,a.baseState=!0);return b}function vi(a,b){var c=C;C=0!==c&&4>c?c:4;a(!0);var d=Gh.transition;Gh.transition={};try{a(!1),b()}finally{C=c,Gh.transition=d}}function wi(){return Uh().memoizedState}\nfunction xi(a,b,c){var d=yi(a);c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,c);else if(c=hh(a,b,c,d),null!==c){var e=R();gi(c,a,d,e);Bi(c,b,d)}}\nfunction ii(a,b,c){var d=yi(a),e={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,e);else{var f=a.alternate;if(0===a.lanes&&(null===f||0===f.lanes)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.hasEagerState=!0;e.eagerState=h;if(He(h,g)){var k=b.interleaved;null===k?(e.next=e,gh(b)):(e.next=k.next,k.next=e);b.interleaved=e;return}}catch(l){}finally{}c=hh(a,b,e,d);null!==c&&(e=R(),gi(c,a,d,e),Bi(c,b,d))}}\nfunction zi(a){var b=a.alternate;return a===M||null!==b&&b===M}function Ai(a,b){Jh=Ih=!0;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}function Bi(a,b,c){if(0!==(c&4194240)){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nvar Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(a,b){Th().memoizedState=[a,void 0===b?null:b];return a},useContext:eh,useEffect:mi,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ki(4194308,\n4,pi.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ki(4194308,4,a,b)},useInsertionEffect:function(a,b){return ki(4,2,a,b)},useMemo:function(a,b){var c=Th();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=Th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};d.queue=a;a=a.dispatch=xi.bind(null,M,a);return[d.memoizedState,a]},useRef:function(a){var b=\nTh();a={current:a};return b.memoizedState=a},useState:hi,useDebugValue:ri,useDeferredValue:function(a){return Th().memoizedState=a},useTransition:function(){var a=hi(!1),b=a[0];a=vi.bind(null,a[1]);Th().memoizedState=a;return[b,a]},useMutableSource:function(){},useSyncExternalStore:function(a,b,c){var d=M,e=Th();if(I){if(void 0===c)throw Error(p(407));c=c()}else{c=b();if(null===Q)throw Error(p(349));0!==(Hh&30)||di(d,b,c)}e.memoizedState=c;var f={value:c,getSnapshot:b};e.queue=f;mi(ai.bind(null,d,\nf,a),[a]);d.flags|=2048;bi(9,ci.bind(null,d,f,c,b),void 0,null);return c},useId:function(){var a=Th(),b=Q.identifierPrefix;if(I){var c=sg;var d=rg;c=(d&~(1<<32-oc(d)-1)).toString(32)+c;b=\":\"+b+\"R\"+c;c=Kh++;0<c&&(b+=\"H\"+c.toString(32));b+=\":\"}else c=Lh++,b=\":\"+b+\"r\"+c.toString(32)+\":\";return a.memoizedState=b},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},\nuseDebugValue:ri,useDeferredValue:function(a){var b=Uh();return ui(b,N.memoizedState,a)},useTransition:function(){var a=Wh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(a){var b=Uh();return null===\nN?b.memoizedState=a:ui(b,N.memoizedState,a)},useTransition:function(){var a=Xh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(a,b){if(a&&a.defaultProps){b=A({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}function Di(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:A({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar Ei={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=R(),d=\nyi(a),e=mh(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=b);b=nh(a,e,d);null!==b&&(gi(b,a,d,c),oh(b,a,d))}};function Fi(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ie(c,d)||!Ie(e,f):!0}\nfunction Gi(a,b,c){var d=!1,e=Vf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=eh(f):(e=Zf(b)?Xf:H.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Yf(a,e):Vf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Ei;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Hi(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Ei.enqueueReplaceState(b,b.state,null)}\nfunction Ii(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs={};kh(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=eh(f):(f=Zf(b)?Xf:H.current,e.context=Yf(a,f));e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Di(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(b=e.state,\n\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Ei.enqueueReplaceState(e,e.state,null),qh(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4194308)}function Ji(a,b){try{var c=\"\",d=b;do c+=Pa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e,digest:null}}\nfunction Ki(a,b,c){return{value:a,source:null,stack:null!=c?c:null,digest:null!=b?b:null}}function Li(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Mi=\"function\"===typeof WeakMap?WeakMap:Map;function Ni(a,b,c){c=mh(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Oi||(Oi=!0,Pi=d);Li(a,b)};return c}\nfunction Qi(a,b,c){c=mh(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)};c.callback=function(){Li(a,b)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){Li(a,b);\"function\"!==typeof d&&(null===Ri?Ri=new Set([this]):Ri.add(this));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nfunction Si(a,b,c){var d=a.pingCache;if(null===d){d=a.pingCache=new Mi;var e=new Set;d.set(b,e)}else e=d.get(b),void 0===e&&(e=new Set,d.set(b,e));e.has(c)||(e.add(c),a=Ti.bind(null,a,b,c),b.then(a,a))}function Ui(a){do{var b;if(b=13===a.tag)b=a.memoizedState,b=null!==b?null!==b.dehydrated?!0:!1:!0;if(b)return a;a=a.return}while(null!==a);return null}\nfunction Vi(a,b,c,d,e){if(0===(a.mode&1))return a===b?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,1===c.tag&&(null===c.alternate?c.tag=17:(b=mh(-1,1),b.tag=2,nh(c,b,1))),c.lanes|=1),a;a.flags|=65536;a.lanes=e;return a}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(a,b,c,d){b.child=null===a?Vg(b,null,c,d):Ug(b,a.child,c,d)}\nfunction Yi(a,b,c,d,e){c=c.render;var f=b.ref;ch(b,e);d=Nh(a,b,c,d,f,e);c=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&c&&vg(b);b.flags|=1;Xi(a,b,d,e);return b.child}\nfunction $i(a,b,c,d,e){if(null===a){var f=c.type;if(\"function\"===typeof f&&!aj(f)&&void 0===f.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=f,bj(a,b,f,d,e);a=Rg(c.type,null,d,b,b.mode,e);a.ref=b.ref;a.return=b;return b.child=a}f=a.child;if(0===(a.lanes&e)){var g=f.memoizedProps;c=c.compare;c=null!==c?c:Ie;if(c(g,d)&&a.ref===b.ref)return Zi(a,b,e)}b.flags|=1;a=Pg(f,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction bj(a,b,c,d,e){if(null!==a){var f=a.memoizedProps;if(Ie(f,d)&&a.ref===b.ref)if(dh=!1,b.pendingProps=d=f,0!==(a.lanes&e))0!==(a.flags&131072)&&(dh=!0);else return b.lanes=a.lanes,Zi(a,b,e)}return cj(a,b,c,d,e)}\nfunction dj(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode)if(0===(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=c;else{if(0===(c&1073741824))return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a,cachePool:null,transitions:null},b.updateQueue=null,G(ej,fj),fj|=a,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null};d=null!==f?f.baseLanes:c;G(ej,fj);fj|=d}else null!==\nf?(d=f.baseLanes|c,b.memoizedState=null):d=c,G(ej,fj),fj|=d;Xi(a,b,e,c);return b.child}function gj(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=512,b.flags|=2097152}function cj(a,b,c,d,e){var f=Zf(c)?Xf:H.current;f=Yf(b,f);ch(b,e);c=Nh(a,b,c,d,f,e);d=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&d&&vg(b);b.flags|=1;Xi(a,b,c,e);return b.child}\nfunction hj(a,b,c,d,e){if(Zf(c)){var f=!0;cg(b)}else f=!1;ch(b,e);if(null===b.stateNode)ij(a,b),Gi(b,c,d),Ii(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=eh(l):(l=Zf(c)?Xf:H.current,l=Yf(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||\n(h!==d||k!==l)&&Hi(b,g,d,l);jh=!1;var r=b.memoizedState;g.state=r;qh(b,d,g,e);k=b.memoizedState;h!==d||r!==k||Wf.current||jh?(\"function\"===typeof m&&(Di(b,c,m,d),k=b.memoizedState),(h=jh||Fi(b,c,h,d,r,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.flags|=4194308)):\n(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),d=!1)}else{g=b.stateNode;lh(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:Ci(b.type,h);g.props=l;q=b.pendingProps;r=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=eh(k):(k=Zf(c)?Xf:H.current,k=Yf(b,k));var y=c.getDerivedStateFromProps;(m=\"function\"===typeof y||\"function\"===typeof g.getSnapshotBeforeUpdate)||\n\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==q||r!==k)&&Hi(b,g,d,k);jh=!1;r=b.memoizedState;g.state=r;qh(b,d,g,e);var n=b.memoizedState;h!==q||r!==n||Wf.current||jh?(\"function\"===typeof y&&(Di(b,c,y,d),n=b.memoizedState),(l=jh||Fi(b,c,l,d,r,n,k)||!1)?(m||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,n,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&\ng.UNSAFE_componentWillUpdate(d,n,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=1024)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),b.memoizedProps=d,b.memoizedState=n),g.props=d,g.state=n,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===\na.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),d=!1)}return jj(a,b,c,d,f,e)}\nfunction jj(a,b,c,d,e,f){gj(a,b);var g=0!==(b.flags&128);if(!d&&!g)return e&&dg(b,c,!1),Zi(a,b,f);d=b.stateNode;Wi.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Ug(b,a.child,null,f),b.child=Ug(b,null,h,f)):Xi(a,b,h,f);b.memoizedState=d.state;e&&dg(b,c,!0);return b.child}function kj(a){var b=a.stateNode;b.pendingContext?ag(a,b.pendingContext,b.pendingContext!==b.context):b.context&&ag(a,b.context,!1);yh(a,b.containerInfo)}\nfunction lj(a,b,c,d,e){Ig();Jg(e);b.flags|=256;Xi(a,b,c,d);return b.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(a){return{baseLanes:a,cachePool:null,transitions:null}}\nfunction oj(a,b,c){var d=b.pendingProps,e=L.current,f=!1,g=0!==(b.flags&128),h;(h=g)||(h=null!==a&&null===a.memoizedState?!1:0!==(e&2));if(h)f=!0,b.flags&=-129;else if(null===a||null!==a.memoizedState)e|=1;G(L,e&1);if(null===a){Eg(b);a=b.memoizedState;if(null!==a&&(a=a.dehydrated,null!==a))return 0===(b.mode&1)?b.lanes=1:\"$!\"===a.data?b.lanes=8:b.lanes=1073741824,null;g=d.children;a=d.fallback;return f?(d=b.mode,f=b.child,g={mode:\"hidden\",children:g},0===(d&1)&&null!==f?(f.childLanes=0,f.pendingProps=\ng):f=pj(g,d,0,null),a=Tg(a,d,c,null),f.return=b,a.return=b,f.sibling=a,b.child=f,b.child.memoizedState=nj(c),b.memoizedState=mj,a):qj(b,g)}e=a.memoizedState;if(null!==e&&(h=e.dehydrated,null!==h))return rj(a,b,g,d,h,e,c);if(f){f=d.fallback;g=b.mode;e=a.child;h=e.sibling;var k={mode:\"hidden\",children:d.children};0===(g&1)&&b.child!==e?(d=b.child,d.childLanes=0,d.pendingProps=k,b.deletions=null):(d=Pg(e,k),d.subtreeFlags=e.subtreeFlags&14680064);null!==h?f=Pg(h,f):(f=Tg(f,g,c,null),f.flags|=2);f.return=\nb;d.return=b;d.sibling=f;b.child=d;d=f;f=b.child;g=a.child.memoizedState;g=null===g?nj(c):{baseLanes:g.baseLanes|c,cachePool:null,transitions:g.transitions};f.memoizedState=g;f.childLanes=a.childLanes&~c;b.memoizedState=mj;return d}f=a.child;a=f.sibling;d=Pg(f,{mode:\"visible\",children:d.children});0===(b.mode&1)&&(d.lanes=c);d.return=b;d.sibling=null;null!==a&&(c=b.deletions,null===c?(b.deletions=[a],b.flags|=16):c.push(a));b.child=d;b.memoizedState=null;return d}\nfunction qj(a,b){b=pj({mode:\"visible\",children:b},a.mode,0,null);b.return=a;return a.child=b}function sj(a,b,c,d){null!==d&&Jg(d);Ug(b,a.child,null,c);a=qj(b,b.pendingProps.children);a.flags|=2;b.memoizedState=null;return a}\nfunction rj(a,b,c,d,e,f,g){if(c){if(b.flags&256)return b.flags&=-257,d=Ki(Error(p(422))),sj(a,b,g,d);if(null!==b.memoizedState)return b.child=a.child,b.flags|=128,null;f=d.fallback;e=b.mode;d=pj({mode:\"visible\",children:d.children},e,0,null);f=Tg(f,e,g,null);f.flags|=2;d.return=b;f.return=b;d.sibling=f;b.child=d;0!==(b.mode&1)&&Ug(b,a.child,null,g);b.child.memoizedState=nj(g);b.memoizedState=mj;return f}if(0===(b.mode&1))return sj(a,b,g,null);if(\"$!\"===e.data){d=e.nextSibling&&e.nextSibling.dataset;\nif(d)var h=d.dgst;d=h;f=Error(p(419));d=Ki(f,d,void 0);return sj(a,b,g,d)}h=0!==(g&a.childLanes);if(dh||h){d=Q;if(null!==d){switch(g&-g){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=0!==(e&(d.suspendedLanes|g))?0:e;\n0!==e&&e!==f.retryLane&&(f.retryLane=e,ih(a,e),gi(d,a,e,-1))}tj();d=Ki(Error(p(421)));return sj(a,b,g,d)}if(\"$?\"===e.data)return b.flags|=128,b.child=a.child,b=uj.bind(null,a),e._reactRetry=b,null;a=f.treeContext;yg=Lf(e.nextSibling);xg=b;I=!0;zg=null;null!==a&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=b);b=qj(b,d.children);b.flags|=4096;return b}function vj(a,b,c){a.lanes|=b;var d=a.alternate;null!==d&&(d.lanes|=b);bh(a.return,b,c)}\nfunction wj(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e}:(f.isBackwards=b,f.rendering=null,f.renderingStartTime=0,f.last=d,f.tail=c,f.tailMode=e)}\nfunction xj(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;Xi(a,b,d.children,c);d=L.current;if(0!==(d&2))d=d&1|2,b.flags|=128;else{if(null!==a&&0!==(a.flags&128))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&vj(a,c,b);else if(19===a.tag)vj(a,c,b);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}G(L,d);if(0===(b.mode&1))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Ch(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);wj(b,!1,e,c,f);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Ch(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}wj(b,!0,c,null,f);break;case \"together\":wj(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}\nfunction ij(a,b){0===(b.mode&1)&&null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2)}function Zi(a,b,c){null!==a&&(b.dependencies=a.dependencies);rh|=b.lanes;if(0===(c&b.childLanes))return null;if(null!==a&&b.child!==a.child)throw Error(p(153));if(null!==b.child){a=b.child;c=Pg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Pg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}\nfunction yj(a,b,c){switch(b.tag){case 3:kj(b);Ig();break;case 5:Ah(b);break;case 1:Zf(b.type)&&cg(b);break;case 4:yh(b,b.stateNode.containerInfo);break;case 10:var d=b.type._context,e=b.memoizedProps.value;G(Wg,d._currentValue);d._currentValue=e;break;case 13:d=b.memoizedState;if(null!==d){if(null!==d.dehydrated)return G(L,L.current&1),b.flags|=128,null;if(0!==(c&b.child.childLanes))return oj(a,b,c);G(L,L.current&1);a=Zi(a,b,c);return null!==a?a.sibling:null}G(L,L.current&1);break;case 19:d=0!==(c&\nb.childLanes);if(0!==(a.flags&128)){if(d)return xj(a,b,c);b.flags|=128}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);G(L,L.current);if(d)break;else return null;case 22:case 23:return b.lanes=0,dj(a,b,c)}return Zi(a,b,c)}var zj,Aj,Bj,Cj;\nzj=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Aj=function(){};\nBj=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;xh(uh.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"select\":e=A({},e,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=Bf)}ub(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===l){var h=e[l];for(g in h)h.hasOwnProperty(g)&&\n(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ea.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,\nc)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ea.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&D(\"scroll\",a),f||h===k||(f=[])):(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",c);var l=f;if(b.updateQueue=l)b.flags|=4}};Cj=function(a,b,c,d){c!==d&&(b.flags|=4)};\nfunction Dj(a,b){if(!I)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction S(a){var b=null!==a.alternate&&a.alternate.child===a.child,c=0,d=0;if(b)for(var e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags&14680064,d|=e.flags&14680064,e.return=a,e=e.sibling;else for(e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags,d|=e.flags,e.return=a,e=e.sibling;a.subtreeFlags|=d;a.childLanes=c;return b}\nfunction Ej(a,b,c){var d=b.pendingProps;wg(b);switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(b),null;case 1:return Zf(b.type)&&$f(),S(b),null;case 3:d=b.stateNode;zh();E(Wf);E(H);Eh();d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)Gg(b)?b.flags|=4:null===a||a.memoizedState.isDehydrated&&0===(b.flags&256)||(b.flags|=1024,null!==zg&&(Fj(zg),zg=null));Aj(a,b);S(b);return null;case 5:Bh(b);var e=xh(wh.current);\nc=b.type;if(null!==a&&null!=b.stateNode)Bj(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!d){if(null===b.stateNode)throw Error(p(166));S(b);return null}a=xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[Of]=b;d[Pf]=f;a=0!==(b.mode&1);switch(c){case \"dialog\":D(\"cancel\",d);D(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",d);break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],d);break;case \"source\":D(\"error\",d);break;case \"img\":case \"image\":case \"link\":D(\"error\",\nd);D(\"load\",d);break;case \"details\":D(\"toggle\",d);break;case \"input\":Za(d,f);D(\"invalid\",d);break;case \"select\":d._wrapperState={wasMultiple:!!f.multiple};D(\"invalid\",d);break;case \"textarea\":hb(d,f),D(\"invalid\",d)}ub(c,f);e=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,h,a),e=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,\nh,a),e=[\"children\",\"\"+h]):ea.hasOwnProperty(g)&&null!=h&&\"onScroll\"===g&&D(\"scroll\",d)}switch(c){case \"input\":Va(d);db(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=Bf)}d=e;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;\"http://www.w3.org/1999/xhtml\"===a&&(a=kb(c));\"http://www.w3.org/1999/xhtml\"===a?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\n\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[Of]=b;a[Pf]=d;zj(a,b,!1,!1);b.stateNode=a;a:{g=vb(c,d);switch(c){case \"dialog\":D(\"cancel\",a);D(\"close\",a);e=d;break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],a);e=d;break;case \"source\":D(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":D(\"error\",\na);D(\"load\",a);e=d;break;case \"details\":D(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);D(\"invalid\",a);break;case \"option\":e=d;break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=A({},d,{value:void 0});D(\"invalid\",a);break;case \"textarea\":hb(a,d);e=gb(a,d);D(\"invalid\",a);break;default:e=d}ub(c,e);h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?sb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&nb(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==\nc||\"\"!==k)&&ob(a,k):\"number\"===typeof k&&ob(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ea.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&D(\"scroll\",a):null!=k&&ta(a,f,k,g))}switch(c){case \"input\":Va(a);db(a,d,!1);break;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,\n!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=Bf)}switch(c){case \"button\":case \"input\":case \"select\":case \"textarea\":d=!!d.autoFocus;break a;case \"img\":d=!0;break a;default:d=!1}}d&&(b.flags|=4)}null!==b.ref&&(b.flags|=512,b.flags|=2097152)}S(b);return null;case 6:if(a&&null!=b.stateNode)Cj(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(p(166));c=xh(wh.current);xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.memoizedProps;d[Of]=b;if(f=d.nodeValue!==c)if(a=\nxg,null!==a)switch(a.tag){case 3:Af(d.nodeValue,c,0!==(a.mode&1));break;case 5:!0!==a.memoizedProps.suppressHydrationWarning&&Af(d.nodeValue,c,0!==(a.mode&1))}f&&(b.flags|=4)}else d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[Of]=b,b.stateNode=d}S(b);return null;case 13:E(L);d=b.memoizedState;if(null===a||null!==a.memoizedState&&null!==a.memoizedState.dehydrated){if(I&&null!==yg&&0!==(b.mode&1)&&0===(b.flags&128))Hg(),Ig(),b.flags|=98560,f=!1;else if(f=Gg(b),null!==d&&null!==d.dehydrated){if(null===\na){if(!f)throw Error(p(318));f=b.memoizedState;f=null!==f?f.dehydrated:null;if(!f)throw Error(p(317));f[Of]=b}else Ig(),0===(b.flags&128)&&(b.memoizedState=null),b.flags|=4;S(b);f=!1}else null!==zg&&(Fj(zg),zg=null),f=!0;if(!f)return b.flags&65536?b:null}if(0!==(b.flags&128))return b.lanes=c,b;d=null!==d;d!==(null!==a&&null!==a.memoizedState)&&d&&(b.child.flags|=8192,0!==(b.mode&1)&&(null===a||0!==(L.current&1)?0===T&&(T=3):tj()));null!==b.updateQueue&&(b.flags|=4);S(b);return null;case 4:return zh(),\nAj(a,b),null===a&&sf(b.stateNode.containerInfo),S(b),null;case 10:return ah(b.type._context),S(b),null;case 17:return Zf(b.type)&&$f(),S(b),null;case 19:E(L);f=b.memoizedState;if(null===f)return S(b),null;d=0!==(b.flags&128);g=f.rendering;if(null===g)if(d)Dj(f,!1);else{if(0!==T||null!==a&&0!==(a.flags&128))for(a=b.child;null!==a;){g=Ch(a);if(null!==g){b.flags|=128;Dj(f,!1);d=g.updateQueue;null!==d&&(b.updateQueue=d,b.flags|=4);b.subtreeFlags=0;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=14680066,\ng=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,f.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;G(L,L.current&1|2);return b.child}a=\na.sibling}null!==f.tail&&B()>Gj&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304)}else{if(!d)if(a=Ch(g),null!==a){if(b.flags|=128,d=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Dj(f,!0),null===f.tail&&\"hidden\"===f.tailMode&&!g.alternate&&!I)return S(b),null}else 2*B()-f.renderingStartTime>Gj&&1073741824!==c&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304);f.isBackwards?(g.sibling=b.child,b.child=g):(c=f.last,null!==c?c.sibling=g:b.child=g,f.last=g)}if(null!==f.tail)return b=f.tail,f.rendering=\nb,f.tail=b.sibling,f.renderingStartTime=B(),b.sibling=null,c=L.current,G(L,d?c&1|2:c&1),b;S(b);return null;case 22:case 23:return Hj(),d=null!==b.memoizedState,null!==a&&null!==a.memoizedState!==d&&(b.flags|=8192),d&&0!==(b.mode&1)?0!==(fj&1073741824)&&(S(b),b.subtreeFlags&6&&(b.flags|=8192)):S(b),null;case 24:return null;case 25:return null}throw Error(p(156,b.tag));}\nfunction Ij(a,b){wg(b);switch(b.tag){case 1:return Zf(b.type)&&$f(),a=b.flags,a&65536?(b.flags=a&-65537|128,b):null;case 3:return zh(),E(Wf),E(H),Eh(),a=b.flags,0!==(a&65536)&&0===(a&128)?(b.flags=a&-65537|128,b):null;case 5:return Bh(b),null;case 13:E(L);a=b.memoizedState;if(null!==a&&null!==a.dehydrated){if(null===b.alternate)throw Error(p(340));Ig()}a=b.flags;return a&65536?(b.flags=a&-65537|128,b):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(b.type._context),null;case 22:case 23:return Hj(),\nnull;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=\"function\"===typeof WeakSet?WeakSet:Set,V=null;function Lj(a,b){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(d){W(a,b,d)}else c.current=null}function Mj(a,b,c){try{c()}catch(d){W(a,b,d)}}var Nj=!1;\nfunction Oj(a,b){Cf=dd;a=Me();if(Ne(a)){if(\"selectionStart\"in a)var c={start:a.selectionStart,end:a.selectionEnd};else a:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&0!==d.rangeCount){c=d.anchorNode;var e=d.anchorOffset,f=d.focusNode;d=d.focusOffset;try{c.nodeType,f.nodeType}catch(F){c=null;break a}var g=0,h=-1,k=-1,l=0,m=0,q=a,r=null;b:for(;;){for(var y;;){q!==c||0!==e&&3!==q.nodeType||(h=g+e);q!==f||0!==d&&3!==q.nodeType||(k=g+d);3===q.nodeType&&(g+=\nq.nodeValue.length);if(null===(y=q.firstChild))break;r=q;q=y}for(;;){if(q===a)break b;r===c&&++l===e&&(h=g);r===f&&++m===d&&(k=g);if(null!==(y=q.nextSibling))break;q=r;r=q.parentNode}q=y}c=-1===h||-1===k?null:{start:h,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;Df={focusedElem:a,selectionRange:c};dd=!1;for(V=b;null!==V;)if(b=V,a=b.child,0!==(b.subtreeFlags&1028)&&null!==a)a.return=b,V=a;else for(;null!==V;){b=V;try{var n=b.alternate;if(0!==(b.flags&1024))switch(b.tag){case 0:case 11:case 15:break;\ncase 1:if(null!==n){var t=n.memoizedProps,J=n.memoizedState,x=b.stateNode,w=x.getSnapshotBeforeUpdate(b.elementType===b.type?t:Ci(b.type,t),J);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var u=b.stateNode.containerInfo;1===u.nodeType?u.textContent=\"\":9===u.nodeType&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163));}}catch(F){W(b,b.return,F)}a=b.sibling;if(null!==a){a.return=b.return;V=a;break}V=b.return}n=Nj;Nj=!1;return n}\nfunction Pj(a,b,c){var d=b.updateQueue;d=null!==d?d.lastEffect:null;if(null!==d){var e=d=d.next;do{if((e.tag&a)===a){var f=e.destroy;e.destroy=void 0;void 0!==f&&Mj(b,c,f)}e=e.next}while(e!==d)}}function Qj(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function Rj(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=c;break;default:a=c}\"function\"===typeof b?b(a):b.current=a}}\nfunction Sj(a){var b=a.alternate;null!==b&&(a.alternate=null,Sj(b));a.child=null;a.deletions=null;a.sibling=null;5===a.tag&&(b=a.stateNode,null!==b&&(delete b[Of],delete b[Pf],delete b[of],delete b[Qf],delete b[Rf]));a.stateNode=null;a.return=null;a.dependencies=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.stateNode=null;a.updateQueue=null}function Tj(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Uj(a){a:for(;;){for(;null===a.sibling;){if(null===a.return||Tj(a.return))return null;a=a.return}a.sibling.return=a.return;for(a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(a.flags&2)continue a;if(null===a.child||4===a.tag)continue a;else a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}\nfunction Vj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=Bf));else if(4!==d&&(a=a.child,null!==a))for(Vj(a,b,c),a=a.sibling;null!==a;)Vj(a,b,c),a=a.sibling}\nfunction Wj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Wj(a,b,c),a=a.sibling;null!==a;)Wj(a,b,c),a=a.sibling}var X=null,Xj=!1;function Yj(a,b,c){for(c=c.child;null!==c;)Zj(a,b,c),c=c.sibling}\nfunction Zj(a,b,c){if(lc&&\"function\"===typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,c)}catch(h){}switch(c.tag){case 5:U||Lj(c,b);case 6:var d=X,e=Xj;X=null;Yj(a,b,c);X=d;Xj=e;null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):X.removeChild(c.stateNode));break;case 18:null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?Kf(a.parentNode,c):1===a.nodeType&&Kf(a,c),bd(a)):Kf(X,c.stateNode));break;case 4:d=X;e=Xj;X=c.stateNode.containerInfo;Xj=!0;\nYj(a,b,c);X=d;Xj=e;break;case 0:case 11:case 14:case 15:if(!U&&(d=c.updateQueue,null!==d&&(d=d.lastEffect,null!==d))){e=d=d.next;do{var f=e,g=f.destroy;f=f.tag;void 0!==g&&(0!==(f&2)?Mj(c,b,g):0!==(f&4)&&Mj(c,b,g));e=e.next}while(e!==d)}Yj(a,b,c);break;case 1:if(!U&&(Lj(c,b),d=c.stateNode,\"function\"===typeof d.componentWillUnmount))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(h){W(c,b,h)}Yj(a,b,c);break;case 21:Yj(a,b,c);break;case 22:c.mode&1?(U=(d=U)||null!==\nc.memoizedState,Yj(a,b,c),U=d):Yj(a,b,c);break;default:Yj(a,b,c)}}function ak(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Kj);b.forEach(function(b){var d=bk.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction ck(a,b){var c=b.deletions;if(null!==c)for(var d=0;d<c.length;d++){var e=c[d];try{var f=a,g=b,h=g;a:for(;null!==h;){switch(h.tag){case 5:X=h.stateNode;Xj=!1;break a;case 3:X=h.stateNode.containerInfo;Xj=!0;break a;case 4:X=h.stateNode.containerInfo;Xj=!0;break a}h=h.return}if(null===X)throw Error(p(160));Zj(f,g,e);X=null;Xj=!1;var k=e.alternate;null!==k&&(k.return=null);e.return=null}catch(l){W(e,b,l)}}if(b.subtreeFlags&12854)for(b=b.child;null!==b;)dk(b,a),b=b.sibling}\nfunction dk(a,b){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ck(b,a);ek(a);if(d&4){try{Pj(3,a,a.return),Qj(3,a)}catch(t){W(a,a.return,t)}try{Pj(5,a,a.return)}catch(t){W(a,a.return,t)}}break;case 1:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);break;case 5:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);if(a.flags&32){var e=a.stateNode;try{ob(e,\"\")}catch(t){W(a,a.return,t)}}if(d&4&&(e=a.stateNode,null!=e)){var f=a.memoizedProps,g=null!==c?c.memoizedProps:f,h=a.type,k=a.updateQueue;\na.updateQueue=null;if(null!==k)try{\"input\"===h&&\"radio\"===f.type&&null!=f.name&&ab(e,f);vb(h,g);var l=vb(h,f);for(g=0;g<k.length;g+=2){var m=k[g],q=k[g+1];\"style\"===m?sb(e,q):\"dangerouslySetInnerHTML\"===m?nb(e,q):\"children\"===m?ob(e,q):ta(e,m,q,l)}switch(h){case \"input\":bb(e,f);break;case \"textarea\":ib(e,f);break;case \"select\":var r=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!f.multiple;var y=f.value;null!=y?fb(e,!!f.multiple,y,!1):r!==!!f.multiple&&(null!=f.defaultValue?fb(e,!!f.multiple,\nf.defaultValue,!0):fb(e,!!f.multiple,f.multiple?[]:\"\",!1))}e[Pf]=f}catch(t){W(a,a.return,t)}}break;case 6:ck(b,a);ek(a);if(d&4){if(null===a.stateNode)throw Error(p(162));e=a.stateNode;f=a.memoizedProps;try{e.nodeValue=f}catch(t){W(a,a.return,t)}}break;case 3:ck(b,a);ek(a);if(d&4&&null!==c&&c.memoizedState.isDehydrated)try{bd(b.containerInfo)}catch(t){W(a,a.return,t)}break;case 4:ck(b,a);ek(a);break;case 13:ck(b,a);ek(a);e=a.child;e.flags&8192&&(f=null!==e.memoizedState,e.stateNode.isHidden=f,!f||\nnull!==e.alternate&&null!==e.alternate.memoizedState||(fk=B()));d&4&&ak(a);break;case 22:m=null!==c&&null!==c.memoizedState;a.mode&1?(U=(l=U)||m,ck(b,a),U=l):ck(b,a);ek(a);if(d&8192){l=null!==a.memoizedState;if((a.stateNode.isHidden=l)&&!m&&0!==(a.mode&1))for(V=a,m=a.child;null!==m;){for(q=V=m;null!==V;){r=V;y=r.child;switch(r.tag){case 0:case 11:case 14:case 15:Pj(4,r,r.return);break;case 1:Lj(r,r.return);var n=r.stateNode;if(\"function\"===typeof n.componentWillUnmount){d=r;c=r.return;try{b=d,n.props=\nb.memoizedProps,n.state=b.memoizedState,n.componentWillUnmount()}catch(t){W(d,c,t)}}break;case 5:Lj(r,r.return);break;case 22:if(null!==r.memoizedState){gk(q);continue}}null!==y?(y.return=r,V=y):gk(q)}m=m.sibling}a:for(m=null,q=a;;){if(5===q.tag){if(null===m){m=q;try{e=q.stateNode,l?(f=e.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(h=q.stateNode,k=q.memoizedProps.style,g=void 0!==k&&null!==k&&k.hasOwnProperty(\"display\")?k.display:null,h.style.display=\nrb(\"display\",g))}catch(t){W(a,a.return,t)}}}else if(6===q.tag){if(null===m)try{q.stateNode.nodeValue=l?\"\":q.memoizedProps}catch(t){W(a,a.return,t)}}else if((22!==q.tag&&23!==q.tag||null===q.memoizedState||q===a)&&null!==q.child){q.child.return=q;q=q.child;continue}if(q===a)break a;for(;null===q.sibling;){if(null===q.return||q.return===a)break a;m===q&&(m=null);q=q.return}m===q&&(m=null);q.sibling.return=q.return;q=q.sibling}}break;case 19:ck(b,a);ek(a);d&4&&ak(a);break;case 21:break;default:ck(b,\na),ek(a)}}function ek(a){var b=a.flags;if(b&2){try{a:{for(var c=a.return;null!==c;){if(Tj(c)){var d=c;break a}c=c.return}throw Error(p(160));}switch(d.tag){case 5:var e=d.stateNode;d.flags&32&&(ob(e,\"\"),d.flags&=-33);var f=Uj(a);Wj(a,f,e);break;case 3:case 4:var g=d.stateNode.containerInfo,h=Uj(a);Vj(a,h,g);break;default:throw Error(p(161));}}catch(k){W(a,a.return,k)}a.flags&=-3}b&4096&&(a.flags&=-4097)}function hk(a,b,c){V=a;ik(a,b,c)}\nfunction ik(a,b,c){for(var d=0!==(a.mode&1);null!==V;){var e=V,f=e.child;if(22===e.tag&&d){var g=null!==e.memoizedState||Jj;if(!g){var h=e.alternate,k=null!==h&&null!==h.memoizedState||U;h=Jj;var l=U;Jj=g;if((U=k)&&!l)for(V=e;null!==V;)g=V,k=g.child,22===g.tag&&null!==g.memoizedState?jk(e):null!==k?(k.return=g,V=k):jk(e);for(;null!==f;)V=f,ik(f,b,c),f=f.sibling;V=e;Jj=h;U=l}kk(a,b,c)}else 0!==(e.subtreeFlags&8772)&&null!==f?(f.return=e,V=f):kk(a,b,c)}}\nfunction kk(a){for(;null!==V;){var b=V;if(0!==(b.flags&8772)){var c=b.alternate;try{if(0!==(b.flags&8772))switch(b.tag){case 0:case 11:case 15:U||Qj(5,b);break;case 1:var d=b.stateNode;if(b.flags&4&&!U)if(null===c)d.componentDidMount();else{var e=b.elementType===b.type?c.memoizedProps:Ci(b.type,c.memoizedProps);d.componentDidUpdate(e,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var f=b.updateQueue;null!==f&&sh(b,f,d);break;case 3:var g=b.updateQueue;if(null!==g){c=null;if(null!==b.child)switch(b.child.tag){case 5:c=\nb.child.stateNode;break;case 1:c=b.child.stateNode}sh(b,g,c)}break;case 5:var h=b.stateNode;if(null===c&&b.flags&4){c=h;var k=b.memoizedProps;switch(b.type){case \"button\":case \"input\":case \"select\":case \"textarea\":k.autoFocus&&c.focus();break;case \"img\":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===b.memoizedState){var l=b.alternate;if(null!==l){var m=l.memoizedState;if(null!==m){var q=m.dehydrated;null!==q&&bd(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;\ndefault:throw Error(p(163));}U||b.flags&512&&Rj(b)}catch(r){W(b,b.return,r)}}if(b===a){V=null;break}c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}function gk(a){for(;null!==V;){var b=V;if(b===a){V=null;break}var c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}\nfunction jk(a){for(;null!==V;){var b=V;try{switch(b.tag){case 0:case 11:case 15:var c=b.return;try{Qj(4,b)}catch(k){W(b,c,k)}break;case 1:var d=b.stateNode;if(\"function\"===typeof d.componentDidMount){var e=b.return;try{d.componentDidMount()}catch(k){W(b,e,k)}}var f=b.return;try{Rj(b)}catch(k){W(b,f,k)}break;case 5:var g=b.return;try{Rj(b)}catch(k){W(b,g,k)}}}catch(k){W(b,b.return,k)}if(b===a){V=null;break}var h=b.sibling;if(null!==h){h.return=b.return;V=h;break}V=b.return}}\nvar lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=Infinity,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return 0!==(K&6)?B():-1!==Ak?Ak:Ak=B()}\nfunction yi(a){if(0===(a.mode&1))return 1;if(0!==(K&2)&&0!==Z)return Z&-Z;if(null!==Kg.transition)return 0===Bk&&(Bk=yc()),Bk;a=C;if(0!==a)return a;a=window.event;a=void 0===a?16:jd(a.type);return a}function gi(a,b,c,d){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(a,c,d);if(0===(K&2)||a!==Q)a===Q&&(0===(K&2)&&(qk|=c),4===T&&Ck(a,Z)),Dk(a,d),1===c&&0===K&&0===(b.mode&1)&&(Gj=B()+500,fg&&jg())}\nfunction Dk(a,b){var c=a.callbackNode;wc(a,b);var d=uc(a,a===Q?Z:0);if(0===d)null!==c&&bc(c),a.callbackNode=null,a.callbackPriority=0;else if(b=d&-d,a.callbackPriority!==b){null!=c&&bc(c);if(1===b)0===a.tag?ig(Ek.bind(null,a)):hg(Ek.bind(null,a)),Jf(function(){0===(K&6)&&jg()}),c=null;else{switch(Dc(d)){case 1:c=fc;break;case 4:c=gc;break;case 16:c=hc;break;case 536870912:c=jc;break;default:c=hc}c=Fk(c,Gk.bind(null,a))}a.callbackPriority=b;a.callbackNode=c}}\nfunction Gk(a,b){Ak=-1;Bk=0;if(0!==(K&6))throw Error(p(327));var c=a.callbackNode;if(Hk()&&a.callbackNode!==c)return null;var d=uc(a,a===Q?Z:0);if(0===d)return null;if(0!==(d&30)||0!==(d&a.expiredLanes)||b)b=Ik(a,d);else{b=d;var e=K;K|=2;var f=Jk();if(Q!==a||Z!==b)uk=null,Gj=B()+500,Kk(a,b);do try{Lk();break}catch(h){Mk(a,h)}while(1);$g();mk.current=f;K=e;null!==Y?b=0:(Q=null,Z=0,b=T)}if(0!==b){2===b&&(e=xc(a),0!==e&&(d=e,b=Nk(a,e)));if(1===b)throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;if(6===b)Ck(a,d);\nelse{e=a.current.alternate;if(0===(d&30)&&!Ok(e)&&(b=Ik(a,d),2===b&&(f=xc(a),0!==f&&(d=f,b=Nk(a,f))),1===b))throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;a.finishedWork=e;a.finishedLanes=d;switch(b){case 0:case 1:throw Error(p(345));case 2:Pk(a,tk,uk);break;case 3:Ck(a,d);if((d&130023424)===d&&(b=fk+500-B(),10<b)){if(0!==uc(a,0))break;e=a.suspendedLanes;if((e&d)!==d){R();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),b);break}Pk(a,tk,uk);break;case 4:Ck(a,d);if((d&4194240)===\nd)break;b=a.eventTimes;for(e=-1;0<d;){var g=31-oc(d);f=1<<g;g=b[g];g>e&&(e=g);d&=~f}d=e;d=B()-d;d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*lk(d/1960))-d;if(10<d){a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),d);break}Pk(a,tk,uk);break;case 5:Pk(a,tk,uk);break;default:throw Error(p(329));}}}Dk(a,B());return a.callbackNode===c?Gk.bind(null,a):null}\nfunction Nk(a,b){var c=sk;a.current.memoizedState.isDehydrated&&(Kk(a,b).flags|=256);a=Ik(a,b);2!==a&&(b=tk,tk=c,null!==b&&Fj(b));return a}function Fj(a){null===tk?tk=a:tk.push.apply(tk,a)}\nfunction Ok(a){for(var b=a;;){if(b.flags&16384){var c=b.updateQueue;if(null!==c&&(c=c.stores,null!==c))for(var d=0;d<c.length;d++){var e=c[d],f=e.getSnapshot;e=e.value;try{if(!He(f(),e))return!1}catch(g){return!1}}}c=b.child;if(b.subtreeFlags&16384&&null!==c)c.return=b,b=c;else{if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return!0;b=b.return}b.sibling.return=b.return;b=b.sibling}}return!0}\nfunction Ck(a,b){b&=~rk;b&=~qk;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-oc(b),d=1<<c;a[c]=-1;b&=~d}}function Ek(a){if(0!==(K&6))throw Error(p(327));Hk();var b=uc(a,0);if(0===(b&1))return Dk(a,B()),null;var c=Ik(a,b);if(0!==a.tag&&2===c){var d=xc(a);0!==d&&(b=d,c=Nk(a,d))}if(1===c)throw c=pk,Kk(a,0),Ck(a,b),Dk(a,B()),c;if(6===c)throw Error(p(345));a.finishedWork=a.current.alternate;a.finishedLanes=b;Pk(a,tk,uk);Dk(a,B());return null}\nfunction Qk(a,b){var c=K;K|=1;try{return a(b)}finally{K=c,0===K&&(Gj=B()+500,fg&&jg())}}function Rk(a){null!==wk&&0===wk.tag&&0===(K&6)&&Hk();var b=K;K|=1;var c=ok.transition,d=C;try{if(ok.transition=null,C=1,a)return a()}finally{C=d,ok.transition=c,K=b,0===(K&6)&&jg()}}function Hj(){fj=ej.current;E(ej)}\nfunction Kk(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Gf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;wg(d);switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&$f();break;case 3:zh();E(Wf);E(H);Eh();break;case 5:Bh(d);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(d.type._context);break;case 22:case 23:Hj()}c=c.return}Q=a;Y=a=Pg(a.current,null);Z=fj=b;T=0;pk=null;rk=qk=rh=0;tk=sk=null;if(null!==fh){for(b=\n0;b<fh.length;b++)if(c=fh[b],d=c.interleaved,null!==d){c.interleaved=null;var e=d.next,f=c.pending;if(null!==f){var g=f.next;f.next=e;d.next=g}c.pending=d}fh=null}return a}\nfunction Mk(a,b){do{var c=Y;try{$g();Fh.current=Rh;if(Ih){for(var d=M.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}Ih=!1}Hh=0;O=N=M=null;Jh=!1;Kh=0;nk.current=null;if(null===c||null===c.return){T=1;pk=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=Z;h.flags|=32768;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k,m=h,q=m.tag;if(0===(m.mode&1)&&(0===q||11===q||15===q)){var r=m.alternate;r?(m.updateQueue=r.updateQueue,m.memoizedState=r.memoizedState,\nm.lanes=r.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Ui(g);if(null!==y){y.flags&=-257;Vi(y,g,h,f,b);y.mode&1&&Si(f,l,b);b=y;k=l;var n=b.updateQueue;if(null===n){var t=new Set;t.add(k);b.updateQueue=t}else n.add(k);break a}else{if(0===(b&1)){Si(f,l,b);tj();break a}k=Error(p(426))}}else if(I&&h.mode&1){var J=Ui(g);if(null!==J){0===(J.flags&65536)&&(J.flags|=256);Vi(J,g,h,f,b);Jg(Ji(k,h));break a}}f=k=Ji(k,h);4!==T&&(T=2);null===sk?sk=[f]:sk.push(f);f=g;do{switch(f.tag){case 3:f.flags|=65536;\nb&=-b;f.lanes|=b;var x=Ni(f,k,b);ph(f,x);break a;case 1:h=k;var w=f.type,u=f.stateNode;if(0===(f.flags&128)&&(\"function\"===typeof w.getDerivedStateFromError||null!==u&&\"function\"===typeof u.componentDidCatch&&(null===Ri||!Ri.has(u)))){f.flags|=65536;b&=-b;f.lanes|=b;var F=Qi(f,h,b);ph(f,F);break a}}f=f.return}while(null!==f)}Sk(c)}catch(na){b=na;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}function Jk(){var a=mk.current;mk.current=Rh;return null===a?Rh:a}\nfunction tj(){if(0===T||3===T||2===T)T=4;null===Q||0===(rh&268435455)&&0===(qk&268435455)||Ck(Q,Z)}function Ik(a,b){var c=K;K|=2;var d=Jk();if(Q!==a||Z!==b)uk=null,Kk(a,b);do try{Tk();break}catch(e){Mk(a,e)}while(1);$g();K=c;mk.current=d;if(null!==Y)throw Error(p(261));Q=null;Z=0;return T}function Tk(){for(;null!==Y;)Uk(Y)}function Lk(){for(;null!==Y&&!cc();)Uk(Y)}function Uk(a){var b=Vk(a.alternate,a,fj);a.memoizedProps=a.pendingProps;null===b?Sk(a):Y=b;nk.current=null}\nfunction Sk(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&32768)){if(c=Ej(c,b,fj),null!==c){Y=c;return}}else{c=Ij(c,b);if(null!==c){c.flags&=32767;Y=c;return}if(null!==a)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6;Y=null;return}}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===T&&(T=5)}function Pk(a,b,c){var d=C,e=ok.transition;try{ok.transition=null,C=1,Wk(a,b,c,d)}finally{ok.transition=e,C=d}return null}\nfunction Wk(a,b,c,d){do Hk();while(null!==wk);if(0!==(K&6))throw Error(p(327));c=a.finishedWork;var e=a.finishedLanes;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(p(177));a.callbackNode=null;a.callbackPriority=0;var f=c.lanes|c.childLanes;Bc(a,f);a===Q&&(Y=Q=null,Z=0);0===(c.subtreeFlags&2064)&&0===(c.flags&2064)||vk||(vk=!0,Fk(hc,function(){Hk();return null}));f=0!==(c.flags&15990);if(0!==(c.subtreeFlags&15990)||f){f=ok.transition;ok.transition=null;\nvar g=C;C=1;var h=K;K|=4;nk.current=null;Oj(a,c);dk(c,a);Oe(Df);dd=!!Cf;Df=Cf=null;a.current=c;hk(c,a,e);dc();K=h;C=g;ok.transition=f}else a.current=c;vk&&(vk=!1,wk=a,xk=e);f=a.pendingLanes;0===f&&(Ri=null);mc(c.stateNode,d);Dk(a,B());if(null!==b)for(d=a.onRecoverableError,c=0;c<b.length;c++)e=b[c],d(e.value,{componentStack:e.stack,digest:e.digest});if(Oi)throw Oi=!1,a=Pi,Pi=null,a;0!==(xk&1)&&0!==a.tag&&Hk();f=a.pendingLanes;0!==(f&1)?a===zk?yk++:(yk=0,zk=a):yk=0;jg();return null}\nfunction Hk(){if(null!==wk){var a=Dc(xk),b=ok.transition,c=C;try{ok.transition=null;C=16>a?16:a;if(null===wk)var d=!1;else{a=wk;wk=null;xk=0;if(0!==(K&6))throw Error(p(331));var e=K;K|=4;for(V=a.current;null!==V;){var f=V,g=f.child;if(0!==(V.flags&16)){var h=f.deletions;if(null!==h){for(var k=0;k<h.length;k++){var l=h[k];for(V=l;null!==V;){var m=V;switch(m.tag){case 0:case 11:case 15:Pj(8,m,f)}var q=m.child;if(null!==q)q.return=m,V=q;else for(;null!==V;){m=V;var r=m.sibling,y=m.return;Sj(m);if(m===\nl){V=null;break}if(null!==r){r.return=y;V=r;break}V=y}}}var n=f.alternate;if(null!==n){var t=n.child;if(null!==t){n.child=null;do{var J=t.sibling;t.sibling=null;t=J}while(null!==t)}}V=f}}if(0!==(f.subtreeFlags&2064)&&null!==g)g.return=f,V=g;else b:for(;null!==V;){f=V;if(0!==(f.flags&2048))switch(f.tag){case 0:case 11:case 15:Pj(9,f,f.return)}var x=f.sibling;if(null!==x){x.return=f.return;V=x;break b}V=f.return}}var w=a.current;for(V=w;null!==V;){g=V;var u=g.child;if(0!==(g.subtreeFlags&2064)&&null!==\nu)u.return=g,V=u;else b:for(g=w;null!==V;){h=V;if(0!==(h.flags&2048))try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(na){W(h,h.return,na)}if(h===g){V=null;break b}var F=h.sibling;if(null!==F){F.return=h.return;V=F;break b}V=h.return}}K=e;jg();if(lc&&\"function\"===typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,a)}catch(na){}d=!0}return d}finally{C=c,ok.transition=b}}return!1}function Xk(a,b,c){b=Ji(c,b);b=Ni(a,b,1);a=nh(a,b,1);b=R();null!==a&&(Ac(a,1,b),Dk(a,b))}\nfunction W(a,b,c){if(3===a.tag)Xk(a,a,c);else for(;null!==b;){if(3===b.tag){Xk(b,a,c);break}else if(1===b.tag){var d=b.stateNode;if(\"function\"===typeof b.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Ri||!Ri.has(d))){a=Ji(c,a);a=Qi(b,a,1);b=nh(b,a,1);a=R();null!==b&&(Ac(b,1,a),Dk(b,a));break}}b=b.return}}\nfunction Ti(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=R();a.pingedLanes|=a.suspendedLanes&c;Q===a&&(Z&c)===c&&(4===T||3===T&&(Z&130023424)===Z&&500>B()-fk?Kk(a,0):rk|=c);Dk(a,b)}function Yk(a,b){0===b&&(0===(a.mode&1)?b=1:(b=sc,sc<<=1,0===(sc&130023424)&&(sc=4194304)));var c=R();a=ih(a,b);null!==a&&(Ac(a,b,c),Dk(a,c))}function uj(a){var b=a.memoizedState,c=0;null!==b&&(c=b.retryLane);Yk(a,c)}\nfunction bk(a,b){var c=0;switch(a.tag){case 13:var d=a.stateNode;var e=a.memoizedState;null!==e&&(c=e.retryLane);break;case 19:d=a.stateNode;break;default:throw Error(p(314));}null!==d&&d.delete(b);Yk(a,c)}var Vk;\nVk=function(a,b,c){if(null!==a)if(a.memoizedProps!==b.pendingProps||Wf.current)dh=!0;else{if(0===(a.lanes&c)&&0===(b.flags&128))return dh=!1,yj(a,b,c);dh=0!==(a.flags&131072)?!0:!1}else dh=!1,I&&0!==(b.flags&1048576)&&ug(b,ng,b.index);b.lanes=0;switch(b.tag){case 2:var d=b.type;ij(a,b);a=b.pendingProps;var e=Yf(b,H.current);ch(b,c);e=Nh(null,b,d,a,e,c);var f=Sh();b.flags|=1;\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof?(b.tag=1,b.memoizedState=null,b.updateQueue=\nnull,Zf(d)?(f=!0,cg(b)):f=!1,b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,kh(b),e.updater=Ei,b.stateNode=e,e._reactInternals=b,Ii(b,d,a,c),b=jj(null,b,d,!0,f,c)):(b.tag=0,I&&f&&vg(b),Xi(null,b,e,c),b=b.child);return b;case 16:d=b.elementType;a:{ij(a,b);a=b.pendingProps;e=d._init;d=e(d._payload);b.type=d;e=b.tag=Zk(d);a=Ci(d,a);switch(e){case 0:b=cj(null,b,d,a,c);break a;case 1:b=hj(null,b,d,a,c);break a;case 11:b=Yi(null,b,d,a,c);break a;case 14:b=$i(null,b,d,Ci(d.type,a),c);break a}throw Error(p(306,\nd,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),cj(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),hj(a,b,d,e,c);case 3:a:{kj(b);if(null===a)throw Error(p(387));d=b.pendingProps;f=b.memoizedState;e=f.element;lh(a,b);qh(b,d,null,c);var g=b.memoizedState;d=g.element;if(f.isDehydrated)if(f={element:d,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},b.updateQueue.baseState=\nf,b.memoizedState=f,b.flags&256){e=Ji(Error(p(423)),b);b=lj(a,b,d,c,e);break a}else if(d!==e){e=Ji(Error(p(424)),b);b=lj(a,b,d,c,e);break a}else for(yg=Lf(b.stateNode.containerInfo.firstChild),xg=b,I=!0,zg=null,c=Vg(b,null,d,c),b.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{Ig();if(d===e){b=Zi(a,b,c);break a}Xi(a,b,d,c)}b=b.child}return b;case 5:return Ah(b),null===a&&Eg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ef(d,e)?g=null:null!==f&&Ef(d,f)&&(b.flags|=32),\ngj(a,b),Xi(a,b,g,c),b.child;case 6:return null===a&&Eg(b),null;case 13:return oj(a,b,c);case 4:return yh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Ug(b,null,d,c):Xi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),Yi(a,b,d,e,c);case 7:return Xi(a,b,b.pendingProps,c),b.child;case 8:return Xi(a,b,b.pendingProps.children,c),b.child;case 12:return Xi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;f=b.memoizedProps;\ng=e.value;G(Wg,d._currentValue);d._currentValue=g;if(null!==f)if(He(f.value,g)){if(f.children===e.children&&!Wf.current){b=Zi(a,b,c);break a}}else for(f=b.child,null!==f&&(f.return=b);null!==f;){var h=f.dependencies;if(null!==h){g=f.child;for(var k=h.firstContext;null!==k;){if(k.context===d){if(1===f.tag){k=mh(-1,c&-c);k.tag=2;var l=f.updateQueue;if(null!==l){l=l.shared;var m=l.pending;null===m?k.next=k:(k.next=m.next,m.next=k);l.pending=k}}f.lanes|=c;k=f.alternate;null!==k&&(k.lanes|=c);bh(f.return,\nc,b);h.lanes|=c;break}k=k.next}}else if(10===f.tag)g=f.type===b.type?null:f.child;else if(18===f.tag){g=f.return;if(null===g)throw Error(p(341));g.lanes|=c;h=g.alternate;null!==h&&(h.lanes|=c);bh(g,c,b);g=f.sibling}else g=f.child;if(null!==g)g.return=f;else for(g=f;null!==g;){if(g===b){g=null;break}f=g.sibling;if(null!==f){f.return=g.return;g=f;break}g=g.return}f=g}Xi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,d=b.pendingProps.children,ch(b,c),e=eh(e),d=d(e),b.flags|=1,Xi(a,b,d,c),\nb.child;case 14:return d=b.type,e=Ci(d,b.pendingProps),e=Ci(d.type,e),$i(a,b,d,e,c);case 15:return bj(a,b,b.type,b.pendingProps,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),ij(a,b),b.tag=1,Zf(d)?(a=!0,cg(b)):a=!1,ch(b,c),Gi(b,d,e),Ii(b,d,e,c),jj(null,b,d,!0,a,c);case 19:return xj(a,b,c);case 22:return dj(a,b,c)}throw Error(p(156,b.tag));};function Fk(a,b){return ac(a,b)}\nfunction $k(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Bg(a,b,c,d){return new $k(a,b,c,d)}function aj(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction Zk(a){if(\"function\"===typeof a)return aj(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Da)return 11;if(a===Ga)return 14}return 2}\nfunction Pg(a,b){var c=a.alternate;null===c?(c=Bg(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null);c.flags=a.flags&14680064;c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Rg(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)aj(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ya:return Tg(c.children,e,f,b);case za:g=8;e|=8;break;case Aa:return a=Bg(12,c,b,e|2),a.elementType=Aa,a.lanes=f,a;case Ea:return a=Bg(13,c,b,e),a.elementType=Ea,a.lanes=f,a;case Fa:return a=Bg(19,c,b,e),a.elementType=Fa,a.lanes=f,a;case Ia:return pj(c,e,f,b);default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case Ba:g=10;break a;case Ca:g=9;break a;case Da:g=11;\nbreak a;case Ga:g=14;break a;case Ha:g=16;d=null;break a}throw Error(p(130,null==a?a:typeof a,\"\"));}b=Bg(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Tg(a,b,c,d){a=Bg(7,a,d,b);a.lanes=c;return a}function pj(a,b,c,d){a=Bg(22,a,d,b);a.elementType=Ia;a.lanes=c;a.stateNode={isHidden:!1};return a}function Qg(a,b,c){a=Bg(6,a,null,b);a.lanes=c;return a}\nfunction Sg(a,b,c){b=Bg(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction al(a,b,c,d,e){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=zc(0);this.expirationTimes=zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=zc(0);this.identifierPrefix=d;this.onRecoverableError=e;this.mutableSourceEagerHydrationData=\nnull}function bl(a,b,c,d,e,f,g,h,k){a=new al(a,b,c,h,k);1===b?(b=1,!0===f&&(b|=8)):b=0;f=Bg(3,null,null,b);a.current=f;f.stateNode=a;f.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};kh(f);return a}function cl(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction dl(a){if(!a)return Vf;a=a._reactInternals;a:{if(Vb(a)!==a||1!==a.tag)throw Error(p(170));var b=a;do{switch(b.tag){case 3:b=b.stateNode.context;break a;case 1:if(Zf(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break a}}b=b.return}while(null!==b);throw Error(p(171));}if(1===a.tag){var c=a.type;if(Zf(c))return bg(a,c,b)}return b}\nfunction el(a,b,c,d,e,f,g,h,k){a=bl(c,d,!0,a,e,f,g,h,k);a.context=dl(null);c=a.current;d=R();e=yi(c);f=mh(d,e);f.callback=void 0!==b&&null!==b?b:null;nh(c,f,e);a.current.lanes=e;Ac(a,e,d);Dk(a,d);return a}function fl(a,b,c,d){var e=b.current,f=R(),g=yi(e);c=dl(c);null===b.context?b.context=c:b.pendingContext=c;b=mh(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);a=nh(e,b,g);null!==a&&(gi(a,e,g,f),oh(a,e,g));return g}\nfunction gl(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function hl(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function il(a,b){hl(a,b);(a=a.alternate)&&hl(a,b)}function jl(){return null}var kl=\"function\"===typeof reportError?reportError:function(a){console.error(a)};function ll(a){this._internalRoot=a}\nml.prototype.render=ll.prototype.render=function(a){var b=this._internalRoot;if(null===b)throw Error(p(409));fl(a,b,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var a=this._internalRoot;if(null!==a){this._internalRoot=null;var b=a.containerInfo;Rk(function(){fl(null,a,null,null)});b[uf]=null}};function ml(a){this._internalRoot=a}\nml.prototype.unstable_scheduleHydration=function(a){if(a){var b=Hc();a={blockedOn:null,target:a,priority:b};for(var c=0;c<Qc.length&&0!==b&&b<Qc[c].priority;c++);Qc.splice(c,0,a);0===c&&Vc(a)}};function nl(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType)}function ol(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function pl(){}\nfunction ql(a,b,c,d,e){if(e){if(\"function\"===typeof d){var f=d;d=function(){var a=gl(g);f.call(a)}}var g=el(b,d,a,0,null,!1,!1,\"\",pl);a._reactRootContainer=g;a[uf]=g.current;sf(8===a.nodeType?a.parentNode:a);Rk();return g}for(;e=a.lastChild;)a.removeChild(e);if(\"function\"===typeof d){var h=d;d=function(){var a=gl(k);h.call(a)}}var k=bl(a,0,!1,null,null,!1,!1,\"\",pl);a._reactRootContainer=k;a[uf]=k.current;sf(8===a.nodeType?a.parentNode:a);Rk(function(){fl(b,k,c,d)});return k}\nfunction rl(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f;if(\"function\"===typeof e){var h=e;e=function(){var a=gl(g);h.call(a)}}fl(b,g,a,e)}else g=ql(c,b,a,e,d);return gl(g)}Ec=function(a){switch(a.tag){case 3:var b=a.stateNode;if(b.current.memoizedState.isDehydrated){var c=tc(b.pendingLanes);0!==c&&(Cc(b,c|1),Dk(b,B()),0===(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var b=ih(a,1);if(null!==b){var c=R();gi(b,a,1,c)}}),il(a,1)}};\nFc=function(a){if(13===a.tag){var b=ih(a,134217728);if(null!==b){var c=R();gi(b,a,134217728,c)}il(a,134217728)}};Gc=function(a){if(13===a.tag){var b=yi(a),c=ih(a,b);if(null!==c){var d=R();gi(c,a,b,d)}il(a,b)}};Hc=function(){return C};Ic=function(a,b){var c=C;try{return C=a,b()}finally{C=c}};\nyb=function(a,b,c){switch(b){case \"input\":bb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(p(90));Wa(d);bb(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Qk;Hb=Rk;\nvar sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"};\nvar ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Zb(a);return null===a?null:a.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||\njl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;\nexports.createPortal=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(b))throw Error(p(200));return cl(a,b,null,c)};exports.createRoot=function(a,b){if(!nl(a))throw Error(p(299));var c=!1,d=\"\",e=kl;null!==b&&void 0!==b&&(!0===b.unstable_strictMode&&(c=!0),void 0!==b.identifierPrefix&&(d=b.identifierPrefix),void 0!==b.onRecoverableError&&(e=b.onRecoverableError));b=bl(a,1,!1,null,null,c,!1,d,e);a[uf]=b.current;sf(8===a.nodeType?a.parentNode:a);return new ll(b)};\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(p(188));a=Object.keys(a).join(\",\");throw Error(p(268,a));}a=Zb(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a){return Rk(a)};exports.hydrate=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!0,c)};\nexports.hydrateRoot=function(a,b,c){if(!nl(a))throw Error(p(405));var d=null!=c&&c.hydratedSources||null,e=!1,f=\"\",g=kl;null!==c&&void 0!==c&&(!0===c.unstable_strictMode&&(e=!0),void 0!==c.identifierPrefix&&(f=c.identifierPrefix),void 0!==c.onRecoverableError&&(g=c.onRecoverableError));b=el(b,null,a,1,null!=c?c:null,e,!1,f,g);a[uf]=b.current;sf(a);if(d)for(a=0;a<d.length;a++)c=d[a],e=c._getVersion,e=e(c._source),null==b.mutableSourceEagerHydrationData?b.mutableSourceEagerHydrationData=[c,e]:b.mutableSourceEagerHydrationData.push(c,\ne);return new ml(b)};exports.render=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!ol(a))throw Error(p(40));return a._reactRootContainer?(Rk(function(){rl(null,null,a,!1,function(){a._reactRootContainer=null;a[uf]=null})}),!0):!1};exports.unstable_batchedUpdates=Qk;\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!ol(c))throw Error(p(200));if(null==a||void 0===a._reactInternals)throw Error(p(38));return rl(a,b,c,!1,d)};exports.version=\"18.3.1-next-f1338f8080-20240426\";\n","// gridsVisitedUtils.js (Client-side)\n// Bit manipulation utilities for tracking visited grids\n// Uses a 512-byte buffer to store 4096 bits (64 settlements  64 grids = 4096)\n\n/**\n * Convert a gridCoord to a 0-4095 bit index\n * gridCoord format: TFFSSGG where:\n *   T = Frontier tier (ignored for bit storage)\n *   FF = Frontier index (ignored for bit storage)\n *   SS = Settlement row (0-7) & col (0-7) within frontier's 8x8 grid\n *   GG = Grid row (0-7) & col (0-7) within settlement's 8x8 grid\n *\n * @param {number} gridCoord - The full gridCoord value (e.g., 1011100)\n * @returns {number} - Bit index 0-4095, or -1 if invalid\n */\nexport function gridCoordToBitIndex(gridCoord) {\n  if (typeof gridCoord !== 'number' || gridCoord < 0) {\n    return -1;\n  }\n\n  // Extract the last 4 digits (SSGG)\n  const relevantPart = gridCoord % 10000;\n\n  // Extract settlement and grid positions (each digit is 0-7)\n  const settlementRow = Math.floor(relevantPart / 1000) % 10;\n  const settlementCol = Math.floor(relevantPart / 100) % 10;\n  const gridRow = Math.floor(relevantPart / 10) % 10;\n  const gridCol = relevantPart % 10;\n\n  // Validate ranges (each should be 0-7)\n  if (settlementRow > 7 || settlementCol > 7 || gridRow > 7 || gridCol > 7) {\n    return -1;\n  }\n\n  // Calculate bit index: settlement position (0-63) * 64 + grid position (0-63)\n  const settlementIndex = settlementRow * 8 + settlementCol;  // 0-63\n  const gridIndex = gridRow * 8 + gridCol;                     // 0-63\n  const bitIndex = settlementIndex * 64 + gridIndex;           // 0-4095\n\n  return bitIndex;\n}\n\n/**\n * Convert a bit index (0-4095) back to the SSGG portion of a gridCoord\n * @param {number} bitIndex - Bit index 0-4095\n * @returns {number} - The SSGG portion (e.g., 1100 for settlement 1,1 grid 0,0)\n */\nexport function bitIndexToGridCoordPart(bitIndex) {\n  if (bitIndex < 0 || bitIndex > 4095) {\n    return -1;\n  }\n\n  const settlementIndex = Math.floor(bitIndex / 64);  // 0-63\n  const gridIndex = bitIndex % 64;                     // 0-63\n\n  const settlementRow = Math.floor(settlementIndex / 8);  // 0-7\n  const settlementCol = settlementIndex % 8;               // 0-7\n  const gridRow = Math.floor(gridIndex / 8);               // 0-7\n  const gridCol = gridIndex % 8;                           // 0-7\n\n  return settlementRow * 1000 + settlementCol * 100 + gridRow * 10 + gridCol;\n}\n\n/**\n * Convert gridsVisited data from server to Uint8Array\n * @param {Object|Array|string} gridsVisited - Data from player.gridsVisited\n * @returns {Uint8Array} - Usable byte array\n */\nfunction toByteArray(gridsVisited) {\n  if (!gridsVisited) {\n    return new Uint8Array(512);\n  }\n\n  // If it's already a Uint8Array\n  if (gridsVisited instanceof Uint8Array) {\n    return gridsVisited;\n  }\n\n  // If it's a regular array\n  if (Array.isArray(gridsVisited)) {\n    return new Uint8Array(gridsVisited);\n  }\n\n  // If it's a MongoDB Buffer object with data property\n  if (gridsVisited.type === 'Buffer' && Array.isArray(gridsVisited.data)) {\n    return new Uint8Array(gridsVisited.data);\n  }\n\n  // If it's a base64 string\n  if (typeof gridsVisited === 'string') {\n    const binaryString = atob(gridsVisited);\n    const bytes = new Uint8Array(binaryString.length);\n    for (let i = 0; i < binaryString.length; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes;\n  }\n\n  return new Uint8Array(512);\n}\n\n/**\n * Check if a grid has been visited\n * @param {Object|Array|Uint8Array} gridsVisited - The gridsVisited data from player\n * @param {number} gridCoord - The full gridCoord value (e.g., 1011100)\n * @returns {boolean} - True if the grid has been visited\n */\nexport function isGridVisited(gridsVisited, gridCoord) {\n  if (!gridsVisited) {\n    return false;\n  }\n\n  // Convert gridCoord to bit index\n  const bitIndex = gridCoordToBitIndex(gridCoord);\n  if (bitIndex < 0) {\n    return false;\n  }\n\n  const buffer = toByteArray(gridsVisited);\n  const byteIndex = Math.floor(bitIndex / 8);\n  const bitPosition = bitIndex % 8;\n\n  if (byteIndex >= buffer.length) {\n    return false;\n  }\n\n  return (buffer[byteIndex] & (1 << bitPosition)) !== 0;\n}\n\n/**\n * Mark a grid as visited (returns new array, does not mutate)\n * @param {Object|Array|Uint8Array} gridsVisited - The gridsVisited data from player\n * @param {number} gridCoord - The full gridCoord value (e.g., 1011100)\n * @returns {Uint8Array} - New array with the grid marked as visited\n */\nexport function markGridVisited(gridsVisited, gridCoord) {\n  // Convert gridCoord to bit index\n  const bitIndex = gridCoordToBitIndex(gridCoord);\n  if (bitIndex < 0) {\n    return toByteArray(gridsVisited);\n  }\n\n  const buffer = toByteArray(gridsVisited);\n\n  // Create a copy to avoid mutation\n  const newBuffer = new Uint8Array(Math.max(512, buffer.length));\n  newBuffer.set(buffer);\n\n  const byteIndex = Math.floor(bitIndex / 8);\n  const bitPosition = bitIndex % 8;\n\n  newBuffer[byteIndex] |= (1 << bitPosition);\n\n  return newBuffer;\n}\n\n/**\n * Get all visited grid coordinates\n * @param {Object|Array|Uint8Array} gridsVisited - The gridsVisited data from player\n * @returns {number[]} - Array of visited gridCoords (SSGG format)\n */\nexport function getVisitedGridCoords(gridsVisited) {\n  if (!gridsVisited) {\n    return [];\n  }\n\n  const buffer = toByteArray(gridsVisited);\n  const visited = [];\n\n  for (let byteIndex = 0; byteIndex < buffer.length && byteIndex < 512; byteIndex++) {\n    const byte = buffer[byteIndex];\n    if (byte === 0) continue; // Skip empty bytes for efficiency\n\n    for (let bitPos = 0; bitPos < 8; bitPos++) {\n      if (byte & (1 << bitPos)) {\n        const bitIndex = byteIndex * 8 + bitPos;\n        if (bitIndex <= 4095) {\n          // Convert bit index back to SSGG gridCoord format\n          const gridCoordPart = bitIndexToGridCoordPart(bitIndex);\n          if (gridCoordPart >= 0) {\n            visited.push(gridCoordPart);\n          }\n        }\n      }\n    }\n  }\n\n  return visited;\n}\n\n/**\n * Count how many grids have been visited\n * @param {Object|Array|Uint8Array} gridsVisited - The gridsVisited data from player\n * @returns {number} - Count of visited grids\n */\nexport function countVisitedGrids(gridsVisited) {\n  if (!gridsVisited) {\n    return 0;\n  }\n\n  const buffer = toByteArray(gridsVisited);\n  let count = 0;\n\n  for (let byteIndex = 0; byteIndex < buffer.length && byteIndex < 512; byteIndex++) {\n    let byte = buffer[byteIndex];\n    // Count set bits using Brian Kernighan's algorithm\n    while (byte) {\n      byte &= (byte - 1);\n      count++;\n    }\n  }\n\n  return count;\n}\n\n/**\n * Convert a Uint8Array to the format expected by the server\n * @param {Uint8Array} buffer - The byte array\n * @returns {Array} - Array of numbers for JSON serialization\n */\nexport function toServerFormat(buffer) {\n  return Array.from(buffer);\n}\n","import playersInGridManager from \"../GridState/PlayersInGrid\";\nimport axios from \"axios\";\nimport API_BASE from \"../config\";\n  \nexport const getIngredientDetails = (recipe, allResources) => {\n  \n    const ingredients = [];\n    for (let i = 1; i <= 4; i++) {\n      const ingredientType = recipe[`ingredient${i}`];\n      const ingredientQty = recipe[`ingredient${i}qty`];\n      if (ingredientType && ingredientQty) {\n        const ingredientResource = allResources.find((res) => res.type === ingredientType);\n        const symbol = ingredientResource?.symbol || '';\n        ingredients.push(`${symbol} ${ingredientType} x${ingredientQty}`);\n      }\n    }\n    return ingredients;\n  };\n  \n\n// Utility Function for Socket Listener\nexport function mergeResources(existingResources, updatedResources) {\n  console.log(\" mergeResources called\");\n  console.log(\" Existing Resources:\", existingResources.length);\n  console.log(\" Updated Resources:\", updatedResources);\n\n  const map = new Map();\n\n  // Add all existing resources to map\n  for (const res of existingResources) {\n    const key = `${res.x},${res.y}`;\n    map.set(key, res);\n  }\n\n  // Track whether any actual changes were made\n  let changed = false;\n\n  // Overwrite with updated ones\n  for (const updated of updatedResources) {\n    const key = `${updated.x},${updated.y}`;\n    const existing = map.get(key);\n    const merged = { ...existing, ...updated };\n\n    // Deep compare for debugging\n    const changedFields = Object.entries(updated).filter(\n      ([k, v]) => existing?.[k] !== v\n    );\n    if (changedFields.length > 0) {\n      console.log(` Resource at (${key}) changed fields:`, changedFields);\n      changed = true;\n    } else {\n      console.log(` Resource at (${key}) unchanged`);\n    }\n\n    map.set(key, merged);\n  }\n\n  const result = Array.from(map.values());\n\n  console.log(\" mergeResources returning new array of length:\", result.length);\n  console.log(\" Resources actually changed?\", changed);\n  return result;\n}\n\n\nexport function mergeTiles(existingTiles, updatedTiles) {\n  console.log(\" mergeTiles called\");\n  console.log(\" Existing Tiles:\", existingTiles.length, \"rows\");\n  console.log(\" Updated Tiles:\", updatedTiles);\n\n  const newTiles = existingTiles.map(row => [...row]); // Create deep copy\n  let changed = false;\n\n  updatedTiles.forEach(({ x, y, type: tileType }) => {\n    if (newTiles[y] && typeof newTiles[y][x] !== 'undefined') {\n      const oldTile = newTiles[y][x];\n      if (oldTile !== tileType) {\n        console.log(` Tile at (${x},${y}) changed from \"${oldTile}\" to \"${tileType}\"`);\n        newTiles[y][x] = tileType;\n        changed = true;\n      } else {\n        console.log(` Tile at (${x},${y}) is already \"${tileType}\"  no change`);\n      }\n    } else {\n      console.warn(` Attempted to update invalid tile at (${x},${y})`);\n    }\n  });\n\n  console.log(\" mergeTiles returning new tile array\");\n  console.log(\" Any tiles changed?\", changed);\n  return newTiles;\n}\n\n\nexport function enrichResourceFromMaster(raw, masterResources) {\n// Used by socket listeners to enrich raw resource data with template details\n  const template = masterResources.find(r => r.type === raw.type);  \n  if (!template) {\n    console.warn(` No matching resource template found for ${raw.type}`);\n    return raw;\n  }\n  return {\n    ...template,\n    ...raw, // Allow raw to override specific fields like growEnd, x, y\n  };\n}\n\nexport function getCurrentTileCoordinates(gridId, currentPlayer) {\n  const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n  if (!playersInGrid || !currentPlayer?.playerId) {\n    console.warn(' playersInGrid or playerId missing.');\n    return null;\n  }\n  const playerData = playersInGrid[currentPlayer.playerId];\n  if (!playerData) {\n    console.warn(' Player not found in playersInGrid.');\n    return null;\n  }\n  const { x, y } = playerData.position;\n  if (x == null || y == null) {\n    console.warn(' Invalid player position.');\n    return null;\n  }\n  const tileX = Math.floor(x);\n  const tileY = Math.floor(y);\n  return { tileX, tileY };\n}\n\n// export async function getTileResource(gridId, x, y) {\n//   try {\n//     console.log(`Fetching resource at (${x}, ${y}) in grid ${gridId}`);\n//     const response = await axios.get(`${API_BASE}/api/get-resource/${gridId}/${x}/${y}`);\n//     console.log(`Resource at (${x}, ${y}):`, response.data);\n//     return response.data;\n//   } catch (error) {\n//     console.error(`Error fetching resource at (${x}, ${y}) in grid ${gridId}:`, error);\n//     throw error;\n//   }\n// }\n\nexport async function validateTileType(gridId, x, y) {\n  try {\n    console.log(`Validating tile type at (${x}, ${y}) in grid ${gridId}`);\n    const response = await axios.get(`${API_BASE}/api/get-tile/${gridId}/${x}/${y}`);\n    console.log(`Tile type at (${x}, ${y}):`, response.data.tileType);\n    return response.data.tileType;\n  } catch (error) {\n    console.error(`Error fetching tile type at (${x}, ${y}) in grid ${gridId}:`, error);\n    throw error;\n  }\n}\n\n/**\n * Check if an item is a crop (output of farmplot)\n * @param {string} itemType - The item type to check\n * @param {Array} masterResources - Master resources array\n * @returns {boolean} True if the item is a crop\n */\nexport function isACrop(itemType, masterResources) {\n  // Exclude trees from being considered crops\n  if (itemType === 'Oak Tree' || itemType === 'Pine Tree') {\n    return false;\n  }\n\n  // Check if this item is the output of any farmplot resource\n  const isFarmplotOutput = masterResources.some(resource =>\n    resource.category === 'farmplot' && resource.output === itemType\n  );\n\n  // If it's a farmplot output, it's a crop (even if also output of a source like Snowman -> Carrot)\n  if (isFarmplotOutput) {\n    return true;\n  }\n\n  // Not a crop if it's not the output of a farmplot\n  return false;\n}\n\n/**\n * Check if a player has the required skill for a resource/item\n * 'devonly' is a visibility filter, not a skill requirement - always passes\n * @param {string} requiredSkill - The skill requirement (e.g., 'Farming', 'devonly', etc.)\n * @param {Object} currentPlayer - The current player object with skills array\n * @returns {boolean} True if the skill requirement is met\n */\nexport function hasRequiredSkill(requiredSkill, currentPlayer) {\n  // 'devonly' is a visibility filter, not a skill requirement - always passes skill check\n  if (requiredSkill === 'devonly') return true;\n  // No requirement means it's always available\n  if (!requiredSkill) return true;\n  // Check if player has the required skill\n  return currentPlayer?.skills?.some((owned) => owned.type === requiredSkill) ?? false;\n}\n\n/**\n * Check if a resource should be visible based on 'devonly' requirement\n * @param {Object} resource - The resource object with optional 'requires' field\n * @param {boolean} isDeveloper - Whether the current player is a developer\n * @returns {boolean} True if the resource should be visible\n */\nexport function isVisibleToPlayer(resource, isDeveloper) {\n  // If requires is 'devonly', only show to developers\n  if (resource.requires === 'devonly') return isDeveloper;\n  return true;\n}\n\n","// GlobalGridStateTilesAndResources.js\nconst GlobalGridStateTilesAndResources = {\n    tiles: [],\n    resources: [],\n  \n    // Setter for tiles\n    setTiles(newTiles) {\n      this.tiles = newTiles;\n      //console.log('Global tiles updated:', this.tiles);\n    },\n  \n    // Setter for resources\n    setResources(newResources) {\n      this.resources = newResources;\n      //console.log('Global resources updated:', this.resources);\n    },\n  \n    // Getter for tiles\n    getTiles() {\n      return this.tiles;\n    },\n  \n    // Getter for resources\n    getResources() {\n      return this.resources;\n    },\n  };\n  \n  export default GlobalGridStateTilesAndResources;","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","import axios from 'axios';\nimport { updateGridResource } from './Utils/GridManagement';\n\nlet farmTimer = null;\n\nclass FarmState {\n    constructor() {\n      this.farmState = [];\n    }\n  \n    initializeFarmState(resources = []) {\n      this.farmState = resources.filter((res) => res.category === 'farmplot' && res.growEnd);\n      \n      \n    }\n  \n    addSeed(seed) {\n      if (!seed.output) {\n        console.warn(' Trying to add a seed without an output! This will break later.', seed);\n      }\n      this.farmState.push(seed);\n    }\n\n  /**\n   * Process seeds periodically to check for growth completion.\n   */\n  startSeedTimer({ gridId, setResources, masterResources }) {\n    if (farmTimer) clearInterval(farmTimer);\n    \n    // Store the current gridId to check if we're still on the same grid\n    const currentGridId = gridId;\n    \n  \n    farmTimer = setInterval(async () => {\n      //console.log('FarmState timer ticking.');\n      //console.log('Current farmState:', this.farmState);\n  \n      const now = Date.now();\n      const completedSeeds = this.farmState.filter((seed) => seed.growEnd <= now);\n      //console.log('Completed seeds:', completedSeeds);\n  \n      if (completedSeeds.length > 0) {\n\n        // Process seeds sequentially to match server processing speed\n        let successfulCount = 0;\n        \n        for (const seed of completedSeeds) {\n          // First check if this seed still exists in current farmState\n          // (it might have been removed by bulk harvest)\n          const stillExists = this.farmState.some(s => \n            s.x === seed.x && s.y === seed.y && s.type === seed.type\n          );\n          \n          if (!stillExists) {\n            console.log(`Seed at (${seed.x}, ${seed.y}) no longer exists in farmState, skipping conversion.`);\n            continue;\n          }\n          \n          const newCrop = masterResources.find((res) => res.type === seed.output);\n          \n          if (!newCrop) {\n            console.warn(`No target resource found for seed output: ${seed.output}`);\n            continue;\n          }\n\n          try {\n            const response = await updateGridResource(\n              currentGridId, \n              { \n                type: newCrop.type,\n                x: seed.x,\n                y: seed.y,\n              },\n              true\n            );\n\n            if (response?.success) {\n              \n              const enriched = {\n                ...newCrop,\n                x: seed.x,\n                y: seed.y\n              };\n\n              // Update UI only after server confirms the update\n              setResources(prev => {\n                const filtered = prev.filter(r => !(r.x === seed.x && r.y === seed.y));\n                return [...filtered, enriched];\n              });\n              \n              // Remove from farmState after successful conversion\n              this.farmState = this.farmState.filter(s => !(s.x === seed.x && s.y === seed.y && s.type === seed.type));\n              \n              successfulCount++;\n              \n              // Add a small delay between conversions to make them visually distinct\n              // This also helps prevent overwhelming the server and keeps us in sync\n              // Using 120ms to match observed server processing time\n              await new Promise(resolve => setTimeout(resolve, 120));\n            } else {\n              console.warn(`Failed to update grid resource for seed at (${seed.x}, ${seed.y}).`);\n            }\n          } catch (error) {\n            console.error(`Error updating grid resource for seed at (${seed.x}, ${seed.y}):`, error);\n          }\n        }\n        \n      }\n    }, 1000);\n  }\n\n  \n  /**\n   * Force process any seeds that are ready to convert\n   * This ensures client/server sync before operations like bulk harvest\n   */\n  async forceProcessPendingSeeds({ gridId, setResources, masterResources }) {\n    const now = Date.now();\n    const completedSeeds = this.farmState.filter((seed) => seed.growEnd <= now);\n    \n    if (completedSeeds.length === 0) {\n      return true;\n    }\n    \n    try {\n      // Process all completed seeds\n      const updatePromises = completedSeeds.map(async (seed) => {\n        const newCrop = masterResources.find((res) => res.type === seed.output);\n        \n        if (!newCrop) {\n          console.warn(`No target resource found for seed output: ${seed.output}`);\n          return null;\n        }\n\n        try {\n          const response = await updateGridResource(\n            gridId, \n            { \n              type: newCrop.type,\n              x: seed.x,\n              y: seed.y,\n            },\n            true\n          );\n\n          if (response?.success) {\n            return { seed, enriched: { ...newCrop, x: seed.x, y: seed.y } };\n          }\n          return null;\n        } catch (error) {\n          console.error(`Error syncing seed at (${seed.x}, ${seed.y}):`, error);\n          return null;\n        }\n      });\n\n      // Wait for all updates\n      const results = await Promise.all(updatePromises);\n      const successfulUpdates = results.filter(result => result !== null);\n      \n      // Update local state\n      if (successfulUpdates.length > 0) {\n        setResources(prev => {\n          const seedPositions = successfulUpdates.map(({ seed }) => `${seed.x},${seed.y}`);\n          const filtered = prev.filter(r => !seedPositions.includes(`${r.x},${r.y}`));\n          const newCrops = successfulUpdates.map(({ enriched }) => enriched);\n          return [...filtered, ...newCrops];\n        });\n        \n        // Remove from farmState\n        const processedSeeds = successfulUpdates.map(({ seed }) => seed);\n        this.farmState = this.farmState.filter(s => !processedSeeds.includes(s));\n      }\n      \n      return true;\n    } catch (error) {\n      console.error(' Error during force sync:', error);\n      return false;\n    }\n  }\n  \n  /**\n   * Stop the seed timer.\n   */\n  stopSeedTimer() {\n    if (farmTimer) clearInterval(farmTimer);\n    farmTimer = null;\n    // Clear farmState when stopping to prevent stale data\n    this.farmState = [];\n  }\n}\n\nconst farmStateInstance = new FarmState();\nexport default farmStateInstance;","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './Notifications.css';\nimport { useStrings } from '../StringsContext';\n\n// Global notification manager\nlet notificationRoot = null;\nlet notificationTimer = null;\nlet globalClickHandlers = {};\n\n// Notification types that should persist until manually dismissed\nconst PERSISTENT_NOTIFICATION_TYPES = ['To Do', 'FTUE', 'Message'];\n\n/**\n * Generic notification component\n */\nfunction Notification({ type, data, onDismiss, onClick }) {\n    const strings = useStrings();\n    \n    // Add unmount detection\n    React.useEffect(() => {\n        return () => {\n        };\n    }, []);\n    \n    React.useEffect(() => {\n        // Auto-dismiss after 5 seconds (except for persistent notification types)\n        if (!PERSISTENT_NOTIFICATION_TYPES.includes(type)) {\n            const timer = setTimeout(() => {\n                onDismiss();\n            }, 5000);\n            \n            return () => {\n                clearTimeout(timer);\n            };\n        } else {\n        }\n        // Remove onDismiss from dependencies to prevent re-running effect\n    }, [type]);\n    \n    // Render different content based on notification type\n    const renderContent = () => {\n        switch (type) {\n            case 'Trophy':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                            {data.type === 'Progress' && data.progress && (\n                                <div className=\"notification-milestone\">{data.progress}</div>\n                            )}\n                            {data.type === 'Count' && data.qty && (\n                                <div className=\"notification-milestone\">{data.qty}x</div>\n                            )}\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{strings[6003]}</div>\n                            <div className=\"notification-name\">{data.name}</div>\n                        </div>\n                    </>\n                );\n            \n            case 'Phase Change':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">Phase Change</div>\n                            <div className=\"notification-name\">{data.message || 'Day has turned to night'}</div>\n                        </div>\n                    </>\n                );\n            \n            case 'Message':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || 'New Message'}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'To Do':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[204]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'Tip':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[7001]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'Travel':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[7001]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            case 'FTUE':\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">{data.title || strings[7049]}</div>\n                            <div className=\"notification-name\">{data.message}</div>\n                        </div>\n                    </>\n                );\n\n            default:\n                return (\n                    <>\n                        <div className=\"notification-icon-wrapper\">\n                            <div className=\"notification-icon\">{data.icon || ''}</div>\n                        </div>\n                        <div className=\"notification-text\">\n                            <div className=\"notification-title\">Notification</div>\n                            <div className=\"notification-name\">{data.message || 'Something happened!'}</div>\n                        </div>\n                    </>\n                );\n        }\n    };\n    \n    // Add persistent class for notifications that shouldn't auto-dismiss\n    const isPersistent = PERSISTENT_NOTIFICATION_TYPES.includes(type);\n    const className = `notification ${isPersistent ? 'notification-persistent' : ''}`;\n    \n    return (\n        <div className={className} onClick={onClick} style={{ cursor: onClick ? 'pointer' : 'default' }}>\n            <button className=\"notification-dismiss\" onClick={(e) => {\n                e.stopPropagation();\n                onDismiss();\n            }}></button>\n            <div className=\"notification-content\">\n                {renderContent()}\n            </div>\n        </div>\n    );\n}\n\n/**\n * Shows a notification\n * @param {string} type - The type of notification ('Trophy', 'Phase Change', 'Message', etc.)\n * @param {Object} data - The data to display in the notification\n * @param {string} [data.icon] - Optional emoji to override the default notification icon\n * @param {Function} onClick - Optional click handler for the notification\n */\n/**\n * Register a global click handler for a notification type\n * @param {string} type - The notification type\n * @param {Function} handler - The click handler\n */\nexport function registerNotificationClickHandler(type, handler) {\n    globalClickHandlers[type] = handler;\n}\n\nexport function showNotification(type, data, onClick = null) {\n    console.log(`[showNotification] Called with type: ${type}`, data);\n    // Clear any existing notification\n    if (notificationTimer) {\n        clearTimeout(notificationTimer);\n    }\n    \n    // Create or reuse the notification container\n    let container = document.getElementById('notification-container');\n    if (!container) {\n        container = document.createElement('div');\n        container.id = 'notification-container';\n        // Append to game container instead of body\n        const gameContainer = document.querySelector('.game-container') || document.querySelector('.App') || document.body;\n        gameContainer.appendChild(container);\n    }\n    \n    if (!notificationRoot) {\n        notificationRoot = ReactDOM.createRoot(container);\n    }\n    \n    const handleDismiss = () => {\n        console.log(`[handleDismiss] Dismissing notification of type: ${type}`);\n        if (notificationRoot) {\n            notificationRoot.render(null);\n        }\n    };\n    \n    // Use passed onClick or fall back to global handler for this type\n    const clickHandler = onClick || (globalClickHandlers[type] ? () => globalClickHandlers[type](data) : null);\n    \n    // Use a unique key to force React to remount the component and trigger animation\n    const notificationKey = `${type}-${Date.now()}`;\n    \n    notificationRoot.render(\n        <Notification \n            key={notificationKey}\n            type={type}\n            data={data}\n            onDismiss={handleDismiss}\n            onClick={clickHandler}\n        />\n    );\n}","import React, { useState, useRef, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport './FloatingText.css';\nimport { calculateTileCenter } from '../VFX/VFX.js';\nimport { useStrings } from '../UI/StringsContext';\n\n// Global array to store floating texts - shared across all instances\nlet globalFloatingTexts = [];\nlet globalForceUpdate = null;\n\nconst FloatingTextManager = () => {\n    const [tick, setTick] = useState(0);\n    const strings = useStrings();\n    const instanceIdRef = useRef(Math.floor(Math.random() * 10000));\n\n    const forceUpdate = () => setTick((prev) => prev + 1);\n\n    // Set this instance as the active one for force updates\n    useEffect(() => {\n        globalForceUpdate = forceUpdate;\n        \n        FloatingTextManager.addFloatingText = (message, x, y, TILE_SIZE, options = {}) => {\n            const displayText = typeof message === 'number'\n                ? (strings[message] || `Missing string for code: ${message}`)\n                : message;\n\n            const container = document.querySelector('.homestead');\n            if (!container) return;\n\n            if (isNaN(x) || isNaN(y)) {\n                console.warn('Invalid coordinates in addFloatingText:', { x, y });\n                return;\n            }\n\n            const { centerX, centerY } = calculateTileCenter(x, y, TILE_SIZE);\n            const newId = `${Date.now()}-${Math.floor(Math.random() * 10000)}`;\n            \n            // Edge detection and offset calculation\n            const EDGE_THRESHOLD = 100; // Distance from edge to trigger offset\n            const OFFSET_AMOUNT = 40; // How much to offset when near edge\n            \n            let finalX = centerX;\n            let finalY = centerY;\n            \n            // Get container dimensions (64x64 grid)\n            const gridSize = 64 * TILE_SIZE;\n            \n            // Check left edge\n            if (centerX < EDGE_THRESHOLD) {\n                finalX = centerX + OFFSET_AMOUNT;\n            }\n            // Check right edge\n            else if (centerX > gridSize - EDGE_THRESHOLD) {\n                finalX = centerX - OFFSET_AMOUNT;\n            }\n            \n            // Check top edge\n            if (centerY < EDGE_THRESHOLD) {\n                finalY = centerY + OFFSET_AMOUNT;\n            }\n            // Check bottom edge  \n            else if (centerY > gridSize - EDGE_THRESHOLD) {\n                finalY = centerY - OFFSET_AMOUNT;\n            }\n\n            globalFloatingTexts.push({\n                id: newId,\n                text: displayText,\n                x: finalX,\n                y: finalY,\n                timestamp: Date.now(),\n                color: options.color,\n                size: options.size\n            });\n\n            if (globalForceUpdate) globalForceUpdate();\n        };\n    }, [strings]);\n\n    const container = document.querySelector('.homestead');\n    if (!container) return null;\n    \n    return createPortal(\n        <div className=\"floating-text-container\">\n            {globalFloatingTexts.map(({ id, text, x, y, color, size }) => (\n                <div\n                    key={id}\n                    className=\"floating-text\"\n                    style={{\n                        position: 'absolute',\n                        left: x,\n                        top: y - 30,\n                        transform: 'translate(-50%, -50%)',\n                        color: color || undefined,\n                        fontSize: size || undefined\n                    }}\n                    onAnimationEnd={(e) => {\n                        // Immediately hide the element to prevent visual artifacts\n                        e.target.style.display = 'none';\n                        \n                        globalFloatingTexts = globalFloatingTexts.filter(t => t.id !== id);\n                        if (globalForceUpdate) globalForceUpdate();\n                    }}\n                >\n                    {text}\n                </div>\n            ))}\n        </div>,\n        container\n    );\n};\n\n// Will be assigned inside useEffect\nFloatingTextManager.addFloatingText = (...args) => {\n    console.warn('FloatingTextManager not ready yet', ...args);\n};\n\nexport default FloatingTextManager;","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","import API_BASE from './config';\nimport axios from 'axios';\nimport { fetchGridData } from './Utils/GridManagement'; // Utility for fetching grid data\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\n\n/**\n * Grid Initialization (Runs on Refresh or Login)\n * This is for TILES and RESOURCES (not players)\n */\nexport const initializeGrid = async (\n  TILE_SIZE,\n  gridId,\n  setGrid,\n  setResources,\n  setTileTypes,\n  updateStatus,\n  DBPlayerData,\n  masterResources\n) => {\n  try {\n    if (!gridId) {\n      console.error(' [CRITICAL] GridId is missing. Cannot initialize grid.');\n      return;\n    }\n\n    console.log(' Initializing grid for gridId:', gridId);\n\n    const gridData = await fetchGridData(gridId, updateStatus, DBPlayerData);\n    const { tiles, resources } = gridData;\n    \n    console.log(' [DEBUG] fetchGridData result:', {\n      gridDataKeys: Object.keys(gridData || {}),\n      tilesLength: tiles?.length || 0,\n      resourcesLength: resources?.length || 0,\n      tilesType: typeof tiles,\n      resourcesType: typeof resources,\n      firstTile: tiles?.[0],\n      firstResource: resources?.[0]\n    });\n    \n\n    // Process resources to add shadow tiles for multi-tile buildings\n    const processedResources = [];\n    const loadedResources = resources || [];\n    \n    for (const rawResource of loadedResources) {\n      // Enrich resource with master data to get properties like range, passable, etc\n      let resource = rawResource;\n      if (masterResources && masterResources.length > 0) {\n        const template = masterResources.find(r => r.type === rawResource.type);\n        if (template) {\n          resource = {\n            ...template,\n            ...rawResource // Raw data overrides template (for x, y, growEnd, etc)\n          };\n        }\n      }\n      \n      processedResources.push(resource);\n      \n      \n      // If this is a multi-tile resource (has range > 1), create shadow tiles\n      // Note: Resources from server might not have anchorKey, so we generate one if needed\n      if (resource.range && resource.range > 1) {\n        const anchorKey = resource.anchorKey || `${resource.type}-${resource.x}-${resource.y}`;\n        \n        for (let dx = 0; dx < resource.range; dx++) {\n          for (let dy = 0; dy < resource.range; dy++) {\n            // Skip the anchor tile (0,0)\n            if (dx === 0 && dy === 0) continue;\n            \n            const shadowX = resource.x + dx;\n            const shadowY = resource.y - dy;\n            const shadowResource = {\n              type: 'shadow',\n              x: shadowX,\n              y: shadowY,\n              parentAnchorKey: anchorKey,\n              passable: resource.passable\n            };\n            \n            processedResources.push(shadowResource);\n          }\n        }\n      }\n    }\n\n    console.log(' [DEBUG] Setting state:', {\n      tilesLength: (tiles || []).length,\n      processedResourcesLength: processedResources.length,\n      aboutToSetGrid: true,\n      aboutToSetResources: true,\n      aboutToSetTileTypes: true\n    });\n\n    setGrid(tiles || []);\n    setResources(processedResources);\n    setTileTypes(tiles || []);\n    \n    // Also update the global grid state with both tiles and resources\n    GlobalGridStateTilesAndResources.setTiles(tiles || []);\n    GlobalGridStateTilesAndResources.setResources(processedResources);\n    \n    console.log(' Grid, tiles, and resources initialized for gridId:', gridId);\n    console.log(' [DEBUG] Final verification in AppInit:', {\n      globalTilesLength: GlobalGridStateTilesAndResources.getTiles().length,\n      globalResourcesLength: GlobalGridStateTilesAndResources.getResources().length\n    });\n  } catch (error) {\n    console.error('Error initializing grid:', error);\n  }\n};\n\n\n\n/**\n * Logout Player\n */\nexport const logoutPlayer = (setPlayerData, setisLoginPanelOpen, setGrid, setResources, setTileTypes) => {\n  localStorage.removeItem('player');\n  setPlayerData(null);\n  setGrid([]); // Clear the grid state\n  setResources([]); // Clear resources\n  setTileTypes([]); // Clear tile types\n  setisLoginPanelOpen(true); // Open login modal\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + {\"95\":\"68003008\",\"453\":\"e009a26f\",\"803\":\"35bf588a\"}[chunkId] + \".chunk.js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"game-client:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgame_client\"] = self[\"webpackChunkgame_client\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","import axios from 'axios';\nimport API_BASE from '../config';\n\n// Utility: detect mobile browser\nexport function isMobile() {\n  return /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\n\n// Utility function: return boolean indicating developer status\nexport const checkDeveloperStatus = async (username) => {\n  console.log(` [DEV CHECK] Checking developer status for username: \"${username}\"`);\n  console.log(` [DEV CHECK] API_BASE: ${API_BASE}`);\n  try {\n    const url = `${API_BASE}/api/check-developer-status/${username}`;\n    console.log(` [DEV CHECK] Full URL: ${url}`);\n    const response = await axios.get(url);\n    console.log(` [DEV CHECK] Response:`, response.data);\n    const result = !!response.data?.isDeveloper;\n    console.log(` [DEV CHECK] Result: ${result}`);\n    return result;\n  } catch (err) {\n    console.warn(' Failed to check developer status:', err);\n    return false;\n  }\n};\n\n// Badge update helper\nexport function updateBadge(currentPlayer, setBadgeState, category, value = true) {\n  const key = `badges_${currentPlayer.username}`;\n  const current = JSON.parse(localStorage.getItem(key)) || {};\n  const updated = { ...current, [category]: value };\n  localStorage.setItem(key, JSON.stringify(updated));\n  setBadgeState(updated);\n}\n\n// Badge read helper\nexport function getBadgeState(currentPlayer) {\n  if (!currentPlayer?.username) {\n    console.warn(\" getBadgeState called without valid currentPlayer\");\n    return {};\n  }\n  const key = `badges_${currentPlayer.username}`;\n  const stored = localStorage.getItem(key);\n  return stored ? JSON.parse(stored) : {};\n}","import React, { useState, useEffect, useRef } from 'react';\nimport socket from '../../socketManager';\nimport { emitChatMessage } from '../../socketManager';\nimport { updateBadge } from '../../Utils/appUtils';\nimport './Chat.css';\nimport API_BASE from '../../config';\n\nconst Chat = ({ currentGridId, currentSettlementId, currentFrontierId, currentPlayer, onClose }) => {\n\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const endRef = useRef(null);\n  const playerId = currentPlayer?._id || 'unknown'; // Fallback if currentPlayer is not available\n\n  useEffect(() => {\n    console.log(\" Chat component mounted with frontierId:\", currentFrontierId);\n\n    //  Join only frontier chat room\n    if (socket && socket.connected && currentFrontierId) {\n      console.log(\" Joining frontier chat room from Chat.js\");\n      socket.emit('join-chat-rooms', {\n        gridId: null,\n        settlementId: null,\n        frontierId: currentFrontierId,\n      });\n    } else {\n      console.warn(\" Socket not connected or no frontierId when Chat mounted.\");\n    }\n\n    //  Clear chat badge on open\n    if (currentPlayer) {\n      updateBadge(currentPlayer, () => {}, 'chat', false ?? true);\n    }\n  }, [currentFrontierId]);\n\n  useEffect(() => {\n    if (!socket) return;\n\n    socket.on('receive-chat-message', (msg) => {\n      // Only show frontier messages\n      if (msg.scope !== 'frontier') return;\n      \n      if (!msg.username && currentPlayer?.username) {\n        msg.username = currentPlayer.username;\n      }\n      console.log(\" Received chat message via socket:\", msg);\n      setMessages(prev => [...prev, msg]);\n    });\n\n    return () => {\n        socket.off('receive-chat-message');\n    };\n    }, [socket]);\n\n\nuseEffect(() => {\n  const fetchMessages = async () => {\n    if (!currentFrontierId) return;\n    \n    try {\n      const res = await fetch(`${API_BASE}/api/chat/frontier/${currentFrontierId}`);\n      const data = await res.json();\n      setMessages(data);\n    } catch (err) {\n      console.error(\"Failed to fetch chat history:\", err);\n    }\n  };\n\n  fetchMessages();\n}, [currentFrontierId]);\n\n\n  useEffect(() => {\n    endRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n\n  const handleSend = (e) => {\n    e.preventDefault();\n    const trimmed = inputText.trim();\n    if (!trimmed || !currentFrontierId) return;\n\n    console.log(\" Sending chat message:\", trimmed);\n\n    emitChatMessage({\n      playerId,\n      username: currentPlayer?.username || 'unknown',\n      message: trimmed,\n      scope: 'frontier',\n      scopeId: currentFrontierId\n    });\n\n    setInputText(''); //  clear input after emitting\n  };\n\n  const handleKeyPress = (e) => {\n    console.log(\" Key pressed:\", e.key);\n    if (e.key === 'Enter') {\n      e.preventDefault(); // Prevents default Enter behavior in input\n      handleSend(e); // Pass the actual event to handleSend\n    }\n  };\n\nreturn (\n    <div className=\"chat-container\">\n\n    <div className=\"chat-panel-header\">\n      <h3> Chat</h3>\n      <button className=\"chat-close-button\" onClick={onClose}></button>\n    </div>\n\n    <div className=\"chat-panel\">\n        <div className=\"chat-messages\">\n        {messages.map((msg, i) => (\n            <div key={msg.id || i} className=\"chat-message\">\n              <strong>{msg.username || '???'}</strong>: {msg.message || '[empty]'}\n            </div>\n        ))}\n        <div ref={endRef} />\n        </div>\n\n        <div className=\"chat-input\">\n        <input\n            type=\"text\"\n            value={inputText}\n            onChange={e => setInputText(e.target.value)}\n            onKeyDown={handleKeyPress}\n            placeholder=\"Message everyone...\"\n        />\n        <button type=\"button\" onClick={handleSend}>Send</button>\n        </div>\n\n    </div>\n    </div>\n  );\n};\n\nexport default Chat;","/**\n * Centralized Tile Color Configuration\n *\n * This file is the single source of truth for tile colors used throughout\n * the game client and editor. Import from here to ensure consistency.\n *\n * Usage:\n *   import { tileColors, layoutKeyColors, defaultTileColor } from '../UI/Styles/tileColors';\n */\n\n// Single-letter tile type keys (used by game rendering and editor)\nexport const tileColors = {\n  g: '#81ba44',    // grass\n  s: '#8fa6bdff',  // stone/slate\n  d: '#c0834a',    // dirt\n  w: '#58cad8',    // water\n  p: '#d3ce7b',    // pavement\n  l: '#c4583d',    // lava\n  n: '#fbde00',    // sand\n  o: '#ffffff',    // snow\n  x: '#959ba3ff',  // cobblestone\n  y: '#000000ff',  // dungeon\n  z: '#1b712cff',  // moss\n  c: '#6c3b3bff',  // clay\n  v: '#44551dff',  // tbdTile1\n  u: '#1b712cff',  // tbdTile2\n};\n\n// Two-letter layout keys (used by Tile.jsx rendering in editor)\nexport const layoutKeyColors = {\n  '**': '#fff',       // none\n  'GR': '#67c257',    // grass\n  'SL': '#8fa6bdff',  // stone/slate\n  'DI': '#c0834a',    // dirt\n  'WA': '#58cad8',    // water\n  'PA': '#c5a85d',    // pavement\n  'LV': '#c4583d',    // lava\n  'SA': '#fbde00',    // sand\n  'SN': '#ffffff',    // snow\n  'CB': '#959ba3ff',  // cobblestone\n  'DU': '#000000ff',  // dungeon\n  'ZZ': '#1b712cff',  // moss\n  'CL': '#6c3b3bff',  // clay\n  'V1': '#44551dff',  // tbdTile1\n  'U2': '#1b712cff',  // tbdTile2\n};\n\n// Tile rounding configuration - which tile types should have rounded corners\nexport const tileRoundingConfig = {\n  g: true,   // grass - rounded\n  s: true,   // stone - rounded\n  w: true,   // water - rounded\n  l: true,   // lava - rounded\n  n: true,   // sand - rounded\n  o: true,   // snow - rounded\n  d: false,  // dirt - no rounding (base layer)\n  p: true,   // pavement - rounded\n  x: true,   // cobblestone - rounded\n  y: false,  // dungeon - no rounding\n  z: false,  // moss - no rounding\n  c: false,  // clay - no rounding\n  v: false,  // tbdTile1 - no rounding\n  u: false,  // tbdTile2 - no rounding\n};\n\n// Bit mappings for encoded tile data (used by RenderVisitedGrid)\n// 4 bits per tile allows 16 tile types (0-15)\nexport const BITS_TO_TILE_TYPE = {\n  0b0000: 'g', // grass\n  0b0001: 's', // slate/stone\n  0b0010: 'd', // dirt\n  0b0011: 'w', // water\n  0b0100: 'p', // pavement\n  0b0101: 'l', // lava\n  0b0110: 'n', // sand\n  0b0111: 'o', // snow\n  0b1000: 'x', // cobblestone\n  0b1001: 'y', // dungeon\n  0b1010: 'z', // moss\n  0b1011: 'c', // clay\n  0b1100: 'v', // tbdTile1\n  0b1101: 'u', // tbdTile2\n  // 0b1110, 0b1111 reserved for future tiles\n};\n\n// Reverse mapping: tile type to bits (for encoding)\nexport const TILE_TYPE_TO_BITS = Object.fromEntries(\n  Object.entries(BITS_TO_TILE_TYPE).map(([bits, type]) => [type, parseInt(bits)])\n);\n\n// Priority order for corner color calculations\nexport const tilePriorityOrder = ['w', 'l', 's', 'd', 'g', 'p', 'n', 'o', 'x', 'y', 'z', 'c', 'v', 'u'];\n\n// Default color for unknown tile types\nexport const defaultTileColor = '#ff0000'; // debug red\n\n// Helper function to get tile color\nexport function getTileColor(tileType) {\n  return tileColors[tileType] || defaultTileColor;\n}\n","import React, { useRef, useEffect, useCallback } from 'react';\nimport { tileRoundingConfig, getTileColor, tilePriorityOrder } from '../UI/Styles/tileColors';\n\n// Use centralized tile rounding configuration\nconst TILE_ROUNDING_CONFIG = tileRoundingConfig;\n\n// Helper function to draw a single grass tuft\nfunction drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE) {\n  const size = Math.max(1, TILE_SIZE * 0.08 + (tuftSeed * 0.01) % (TILE_SIZE * 0.04));\n  const opacity = 0.15 + (tuftSeed * 0.01) % 0.1;\n  \n  ctx.save();\n  ctx.translate(x, y);\n  ctx.rotate((tuftSeed * 0.5) % 60 - 30);\n  ctx.fillStyle = `rgba(0, 50, 0, ${opacity})`;\n  \n  // Draw irregular grass clump using path\n  ctx.beginPath();\n  const points = [\n    [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n    [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n  ];\n  \n  points.forEach(([px, py], index) => {\n    const drawX = px * size - size/2;\n    const drawY = py * size - size/2;\n    if (index === 0) ctx.moveTo(drawX, drawY);\n    else ctx.lineTo(drawX, drawY);\n  });\n  ctx.closePath();\n  ctx.fill();\n  ctx.restore();\n}\n\n// Calculate which corners should be rounded based on adjacent tiles\nfunction calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes) {\n  // If this tile type doesn't support rounding, return null\n  if (!TILE_ROUNDING_CONFIG[tileType]) {\n    return null;\n  }\n\n  const roundedCorners = {\n    topLeft: false,\n    topRight: false,\n    bottomRight: false,\n    bottomLeft: false\n  };\n  \n  // Check each corner: top-left, top-right, bottom-right, bottom-left\n  const adjacentChecks = [\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'topLeft'\n    },\n    { \n      neighbors: [\n        { row: rowIndex - 1, col: colIndex },     // top\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'topRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex + 1 },     // right\n      ],\n      corner: 'bottomRight'\n    },\n    { \n      neighbors: [\n        { row: rowIndex + 1, col: colIndex },     // bottom\n        { row: rowIndex, col: colIndex - 1 },     // left\n      ],\n      corner: 'bottomLeft'\n    }\n  ];\n\n  for (const check of adjacentChecks) {\n    // For a corner to be rounded, BOTH adjacent sides must have different tiles\n    const allNeighborsDifferent = check.neighbors.every(neighbor => {\n      const neighborType = tileTypes[neighbor.row]?.[neighbor.col] || 'd'; // default to dirt if out of bounds\n      return neighborType !== tileType;\n    });\n    \n    roundedCorners[check.corner] = allNeighborsDifferent;\n  }\n  \n  return roundedCorners;\n}\n\n// Calculate corner background color based on adjacent tiles\nfunction calculateCornerColor(tileType, corner, rowIndex, colIndex, tileTypes) {\n  let adjacentTiles = [];\n  \n  switch (corner) {\n    case 'topLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex - 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n    case 'topRight':\n      adjacentTiles = [\n        tileTypes[rowIndex - 1]?.[colIndex] || 'd',     // top\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex - 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomRight':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex + 1] || 'd',     // right\n        tileTypes[rowIndex + 1]?.[colIndex + 1] || 'd', // diagonal\n      ];\n      break;\n    case 'bottomLeft':\n      adjacentTiles = [\n        tileTypes[rowIndex + 1]?.[colIndex] || 'd',     // bottom\n        tileTypes[rowIndex]?.[colIndex - 1] || 'd',     // left\n        tileTypes[rowIndex + 1]?.[colIndex - 1] || 'd', // diagonal\n      ];\n      break;\n  }\n  \n  // Remove the current tile type from consideration\n  adjacentTiles = adjacentTiles.filter(type => type !== tileType);\n  \n  // If all adjacent tiles are the same type, use that color\n  if (adjacentTiles.length > 0 && adjacentTiles.every(type => type === adjacentTiles[0])) {\n    return getTileColor(adjacentTiles[0]);\n  }\n  \n  // If there are different adjacent tiles (mixed colors), default to the tile's own color\n  if (adjacentTiles.length > 1) {\n    const uniqueTypes = [...new Set(adjacentTiles)];\n    if (uniqueTypes.length > 1) {\n      return getTileColor(tileType);\n    }\n  }\n  \n  // If only one adjacent tile type, use priority system\n  for (const priorityType of tilePriorityOrder) {\n    if (adjacentTiles.includes(priorityType)) {\n      return getTileColor(priorityType);\n    }\n  }\n  \n  // Fallback to dirt if no adjacent tiles found\n  return getTileColor('d');\n}\n\n// Pre-render organic textures for tile types with variation\nfunction createTileTexture(tileType, TILE_SIZE, variation = 0, rowIndex, colIndex, tileTypes, zoomLevel) {\n  const canvas = document.createElement('canvas');\n  canvas.width = TILE_SIZE;\n  canvas.height = TILE_SIZE;\n  const ctx = canvas.getContext('2d');\n  \n  // Calculate rounded corners for this tile (skip for far zoom to improve performance)\n  const roundedCorners = (zoomLevel === 'far') ? null : calculateRoundedCorners(tileType, rowIndex, colIndex, tileTypes);\n  \n  // Fill base color\n  ctx.fillStyle = getTileColor(tileType);\n  ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n  \n  // Draw corner backgrounds if we have rounded corners\n  if (roundedCorners) {\n    const cornerSize = TILE_SIZE / 2;\n    \n    // Top-left corner\n    if (roundedCorners.topLeft) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'topLeft', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(0, 0, cornerSize, cornerSize);\n    }\n    \n    // Top-right corner\n    if (roundedCorners.topRight) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'topRight', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(cornerSize, 0, cornerSize, cornerSize);\n    }\n    \n    // Bottom-right corner\n    if (roundedCorners.bottomRight) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'bottomRight', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(cornerSize, cornerSize, cornerSize, cornerSize);\n    }\n    \n    // Bottom-left corner\n    if (roundedCorners.bottomLeft) {\n      ctx.fillStyle = calculateCornerColor(tileType, 'bottomLeft', rowIndex, colIndex, tileTypes);\n      ctx.fillRect(0, cornerSize, cornerSize, cornerSize);\n    }\n    \n    // Draw the main tile with rounded corners over the corner backgrounds\n    ctx.fillStyle = getTileColor(tileType);\n    \n    const radius = 8; // Base radius for corners\n    ctx.beginPath();\n    ctx.moveTo(roundedCorners.topLeft ? radius : 0, 0);\n    ctx.lineTo(TILE_SIZE - (roundedCorners.topRight ? radius : 0), 0);\n    if (roundedCorners.topRight) {\n      ctx.quadraticCurveTo(TILE_SIZE, 0, TILE_SIZE, radius);\n    }\n    ctx.lineTo(TILE_SIZE, TILE_SIZE - (roundedCorners.bottomRight ? radius : 0));\n    if (roundedCorners.bottomRight) {\n      ctx.quadraticCurveTo(TILE_SIZE, TILE_SIZE, TILE_SIZE - radius, TILE_SIZE);\n    }\n    ctx.lineTo(roundedCorners.bottomLeft ? radius : 0, TILE_SIZE);\n    if (roundedCorners.bottomLeft) {\n      ctx.quadraticCurveTo(0, TILE_SIZE, 0, TILE_SIZE - radius);\n    }\n    ctx.lineTo(0, roundedCorners.topLeft ? radius : 0);\n    if (roundedCorners.topLeft) {\n      ctx.quadraticCurveTo(0, 0, radius, 0);\n    }\n    ctx.closePath();\n    ctx.fill();\n  }\n  \n  // Add organic textures based on tile type\n  if (tileType === 'g') {\n    // Grass tufts - completely different approaches per variation\n    const baseSeeds = [157, 331, 523, 769]; // Prime numbers for max variation\n    const seed = baseSeeds[variation] || 500;\n    \n    // Completely different positioning strategies per variation\n    if (variation === 0) {\n      // Variation 0: Scattered pattern\n      const positions = [[25, 30], [70, 45], [45, 70]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 73) % 1000;\n        const x = (baseX + (tuftSeed * 0.1) % 20 - 10) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.2) % 20 - 10) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else if (variation === 1) {\n      // Variation 1: Corner clusters\n      const corners = [[20, 20], [75, 25], [30, 75], [80, 80]];\n      corners.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 91) % 1000;\n        const x = (baseX + (tuftSeed * 0.15) % 15 - 7) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.18) % 15 - 7) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else if (variation === 2) {\n      // Variation 2: Organic center cluster\n      const positions = [[50, 40], [60, 55], [45, 60], [35, 45]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 113) % 1000;\n        const x = (baseX + (tuftSeed * 0.25) % 30 - 15) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.3) % 25 - 12) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    } else {\n      // Variation 3: Random sparse\n      const positions = [[40, 35], [65, 60]];\n      positions.forEach(([baseX, baseY], i) => {\n        const tuftSeed = (seed + i * 137) % 1000;\n        const x = (baseX + (tuftSeed * 0.2) % 30 - 15) / 100 * TILE_SIZE;\n        const y = (baseY + (tuftSeed * 0.25) % 25 - 12) / 100 * TILE_SIZE;\n        drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n      });\n    }\n    \n    // Occasional yellow clump - varies by variation  \n    if ((seed + variation * 17) % 5 === 0) {\n      const lightSeed = (seed * 1.41) % 1000;\n      const lightX = (15 + (lightSeed * 0.83) % 70) / 100 * TILE_SIZE;\n      const lightY = (25 + (lightSeed * 1.37) % 50) / 100 * TILE_SIZE;\n      const lightSize = Math.max(2, TILE_SIZE * 0.12 + (lightSeed * 0.01) % (TILE_SIZE * 0.04));\n      \n      ctx.save();\n      ctx.translate(lightX, lightY);\n      ctx.rotate((lightSeed * 0.7) % 60 - 30);\n      ctx.fillStyle = `rgba(220, 220, 40, 0.6)`;\n      \n      ctx.beginPath();\n      const points = [\n        [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n        [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n      ];\n      \n      points.forEach(([px, py], index) => {\n        const drawX = px * lightSize - lightSize/2;\n        const drawY = py * lightSize - lightSize/2;\n        if (index === 0) ctx.moveTo(drawX, drawY);\n        else ctx.lineTo(drawX, drawY);\n      });\n      ctx.closePath();\n      ctx.fill();\n      ctx.restore();\n    }\n  }\n\n  // Dirt cracks - using variation for different patterns\n\n  if (tileType === 'd') {\n    const seed = 600 + variation * 150;\n    const numPatches = 4 + (seed % 4);\n    \n    for (let i = 0; i < numPatches; i++) {\n      const patchSeed = (seed + i * 139) % 1000;\n      const x = (5 + (patchSeed * 0.91) % 90) / 100 * TILE_SIZE;\n      const y = (5 + (patchSeed * 1.23) % 90) / 100 * TILE_SIZE;\n      const size = Math.max(1, TILE_SIZE * 0.06 + (patchSeed * 0.01) % (TILE_SIZE * 0.03));\n      const opacity = 0.12 + (patchSeed * 0.01) % 0.08;\n      \n      ctx.save();\n      ctx.translate(x, y);\n      ctx.rotate((patchSeed * 0.7) % 180 * Math.PI / 180);\n      ctx.fillStyle = `rgba(80, 50, 30, ${opacity})`;\n      \n      const width = size * 2;\n      const height = size * 0.5;\n      ctx.fillRect(-width/2, -height/2, width, height);\n      ctx.restore();\n    }\n    \n    // Occasional lighter dirt patch\n    if (seed % 6 === 0) {\n      const lightSeed = (seed * 1.61) % 1000;\n      const lightX = (10 + (lightSeed * 0.79) % 80) / 100 * TILE_SIZE;\n      const lightY = (10 + (lightSeed * 1.47) % 80) / 100 * TILE_SIZE;\n      const lightSize = Math.max(1, TILE_SIZE * 0.08 + (lightSeed * 0.01) % (TILE_SIZE * 0.02));\n      \n      ctx.fillStyle = `rgba(160, 130, 90, 0.25)`;\n      ctx.beginPath();\n      ctx.arc(lightX, lightY, lightSize/2, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  }\n  \n\n\n  // App icon-style PAVEMENT tile with grass showing through rounded corners\n\n  if (tileType === 'p') {\n    const grassColor = '#67c257';\n    const cornerRadius = Math.max(4, TILE_SIZE * 0.15); // Nice visible rounded corners\n    \n    // Step 1: Fill entire tile with grass color (background)\n    ctx.fillStyle = grassColor;\n    ctx.globalAlpha = 0.4;\n    ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n    ctx.globalAlpha = 1.0;\n    \n    // Step 2: Create rounded rectangle mask for the pavement stone\n    const drawRoundedRect = (x, y, width, height, radius) => {\n      ctx.beginPath();\n      ctx.moveTo(x + radius, y);\n      ctx.lineTo(x + width - radius, y);\n      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n      ctx.lineTo(x + width, y + height - radius);\n      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n      ctx.lineTo(x + radius, y + height);\n      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n      ctx.lineTo(x, y + radius);\n      ctx.quadraticCurveTo(x, y, x + radius, y);\n      ctx.closePath();\n    };\n    \n    // Step 3: Draw everything within the rounded rectangle shape\n    ctx.save();\n    drawRoundedRect(0, 0, TILE_SIZE, TILE_SIZE, cornerRadius);\n    ctx.clip(); // Clip everything to the rounded rectangle\n    \n    // Clear the grass background within the clipped area and draw stone\n    ctx.fillStyle = getTileColor(tileType);\n    ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n    \n    // Add thin grass border inside the rounded shape\n    const grassWidth = Math.max(1, TILE_SIZE * 0.001);\n    ctx.fillStyle = grassColor;\n    ctx.globalAlpha = 0.6;\n    \n    // Top grass border\n    ctx.fillRect(0, 0, TILE_SIZE, grassWidth);\n    // Bottom grass border\n    ctx.fillRect(0, TILE_SIZE - grassWidth, TILE_SIZE, grassWidth);\n    // Left grass border\n    ctx.fillRect(0, 0, grassWidth, TILE_SIZE);\n    // Right grass border\n    ctx.fillRect(TILE_SIZE - grassWidth, 0, grassWidth, TILE_SIZE);\n    \n    ctx.globalAlpha = 1.0;\n    \n    // Add beveled effect within the rounded shape\n    const bevelSize = Math.max(1, TILE_SIZE * 0.01);\n    const inset = grassWidth;\n    \n    // Light highlights (top and left)\n    ctx.fillStyle = 'rgba(220, 215, 200, 0.7)';\n    ctx.fillRect(inset, inset, TILE_SIZE - inset * 2, bevelSize);\n    ctx.fillRect(inset, inset, bevelSize, TILE_SIZE - inset * 2);\n    \n    // Dark shadows (bottom and right)\n    ctx.fillStyle = 'rgba(80, 65, 45, 0.7)';\n    ctx.fillRect(inset, TILE_SIZE - inset - bevelSize, TILE_SIZE - inset * 2, bevelSize);\n    ctx.fillRect(TILE_SIZE - inset - bevelSize, inset, bevelSize, TILE_SIZE - inset * 2);\n    \n    ctx.restore(); // End clipping\n    \n    // Add stretched grass tufts along edges with random variation\n    // Use tile coordinates for consistent but varied seeding\n    const uniqueSeed = (rowIndex * 73 + colIndex * 137 + variation * 211) % 1000;\n    const numGrassTufts = 2 + (uniqueSeed % 3); // 2-4 tufts per tile\n    \n    for (let i = 0; i < numGrassTufts; i++) {\n      const grassSeed = (uniqueSeed + i * 179) % 1000;\n      \n      // Position grass tufts along edges\n      let x, y, isHorizontal;\n      const side = grassSeed % 4;\n      const extensionIntoStone = grassWidth * 2; // Allow tufts to extend into pavement area\n      \n      if (side === 0) { // Top edge - horizontal stretch\n        x = (grassSeed * 0.7) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1; // Stay away from corners\n        y = (grassSeed * 0.3) % (grassWidth + extensionIntoStone);\n        isHorizontal = true;\n      } else if (side === 1) { // Bottom edge - horizontal stretch\n        x = (grassSeed * 0.8) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        y = TILE_SIZE - grassWidth - extensionIntoStone + (grassSeed * 0.4) % (grassWidth + extensionIntoStone);\n        isHorizontal = true;\n      } else if (side === 2) { // Left edge - vertical stretch\n        x = (grassSeed * 0.5) % (grassWidth + extensionIntoStone);\n        y = (grassSeed * 0.9) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        isHorizontal = false;\n      } else { // Right edge - vertical stretch\n        x = TILE_SIZE - grassWidth - extensionIntoStone + (grassSeed * 0.6) % (grassWidth + extensionIntoStone);\n        y = (grassSeed * 1.1) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        isHorizontal = false;\n      }\n      \n      // Draw stretched grass along the edge (6 pixels long)\n      const stretchLength = Math.max(4, TILE_SIZE * 0.15); // About 6 pixels at normal size\n      const stretchWidth = Math.max(1, TILE_SIZE * 0.02);\n      \n      ctx.fillStyle = `rgba(27, 151, 27, 0.7)`;\n      ctx.save();\n      ctx.translate(x, y);\n      \n      // Random rotation for natural look\n      const baseRotation = (grassSeed * 0.01) % (Math.PI * 0.3) - Math.PI * 0.15; // 27 degrees\n      ctx.rotate(baseRotation);\n      \n      if (isHorizontal) {\n        // Horizontal grass streak\n        ctx.fillRect(-stretchLength/2, -stretchWidth/2, stretchLength, stretchWidth);\n        \n        // Add some organic variation along the length\n        for (let k = 0; k < 3; k++) {\n          const offset = (k - 1) * stretchLength * 0.3;\n          const size = stretchWidth * (0.5 + (grassSeed + k * 23) % 100 / 200);\n          ctx.beginPath();\n          ctx.ellipse(offset, 0, size, size * 1.5, 0, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      } else {\n        // Vertical grass streak\n        ctx.fillRect(-stretchWidth/2, -stretchLength/2, stretchWidth, stretchLength);\n        \n        // Add some organic variation along the length\n        for (let k = 0; k < 3; k++) {\n          const offset = (k - 1) * stretchLength * 0.3;\n          const size = stretchWidth * (0.5 + (grassSeed + k * 29) % 100 / 200);\n          ctx.beginPath();\n          ctx.ellipse(0, offset, size * 1.5, size, 0, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      }\n      \n      ctx.restore();\n    }\n  }\n  \n  // App icon-style COBBLESTONE tile with grass showing through rounded corners\n\n    if (tileType === 'x') {\n    const grassColor = '#307823ff';\n    const cornerRadius = Math.max(4, TILE_SIZE * 0.15); // Nice visible rounded corners\n    \n    // Step 1: Fill entire tile with grass color (background)\n    ctx.fillStyle = grassColor;\n    ctx.globalAlpha = 0.4;\n    ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n    ctx.globalAlpha = 1.0;\n    \n    // Step 2: Create rounded rectangle mask for the pavement stone\n    const drawRoundedRect = (x, y, width, height, radius) => {\n      ctx.beginPath();\n      ctx.moveTo(x + radius, y);\n      ctx.lineTo(x + width - radius, y);\n      ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n      ctx.lineTo(x + width, y + height - radius);\n      ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n      ctx.lineTo(x + radius, y + height);\n      ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n      ctx.lineTo(x, y + radius);\n      ctx.quadraticCurveTo(x, y, x + radius, y);\n      ctx.closePath();\n    };\n    \n    // Step 3: Draw everything within the rounded rectangle shape\n    ctx.save();\n    drawRoundedRect(0, 0, TILE_SIZE, TILE_SIZE, cornerRadius);\n    ctx.clip(); // Clip everything to the rounded rectangle\n    \n    // Clear the grass background within the clipped area and draw stone\n    ctx.fillStyle = getTileColor(tileType);\n    ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n    \n    // Add thin grass border inside the rounded shape\n    const grassWidth = Math.max(1, TILE_SIZE * 0.006);\n    ctx.fillStyle = grassColor;\n    ctx.globalAlpha = 0.6;\n    \n    // Top grass border\n    ctx.fillRect(0, 0, TILE_SIZE, grassWidth);\n    // Bottom grass border\n    ctx.fillRect(0, TILE_SIZE - grassWidth, TILE_SIZE, grassWidth);\n    // Left grass border\n    ctx.fillRect(0, 0, grassWidth, TILE_SIZE);\n    // Right grass border\n    ctx.fillRect(TILE_SIZE - grassWidth, 0, grassWidth, TILE_SIZE);\n    \n    ctx.globalAlpha = 1.0;\n    \n    // Add beveled effect within the rounded shape\n    const bevelSize = Math.max(1, TILE_SIZE * 0.06);\n    const inset = grassWidth;\n    \n    // Light highlights (top and left)\n    ctx.fillStyle = 'rgba(200, 212, 220, 0.7)';\n    ctx.fillRect(inset, inset, TILE_SIZE - inset * 2, bevelSize);\n    ctx.fillRect(inset, inset, bevelSize, TILE_SIZE - inset * 2);\n    \n    // Dark shadows (bottom and right)\n    ctx.fillStyle = 'rgba(45, 54, 80, 0.7)';\n    ctx.fillRect(inset, TILE_SIZE - inset - bevelSize, TILE_SIZE - inset * 2, bevelSize);\n    ctx.fillRect(TILE_SIZE - inset - bevelSize, inset, bevelSize, TILE_SIZE - inset * 2);\n    \n    ctx.restore(); // End clipping\n    \n    // Add stretched grass tufts along edges with random variation\n    // Use tile coordinates for consistent but varied seeding\n    const uniqueSeed = (rowIndex * 73 + colIndex * 137 + variation * 211) % 1000;\n    const numGrassTufts = 2 + (uniqueSeed % 3); // 2-4 tufts per tile\n    \n    for (let i = 0; i < numGrassTufts; i++) {\n      const grassSeed = (uniqueSeed + i * 179) % 1000;\n      \n      // Position grass tufts along edges\n      let x, y, isHorizontal;\n      const side = grassSeed % 4;\n      const extensionIntoStone = grassWidth * 2; // Allow tufts to extend into pavement area\n      \n      if (side === 0) { // Top edge - horizontal stretch\n        x = (grassSeed * 0.7) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1; // Stay away from corners\n        y = (grassSeed * 0.3) % (grassWidth + extensionIntoStone);\n        isHorizontal = true;\n      } else if (side === 1) { // Bottom edge - horizontal stretch\n        x = (grassSeed * 0.8) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        y = TILE_SIZE - grassWidth - extensionIntoStone + (grassSeed * 0.4) % (grassWidth + extensionIntoStone);\n        isHorizontal = true;\n      } else if (side === 2) { // Left edge - vertical stretch\n        x = (grassSeed * 0.5) % (grassWidth + extensionIntoStone);\n        y = (grassSeed * 0.9) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        isHorizontal = false;\n      } else { // Right edge - vertical stretch\n        x = TILE_SIZE - grassWidth - extensionIntoStone + (grassSeed * 0.6) % (grassWidth + extensionIntoStone);\n        y = (grassSeed * 1.1) % (TILE_SIZE * 0.8) + TILE_SIZE * 0.1;\n        isHorizontal = false;\n      }\n      \n      // Draw stretched grass along the edge (6 pixels long)\n      const stretchLength = Math.max(4, TILE_SIZE * 0.15); // About 6 pixels at normal size\n      const stretchWidth = Math.max(1, TILE_SIZE * 0.02);\n      \n      ctx.fillStyle = `rgba(19, 100, 19, 0.7)`;\n      ctx.save();\n      ctx.translate(x, y);\n      \n      // Random rotation for natural look\n      const baseRotation = (grassSeed * 0.01) % (Math.PI * 0.3) - Math.PI * 0.15; // 27 degrees\n      ctx.rotate(baseRotation);\n      \n      if (isHorizontal) {\n        // Horizontal grass streak\n        ctx.fillRect(-stretchLength/2, -stretchWidth/2, stretchLength, stretchWidth);\n        \n        // Add some organic variation along the length\n        for (let k = 0; k < 3; k++) {\n          const offset = (k - 1) * stretchLength * 0.3;\n          const size = stretchWidth * (0.5 + (grassSeed + k * 23) % 100 / 200);\n          ctx.beginPath();\n          ctx.ellipse(offset, 0, size, size * 1.5, 0, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      } else {\n        // Vertical grass streak\n        ctx.fillRect(-stretchWidth/2, -stretchLength/2, stretchWidth, stretchLength);\n        \n        // Add some organic variation along the length\n        for (let k = 0; k < 3; k++) {\n          const offset = (k - 1) * stretchLength * 0.3;\n          const size = stretchWidth * (0.5 + (grassSeed + k * 29) % 100 / 200);\n          ctx.beginPath();\n          ctx.ellipse(0, offset, size * 1.5, size, 0, 0, Math.PI * 2);\n          ctx.fill();\n        }\n      }\n      \n      ctx.restore();\n    }\n  }\n\n\n    if (tileType === 's' || tileType === 'x') {\n    // Stone cracks - Y-shaped forking cracks on every 3rd tile\n    const seed = (rowIndex * 73 + colIndex * 137 + variation * 211) % 1000;\n    \n    // Only show cracks on every 3rd tile\n    if (seed % 3 === 0) {\n      const numCracks = 1 + (seed % 2); // 1-2 Y-shaped cracks per tile\n      \n      for (let i = 0; i < numCracks; i++) {\n        const crackSeed = (seed + i * 179) % 1000;\n        const startX = (20 + (crackSeed * 0.6) % 60) / 100 * TILE_SIZE;\n        const startY = (20 + (crackSeed * 1.1) % 60) / 100 * TILE_SIZE;\n        \n        ctx.save();\n        ctx.strokeStyle = `rgba(89, 93, 98, 0.7)`;\n        ctx.lineWidth = Math.max(1, TILE_SIZE * 0.008);\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        \n        // Helper function to draw a wiggly line from start to end\n        const drawWigglyLine = (fromX, fromY, toX, toY, wiggleAmount = 0.3) => {\n          const distance = Math.sqrt((toX - fromX) ** 2 + (toY - fromY) ** 2);\n          const segments = Math.max(4, Math.floor(distance / (TILE_SIZE * 0.05))); // Segment every 5% of tile size\n          \n          ctx.moveTo(fromX, fromY);\n          \n          for (let j = 1; j <= segments; j++) {\n            const progress = j / segments;\n            const linearX = fromX + (toX - fromX) * progress;\n            const linearY = fromY + (toY - fromY) * progress;\n            \n            // Add perpendicular wiggle\n            const perpAngle = Math.atan2(toY - fromY, toX - fromX) + Math.PI / 2;\n            const wiggleSeed = (crackSeed + j * 23 + i * 67) % 1000;\n            const wiggleOffset = Math.sin(progress * Math.PI * 2) * wiggleAmount * TILE_SIZE * 0.02;\n            const randomWiggle = ((wiggleSeed * 0.1) % 1 - 0.5) * wiggleAmount * TILE_SIZE * 0.015;\n            \n            const wiggleX = linearX + Math.cos(perpAngle) * (wiggleOffset + randomWiggle);\n            const wiggleY = linearY + Math.sin(perpAngle) * (wiggleOffset + randomWiggle);\n            \n            ctx.lineTo(wiggleX, wiggleY);\n          }\n        };\n        \n        // Main crack stem\n        const mainLength = TILE_SIZE * 0.15 + (crackSeed * 0.01) % (TILE_SIZE * 0.1);\n        const mainAngle = (crackSeed * 0.8) % 360 * Math.PI / 180;\n        const stemEndX = startX + Math.cos(mainAngle) * mainLength;\n        const stemEndY = startY + Math.sin(mainAngle) * mainLength;\n        \n        ctx.beginPath();\n        drawWigglyLine(startX, startY, stemEndX, stemEndY);\n        ctx.stroke();\n        \n        // Fork point - slightly before the end of main stem\n        const forkProgress = 0.6 + (crackSeed * 0.01) % 0.3; // Fork at 60-90% along stem\n        const forkX = startX + Math.cos(mainAngle) * mainLength * forkProgress;\n        const forkY = startY + Math.sin(mainAngle) * mainLength * forkProgress;\n        \n        // Two fork branches\n        const forkLength = mainLength * (0.4 + (crackSeed * 0.01) % 0.3); // 40-70% of main length\n        const forkAngleSpread = 30 + (crackSeed % 40); // 30-70 degree spread\n        \n        // Left fork\n        const leftForkAngle = mainAngle - (forkAngleSpread * Math.PI / 180);\n        const leftEndX = forkX + Math.cos(leftForkAngle) * forkLength;\n        const leftEndY = forkY + Math.sin(leftForkAngle) * forkLength;\n        \n        ctx.beginPath();\n        drawWigglyLine(forkX, forkY, leftEndX, leftEndY, 0.2); // Less wiggle on forks\n        ctx.stroke();\n        \n        // Right fork\n        const rightForkAngle = mainAngle + (forkAngleSpread * Math.PI / 180);\n        const rightEndX = forkX + Math.cos(rightForkAngle) * forkLength;\n        const rightEndY = forkY + Math.sin(rightForkAngle) * forkLength;\n        \n        ctx.beginPath();\n        drawWigglyLine(forkX, forkY, rightEndX, rightEndY, 0.2); // Less wiggle on forks\n        ctx.stroke();\n        \n        ctx.restore(); \n      }\n    }\n  }\n\n    return canvas;\n}\n\n// Canvas-based tile renderer component\nexport const RenderTilesCanvas = ({ grid, tileTypes, TILE_SIZE, zoomLevel, handleTileClick }) => {\n  const canvasRef = useRef(null);\n  const textureCache = useRef(new Map());\n  const lastRenderData = useRef(null);\n  \n  // Clear texture cache when TILE_SIZE or zoomLevel changes\n  useEffect(() => {\n    textureCache.current.clear();\n  }, [TILE_SIZE, zoomLevel]);\n  \n  // Get or create tile texture with variation\n  const getTileTexture = useCallback((tileType, rowIndex, colIndex) => {\n    // Create 4 variations for grass, dirt, and stone; 1 for others (only for close zoom)\n    const numVariations = (zoomLevel === 'far') ? 1 : \n                          ((tileType === 'g' || tileType === 'd' || tileType === 's') ? 4 : 1);\n    const variation = (rowIndex * 73 + colIndex * 37) % numVariations;\n    const cacheKey = `${tileType}-${TILE_SIZE}-${zoomLevel}-${variation}-${rowIndex}-${colIndex}`;\n    \n    if (!textureCache.current.has(cacheKey)) {\n      textureCache.current.set(cacheKey, createTileTexture(tileType, TILE_SIZE, variation, rowIndex, colIndex, tileTypes, zoomLevel));\n    }\n    return textureCache.current.get(cacheKey);\n  }, [TILE_SIZE, tileTypes, zoomLevel]);\n  \n  // Render tiles to canvas\n  const renderTiles = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !grid || !tileTypes) {\n      return;\n    }\n\n    const ctx = canvas.getContext('2d');\n    const rows = grid.length;\n    const cols = grid[0]?.length || 0;\n\n    // Set canvas size\n    canvas.width = cols * TILE_SIZE;\n    canvas.height = rows * TILE_SIZE;\n\n    // Clear canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Render each tile\n    for (let rowIndex = 0; rowIndex < rows; rowIndex++) {\n      for (let colIndex = 0; colIndex < cols; colIndex++) {\n        const tileType = tileTypes[rowIndex]?.[colIndex] || 'unknown';\n        const texture = getTileTexture(tileType, rowIndex, colIndex);\n\n        ctx.drawImage(\n          texture,\n          colIndex * TILE_SIZE,\n          rowIndex * TILE_SIZE,\n          TILE_SIZE,\n          TILE_SIZE\n        );\n      }\n    }\n  }, [grid, tileTypes, TILE_SIZE, getTileTexture]);\n\n  // Re-render when dependencies change\n  useEffect(() => {\n    const currentData = JSON.stringify({ grid, tileTypes, TILE_SIZE, zoomLevel });\n    if (currentData !== lastRenderData.current) {\n      renderTiles();\n      lastRenderData.current = currentData;\n    }\n  }, [renderTiles, grid, tileTypes, TILE_SIZE, zoomLevel]);\n\n  // Handle tile clicks by converting canvas coordinates\n  const handleCanvasClick = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas || !handleTileClick) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n\n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n\n    if (rowIndex >= 0 && rowIndex < grid.length &&\n        colIndex >= 0 && colIndex < (grid[0]?.length || 0)) {\n      handleTileClick(rowIndex, colIndex);\n    }\n  }, [handleTileClick, TILE_SIZE, grid]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 1, // Same as DOM tiles\n        cursor: 'pointer',\n        imageRendering: 'pixelated', // Keep crisp pixel art look\n      }}\n    />\n  );\n};","/**\n * RenderTilesCanvasV2 - Autotiling Renderer with Grass Overlay\n *\n * Key insight from reference: Grass is the TOP layer that overlays onto other tiles.\n * The grass \"grows over\" the edges of dirt/sand/water, not the other way around.\n */\n\nimport React, { useRef, useEffect, useCallback } from 'react';\nimport { getTileColor } from '../UI/Styles/tileColors';\n\n// Corner rounding priority - higher priority tiles round INTO lower priority tiles\n// Inorganic tiles (p, x, y) never get rounded - they have sharp edges\n// Priority order: grass > snow > dirt/sand > water (lowest)\nconst CORNER_PRIORITY = {\n  'g': 100,  // grass - highest priority, rounds into everything\n  'o': 90,   // snow - second highest\n  'z': 80,   // moss\n  'n': 70,   // sand\n  'd': 60,   // dirt\n  'c': 50,   // clay\n  's': 40,   // slate\n  'l': 30,   // lava\n  'w': 20,   // water - lowest organic priority\n  'v': 15,   // tbdTile1\n  'u': 15,   // tbdTile2\n  'p': 0,    // pavement - inorganic, never rounded\n  'x': 0,    // cobblestone - inorganic, never rounded\n  'y': 0,    // dungeon - inorganic, never rounded\n};\n\n// Tile priority - higher priority tiles overlay lower priority ones\n// Grass is highest priority (renders on top)\nconst TILE_PRIORITY = {\n  'g': 10,  // grass - highest, overlays everything\n  'z': 9,   // moss\n  'o': 8,   // snow\n  'n': 7,   // sand\n  'd': 6,   // dirt\n  'c': 5,   // clay\n  's': 4,   // slate\n  'w': 3,   // water\n  'l': 2,   // lava\n  'p': 1,   // pavement\n  'x': 1,   // cobblestone\n  'y': 1,   // dungeon\n  'v': 1,   // tbdTile1\n  'u': 1,   // tbdTile2\n};\n\n// Tile edge style - organic tiles get smooth wavy edges, inorganic get straight edges\n// Organic tiles create natural-looking transitions with other organic tiles\nconst TILE_EDGE_STYLE = {\n  'g': 'organic',   // grass\n  'z': 'organic',   // moss\n  'o': 'organic',   // snow\n  'n': 'organic',   // sand\n  'd': 'organic',   // dirt\n  'c': 'organic',   // clay\n  's': 'organic',   // slate\n  'w': 'organic',   // water\n  'l': 'organic',   // lava\n  'p': 'straight',  // pavement\n  'x': 'straight',  // cobblestone\n  'y': 'straight',  // dungeon\n  'v': 'organic',   // tbdTile1\n  'u': 'organic',   // tbdTile2\n};\n\n// Helper to check if a tile type uses organic edges (kept for future use)\nfunction isOrganicTile(tileType) {\n  return TILE_EDGE_STYLE[tileType] === 'organic';\n}\n\n/**\n * Get neighbor tile type safely\n */\nfunction getNeighbor(tileTypes, row, col, defaultType) {\n  return tileTypes[row]?.[col] ?? defaultType;\n}\n\n/**\n * Draw rounded corners where higher-priority tiles meet lower-priority tiles.\n * The higher-priority tile's color rounds INTO the lower-priority tile.\n * Inorganic tiles (pavement, cobblestone, dungeon) never get rounded.\n */\nfunction drawCornerRounding(ctx, tileType, TILE_SIZE, rowIndex, colIndex, tileTypes) {\n  // Inorganic tiles never get rounded corners\n  if (!isOrganicTile(tileType)) return;\n\n  const myPriority = CORNER_PRIORITY[tileType] || 0;\n  const cornerRadius = Math.max(2, Math.floor(TILE_SIZE * 0.2));\n\n  // Get all 8 neighbors\n  const top = getNeighbor(tileTypes, rowIndex - 1, colIndex, tileType);\n  const bottom = getNeighbor(tileTypes, rowIndex + 1, colIndex, tileType);\n  const left = getNeighbor(tileTypes, rowIndex, colIndex - 1, tileType);\n  const right = getNeighbor(tileTypes, rowIndex, colIndex + 1, tileType);\n  const topLeft = getNeighbor(tileTypes, rowIndex - 1, colIndex - 1, tileType);\n  const topRight = getNeighbor(tileTypes, rowIndex - 1, colIndex + 1, tileType);\n  const bottomLeft = getNeighbor(tileTypes, rowIndex + 1, colIndex - 1, tileType);\n  const bottomRight = getNeighbor(tileTypes, rowIndex + 1, colIndex + 1, tileType);\n\n  // Helper to draw an OUTER corner - small triangular fill in the corner\n  // Used when both cardinal neighbors are the same type (different from this tile)\n  const drawOuterCorner = (corner, fillColor) => {\n    ctx.fillStyle = fillColor;\n    ctx.beginPath();\n\n    switch (corner) {\n      case 'topLeft':\n        ctx.moveTo(0, 0);\n        ctx.lineTo(cornerRadius, 0);\n        ctx.quadraticCurveTo(0, 0, 0, cornerRadius);\n        ctx.closePath();\n        break;\n      case 'topRight':\n        ctx.moveTo(TILE_SIZE - cornerRadius, 0);\n        ctx.lineTo(TILE_SIZE, 0);\n        ctx.lineTo(TILE_SIZE, cornerRadius);\n        ctx.quadraticCurveTo(TILE_SIZE, 0, TILE_SIZE - cornerRadius, 0);\n        ctx.closePath();\n        break;\n      case 'bottomLeft':\n        ctx.moveTo(0, TILE_SIZE - cornerRadius);\n        ctx.lineTo(0, TILE_SIZE);\n        ctx.lineTo(cornerRadius, TILE_SIZE);\n        ctx.quadraticCurveTo(0, TILE_SIZE, 0, TILE_SIZE - cornerRadius);\n        ctx.closePath();\n        break;\n      case 'bottomRight':\n        ctx.moveTo(TILE_SIZE, TILE_SIZE - cornerRadius);\n        ctx.lineTo(TILE_SIZE, TILE_SIZE);\n        ctx.lineTo(TILE_SIZE - cornerRadius, TILE_SIZE);\n        ctx.quadraticCurveTo(TILE_SIZE, TILE_SIZE, TILE_SIZE, TILE_SIZE - cornerRadius);\n        ctx.closePath();\n        break;\n    }\n    ctx.fill();\n  };\n\n  // Corner rounding logic:\n  // 1. SURROUNDED CORNERS: If all 3 neighbors (both cardinals + diagonal) are the same different type,\n  //    that type ALWAYS wins regardless of priority (the surrounding tile rounds into this corner)\n  // 2. OUTER CORNERS: If both cardinals are the same different type (but diagonal differs or matches),\n  //    use normal priority to determine if we round\n\n  // Top-left corner\n  if (top !== tileType && left !== tileType && top === left) {\n    // Both cardinals are the same different type\n    const neighborPriority = CORNER_PRIORITY[top] || 0;\n    // Surrounded: all 3 neighbors match AND they're organic - always round regardless of priority\n    // Outer: only cardinals match - use priority\n    const isSurrounded = topLeft === top && isOrganicTile(top);\n    if (isSurrounded || neighborPriority > myPriority) {\n      drawOuterCorner('topLeft', getTileColor(top));\n    }\n  }\n\n  // Top-right corner\n  if (top !== tileType && right !== tileType && top === right) {\n    const neighborPriority = CORNER_PRIORITY[top] || 0;\n    const isSurrounded = topRight === top && isOrganicTile(top);\n    if (isSurrounded || neighborPriority > myPriority) {\n      drawOuterCorner('topRight', getTileColor(top));\n    }\n  }\n\n  // Bottom-left corner\n  if (bottom !== tileType && left !== tileType && bottom === left) {\n    const neighborPriority = CORNER_PRIORITY[bottom] || 0;\n    const isSurrounded = bottomLeft === bottom && isOrganicTile(bottom);\n    if (isSurrounded || neighborPriority > myPriority) {\n      drawOuterCorner('bottomLeft', getTileColor(bottom));\n    }\n  }\n\n  // Bottom-right corner\n  if (bottom !== tileType && right !== tileType && bottom === right) {\n    const neighborPriority = CORNER_PRIORITY[bottom] || 0;\n    const isSurrounded = bottomRight === bottom && isOrganicTile(bottom);\n    if (isSurrounded || neighborPriority > myPriority) {\n      drawOuterCorner('bottomRight', getTileColor(bottom));\n    }\n  }\n}\n\n\n/**\n * Draw a single beveled stone with highlight and shadow\n */\nfunction drawSingleBeveledStone(ctx, x, y, width, height, bevelSize, mainColor, highlightColor, shadowColor) {\n  // Draw main stone body\n  ctx.fillStyle = mainColor;\n  ctx.fillRect(x, y, width, height);\n\n  // Draw highlight (top and left edges)\n  ctx.fillStyle = highlightColor;\n  ctx.fillRect(x, y, width, bevelSize); // Top\n  ctx.fillRect(x, y, bevelSize, height); // Left\n\n  // Draw shadow (bottom and right edges)\n  ctx.fillStyle = shadowColor;\n  ctx.fillRect(x, y + height - bevelSize, width, bevelSize); // Bottom\n  ctx.fillRect(x + width - bevelSize, y, bevelSize, height); // Right\n}\n\n/**\n * Draw a beveled stone tile (for pavement and cobblestone)\n * Pavement: single stone per tile\n * Cobblestone: 4 stones per tile (2x2 grid)\n */\nfunction drawBeveledStoneTile(ctx, tileX, tileY, TILE_SIZE, baseColor, tileType, seed) {\n  if (tileType === 'x') {\n    // COBBLESTONE: 4 stones per tile (2x2 grid), no gap between tiles\n    const halfSize = TILE_SIZE / 2;\n    const bevelSize = Math.max(1, Math.floor(halfSize * 0.12));\n    const highlightColor = 'rgba(180, 180, 185, 0.7)';\n    const shadowColor = 'rgba(90, 90, 95, 0.5)';\n\n    // Draw 4 cobblestones in a 2x2 grid\n    const positions = [\n      [0, 0],           // top-left\n      [halfSize, 0],    // top-right\n      [0, halfSize],    // bottom-left\n      [halfSize, halfSize] // bottom-right\n    ];\n\n    positions.forEach(([ox, oy], i) => {\n      const stoneSeed = (seed + i * 37) % 1000;\n      // Slight color variation per stone\n      const colorVariation = (stoneSeed % 20) - 10;\n      const r = Math.min(255, Math.max(0, 149 + colorVariation));\n      const g = Math.min(255, Math.max(0, 155 + colorVariation));\n      const b = Math.min(255, Math.max(0, 163 + colorVariation));\n      const stoneColor = `rgb(${r}, ${g}, ${b})`;\n\n      drawSingleBeveledStone(\n        ctx,\n        tileX + ox,\n        tileY + oy,\n        halfSize,\n        halfSize,\n        bevelSize,\n        stoneColor,\n        highlightColor,\n        shadowColor\n      );\n\n      // Add occasional crack to individual cobblestones\n      if (stoneSeed % 3 === 0) {\n        ctx.strokeStyle = 'rgba(60, 60, 65, 0.3)';\n        ctx.lineWidth = 1;\n        const crackStartX = tileX + ox + bevelSize + (stoneSeed % 30) / 100 * (halfSize - bevelSize * 2);\n        const crackStartY = tileY + oy + bevelSize + ((stoneSeed * 1.3) % 30) / 100 * (halfSize - bevelSize * 2);\n        const crackEndX = crackStartX + (stoneSeed % 20 - 10) / 100 * halfSize * 0.5;\n        const crackEndY = crackStartY + ((stoneSeed * 0.7) % 20) / 100 * halfSize * 0.5;\n\n        ctx.beginPath();\n        ctx.moveTo(crackStartX, crackStartY);\n        ctx.lineTo(crackEndX, crackEndY);\n        ctx.stroke();\n      }\n    });\n  } else {\n    // PAVEMENT: single stone per tile, no gap\n    const bevelSize = Math.max(2, Math.floor(TILE_SIZE * 0.08));\n    const highlightColor = 'rgba(220, 200, 160, 0.5)';\n    const shadowColor = 'rgba(160, 140, 100, 0.6)';\n\n    drawSingleBeveledStone(\n      ctx,\n      tileX,\n      tileY,\n      TILE_SIZE,\n      TILE_SIZE,\n      bevelSize,\n      baseColor,\n      highlightColor,\n      shadowColor\n    );\n  }\n\n  // Add tiny grass tufts at edges for pavement\n  // Very small, right at the edge - like in Screenshot2_original\n  // Using dark grass color (same as grass tuft spots): rgba(0, 50, 0, opacity)\n  if (tileType === 'p' && seed % 5 < 3) {\n    // ~60% of pavement tiles get grass tufts (was 50%)\n    const tuftSeed = (seed * 3) % 1000;\n    // Medium grass green - between bright #67c257 and dark rgba(0,50,0)\n    const grassDark = 'rgba(50, 130, 50, 0.85)';\n\n    // 1-2 tiny tufts per tile\n    const tuftCount = 1 + (tuftSeed % 2);\n\n    for (let t = 0; t < tuftCount; t++) {\n      // Use a different prime multiplier for edge selection to get better distribution\n      const edge = (seed * 7 + t * 41) % 4;\n      const tSeed = (tuftSeed + t * 100) % 1000;\n      const edgePos = (0.2 + (tSeed % 60) / 100) * TILE_SIZE;\n\n      // Tuft is just 2-3 tiny triangles right at the edge\n      const bladeCount = 2 + (tSeed % 2);\n      const bladeSpacing = TILE_SIZE * 0.064; // 60% wider spacing along edge (was 0.04)\n\n      ctx.fillStyle = grassDark;\n\n      for (let b = 0; b < bladeCount; b++) {\n        const bSeed = (tSeed + b * 17) % 100;\n        // Blade height - 4-7% of tile size\n        const h = TILE_SIZE * (0.04 + bSeed / 1500);\n        const w = Math.max(1, TILE_SIZE * 0.04); // Thicker blades (was 0.026)\n\n        let x, y;\n        switch (edge) {\n          case 0: // top\n            x = tileX + edgePos + b * bladeSpacing;\n            y = tileY;\n            ctx.beginPath();\n            ctx.moveTo(x - w, y);\n            ctx.lineTo(x, y + h);\n            ctx.lineTo(x + w, y);\n            ctx.closePath();\n            ctx.fill();\n            break;\n          case 1: // right\n            x = tileX + TILE_SIZE;\n            y = tileY + edgePos + b * bladeSpacing;\n            ctx.beginPath();\n            ctx.moveTo(x, y - w);\n            ctx.lineTo(x - h, y);\n            ctx.lineTo(x, y + w);\n            ctx.closePath();\n            ctx.fill();\n            break;\n          case 2: // bottom\n            x = tileX + edgePos + b * bladeSpacing;\n            y = tileY + TILE_SIZE;\n            ctx.beginPath();\n            ctx.moveTo(x - w, y);\n            ctx.lineTo(x, y - h);\n            ctx.lineTo(x + w, y);\n            ctx.closePath();\n            ctx.fill();\n            break;\n          case 3: // left\n            x = tileX;\n            y = tileY + edgePos + b * bladeSpacing;\n            ctx.beginPath();\n            ctx.moveTo(x, y - w);\n            ctx.lineTo(x + h, y);\n            ctx.lineTo(x, y + w);\n            ctx.closePath();\n            ctx.fill();\n            break;\n        }\n      }\n    }\n  }\n}\n\n/**\n * Draw a single grass tuft - irregular clump shape (from V1)\n */\nfunction drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE) {\n  const size = Math.max(1, TILE_SIZE * 0.08 + (tuftSeed * 0.01) % (TILE_SIZE * 0.04));\n  const opacity = 0.15 + (tuftSeed * 0.01) % 0.1;\n\n  ctx.save();\n  ctx.translate(x, y);\n  ctx.rotate((tuftSeed * 0.5) % 60 - 30);\n  ctx.fillStyle = `rgba(0, 50, 0, ${opacity})`;\n\n  // Draw irregular grass clump using path\n  ctx.beginPath();\n  const points = [\n    [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n    [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n  ];\n\n  points.forEach(([px, py], index) => {\n    const drawX = px * size - size / 2;\n    const drawY = py * size - size / 2;\n    if (index === 0) ctx.moveTo(drawX, drawY);\n    else ctx.lineTo(drawX, drawY);\n  });\n  ctx.closePath();\n  ctx.fill();\n  ctx.restore();\n}\n\n/**\n * Add subtle texture variation to tiles\n */\nfunction addTileTexture(ctx, tileType, tileX, tileY, TILE_SIZE, seed) {\n  if (tileType === 'g') {\n    // Grass tufts - replicate V1 logic with 4 variations\n    const variation = seed % 4;\n    const baseSeeds = [157, 331, 523, 769];\n    const varSeed = baseSeeds[variation] || 500;\n\n    // Different positioning strategies per variation\n    let positions;\n    if (variation === 0) {\n      positions = [[25, 30], [70, 45], [45, 70]];\n    } else if (variation === 1) {\n      positions = [[20, 20], [75, 25], [30, 75], [80, 80]];\n    } else if (variation === 2) {\n      positions = [[50, 40], [60, 55], [45, 60], [35, 45]];\n    } else {\n      positions = [[40, 35], [65, 60]];\n    }\n\n    positions.forEach(([baseX, baseY], i) => {\n      const tuftSeed = (varSeed + i * 73 + seed * 11) % 1000;\n      const offsetX = (tuftSeed * 0.1) % 20 - 10;\n      const offsetY = (tuftSeed * 0.2) % 20 - 10;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      drawGrassTuft(ctx, x, y, tuftSeed, TILE_SIZE);\n    });\n\n    // Occasional yellow clump - use variation-based positioning to break diagonal patterns\n    // Each variation has different predefined positions spread across the tile\n    const yellowVariation = (seed * 7 + variation * 3) % 8;\n    const yellowPositionSets = [\n      [15, 25], [75, 65], [40, 80], [85, 20], // 4 corner-ish positions\n      [55, 35], [25, 70], [70, 45], [35, 15]  // 4 different positions\n    ];\n\n    // Only ~20% of tiles get yellow clumps, but selection is more random\n    const showYellow = ((seed * 31 + variation * 17) % 100) < 20;\n\n    if (showYellow) {\n      const yellowPos = yellowPositionSets[yellowVariation];\n      // Add small offset based on seed for extra variation\n      const offsetSeed = (seed * 37 + variation * 53) % 1000;\n      const offsetX = (offsetSeed % 20) - 10;\n      const offsetY = ((offsetSeed * 7) % 20) - 10;\n\n      const lightX = tileX + (yellowPos[0] + offsetX) / 100 * TILE_SIZE;\n      const lightY = tileY + (yellowPos[1] + offsetY) / 100 * TILE_SIZE;\n      const lightSize = Math.max(2, TILE_SIZE * 0.12 + (offsetSeed % 40) / 1000 * TILE_SIZE);\n\n      ctx.save();\n      ctx.translate(lightX, lightY);\n      ctx.rotate((offsetSeed * 0.7) % 60 - 30);\n      ctx.fillStyle = 'rgba(220, 220, 40, 0.6)';\n\n      ctx.beginPath();\n      const points = [\n        [0.3, 1], [0, 0.8], [0.1, 0.6], [0, 0.4], [0.15, 0.2],\n        [0.4, 0.3], [0.6, 0.1], [0.8, 0.3], [1, 0.5], [0.85, 0.8], [0.7, 1]\n      ];\n\n      points.forEach(([px, py], index) => {\n        const drawX = px * lightSize - lightSize / 2;\n        const drawY = py * lightSize - lightSize / 2;\n        if (index === 0) ctx.moveTo(drawX, drawY);\n        else ctx.lineTo(drawX, drawY);\n      });\n      ctx.closePath();\n      ctx.fill();\n      ctx.restore();\n    }\n  } else if (tileType === 'd') {\n    // Dirt noise - small scattered dots like grass tufts but smaller\n    // Use variation-based positioning like grass for better randomization\n    const variation = seed % 4;\n    const baseSeeds = [173, 349, 541, 797]; // Different primes than grass\n    const varSeed = baseSeeds[variation] || 500;\n\n    // Darker specks - scattered positions\n    const darkPositions = [\n      [15, 25], [45, 15], [75, 35], [25, 55], [55, 45],\n      [85, 65], [35, 85], [65, 75], [20, 70], [80, 20]\n    ];\n\n    ctx.fillStyle = 'rgba(60, 35, 20, 0.35)';\n    darkPositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 73 + seed * 13) % 1000;\n      const offsetX = (dotSeed * 0.15) % 20 - 10;\n      const offsetY = ((dotSeed * 0.23) % 20) - 10;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(0.8, TILE_SIZE * (0.012 + (dotSeed % 8) / 2000));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Lighter specks - different scattered positions\n    const lightPositions = [\n      [30, 20], [60, 40], [20, 60], [70, 80], [50, 70], [85, 45]\n    ];\n\n    ctx.fillStyle = 'rgba(130, 95, 60, 0.25)';\n    lightPositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 89 + seed * 17 + 300) % 1000;\n      const offsetX = (dotSeed * 0.18) % 18 - 9;\n      const offsetY = ((dotSeed * 0.27) % 18) - 9;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(0.6, TILE_SIZE * (0.01 + (dotSeed % 6) / 2000));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Occasional tiny pebble/rock\n    if (seed % 4 === 0) {\n      const pebbleSeed = (varSeed + seed * 1.5) % 1000;\n      const px = tileX + (20 + (pebbleSeed * 0.6) % 60) / 100 * TILE_SIZE;\n      const py = tileY + (20 + (pebbleSeed * 0.8) % 60) / 100 * TILE_SIZE;\n      const psize = Math.max(1.5, TILE_SIZE * 0.02);\n\n      ctx.fillStyle = 'rgba(90, 70, 50, 0.3)';\n      ctx.beginPath();\n      ctx.arc(px, py, psize, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  } else if (tileType === 'n') {\n    // Sand noise - small scattered dots like dirt but dark yellow\n    // Use variation-based positioning like grass/dirt for better randomization\n    const variation = seed % 4;\n    const baseSeeds = [191, 373, 557, 811]; // Different primes than dirt/grass\n    const varSeed = baseSeeds[variation] || 500;\n\n    // Darker sand specks - scattered positions\n    const darkPositions = [\n      [20, 30], [50, 20], [80, 40], [30, 60], [60, 50],\n      [90, 70], [40, 80], [70, 70], [25, 75], [75, 25]\n    ];\n\n    ctx.fillStyle = 'rgba(140, 110, 20, 0.4)'; // Dark yellow\n    darkPositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 79 + seed * 11) % 1000;\n      const offsetX = (dotSeed * 0.15) % 20 - 10;\n      const offsetY = ((dotSeed * 0.23) % 20) - 10;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(0.8, TILE_SIZE * (0.012 + (dotSeed % 8) / 2000));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Lighter sand specks - different scattered positions\n    const lightPositions = [\n      [35, 25], [65, 45], [25, 65], [75, 85], [55, 75], [80, 40]\n    ];\n\n    ctx.fillStyle = 'rgba(160, 130, 50, 0.3)'; // Lighter yellow\n    lightPositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 83 + seed * 19 + 400) % 1000;\n      const offsetX = (dotSeed * 0.18) % 18 - 9;\n      const offsetY = ((dotSeed * 0.27) % 18) - 9;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(0.6, TILE_SIZE * (0.01 + (dotSeed % 6) / 2000));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Occasional tiny shell/pebble\n    if (seed % 5 === 0) {\n      const shellSeed = (varSeed + seed * 1.7) % 1000;\n      const sx = tileX + (20 + (shellSeed * 0.6) % 60) / 100 * TILE_SIZE;\n      const sy = tileY + (20 + (shellSeed * 0.8) % 60) / 100 * TILE_SIZE;\n      const ssize = Math.max(1.5, TILE_SIZE * 0.02);\n\n      ctx.fillStyle = 'rgba(220, 200, 150, 0.35)';\n      ctx.beginPath();\n      ctx.arc(sx, sy, ssize, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  } else if (tileType === 's') {\n    // Slate cracks - organic, Y-shaped branching fracture patterns\n    // ~48% of tiles get cracks\n    if (seed % 100 < 48) {\n      const crackSeed = (seed * 3) % 1000;\n\n      // Slate crack colors - darker than the base slate\n      const crackColor = 'rgba(70, 80, 90, 0.6)';\n      const crackHighlight = 'rgba(120, 130, 140, 0.3)';\n\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n\n      // Helper to draw organic crack segment with bezier curves\n      const drawCrackSegment = (startX, startY, endX, endY, width, segSeed) => {\n        // Calculate control points for natural curve\n        const midX = (startX + endX) / 2;\n        const midY = (startY + endY) / 2;\n        const perpAngle = Math.atan2(endY - startY, endX - startX) + Math.PI / 2;\n        const bulge = ((segSeed % 60) - 30) / 100 * TILE_SIZE * 0.05;\n\n        const ctrlX = midX + Math.cos(perpAngle) * bulge;\n        const ctrlY = midY + Math.sin(perpAngle) * bulge;\n\n        // Draw shadow/depth line first (offset slightly)\n        ctx.strokeStyle = crackColor;\n        ctx.lineWidth = width;\n        ctx.beginPath();\n        ctx.moveTo(startX, startY);\n        ctx.quadraticCurveTo(ctrlX, ctrlY, endX, endY);\n        ctx.stroke();\n\n        // Draw highlight on one edge for depth\n        ctx.strokeStyle = crackHighlight;\n        ctx.lineWidth = Math.max(0.5, width * 0.4);\n        ctx.beginPath();\n        ctx.moveTo(startX + 0.5, startY + 0.5);\n        ctx.quadraticCurveTo(ctrlX + 0.5, ctrlY + 0.5, endX + 0.5, endY + 0.5);\n        ctx.stroke();\n      };\n\n      // Number of main cracks (1-2)\n      const numCracks = 1 + (crackSeed % 2);\n\n      for (let c = 0; c < numCracks; c++) {\n        const cSeed = (crackSeed + c * 137) % 1000;\n\n        // Start point - mostly interior, occasionally from edges\n        let startX, startY;\n        const startEdge = cSeed % 6; // 0-3 = edges, 4-5 = interior (more interior starts)\n        if (startEdge === 0) {\n          startX = tileX;\n          startY = tileY + (cSeed % 80 + 10) / 100 * TILE_SIZE;\n        } else if (startEdge === 1) {\n          startX = tileX + TILE_SIZE;\n          startY = tileY + ((cSeed * 1.3) % 80 + 10) / 100 * TILE_SIZE;\n        } else if (startEdge === 2) {\n          startX = tileX + (cSeed % 80 + 10) / 100 * TILE_SIZE;\n          startY = tileY;\n        } else if (startEdge === 3) {\n          startX = tileX + ((cSeed * 1.5) % 80 + 10) / 100 * TILE_SIZE;\n          startY = tileY + TILE_SIZE;\n        } else {\n          startX = tileX + (25 + cSeed % 50) / 100 * TILE_SIZE;\n          startY = tileY + (25 + (cSeed * 1.2) % 50) / 100 * TILE_SIZE;\n        }\n\n        // Main crack direction and length - SHORTER\n        const mainAngle = (cSeed * 0.8) % (Math.PI * 2);\n        const mainLength = TILE_SIZE * (0.15 + (cSeed % 25) / 100); // Shorter: 15-40% of tile\n        const mainWidth = Math.max(1, TILE_SIZE * 0.012);\n\n        // Draw main stem (shorter, 2-3 segments)\n        const segments = 2 + (cSeed % 2);\n        let prevX = startX;\n        let prevY = startY;\n        let forkX = startX;\n        let forkY = startY;\n        let forkAngle = mainAngle;\n\n        for (let s = 0; s < segments; s++) {\n          const progress = (s + 1) / segments;\n          const segSeed = (cSeed + s * 47) % 1000;\n\n          // Add variation to angle\n          const angleVar = ((segSeed % 30) - 15) / 180 * Math.PI;\n          const segAngle = mainAngle + angleVar;\n\n          const segLength = mainLength / segments;\n          const nextX = prevX + Math.cos(segAngle) * segLength;\n          const nextY = prevY + Math.sin(segAngle) * segLength;\n\n          // Crack gets thinner as it goes\n          const segWidth = mainWidth * (1 - progress * 0.3);\n\n          drawCrackSegment(prevX, prevY, nextX, nextY, segWidth, segSeed);\n\n          // Save fork point (around 50-70% along the stem)\n          if (s === Math.floor(segments * 0.5)) {\n            forkX = nextX;\n            forkY = nextY;\n            forkAngle = segAngle;\n          }\n\n          prevX = nextX;\n          prevY = nextY;\n        }\n\n        // Y-BRANCH: Most cracks fork into Y shape\n        if (cSeed % 3 !== 0) { // ~67% get Y-fork\n          const forkSpread = (25 + cSeed % 35) * Math.PI / 180; // 25-60 degree spread\n          const branchLength = mainLength * (0.3 + (cSeed % 20) / 100); // 30-50% of main length\n\n          // Left branch of Y\n          const leftAngle = forkAngle - forkSpread;\n          const leftEndX = forkX + Math.cos(leftAngle) * branchLength;\n          const leftEndY = forkY + Math.sin(leftAngle) * branchLength;\n          drawCrackSegment(forkX, forkY, leftEndX, leftEndY, mainWidth * 0.7, cSeed + 100);\n\n          // Right branch of Y\n          const rightAngle = forkAngle + forkSpread;\n          const rightEndX = forkX + Math.cos(rightAngle) * branchLength;\n          const rightEndY = forkY + Math.sin(rightAngle) * branchLength;\n          drawCrackSegment(forkX, forkY, rightEndX, rightEndY, mainWidth * 0.7, cSeed + 200);\n\n          // Occasional tiny sub-branches on Y tips\n          if (cSeed % 5 === 0) {\n            const subLength = branchLength * 0.4;\n            const subAngle = leftAngle - 20 * Math.PI / 180;\n            drawCrackSegment(leftEndX, leftEndY,\n              leftEndX + Math.cos(subAngle) * subLength,\n              leftEndY + Math.sin(subAngle) * subLength,\n              mainWidth * 0.4, cSeed + 300);\n          }\n        }\n      }\n    }\n\n    // Add subtle surface texture variation\n    const speckCount = 2 + (seed % 3);\n    ctx.fillStyle = 'rgba(100, 110, 120, 0.1)';\n    for (let i = 0; i < speckCount; i++) {\n      const speckSeed = (seed + i * 89) % 1000;\n      const x = tileX + (speckSeed % 90 + 5) / 100 * TILE_SIZE;\n      const y = tileY + ((speckSeed * 1.4) % 90 + 5) / 100 * TILE_SIZE;\n      const size = Math.max(1, TILE_SIZE * 0.03);\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  } else if (tileType === 'o') {\n    // Snow texture - subtle shadows and sparkle highlights\n    // Use variation-based positioning - spread evenly to avoid grid pattern when tiled\n    const variation = seed % 4;\n    const baseSeeds = [197, 389, 571, 827]; // Different primes for snow\n    const varSeed = baseSeeds[variation] || 500;\n\n    // Light shadow blotches - spread across entire tile including edges\n    // Different variations place blotches in different quadrants to break up pattern\n    const shadowPositionSets = [\n      [[10, 15], [85, 40], [45, 90], [60, 5]],   // variation 0: corners/edges\n      [[5, 55], [50, 20], [90, 75], [35, 60]],   // variation 1: different spread\n      [[75, 10], [20, 80], [95, 50], [40, 35]],  // variation 2: opposite corners\n      [[55, 95], [15, 30], [80, 65], [45, 5]]    // variation 3: mixed\n    ];\n    const shadowPositions = shadowPositionSets[variation];\n\n    ctx.fillStyle = 'rgba(220, 230, 240, 0.35)'; // Very light blue-gray, subtle\n    shadowPositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 71 + seed * 17) % 1000;\n      // Smaller offset to keep distribution even\n      const offsetX = (dotSeed * 0.12) % 16 - 8;\n      const offsetY = ((dotSeed * 0.17) % 16) - 8;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      // Bigger blotches\n      const size = Math.max(2, TILE_SIZE * (0.04 + (dotSeed % 10) / 500));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Sparkle highlights - spread across tile\n    const sparklePositionSets = [\n      [[30, 5], [85, 60], [15, 85]],   // variation 0\n      [[70, 15], [10, 50], [55, 80]],  // variation 1\n      [[90, 30], [40, 70], [5, 20]],   // variation 2\n      [[25, 45], [75, 90], [50, 10]]   // variation 3\n    ];\n    const sparklePositions = sparklePositionSets[variation];\n\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.6)'; // Soft white sparkles\n    sparklePositions.forEach(([baseX, baseY], i) => {\n      const dotSeed = (varSeed + i * 97 + seed * 23 + 500) % 1000;\n      const offsetX = (dotSeed * 0.15) % 14 - 7;\n      const offsetY = ((dotSeed * 0.2) % 14) - 7;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(1, TILE_SIZE * (0.015 + (dotSeed % 5) / 1500));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Occasional larger snow drift shadow - position varies by seed\n    if (seed % 6 === 0) {\n      const driftSeed = (varSeed + seed * 1.9) % 1000;\n      // Full range positioning including edges\n      const dx = tileX + (5 + (driftSeed * 0.9) % 90) / 100 * TILE_SIZE;\n      const dy = tileY + (5 + (driftSeed * 1.1) % 90) / 100 * TILE_SIZE;\n      const dsize = Math.max(3, TILE_SIZE * 0.06);\n\n      ctx.fillStyle = 'rgba(230, 238, 245, 0.3)'; // Very light, almost white\n      ctx.beginPath();\n      ctx.arc(dx, dy, dsize, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  } else if (tileType === 'z') {\n    // Moss texture - bigger clumps than grass with yellow and lighter green highlights\n    const variation = seed % 4;\n    const baseSeeds = [163, 337, 509, 733]; // Different primes for moss\n    const varSeed = baseSeeds[variation] || 500;\n\n    // Big fluffy moss clumps - more positions and larger than grass\n    const clumpPositionSets = [\n      [[20, 25], [65, 35], [35, 70], [80, 75], [50, 50]],\n      [[15, 50], [55, 20], [85, 55], [40, 85], [70, 70]],\n      [[30, 15], [75, 45], [20, 75], [60, 65], [45, 40]],\n      [[45, 25], [80, 30], [25, 60], [65, 80], [15, 35]]\n    ];\n    const clumpPositions = clumpPositionSets[variation];\n\n    // Draw moss clumps - lighter green organic shapes\n    clumpPositions.forEach(([baseX, baseY], i) => {\n      const clumpSeed = (varSeed + i * 67 + seed * 13) % 1000;\n      const offsetX = (clumpSeed * 0.15) % 20 - 10;\n      const offsetY = ((clumpSeed * 0.2) % 20) - 10;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      // Bigger clumps than grass (1.5x-2x size)\n      const clumpSize = Math.max(3, TILE_SIZE * (0.08 + (clumpSeed % 40) / 500));\n\n      // Lighter moss green color\n      ctx.fillStyle = 'rgba(45, 140, 55, 0.5)';\n\n      // Draw irregular clump shape\n      ctx.beginPath();\n      const points = 6 + (clumpSeed % 3);\n      for (let p = 0; p < points; p++) {\n        const angle = (p / points) * Math.PI * 2;\n        const radiusVariation = 0.6 + ((clumpSeed * (p + 1)) % 100) / 250;\n        const px = x + Math.cos(angle) * clumpSize * radiusVariation;\n        const py = y + Math.sin(angle) * clumpSize * radiusVariation;\n        if (p === 0) ctx.moveTo(px, py);\n        else ctx.lineTo(px, py);\n      }\n      ctx.closePath();\n      ctx.fill();\n    });\n\n    // Yellow-green highlight clumps - more frequent than grass (40% of tiles)\n    const yellowPositionSets = [\n      [[25, 40], [70, 25], [45, 80]],\n      [[60, 50], [20, 70], [80, 15]],\n      [[35, 30], [75, 70], [15, 55]],\n      [[50, 15], [30, 85], [85, 45]]\n    ];\n    const yellowPositions = yellowPositionSets[variation];\n\n    const showYellow = ((seed * 29 + variation * 13) % 100) < 40;\n    if (showYellow) {\n      yellowPositions.forEach(([baseX, baseY], i) => {\n        const yellowSeed = (varSeed + i * 83 + seed * 19 + 400) % 1000;\n        const offsetX = (yellowSeed * 0.12) % 16 - 8;\n        const offsetY = ((yellowSeed * 0.18) % 16) - 8;\n        const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n        const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n        const size = Math.max(2, TILE_SIZE * (0.06 + (yellowSeed % 30) / 600));\n\n        // Yellow-green color\n        ctx.fillStyle = 'rgba(180, 200, 50, 0.55)';\n\n        // Irregular blob shape\n        ctx.beginPath();\n        const points = 5 + (yellowSeed % 2);\n        for (let p = 0; p < points; p++) {\n          const angle = (p / points) * Math.PI * 2;\n          const radiusVariation = 0.7 + ((yellowSeed * (p + 2)) % 100) / 300;\n          const px = x + Math.cos(angle) * size * radiusVariation;\n          const py = y + Math.sin(angle) * size * radiusVariation;\n          if (p === 0) ctx.moveTo(px, py);\n          else ctx.lineTo(px, py);\n        }\n        ctx.closePath();\n        ctx.fill();\n      });\n    }\n\n    // Bright green accent spots - small highlights\n    const accentPositionSets = [\n      [[40, 55], [75, 85]],\n      [[30, 40], [85, 25]],\n      [[55, 75], [15, 20]],\n      [[70, 50], [25, 80]]\n    ];\n    const accentPositions = accentPositionSets[variation];\n\n    ctx.fillStyle = 'rgba(100, 180, 80, 0.4)';\n    accentPositions.forEach(([baseX, baseY], i) => {\n      const accentSeed = (varSeed + i * 101 + seed * 7 + 200) % 1000;\n      const offsetX = (accentSeed * 0.1) % 14 - 7;\n      const offsetY = ((accentSeed * 0.15) % 14) - 7;\n      const x = tileX + (baseX + offsetX) / 100 * TILE_SIZE;\n      const y = tileY + (baseY + offsetY) / 100 * TILE_SIZE;\n      const size = Math.max(1.5, TILE_SIZE * (0.025 + (accentSeed % 15) / 800));\n\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // Dark moss shadows for depth\n    if (seed % 3 === 0) {\n      const shadowSeed = (varSeed + seed * 2.3) % 1000;\n      const sx = tileX + (15 + (shadowSeed * 0.7) % 70) / 100 * TILE_SIZE;\n      const sy = tileY + (15 + (shadowSeed * 0.9) % 70) / 100 * TILE_SIZE;\n      const ssize = Math.max(2, TILE_SIZE * 0.04);\n\n      ctx.fillStyle = 'rgba(10, 60, 20, 0.3)';\n      ctx.beginPath();\n      ctx.arc(sx, sy, ssize, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  }\n  // Note: pavement (p) and cobblestone (x) textures are handled by drawBeveledStoneTile\n}\n\n/**\n * Create tile texture - simple solid tiles with texture and corner rounding\n */\nfunction createTileTextureV2(tileType, TILE_SIZE, rowIndex, colIndex, tileTypes) {\n  const canvas = document.createElement('canvas');\n  canvas.width = TILE_SIZE;\n  canvas.height = TILE_SIZE;\n  const ctx = canvas.getContext('2d');\n\n  const baseColor = getTileColor(tileType);\n  const seed = (rowIndex * 127 + colIndex * 53) % 10000;\n\n  // Special handling for pavement and cobblestone - beveled stone look\n  if (tileType === 'p' || tileType === 'x') {\n    // Fill background with grass color first (for gaps between stones)\n    ctx.fillStyle = getTileColor('g');\n    ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n\n    // Draw beveled stone on top\n    drawBeveledStoneTile(ctx, 0, 0, TILE_SIZE, baseColor, tileType, seed);\n\n    return canvas;\n  }\n\n  // Fill with base tile color (solid fill, no gaps)\n  ctx.fillStyle = baseColor;\n  ctx.fillRect(0, 0, TILE_SIZE, TILE_SIZE);\n\n  // Add subtle texture to base tile\n  addTileTexture(ctx, tileType, 0, 0, TILE_SIZE, seed);\n\n  // Draw rounded corners where higher-priority tiles meet this tile\n  if (tileTypes) {\n    drawCornerRounding(ctx, tileType, TILE_SIZE, rowIndex, colIndex, tileTypes);\n  }\n\n  return canvas;\n}\n\n// ============================================\n// MAIN COMPONENT\n// ============================================\n\nexport const RenderTilesCanvasV2 = ({ grid, tileTypes, TILE_SIZE, zoomLevel, handleTileClick }) => {\n  const canvasRef = useRef(null);\n  const textureCache = useRef(new Map());\n  const lastRenderData = useRef(null);\n  const lastTileTypes = useRef(null);\n\n  // Clear texture cache when TILE_SIZE or zoomLevel changes\n  useEffect(() => {\n    textureCache.current.clear();\n  }, [TILE_SIZE, zoomLevel]);\n\n  // Invalidate cache for changed tiles and their neighbors\n  useEffect(() => {\n    if (!tileTypes || !lastTileTypes.current) {\n      lastTileTypes.current = tileTypes;\n      return;\n    }\n\n    const rows = tileTypes.length;\n    const cols = tileTypes[0]?.length || 0;\n    const keysToDelete = new Set();\n\n    // Find changed tiles and mark them + neighbors for cache invalidation\n    for (let row = 0; row < rows; row++) {\n      for (let col = 0; col < cols; col++) {\n        const currentType = tileTypes[row]?.[col];\n        const previousType = lastTileTypes.current[row]?.[col];\n\n        if (currentType !== previousType) {\n          // Invalidate this tile and all 8 neighbors\n          for (let dr = -1; dr <= 1; dr++) {\n            for (let dc = -1; dc <= 1; dc++) {\n              const nr = row + dr;\n              const nc = col + dc;\n              if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) {\n                const neighborType = tileTypes[nr]?.[nc] || 'g';\n                const cacheKey = `${neighborType}-${TILE_SIZE}-${zoomLevel}-${nr}-${nc}`;\n                keysToDelete.add(cacheKey);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Delete invalidated cache entries\n    keysToDelete.forEach(key => {\n      textureCache.current.delete(key);\n    });\n\n    lastTileTypes.current = tileTypes;\n  }, [tileTypes, TILE_SIZE, zoomLevel]);\n\n  // Get or create tile texture\n  const getTileTexture = useCallback((tileType, rowIndex, colIndex) => {\n    const cacheKey = `${tileType}-${TILE_SIZE}-${zoomLevel}-${rowIndex}-${colIndex}`;\n\n    if (!textureCache.current.has(cacheKey)) {\n      textureCache.current.set(\n        cacheKey,\n        createTileTextureV2(tileType, TILE_SIZE, rowIndex, colIndex, tileTypes)\n      );\n    }\n    return textureCache.current.get(cacheKey);\n  }, [TILE_SIZE, tileTypes, zoomLevel]);\n\n  // Render tiles to canvas\n  const renderTiles = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !grid || !tileTypes) {\n      return;\n    }\n\n    const ctx = canvas.getContext('2d');\n    const rows = grid.length;\n    const cols = grid[0]?.length || 0;\n\n    canvas.width = cols * TILE_SIZE;\n    canvas.height = rows * TILE_SIZE;\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    for (let rowIndex = 0; rowIndex < rows; rowIndex++) {\n      for (let colIndex = 0; colIndex < cols; colIndex++) {\n        const tileType = tileTypes[rowIndex]?.[colIndex] || 'g';\n        const texture = getTileTexture(tileType, rowIndex, colIndex);\n\n        ctx.drawImage(\n          texture,\n          colIndex * TILE_SIZE,\n          rowIndex * TILE_SIZE,\n          TILE_SIZE,\n          TILE_SIZE\n        );\n      }\n    }\n  }, [grid, tileTypes, TILE_SIZE, getTileTexture]);\n\n  useEffect(() => {\n    const currentData = JSON.stringify({ grid, tileTypes, TILE_SIZE, zoomLevel });\n    if (currentData !== lastRenderData.current) {\n      renderTiles();\n      lastRenderData.current = currentData;\n    }\n  }, [renderTiles, grid, tileTypes, TILE_SIZE, zoomLevel]);\n\n  const handleCanvasClick = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas || !handleTileClick) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n\n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n\n    if (rowIndex >= 0 && rowIndex < grid.length &&\n        colIndex >= 0 && colIndex < (grid[0]?.length || 0)) {\n      handleTileClick(rowIndex, colIndex);\n    }\n  }, [handleTileClick, TILE_SIZE, grid]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 1,\n        cursor: 'pointer',\n        imageRendering: 'pixelated',\n      }}\n    />\n  );\n};\n","// Shared utility for determining resource overlay status\n// Used by both DOM and Canvas rendering systems\n\nexport const getResourceOverlayStatus = (\n  resource, \n  craftingStatus, \n  tradingStatus, \n  badgeState, \n  electionPhase,\n  currentPlayer\n) => {\n  if (!resource) return null;\n\n  const resourceKey = `${resource.x}-${resource.y}`;\n  const currentTime = Date.now();\n  \n  // Check various status conditions\n  const isCraftReady = craftingStatus?.ready?.includes(resourceKey);\n  const isCraftInProgress = craftingStatus?.inProgress?.includes(resourceKey);\n  const isTradingReady = tradingStatus?.ready?.includes(resourceKey);\n  \n  // Determine overlay type based on priority (most important first)\n  \n  // Crafting status (highest priority)\n  if (isCraftReady) {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  if (isCraftInProgress) {\n    return { type: 'inprogress', priority: 2 };\n  }\n  \n  // Trading Post status\n  if (isTradingReady && resource.type === 'Trading Post') {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  // Mailbox status\n  if (badgeState?.mailbox && resource.type === 'Mailbox') {\n    return { type: 'ready', priority: 1 };\n  }\n  \n  \n  // Courthouse/Election status\n  if (resource.type === 'Courthouse') {\n    if (electionPhase === 'Campaigning') {\n      return { type: 'campaign', priority: 3 };\n    } else if (electionPhase === 'Voting') {\n      return { type: 'voting', priority: 1 };\n    }\n  }\n  \n  // No overlay needed\n  return null;\n};\n\n// Mapping from overlay types to SVG files\nexport const OVERLAY_SVG_MAPPING = {\n  'ready': 'checkmark.svg',\n  'completed': 'checkmark.svg', \n  'voting': 'checkmark.svg',\n  'inprogress': 'clock.svg',\n  'campaign': 'clock.svg',\n  'available': 'hand.svg',\n};\n\n// Mapping from overlay types to emoji (for DOM fallback)\nexport const OVERLAY_EMOJI_MAPPING = {\n  'ready': { emoji: '', color: 'green' },\n  'completed': { emoji: '', color: '#32CD32' },\n  'voting': { emoji: '', color: 'green' },\n  'inprogress': { emoji: '', color: 'orange' },\n  'campaign': { emoji: '', color: '#FFD700' },\n  'available': { emoji: '', color: '#FFD700' },\n  'exclamation': { emoji: '', color: '#FF6B35' },\n  'attack': { emoji: '', color: '#DC143C' },\n};","import React, { useRef, useEffect, useCallback } from 'react';\nimport SVGAssetManager from './SVGAssetManager';\nimport { getResourceOverlayStatus, OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\n\n// Helper function to get the filename for a resource type\nconst getResourceFilename = (resourceType, masterResources) => {\n  if (!masterResources) return null;\n\n  const masterResource = masterResources.find(r => r.type === resourceType);\n  return masterResource?.filename || null;\n};\n\n\n// Canvas-based resource renderer component\nexport const RenderResourcesCanvas = ({\n  resources,\n  masterResources,\n  globalTuning,\n  TILE_SIZE,\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  handleTileClick\n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n  const renderingRef = useRef(false); // Track if rendering is in progress\n  \n  \n  // Update SVGAssetManager zoom tiers when globalTuning changes\n  useEffect(() => {\n    if (globalTuning) {\n      SVGAssetManager.updateZoomTiers(globalTuning);\n    }\n  }, [globalTuning]);\n  \n  // Cleanup rendering flag on unmount\n  useEffect(() => {\n    return () => {\n      renderingRef.current = false;\n    };\n  }, []);\n  \n  // Render resources to canvas\n  const renderResources = useCallback(async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !resources) return;\n    \n    // Prevent concurrent renders\n    if (renderingRef.current) {\n      console.log(' [RESOURCE RENDER] Skipping render - already in progress');\n      return;\n    }\n    renderingRef.current = true;\n    \n    console.log(` [RESOURCE RENDER] Starting resource render for ${resources.length} resources at TILE_SIZE: ${TILE_SIZE}`);\n    \n    // Add timeout to prevent stuck renders\n    const renderTimeout = setTimeout(() => {\n      console.warn(' [RESOURCE RENDER] Render timed out after 10 seconds, resetting lock');\n      renderingRef.current = false;\n    }, 10000);\n    \n    try {\n      const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // Render all resources (matching DOM behavior)\n    for (const resource of resources) {\n      // Only render once per resource at its anchor position (x,y)\n      // Multi-tile resources span from (x,y) but are visually rendered from anchor\n      await renderSingleResource(ctx, resource, TILE_SIZE, masterResources);\n    }\n    \n    // Render overlays for resources that need them\n    // Filter out shadow, doober, and source for overlays (they don't get status overlays)\n    const overlayResources = resources.filter(resource => \n      resource.type !== 'shadow' && resource.category !== 'doober' && resource.category !== 'source'\n    );\n    \n    for (const resource of overlayResources) {\n      await renderResourceOverlay(ctx, resource, TILE_SIZE);\n    }\n    \n    console.log(` [RESOURCE RENDER] Resource rendering completed - ${resources.length} resources at TILE_SIZE: ${TILE_SIZE}`);\n    } finally {\n      clearTimeout(renderTimeout);\n      renderingRef.current = false;\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase, masterResources]);\n\n  // Render a single resource (SVG or emoji)\n  const renderSingleResource = async (ctx, resource, TILE_SIZE, masterResources) => {\n    const x = resource.x * TILE_SIZE;\n    const y = resource.y * TILE_SIZE;\n    const range = resource.range || 1;\n    const size = TILE_SIZE * range;\n\n    // Multi-tile resources grow UPWARD from anchor (anchor is bottom-left of visual area)\n    // For range > 1, we need to shift the visual up so it occupies the correct tiles\n    // Visual should span from (resource.y - range + 1) to resource.y in tile coordinates\n    const visualY = (range > 1) ? y - (range - 1) * TILE_SIZE : y;\n\n    // Check if resource has custom SVG art from masterResources\n    const filename = getResourceFilename(resource.type, masterResources);\n\n    if (filename) {\n      // Render custom SVG art\n      console.log(` [SVG DEBUG] Loading SVG texture for ${resource.type}: ${filename} at size ${size}`);\n      const texture = await SVGAssetManager.getSVGTexture(filename, size);\n      if (texture) {\n        console.log(` [SVG DEBUG] Successfully loaded SVG texture for ${resource.type}: ${filename}`);\n\n        if (range > 1) {\n          console.log(` [MULTI-TILE DEBUG] Rendering ${resource.type} (range ${range}) at anchor (${resource.x}, ${resource.y}) -> visual position (${x}, ${visualY}) size ${size}x${size}`);\n          console.log(`    Logical blocking tiles: (${resource.x}, ${resource.y - range + 1}) to (${resource.x + range - 1}, ${resource.y})`);\n          console.log(`    Visual rendering tiles: (${Math.floor(x/TILE_SIZE)}, ${Math.floor(visualY/TILE_SIZE)}) to (${Math.floor((x+size)/TILE_SIZE)-1}, ${Math.floor((visualY+size)/TILE_SIZE)-1})`);\n        }\n\n        ctx.drawImage(texture, x, visualY, size, size);\n      } else {\n        console.warn(` [SVG DEBUG] Failed to load SVG for ${resource.type}: ${filename}`);\n        // Fall back to emoji if SVG fails to load\n        renderResourceEmoji(ctx, resource, x, visualY, TILE_SIZE, range);\n      }\n    } else if (resource.symbol) {\n      // Render emoji symbol\n      renderResourceEmoji(ctx, resource, x, visualY, TILE_SIZE, range);\n    }\n  };\n  \n  // Helper function to render emoji resources\n  // Note: y parameter is already the corrected visualY (top of visual area for multi-tile resources)\n  const renderResourceEmoji = (ctx, resource, x, y, TILE_SIZE, range) => {\n    ctx.save();\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n\n    // Calculate font size based on resource type and range\n    let fontSize;\n    if (range > 1) {\n      if (resource.action === 'wall') {\n        fontSize = TILE_SIZE * 1.2 * range;  // Multi-tile walls\n      } else {\n        // Scale emoji font size more aggressively for larger multi-tile resources\n        // to better fill the visual space\n        const baseScale = range <= 2 ? 0.8 : (range === 3 ? 1.0 : 1.2);\n        fontSize = TILE_SIZE * baseScale * range;\n      }\n    } else {\n      fontSize = resource.action === 'wall'\n        ? TILE_SIZE * 1.1  // Single-tile walls\n        : TILE_SIZE * 0.7; // Other single-tile resources\n    }\n\n    ctx.font = `${fontSize}px sans-serif`;\n\n    // Position text at center of resource visual area\n    const size = TILE_SIZE * range;\n    const centerX = x + size / 2;\n    const centerY = y + size / 2;\n\n    ctx.fillText(resource.symbol, centerX, centerY);\n    ctx.restore();\n  };\n\n  // Render overlay for a resource (status indicators)\n  const renderResourceOverlay = async (ctx, resource, TILE_SIZE) => {\n    // Use shared overlay logic to determine what overlay to show\n    const overlayInfo = getResourceOverlayStatus(\n      resource, \n      craftingStatus, \n      tradingStatus, \n      badgeState, \n      electionPhase,\n      currentPlayer\n    );\n    \n    if (!overlayInfo) return; // No overlay needed\n    \n    const overlayType = overlayInfo.type;\n    \n    // Render overlay if one is determined\n    if (overlayType && OVERLAY_SVG_MAPPING[overlayType]) {\n      const x = resource.x * TILE_SIZE;\n      const y = resource.y * TILE_SIZE;\n      const size = TILE_SIZE * (resource.range || 1);\n      \n      // Position overlay in lower-left corner of the resource's primary tile\n      // Scale overlay more appropriately for different zoom levels\n      let overlaySize;\n      if (TILE_SIZE <= 16) {\n        // Far zoom: use smaller minimum and ratio\n        overlaySize = Math.max(6, TILE_SIZE * 0.35);\n      } else if (TILE_SIZE <= 30) {\n        // Close zoom: standard sizing\n        overlaySize = Math.max(10, TILE_SIZE * 0.35);\n      } else {\n        // Closer zoom: allow larger overlays\n        overlaySize = Math.max(14, TILE_SIZE * 0.35);\n      }\n      \n      const overlayX = x + 2; // Small offset from left edge\n      const overlayY = y + TILE_SIZE - overlaySize - 2; // Lower corner of primary tile\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        OVERLAY_SVG_MAPPING[overlayType], \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      } else {\n        console.warn(`Failed to load overlay texture for ${overlayType}`);\n      }\n    }\n  };\n\n  // Re-render when dependencies change\n  useEffect(() => {\n    console.log(` [RESOURCE USEEFFECT] useEffect triggered with TILE_SIZE: ${TILE_SIZE}, resources count: ${resources?.length || 0}`);\n    \n    const currentData = JSON.stringify({ \n      resources: resources?.map(r => ({ \n        x: r.x, \n        y: r.y, \n        type: r.type, \n        symbol: r.symbol, \n        range: r.range \n      })), \n      TILE_SIZE,\n      craftingReady: craftingStatus?.ready,\n      craftingInProgress: craftingStatus?.inProgress,\n      tradingReady: tradingStatus?.ready,\n      mailboxBadge: badgeState?.mailbox,\n      electionPhase,\n      playerId: currentPlayer?.id // Include player ID for trade status changes\n    });\n    \n    if (currentData !== lastRenderData.current) {\n      console.log(` [RESOURCE USEEFFECT] Data changed, triggering render with TILE_SIZE: ${TILE_SIZE}`);\n      renderResources().catch(error => {\n        console.error('Error rendering resources:', error);\n        renderingRef.current = false; // Reset flag on error\n      });\n      lastRenderData.current = currentData;\n    } else {\n      console.log(` [RESOURCE USEEFFECT] Data unchanged, skipping render with TILE_SIZE: ${TILE_SIZE}`);\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase, currentPlayer]);\n\n  // Handle canvas clicks and convert to grid coordinates\n  const handleCanvasClick = useCallback((event) => {\n    if (!handleTileClick) return;\n    \n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    handleTileClick(rowIndex, colIndex);\n  }, [handleTileClick, TILE_SIZE]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: `${64 * TILE_SIZE}px`,\n        height: `${64 * TILE_SIZE}px`,\n        zIndex: 10, // Same as DOM resources\n        pointerEvents: 'none' // Let mouse events pass through to RenderDynamicElements\n      }}\n    />\n  );\n};","import React from 'react';\nimport { RenderResourcesCanvas } from './RenderResourcesCanvas';\n\n/**\n * Main resource rendering component - FORCED TO CANVAS MODE ONLY\n * Only handles the actual resource entities, not their overlays or tooltips\n */\nexport const RenderResources = ({\n  resources,\n  masterResources,\n  globalTuning,\n  TILE_SIZE,\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  handleTileClick,\n  // useCanvasResources removed - always Canvas mode now\n}) => {\n  // FORCED TO CANVAS MODE - no decision tree\n  return (\n    <RenderResourcesCanvas\n      resources={resources}\n      masterResources={masterResources}\n      globalTuning={globalTuning}\n      TILE_SIZE={TILE_SIZE}\n      craftingStatus={craftingStatus}\n      tradingStatus={tradingStatus}\n      badgeState={badgeState}\n      electionPhase={electionPhase}\n      currentPlayer={currentPlayer}\n      handleTileClick={handleTileClick}\n    />\n  );\n};\n\nexport default RenderResources;","import API_BASE from '../../config';\nimport axios from 'axios';\nimport FloatingTextManager from \"../../UI/FloatingText\";\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs\";\nimport playersInGridManager from \"../../GridState/PlayersInGrid\";\nimport { calculateDistance } from \"../../Utils/worldHelpers\";\nimport { extractXY } from \"../NPCs/NPCUtils\";\nimport { updateGridResource, isWallBlocking, getLineOfSightTiles } from \"../../Utils/GridManagement\";\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { createCollectEffect } from \"../../VFX/VFX\";\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\n\n/** Helper to check if target is in range and validate positions **/\nfunction checkRange(player, target, TILE_SIZE) {\n\n    const playerPos = player.position;\n    const targetPos = extractXY(target.position);\n    \n    console.log('Fetched positions: playerPos =', playerPos, '; targetPos =', targetPos);\n    if (!targetPos) {\n        console.error(\"Invalid target position\", { targetPos });\n        FloatingTextManager.addFloatingText(505, 0, 0, TILE_SIZE);\n        return false;\n    }\n\n    const distance = calculateDistance(playerPos, targetPos);\n    const playerRange = player.attackrange || 1;\n    console.log('playerRange = ',playerRange);\n    console.log('playerPos = ',playerPos);\n\n    if (distance > playerRange) {\n        FloatingTextManager.addFloatingText(501, targetPos.x, targetPos.y, TILE_SIZE);\n        console.log('target out of range: targetPos.x = ',targetPos.x,' targetPos.y= ',targetPos.y);\n        return false;\n    }\n    \n    // Check for walls blocking line of sight\n    if (isWallBlocking(playerPos, targetPos)) {\n        FloatingTextManager.addFloatingText(40, targetPos.x, targetPos.y, TILE_SIZE); // string[40] for wall blocking\n        console.log('Wall blocking attack from player to target');\n        return false;\n    }\n    \n    return true;  // Target is in range and no walls blocking\n}\n\n/** Helper to determine if the attack hits **/\nfunction isAHit(player, target, TILE_SIZE) {\n\n    const attackRoll = Math.floor(Math.random() * 20) + 1;\n    const hitRoll = attackRoll + (player.attackbonus || 0);\n\n    console.log(`Attack roll: ${attackRoll}, Attack bonus: ${player.attackbonus}`);\n    console.log(`Total hit roll: ${hitRoll}, Target armor class: ${target.armorclass}`);\n\n    if (hitRoll >= target.armorclass) {\n        FloatingTextManager.addFloatingText(502, target.position.x, target.position.y-1, TILE_SIZE);\n        return true;\n    } else {\n        FloatingTextManager.addFloatingText(503, target.position.x, target.position.y, TILE_SIZE);\n        return false;\n    }\n}\n\n/** Helper to calculate damage **/\nfunction calculateDamage(player) {\n    const randomDamageModifier = Math.floor(Math.random() * 6) + 1;\n    const damage = (player.damage || 0) + randomDamageModifier;\n    console.log(`Damage roll: ${randomDamageModifier}, player damage: ${player.damage}, Damage dealt: ${damage}`);\n    return damage;\n}\n\n/** handle attack on NPC **/\nexport async function handleAttackOnNPC(npc, currentPlayer, setCurrentPlayer, TILE_SIZE, setResources, masterResources, masterTrophies = null) {\n    console.log(`Handling attack on NPC ${npc.id}.`);\n\n    // Translate currentPlayer to pc from playersInGridManager\n    const gridId = currentPlayer.location.g;\n    const playerId = currentPlayer._id.toString();  // Convert ObjectId to string for matching\n    console.log('playerId = ', playerId);\n    const player = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    console.log('player = ', player);\n    if (!player) {\n        console.error(`Player not found in playersInGrid for playerId: ${playerId}.`);\n        return;\n    }\n\n    const freshNPC = NPCsInGridManager.getNPCsInGrid(gridId)?.[npc.id] || npc;\n\n    if (player.iscamping) {\n        FloatingTextManager.addFloatingText(31, freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n        return;\n    }\n    if (!checkRange(player, freshNPC, TILE_SIZE)) return;\n    if (!isAHit(player, freshNPC, TILE_SIZE)) return;\n \n    const damage = calculateDamage(player);\n    FloatingTextManager.addFloatingText(`- ${damage}  HP`, freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n    createCollectEffect(freshNPC.position.x, freshNPC.position.y, TILE_SIZE);\n\n    freshNPC.hp -= damage;\n    await NPCsInGridManager.updateNPC(gridId, freshNPC.id, {\n      hp: freshNPC.hp,\n      position: freshNPC.position,\n      state: freshNPC.state,\n    });\n\n    if (freshNPC.hp <= 0) {\n        console.log(`NPC ${freshNPC.id} killed.`);\n        FloatingTextManager.addFloatingText(504, freshNPC.position.x, freshNPC.position.y-0.5, TILE_SIZE);\n\n        try {\n            await NPCsInGridManager.removeNPC(gridId, freshNPC.id);\n            console.log(`NPC ${freshNPC.id} successfully removed from grid.`);\n\n            // Award XP for killing the NPC\n            const npcResource = masterResources.find(res => res.type === freshNPC.type && res.category === 'npc');\n            if (npcResource && npcResource.xp && currentPlayer.playerId) {\n                try {\n                    const xpResponse = await axios.post(`${API_BASE}/api/addXP`, {\n                        playerId: currentPlayer.playerId,\n                        xpAmount: npcResource.xp\n                    });\n                    \n                    if (xpResponse.data.success) {\n                        // Update currentPlayer with new XP\n                        setCurrentPlayer(prev => ({\n                            ...prev,\n                            xp: xpResponse.data.newXP\n                        }));\n                        \n                        // Show XP earned with a delay\n                        setTimeout(() => {\n                            FloatingTextManager.addFloatingText(`+${npcResource.xp} XP`, freshNPC.position.x, freshNPC.position.y-1.2, TILE_SIZE);\n                        }, 500);\n                        \n                        console.log(` Awarded ${npcResource.xp} XP for killing ${freshNPC.type}`);\n                    }\n                } catch (error) {\n                    console.error('Error awarding XP:', error);\n                }\n            }\n\n            // Add the Dead NPC \"output\" to the grid:\n            if (freshNPC.output) {\n                console.log(`Spawning resource: ${freshNPC.output} at NPC's death position.`);\n                const resourceDetails = masterResources.find((res) => res.type === freshNPC.output);\n\n                const enrichedResource = {\n                    ...resourceDetails,\n                    type: freshNPC.output,\n                    x: Math.floor(freshNPC.position.x),\n                    y: Math.floor(freshNPC.position.y),\n                    category: resourceDetails.category || 'doober',\n                    symbol: resourceDetails.symbol || '',\n                    qtycollected: resourceDetails.qtycollected || 1,\n                };\n\n                const updatedResources = [\n                    ...GlobalGridStateTilesAndResources.getResources(),\n                    enrichedResource\n                ];\n                GlobalGridStateTilesAndResources.setResources(updatedResources);\n                setResources((prevResources) => [...prevResources, enrichedResource]);\n\n                await updateGridResource(\n                    gridId, \n                    { \n                      type: freshNPC.output,\n                      x: Math.floor(freshNPC.position.x),\n                      y: Math.floor(freshNPC.position.y),\n                    },\n                    setResources,\n                    true\n                  );\n            } else {\n                console.warn(`NPC ${freshNPC.id} has no output resource defined.`);\n            }\n        } catch (error) {\n            console.error('Error removing NPC or spawning resource:', error);\n        }\n        \n        // Special case for Duke Angelo - auto-accept quest if not active\n        if (freshNPC.type === 'Duke Angelo') {\n            // Award \"Kill the Duke\" trophy when Duke Angelo is defeated\n            if (masterTrophies && currentPlayer?.playerId) {\n                try {\n                    console.log(' Awarding Kill the Duke trophy for defeating Duke Angelo');\n                    await earnTrophy(currentPlayer.playerId, \"Kill the Duke\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n                    console.log(' Successfully awarded Kill the Duke trophy');\n                } catch (error) {\n                    console.error(' Error awarding Kill the Duke trophy:', error);\n                }\n            }\n            \n            const bloodForJulietQuest = currentPlayer.activeQuests?.find(q => q.questId === 'Blood for Juliet');\n            \n            if (!bloodForJulietQuest) {\n                // Quest not active - auto-accept it with completed status\n                try {\n                    const response = await axios.post(`${API_BASE}/api/add-player-quest`, {\n                        playerId: currentPlayer.playerId,\n                        questId: 'Blood for Juliet',\n                        startTime: Date.now(),\n                        progress: { goal1: 1 }, // Mark as already completed\n                        completed: true, // Mark quest as completed\n                    });\n                    \n                    if (response.data.success) {\n                        setCurrentPlayer(response.data.player);\n                        FloatingTextManager.addFloatingText('Quest: Blood for Juliet completed!', freshNPC.position.x, freshNPC.position.y-2, TILE_SIZE);\n                        console.log('Auto-accepted and completed Blood for Juliet quest');\n                    }\n                } catch (error) {\n                    console.error('Error auto-accepting Blood for Juliet quest:', error);\n                }\n            } else {\n                // Quest is active - track progress normally\n                await trackQuestProgress(currentPlayer, 'Kill', freshNPC.type, 1, setCurrentPlayer);\n            }\n        } else {\n            // Normal quest progress tracking for other NPCs\n            await trackQuestProgress(currentPlayer, 'Kill', freshNPC.type, 1, setCurrentPlayer);\n        }\n    }\n}\n\n\nexport async function handleAttackOnPC(pc, currentPlayer, gridId, TILE_SIZE) {\n  const playerId = currentPlayer._id.toString();  // Convert ObjectId to string for matching\n  const player = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n  if (!player) {\n    console.error('Player not found in playersInGrid.');\n    return;\n  }\n\n  // Refresh the target PC from memory\n  pc = playersInGridManager.getPlayersInGrid(gridId)?.[pc.playerId] || pc;\n\n  if (!checkRange(player, pc, TILE_SIZE)) return;\n  if (!isAHit(player, pc, TILE_SIZE)) return;\n\n  const damage = calculateDamage(player, gridId);\n  FloatingTextManager.addFloatingText(`- ${damage} HP`, pc.position.x, pc.position.y, TILE_SIZE);\n  createCollectEffect(pc.position.x, pc.position.y, TILE_SIZE);\n\n  const newHP = Math.max(0, pc.hp - damage);\n  console.log(' Calling updatePC after reducing HP; current HP:', newHP);\n  await playersInGridManager.updatePC(gridId, pc.playerId, { hp: newHP });\n\n  if (newHP <= 0) {\n    console.log(`PC ${pc.playerId} defeated.`);\n    FloatingTextManager.addFloatingText(504, pc.position.x, pc.position.y+1, TILE_SIZE);\n  }\n}","import API_BASE from \"../../config.js\";\nimport axios from \"axios\";    \nimport FloatingTextManager from \"../../UI/FloatingText.js\";\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs.js\";\nimport { handleAttackOnNPC } from \"../Combat/Combat.js\";\nimport { gainIngredients, hasRoomFor } from \"../../Utils/InventoryManagement.js\";\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker.js';\nimport AnimalPanel from '../FarmAnimals/FarmAnimals.js';\nimport { calculateDistance } from '../../Utils/worldHelpers.js';\nimport { getLocalizedString } from '../../Utils/stringLookup.js';\nimport { formatSingleCollection } from '../../UI/StatusBar/CollectionFormatters.js';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement.js';\n\n// Generate unique transaction ID\nfunction generateTransactionId() {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Protected farm animal collection function\nasync function handleProtectedFarmAnimalCollection(\n  npc,\n  row,\n  col,\n  setInventory,\n  setBackpack,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  currentGridId,\n  updateStatus,\n  strings = {},\n  globalTuning = null,\n  inventory = null,\n  backpack = null\n) {\n  console.log(` [PROTECTED FARM ANIMAL] Starting protected collection for NPC ${npc.id}`);\n  \n  // Generate transaction ID and key\n  const transactionId = generateTransactionId();\n  const transactionKey = `farm-animal-collect-${npc.id}-${currentGridId}`;\n  \n  try {\n    console.log(` Attempting to collect animal - ID: ${npc.id}, State: ${npc.state}, GrazeEnd: ${npc.grazeEnd}, Current Time: ${Date.now()}`);\n    \n    // Double-check the NPC state from the grid manager before making the request\n    const currentNPCState = NPCsInGridManager.getNPCsInGrid(currentGridId)?.[npc.id];\n    if (currentNPCState && currentNPCState.state !== 'processing') {\n      console.warn(` NPC ${npc.id} state changed to ${currentNPCState.state} before collection attempt`);\n      updateStatus(` Animal not ready - state: ${currentNPCState.state}`);\n      return { type: 'error', message: `Animal not in processing state (${currentNPCState.state})` };\n    }\n    \n    // Check if grazeEnd has expired while offline (indicates stale client state)\n    if (currentNPCState && currentNPCState.grazeEnd) {\n      const timeSinceGrazeEnd = Date.now() - currentNPCState.grazeEnd;\n      if (timeSinceGrazeEnd > 3600000) { // 1 hour past grazeEnd\n        console.warn(` NPC ${npc.id} has expired grazeEnd - ${Math.floor(timeSinceGrazeEnd / 60000)} minutes overdue`);\n        console.warn(` GrazeEnd was: ${new Date(currentNPCState.grazeEnd).toISOString()}, Now: ${new Date().toISOString()}`);\n        // Let the server validate the state - it's the source of truth\n        updateStatus(\"Checking animal state...\");\n      }\n    }\n    \n    // Skip pre-check for warehouse capacity - let server handle it with fresh data\n    // The pre-check was using potentially stale inventory data from currentPlayer\n    \n    const response = await axios.post(`${API_BASE}/api/farm-animal/collect`, {\n      playerId: currentPlayer.playerId,\n      gridId: currentGridId,\n      npcId: npc.id,\n      npcPosition: { x: col, y: row },\n      transactionId,\n      transactionKey\n    });\n\n    if (response.data.success) {\n      const { collectedQuantity, collectedItem, skillsApplied, updatedNPC } = response.data;\n      \n      // Don't use server inventory - use gainIngredients to properly handle capacity\n      // This ensures Gold Pass warehouse bonus is respected\n      \n      // Add to inventory using gainIngredients (respects Gold Pass capacity)\n      const gained = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: collectedItem,\n        quantity: collectedQuantity,\n        inventory: inventory || currentPlayer.inventory,\n        backpack: backpack || currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n      \n      // Check if gainIngredients succeeded - it returns true on success or an error object on failure\n      if (gained !== true && (!gained || gained.success === false)) {\n        console.error(' Failed to add animal product to inventory - warehouse may be full');\n        console.error(' gainIngredients result:', gained);\n        // The server already changed the NPC state, but we couldn't add the item\n        // This is a critical error - the item is lost\n        // Show the \"You're full\" floating text instead of success\n        FloatingTextManager.addFloatingText(strings[\"41\"] || \"You're full\", col, row, TILE_SIZE);\n        return { type: 'error', message: 'Warehouse full - item lost' };\n      }\n\n      // Only update NPC state and show success if we successfully added to inventory\n      if (updatedNPC) {\n        await NPCsInGridManager.updateNPC(currentGridId, npc.id, updatedNPC);\n        \n        // Check if there are other animals at the same position that might need state updates\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n        const animalsAtSamePosition = Object.values(npcsInGrid || {}).filter(otherNpc => \n          otherNpc.id !== npc.id &&\n          Math.floor(otherNpc.position?.x) === col &&\n          Math.floor(otherNpc.position?.y) === row &&\n          otherNpc.action === 'graze'\n        );\n        \n        if (animalsAtSamePosition.length > 0) {\n          console.log(` Found ${animalsAtSamePosition.length} other animals at same stall position after collection`);\n          console.log(` Other animals at position:`, animalsAtSamePosition.map(a => ({\n            id: a.id,\n            state: a.state,\n            grazeEnd: a.grazeEnd,\n            targetStall: a.targetStall\n          })));\n          \n          // For animals in processing state at the same stall, they can remain in processing\n          // The server should handle their collection independently\n          // Only log the situation for debugging\n          for (const otherAnimal of animalsAtSamePosition) {\n            if (otherAnimal.state === 'processing') {\n              console.log(` Animal ${otherAnimal.id} remains in processing state at same stall - ready for collection`);\n            } else if (otherAnimal.state === 'stall') {\n              console.log(` Animal ${otherAnimal.id} is still moving to stall`);\n            } else {\n              console.log(` Animal ${otherAnimal.id} in unexpected state '${otherAnimal.state}' at stall position`);\n            }\n          }\n        }\n      }\n\n      // Only show success feedback if item was added to inventory\n      if (gained === true) {\n        // Visual feedback\n        FloatingTextManager.addFloatingText(`+${collectedQuantity} ${getLocalizedString(collectedItem, strings)}`, col, row, TILE_SIZE);\n        \n        // Calculate skill info for formatting\n        const skillInfo = calculateSkillMultiplier(collectedItem, currentPlayer.skills || [], masterSkills);\n        \n        // Format status message using shared formatter\n        const statusMessage = formatSingleCollection('animal', collectedItem, collectedQuantity, \n          skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n        \n        // Update status with the formatted message\n        updateStatus(statusMessage);\n      }\n\n      //  Track quest progress for NPC graze collection\n      await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQuantity, setCurrentPlayer);\n\n      console.log(`Farm animal collection completed: ${collectedQuantity} ${collectedItem}`);\n      return { \n        type: 'success', \n        message: `Collected ${collectedQuantity} ${collectedItem}.`,\n        collectedItem,\n        collectedQuantity,\n        skillsApplied\n      };\n    }\n  } catch (error) {\n    console.error('Error in protected farm animal collection:', error);\n    \n    if (error.response?.status === 429) {\n      updateStatus(471);\n      return { type: 'error', message: 'Collection already in progress' };\n    } else if (error.response?.status === 400) {\n      const errorMessage = error.response?.data?.error || 'Animal not ready for collection';\n      const errorDetails = error.response?.data;\n      console.error(` 400 Error details:`, errorDetails);\n      \n      // Handle warehouse full error\n      if (errorMessage === 'Warehouse full' || errorMessage.includes('Warehouse full')) {\n        console.error(` Cannot collect: Warehouse is full (${errorDetails?.currentUsage}/${errorDetails?.capacity})`);\n        // Show \"You're full\" floating text\n        FloatingTextManager.addFloatingText(strings[\"41\"] || \"You're full\", col, row, TILE_SIZE);\n        // Don't show status message - floating text is enough\n        return { type: 'error', message: 'Warehouse is full' };\n      }\n      \n      console.error(` Animal state mismatch - Client state: ${npc.state}, Server error: ${errorMessage}`);\n      console.error(` Animal details - ID: ${npc.id}, GrazeEnd: ${npc.grazeEnd}, Current Time: ${Date.now()}`);\n      \n      // If server says NPC is in different state, sync with server state\n      if (errorMessage.includes('state:')) {\n        const serverStateMatch = errorMessage.match(/\\(state:\\s*(\\w+)\\)/);\n        if (serverStateMatch) {\n          const serverState = serverStateMatch[1];\n          console.error(` Server reports NPC ${npc.id} in state '${serverState}' but client has '${npc.state}'`);\n          \n          // Special handling for processing -> stall mismatch (animal was already collected)\n          if (npc.state === 'processing' && serverState === 'stall') {\n            console.log(` Animal ${npc.id} was already collected (now looking for stall)`);\n            updateStatus(strings[\"815\"] || \"This animal was already collected\");\n            \n            // Clear stale grazeEnd and update state\n            await NPCsInGridManager.updateNPC(currentGridId, npc.id, {\n              state: serverState,\n              grazeEnd: null,\n              targetStall: null\n            });\n            \n            // Don't try other animals - this was the expected animal\n            return { type: 'error', message: 'Animal already collected' };\n          }\n          \n          // Force refresh the NPC from server\n          console.log(` Attempting to resync NPC ${npc.id} state with server...`);\n          \n          // Update local state to match server\n          await NPCsInGridManager.updateNPC(currentGridId, npc.id, {\n            state: serverState\n          });\n          \n          // Check if there's another animal at this position that might be in processing state\n          const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n          const otherProcessingAnimal = Object.values(npcsInGrid || {}).find(otherNpc => \n            otherNpc.id !== npc.id &&\n            Math.floor(otherNpc.position?.x) === col &&\n            Math.floor(otherNpc.position?.y) === row &&\n            otherNpc.action === 'graze' &&\n            otherNpc.state === 'processing'\n          );\n          \n          if (otherProcessingAnimal) {\n            console.log(` Found another processing animal at same position after sync. Trying to collect from NPC ${otherProcessingAnimal.id}`);\n            updateStatus(`Trying another animal at this stall...`);\n            \n            // Try to collect from the other animal\n            return await handleProtectedFarmAnimalCollection(\n              otherProcessingAnimal,\n              row,\n              col,\n              setInventory,\n              setBackpack,\n              setResources,\n              currentPlayer,\n              setCurrentPlayer,\n              TILE_SIZE,\n              masterResources,\n              masterSkills,\n              currentGridId,\n              updateStatus,\n              strings,\n              globalTuning\n            );\n          }\n          \n          updateStatus(` Animal not ready - server state: ${serverState}`);\n        }\n      } else {\n        updateStatus(` ${errorMessage}`);\n      }\n      return { type: 'error', message: errorMessage };\n    } else {\n      updateStatus(' Failed to collect from animal');\n      return { type: 'error', message: 'Failed to collect from animal' };\n    }\n  }\n}\n\nexport function loadNPCDefinitions(resources) {\n    const npcDefinitions = {};\n    resources.forEach((resource) => {\n      if (resource.category === 'npc') {\n        npcDefinitions[resource.type] = resource;\n      }\n    });\n    return npcDefinitions;\n}\n  \nexport function extractXY(location) {\n  if (!location || location.x === undefined || location.y === undefined) {\n    console.error(\"Invalid location object\", location);\n    return null;\n  }\n  return { x: location.x, y: location.y };\n}\n\n// Re-export calculateDistance from worldHelpers to maintain backward compatibility\nexport { calculateDistance } from '../../Utils/worldHelpers.js';\n  \nexport async function handleNPCClick(\n  npc,\n  row,\n  col,\n  setInventory,\n  setBackpack,\n  setResources,\n  currentPlayer,\n  setCurrentPlayer,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  currentGridId,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  strings = {},\n  masterTrophies = null,\n  globalTuning = null\n) {\n  if (!npc) {\n    console.warn(\"handleNPCClick was called with an undefined NPC.\");\n    return;\n  }\n  console.log(`[ handleNPCClick] NPC ${npc.id} clicked with state=${npc.state}`);\n\n  switch (npc.action) {\n\n    case 'quest': \n    case 'heal':\n    case 'worker':\n      {\n        //handled directly in RenderDynamic  \n        break;\n      }\n \n    case 'graze': {\n\n      console.log(`Handling grazing logic for NPC ${npc.id}.`);\n\n      if (npc.state !== 'processing') {\n        console.log(` NPC ${npc.id} clicked but not in processing state: ${npc.state}`);\n        \n        // Get fresh state data to check for other animals\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n        \n        // Log all animals at this position for debugging\n        const allAnimalsAtPosition = Object.values(npcsInGrid || {}).filter(otherNpc =>\n          Math.floor(otherNpc.position?.x) === col &&\n          Math.floor(otherNpc.position?.y) === row &&\n          otherNpc.action === 'graze'\n        );\n        \n        if (allAnimalsAtPosition.length > 1) {\n          console.log(` Found ${allAnimalsAtPosition.length} animals at position (${col}, ${row}):`, \n            allAnimalsAtPosition.map(a => ({\n              id: a.id,\n              state: a.state,\n              grazeEnd: a.grazeEnd\n            }))\n          );\n        }\n        \n        // Find an animal in processing state at this position\n        const processingAnimalAtSamePosition = allAnimalsAtPosition.find(otherNpc => \n          otherNpc.id !== npc.id &&\n          otherNpc.state === 'processing'\n        );\n        \n        if (processingAnimalAtSamePosition) {\n          console.log(` Found another animal in processing state at same position. Switching to collect from NPC ${processingAnimalAtSamePosition.id} (state: ${processingAnimalAtSamePosition.state}) instead of ${npc.id} (state: ${npc.state})`);\n          // Recursively call handleNPCClick with the processing animal\n          return await handleNPCClick(\n            processingAnimalAtSamePosition,\n            row,\n            col,\n            setInventory,\n            setBackpack,\n            setResources,\n            currentPlayer,\n            setCurrentPlayer,\n            TILE_SIZE,\n            masterResources,\n            masterSkills,\n            currentGridId,\n            setModalContent,\n            setIsModalOpen,\n            updateStatus,\n            openPanel,\n            setActiveStation,\n            strings,\n            masterTrophies,\n            globalTuning\n          );\n        }\n\n        // Set the active station before opening the panel\n        setActiveStation({\n          type: npc.type,\n          position: { x: col, y: row },\n          gridId: currentGridId,\n          npcId: npc.id, // Include the NPC ID for reliable identification\n        });\n        openPanel('AnimalPanel');\n\n        return { type: 'info', message: 'NPC is not ready for collection.' };\n      }\n\n      //  Otherwise, handle Animals in stalls in \"procesing\" state\n\n      //  Use protected transaction system instead of UI lock hack\n      return await handleProtectedFarmAnimalCollection(\n        npc,\n        row,\n        col,\n        setInventory,\n        setBackpack,\n        setResources,\n        currentPlayer,\n        setCurrentPlayer,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        currentGridId,\n        updateStatus,\n        strings,\n        globalTuning\n      );\n    }\n\n    case 'attack': \n    case 'spawn':\n      handleAttackOnNPC(npc,currentPlayer,setCurrentPlayer,TILE_SIZE,setResources,masterResources,masterTrophies);\n      \n    break;\n  \n\n    default:\n      console.log(`Unhandled NPC action: ${npc.action}`);\n      break;\n  }\n}\n","import React, { useEffect } from 'react';\nimport { usePanelContext } from './PanelContext'; // Import the context\nimport './Panel.css';\nimport { useStrings } from '../StringsContext';\n\nconst Panel = ({ onClose, children, descriptionKey, panelName, titleKey, title }) => {\n  const strings = useStrings();\n  const { activePanel, openPanel, closePanel } = usePanelContext();\n\n  useEffect(() => {\n    if (activePanel === panelName) {\n      openPanel(panelName); // Set this panel as active\n    }\n  }, [activePanel, panelName, openPanel]);\n\n  if (activePanel !== panelName) {\n    return null; // Ensure only the active panel is displayed\n  }\n\n  return (\n    <div className=\"panel-container\">\n      {/* Fixed Header with Title and Close Button */}\n      <div className=\"panel-header\">\n        <h2 className=\"panel-title\">{title || strings[titleKey] || \"Panel\"}</h2>\n        <button\n          className=\"panel-close-btn\"\n          onClick={() => {\n            closePanel();\n            onClose();\n          }}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            width=\"24\"\n            height=\"24\"\n          >\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n          </svg>\n        </button>\n      </div>\n\n      {/* Scrollable Content Area */}\n      <div className=\"panel-content\">{children}</div>\n\n      {/* Panel Description */}\n      {descriptionKey && (\n        <div className=\"panel-description\">\n          <p>{strings[descriptionKey]}</p>\n        </div>\n      )}\n      \n      {/* Buffer space for Ko-fi widget */}\n      <div className=\"panel-buffer-space\"></div>\n    </div>\n  );\n};\n\nexport default Panel;","import React, { useState } from 'react';\n\n/**\n * A button component that prevents transaction spamming by managing its own state\n * and ensuring only one transaction can be active at a time.\n */\nconst TransactionButton = ({ \n  onAction, \n  children, \n  disabled = false,\n  transactionKey, // unique key for this action type\n  className = '',\n  style = {},\n  ...props \n}) => {\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [transactionId] = useState(() => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const handleClick = async (e) => {\n    if (isProcessing || disabled) return;\n    \n    e.preventDefault();\n    e.stopPropagation();\n    \n    setIsProcessing(true);\n    try {\n      await onAction(transactionId, transactionKey);\n    } catch (error) {\n      console.error('Transaction failed:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <button \n      {...props}\n      onClick={handleClick}\n      disabled={disabled || isProcessing}\n      className={`${className} ${isProcessing ? 'processing' : ''}`}\n      style={{\n        ...style,\n        opacity: (disabled || isProcessing) ? 0.6 : 1,\n        cursor: (disabled || isProcessing) ? 'not-allowed' : 'pointer'\n      }}\n    >\n      {isProcessing ? '' : children}\n    </button>\n  );\n};\n\nexport default TransactionButton;","import API_BASE from '../../config';\nimport axios from 'axios';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport './AnimalPanel.css';\n\nconst AnimalPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  npcId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) => {\n\n  const [stallDetails, setStallDetails] = useState(null);\n  const [currentNPC, setCurrentNPC] = useState(null);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n  const strings = useStrings();\n\n  console.log('--------Inside Animal Panel:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const stallResource = masterResources.find((res) => res.type === stationType);\n    setStallDetails(stallResource);\n  }, [stationType, masterResources]);\n\n  // Get current NPC data and update it periodically\n  useEffect(() => {\n    const updateNPCData = () => {\n      if (npcId && gridId) {\n        const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n        const npc = Object.values(npcsInGrid).find(n => n.id === npcId);\n        setCurrentNPC(npc);\n      }\n    };\n\n    updateNPCData(); // Initial load\n    const interval = setInterval(updateNPCData, 1000); // Update every second for live status\n\n    return () => clearInterval(interval);\n  }, [npcId, gridId]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Function to generate status text like the tooltip\n  const getNPCStatusText = (npc) => {\n    if (!npc) return \"Unknown status\";\n    \n    switch (npc.state) {\n      case 'processing':\n        return \"is ready.\";\n      case 'hungry':\n        const lookingFor = npc.type === 'Pig' ? 'dirt' : 'grass';\n        return `is hungry and looking for ${lookingFor}.`;\n      case 'grazing':\n        if (npc.grazeEnd) {\n          const remainingTime = Math.max(0, npc.grazeEnd - currentTime);\n          const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n          const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n          return `is grazing. ${minutes}m ${seconds}s`;\n        }\n        return \"is grazing.\";\n      case 'roam':\n        return \"is roaming.\";\n      case 'stall':\n        return \"is looking for an Animal Stall.\";\n      default:\n        return `is in ${npc.state} state.`;\n    }\n  };\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    const ingredients = [];\n    for (let i = 1; i <= 3; i++) {\n      const ingredientType = stallDetails[`ingredient${i}`];\n      const ingredientQty = stallDetails[`ingredient${i}qty`];\n      if (ingredientType && ingredientQty) {\n        ingredients.push({ type: ingredientType, quantity: ingredientQty });\n      }\n    }\n    if (!ingredients.length) { console.error('No ingredients found for refund.'); return; }\n\n    try {\n      for (const { type, quantity } of ingredients) {\n        const success = await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: type,\n          quantity,\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n        if (!success) return;\n      }\n\n      // Update currentPlayer with the new inventory to ensure money display updates\n      setCurrentPlayer(prev => ({ \n        ...prev, \n        inventory: inventory,\n        backpack: backpack \n      }));\n\n      // Note: We don't remove the animal stall building here - only the NPC\n      // The stall building can be sold separately from the AnimalStall panel\n\n      // Remove the animal NPC from NPCsInGrid using the specific NPC ID\n      try {\n        if (npcId) {\n          console.log(` Removing animal NPC ${npcId} (original position: ${currentStationPosition.x}, ${currentStationPosition.y})`);\n          await NPCsInGridManager.removeNPC(gridId, npcId);\n          console.log(\" Animal NPC removed from NPCsInGrid.\");\n        } else {\n          console.error(\"No NPC ID provided - cannot remove animal NPC\");\n        }\n      } catch (error) {\n        console.error('Error removing NPC:', error);\n      }\n\n      const totalRefund = ingredients\n        .filter((item) => item.type === \"Money\")\n        .reduce((sum, item) => sum + item.quantity, 0);\n\n      console.log(`Sold ${stationType} successfully for ${totalRefund} Money.`);\n      updateStatus(`Sold ${getLocalizedString(stationType, strings)} for ${totalRefund} ${getLocalizedString('Money', strings)}.`);\n      onClose();\n    } catch (error) {\n      console.error('Error selling the stall:', error);\n    }\n  };\n  \n\n  return (\n    <Panel onClose={onClose} titleKey=\"1129\" panelName=\"AnimalPanel\" >\n      <div className=\"animal-panel-container\">\n        <div className=\"animal-panel-content\">\n          <h2>\n              {stallDetails?.symbol || ''} {getLocalizedString(stationType, strings)}\n          </h2>\n\n          {/* Show current NPC status */}\n          {currentNPC && (\n            <p>\n              <strong>{getLocalizedString(currentNPC.type, strings)}</strong> {getNPCStatusText(currentNPC)}\n            </p>\n          )}\n        </div>\n        \n        {currentPlayer.location.gtype === 'homestead' && (\n          <div className=\"animal-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(AnimalPanel);\n","/**\n * Shared formatters for collection status messages\n * Used by both single and bulk collection operations\n */\n\n/**\n * Format harvest/collection results for status bar\n * @param {String} operation - Type of operation ('harvest', 'craft', 'animal', 'logging')\n * @param {Object} results - Collection results with items and quantities\n * @param {Object} skillsInfo - Skills applied for each item type\n * @param {Object} replantInfo - Optional replanting information\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted status message\n */\nexport function formatCollectionResults(operation, results, skillsInfo, replantInfo, strings, getLocalizedString) {\n  const parts = [];\n  \n  // Format the main collection based on operation type\n  const operationLabels = {\n    'harvest': strings[469] || 'Harvest complete',\n    'craft': strings[480] || 'Crafting complete',\n    'animal': strings[469] || 'Animal Collect complete',\n    'logging': strings[479] || 'Logging complete'\n  };\n  \n  const label = operationLabels[operation] || strings[469] || 'Complete';\n  \n  // Format collected items\n  if (results && Object.keys(results).length > 0) {\n    const itemParts = Object.entries(results).map(([type, quantity]) => {\n      const skillInfo = skillsInfo?.[type];\n      const localizedName = getLocalizedString(type, strings);\n      \n      if (skillInfo && skillInfo.hasSkills) {\n        const skillsStr = skillInfo.skills.join(', ');\n        return `${quantity} ${localizedName}, ${strings[481]} ${skillsStr} ${strings[482]} (${skillInfo.multiplier}x)`;\n      } else {\n        return `${quantity} ${localizedName}`;\n      }\n    }).join(', ');\n    \n    parts.push(`${label} ${itemParts}`);\n  }\n  \n  // Add replanting info if provided\n  if (replantInfo && Object.keys(replantInfo).length > 0) {\n    const replantParts = Object.entries(replantInfo)\n      .map(([type, count]) => `${count} ${getLocalizedString(type, strings)}`)\n      .join(', ');\n    parts.push(`${replantParts} ${strings[483] || 'replanted'}`);\n  }\n  \n  return parts.join(' | ');\n}\n\n/**\n * Format single item collection for status bar\n * @param {String} operation - Type of operation\n * @param {String} itemType - Type of item collected\n * @param {Number} quantity - Quantity collected\n * @param {Object} skillInfo - Skills applied\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted status message\n */\nexport function formatSingleCollection(operation, itemType, quantity, skillInfo, strings, getLocalizedString) {\n  const results = { [itemType]: quantity };\n  const skillsInfo = skillInfo ? { [itemType]: skillInfo } : {};\n  return formatCollectionResults(operation, results, skillsInfo, null, strings, getLocalizedString);\n}\n\n/**\n * Format restart/replant results\n * @param {Object} restartInfo - Information about restarted operations\n * @param {String} operation - Type of operation ('craft' or 'harvest')\n * @param {Object} strings - Localized strings\n * @param {Function} getLocalizedString - String localization function\n * @returns {String} Formatted restart message\n */\nexport function formatRestartResults(restartInfo, operation, strings, getLocalizedString) {\n  if (!restartInfo || Object.keys(restartInfo).length === 0) {\n    return '';\n  }\n  \n  const restartParts = Object.entries(restartInfo)\n    .map(([type, count]) => `${count} ${getLocalizedString(type, strings)}`)\n    .join(', ');\n  \n  const labels = {\n    'craft': 'restarted',\n    'harvest': 'replanted'\n  };\n  \n  const label = labels[operation] || 'restarted';\n  return `${restartParts} ${label}`;\n}","import { getDerivedRange } from '../../Utils/worldHelpers';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleNPCClick } from './NPCUtils';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { isWallBlocking, getLineOfSightTiles } from '../../Utils/GridManagement';\n\n// Shared global attack cooldown for consistency between DOM and Canvas modes\nlet globalAttackCooldown = 0;\n\n\n/**\n * Generates tooltip content for NPCs - shared between DOM and Canvas modes\n * This ensures identical tooltip behavior across rendering modes\n */\nexport function generateNPCTooltipContent(npc, strings) {\n  const localizedNPCType = getLocalizedString(npc.type, strings);\n  let tooltipContent = `<p>${localizedNPCType}</p>`;\n\n  switch (npc.action) {\n    case 'graze': {\n      switch (npc.state) {\n        case 'processing':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is ready.</p>`;\n          break;\n        case 'hungry': {\n          const lookingFor = npc.type === 'Pig' ? 'dirt' : 'grass';\n          tooltipContent = `<p>${localizedNPCType}</p><p>is hungry and</p><p>looking for ${lookingFor}.</p>`;\n          break;\n        }\n        case 'grazing': {\n          let countdownText = \"\";\n          if (npc.grazeEnd) {\n            const remainingTime = Math.max(0, npc.grazeEnd - Date.now());\n            const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n            const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n            countdownText = `<p>${minutes}m ${seconds}s</p>`;\n          }\n          tooltipContent = `<p>${localizedNPCType}</p><p>is grazing.</p>${countdownText}`;\n          break;\n        }\n        case 'idle':\n          tooltipContent = `<p>Zzzz...</p>`;\n          break;\n        case 'roam':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is roaming.</p>`;\n          break;\n        case 'stall':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is looking for an Animal Stall.</p>`;\n          break;\n        default:\n          tooltipContent = `<p>${localizedNPCType}</p>`;\n          break;\n      }\n      break;\n    }\n    case 'quest':\n      if (npc.type === 'Kent') {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[47] || 'Kent says hi!'}\"</p>`;\n      } else {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[48] || 'I have quests!'}\"</p>`;\n      }\n      break;\n    case 'trade':\n    case 'heal':\n    case 'worker':\n      tooltipContent = `<p>${localizedNPCType}</p>`;\n      break;\n    case 'attack':\n    case 'spawn':\n      tooltipContent = `<p>${localizedNPCType}</p><p>HP: ${npc.hp}/${npc.maxhp}</p>`;\n      // Add state info for enemy NPCs\n      if (npc.state) {\n        tooltipContent += `<p>State: ${npc.state}</p>`;\n      }\n      break;\n    default:\n      tooltipContent = `<p>${npc.type}</p>`;\n      break;\n  }\n\n  return tooltipContent;\n}\n\n/**\n * Handles NPC clicks with full parity to DOM mode logic - shared between DOM and Canvas\n * This ensures identical click behavior across rendering modes\n */\nexport function handleNPCClickShared(npc, {\n  currentPlayer,\n  playersInGrid,\n  gridId,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  globalTuning,\n  strings,\n  // Overlay checking function (optional - only used by DOM mode)\n  getNPCOverlay,\n  // Event handlers\n  onNPCClick,\n  setHoverTooltip,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation\n}) {\n  // Check if NPC has an overlay that prevents clicking (DOM mode feature)\n  if (getNPCOverlay) {\n    const overlayData = getNPCOverlay(npc.id);\n    if (overlayData && !overlayData.clickable) {\n      return false; // Prevent clicking on non-clickable overlay NPCs\n    }\n  }\n  \n  //  Prevent interaction with NPCs on another player's homestead\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n  if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead) {\n    return false; // Cannot interact with NPCs on another player's homestead\n  }\n  \n  // Clear any existing tooltip\n  if (setHoverTooltip) {\n    setHoverTooltip(null);\n  }\n  \n  const currentTime = Date.now();\n  \n  // Handle attack NPCs with cooldown\n  if (npc.action === 'attack' || npc.action === 'spawn') {\n    // Get player state from playersInGridManager like Combat.js does\n    const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n    const pcState = playersInGrid?.[String(currentPlayer._id)];\n    const speed = pcState?.speed ?? 5;\n    console.log(' Attack cooldown check:');\n    console.log('  Speed being used:', speed);\n    console.log('  pcState?.speed:', pcState?.speed);\n    if (currentTime < globalAttackCooldown) {\n      return false; // Still on cooldown\n    }\n    // New cooldown formula: speed 5 = 3.5s, speed 1 = 0.5s\n    // Formula: cooldown = 0.5 + (speed - 1) * 0.75\n    // This gives us: speed 1 = 0.5s, speed 2 = 1.25s, speed 3 = 2s, speed 4 = 2.75s, speed 5 = 3.5s\n    const cooldownSeconds = 0.5 + (speed - 1) * 0.75;\n    const cooldownDuration = cooldownSeconds * 1000;\n    globalAttackCooldown = currentTime + cooldownDuration;\n    console.log(` Setting new cooldown: ${cooldownDuration}ms (${cooldownSeconds} seconds for speed ${speed})`);\n    // Continue to handleNPCClick below for attack NPCs\n  }\n  \n  // Handle quest/heal/worker/trade NPCs with range checking\n  if (npc.action === 'quest' || npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade') {\n    // Check range for helper NPCs (skip on own homestead)\n    const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n    const playerPos = playersInGridManager.getPlayerPosition(currentPlayer?.location?.g, String(currentPlayer._id));\n    const npcPos = { x: Math.round(npc.position?.x || 0), y: Math.round(npc.position?.y || 0) };\n\n    if (!isOnOwnHomestead && playerPos && typeof playerPos.x === 'number' && typeof playerPos.y === 'number') {\n      const distance = Math.sqrt(Math.pow(playerPos.x - npcPos.x, 2) + Math.pow(playerPos.y - npcPos.y, 2));\n      const playerRange = getDerivedRange(currentPlayer, masterResources);\n\n      if (distance > playerRange) {\n        // Show \"Out of range\" message\n        FloatingTextManager.addFloatingText(24, npcPos.x, npcPos.y, TILE_SIZE);\n        return false;\n      }\n\n      // Check for walls blocking line of sight\n      if (isWallBlocking(playerPos, npcPos)) {\n        FloatingTextManager.addFloatingText(40, npcPos.x, npcPos.y, TILE_SIZE); // string[40] for wall blocking\n        console.log('Wall blocking interaction from player to NPC');\n        return false;\n      }\n    }\n    \n    // Use onNPCClick for these special NPCs (opens panels/dialogs)\n    if (onNPCClick) {\n      onNPCClick(npc);\n    }\n    return true;\n  }\n  \n  // Use handleNPCClick for all other NPCs (combat, grazing, etc.)\n  handleNPCClick(\n      npc,\n      Math.round(npc.position?.y || 0),\n      Math.round(npc.position?.x || 0),\n      setInventory,\n      setBackpack,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      TILE_SIZE,\n      masterResources,\n      masterSkills,\n      currentPlayer?.location?.g,\n      setModalContent,\n      setIsModalOpen,\n      updateStatus,\n      openPanel,\n      setActiveStation,\n      strings,\n      masterTrophies,\n      globalTuning\n    );\n    return true;\n}\n\n/**\n * Gets the current attack cooldown status\n */\nexport function getAttackCooldownStatus() {\n  return {\n    cooldownEnd: globalAttackCooldown,\n    isOnCooldown: Date.now() < globalAttackCooldown\n  };\n}\n\n/**\n * Determines cursor class for NPC based on action and cooldown status\n */\nexport function getNPCCursorClass(npc) {\n  if (npc.action === 'heal' || npc.action === 'worker' || npc.action === 'trade' || npc.action === 'quest') {\n    return 'cursor-help';\n  } else if (npc.action === 'attack' || npc.action === 'spawn') {\n    // For attack NPCs, check reload status\n    const currentTime = Date.now();\n    return currentTime < globalAttackCooldown ? 'cursor-wait' : 'cursor-crosshair';\n  }\n  return 'cursor-pointer';\n}\n\n/**\n * Sets the shared global attack cooldown (used by DOM mode to sync with shared state)\n */\nexport function setGlobalAttackCooldown(cooldownEnd) {\n  globalAttackCooldown = cooldownEnd;\n}","/**\n * Shared cursor logic for DOM and Canvas modes\n * Provides consistent cursor behavior across rendering modes\n */\nimport { getAttackCooldownStatus } from '../GameFeatures/NPCs/NPCInteractionUtils';\n\n/**\n * Determines the appropriate cursor style for an NPC\n * @param {Object} npc - The NPC object\n * @returns {string} CSS cursor class name\n */\nexport function getNPCCursorClass(npc) {\n  if (!npc) return 'cursor-pointer';\n  \n  // Handle different NPC types\n  switch (npc.action) {\n    case 'heal':\n    case 'worker':\n    case 'trade':\n    case 'quest':\n      return 'cursor-help';\n      \n    case 'attack':\n    case 'spawn':\n      // For attack NPCs, check cooldown status from shared state\n      const cooldownStatus = getAttackCooldownStatus();\n      return cooldownStatus.isOnCooldown ? 'cursor-wait' : 'cursor-crosshair';\n      \n    default:\n      return 'cursor-pointer';\n  }\n}\n\n/**\n * Determines the appropriate cursor style for a resource\n * @param {Object} resource - The resource object\n * @returns {string} CSS cursor class name\n */\nexport function getResourceCursorClass(resource) {\n  if (!resource) return 'cursor-pointer';\n  \n  // All interactive resources should show pointer cursor (finger)\n  // This includes crafting stations, farmhouses, doobers, etc.\n  return 'cursor-pointer';\n}\n\n/**\n * Applies cursor class to a DOM element\n * @param {HTMLElement} element - The DOM element\n * @param {string} cursorClass - The cursor class to apply\n */\nexport function applyCursorClass(element, cursorClass) {\n  if (!element) return;\n  \n  // Remove all cursor classes first\n  element.classList.remove('cursor-pointer', 'cursor-help', 'cursor-wait', 'cursor-crosshair');\n  \n  // Apply the new cursor class\n  if (cursorClass) {\n    element.classList.add(cursorClass);\n  }\n}\n\n/**\n * Sets cursor style for canvas elements using CSS\n * @param {HTMLCanvasElement} canvas - The canvas element\n * @param {string} cursorClass - The cursor class to apply\n */\nexport function setCanvasCursor(canvas, cursorClass) {\n  if (!canvas) return;\n  \n  // Map cursor classes to CSS cursor values\n  const cursorMap = {\n    'cursor-pointer': 'pointer',\n    'cursor-help': 'help',\n    'cursor-wait': 'wait',\n    'cursor-crosshair': 'crosshair'\n  };\n  \n  canvas.style.cursor = cursorMap[cursorClass] || 'default';\n}","/**\n * Utility functions for tooltip positioning with boundary checking\n * Ensures tooltips stay within the game container bounds\n */\n\n/**\n * Calculate tooltip position with boundary checking to keep it within the game container\n * @param {number} mouseX - Mouse X position (clientX)\n * @param {number} mouseY - Mouse Y position (clientY) \n * @param {string} gameContainerSelector - CSS selector for game container (default: '.homestead')\n * @returns {Object} - Adjusted tooltip position {x, y}\n */\nexport function calculateTooltipPosition(mouseX, mouseY, gameContainerSelector = '.homestead') {\n  const gameContainer = document.querySelector(gameContainerSelector);\n  \n  // Fallback to original position if container not found\n  if (!gameContainer) {\n    return { x: mouseX, y: mouseY };\n  }\n  \n  // Get container bounds relative to viewport\n  const containerRect = gameContainer.getBoundingClientRect();\n  \n  // Tooltip dimensions - estimate based on typical tooltip size\n  const tooltipWidth = 120; // Estimated tooltip width\n  const tooltipHeight = 60; // Estimated tooltip height\n  const margin = 10; // Margin from edges\n  \n  let adjustedX = mouseX;\n  let adjustedY = mouseY;\n  \n  // Check horizontal boundaries\n  // Since tooltip uses transform: translateX(-50%), we need to consider half width on each side\n  const tooltipLeftEdge = mouseX - (tooltipWidth / 2);\n  const tooltipRightEdge = mouseX + (tooltipWidth / 2);\n  \n  if (tooltipLeftEdge < containerRect.left + margin) {\n    // Tooltip would go off left edge - move it right\n    adjustedX = containerRect.left + margin + (tooltipWidth / 2);\n  } else if (tooltipRightEdge > containerRect.right - margin) {\n    // Tooltip would go off right edge - move it left\n    adjustedX = containerRect.right - margin - (tooltipWidth / 2);\n  }\n  \n  // Check vertical boundaries\n  // Tooltip renders above the cursor (bottom: calc(100vh - y + 10px))\n  // So we need to check if it would go off the top\n  const tooltipTop = mouseY - tooltipHeight - 10; // 10px offset from cursor\n  \n  if (tooltipTop < containerRect.top + margin) {\n    // Tooltip would go off top edge - position it below cursor instead\n    adjustedY = mouseY + 20; // Position below cursor with some offset\n  }\n  \n  // Check if positioning below would go off bottom edge\n  if (adjustedY + tooltipHeight + margin > containerRect.bottom) {\n    // Both above and below positions are problematic - keep it within bounds\n    adjustedY = Math.max(containerRect.top + margin + tooltipHeight, \n                        Math.min(mouseY, containerRect.bottom - margin - tooltipHeight));\n  }\n  \n  return { x: adjustedX, y: adjustedY };\n}\n\n/**\n * Enhanced version that also returns positioning mode for different CSS styles\n * @param {number} mouseX - Mouse X position (clientX)\n * @param {number} mouseY - Mouse Y position (clientY)\n * @param {string} gameContainerSelector - CSS selector for game container\n * @returns {Object} - {x, y, mode} where mode is 'above' or 'below'\n */\nexport function calculateTooltipPositionWithMode(mouseX, mouseY, gameContainerSelector = '.homestead') {\n  const gameContainer = document.querySelector(gameContainerSelector);\n  \n  if (!gameContainer) {\n    return { x: mouseX, y: mouseY, mode: 'above' };\n  }\n  \n  const containerRect = gameContainer.getBoundingClientRect();\n  const tooltipWidth = 120;\n  const tooltipHeight = 60;\n  const margin = 10;\n  \n  let adjustedX = mouseX;\n  let adjustedY = mouseY;\n  let mode = 'above'; // Default positioning mode\n  \n  // Horizontal boundary checking (same as basic version)\n  const tooltipLeftEdge = mouseX - (tooltipWidth / 2);\n  const tooltipRightEdge = mouseX + (tooltipWidth / 2);\n  \n  if (tooltipLeftEdge < containerRect.left + margin) {\n    adjustedX = containerRect.left + margin + (tooltipWidth / 2);\n  } else if (tooltipRightEdge > containerRect.right - margin) {\n    adjustedX = containerRect.right - margin - (tooltipWidth / 2);\n  }\n  \n  // Vertical boundary checking with mode detection\n  const tooltipTopWhenAbove = mouseY - tooltipHeight - 10;\n  const tooltipBottomWhenBelow = mouseY + 20 + tooltipHeight;\n  \n  if (tooltipTopWhenAbove < containerRect.top + margin) {\n    // Would go off top - try positioning below\n    if (tooltipBottomWhenBelow <= containerRect.bottom - margin) {\n      // Can fit below\n      adjustedY = mouseY;\n      mode = 'below';\n    } else {\n      // Can't fit above or below - constrain to container\n      adjustedY = containerRect.top + margin + tooltipHeight;\n      mode = 'above';\n    }\n  } else if (tooltipBottomWhenBelow > containerRect.bottom - margin) {\n    // Would go off bottom when positioned below - keep above\n    adjustedY = mouseY;\n    mode = 'above';\n  } else {\n    // Default above positioning works\n    adjustedY = mouseY;\n    mode = 'above';\n  }\n  \n  return { x: adjustedX, y: adjustedY, mode };\n}","// Singleton manager for active conversations\nclass ConversationManager {\n  constructor() {\n    this.activeConversations = new Map(); // speakerId -> {emoji, topic, timestamp}\n    this.relationshipOutcomes = new Map(); // speakerId -> {type: 'positive'|'negative', timestamp}\n    this.listeners = new Set();\n  }\n  \n  // Add a conversation bubble\n  // matchState can be: false, 'match', or 'rival'\n  addSpeech(speakerId, emoji, topic, matchState = false) {\n    console.log(' ConversationManager.addSpeech:', { speakerId, emoji, topic, matchState });\n    console.log(' Current active conversations:', Array.from(this.activeConversations.keys()));\n    this.activeConversations.set(speakerId, {\n      emoji,\n      topic,\n      timestamp: Date.now(),\n      matchState\n    });\n    this.notifyListeners();\n  }\n  \n  // Remove a conversation bubble\n  removeSpeech(speakerId) {\n    console.log(' ConversationManager.removeSpeech:', speakerId);\n    this.activeConversations.delete(speakerId);\n    this.notifyListeners();\n  }\n  \n  // Get active speech for a speaker\n  getSpeech(speakerId) {\n    return this.activeConversations.get(speakerId);\n  }\n  \n  // Subscribe to changes\n  subscribe(listener) {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n  \n  // Notify all listeners of changes\n  notifyListeners() {\n    this.listeners.forEach(listener => listener());\n  }\n  \n  // Clear all conversations\n  clear() {\n    this.activeConversations.clear();\n    this.relationshipOutcomes.clear();\n    this.notifyListeners();\n  }\n  \n  // Add relationship outcome VFX\n  // emoji parameter is optional - if not provided, uses default based on isPositive\n  showOutcome(speakerId, isPositive, emoji = null) {\n    const defaultEmoji = isPositive ? '' : '';\n    const finalEmoji = emoji || defaultEmoji;\n    console.log(' showOutcome called:', { speakerId, isPositive, emoji, defaultEmoji, finalEmoji });\n    this.relationshipOutcomes.set(speakerId, {\n      type: isPositive ? 'positive' : 'negative',\n      emoji: finalEmoji,\n      timestamp: Date.now()\n    });\n    this.notifyListeners();\n\n    // Auto-remove after animation duration\n    setTimeout(() => {\n      this.relationshipOutcomes.delete(speakerId);\n      this.notifyListeners();\n    }, 2500); // 2.5 seconds for animation\n  }\n  \n  // Get outcome for a speaker\n  getOutcome(speakerId) {\n    const outcome = this.relationshipOutcomes.get(speakerId);\n    return outcome;\n  }\n}\n\n// Export singleton instance\nexport default new ConversationManager();","import React, { useRef, useEffect, useCallback, useMemo } from 'react';\nimport SVGAssetManager from './SVGAssetManager';\nimport { OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\nimport { generateNPCTooltipContent, handleNPCClickShared, getAttackCooldownStatus } from '../GameFeatures/NPCs/NPCInteractionUtils';\nimport { getNPCCursorClass, setCanvasCursor } from '../Utils/CursorUtils';\nimport { calculateTooltipPosition } from '../Utils/TooltipUtils';\nimport ConversationManager from '../GameFeatures/Relationships/ConversationManager';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\n\n// NPC art mapping - maps NPC types to SVG files\n// Start with a few NPCs for testing, can expand later\nconst NPC_ART_MAPPING = {\n  // Add NPC types as we create SVG art for them\n  // 'Farmer': 'farmer.svg',\n  // 'Kent': 'kent.svg',\n  // For now, we'll render NPCs as emoji symbols in canvas\n};\n\n// Canvas-based NPC renderer component\nconst RenderNPCsCanvasComponent = ({ \n  npcs,\n  TILE_SIZE,\n  currentPlayer,\n  globalTuning,\n  gridId,\n  onNPCClick,\n  onMouseEnter,\n  onMouseLeave,\n  // Status checking functions\n  checkQuestNPCStatus,\n  checkTradeNPCStatus,\n  checkKentNPCStatus,\n  getOverlayContent,\n  // Additional props for NPC interactions\n  strings,\n  masterResources,\n  playersInGrid,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  setHoverTooltip\n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n  const currentHoveredNPC = useRef(null); // Track which NPC is currently being hovered\n  const tooltipUpdateInterval = useRef(null); // Timer for updating time-based tooltips\n  const cursorUpdateInterval = useRef(null); // Timer for updating cursor when cooldown expires\n  \n  // Canvas-specific animation system (mimics DOM's CSS transitions)\n  const canvasAnimations = useRef({});\n  const animationFrameId = useRef(null);\n  const renderNPCsRef = useRef(null);\n  // Removed bounceAnimations - no longer bouncing\n  \n  // Use NPCs directly without memoization to ensure we see all position updates\n  useEffect(() => {\n    // Removed log to reduce noise\n  }, [npcs]);\n  \n  // Update SVGAssetManager zoom tiers when globalTuning changes\n  useEffect(() => {\n    if (globalTuning) {\n      SVGAssetManager.updateZoomTiers(globalTuning);\n    }\n  }, [globalTuning]);\n\n  // Animation loop (mimics CSS transition behavior)\n  const startAnimationLoop = useCallback(() => {\n    const animate = () => {\n      const now = Date.now();\n      let hasActiveAnimations = false;\n      \n      // Update all animation positions\n      Object.keys(canvasAnimations.current).forEach(npcId => {\n        const animation = canvasAnimations.current[npcId];\n        if (!animation || animation.duration === 0) return;\n        \n        const elapsed = now - animation.startTime;\n        \n        if (elapsed >= animation.duration) {\n          // Animation complete\n          animation.currentPos = { ...animation.targetPos };\n          animation.duration = 0;\n        } else {\n          // Linear interpolation (matches DOM CSS 'linear' timing)\n          const progress = elapsed / animation.duration;\n          animation.currentPos = {\n            x: animation.startPos.x + (animation.targetPos.x - animation.startPos.x) * progress,\n            y: animation.startPos.y + (animation.targetPos.y - animation.startPos.y) * progress\n          };\n          hasActiveAnimations = true;\n        }\n      });\n      \n      // Re-render canvas\n      if (renderNPCsRef.current) {\n        renderNPCsRef.current();\n      }\n      \n      // Removed bounce animation checks - no longer bouncing\n      \n      // Continue loop if there are active animations\n      if (hasActiveAnimations) {\n        animationFrameId.current = requestAnimationFrame(animate);\n      } else {\n        animationFrameId.current = null;\n      }\n    };\n    \n    animationFrameId.current = requestAnimationFrame(animate);\n  }, []);\n\n  // Start animation when NPC positions change\n  // Re-run whenever the NPCs array or positions change\n  useEffect(() => {\n    if (!npcs || npcs.length === 0) return;\n    \n    // Removed log to reduce noise\n    let hasPositionChanges = false;\n    \n    npcs.forEach(npc => {\n      const currentAnimation = canvasAnimations.current[npc.id];\n      \n      // NPCs use their actual position, not renderPositions (that's for PCs)\n      const targetPos = { x: npc.position.x, y: npc.position.y };\n      \n      if (!currentAnimation) {\n        // First time - just set position\n        // NPC initialized\n        canvasAnimations.current[npc.id] = {\n          startPos: { ...targetPos },\n          currentPos: { ...targetPos },\n          targetPos: { ...targetPos },\n          startTime: Date.now(),\n          duration: 0 // No animation needed for first time\n        };\n        hasPositionChanges = true;\n      } else if (currentAnimation.targetPos.x !== targetPos.x || currentAnimation.targetPos.y !== targetPos.y) {\n        // Position changed - start new animation from current position\n        // NPC moved\n        canvasAnimations.current[npc.id] = {\n          startPos: { ...currentAnimation.currentPos },\n          currentPos: { ...currentAnimation.currentPos },\n          targetPos: { ...targetPos },\n          startTime: Date.now(),\n          duration: 1200 // 1.2s to match DOM CSS transitions\n        };\n        hasPositionChanges = true;\n        \n        // Start animation loop if not already running\n        if (!animationFrameId.current) {\n          startAnimationLoop();\n        }\n      }\n    });\n    \n    // Always trigger a render when this effect runs\n    if (renderNPCsRef.current) {\n      // Triggering canvas render\n      renderNPCsRef.current();\n    }\n  }, [npcs, startAnimationLoop]);\n\n  // Cleanup animation loop on unmount\n  useEffect(() => {\n    return () => {\n      if (animationFrameId.current) {\n        cancelAnimationFrame(animationFrameId.current);\n        animationFrameId.current = null;\n      }\n    };\n  }, []);\n\n  // Get current render position for NPC (includes animation state)\n  const getNPCRenderPosition = useCallback((npc) => {\n    const animation = canvasAnimations.current[npc.id];\n    if (animation) {\n      return animation.currentPos;\n    }\n    // Fallback to base position if no animation data\n    return npc.position;\n  }, []);\n\n  // Removed setBounceAnimation function - no longer bouncing\n\n  // Removed getBounceOffset function - no longer bouncing\n\n  // Removed bounce animation management - no longer bouncing\n\n  // Stop tooltip update timer (defined first to avoid dependency issues)\n  const stopTooltipTimer = useCallback(() => {\n    if (tooltipUpdateInterval.current) {\n      clearInterval(tooltipUpdateInterval.current);\n      tooltipUpdateInterval.current = null;\n    }\n  }, []);\n\n  // Stop cursor update interval\n  const stopCursorUpdateInterval = useCallback(() => {\n    if (cursorUpdateInterval.current) {\n      clearInterval(cursorUpdateInterval.current);\n      cursorUpdateInterval.current = null;\n    }\n  }, []);\n\n  // Function to update tooltip if currently hovering over an NPC\n  const updateCurrentTooltip = useCallback(() => {\n    if (!currentHoveredNPC.current || !setHoverTooltip) return;\n    \n    // Get fresh NPC data directly from NPCsInGridManager for most up-to-date info\n    const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (!npcsInGrid) return;\n    \n    // Find the current NPC being hovered in the fresh data\n    const npc = Object.values(npcsInGrid).find(n => n && n.id === currentHoveredNPC.current.id);\n    if (!npc) {\n      // NPC no longer exists, clear tooltip\n      setHoverTooltip(null);\n      currentHoveredNPC.current = null;\n      stopTooltipTimer();\n      return;\n    }\n    \n    // Generate fresh tooltip content with updated data\n    const tooltipContent = generateNPCTooltipContent(npc, strings);\n    \n    // Update tooltip with fresh content, keeping same position\n    if (currentHoveredNPC.current.tooltipData) {\n      setHoverTooltip({\n        x: currentHoveredNPC.current.tooltipData.x,\n        y: currentHoveredNPC.current.tooltipData.y,\n        content: tooltipContent\n      });\n    }\n  }, [gridId, strings, setHoverTooltip, stopTooltipTimer]);\n\n  // Start tooltip update timer for time-based data (graze countdowns, etc.)\n  const startTooltipTimer = useCallback(() => {\n    if (tooltipUpdateInterval.current) return; // Already running\n    \n    tooltipUpdateInterval.current = setInterval(() => {\n      // Call updateCurrentTooltip directly without dependencies to ensure fresh data\n      if (!currentHoveredNPC.current || !setHoverTooltip) return;\n      \n      // Get fresh NPC data directly from NPCsInGridManager for most up-to-date info\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (!npcsInGrid) return;\n      \n      // Find the current NPC being hovered in the fresh data\n      const npc = Object.values(npcsInGrid).find(n => n && n.id === currentHoveredNPC.current.id);\n      if (!npc) {\n        // NPC no longer exists, clear tooltip\n        setHoverTooltip(null);\n        currentHoveredNPC.current = null;\n        if (tooltipUpdateInterval.current) {\n          clearInterval(tooltipUpdateInterval.current);\n          tooltipUpdateInterval.current = null;\n        }\n        return;\n      }\n      \n      // Generate fresh tooltip content with updated data\n      const tooltipContent = generateNPCTooltipContent(npc, strings);\n      \n      // Update tooltip with fresh content, keeping same position\n      if (currentHoveredNPC.current.tooltipData) {\n        setHoverTooltip({\n          x: currentHoveredNPC.current.tooltipData.x,\n          y: currentHoveredNPC.current.tooltipData.y,\n          content: tooltipContent\n        });\n      }\n    }, 1000); // Update every second\n  }, [gridId, strings, setHoverTooltip]); // Include direct dependencies instead of updateCurrentTooltip\n\n  // Update tooltip when NPC data changes (making tooltips reactive)\n  useEffect(() => {\n    updateCurrentTooltip();\n  }, [npcs, updateCurrentTooltip]);\n\n  // Cleanup timer on unmount\n  useEffect(() => {\n    return () => {\n      stopTooltipTimer();\n      stopCursorUpdateInterval();\n    };\n  }, [stopTooltipTimer, stopCursorUpdateInterval]);\n  \n  // Render NPCs to canvas\n  const renderNPCs = useCallback(async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !npcs) return;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // First render all attack range indicators (behind NPCs)\n    npcs.forEach(npc => {\n      if (!npc || !npc.position || typeof npc.position.x === 'undefined' || typeof npc.position.y === 'undefined') {\n        return;\n      }\n      renderNPCAttackRange(ctx, npc, TILE_SIZE);\n    });\n    \n    // Then render NPCs and their overlays\n    for (const npc of npcs) {\n      if (!npc || !npc.position || typeof npc.position.x === 'undefined' || typeof npc.position.y === 'undefined') {\n        continue; // Skip NPCs without valid position data\n      }\n      \n      renderSingleNPC(ctx, npc, TILE_SIZE);\n      await renderNPCOverlay(ctx, npc, TILE_SIZE);\n    }\n  }, [npcs, TILE_SIZE, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus, getNPCRenderPosition, currentPlayer]);\n\n  // Store renderNPCs function in ref for animation loop access\n  useEffect(() => {\n    renderNPCsRef.current = renderNPCs;\n    // Trigger immediate render when function is first set\n    if (npcs && npcs.length > 0) {\n      // RenderNPCs function ready\n      renderNPCs();\n    }\n  }, [renderNPCs, npcs]);\n\n  // Render a single NPC\n  const renderSingleNPC = (ctx, npc, TILE_SIZE) => {\n    // Use interpolated position for smooth movement\n    const renderPos = getNPCRenderPosition(npc);\n    const x = renderPos.x * TILE_SIZE;\n    const y = renderPos.y * TILE_SIZE;\n    \n    // Removed bounce offset - no longer bouncing\n    \n    // Check if we have custom SVG art for this NPC type\n    const customArt = NPC_ART_MAPPING[npc.type];\n    \n    if (customArt) {\n      // For now, skip SVG loading since it's async and we don't have any NPC art yet\n      // Just use emoji rendering\n      renderNPCEmoji(ctx, npc, x, y, TILE_SIZE);\n    } else {\n      // Render NPC as emoji symbol (fallback for NPCs without SVG art)\n      renderNPCEmoji(ctx, npc, x, y, TILE_SIZE);\n    }\n  };\n\n  // Render NPC as emoji symbol in canvas\n  const renderNPCEmoji = (ctx, npc, x, y, TILE_SIZE) => {\n    ctx.save();\n    ctx.font = `${TILE_SIZE * 0.8}px sans-serif`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    \n    // Position text in center of tile\n    const centerX = x + TILE_SIZE / 2;\n    const centerY = y + TILE_SIZE / 2;\n    \n    ctx.fillText(npc.symbol || '', centerX, centerY);\n    ctx.restore();\n  };\n\n  // Render attack range indicator for NPCs\n  const renderNPCAttackRange = (ctx, npc, TILE_SIZE) => {\n    // Check if range indicators should be shown\n    const showRangeIndicator = currentPlayer?.settings?.rangeOn !== false && \n                               (npc.action === 'attack' || npc.action === 'spawn') && \n                               npc.attackrange && \n                               npc.attackrange > 0;\n    \n    if (!showRangeIndicator) return;\n    \n    // Use interpolated position for smooth movement with range indicator\n    const renderPos = getNPCRenderPosition(npc);\n    const centerX = (renderPos.x + 0.5) * TILE_SIZE; // Center of the tile\n    const centerY = (renderPos.y + 0.5) * TILE_SIZE;\n    \n    // Removed bounce offset - no longer bouncing\n    \n    const radius = npc.attackrange * TILE_SIZE;\n    \n    ctx.save();\n    ctx.strokeStyle = 'rgba(255, 255, 100, 0.3)'; // Yellow for enemies (matching original)\n    ctx.setLineDash([5, 5]); // Dashed line\n    ctx.lineWidth = 2;\n    \n    // Draw circle\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);\n    ctx.stroke();\n    \n    ctx.restore();\n  };\n\n  // Render overlay for an NPC (status indicators)\n  const renderNPCOverlay = async (ctx, npc, TILE_SIZE) => {\n    // Determine what overlay to show for this NPC\n    let overlayType = null;\n    \n    // Check quest NPCs first (including Kent)\n    if (npc.action === 'quest' && checkQuestNPCStatus) {\n      overlayType = await checkQuestNPCStatus(npc);\n      \n      // For Kent, also check affordable offers if no quest overlay\n      if (!overlayType && npc.type === 'Kent' && checkKentNPCStatus) {\n        overlayType = checkKentNPCStatus(npc);\n      }\n    }\n    // Check trade NPCs\n    else if (npc.action === 'trade' && checkTradeNPCStatus) {\n      overlayType = checkTradeNPCStatus(npc);\n    }\n    \n    if (!overlayType) return; // No overlay needed\n    \n    // For trade NPCs, overlayType might be the trade item symbol\n    // For other NPCs, it's a status like 'completed', 'available', etc.\n    let svgFileName = OVERLAY_SVG_MAPPING[overlayType];\n    \n    if (!svgFileName && overlayType && overlayType.length <= 3) {\n      // Trade NPC with item symbol - use hand.svg as fallback\n      svgFileName = OVERLAY_SVG_MAPPING['available']; // hand.svg\n    }\n    \n    if (svgFileName) {\n      // Use interpolated position for overlays to match NPC movement  \n      const interpolatedPos = getNPCRenderPosition(npc);\n      const x = interpolatedPos.x * TILE_SIZE;\n      const y = interpolatedPos.y * TILE_SIZE;\n      \n      // Removed bounce offset - no longer bouncing\n      \n      // Position overlay in lower-left corner of the NPC\n      // Scale overlay more appropriately for different zoom levels\n      let overlaySize;\n      if (TILE_SIZE <= 16) {\n        // Far zoom: use smaller minimum and ratio\n        overlaySize = Math.max(6, TILE_SIZE * 0.35);\n      } else if (TILE_SIZE <= 30) {\n        // Close zoom: standard sizing\n        overlaySize = Math.max(10, TILE_SIZE * 0.35);\n      } else {\n        // Closer zoom: allow larger overlays\n        overlaySize = Math.max(14, TILE_SIZE * 0.35);\n      }\n      \n      const overlayX = x + 2; // Small offset from left edge\n      const overlayY = y + TILE_SIZE - overlaySize - 2; // Lower corner\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        svgFileName, \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      } else {\n        console.warn(`Failed to load overlay texture for NPC ${npc.type}: ${svgFileName}`);\n      }\n    }\n  };\n\n  // Re-render when NPCs change or TILE_SIZE changes\n  // This ensures NPCs appear immediately when the component mounts\n  useEffect(() => {\n    if (renderNPCsRef.current) {\n      renderNPCsRef.current();\n    }\n  }, [npcs, TILE_SIZE, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus, currentPlayer, renderNPCs]);\n\n  // Handle canvas clicks and convert to grid coordinates\n  const handleCanvasClick = useCallback((event) => {\n    if (!onNPCClick) return;\n    \n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Find NPC at this position\n    const npc = npcs?.find(n => {\n      const renderPos = getNPCRenderPosition(n);\n      return Math.floor(renderPos.x) === colIndex && Math.floor(renderPos.y) === rowIndex;\n    });\n    \n    if (npc) {\n      // NPC found - handle the click and stop propagation\n      event.preventDefault();\n      event.stopPropagation();\n      \n      // Use the shared click handler that includes cooldown logic for attack NPCs\n      handleNPCClickShared(npc, {\n        currentPlayer,\n        playersInGrid,\n        gridId,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        masterTrophies,\n        globalTuning,\n        strings,\n        // Event handlers\n        onNPCClick,\n        setHoverTooltip,\n        setInventory,\n        setBackpack,\n        setResources,\n        setCurrentPlayer,\n        setModalContent,\n        setIsModalOpen,\n        updateStatus,\n        openPanel,\n        setActiveStation\n      });\n    } else {\n      // No NPC found - forward this click to the grid by finding the underlying element\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Temporarily hide the canvas so we can find what's underneath\n        canvas.style.pointerEvents = 'none';\n        \n        // Find the element at this position\n        const elementBelow = document.elementFromPoint(event.clientX, event.clientY);\n        \n        // Restore canvas pointer events\n        canvas.style.pointerEvents = 'auto';\n        \n        // If we found an element below, simulate a click on it\n        if (elementBelow) {\n          const clickEvent = new MouseEvent('click', {\n            bubbles: true,\n            cancelable: true,\n            clientX: event.clientX,\n            clientY: event.clientY,\n            button: event.button,\n            buttons: event.buttons\n          });\n          elementBelow.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, [onNPCClick, npcs, TILE_SIZE, getNPCRenderPosition]);\n\n  // Start cursor update interval for attack NPCs\n  const startCursorUpdateInterval = useCallback((npc, canvas) => {\n    // Only start for attack NPCs\n    if (npc.action !== 'attack' && npc.action !== 'spawn') return;\n    \n    console.log(' Starting cursor update interval for attack NPC:', npc.id);\n    \n    // Clear any existing interval\n    if (cursorUpdateInterval.current) {\n      clearInterval(cursorUpdateInterval.current);\n      cursorUpdateInterval.current = null;\n    }\n    \n    // Check cursor status every 100ms\n    cursorUpdateInterval.current = setInterval(() => {\n      // Make sure we're still hovering over the same NPC\n      if (!currentHoveredNPC.current || currentHoveredNPC.current.id !== npc.id) {\n        console.log(' Stopping cursor update - no longer hovering');\n        if (cursorUpdateInterval.current) {\n          clearInterval(cursorUpdateInterval.current);\n          cursorUpdateInterval.current = null;\n        }\n        return;\n      }\n      \n      // Update cursor based on current cooldown status\n      const cursorClass = getNPCCursorClass(npc);\n      const currentTime = Date.now();\n      console.log(' Cursor update check:', {\n        npc: npc.id,\n        cursorClass,\n        currentTime,\n        globalAttackCooldown: getAttackCooldownStatus().cooldownEnd,\n        isOnCooldown: getAttackCooldownStatus().isOnCooldown\n      });\n      setCanvasCursor(canvas, cursorClass);\n    }, 100);\n  }, []);\n\n  // Handle mouse events for tooltips and dynamic cursor\n  const handleCanvasMouseMove = useCallback((event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Find NPC at this position\n    const npc = npcs?.find(n => {\n      const renderPos = getNPCRenderPosition(n);\n      return Math.floor(renderPos.x) === colIndex && Math.floor(renderPos.y) === rowIndex;\n    });\n    \n    if (npc) {\n      // NPC found - set appropriate cursor and handle tooltip\n      const cursorClass = getNPCCursorClass(npc);\n      setCanvasCursor(canvas, cursorClass);\n      \n      // Generate tooltip content using shared function\n      const tooltipContent = generateNPCTooltipContent(npc, strings);\n      \n      // Position tooltip at mouse position and track which NPC is being hovered\n      if (setHoverTooltip) {\n        const tooltipPosition = calculateTooltipPosition(event.clientX, event.clientY);\n        const tooltipData = {\n          x: tooltipPosition.x,\n          y: tooltipPosition.y,\n          content: tooltipContent,\n        };\n        setHoverTooltip(tooltipData);\n        \n        // Store current hovered NPC and tooltip position for reactive updates\n        currentHoveredNPC.current = {\n          id: npc.id,\n          tooltipData: tooltipData\n        };\n        \n        // Start timer for time-based tooltip updates (graze countdowns, etc.)\n        startTooltipTimer();\n        \n        // Start cursor update interval for attack NPCs\n        startCursorUpdateInterval(npc, canvas);\n      }\n    } else {\n      // No NPC - show default cursor and clear tooltip\n      setCanvasCursor(canvas, null); // Reset to default\n      if (setHoverTooltip) {\n        setHoverTooltip(null);\n      }\n      // Clear tracked hovered NPC and stop timers\n      currentHoveredNPC.current = null;\n      stopTooltipTimer();\n      stopCursorUpdateInterval();\n    }\n  }, [onMouseEnter, setHoverTooltip, strings, npcs, TILE_SIZE, getNPCRenderPosition, startTooltipTimer, stopTooltipTimer, startCursorUpdateInterval, stopCursorUpdateInterval]);\n\n  const handleCanvasMouseLeave = useCallback((event) => {\n    // Clear tooltip when leaving canvas\n    if (setHoverTooltip) {\n      setHoverTooltip(null);\n    }\n    \n    // Clear tracked hovered NPC and stop timers\n    currentHoveredNPC.current = null;\n    stopTooltipTimer();\n    stopCursorUpdateInterval();\n    \n    if (onMouseLeave) {\n      onMouseLeave(event);\n    }\n  }, [onMouseLeave, setHoverTooltip, stopTooltipTimer]);\n\n\n  return (\n    <canvas\n      ref={canvasRef}\n      onClick={handleCanvasClick}\n      onMouseMove={handleCanvasMouseMove}\n      onMouseLeave={handleCanvasMouseLeave}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 15, // Same as DOM NPCs\n        pointerEvents: 'auto'\n      }}\n    />\n  );\n};\n\n// Export component without complex memoization to ensure position updates are seen\nexport const RenderNPCsCanvas = RenderNPCsCanvasComponent;","import React from 'react';\nimport { RenderNPCsCanvas } from './RenderNPCsCanvas';\n\n/**\n * Main NPC rendering component - FORCED TO CANVAS MODE ONLY\n * Only handles the actual NPC entities, not their overlays or tooltips\n */\nexport const RenderNPCs = ({ \n  npcs,\n  TILE_SIZE,\n  currentPlayer,\n  globalTuning,\n  gridId,\n  onNPCClick,\n  \n  // NPC status checking functions (shared logic)\n  checkQuestNPCStatus,\n  checkTradeNPCStatus,\n  checkKentNPCStatus,\n  \n  // Props for NPC interactions\n  strings,\n  masterResources,\n  playersInGrid,\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  setHoverTooltip,\n  \n  // useCanvasNPCs removed - always Canvas mode now\n}) => {\n  // FORCED TO CANVAS MODE - no decision tree\n  return (\n    <RenderNPCsCanvas\n        npcs={npcs}\n        TILE_SIZE={TILE_SIZE}\n        currentPlayer={currentPlayer}\n        globalTuning={globalTuning}\n        gridId={gridId}\n        onNPCClick={onNPCClick}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n        strings={strings}\n        masterResources={masterResources}\n        playersInGrid={playersInGrid}\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        setResources={setResources}\n        setCurrentPlayer={setCurrentPlayer}\n        masterSkills={masterSkills}\n        setModalContent={setModalContent}\n        setIsModalOpen={setIsModalOpen}\n        updateStatus={updateStatus}\n        openPanel={openPanel}\n        setActiveStation={setActiveStation}\n        masterTrophies={masterTrophies}\n        setHoverTooltip={setHoverTooltip}\n      />\n  );\n};\n\nexport default RenderNPCs;","import React, { useEffect, useState, useRef } from 'react';\nimport ConversationManager from '../GameFeatures/Relationships/ConversationManager';\nimport { getDerivedRange } from '../Utils/worldHelpers';\nimport { renderPositions } from '../PlayerMovement';\nimport './PCComponent.css';\n\nconst PCComponent = ({\n  pc,\n  TILE_SIZE,\n  currentPlayer,\n  isCurrentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings,\n  setHoverTooltip,\n  connectedPlayers\n}) => {\n  const [isHovered, setIsHovered] = useState(false);\n  // Health bar removed - using tooltips instead\n  const [conversationIcon, setConversationIcon] = useState(null);\n  const [speechBubble, setSpeechBubble] = useState(null);\n  const [relationshipOutcome, setRelationshipOutcome] = useState(null);\n  const elementRef = useRef(null);\n  const hoverTimeoutRef = useRef(null);\n  const prevTileSizeRef = useRef(TILE_SIZE);\n\n  // State to force re-renders during animation\n  const [, forceUpdate] = useState({});\n  \n  // Use renderPositions for interpolated movement, fallback to pc.position\n  const overridePos = renderPositions[pc.playerId];\n  const position = overridePos || pc.position;\n  \n  // Animation loop to update position from renderPositions\n  useEffect(() => {\n    let animationFrameId;\n    \n    const updatePosition = () => {\n      // Force re-render if we have an override position\n      if (renderPositions[pc.playerId]) {\n        forceUpdate({});\n      }\n      animationFrameId = requestAnimationFrame(updatePosition);\n    };\n    \n    animationFrameId = requestAnimationFrame(updatePosition);\n    \n    return () => {\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n    };\n  }, [pc.playerId]);\n  \n  // Detect TILE_SIZE changes to disable transitions\n  const tileSizeChanged = prevTileSizeRef.current !== TILE_SIZE;\n  useEffect(() => {\n    prevTileSizeRef.current = TILE_SIZE;\n  }, [TILE_SIZE]);\n\n  // Subscribe to conversation changes\n  useEffect(() => {\n    const updateConversation = () => {\n      const speech = ConversationManager.getSpeech(pc.playerId);\n      setSpeechBubble(speech);\n      \n      const outcome = ConversationManager.getOutcome(pc.playerId);\n      setRelationshipOutcome(outcome);\n    };\n    \n    updateConversation();\n    const unsubscribe = ConversationManager.subscribe(updateConversation);\n    return unsubscribe;\n  }, [pc.playerId]);\n\n  const handleClick = async (e) => {\n    e.stopPropagation();\n\n    // Only open social panel - no combat\n    if (onPCClick) {\n      onPCClick(pc);\n    }\n  };\n\n  const handleMouseEnter = () => {\n    setIsHovered(true);\n    \n    // Removed health bar logic - using tooltips instead\n\n    // Show tooltip only for other players\n    if (!isCurrentPlayer && setHoverTooltip) {\n      const rect = elementRef.current?.getBoundingClientRect();\n      if (rect) {\n        const username = pc.username || 'Anonymous';\n        let content = `<p>${username}</p><p> HP: ${pc.hp}</p>`;\n        if (pc.iscamping) content += `<p> Camping</p>`;\n        if (pc.isinboat) content += `<p> In a boat</p>`;\n        \n        setHoverTooltip({\n          x: rect.left + rect.width / 2,\n          y: rect.top,\n          content\n        });\n      }\n    }\n  };\n\n  const handleMouseLeave = () => {\n    setIsHovered(false);\n    // Health bar state removed\n    \n    if (hoverTimeoutRef.current) {\n      clearTimeout(hoverTimeoutRef.current);\n    }\n    \n    if (setHoverTooltip) {\n      setHoverTooltip(null);\n    }\n  };\n\n  // Health calculations removed - using tooltips\n  const isCamping = pc.iscamping;\n  const isInBoat = pc.isinboat;\n  \n  // Check if range indicators should be shown (only for current player)\n  const showRangeIndicators = isCurrentPlayer && currentPlayer?.settings?.rangeOn !== false;\n  const derivedRange = showRangeIndicators ? getDerivedRange(currentPlayer, masterResources) : 0;\n  const attackRange = showRangeIndicators ? pc.attackrange : 0;\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n\n  // Check if this player is currently connected (online)\n  const isConnected = isCurrentPlayer || connectedPlayers?.has(pc.playerId);\n\n  return (\n    <>\n      {/* Regular range indicator (gray circle) - hidden on own homestead since no range restrictions there */}\n      {showRangeIndicators && derivedRange > 1 && !isOnOwnHomestead && (\n        <div\n          className=\"attack-range player-range\"\n          style={{\n            position: 'absolute',\n            left: `${position.x * TILE_SIZE - derivedRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            top: `${position.y * TILE_SIZE - derivedRange * TILE_SIZE + TILE_SIZE / 2}px`,\n            width: `${derivedRange * 2 * TILE_SIZE}px`,\n            height: `${derivedRange * 2 * TILE_SIZE}px`,\n            backgroundColor: 'rgba(128, 128, 128, 0.2)',\n            borderRadius: '50%',\n            pointerEvents: 'none',\n            zIndex: 10,\n          }}\n        />\n      )}\n\n      {/* Combat/Attack range indicator (red dotted circle) - hidden on own homestead */}\n      {showRangeIndicators && attackRange > 0 && !isOnOwnHomestead && (\n        <div\n          className=\"attack-range player-attack-range\"\n          style={{\n            position: 'absolute',\n            left: `${position.x * TILE_SIZE - attackRange * TILE_SIZE + TILE_SIZE / 2 - 3}px`,\n            top: `${position.y * TILE_SIZE - attackRange * TILE_SIZE + TILE_SIZE / 2 - 3}px`,\n            width: `${attackRange * 2 * TILE_SIZE}px`,\n            height: `${attackRange * 2 * TILE_SIZE}px`,\n            border: '3px dotted rgba(255, 0, 0, 0.4)',\n            borderRadius: '50%',\n            pointerEvents: 'none',\n            zIndex: 11,\n          }}\n        />\n      )}\n\n\n      {/* PC character */}\n      <div\n        ref={elementRef}\n        className={`pc ${isCurrentPlayer ? 'current-player' : 'other-player'} ${isHovered ? 'hovered' : ''}`}\n      style={{\n        position: 'absolute',\n        left: `${position.x * TILE_SIZE}px`,\n        top: `${position.y * TILE_SIZE}px`,\n        width: `${TILE_SIZE}px`,\n        height: `${TILE_SIZE}px`,\n        fontSize: `${TILE_SIZE * 0.7}px`,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 16,\n        pointerEvents: 'auto',\n        cursor: 'pointer',\n        opacity: isConnected ? 1 : 0.4,\n      }}\n      onClick={handleClick}\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n    >\n      {/* Player icon with modifiers */}\n      <span className=\"pc-icon\">\n        {pc.hp === 0 ? '' : pc.hp < 100 ? '' : isCamping ? '' : isInBoat ? '' : pc.icon}\n      </span>\n\n      {/* Conversation speech bubble - Moved to RenderDynamicElements */}\n      \n      {/* Relationship outcome VFX - Moved to RenderDynamicElements */}\n\n      {/* Health bar - removed to avoid duplicate UI */}\n\n      {/* Player name - now in tooltip */}\n      </div>\n    </>\n  );\n};\n\nexport default React.memo(PCComponent);","import React from 'react';\nimport PCComponent from './PCComponent';\n\n/**\n * DOM-based PC (Player Character) renderer - uses the original PCComponent\n */\nexport const RenderPCsDOM = ({\n  pcs,\n  TILE_SIZE,\n  currentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings,\n  connectedPlayers\n}) => {\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: `${64 * TILE_SIZE}px`,\n        height: `${64 * TILE_SIZE}px`,\n        overflow: 'hidden', // Clip range indicators at grid edges\n        pointerEvents: 'none', // Let interactions pass through to underlying layers\n        zIndex: 16, // Match PC zIndex\n      }}\n    >\n      {pcs.map((pc) => {\n        // Skip PCs without valid position data\n        if (!pc || !pc.position || typeof pc.position.x === 'undefined' || typeof pc.position.y === 'undefined') {\n          console.warn('PC missing position data:', pc);\n          return null;\n        }\n        \n        const isCurrentPlayer = String(pc.playerId) === String(currentPlayer?._id);\n        \n        return (\n          <div\n            key={`pc-container-${pc.playerId}`}\n            style={{\n              pointerEvents: 'auto', // Re-enable pointer events for individual PCs\n            }}\n          >\n            <PCComponent\n              key={pc.playerId}\n              pc={pc}\n              TILE_SIZE={TILE_SIZE}\n              currentPlayer={currentPlayer}\n              isCurrentPlayer={isCurrentPlayer}\n              onPCClick={onPCClick}\n              setCurrentPlayer={setCurrentPlayer}\n              setInventory={setInventory}\n              setBackpack={setBackpack}\n              masterResources={masterResources}\n              strings={strings}\n              setHoverTooltip={() => {}} // TODO: Add hover tooltip support\n              connectedPlayers={connectedPlayers}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default RenderPCsDOM;","import React from 'react';\nimport { RenderPCsDOM } from './RenderPCsDOM';\n\n/**\n * Main PC (Player Character) rendering component - TEMPORARILY USING DOM MODE\n * Canvas implementation not yet complete, using DOM for PCs only\n */\nexport const RenderPCs = ({\n  pcs,\n  TILE_SIZE,\n  currentPlayer,\n  onPCClick,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  masterResources,\n  strings,\n  connectedPlayers,\n}) => {\n  // TEMPORARILY USING DOM MODE - Canvas implementation not complete\n  return (\n    <RenderPCsDOM\n      pcs={pcs}\n      TILE_SIZE={TILE_SIZE}\n      currentPlayer={currentPlayer}\n      onPCClick={onPCClick}\n      setCurrentPlayer={setCurrentPlayer}\n      setInventory={setInventory}\n      setBackpack={setBackpack}\n      masterResources={masterResources}\n      strings={strings}\n      connectedPlayers={connectedPlayers}\n    />\n  );\n};\n\nexport default RenderPCs;","import React, { useRef, useEffect, useState, memo, useCallback } from 'react';\nimport { getResourceOverlayStatus, OVERLAY_SVG_MAPPING } from '../Utils/ResourceOverlayUtils';\nimport SVGAssetManager from './SVGAssetManager';\nimport { getResourceCursorClass, getNPCCursorClass, setCanvasCursor } from '../Utils/CursorUtils';\nimport { handleNPCClickShared, getAttackCooldownStatus } from '../GameFeatures/NPCs/NPCInteractionUtils';\nimport { calculateTooltipPosition } from '../Utils/TooltipUtils';\nimport ConversationManager from '../GameFeatures/Relationships/ConversationManager';\nimport '../GameFeatures/Relationships/Conversation.css';\nimport './Tooltip.css';\n\n/**\n * Canvas-based dynamic elements renderer\n * Handles tooltips, overlays, badges, attack ranges, VFX, etc.\n */\nexport const RenderDynamicElementsCanvas = ({\n  resources,\n  npcs,\n  pcs,\n  craftingStatus,\n  tradingStatus,\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  hoverTooltip,\n  setHoverTooltip,\n  TILE_SIZE,\n  strings,\n  timers,\n  generateResourceTooltip,\n  generateNPCTooltip,\n  generatePCTooltip,\n  handleTileClick,\n  onNPCClick,\n  onPCClick,\n  // Additional props needed for NPC interactions\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  masterResources,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  masterTrophies,\n  globalTuning,\n  gridId,\n  playersInGrid,\n  onTileHover,\n  cursorModeActive\n}) => {\n  const canvasRef = useRef(null);\n  const lastRenderData = useRef(null);\n  const [conversationVersion, setConversationVersion] = useState(0);\n  const currentHoveredNPC = useRef(null);\n  const cursorUpdateInterval = useRef(null);\n  const tooltipUpdateInterval = useRef(null);\n  const currentTooltipData = useRef(null);\n\n  // Subscribe to conversation changes\n  useEffect(() => {\n    const unsubscribe = ConversationManager.subscribe(() => {\n      console.log(' RenderDynamicElementsCanvas: Conversation changed, triggering update');\n      setConversationVersion(v => v + 1);\n    });\n    return unsubscribe;\n  }, []);\n\n  // Render overlays to canvas\n  const renderOverlays = async () => {\n    const canvas = canvasRef.current;\n    if (!canvas || !resources) return;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Get device pixel ratio for high-DPI support\n    const devicePixelRatio = window.devicePixelRatio || 1;\n    \n    // Calculate display size and actual canvas size\n    const displayWidth = 64 * TILE_SIZE;\n    const displayHeight = 64 * TILE_SIZE;\n    const actualWidth = displayWidth * devicePixelRatio;\n    const actualHeight = displayHeight * devicePixelRatio;\n    \n    // Set actual canvas size (for high-DPI)\n    canvas.width = actualWidth;\n    canvas.height = actualHeight;\n    \n    // Set display size (CSS size)\n    canvas.style.width = displayWidth + 'px';\n    canvas.style.height = displayHeight + 'px';\n    \n    // Scale canvas context for high-DPI\n    ctx.scale(devicePixelRatio, devicePixelRatio);\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n    \n    // Render resource overlays\n    for (const resource of resources) {\n      if (resource.type === 'shadow' || resource.category === 'doober' || resource.category === 'source') continue;\n      \n      const overlayInfo = getResourceOverlayStatus(\n        resource, \n        craftingStatus, \n        tradingStatus, \n        badgeState, \n        electionPhase,\n        currentPlayer\n      );\n      \n      if (!overlayInfo) continue;\n      \n      const overlayType = overlayInfo.type;\n      if (!overlayType || !OVERLAY_SVG_MAPPING[overlayType]) continue;\n      \n      const x = resource.x * TILE_SIZE;\n      const y = resource.y * TILE_SIZE;\n      const size = TILE_SIZE * (resource.range || 1);\n      \n      // Position overlay in lower-left corner of the resource\n      // Scale overlay more appropriately for different zoom levels\n      let overlaySize;\n      if (TILE_SIZE <= 16) {\n        // Far zoom: use smaller minimum and ratio\n        overlaySize = Math.max(6, TILE_SIZE * 0.35);\n      } else if (TILE_SIZE <= 30) {\n        // Close zoom: standard sizing\n        overlaySize = Math.max(10, TILE_SIZE * 0.35);\n      } else {\n        // Closer zoom: allow larger overlays\n        overlaySize = Math.max(14, TILE_SIZE * 0.35);\n      }\n      \n      const overlayX = x + 2;\n      const overlayY = y + TILE_SIZE - overlaySize - 2;\n      \n      const overlayTexture = await SVGAssetManager.getOverlayTexture(\n        OVERLAY_SVG_MAPPING[overlayType], \n        overlaySize\n      );\n      \n      if (overlayTexture) {\n        ctx.drawImage(overlayTexture, overlayX, overlayY, overlaySize, overlaySize);\n      }\n    }\n  };\n\n  // Re-render when dependencies change\n  useEffect(() => {\n    const currentData = JSON.stringify({ \n      resources: resources?.map(r => ({ \n        x: r.x, \n        y: r.y, \n        type: r.type\n      })), \n      TILE_SIZE,\n      craftingReady: craftingStatus?.ready,\n      craftingInProgress: craftingStatus?.inProgress,\n      tradingReady: tradingStatus?.ready,\n      mailboxBadge: badgeState?.mailbox,\n      electionPhase,\n      playerId: currentPlayer?.id\n    });\n    \n    if (currentData !== lastRenderData.current) {\n      renderOverlays();\n      lastRenderData.current = currentData;\n    }\n  }, [resources, TILE_SIZE, craftingStatus, tradingStatus, badgeState, electionPhase, currentPlayer]);\n\n  // Stop cursor update interval\n  const stopCursorUpdateInterval = useCallback(() => {\n    if (cursorUpdateInterval.current) {\n      clearInterval(cursorUpdateInterval.current);\n      cursorUpdateInterval.current = null;\n    }\n  }, []);\n\n  // Start cursor update interval for attack NPCs\n  const startCursorUpdateInterval = useCallback((npc, element) => {\n    // Only start for attack NPCs\n    if (npc.action !== 'attack' && npc.action !== 'spawn') return;\n    \n    \n    // Clear any existing interval\n    if (cursorUpdateInterval.current) {\n      clearInterval(cursorUpdateInterval.current);\n      cursorUpdateInterval.current = null;\n    }\n    \n    // Check cursor status every 100ms\n    cursorUpdateInterval.current = setInterval(() => {\n      // Make sure we're still hovering over the same NPC\n      if (!currentHoveredNPC.current || currentHoveredNPC.current.id !== npc.id) {\n        if (cursorUpdateInterval.current) {\n          clearInterval(cursorUpdateInterval.current);\n          cursorUpdateInterval.current = null;\n        }\n        return;\n      }\n      \n      // Update cursor based on current cooldown status\n      const cursorClass = getNPCCursorClass(npc);\n      const cooldownStatus = getAttackCooldownStatus();\n      setCanvasCursor(element, cursorClass);\n    }, 100);\n  }, []);\n\n  // Function to stop tooltip update interval\n  const stopTooltipUpdateInterval = useCallback(() => {\n    if (tooltipUpdateInterval.current) {\n      clearInterval(tooltipUpdateInterval.current);\n      tooltipUpdateInterval.current = null;\n      currentTooltipData.current = null;\n    }\n  }, []);\n  \n  // Function to start tooltip update interval for time-sensitive tooltips\n  const startTooltipUpdateInterval = useCallback((entity, entityType, position) => {\n    // Clear any existing interval\n    stopTooltipUpdateInterval();\n    \n    // Store current tooltip data\n    currentTooltipData.current = { entity, entityType, position };\n    \n    // Determine if this entity needs real-time updates\n    const needsRealtimeUpdate = (\n      (entityType === 'resource' && (\n        entity.type === 'Dungeon Entrance' ||\n        (entity.category === 'farmplot' && entity.growEnd) ||\n        (entity.category === 'crafting' && entity.craftEnd) ||\n        (entity.category === 'pet' && entity.craftEnd)\n      )) ||\n      (entityType === 'npc' && entity.action === 'graze' && entity.grazeEnd)\n    );\n    \n    if (!needsRealtimeUpdate) return;\n    \n    // Update tooltip every 100ms\n    tooltipUpdateInterval.current = setInterval(() => {\n      if (!currentTooltipData.current) {\n        stopTooltipUpdateInterval();\n        return;\n      }\n      \n      // Regenerate tooltip content\n      let content = '';\n      if (entityType === 'resource') {\n        content = generateResourceTooltip(entity, strings, timers);\n      } else if (entityType === 'npc') {\n        content = generateNPCTooltip(entity, strings);\n      }\n      \n      if (content) {\n        setHoverTooltip({\n          x: position.x,\n          y: position.y,\n          content: content\n        });\n      }\n    }, 100);\n  }, [strings, timers, stopTooltipUpdateInterval, setHoverTooltip]);\n\n  // Cleanup intervals on unmount\n  useEffect(() => {\n    return () => {\n      stopCursorUpdateInterval();\n      stopTooltipUpdateInterval();\n    };\n  }, [stopCursorUpdateInterval, stopTooltipUpdateInterval]);\n\n  // Handle mouse events for tooltips and cursors - check ALL entity types\n  const handleCanvasMouseMove = (event) => {\n    const canvas = canvasRef.current;\n    const overlayDiv = event.currentTarget; // The div that received the event\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n\n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n\n    // Track hovered tile for cursor highlight when in cursor mode\n    if (onTileHover && cursorModeActive) {\n      if (rowIndex >= 0 && rowIndex < 64 && colIndex >= 0 && colIndex < 64) {\n        onTileHover({ row: rowIndex, col: colIndex });\n      } else {\n        onTileHover(null);\n      }\n    }\n\n    // Debug logging\n    if (!window._tooltipDebugLogged) {\n      console.log('RenderDynamicElementsCanvas - Available entities:', {\n        resources: resources?.length || 0,\n        npcs: npcs?.length || 0,\n        pcs: pcs?.length || 0,\n        TILE_SIZE\n      });\n      window._tooltipDebugLogged = true;\n    }\n    \n    // Check for NPC at this position FIRST (they render on top of resources)\n    const npc = npcs?.find(n => \n      n && n.position && \n      Math.floor(n.position.x) === colIndex && \n      Math.floor(n.position.y) === rowIndex\n    );\n    \n    if (npc) {\n      const tooltipPosition = calculateTooltipPosition(event.clientX, event.clientY);\n      setHoverTooltip({\n        x: tooltipPosition.x,\n        y: tooltipPosition.y,\n        content: generateNPCTooltip(npc, strings),\n      });\n      \n      // Start tooltip update interval for NPCs with timers\n      startTooltipUpdateInterval(npc, 'npc', tooltipPosition);\n      \n      // Track current hovered NPC\n      currentHoveredNPC.current = { id: npc.id };\n      \n      // Set cursor for the NPC\n      const cursorClass = getNPCCursorClass(npc);\n      setCanvasCursor(overlayDiv, cursorClass);\n      \n      // Start cursor update interval for attack NPCs\n      startCursorUpdateInterval(npc, overlayDiv);\n      \n      return;\n    }\n    \n    // Check for any resource at this position (including doobers for cursor)\n    const anyResource = resources?.find(r => {\n      if (r.type === 'shadow') return false;\n      const range = r.range || 1;\n      // Multi-tile resources grow upward from anchor\n      return colIndex >= r.x && colIndex < r.x + range &&\n             rowIndex <= r.y && rowIndex > r.y - range;\n    });\n    \n    // Check for tooltip-eligible resource (excluding doobers and sources)\n    const tooltipResource = anyResource && anyResource.category !== 'doober' && anyResource.category !== 'deco' && anyResource.category !== 'source' ? anyResource : null;\n    \n    if (tooltipResource) {\n      const tooltipPosition = calculateTooltipPosition(event.clientX, event.clientY);\n      setHoverTooltip({\n        x: tooltipPosition.x,\n        y: tooltipPosition.y,\n        content: generateResourceTooltip(tooltipResource, strings, timers),\n      });\n      // Start tooltip update interval for time-sensitive resources\n      startTooltipUpdateInterval(tooltipResource, 'resource', tooltipPosition);\n      // Set cursor for the resource\n      const cursorClass = getResourceCursorClass(tooltipResource);\n      setCanvasCursor(overlayDiv, cursorClass);\n      return;\n    } else if (anyResource) {\n      // Resource exists but no tooltip (doober or source)\n      setHoverTooltip(null);\n      stopTooltipUpdateInterval();\n      // Doobers should show pointer cursor\n      const cursorClass = anyResource.category === 'doober' ? 'cursor-pointer' : getResourceCursorClass(anyResource);\n      setCanvasCursor(overlayDiv, cursorClass);\n      return;\n    }\n    \n    // Check for PC at this position (excluding current player)\n    const pc = pcs?.find(p => \n      p && p.position && \n      Math.floor(p.position.x) === colIndex && \n      Math.floor(p.position.y) === rowIndex &&\n      String(p.playerId) !== String(currentPlayer?._id)\n    );\n    \n    if (pc) {\n      const tooltipPosition = calculateTooltipPosition(event.clientX, event.clientY);\n      setHoverTooltip({\n        x: tooltipPosition.x,\n        y: tooltipPosition.y,\n        content: generatePCTooltip(pc),\n      });\n      // PCs are generally not interactive, so use default cursor\n      setCanvasCursor(overlayDiv, null);\n      return;\n    }\n    \n    // No entity found - clear tooltip and reset cursor\n    setHoverTooltip(null);\n    setCanvasCursor(overlayDiv, null);\n    \n    // Clear tracked NPC and stop cursor update interval\n    currentHoveredNPC.current = null;\n    stopCursorUpdateInterval();\n    stopTooltipUpdateInterval();\n  };\n\n  const handleCanvasMouseLeave = (event) => {\n    setHoverTooltip(null);\n\n    // Clear hovered tile for cursor highlight\n    if (onTileHover) {\n      onTileHover(null);\n    }\n\n    // Reset cursor when leaving\n    const overlayDiv = event.currentTarget;\n    if (overlayDiv) {\n      setCanvasCursor(overlayDiv, null);\n    }\n\n    // Clear tracked NPC and stop cursor update interval\n    currentHoveredNPC.current = null;\n    stopCursorUpdateInterval();\n\n    // Stop tooltip update interval\n    stopTooltipUpdateInterval();\n  };\n\n  // Handle clicks and forward to appropriate handlers\n  const handleCanvasClick = (event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    \n    const colIndex = Math.floor(x / TILE_SIZE);\n    const rowIndex = Math.floor(y / TILE_SIZE);\n    \n    // Check if there's an NPC at this position\n    const npc = npcs?.find(n => \n      n && n.position && \n      Math.floor(n.position.x) === colIndex && \n      Math.floor(n.position.y) === rowIndex\n    );\n    \n    if (npc) {\n      // Use the shared click handler that includes cooldown logic for attack NPCs\n      handleNPCClickShared(npc, {\n        currentPlayer,\n        playersInGrid,\n        gridId,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        masterTrophies,\n        globalTuning,\n        strings,\n        // Event handlers\n        onNPCClick,\n        setHoverTooltip,\n        setInventory,\n        setBackpack,\n        setResources,\n        setCurrentPlayer,\n        setModalContent,\n        setIsModalOpen,\n        updateStatus,\n        openPanel,\n        setActiveStation\n      });\n      return;\n    }\n    \n    // Check if there's a PC at this position\n    const pc = pcs?.find(p => \n      p && p.position && \n      Math.floor(p.position.x) === colIndex && \n      Math.floor(p.position.y) === rowIndex\n    );\n    \n    if (pc && onPCClick) {\n      onPCClick(pc);\n      return;\n    }\n    \n    // No NPC or PC found, forward to tile/resource handler\n    if (handleTileClick) {\n      handleTileClick(rowIndex, colIndex);\n    }\n  };\n\n  // Render speech bubbles for NPCs and PCs\n  const renderSpeechBubbles = () => {\n    const bubbles = [];\n    \n    // Render NPC speech bubbles\n    npcs?.forEach(npc => {\n      \n      const speech = ConversationManager.getSpeech(npc.type);\n      const outcome = ConversationManager.getOutcome(npc.type) || ConversationManager.getOutcome(npc.id);\n      const position = npc.position;\n      if (!position) return;\n      \n      // Render speech bubble if there's active speech and no outcome\n      if (speech && !outcome) {\n        // Create wrapper div for entity + bubble (only animate if no outcome)\n        bubbles.push(\n          <div\n            key={`speech-wrapper-npc-${npc.id}`}\n            className=\"speaking-animation\"\n            style={{\n              position: 'absolute',\n              left: position.x * TILE_SIZE,\n              top: position.y * TILE_SIZE,\n              width: TILE_SIZE,\n              height: TILE_SIZE,\n              pointerEvents: 'none',\n              zIndex: 1000,\n            }}\n          >\n            <div\n              className={`conversation-speech-bubble npc${speech.matchState === 'match' ? ' match' : speech.matchState === 'rival' ? ' rival' : ''}`}\n              style={{\n                position: 'absolute',\n                left: '50%',\n                bottom: '100%',\n                transform: 'translateX(-50%)',\n                marginBottom: '10px',\n                fontSize: `${TILE_SIZE * 0.6}px`,\n                width: `${TILE_SIZE * 1.5}px`,\n                height: `${TILE_SIZE * 1.5}px`,\n                padding: `${TILE_SIZE * 0.3}px`,\n                borderWidth: `${TILE_SIZE * 0.06}px`,\n              }}\n            >\n              <div className=\"speech-emoji\" style={{ fontSize: `${TILE_SIZE * 0.9}px` }}>\n                {speech.topic || speech.emoji}\n              </div>\n            </div>\n          </div>\n        );\n      }\n\n      // Render relationship outcome if present (already checked above)\n      if (outcome) {\n        // Render outcome as a simple emoji \"speech bubble\" without the bubble container\n        bubbles.push(\n          <div\n            key={`outcome-npc-${npc.id}`}\n            style={{\n              position: 'absolute',\n              left: position.x * TILE_SIZE,\n              top: position.y * TILE_SIZE,\n              width: TILE_SIZE,\n              height: TILE_SIZE,\n              pointerEvents: 'none',\n              zIndex: 1100, // Higher than speech bubbles\n            }}\n          >\n            <div\n              style={{\n                position: 'absolute',\n                left: '50%',\n                bottom: '100%',\n                transform: 'translateX(-50%)',\n                marginBottom: '10px',\n                fontSize: `${TILE_SIZE * 1.2}px`,\n                textAlign: 'center',\n              }}\n            >\n              {outcome.emoji}\n            </div>\n          </div>\n        );\n      }\n    });\n\n    // Render PC speech bubbles\n    pcs?.forEach(pc => {\n      const speech = ConversationManager.getSpeech(pc.playerId);\n      const outcome = ConversationManager.getOutcome(pc.playerId);\n      \n      const position = pc.position;\n      if (!position) return;\n      \n      // Only render speech bubble if no outcome is showing\n      if (speech && !outcome) {\n        // Create wrapper div for entity + bubble\n        bubbles.push(\n          <div\n            key={`speech-wrapper-pc-${pc.playerId}`}\n            className=\"speaking-animation\"\n            style={{\n              position: 'absolute',\n              left: position.x * TILE_SIZE,\n              top: position.y * TILE_SIZE,\n              width: TILE_SIZE,\n              height: TILE_SIZE,\n              pointerEvents: 'none',\n              zIndex: 1000,\n            }}\n          >\n            <div\n              className={`conversation-speech-bubble pc${speech.matchState === 'match' ? ' match' : speech.matchState === 'rival' ? ' rival' : ''}`}\n              style={{\n                position: 'absolute',\n                left: '50%',\n                bottom: '100%',\n                transform: 'translateX(-50%)',\n                marginBottom: '10px',\n                fontSize: `${TILE_SIZE * 0.6}px`,\n                width: `${TILE_SIZE * 1.5}px`,\n                height: `${TILE_SIZE * 1.5}px`,\n                padding: `${TILE_SIZE * 0.3}px`,\n                borderWidth: `${TILE_SIZE * 0.06}px`,\n              }}\n            >\n              <div className=\"speech-emoji\" style={{ fontSize: `${TILE_SIZE * 0.9}px` }}>\n                {speech.topic || speech.emoji}\n              </div>\n            </div>\n          </div>\n        );\n      }\n      \n      // Render relationship outcome if present\n      if (outcome) {\n        // Render outcome as a simple emoji \"speech bubble\" without the bubble container\n        bubbles.push(\n          <div\n            key={`outcome-pc-${pc.playerId}`}\n            style={{\n              position: 'absolute',\n              left: position.x * TILE_SIZE,\n              top: position.y * TILE_SIZE,\n              width: TILE_SIZE,\n              height: TILE_SIZE,\n              pointerEvents: 'none',\n              zIndex: 1100, // Higher than speech bubbles\n            }}\n          >\n            <div\n              style={{\n                position: 'absolute',\n                left: '50%',\n                bottom: '100%',\n                transform: 'translateX(-50%)',\n                marginBottom: '10px',\n                fontSize: `${TILE_SIZE * 1.2}px`,\n                textAlign: 'center',\n              }}\n            >\n              {outcome.emoji}\n            </div>\n          </div>\n        );\n      }\n    });\n\n    return bubbles;\n  };\n\n  return (\n    <>\n      {/* Overlay Canvas */}\n      <canvas\n        ref={canvasRef}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: `${64 * TILE_SIZE}px`,\n          height: `${64 * TILE_SIZE}px`,\n          zIndex: 20, // Higher than all entity layers\n          pointerEvents: 'none', // Canvas doesn't need pointer events\n        }}\n      />\n      \n      {/* Invisible div for mouse detection */}\n      <div\n        onMouseMove={handleCanvasMouseMove}\n        onMouseLeave={handleCanvasMouseLeave}\n        onClick={handleCanvasClick}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: `${64 * TILE_SIZE}px`,\n          height: `${64 * TILE_SIZE}px`,\n          zIndex: 21, // Just above the canvas\n          pointerEvents: 'auto',\n          background: 'transparent',\n          cursor: 'inherit', // Allow cursor to be set\n        }}\n      />\n      \n      {/* Speech bubbles and relationship outcomes */}\n      {renderSpeechBubbles()}\n    </>\n  );\n};\n\nexport default RenderDynamicElementsCanvas;","import axios from 'axios';\nimport API_BASE from '../config';\n\nclass QuestCache {\n  constructor() {\n    this.cache = null;\n    this.cacheTime = null;\n    this.cacheExpiry = 5 * 60 * 1000; // 5 minutes cache\n    this.pendingRequest = null;\n  }\n\n  async getQuests() {\n    // If we have a pending request, wait for it\n    if (this.pendingRequest) {\n      return this.pendingRequest;\n    }\n\n    // If cache is fresh, return it\n    if (this.cache && this.cacheTime && (Date.now() - this.cacheTime < this.cacheExpiry)) {\n      // Removed console.log to reduce spam\n      return Promise.resolve(this.cache);\n    }\n\n    // Make new request and cache it\n    console.log(' Fetching fresh quests from API');\n    this.pendingRequest = axios.get(`${API_BASE}/api/quests`)\n      .then(response => {\n        this.cache = response.data;\n        this.cacheTime = Date.now();\n        this.pendingRequest = null;\n        return this.cache;\n      })\n      .catch(error => {\n        this.pendingRequest = null;\n        throw error;\n      });\n\n    return this.pendingRequest;\n  }\n\n  // Force cache refresh (e.g., after quest completion)\n  invalidate() {\n    console.log(' Invalidating quest cache');\n    this.cache = null;\n    this.cacheTime = null;\n  }\n\n  // Get quests for a specific NPC\n  async getQuestsForNPC(npcType) {\n    const allQuests = await this.getQuests();\n    return allQuests.filter(quest => quest.giver === npcType);\n  }\n}\n\n// Create singleton instance\nconst questCache = new QuestCache();\n\nexport default questCache;","import React, { useCallback } from 'react';\nimport { RenderDynamicElementsCanvas } from './RenderDynamicElementsCanvas';\nimport { getLocalizedString } from '../Utils/stringLookup';\nimport questCache from '../Utils/QuestCache';\n\n/**\n * Generate tooltip content for a resource - shared between Canvas and DOM\n */\nexport function generateResourceTooltip(resource, strings, timers = null) {\n  if (!resource || resource.category === 'doober' || resource.category === 'source') return '';\n\n  const lines = [];\n  const currentTime = Date.now();\n  const localizedResourceType = getLocalizedString(resource.type, strings);\n\n  // Special handling for Dungeon Entrance\n  if (resource.type === 'Dungeon Entrance' && timers?.dungeon) {\n    lines.push(`<p>${localizedResourceType}</p>`);\n    \n    const dungeonEndTime = timers.dungeon.endTime;\n    \n    if (dungeonEndTime) {\n      const remainingTime = Math.max(0, dungeonEndTime - currentTime);\n      \n      // Determine actual phase based on whether timer has expired\n      let actualPhase = timers.dungeon.phase;\n      if (currentTime >= dungeonEndTime) {\n        // Timer expired - phase should switch\n        actualPhase = timers.dungeon.phase === 'open' ? 'resetting' : 'open';\n      }\n      \n      const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n      const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n      const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n      \n      const parts = [];\n      if (hours > 0) parts.push(`${hours}h`);\n      if (minutes > 0) parts.push(`${minutes}m`);\n      if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n      const timeString = parts.join(' ');\n      \n      if (actualPhase === 'open') {\n        lines.push(`<p>Open - Resets in ${timeString}</p>`);\n      } else if (actualPhase === 'resetting') {\n        lines.push(`<p>Closed - Opens in ${timeString}</p>`);\n      }\n    } else {\n      // Fallback if no timer data\n      lines.push(`<p>${timers.dungeon.phase === 'open' ? 'Open' : 'Closed'}</p>`);\n    }\n    \n    return lines.join('');\n  }\n\n  switch (resource.category) {\n    case 'farmplot':\n      lines.push(`<p>${localizedResourceType}</p>`);\n      if (resource.growEnd) {\n        const remainingTime = Math.max(0, resource.growEnd - currentTime);\n        const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n        const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n        const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n        const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n        if (remainingTime > 0) {\n          const parts = [];\n          if (days > 0) parts.push(`${days}d`);\n          if (hours > 0) parts.push(`${hours}h`);\n          if (minutes > 0) parts.push(`${minutes}m`);\n          if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n          lines.push(`<p>${parts.join(' ')} remaining</p>`);\n        }\n      }\n      break;\n\n    case 'crafting':\n      lines.push(`<p>${localizedResourceType}</p>`);\n      if (resource.craftEnd) {\n        const remainingTime = Math.max(0, resource.craftEnd - currentTime);\n        const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n        const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n        const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n        const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n        if (remainingTime > 0) {\n          const parts = [];\n          if (days > 0) parts.push(`${days}d`);\n          if (hours > 0) parts.push(`${hours}h`);\n          if (minutes > 0) parts.push(`${minutes}m`);\n          if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n          lines.push(`<p> ${parts.join(' ')} remaining</p>`);\n        }\n      }\n      break;\n\n    default:\n      lines.push(`<p>${localizedResourceType}</p>`);\n      break;\n  }\n\n  return lines.join('');\n}\n\n/**\n * Generate tooltip content for NPCs - shared between Canvas and DOM\n */\nexport function generateNPCTooltip(npc, strings) {\n  const localizedNPCType = getLocalizedString(npc.type, strings);\n  let tooltipContent = `<p>${localizedNPCType}</p>`;\n\n  switch (npc.action) {\n    case 'graze': {\n      switch (npc.state) {\n        case 'processing':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is ready.</p>`;\n          break;\n        case 'hungry': {\n          const lookingFor = npc.type === 'Pig' ? 'dirt' : 'grass';\n          tooltipContent = `<p>${localizedNPCType}</p><p>is hungry and</p><p>looking for ${lookingFor}.</p>`;\n          break;\n        }\n        case 'grazing': {\n          let countdownText = \"\";\n          if (npc.grazeEnd) {\n            const remainingTime = Math.max(0, npc.grazeEnd - Date.now());\n            const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n            const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n            countdownText = `<p>${minutes}m ${seconds}s</p>`;\n          }\n          tooltipContent = `<p>${localizedNPCType}</p><p>is grazing.</p>${countdownText}`;\n          break;\n        }\n        case 'idle':\n          tooltipContent = `<p>Zzzz...</p>`;\n          break;\n        case 'roam':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is roaming.</p>`;\n          break;\n        case 'stall':\n          tooltipContent = `<p>${localizedNPCType}</p><p>is looking for an Animal Stall.</p>`;\n          break;\n        default:\n          tooltipContent = `<p>${localizedNPCType}</p>`;\n          break;\n      }\n      break;\n    }\n    case 'quest':\n      if (npc.type === 'Kent') {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[47] || 'I have special offers!'}\"</p>`;\n      } else {\n        tooltipContent = `<p>${localizedNPCType}</p><p>\"${strings?.[48] || 'I might have work for you.'}\"</p>`;\n      }\n      break;\n    case 'attack':\n    case 'spawn':\n      tooltipContent = `<p>${localizedNPCType}</p><p>HP: ${npc.hp}/${npc.maxhp}</p>`;\n      // Add state info for enemy NPCs\n      if (npc.state) {\n        tooltipContent += `<p>State: ${npc.state}</p>`;\n      }\n      break;\n    default:\n      tooltipContent = `<p>${npc.type}</p>`;\n      break;\n  }\n\n  return tooltipContent;\n}\n\n/**\n * Generate tooltip content for PCs - shared between Canvas and DOM\n */\nexport function generatePCTooltip(pc, strings) {\n  const username = pc.username || 'Anonymous';\n  let content = `<p>${username}</p><p> HP: ${pc.hp}</p>`;\n  if (pc.iscamping) content += `<p> Camping</p>`;\n  if (pc.isinboat) content += `<p> In a boat</p>`;\n  \n  return content;\n}\n\n/**\n * Check quest NPC status - shared logic for overlays\n */\nexport const checkQuestNPCStatus = async (npc, currentPlayer) => {\n  if (!currentPlayer) return null;\n  \n  try {\n    // Use cached quests instead of direct API call\n    const allQuests = await questCache.getQuests();\n    \n    // Use same filtering logic as NPCPanel\n    let npcQuests = allQuests\n      .filter((quest) => quest.giver === npc.type)\n      .filter((quest) => {\n        const activeQuest = currentPlayer.activeQuests?.find(q => q.questId === quest.title);\n        if (activeQuest) {\n          return activeQuest.completed && !activeQuest.rewardCollected;\n        }\n        return (quest.repeatable === true || quest.repeatable === 'true') || !currentPlayer.completedQuests?.some(q => q.questId === quest.title);\n      });\n\n    // Check if any quests have completed rewards to collect\n    const hasCompletedQuests = npcQuests.some(quest => {\n      const activeQuest = currentPlayer.activeQuests?.find(q => q.questId === quest.title);\n      return activeQuest && activeQuest.completed && !activeQuest.rewardCollected;\n    });\n\n    let status = null;\n    if (hasCompletedQuests) {\n      status = 'completed'; // Show checkmark\n    } else if (npcQuests.length > 0) {\n      status = 'available'; // Show question mark/hand\n    }\n    \n    return status;\n  } catch (error) {\n    console.error('Error checking quest NPC status:', error);\n    return null;\n  }\n};\n\n/**\n * Check trade NPC status - shared logic for overlays\n */\nexport const checkTradeNPCStatus = (npc, masterResources) => {\n  if (!npc.symbol || !masterResources) return null;\n  \n  const tradeResource = masterResources.find(r => \n    r.category === 'trader' && r.symbol === npc.symbol\n  );\n  \n  if (!tradeResource) return null;\n  \n  // Trade NPCs show their trade item symbol as the overlay\n  return tradeResource.input;\n};\n\n/**\n * Check Kent NPC status - shared logic for overlays\n */\nexport const checkKentNPCStatus = (npc, currentPlayer) => {\n  if (npc.type !== 'Kent' || !currentPlayer) return null;\n  \n  try {\n    const kentOffers = currentPlayer?.kentOffers?.offers || [];\n    \n    // Check if player can afford any of Kent's offers\n    const canAffordAny = kentOffers.some(offer => {\n      // Calculate player's total quantity from inventory and backpack\n      const inventoryQty = currentPlayer?.inventory?.find(item => item.type === offer.item)?.quantity || 0;\n      const backpackQty = currentPlayer?.backpack?.find(item => item.type === offer.item)?.quantity || 0;\n      const playerQty = inventoryQty + backpackQty;\n      \n      return playerQty >= offer.quantity;\n    });\n    \n    return canAffordAny ? 'completed' : null;\n  } catch (error) {\n    console.error('Error checking Kent status:', error);\n    return null;\n  }\n};\n\n/**\n * Main dynamic elements rendering component - FORCED TO CANVAS MODE ONLY\n * Handles tooltips, overlays, badges, attack ranges, VFX, etc.\n */\nexport const RenderDynamicElements = ({ \n  // Grid data\n  resources,\n  npcs,\n  pcs,\n  \n  // Status data for overlays\n  badgeState,\n  electionPhase,\n  currentPlayer,\n  masterResources,\n  \n  // UI state\n  hoverTooltip,\n  setHoverTooltip,\n  \n  // Click handlers\n  handleTileClick,\n  onNPCClick,\n  onPCClick,\n  \n  // Configuration\n  TILE_SIZE,\n  strings,\n  timers,\n  \n  // Additional props for NPC interactions\n  setInventory,\n  setBackpack,\n  setResources,\n  setCurrentPlayer,\n  masterSkills,\n  masterTrophies,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  openPanel,\n  setActiveStation,\n  globalTuning,\n  gridId,\n  onTileHover,\n  cursorModeActive\n}) => {\n  // Calculate crafting and trading status for dynamic overlays\n  const currentTime = Date.now();\n  \n  const craftingStatus = React.useMemo(() => {\n    if (!resources) return { ready: [], searching: [], hungry: [], inProgress: [] };\n    \n    return resources.reduce((acc, res) => {\n      if ((res.category === 'crafting' || res.category === 'farmhouse') && res.craftEnd) {\n        const key = `${res.x}-${res.y}`;\n        if (res.craftEnd < currentTime) {\n          acc.ready.push(key);\n        } else {\n          acc.inProgress.push(key);\n        }\n      } else if (res.category === 'farmplot' && res.isSearching) {\n        const key = `${res.x}-${res.y}`;\n        acc.searching.push(key);\n      } else if (res.category === 'farmplot' && res.growEnd) {\n        const key = `${res.x}-${res.y}`;\n        if (res.growEnd < currentTime) {\n          acc.ready.push(key);\n        }\n      } else if (res.category === 'pet') {\n        const key = `${res.x}-${res.y}`;\n        if (res.craftEnd && res.craftedItem) {\n          if (res.craftEnd < currentTime) {\n            acc.ready.push(key); // Pet has a reward ready\n          } else {\n            acc.inProgress.push(key); // Pet is feeding\n          }\n        }\n      }\n      return acc;\n    }, { ready: [], searching: [], hungry: [], inProgress: [] });\n  }, [resources, currentTime]);\n\n  // Check for completed trades at Trading Post\n  const tradingStatus = React.useMemo(() => {\n    if (!resources || !currentPlayer?.tradeStall) return { completed: [] };\n    \n    return resources.reduce((acc, res) => {\n      if (res.type === 'Trading Post' && currentPlayer.tradeStall) {\n        const hasCompletedTrades = currentPlayer.tradeStall.some(trade => \n          trade && (\n            (trade.sellTime && new Date(trade.sellTime) < currentTime) ||\n            (trade.boughtBy !== null && trade.boughtBy !== undefined)\n          )\n        );\n        if (hasCompletedTrades) {\n          const key = `${res.x}-${res.y}`;\n          acc.completed.push(key);\n        }\n      }\n      return acc;\n    }, { completed: [] });\n  }, [resources, currentPlayer?.tradeStall, currentTime]);\n\n  // FORCED TO CANVAS MODE - no decision tree\n  return (\n    <RenderDynamicElementsCanvas\n        resources={resources}\n        npcs={npcs}\n        pcs={pcs}\n        craftingStatus={craftingStatus}\n        tradingStatus={tradingStatus}\n        badgeState={badgeState}\n        electionPhase={electionPhase}\n        currentPlayer={currentPlayer}\n        masterResources={masterResources}\n        hoverTooltip={hoverTooltip}\n        setHoverTooltip={setHoverTooltip}\n        handleTileClick={handleTileClick}\n        onNPCClick={onNPCClick}\n        onPCClick={onPCClick}\n        TILE_SIZE={TILE_SIZE}\n        strings={strings}\n        timers={timers}\n        generateResourceTooltip={generateResourceTooltip}\n        generateNPCTooltip={generateNPCTooltip}\n        generatePCTooltip={generatePCTooltip}\n        checkQuestNPCStatus={checkQuestNPCStatus}\n        checkTradeNPCStatus={checkTradeNPCStatus}\n        checkKentNPCStatus={checkKentNPCStatus}\n        // Additional props for NPC interactions\n        setInventory={setInventory}\n        setBackpack={setBackpack}\n        setResources={setResources}\n        setCurrentPlayer={setCurrentPlayer}\n        masterSkills={masterSkills}\n        masterTrophies={masterTrophies}\n        setModalContent={setModalContent}\n        setIsModalOpen={setIsModalOpen}\n        updateStatus={updateStatus}\n        openPanel={openPanel}\n        setActiveStation={setActiveStation}\n        globalTuning={globalTuning}\n        gridId={gridId}\n        onTileHover={onTileHover}\n        cursorModeActive={cursorModeActive}\n    />\n  );\n};\n\nexport default RenderDynamicElements;","import React, { useRef, useEffect } from 'react';\n\n/**\n * CursorTileHighlight - Renders a highlight overlay on the tile under the cursor\n * when in placement cursor mode (plant, terraform, build, etc.)\n *\n * The highlight \"snaps\" from tile to tile as the cursor moves across the grid,\n * showing the player exactly which tile will be affected by their click.\n *\n * Props:\n * - hoveredTile: { row, col } or null - the tile position currently being hovered\n * - cursorMode: { type, emoji, ... } or null - the current cursor mode\n * - TILE_SIZE: number - size of each tile in pixels\n * - gridWidth: number - width of the grid in tiles\n * - gridHeight: number - height of the grid in tiles\n */\nconst CursorTileHighlight = ({\n  hoveredTile,\n  cursorMode,\n  TILE_SIZE,\n  gridWidth,\n  gridHeight,\n}) => {\n  const canvasRef = useRef(null);\n\n  // Render the highlight\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n\n    // Set canvas size to match grid\n    canvas.width = gridWidth * TILE_SIZE;\n    canvas.height = gridHeight * TILE_SIZE;\n\n    // Clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Only draw highlight if we have a hovered tile and cursor mode\n    if (!hoveredTile || !cursorMode) return;\n\n    const { row, col } = hoveredTile;\n\n    // Validate tile position\n    if (row < 0 || row >= gridHeight || col < 0 || col >= gridWidth) return;\n\n    // Get range from cursorMode (multi-tile resources have range > 1)\n    const range = cursorMode.range || 1;\n\n    // Draw highlight for all tiles that will be occupied\n    // Multi-tile resources expand right (+col) and up (-row) from the anchor\n    for (let dx = 0; dx < range; dx++) {\n      for (let dy = 0; dy < range; dy++) {\n        const tileCol = col + dx;\n        const tileRow = row - dy;\n\n        // Skip tiles that are out of bounds\n        if (tileCol < 0 || tileCol >= gridWidth || tileRow < 0 || tileRow >= gridHeight) continue;\n\n        const x = tileCol * TILE_SIZE;\n        const y = tileRow * TILE_SIZE;\n\n        // Draw highlight fill - white semi-transparent\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';\n        ctx.fillRect(x, y, TILE_SIZE, TILE_SIZE);\n\n        // Draw highlight border - bright white\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';\n        ctx.lineWidth = 2;\n        ctx.strokeRect(x + 1, y + 1, TILE_SIZE - 2, TILE_SIZE - 2);\n\n        // Draw inner glow effect\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';\n        ctx.lineWidth = 1;\n        ctx.strokeRect(x + 3, y + 3, TILE_SIZE - 6, TILE_SIZE - 6);\n      }\n    }\n\n  }, [hoveredTile, cursorMode, TILE_SIZE, gridWidth, gridHeight]);\n\n  // Don't render anything if no cursor mode\n  if (!cursorMode) return null;\n\n  return (\n    <canvas\n      ref={canvasRef}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        zIndex: 5, // Above tiles (1) but below resources (10+)\n        pointerEvents: 'none', // Allow clicks to pass through\n        imageRendering: 'pixelated',\n      }}\n    />\n  );\n};\n\nexport default CursorTileHighlight;\n","const lockedResources = new Map(); // Key: \"x-y\", Value: timestamp\n\nexport function lockResource(x, y) {\n  lockedResources.set(`${x}-${y}`, Date.now());\n}\n\nexport function unlockResource(x, y) {\n    lockedResources.delete(`${x}-${y}`);\n}\n\nexport function isResourceLocked(x, y) {\n  const lockTime = lockedResources.get(`${x}-${y}`);\n  const now = Date.now();\n\n  // Ignore lock if it has expired (e.g., 3 seconds timeout)\n  return lockTime && now - lockTime < 1000;\n}\n","/**\n * Warehouse materials and ingredient drop utilities\n */\n\n// Import isACrop from ResourceHelpers since it's a general utility\nimport { isACrop } from './ResourceHelpers';\n\n/**\n * Determine which third of players a player belongs to based on their ID\n * Used for asymmetric rarity distribution\n * @param {string} playerId - The player's unique ID\n * @returns {number} 0, 1, or 2 (splits players into thirds)\n */\nexport function getPlayerRarityGroup(playerId) {\n  // Simple hash: sum all character codes\n  let hash = 0;\n  for (let i = 0; i < playerId.length; i++) {\n    hash += playerId.charCodeAt(i);\n  }\n  // Return 0, 1, or 2 (splits players into thirds)\n  return hash % 3;\n}\n\n/**\n * Map warehouse ingredient rarity based on player's deterministic group\n * Each third of players gets a different rarity distribution\n * @param {string} itemType - The warehouse ingredient type (Saw, Shovel, Screwdriver)\n * @param {string} playerId - The player's unique ID\n * @returns {string} 'common', 'uncommon', or 'rare'\n */\nexport function getPersonalizedWarehouseRarity(itemType, playerId) {\n  const rarityGroup = getPlayerRarityGroup(playerId);\n  \n  // Define rotation pattern for the three warehouse ingredients\n  // Each row represents what a player group experiences\n  const rarityRotation = {\n    'Saw': ['common', 'uncommon', 'rare'],        // Group 0: common, Group 1: uncommon, Group 2: rare\n    'Shovel': ['uncommon', 'rare', 'common'],      // Group 0: uncommon, Group 1: rare, Group 2: common\n    'Screwdriver': ['rare', 'common', 'uncommon']  // Group 0: rare, Group 1: common, Group 2: uncommon\n  };\n  \n  // Return the rarity for this item based on player's group\n  return rarityRotation[itemType]?.[rarityGroup] || 'common';\n}\n\n\n/**\n * Checks for and processes warehouse ingredient drops when collecting crops\n * Uses globalTuning.harvestDropRate to determine if a drop occurs (e.g., 0.1 = 10% chance)\n * Then uses resource.scrollchance to determine which warehouse ingredient to drop\n * @param {string} collectedItemType - The type of item that was collected\n * @param {number} col - Column position for floating text\n * @param {number} row - Row position for floating text\n * @param {number} TILE_SIZE - Tile size for positioning\n * @param {Object} params - Object containing required parameters\n * @param {Object} params.currentPlayer - Current player object\n * @param {Array} params.inventory - Current inventory\n * @param {Array} params.backpack - Current backpack\n * @param {Function} params.setInventory - Inventory setter\n * @param {Function} params.setBackpack - Backpack setter\n * @param {Function} params.setCurrentPlayer - Player setter\n * @param {Function} params.updateStatus - Status update function\n * @param {Array} params.masterResources - Master resources array with warehouse ingredients (requires: \"Warehouse\")\n * @param {Object} params.globalTuning - Global tuning configuration with harvestDropRate\n * @param {Object} params.strings - Localized strings\n * @param {Function} params.FloatingTextManager - Floating text manager\n * @param {Function} params.gainIngredients - Gain ingredients function\n * @param {Function} params.trackQuestProgress - Quest progress tracking function\n * @param {Function} params.getLocalizedString - String localization function\n * @param {Function} params.selectWeightedRandomItem - Weighted random selection function\n * @param {Function} params.getDropQuantity - Drop quantity calculation function\n * @returns {Promise<{dropped: boolean, item?: string, quantity?: number}>} Result of the drop attempt\n */\nexport async function checkAndDropWarehouseIngredient(\n  collectedItemType,\n  col,\n  row,\n  TILE_SIZE,\n  {\n    currentPlayer,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    globalTuning,\n    strings,\n    FloatingTextManager,\n    gainIngredients,\n    trackQuestProgress,\n    getLocalizedString,\n    selectWeightedRandomItem,\n  }\n) {\n  // Check if this is a crop (excluding Wheat to prevent exploit)\n  if (!isACrop(collectedItemType, masterResources) || collectedItemType === 'Wheat') {\n    return { dropped: false };\n  }\n  \n  console.log(`<> Collected crop: ${collectedItemType}, checking for warehouse ingredient drops...`);\n  \n  // Check if we should drop based on harvestDropRate from globalTuning\n  const dropRate = globalTuning?.harvestDropRate || 0.1; // Default to 10% if not configured\n  const roll = Math.random();\n  \n  if (roll > dropRate) {\n    console.log(`< Drop roll failed: ${roll.toFixed(3)} > ${dropRate} (${(dropRate * 100).toFixed(0)}% chance)`);\n    return { dropped: false };\n  }\n  \n  console.log(`< Drop roll succeeded: ${roll.toFixed(3)} <= ${dropRate} (${(dropRate * 100).toFixed(0)}% chance)`);\n  \n  // Get all warehouse ingredients from masterResources\n  const warehouseIngredients = masterResources.filter(res => res.requires === 'Warehouse' && res.scrollchance);\n  \n  if (warehouseIngredients.length === 0) {\n    console.warn('\u000f No warehouse ingredients found in masterResources');\n    return { dropped: false };\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedIngredients = warehouseIngredients.map(ingredient => ({\n    ...ingredient,\n    scrollchance: getPersonalizedWarehouseRarity(ingredient.type, currentPlayer.playerId)\n  }));\n  \n  // Use weighted random selection based on personalized rarity\n  const selectedIngredient = selectWeightedRandomItem(personalizedIngredients, 1);\n  \n  if (!selectedIngredient) {\n    return { dropped: false };\n  }\n  \n  // Warehouse ingredients always drop exactly 1, regardless of rarity\n  const dropQty = 1;\n  \n  console.log(`< Warehouse ingredient drop: ${selectedIngredient.type} x${dropQty} (${selectedIngredient.scrollchance})`);\n  \n  // Show bonus floating text with offset to avoid overlap with main doober text\n  const symbol = selectedIngredient.symbol || '';\n  FloatingTextManager.addFloatingText(\n    `${symbol} +${dropQty} ${getLocalizedString(selectedIngredient.type, strings)}`, \n    col, \n    row - (30 / TILE_SIZE), // Offset up (converted to tile units)\n    TILE_SIZE\n  );\n  \n  // Add the warehouse ingredient to inventory\n  const bonusGained = await gainIngredients({\n    playerId: currentPlayer.playerId,\n    currentPlayer,\n    resource: selectedIngredient.type,\n    quantity: dropQty,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    globalTuning,\n  });\n  \n  if (!bonusGained) {\n    console.warn('L Failed to add bonus warehouse ingredient to inventory - may be full');\n    // Don't show error to user - this is a bonus drop\n    return { dropped: true, item: selectedIngredient.type, quantity: dropQty, added: false };\n  }\n  \n  // Track quest progress for the bonus item\n  await trackQuestProgress(currentPlayer, 'Collect', selectedIngredient.type, dropQty, setCurrentPlayer);\n  \n  return { dropped: true, item: selectedIngredient.type, quantity: dropQty, added: true };\n}\n\n/**\n * Calculate warehouse ingredient drops for bulk harvest operations\n * Calculates drops per farm plot harvested, ignoring skill multipliers\n * @param {number} numPlotsHarvested - Number of farm plots that were harvested\n * @param {Object} params - Object containing required parameters\n * @param {Array} params.masterResources - Master resources array with warehouse ingredients\n * @param {Object} params.globalTuning - Global tuning configuration with harvestDropRate\n * @param {Function} params.selectWeightedRandomItem - Weighted random selection function\n * @param {string} params.playerId - Player ID for personalized rarity calculation\n * @returns {Array} Array of warehouse ingredient drops: [{type, quantity, symbol}]\n */\nexport function calculateBulkWarehouseDrops(numPlotsHarvested, {\n  masterResources,\n  globalTuning,\n  selectWeightedRandomItem,\n  playerId\n}) {\n  const warehouseDrops = [];\n  \n  // Get all warehouse ingredients from masterResources\n  const warehouseIngredients = masterResources.filter(res => res.requires === 'Warehouse' && res.scrollchance);\n  \n  if (warehouseIngredients.length === 0) {\n    console.warn('\u000f No warehouse ingredients found in masterResources');\n    return warehouseDrops;\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedIngredients = warehouseIngredients.map(ingredient => ({\n    ...ingredient,\n    scrollchance: getPersonalizedWarehouseRarity(ingredient.type, playerId)\n  })); \n  \n  // Get drop rate from globalTuning\n  const dropRate = globalTuning?.harvestDropRate || 0.1; // Default to 10%\n  \n  console.log(`< Bulk warehouse calculation: globalTuning.harvestDropRate = ${globalTuning?.harvestDropRate}, resolved dropRate = ${dropRate}`);\n  \n  // Roll for drops once per farm plot harvested (ignoring skill multipliers)\n  for (let i = 0; i < numPlotsHarvested; i++) {\n    const roll = Math.random();\n    \n    if (roll <= dropRate) {\n      // Select a warehouse ingredient using weighted random with personalized rarity\n      const selectedIngredient = selectWeightedRandomItem(personalizedIngredients, 1);\n      \n      if (selectedIngredient) {\n        // Always drop quantity 1 for warehouse ingredients\n        warehouseDrops.push({\n          type: selectedIngredient.type,\n          quantity: 1,\n          symbol: selectedIngredient.symbol || '',\n          rarity: selectedIngredient.scrollchance || 'common'\n        });\n      }\n    }\n  }\n  \n  console.log(`< Bulk warehouse drops calculated: ${warehouseDrops.length} total drops from ${numPlotsHarvested} plots`);\n  return warehouseDrops;\n}\n\n/**\n * Aggregate warehouse drops by type for display\n * @param {Array} warehouseDrops - Array of individual drops\n * @returns {Object} Aggregated drops: {type: {quantity, symbol, rarity}}\n */\nexport function aggregateWarehouseDrops(warehouseDrops) {\n  const aggregated = {};\n  \n  warehouseDrops.forEach(drop => {\n    if (!aggregated[drop.type]) {\n      aggregated[drop.type] = {\n        quantity: 0,\n        symbol: drop.symbol,\n        rarity: drop.rarity\n      };\n    }\n    aggregated[drop.type].quantity += drop.quantity;\n  });\n  \n  return aggregated;\n}\n\n/**\n * Get personalized pet rewards by applying asymmetric rarity to warehouse ingredients\n * For pets, we still use pet level as a multiplier, but warehouse ingredients get personalized rarity\n * @param {Array} petRewards - Array of resources with source === 'pets'\n * @param {string} playerId - Player ID for personalized rarity\n * @returns {Array} Array of pet rewards with personalized rarity for warehouse ingredients\n */\nexport function getPersonalizedPetRewards(petRewards, playerId) {\n  return petRewards.map(reward => {\n    // Only apply personalized rarity to warehouse ingredients\n    if (reward.requires === 'Warehouse') {\n      return {\n        ...reward,\n        scrollchance: getPersonalizedWarehouseRarity(reward.type, playerId)\n      };\n    }\n    // Non-warehouse items keep their original rarity\n    return reward;\n  });\n}","/**\n * DropRates.js\n * Shared utility for managing drop rates and rarity chances across the game.\n * Used by both ScrollReveal and PetPanel systems.\n */\n\n/**\n * Standard rarity table for the game\n * These values represent the relative weight/chance of each rarity tier.\n * Higher numbers = more common.\n */\nconst STANDARD_RARITY_TABLE = {\n  'common': 100,     // 1 in 1 (baseline)\n  'uncommon': 50,    // 1 in 2 \n  'rare': 20,        // 1 in 5\n  'epic': 5,         // 1 in 20\n  'legendary': 1     // 1 in 100\n};\n\n/**\n * Convert rarity string to numeric chance value for weighted selection\n * @param {string} rarity - Rarity tier: 'common', 'uncommon', 'rare', 'epic', 'legendary'\n * @param {number} level - Optional level multiplier (default: 1). Higher levels increase drop rates.\n *                        Level 1 = standard rates, Level 2 = 2x drop rates, etc.\n * @returns {number} Chance weight (higher = more common)\n */\nexport function getRarityChance(rarity, level = 1) {\n  // Handle backward compatibility with old numeric values\n  if (typeof rarity === 'number') {\n    return rarity * level;\n  }\n  \n  // Get base rarity from table\n  const baseRarity = STANDARD_RARITY_TABLE[rarity] || STANDARD_RARITY_TABLE['common'];\n  \n  // Apply level multiplier to effectively reduce the rarity gap\n  // The goal is to make rare items more common at higher levels\n  // by multiplying their weight more than common items.\n  // \n  // We use a formula that compresses the rarity distribution:\n  // newWeight = baseRarity * level^scaleFactor\n  // where scaleFactor is higher for rarer items\n  // \n  // For the desired behavior where legendary goes from 1/100 to 1/20 at level 5:\n  // We need legendary weight to go from 1 to 5 (5x increase)\n  // While common weight should increase less dramatically\n  \n  // Calculate scale factor based on rarity (rarer items get bigger boost)\n  // Common (100) gets smallest boost, Legendary (1) gets biggest boost\n  const rarityScale = 1 + (100 - baseRarity) / 100; // Common=1, Legendary=1.99\n  \n  // Apply the level scaling with the rarity-specific multiplier\n  // This makes rare items increase faster than common items\n  return baseRarity * Math.pow(level, rarityScale - 1);\n}\n\n/**\n * Example calculations for getRarityChance at different levels:\n * \n * Level 1 (base rates):\n * - Common: 100 * 1^0 = 100 (1 in 1.76)\n * - Uncommon: 50 * 1^0.5 = 50 (1 in 3.52)\n * - Rare: 20 * 1^0.8 = 20 (1 in 8.8)\n * - Epic: 5 * 1^0.95 = 5 (1 in 35.2)\n * - Legendary: 1 * 1^0.99 = 1 (1 in 176)\n * \n * Level 5 (compressed distribution):\n * - Common: 100 * 5^0 = 100 (1 in 3.89)\n * - Uncommon: 50 * 5^0.5 = 111.8 (1 in 3.48)\n * - Rare: 20 * 5^0.8 = 65.9 (1 in 5.91)\n * - Epic: 5 * 5^0.95 = 22.8 (1 in 17.07)\n * - Legendary: 1 * 5^0.99 = 4.9 (1 in 79.4)\n * \n * This achieves the goal where legendary becomes approximately 5x more common at level 5\n * while common items stay at the same absolute weight.\n */\n\n/**\n * Select a random rarity tier based on weighted probabilities\n * @param {number} level - Optional level multiplier for drop rates (default: 1)\n * @returns {string} Selected rarity tier\n */\nexport function selectRandomRarity(level = 1) {\n  // Calculate total weight with level multiplier\n  const totalWeight = Object.entries(STANDARD_RARITY_TABLE).reduce(\n    (sum, [rarity, baseChance]) => sum + getRarityChance(rarity, level), \n    0\n  );\n  \n  // Generate random value\n  const roll = Math.random() * totalWeight;\n  let cumulative = 0;\n  \n  // Find which rarity tier the roll falls into\n  for (const [rarity, baseChance] of Object.entries(STANDARD_RARITY_TABLE)) {\n    cumulative += getRarityChance(rarity, level);\n    if (roll <= cumulative) {\n      return rarity;\n    }\n  }\n  \n  // Fallback (shouldn't reach here)\n  return 'common';\n}\n\n/**\n * Select a random item from a weighted array based on rarity\n * @param {Array} items - Array of items with scrollchance property\n * @param {number} level - Optional level multiplier for drop rates (default: 1)\n * @returns {Object|null} Selected item or null if no items\n */\nexport function selectWeightedRandomItem(items, level = 1) {\n  if (!items || items.length === 0) {\n    return null;\n  }\n  \n  // Calculate total weight based on rarity chances\n  const totalWeight = items.reduce(\n    (sum, item) => sum + getRarityChance(item.scrollchance, level), \n    0\n  );\n  \n  // Generate weighted random selection\n  const roll = Math.random() * totalWeight;\n  let cumulative = 0;\n  \n  // Find the selected item based on weighted probability\n  for (const item of items) {\n    cumulative += getRarityChance(item.scrollchance, level);\n    if (roll <= cumulative) {\n      return item;\n    }\n  }\n  \n  // Fallback to first item\n  return items[0];\n}\n\n/**\n * Get drop quantity for a given rarity\n * Common items tend to drop in larger quantities\n * @param {string} rarity - The rarity tier\n * @returns {number} Quantity to drop\n */\nexport function getDropQuantity(rarity) {\n  const quantityRanges = {\n    'common': { min: 2, max: 3 },\n    'uncommon': { min: 2, max: 3 },\n    'rare': { min: 2, max: 3 },\n    'epic': { min: 1, max: 1 },\n    'legendary': { min: 1, max: 1 }\n  };\n  \n  const range = quantityRanges[rarity] || quantityRanges['common'];\n  return Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;\n}\n\n/**\n * Export the standard rarity table for reference\n */\nexport const RARITY_TABLE = STANDARD_RARITY_TABLE;","import API_BASE from './config.js'; \nimport axios from 'axios';\nimport { fetchInventoryAndBackpack, refreshPlayerAfterInventoryUpdate } from './Utils/InventoryManagement';\nimport { gainIngredients, spendIngredients, calculateSkillMultiplier, hasRoomFor, isCurrency } from './Utils/InventoryManagement';\nimport { updateGridResource } from './Utils/GridManagement';\nimport { loadMasterResources, loadMasterSkills } from './Utils/TuningManager'; // Centralized tuning manager\nimport FloatingTextManager from './UI/FloatingText';\nimport { lockResource, unlockResource } from './Utils/ResourceLockManager';\nimport { trackQuestProgress } from './GameFeatures/Quests/QuestGoalTracker';\nimport { showNotification } from './UI/Notifications/Notifications';\nimport { createCollectEffect, createSourceConversionEffect, calculateTileCenter } from './VFX/VFX';\nimport { earnTrophy } from './GameFeatures/Trophies/TrophyUtils';\nimport { useStrings } from './UI/StringsContext';\nimport { getLocalizedString } from './Utils/stringLookup';\nimport { formatSingleCollection } from './UI/StatusBar/CollectionFormatters';\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport { checkAndDropWarehouseIngredient } from './Utils/WarehouseMaterials';\nimport { selectWeightedRandomItem, getDropQuantity } from './Economy/DropRates';\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport { getDerivedRange } from './Utils/worldHelpers';\nimport { enrichResourceFromMaster } from './Utils/ResourceHelpers';\n\n \n // Handles resource click actions based on category. //\n export async function handleResourceClick(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  addFloatingText,\n  gridId,\n  TILE_SIZE,\n  tileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setTileTypes,\n  updateStatus,\n  masterResources,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  closeAllPanels,\n  strings,\n  bulkOperationContext,\n  openPanel,\n  masterTrophies = null,\n  globalTuning = null,\n  transitionFadeControl = null,\n  timers = null\n) {\n  console.log(`Resource Clicked:  (${row}, ${col}):`, { resource, tileType: tileTypes[row]?.[col] });\n  if (!resource || !resource.category) { console.error(`Invalid resource at (${col}, ${row}):`, resource); return; }\n  \n  // Check range before doing anything else (skip on own homestead)\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n  const playerPos = playersInGridManager.getPlayerPosition(gridId, String(currentPlayer._id));\n  const resourcePos = { x: col, y: row };\n\n  if (!isOnOwnHomestead && playerPos && typeof playerPos.x === 'number' && typeof playerPos.y === 'number') {\n    const distance = Math.sqrt(Math.pow(playerPos.x - resourcePos.x, 2) + Math.pow(playerPos.y - resourcePos.y, 2));\n    const playerRange = getDerivedRange(currentPlayer, masterResources);\n\n    if (distance > playerRange) {\n      // Show \"Out of range\" message\n      FloatingTextManager.addFloatingText(24, col, row, TILE_SIZE);\n      console.log('Resource out of range');\n      return;\n    }\n\n    // Wall blocking check removed - App.js handles this before calling handleResourceClick\n  }\n  \n  lockResource(col, row); // Optimistically lock the resource\n\n  try {\n    // Load master resources and skills (cached internally)\n    if (!masterResources || masterResources.length === 0) { \n      masterResources = await loadMasterResources();  // Direct assignment without `const`\n    }\n    if (!masterSkills || masterSkills.length === 0) { \n      masterSkills = await loadMasterSkills(); \n    }\n    const skills = currentPlayer.skills;\n    // Fetch inventory and backpack if either is empty\n    if ((!Array.isArray(inventory)) || (!Array.isArray(backpack))) {\n      console.warn('Inventory or backpack is not initialized; fetching from server.');\n      const { inventory: fetchedInventory, backpack: fetchedBackpack } = await fetchInventoryAndBackpack(currentPlayer.playerId);\n      setInventory(fetchedInventory); // Update state with fetched inventory\n      setBackpack(fetchedBackpack); // Update state with fetched backpack\n    }\n\n    switch (resource.category) {\n\n      case 'doober':\n      case 'special':\n        await handleDooberClick(\n          resource,\n          row,\n          col,\n          resources,\n          setResources,\n          setInventory,\n          setBackpack,\n          currentPlayer?.inventory || [],\n          currentPlayer?.backpack || [],\n          skills,\n          gridId,\n          addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          masterSkills, // Pass tuning data\n          strings,\n          openPanel,\n          globalTuning,\n          masterTrophies\n        );\n        break;\n\n      case 'source':\n        await handleSourceConversion(\n          resource,\n          row,\n          col,\n          resources,\n          setResources,\n          inventory,\n          setInventory,\n          backpack,\n          setBackpack,  \n          gridId,\n          addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          masterResources,\n          masterSkills, \n          setModalContent,\n          setIsModalOpen,\n          updateStatus,\n          strings\n        );\n        break;\n\n      case 'seed':\n        console.log('Seed clicked; do nothing');\n        break;\n\n      case 'deco':\n        console.log('Deco clicked; placeholder for future functionality');\n        break;\n        \n        \n      default:\n        console.warn(`Unhandled resource category: ${resource.category}`);\n    }\n  } catch (error) {\n    console.error('Error handling resource click:', error);\n    unlockResource(col, row); // Unlock the resource on error\n  } finally {\n    unlockResource(col, row);\n  }\n}\n\n\n// HANDLE DOOBER CLICKS //\n//\nexport async function handleDooberClick(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory = [],\n  backpack = [],\n  skills = [],\n  gridId,\n  addFloatingText,\n  TILE_SIZE,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  masterSkills,\n  strings = {},\n  openPanel = null,\n  globalTuning = null,\n  masterTrophies = null\n) {\n  console.log('handleDooberClick: Current Player:', currentPlayer);\n  console.log('handleDooberClick: Current backpack:', backpack);\n  const gtype = currentPlayer.location.gtype;\n  const baseQtyCollected = resource.qtycollected || 1;\n\n  if (!Array.isArray(inventory) || !Array.isArray(backpack)) {\n    console.warn(\"Inventory or backpack missing; aborting doober click.\");\n    return;\n  }\n\n  // Create a unique ID for this doober to prevent double-processing\n  const dooberId = `${resource.type}-${col}-${row}`;\n  \n  // Check if we're already processing this doober (prevent double-clicks)\n  if (window._processingDoobers && window._processingDoobers.has(dooberId)) {\n    console.log(\"Already processing this doober, ignoring duplicate click\");\n    return;\n  }\n  \n  // Mark this doober as being processed\n  if (!window._processingDoobers) {\n    window._processingDoobers = new Set();\n  }\n  window._processingDoobers.add(dooberId);\n\n  console.log('MasterSkills:', masterSkills);\n  // Extract player skills from inventory\n  const playerBuffs = skills\n    .filter((item) => {\n      const resourceDetails = masterResources.find((res) => res.type === item.type);\n      const isSkill = resourceDetails?.category === 'skill';\n      const appliesToResource = (masterSkills?.[item.type]?.[resource.type] || 1) > 1;\n      return isSkill && appliesToResource;\n    })\n    .map((buffItem) => buffItem.type);\n\n  //console.log('Player Buffs (Skills and Upgrades):', playerBuffs);\n  // Calculate skill multiplier\n  const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n    const buffValue = masterSkills?.[buff]?.[resource.type] || 1;\n    //console.log(`Buff \"${buff}\" applies to \"${resource.type}\" with multiplier x${buffValue}`);\n    return multiplier * buffValue;\n  }, 1);\n  const qtyCollected = baseQtyCollected * skillMultiplier;\n  console.log('[DEBUG] qtyCollected after multiplier:', qtyCollected);\n  \n  // Check for missing backpack FIRST before any optimistic updates\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const isCurrencyItem = isCurrency(resource.type);\n  const storingInBackpack = !isCurrencyItem && !isHomestead;\n  \n  if (storingInBackpack) {\n    const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n    if (!hasBackpackSkill) {\n      // Missing backpack - show status message and floating text\n      updateStatus(19); // Missing backpack message\n      FloatingTextManager.addFloatingText(strings[\"44\"] || \"No backpack\", col, row, TILE_SIZE);\n      // Clear processing flag\n      if (window._processingDoobers) {\n        window._processingDoobers.delete(dooberId);\n      }\n      return;\n    }\n  }\n  \n  // Pre-check capacity before optimistic update\n  const hasRoom = hasRoomFor({\n    resource: resource.type,\n    quantity: qtyCollected,\n    currentPlayer,\n    inventory,\n    backpack,\n    masterResources,\n    globalTuning\n  });\n  \n  if (!hasRoom) {\n    // At this point we know they have a backpack if needed, so this is a real capacity issue\n    console.warn(\"Pre-check: No room for resource. Showing error immediately.\");\n    FloatingTextManager.addFloatingText(strings[\"41\"] || \"Not enough room\", col, row, TILE_SIZE);\n    if (openPanel) {\n      openPanel('InventoryPanel');\n    }\n    // Clear processing flag\n    if (window._processingDoobers) {\n      window._processingDoobers.delete(dooberId);\n    }\n    return;\n  }\n  \n  // Optimistically remove the resource from display AND show effects\n  setResources((prevResources) =>\n    prevResources.filter((res) => !(res.x === col && res.y === row))\n  );\n  \n  // Show VFX and floating text immediately for responsiveness\n  createCollectEffect(col, row, TILE_SIZE);\n  FloatingTextManager.addFloatingText(`+${qtyCollected} ${getLocalizedString(resource.type, strings)}`, col, row, TILE_SIZE);\n\n  // Perform server validation\n  try {\n    // Use gainIngredients to handle inventory/backpack update, sync, and capacity check\n    console.log(\"Calling gainIngredients with: \",resource.type);\n    \n    const gainResult = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: resource.type,\n      quantity: qtyCollected,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n    // Handle the result based on error type\n    if (gainResult === true) {\n      // Success - continue with normal flow\n    } else if (gainResult && gainResult.success === false) {\n      // Check if we should rollback based on error type\n      if (gainResult.isCapacityError) {\n        // Real conflict - rollback the doober\n        console.warn(\" Capacity limit reached. Rolling back doober.\");\n        setResources((prevResources) => [...prevResources, resource]);\n        \n        // Check if the error is specifically about missing backpack\n        if (gainResult.isMissingBackpack) {\n          // Don't show floating text - status message (19) already set by gainIngredients\n          // Don't open inventory panel for missing backpack\n        } else {\n          // Show floating text for actual capacity error\n          FloatingTextManager.addFloatingText(strings[\"41\"] || \"Not enough room\", col, row, TILE_SIZE);\n          // Auto-open inventory panel when truly at capacity\n          console.log(\"Opening inventory panel. openPanel function:\", openPanel);\n          if (openPanel) {\n            openPanel('InventoryPanel');\n          } else {\n            console.warn(\"openPanel function not available!\");\n          }\n        }\n        // Clear processing flag\n        if (window._processingDoobers) {\n          window._processingDoobers.delete(dooberId);\n        }\n        return;\n      } else if (gainResult.isNetworkError) {\n        // Network/server error - don't rollback, the server might have queued it\n        console.warn(\" Network error during collection, but server may have queued the operation. Not rolling back.\");\n        // Still show success effects since server likely processed it\n      } else {\n        // Other client-side errors - rollback\n        console.warn(\" Client error during collection. Rolling back.\");\n        setResources((prevResources) => [...prevResources, resource]);\n        // Clear processing flag\n        if (window._processingDoobers) {\n          window._processingDoobers.delete(dooberId);\n        }\n        return;\n      }\n    }\n    \n    // Calculate skill info for formatting\n    const skillInfo = calculateSkillMultiplier(resource.type, skills || [], masterSkills);\n    \n    // Format and show status message using shared formatter\n    const statusMessage = formatSingleCollection('harvest', resource.type, qtyCollected, \n      skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n    updateStatus(statusMessage);\n\n    const gridUpdateResponse = await updateGridResource(\n      gridId,\n      { type: null, x: col, y: row }, // Collecting doober removes it\n      true\n    );\n    if (!gridUpdateResponse?.success) {\n      console.warn(' Grid update failed even though inventory succeeded.');\n      return;\n    }\n\n    // Track quest progress for \"Collect\" actions\n    // trackQuestProgress expects: (player, action, item, quantity, setCurrentPlayer)\n    await trackQuestProgress(currentPlayer, 'Collect', resource.type, qtyCollected, setCurrentPlayer);\n\n    // Check for warehouse ingredient drops when collecting crops\n    await checkAndDropWarehouseIngredient(\n      resource.type,\n      col,\n      row,\n      TILE_SIZE,\n      {\n        currentPlayer,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n        strings,\n        FloatingTextManager,\n        gainIngredients,\n        trackQuestProgress,\n        getLocalizedString,\n        selectWeightedRandomItem,\n      }\n    );\n\n    // Award trophies for specific collected items\n    if (masterTrophies && currentPlayer?.playerId) {\n      try {\n        if (resource.type === \"King's Crown\") {\n          console.log(` Awarding King's Crown trophy for collecting ${qtyCollected} crown(s)`);\n          \n          // Award the Count-type trophy for each crown collected\n          for (let i = 0; i < qtyCollected; i++) {\n            await earnTrophy(currentPlayer.playerId, \"King's Crown\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${qtyCollected} King's Crown trophy instance(s)`);\n        } else if (resource.type === \"Trident\") {\n          console.log(` Awarding Trident trophy for collecting ${qtyCollected} trident(s)`);\n          \n          // Award the Count-type trophy for each trident collected\n          for (let i = 0; i < qtyCollected; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Trident\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${qtyCollected} Trident trophy instance(s)`);\n        }\n      } catch (error) {\n        console.error(' Error awarding collection trophy:', error);\n        // Don't fail the collection if trophy awarding fails\n      }\n    }\n\n    // Update currentPlayer state locally\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    console.log('[DEBUG] Player state refreshed after inventory update.');\n\n    // Handle replanting if resource is repeatable\n    if (resource.repeatable === true) {\n      await handleReplant(\n        resource,\n        row,\n        col,\n        setResources,\n        gridId,\n        masterResources\n      );\n    }\n  } catch (error) {\n    console.error('Error during doober collection:', error);\n    // Rollback local resource state on server failure\n    setResources((prevResources) => [...prevResources, resource]);\n  } finally {\n    unlockResource(col, row); // Always unlock the resource\n    // Clear the processing flag for this doober\n    if (window._processingDoobers) {\n      window._processingDoobers.delete(dooberId);\n    }\n  }\n}\n\n// HANDLE REPLANT - Called when a repeatable doober is collected\n// Finds the farmplot that outputs this resource and plants it in the same location\n// Mirrors handleFarmPlotPlacement logic from Farming.js\nasync function handleReplant(\n  collectedResource,\n  row,\n  col,\n  setResources,\n  gridId,\n  masterResources\n) {\n  console.log(` handleReplant: Looking for farmplot that outputs ${collectedResource.type}`);\n\n  // Find the farmplot resource that outputs this collected resource\n  const farmplotResource = masterResources.find(\n    (res) => res.category === 'farmplot' && res.output === collectedResource.type\n  );\n\n  if (!farmplotResource) {\n    console.warn(` handleReplant: No farmplot found that outputs ${collectedResource.type}`);\n    return;\n  }\n\n  console.log(` handleReplant: Found farmplot ${farmplotResource.type}, planting at (${col}, ${row})`);\n\n  // Calculate growEnd based on farmplot's growtime (growtime is in seconds, convert to ms)\n  // This matches Farming.js line 67: Date.now() + (selectedItem.growtime || 0) * 1000\n  const growEndTime = Date.now() + (farmplotResource.growtime || 0) * 1000;\n  console.log(` handleReplant: growtime = ${farmplotResource.growtime}, growEndTime = ${growEndTime}, secondsFromNow = ${(growEndTime - Date.now()) / 1000}`);\n\n  // Use enrichResourceFromMaster like Farming.js does for proper enrichment\n  const enrichedNewResource = enrichResourceFromMaster(\n    {\n      type: farmplotResource.type,\n      x: col,\n      y: row,\n      growEnd: growEndTime,\n    },\n    masterResources\n  );\n\n  console.log(' handleReplant: Enriched farmplot resource:', enrichedNewResource);\n\n  // Update local state - add the new farmplot resource\n  const currentResources = GlobalGridStateTilesAndResources.getResources();\n  const finalResources = [...currentResources, enrichedNewResource];\n\n  GlobalGridStateTilesAndResources.setResources(finalResources);\n  setResources(finalResources);\n\n  // Perform server update to add the farmplot\n  try {\n    const gridUpdateResponse = await updateGridResource(\n      gridId,\n      {\n        type: farmplotResource.type,\n        x: col,\n        y: row,\n        growEnd: growEndTime\n      },\n      true\n    );\n\n    if (gridUpdateResponse?.success) {\n      console.log(` handleReplant: Successfully planted ${farmplotResource.type} at (${col}, ${row})`);\n    } else {\n      throw new Error('Server failed to confirm the replant.');\n    }\n  } catch (error) {\n    console.error(' handleReplant: Error during replanting:', error);\n    // Rollback local state on failure\n    const rolledBackResources = GlobalGridStateTilesAndResources.getResources().filter(\n      (res) => !(res.x === col && res.y === row && res.type === farmplotResource.type)\n    );\n    GlobalGridStateTilesAndResources.setResources(rolledBackResources);\n    setResources(rolledBackResources);\n  }\n}\n\n// HANDLE SOURCE CONVERSIONS //\n//\nexport async function handleSourceConversion(\n  resource,\n  row,\n  col,\n  resources,\n  setResources,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  gridId,\n  addFloatingText,\n  TILE_SIZE,\n  currentPlayer,\n  setCurrentPlayer,\n  masterResources,\n  masterSkills,\n  setModalContent,\n  setIsModalOpen,\n  updateStatus,\n  strings\n) {\n  if (resource.action !== 'convertTo') return;\n\n  // Get target resource first\n  const targetResource = masterResources.find((res) => res.type === resource.output);\n  if (!targetResource) { console.warn(` No matching resource found for output: ${resource.output}`); return; }\n\n  // Get required skill\n  const requirement = resource.requires;\n  const isSkill = masterResources.some(\n    res => res.type === requirement && res.category === \"skill\"\n  );\n\n  // Required Skill Missing\n  if (isSkill) {\n    const hasSkill = currentPlayer.skills?.some(skill => skill.type === requirement);\n    if (!hasSkill) {\n      addFloatingText(`${requirement} Required`, col, row, TILE_SIZE);\n      // Show notification about missing skill (different message for Axe vs Pickaxe)\n      const messageKey = requirement === 'Axe' ? 7057 : requirement === 'Pickaxe' ? 7058 : null;\n      if (messageKey) {\n        showNotification('FTUE', {\n          title: strings[7049],\n          message: strings[messageKey],\n          icon: ''\n        });\n      }\n      return;\n    }\n  }\n\n    createSourceConversionEffect(col, row, TILE_SIZE, requirement);\n\n  // Check if the object should disappear (output is null/empty) or transform\n  const shouldDisappear = !resource.output || resource.output === 'null' || !targetResource;\n  \n  if (shouldDisappear) {\n    // Find the original resource to check for shadows - use global state like ProtectedSelling does\n    const originalResource = GlobalGridStateTilesAndResources.getResources().find(\n      r => r.x === col && r.y === row\n    );\n\n    // Update local state to reflect removal of resource and shadows\n    const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n      (res) => {\n        // Remove the main resource\n        if (res.x === col && res.y === row) return false;\n        \n        // Remove any shadows belonging to this resource if it was multi-tile\n        if (originalResource && originalResource.range && originalResource.range > 1 && res.type === 'shadow') {\n          const anchorKey = originalResource.anchorKey || `${originalResource.type}-${originalResource.x}-${originalResource.y}`;\n          if (res.parentAnchorKey === anchorKey) {\n            return false;\n          }\n        }\n        return true;\n      }\n    );\n    \n    // Update both global and local state with the same filtered array - exactly like ProtectedSelling does\n    GlobalGridStateTilesAndResources.setResources(filteredResources);\n    setResources(filteredResources);\n\n    // Perform server update to remove the main resource\n    try {\n      const gridUpdateResponse = await updateGridResource(\n        gridId, \n        { type: null, x: col, y: row }, \n        true\n      );\n      if (gridUpdateResponse?.success) {\n        // VFX\n        // createSourceConversionEffect(col, row, TILE_SIZE, requirement);\n        console.log(' Resource removal completed successfully on the server.');\n      } else {\n        throw new Error('Server failed to confirm the resource removal.');\n      }\n    } catch (error) {\n      console.error(' Error during resource removal:', error);\n      console.warn('Server update failed. The client may become out of sync.');\n    }\n  } else {\n    // Build the new resource object to replace the one we just clicked\n    const x = col;\n    const y = row;\n    const enrichedNewResource = {\n      ...targetResource,\n      x,\n      y,\n      symbol: targetResource.symbol,\n      qtycollected: targetResource.qtycollected || 1,\n      category: targetResource.category || 'doober',\n      growEnd: targetResource.growEnd || null,\n    };\n    console.log('Enriched newResource for local state: ', enrichedNewResource);\n\n    // Find the original resource to check for shadows - use global state like ProtectedSelling does\n    const originalResource = GlobalGridStateTilesAndResources.getResources().find(\n      r => r.x === col && r.y === row\n    );\n    \n    // Filter out the main resource AND any shadows, then add the new resource\n    const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n      (res) => {\n        // Remove the main resource\n        if (res.x === col && res.y === row) return false;\n        \n        // Remove any shadows belonging to this resource if it was multi-tile\n        if (originalResource && originalResource.range && originalResource.range > 1 && res.type === 'shadow') {\n          const anchorKey = originalResource.anchorKey || `${originalResource.type}-${originalResource.x}-${originalResource.y}`;\n          if (res.parentAnchorKey === anchorKey) {\n            return false;\n          }\n        }\n        return true;\n      }\n    );\n    \n    // Add the new resource to the filtered list\n    const finalResources = [...filteredResources, enrichedNewResource];\n    \n    // Update both global and local state with the same filtered array - exactly like ProtectedSelling does\n    GlobalGridStateTilesAndResources.setResources(finalResources);\n    setResources(finalResources);\n\n    // Perform server update\n    try {\n      const gridUpdateResponse = await updateGridResource(\n        gridId, \n        { type: targetResource.type, x: col, y: row }, \n        true\n      );\n      if (gridUpdateResponse?.success) {\n        // VFX\n        //createSourceConversionEffect(col, row, TILE_SIZE, requirement);\n        console.log(' Source conversion completed successfully on the server.');\n      } else {\n        throw new Error('Server failed to confirm the source conversion.');\n      }\n    } catch (error) {\n      console.error(' Error during source conversion:', error);\n      console.warn('Server update failed. The client may become out of sync.');\n    }\n  }\n  \n  // Shared cleanup regardless of disappear/transform\n  try {\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    unlockResource(col, row);\n  } catch (error) {\n    console.error(' Error during cleanup:', error);\n  }\n}","import React, { createContext, useContext, useState } from 'react';\n\nconst UILockContext = createContext();\n\nexport const UILockProvider = ({ children }) => {\n  const [uiLocked, setUILocked] = useState(false);\n  return (\n    <UILockContext.Provider value={{ uiLocked, setUILocked }}>\n      {children}\n    </UILockContext.Provider>\n  );\n};\n\nexport const useUILock = () => useContext(UILockContext);","import React, { useState, useEffect, useRef } from 'react';\nimport './Modal.css';\nimport './StoryModal.css';\nimport '../Buttons/SharedButtons.css';\nimport { useStrings } from '../StringsContext';\nimport RelationshipMatrix from '../../GameFeatures/Relationships/RelationshipMatrix.json';\n\n/**\n * StoryModal Component\n *\n * Displays dialog when a relationship milestone is reached with an NPC,\n * or for FTUE moments featuring the player character.\n * Supports pagination for long dialog text, breaking at sentence boundaries.\n * Text appears word by word to simulate talking.\n *\n * @param {boolean} isOpen - Whether the modal is visible\n * @param {function} onClose - Callback when modal is closed\n * @param {string} npcName - The name/type of the NPC (e.g., \"Portia\", \"Hotspur\") - used for NPC dialog lookup\n * @param {string} relationshipType - The relationship milestone (e.g., \"met\", \"friend\", \"married\", \"FTUE\")\n * @param {string} username - The player's username to replace {username} placeholders\n * @param {string} symbol - Direct symbol to display (overrides NPC lookup, useful for PC icon in FTUE)\n * @param {number|string} dialogKey - Direct string ID for dialog text (overrides NPC dialog lookup)\n */\nfunction StoryModal({ isOpen = false, onClose, npcName, relationshipType, username, symbol, dialogKey: directDialogKey }) {\n  const strings = useStrings();\n  const [currentPage, setCurrentPage] = useState(0);\n  const [pages, setPages] = useState([]);\n  const [visibleWordCount, setVisibleWordCount] = useState(0);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const animationRef = useRef(null);\n  const isInitialMount = useRef(true);\n\n  // Word reveal speed in milliseconds\n  const WORD_REVEAL_DELAY = 80;\n\n  // Map relationship types to their dialog key names in RelationshipMatrix\n  const relationshipDialogKeys = {\n    met: 'dialogOnMet',\n    friend: 'dialogOnFriend',\n    married: 'dialogOnMarried',\n    love: 'dialogOnLove',\n    rival: 'dialogOnRival',\n  };\n\n  // Get NPC data from RelationshipMatrix (only needed for NPC-based dialogs)\n  const npcData = npcName ? RelationshipMatrix.find(r => r.type === npcName) : null;\n\n  // Determine the symbol to display:\n  // 1. Use direct symbol prop if provided (for FTUE with player icon)\n  // 2. Otherwise use NPC symbol from RelationshipMatrix\n  // 3. Fall back to '?' if neither available\n  const displaySymbol = symbol || npcData?.symbol || '?';\n\n  // Determine the dialog text:\n  // 1. If directDialogKey is provided, use it directly (for FTUE)\n  // 2. Otherwise look up from NPC's relationship dialog\n  let rawDialogText = null;\n  if (directDialogKey) {\n    // Direct dialog key provided (e.g., from FTUE step's bodyKey)\n    rawDialogText = strings[directDialogKey];\n  } else if (npcData && relationshipType) {\n    // NPC-based dialog lookup\n    const dialogKeyName = relationshipDialogKeys[relationshipType];\n    const npcDialogStringId = npcData?.[dialogKeyName];\n    rawDialogText = npcDialogStringId ? strings[npcDialogStringId] : null;\n  }\n\n  // Replace {username} placeholder with actual player username\n  const dialogText = rawDialogText ? rawDialogText.replace(/\\{username\\}/gi, username || 'Adventurer') : null;\n\n  // Split dialog into pages at sentence boundaries\n  useEffect(() => {\n    if (!dialogText) {\n      setPages([]);\n      return;\n    }\n\n    // Split at sentence boundaries (., !, ?)\n    // Keep the punctuation with the sentence\n    const sentences = dialogText.match(/[^.!?]+[.!?]+/g) || [dialogText];\n\n    // Group sentences into pages (aim for ~150 characters per page for readability)\n    const MAX_CHARS_PER_PAGE = 150;\n    const newPages = [];\n    let currentPageText = '';\n\n    sentences.forEach((sentence) => {\n      const trimmedSentence = sentence.trim();\n\n      // If adding this sentence would exceed the limit, start a new page\n      if (currentPageText.length > 0 &&\n          currentPageText.length + trimmedSentence.length > MAX_CHARS_PER_PAGE) {\n        newPages.push(currentPageText.trim());\n        currentPageText = trimmedSentence;\n      } else {\n        currentPageText += (currentPageText ? ' ' : '') + trimmedSentence;\n      }\n    });\n\n    // Don't forget the last page\n    if (currentPageText.trim()) {\n      newPages.push(currentPageText.trim());\n    }\n\n    setPages(newPages);\n    setCurrentPage(0);\n    setVisibleWordCount(0);\n    setIsAnimating(true);\n  }, [dialogText]);\n\n  // Reset to first page and start animation when modal opens with new content\n  useEffect(() => {\n    if (isOpen) {\n      setCurrentPage(0);\n      setVisibleWordCount(0);\n      setIsAnimating(true);\n    } else {\n      // Clear animation when modal closes\n      if (animationRef.current) {\n        clearTimeout(animationRef.current);\n      }\n    }\n  }, [isOpen, npcName, relationshipType, directDialogKey, symbol]);\n\n  // Word-by-word animation effect\n  useEffect(() => {\n    if (!isOpen || !isAnimating) return;\n\n    const currentText = pages[currentPage] || '';\n    const words = currentText.split(/\\s+/).filter(w => w.length > 0);\n    const totalWords = words.length;\n\n    if (visibleWordCount < totalWords) {\n      animationRef.current = setTimeout(() => {\n        setVisibleWordCount(prev => prev + 1);\n      }, WORD_REVEAL_DELAY);\n    } else {\n      setIsAnimating(false);\n    }\n\n    return () => {\n      if (animationRef.current) {\n        clearTimeout(animationRef.current);\n      }\n    };\n  }, [isOpen, isAnimating, visibleWordCount, currentPage, pages]);\n\n  // Reset word count when page changes (but not on initial mount)\n  useEffect(() => {\n    if (isInitialMount.current) {\n      isInitialMount.current = false;\n      return;\n    }\n    setVisibleWordCount(0);\n    setIsAnimating(true);\n  }, [currentPage]);\n\n  // Don't render until pages are populated to avoid showing empty \"\"\n  if (!isOpen || !dialogText || pages.length === 0) return null;\n\n  const isLastPage = currentPage >= pages.length - 1;\n  const currentText = pages[currentPage] || '';\n  const words = currentText.split(/\\s+/).filter(w => w.length > 0);\n  const visibleText = words.slice(0, visibleWordCount).join(' ');\n  const isTextComplete = visibleWordCount >= words.length;\n\n  const handleNext = () => {\n    if (isTextComplete && !isLastPage) {\n      setCurrentPage(prev => prev + 1);\n    } else if (!isTextComplete) {\n      // Skip animation - show all words immediately\n      setVisibleWordCount(words.length);\n      setIsAnimating(false);\n    }\n  };\n\n  const handleOk = () => {\n    if (isTextComplete) {\n      onClose();\n    } else {\n      // Skip animation - show all words immediately\n      setVisibleWordCount(words.length);\n      setIsAnimating(false);\n    }\n  };\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-container modal-small story-modal\">\n        {/* Close Button */}\n        <button className=\"modal-close-btn\" onClick={onClose}>\n          &times;\n        </button>\n\n        {/* Character Symbol (NPC or PC) */}\n        <div className=\"story-modal-symbol\">\n          {displaySymbol}\n        </div>\n\n        {/* Dialog Content */}\n        <div className=\"modal-content story-modal-content\">\n          <p className=\"story-modal-text\">\"{visibleText}\"</p>\n        </div>\n\n        {/* Page indicator for multi-page dialogs */}\n        {pages.length > 1 && (\n          <div className=\"story-modal-page-indicator\">\n            {currentPage + 1} / {pages.length}\n          </div>\n        )}\n\n        {/* Navigation Buttons */}\n        <div className=\"modal-buttons shared-buttons\">\n          {isLastPage ? (\n            <button className=\"btn-basic btn-modal btn-success\" onClick={handleOk}>\n              {strings[796] || 'OK'}\n            </button>\n          ) : (\n            <button className=\"btn-basic btn-modal btn-success\" onClick={handleNext}>\n              {strings[796] || 'OK'}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default StoryModal;\n","import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport './FTUE.css';\nimport FTUEstepsData from './FTUEsteps.json';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport { addAcceptedQuest, completeTutorial, handleFeedbackSubmit } from './FTUEutils';\nimport StoryModal from '../../UI/Modals/StoryModal';\n\n\nconst FTUE = ({ currentPlayer, setCurrentPlayer, onClose, openPanel, setActiveQuestGiver, gridId }) => {\n  const strings = useStrings();\n  const [currentStepData, setCurrentStepData] = useState(null);\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n  const [positiveReasons, setPositiveReasons] = useState([]);\n  const [negativeReasons, setNegativeReasons] = useState([]);\n  \n  // Load the current step data based on player's ftuestep\n  useEffect(() => {\n    // Only show FTUE if player is explicitly a first-time user\n    if (currentPlayer?.firsttimeuser !== true) {\n      console.log('Player is not a first-time user, closing FTUE');\n      onClose();\n      return;\n    }\n    \n    // Handle step 0 by showing step 1 content without advancing yet\n    if (currentPlayer?.ftuestep === 0) {\n      console.log(' Player at FTUE step 0, showing step 1 content');\n      const step1Data = FTUEstepsData.find(step => step.step === 1);\n      if (step1Data) {\n        setCurrentStepData(step1Data);\n      }\n      return;\n    }\n    \n    if (currentPlayer?.ftuestep) {\n      // Normal step loading\n      const stepData = FTUEstepsData.find(step => step.step === currentPlayer.ftuestep);\n      if (stepData) {\n        setCurrentStepData(stepData);\n      } else {\n        // If no valid step found, close the FTUE\n        console.log('No valid FTUE step found for step:', currentPlayer.ftuestep);\n        onClose();\n      }\n    }\n  }, [currentPlayer?.ftuestep, currentPlayer?.firsttimeuser, onClose]);\n\n  // Show notification and add quests for current step on load/refresh\n  // This ensures players see the notification again if they refresh the app\n  // and that quests are added for trigger-based steps that don't have modals\n  useEffect(() => {\n    if (!currentStepData || !strings) return;\n\n    // Show notification if defined\n    if (currentStepData.notificationKey) {\n      console.log(` Re-triggering notification for step ${currentStepData.step} on load`);\n      showNotification('FTUE', {\n        title: strings[7049],\n        message: strings[currentStepData.notificationKey],\n        ...(currentStepData.notificationIcon && { icon: currentStepData.notificationIcon })\n      });\n    }\n\n    // Add quests if defined (check for duplicates to avoid re-adding on refresh)\n    const addQuestsForStep = async () => {\n      if (currentStepData.addQuests && currentStepData.addQuests.length > 0) {\n        console.log(` Step ${currentStepData.step}: Checking quests to add: ${currentStepData.addQuests.join(', ')}`);\n\n        // Fetch quest templates to get quest titles for duplicate checking\n        try {\n          const response = await axios.get(`${API_BASE}/api/quests`);\n          const questTemplates = response.data || [];\n          const currentActiveQuests = currentPlayer?.activeQuests || [];\n\n          let playerState = currentPlayer;\n          for (const questIndex of currentStepData.addQuests) {\n            // Find the quest template to check if it's already added\n            const questTemplate = questTemplates.find(q => q.index === questIndex);\n            if (!questTemplate) continue;\n\n            // Check if quest is already in activeQuests\n            const alreadyHasQuest = currentActiveQuests.some(q => q.questId === questTemplate.title);\n            if (alreadyHasQuest) {\n              console.log(` Quest \"${questTemplate.title}\" already exists, skipping`);\n              continue;\n            }\n\n            console.log(` Adding quest \"${questTemplate.title}\" (index ${questIndex})`);\n            playerState = await addAcceptedQuest(currentPlayer.playerId, playerState, setCurrentPlayer, questIndex);\n          }\n        } catch (error) {\n          console.error('Error adding FTUE quests:', error);\n        }\n      }\n    };\n\n    addQuestsForStep();\n  }, [currentStepData?.step]); // Only trigger when step changes, not on every re-render\n\n  // Auto-advance if step has showModal: false (but not while feedback modal is showing)\n  useEffect(() => {\n    if (currentStepData?.showModal === false && !showFeedbackModal) {\n      console.log(` Step ${currentStepData.step} has showModal: false, auto-advancing...`);\n      // Use setTimeout to ensure handleOK is defined and avoid render cycle issues\n      const timer = setTimeout(() => {\n        handleOK();\n      }, 0);\n      return () => clearTimeout(timer);\n    }\n  }, [currentStepData?.showModal, currentStepData?.step, showFeedbackModal]);\n\n  // Handle feedback submission - saves feedback then continues with current step's logic\n  const onFeedbackSubmit = async (isPositive) => {\n    // Save the feedback\n    await handleFeedbackSubmit(\n      isPositive,\n      currentPlayer.playerId,\n      currentPlayer,\n      setCurrentPlayer,\n      positiveReasons,\n      negativeReasons\n    );\n\n    // Hide feedback modal and continue with the rest of handleOK logic\n    setShowFeedbackModal(false);\n\n    // Continue with the step's remaining logic\n    await continueStepLogic();\n  };\n\n  // Continuation function that executes the rest of the step logic after feedback (if any)\n  const continueStepLogic = async () => {\n    try {\n      const currentStep = currentPlayer.ftuestep === 0 ? 1 : currentPlayer.ftuestep;\n      const actualCurrentStep = currentPlayer.ftuestep;\n      const nextStep = currentStep + 1;\n      const hasNextStep = FTUEstepsData.some(step => step.step === nextStep);\n      const stepData = FTUEstepsData.find(step => step.step === currentStep);\n\n      // Check for notification defined in FTUEsteps.json\n      if (stepData?.notificationKey) {\n        showNotification('FTUE', {\n          title: strings[7049],\n          message: strings[stepData.notificationKey],\n          ...(stepData.notificationIcon && { icon: stepData.notificationIcon })\n        });\n      }\n      // Auto-add quests defined in FTUEsteps.json\n      if (stepData?.addQuests && stepData.addQuests.length > 0) {\n        console.log(` Step ${currentStep}: Auto-adding quests ${stepData.addQuests.join(', ')}`);\n        let playerState = currentPlayer;\n        for (const questIndex of stepData.addQuests) {\n          playerState = await addAcceptedQuest(currentPlayer.playerId, playerState, setCurrentPlayer, questIndex);\n        }\n      }\n\n      if (!hasNextStep) {\n        completeTutorial(currentPlayer.playerId, currentPlayer, setCurrentPlayer, onClose);\n      } else {\n        if (stepData?.continue) {\n          // If the current step has a continue action, advance the FTUE step\n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { ftuestep: actualCurrentStep + 1 }\n          });\n          if (response.data.success) {\n            setCurrentPlayer(prev => ({\n              ...prev,\n              ftuestep: actualCurrentStep + 1\n            }));\n          }\n        }\n        // Close FTUE modal (but don't touch panel state)\n        onClose();\n\n        // Auto-open panel defined in FTUEsteps.json (after closing FTUE modal)\n        if (stepData?.openPanel && openPanel) {\n          console.log(` Step ${currentStep}: Auto-opening ${stepData.openPanel}`);\n          openPanel(stepData.openPanel);\n        }\n      }\n    } catch (error) {\n      console.error('Error in continueStepLogic:', error);\n    }\n  };\n\n  const handleOK = async () => {\n    try {\n      // If we're showing step 1 content but player is still at step 0, advance to step 1\n      const currentStep = currentPlayer.ftuestep === 0 ? 1 : currentPlayer.ftuestep;\n      const stepData = FTUEstepsData.find(step => step.step === currentStep);\n\n      // Check if this step has showFeedbackModalAfter and feedback hasn't been collected yet\n      const hasFeedback = currentPlayer?.ftueFeedback &&\n        (currentPlayer.ftueFeedback.positive?.length > 0 || currentPlayer.ftueFeedback.negative?.length > 0);\n\n      if (stepData?.showFeedbackModalAfter && !hasFeedback) {\n        // Show feedback modal as an intervention after OK is clicked\n        console.log(` Step ${currentStep} has showFeedbackModalAfter, showing feedback modal`);\n        setShowFeedbackModal(true);\n        return; // Don't continue - onFeedbackSubmit will call continueStepLogic\n      }\n\n      // No feedback needed, continue with step logic\n      await continueStepLogic();\n\n    } catch (error) {\n      console.error('Error advancing FTUE step:', error);\n    }\n  };\n\n\n  // Handle aspiration choice for step 2\n  const handleAspirationChoice = async (aspiration) => {\n    try {\n      // Update player's aspiration in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { \n          aspiration: aspiration,\n          //ftuestep: 3 // Advance to next step after choosing\n        }\n      });\n      \n      if (response.data.success) {\n        setCurrentPlayer(prev => ({\n          ...prev,\n          aspiration: aspiration,\n          //ftuestep: 3\n        }));\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error setting aspiration:', error);\n    }\n    handleOK(); // Advance to next step after feedback\n  };\n\n  // Handle checkbox toggle\n  const toggleReason = (reasonIndex, isPositive) => {\n    if (isPositive) {\n      setPositiveReasons(prev => \n        prev.includes(reasonIndex) \n          ? prev.filter(r => r !== reasonIndex)\n          : [...prev, reasonIndex]\n      );\n    } else {\n      setNegativeReasons(prev => \n        prev.includes(reasonIndex) \n          ? prev.filter(r => r !== reasonIndex)\n          : [...prev, reasonIndex]\n      );\n    }\n  };\n\n  // Don't render if no step data (unless showing feedback modal)\n  if (!currentStepData && !showFeedbackModal) {\n    return null;\n  }\n\n  // Render feedback modal if showing\n  if (showFeedbackModal) {\n    return (\n      <div className=\"ftue-overlay\">\n        <div className=\"ftue-modal\">\n          <div className=\"ftue-header\">\n            <h2>{strings[780]}</h2>\n          </div>\n          \n          <div className=\"ftue-feedback-content\">\n            {/* Positive feedback section */}\n            <div className=\"ftue-feedback-section\">\n              <h3>{strings[781]}</h3>\n              <div className=\"ftue-feedback-options\">\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(784)}\n                    onChange={() => toggleReason(784, true)}\n                  />\n                  {strings[784]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(785)}\n                    onChange={() => toggleReason(785, true)}\n                  />\n                  {strings[785]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(786)}\n                    onChange={() => toggleReason(786, true)}\n                  />\n                  {strings[786]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={positiveReasons.includes(787)}\n                    onChange={() => toggleReason(787, true)}\n                  />\n                  {strings[787]}\n                </label>\n              </div>\n              <button\n                className=\"ftue-button ftue-button-primary\"\n                onClick={() => onFeedbackSubmit(true)}\n                disabled={positiveReasons.length === 0}\n              >\n                {strings[783]}\n              </button>\n            </div>\n\n            {/* Negative feedback section */}\n            <div className=\"ftue-feedback-section\">\n              <h3>{strings[782]}</h3>\n              <div className=\"ftue-feedback-options\">\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(790)}\n                    onChange={() => toggleReason(790, false)}\n                  />\n                  {strings[790]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(791)}\n                    onChange={() => toggleReason(791, false)}\n                  />\n                  {strings[791]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(792)}\n                    onChange={() => toggleReason(792, false)}\n                  />\n                  {strings[792]}\n                </label>\n                <label className=\"ftue-checkbox-label\">\n                  <input \n                    type=\"checkbox\" \n                    checked={negativeReasons.includes(793)}\n                    onChange={() => toggleReason(793, false)}\n                  />\n                  {strings[793]}\n                </label>\n              </div>\n              <button\n                className=\"ftue-button ftue-button-primary\"\n                onClick={() => onFeedbackSubmit(false)}\n                disabled={negativeReasons.length === 0}\n              >\n                {strings[794]}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n\n  // Don't render modal if showModal is false (will auto-advance via useEffect)\n  if (currentStepData?.showModal === false) {\n    return null;\n  }\n\n  // Standard render for steps with showModal: true - use StoryModal with player icon\n  return (\n    <StoryModal\n      isOpen={true}\n      onClose={handleOK}\n      symbol={currentPlayer?.icon || ''}\n      dialogKey={currentStepData.bodyKey}\n      relationshipType=\"FTUE\"\n      username={currentPlayer?.username}\n    />\n  );\n};\n\n// Re-export utility functions for backwards compatibility\nexport { incrementFTUEStep, getFTUEStep, addAcceptedQuest, completeTutorial, handleFeedbackSubmit } from './FTUEutils';\n\nexport default FTUE;","import { useState, useEffect } from 'react';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport './FTUE.css';\n\n/**\n * FTUEDoinker - A bouncing red arrow that points to a target resource on the grid\n *\n * Props:\n * - doinkerTarget: string - The resource type to point at (e.g., \"Dungeon Exit\")\n * - TILE_SIZE: number - The current tile size for positioning\n * - visible: boolean - Whether the doinker should be visible\n */\nconst FTUEDoinker = ({ doinkerTarget, TILE_SIZE, visible }) => {\n  const [targetPosition, setTargetPosition] = useState(null);\n\n  // Find the target resource position when doinkerTarget changes\n  useEffect(() => {\n    if (!doinkerTarget || !visible) {\n      setTargetPosition(null);\n      return;\n    }\n\n    const findTargetResource = () => {\n      const resources = GlobalGridStateTilesAndResources.getResources();\n\n      if (!resources || resources.length === 0) {\n        console.log('< Doinker: No resources loaded yet, waiting...');\n        return null;\n      }\n\n      // Find the resource with matching type\n      const targetResource = resources.find(res => res.type === doinkerTarget);\n\n      if (targetResource) {\n        console.log(`< Doinker: Found target \"${doinkerTarget}\" at (${targetResource.x}, ${targetResource.y})`);\n        return {\n          x: targetResource.x,\n          y: targetResource.y,\n          // Account for multi-tile resources (use center if range > 1)\n          range: targetResource.range || 1\n        };\n      } else {\n        console.log(`< Doinker: Target \"${doinkerTarget}\" not found in resources`);\n        return null;\n      }\n    };\n\n    // Initial search\n    const position = findTargetResource();\n    setTargetPosition(position);\n\n    // Set up an interval to re-check in case resources load after component mounts\n    const interval = setInterval(() => {\n      if (!targetPosition) {\n        const pos = findTargetResource();\n        if (pos) {\n          setTargetPosition(pos);\n          clearInterval(interval);\n        }\n      }\n    }, 500);\n\n    return () => clearInterval(interval);\n  }, [doinkerTarget, visible]);\n\n  // Don't render if not visible or no target found\n  if (!visible || !targetPosition) {\n    return null;\n  }\n\n  // Calculate pixel position\n  // Center the doinker on the target tile (or center of multi-tile resource)\n  const centerOffset = (targetPosition.range - 1) / 2;\n  const pixelX = (targetPosition.x + centerOffset + 0.5) * TILE_SIZE;\n  const pixelY = (targetPosition.y - centerOffset + 0.5) * TILE_SIZE;\n\n  // Arrow dimensions (responsive to tile size)\n  const arrowHeight = Math.max(30, TILE_SIZE * 0.8);\n  const arrowWidth = Math.max(20, TILE_SIZE * 0.5);\n\n  return (\n    <div\n      className=\"ftue-doinker\"\n      style={{\n        left: `${pixelX}px`,\n        top: `${pixelY - arrowHeight - 10}px`, // Position above the target with small gap\n        width: `${arrowWidth}px`,\n        height: `${arrowHeight}px`,\n      }}\n    >\n      {/* SVG Arrow pointing down */}\n      <svg\n        width={arrowWidth}\n        height={arrowHeight}\n        viewBox=\"0 0 40 60\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        className=\"ftue-doinker-arrow\"\n      >\n        {/* Arrow body */}\n        <path\n          d=\"M15 0 L15 35 L5 35 L20 60 L35 35 L25 35 L25 0 Z\"\n          fill=\"#e53935\"\n          stroke=\"#b71c1c\"\n          strokeWidth=\"2\"\n        />\n        {/* Highlight */}\n        <path\n          d=\"M17 2 L17 33 L20 33 L20 2 Z\"\n          fill=\"#ff6f60\"\n          opacity=\"0.6\"\n        />\n      </svg>\n    </div>\n  );\n};\n\nexport default FTUEDoinker;\n","import React, { createContext, useContext, useState } from 'react';\n\nconst GridStatePCContext = createContext();\nconst GridStatePCUpdateContext = createContext();\n\nexport const usePlayersInGrid = () => useContext(GridStatePCContext);\nexport const useGridStatePCUpdate = () => useContext(GridStatePCUpdateContext);\n\nexport function GridStatePCProvider({ children }) {\n  const [playersInGrid, setPlayersInGrid] = useState({});\n\n  return (\n    <GridStatePCContext.Provider value={playersInGrid}>\n      <GridStatePCUpdateContext.Provider value={setPlayersInGrid}>\n        {children}\n      </GridStatePCUpdateContext.Provider>\n    </GridStatePCContext.Provider>\n  );\n}\n","import React, { createContext, useContext, useState } from 'react';\n\nconst GridStateContext = createContext();\nconst GridStateUpdateContext = createContext();\n\nexport const useGridState = () => useContext(GridStateContext);\nexport const useGridStateUpdate = () => useContext(GridStateUpdateContext);\n\nlet externalSetGridState = null;\nexport const setGridStateExternally = (state) => {\n  if (externalSetGridState) {\n    externalSetGridState(state);\n  }\n};\n\nexport function GridStateProvider({ children }) {\n  const [NPCsInGrid, setGridState] = useState({}); // instead of null  externalSetGridState = setGridState;\n\n  return (\n    <GridStateContext.Provider value={NPCsInGrid}>\n      <GridStateUpdateContext.Provider value={setGridState}>\n        {children}\n      </GridStateUpdateContext.Provider>\n    </GridStateContext.Provider>\n  );\n}","import socket from '../socketManager';\nimport NPCsInGridManager from './GridStateNPCs';\n\nclass NPCController {\n  constructor() {\n    this.controlledGrids = new Map();\n    this.setupSocketListeners();\n    this.retryTimeout = null;\n  }\n\n  setupSocketListeners() {\n    socket.on('npc-controller-assigned', ({ gridId }) => {\n      console.log(` Assigned as NPC controller for grid ${gridId}`);\n      this.setAsController(gridId);\n    });\n\n    socket.on('npc-controller-revoked', ({ gridId }) => {\n      console.log(` Revoked as NPC controller for grid ${gridId}`);\n      this.removeController(gridId);\n    });\n\n    // Add new listener for controller updates\n    socket.on('npc-controller-update', ({ controllerUsername, gridId }) => {\n      console.log(` Controller update received for ${gridId}: ${controllerUsername}`);\n      const currentPlayer = JSON.parse(localStorage.getItem('player'));\n      if (controllerUsername && currentPlayer?.username === controllerUsername) {\n        this.setAsController(gridId);\n      } else {\n        this.removeController(gridId);\n      }\n    });\n \n    // Add connection status listeners\n    socket.on('connect', () => {\n      console.log(' NPCController socket connected');\n    });\n\n    socket.on('disconnect', () => {\n      console.log(' NPCController socket disconnected');\n    });\n\n    // Add response listener\n    socket.on('join-grid-controller-response', ({ success, gridId }) => {\n      console.log(` Received controller join response: success=${success}, gridId=${gridId}`);\n    });\n  }\n\n  joinGrid(gridId) {\n    if (!socket.connected) {\n      console.log(' Socket not ready, retrying controller join in 1s...');\n      clearTimeout(this.retryTimeout);\n      this.retryTimeout = setTimeout(() => this.joinGrid(gridId), 1000);\n      return;\n    }\n\n    console.log(` Requesting controller status for grid ${gridId}`);\n    socket.emit('join-grid-controller', { \n      gridId,\n      timestamp: Date.now() // Add timestamp for debugging\n    });\n  }\n\n  leaveGrid(gridId) {\n    console.log(` Leaving grid ${gridId}`);\n    socket.emit('leave-grid-controller', { gridId });\n    this.removeController(gridId);\n  }\n\n  setAsController(gridId) {\n    console.log(` Setting controller status for grid ${gridId}`);\n    // Add explicit true value and verify it's set\n    this.controlledGrids.set(gridId, { isController: true });\n    console.log(` Controller Map after set:`, \n      Array.from(this.controlledGrids.entries())\n    );\n\n    // Force an immediate NPC update\n    const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (NPCsInGrid?.npcs) {\n      Object.values(NPCsInGrid.npcs).forEach(npc => {\n        if (typeof npc.update === 'function') {\n          npc.update(Date.now(), NPCsInGrid);\n        }\n      });\n    }\n  }\n\n  removeController(gridId) {\n    this.controlledGrids.delete(gridId);\n    console.log(` Removed controller for grid ${gridId}`);\n    console.log(` Controller Map after remove:`, \n      Array.from(this.controlledGrids.entries())\n    );\n  }\n\n  isControllingGrid(gridId) {\n    const controllerData = this.controlledGrids.get(gridId);\n    const isController = controllerData?.isController === true;\n    // console.log(` Controller check for ${gridId}:`, {\n    //   hasData: !!controllerData,\n    //   isController: isController,\n    //   rawValue: controllerData?.isController\n    // });\n    return isController;\n  }\n}\n\nexport const npcController = new NPCController();\nexport default npcController;\n","import React, { createContext, useState, useContext } from 'react';\nimport { useStrings } from '../StringsContext';\nimport './StatusBar.css';\n\n// Create Context\nexport const StatusBarContext = createContext();\n\n// Provider Component\nexport const StatusBarProvider = ({ children }) => {\n  const strings = useStrings(); // Get strings from context\n  const [messages, setMessages] = useState([]); // Array of message objects with id and text\n  const messageIdRef = React.useRef(0); // Counter for unique message IDs\n\n  /**\n   * Updates the status bar message.\n   * @param {number|string} input - Index for predefined message or custom string.\n   */\n  const updateStatus = (input) => {\n    let newMessage = '';\n    \n    if (typeof input === 'number') {\n      // Use predefined string from strings.json\n      const predefinedMessage = strings[input];\n      if (predefinedMessage) {\n        newMessage = predefinedMessage;\n      } else {\n        console.warn(`No string found for index ${input}. Falling back to default.`);\n        return;\n      }\n    } else if (typeof input === 'string') {\n      // Use custom string directly\n      newMessage = input;\n    } else {\n      console.warn('Invalid status message input. Falling back to default.');\n      return;\n    }\n\n    // Create a new message object with unique ID\n    const messageObject = {\n      id: messageIdRef.current++,\n      text: newMessage\n    };\n\n    // Add new message to the beginning (no max limit for infinite scrolling)\n    setMessages(prev => [messageObject, ...prev]);\n  };\n\n  return (\n    <StatusBarContext.Provider value={{ messages, updateStatus }}>\n      {children}\n    </StatusBarContext.Provider>\n  );\n};\n\n// StatusBar Component\nconst StatusBar = () => {\n  const { messages } = React.useContext(StatusBarContext);\n  const [displayMessages, setDisplayMessages] = React.useState([]);\n  const [slideOffset, setSlideOffset] = React.useState(0);\n  const [scrollPosition, setScrollPosition] = React.useState(0);\n  const [canScrollRight, setCanScrollRight] = React.useState(false);\n  const prevFirstId = React.useRef(null);\n  const newMessageRef = React.useRef(null);\n  const messagesContainerRef = React.useRef(null);\n  const viewportRef = React.useRef(null);\n\n  React.useEffect(() => {\n    if (messages.length === 0) {\n      setDisplayMessages([]);\n      setSlideOffset(0);\n      setScrollPosition(0);\n      return;\n    }\n\n    const currentFirstId = messages[0]?.id;\n    \n    // First render or new message\n    if (prevFirstId.current === null) {\n      // Initial load - also animate the first message\n      setScrollPosition(0); // Reset scroll position\n      const width = newMessageRef.current?.offsetWidth || 200;\n      setSlideOffset(-width);\n      setDisplayMessages(messages);\n\n      // Use double requestAnimationFrame to ensure browser paints the offset position\n      // before we trigger the animation back to 0. Single rAF can be batched.\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          setSlideOffset(0);\n        });\n      });\n    } else if (currentFirstId !== prevFirstId.current) {\n      // New message added - reset scroll position first\n      setScrollPosition(0); // Reset to left before showing new message\n\n      // Then measure and animate the new message\n      const width = newMessageRef.current?.offsetWidth || 200;\n\n      // Start with new message off-screen\n      setSlideOffset(-width);\n      setDisplayMessages(messages);\n\n      // Use double requestAnimationFrame to ensure browser paints the offset position\n      // before we trigger the animation back to 0. Single rAF can be batched.\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          setSlideOffset(0);\n        });\n      });\n    } else {\n      // No change\n      setDisplayMessages(messages);\n    }\n    \n    prevFirstId.current = currentFirstId;\n  }, [messages]);\n\n  // Check if we can scroll right\n  React.useEffect(() => {\n    if (messagesContainerRef.current && viewportRef.current) {\n      const containerWidth = messagesContainerRef.current.scrollWidth;\n      const viewportWidth = viewportRef.current.offsetWidth;\n      const maxScroll = containerWidth - viewportWidth;\n      \n      // Can scroll right if we haven't reached the max scroll position\n      setCanScrollRight(scrollPosition < maxScroll && containerWidth > viewportWidth);\n    }\n  }, [scrollPosition, displayMessages]);\n\n  // Handle scrolling\n  const handleScrollRight = () => {\n    if (messagesContainerRef.current && viewportRef.current) {\n      const containerWidth = messagesContainerRef.current.scrollWidth;\n      const viewportWidth = viewportRef.current.offsetWidth;\n      const maxScroll = containerWidth - viewportWidth;\n      \n      // Scroll right by viewport width or to the end\n      const newPosition = Math.min(scrollPosition + viewportWidth, maxScroll);\n      setScrollPosition(newPosition);\n    }\n  };\n\n  const handleScrollLeft = () => {\n    // Scroll left by viewport width or to the beginning\n    const viewportWidth = viewportRef.current?.offsetWidth || window.innerWidth;\n    const newPosition = Math.max(scrollPosition - viewportWidth, 0);\n    setScrollPosition(newPosition);\n  };\n\n  return (\n    <div className=\"status-bar\">\n      {/* Left scroll arrow - only show when scrolled */}\n      {scrollPosition > 0 && (\n        <button\n          className=\"status-bar-arrow status-bar-arrow-left\"\n          onClick={handleScrollLeft}\n          aria-label=\"Scroll left\"\n        >\n          \n        </button>\n      )}\n      \n      <div className=\"status-bar-viewport\" ref={viewportRef}>\n        {/* Hidden measuring container */}\n        {messages.length > 0 && messages[0].id !== prevFirstId.current && (\n          <div style={{ position: 'absolute', visibility: 'hidden', whiteSpace: 'nowrap' }}>\n            <span ref={newMessageRef} className=\"status-message\">\n              {messages[0].text}\n            </span>\n            <span className=\"status-separator\">&nbsp;&nbsp;&nbsp;&nbsp;</span>\n          </div>\n        )}\n        \n        {/* Actual messages container */}\n        <div \n          ref={messagesContainerRef}\n          className=\"status-bar-messages\"\n          style={{\n            transform: `translateX(${slideOffset - scrollPosition}px)`,\n            transition: slideOffset === 0 && scrollPosition === 0 ? 'transform 0.5s ease-out' : \n                       scrollPosition !== 0 ? 'transform 0.3s ease-out' : 'none'\n          }}\n        >\n          {displayMessages.map((msg, index) => (\n            <React.Fragment key={msg.id}>\n              <span className=\"status-message\">\n                {msg.text}\n              </span>\n              {index < displayMessages.length - 1 && (\n                <span className=\"status-separator\">&nbsp;&nbsp;&nbsp;&nbsp;</span>\n              )}\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n      \n      {/* Right scroll arrow - only show when can scroll right */}\n      {canScrollRight && (\n        <button\n          className=\"status-bar-arrow status-bar-arrow-right\"\n          onClick={handleScrollRight}\n          aria-label=\"Scroll right\"\n        >\n          \n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default StatusBar;","import React, { createContext, useContext, useState } from 'react';\n\nconst BulkOperationContext = createContext();\n\nexport const BulkOperationProvider = ({ children }) => {\n  // Track active bulk operations by type\n  const [activeBulkOperations, setActiveBulkOperations] = useState({});\n  \n  const startBulkOperation = (operationType, operationId) => {\n    setActiveBulkOperations(prev => ({\n      ...prev,\n      [operationId]: {\n        type: operationType,\n        startTime: Date.now(),\n        active: true\n      }\n    }));\n  };\n  \n  const endBulkOperation = (operationId) => {\n    setActiveBulkOperations(prev => {\n      const newState = { ...prev };\n      delete newState[operationId];\n      return newState;\n    });\n  };\n  \n  const isAnyBulkOperationActive = () => {\n    return Object.keys(activeBulkOperations).length > 0;\n  };\n  \n  const getActiveBulkOperations = () => {\n    return Object.entries(activeBulkOperations).map(([id, operation]) => ({\n      id,\n      ...operation\n    }));\n  };\n  \n  return (\n    <BulkOperationContext.Provider value={{ \n      activeBulkOperations,\n      startBulkOperation,\n      endBulkOperation,\n      isAnyBulkOperationActive,\n      getActiveBulkOperations\n    }}>\n      {children}\n    </BulkOperationContext.Provider>\n  );\n};\n\nexport const useBulkOperation = () => {\n  const context = useContext(BulkOperationContext);\n  if (!context) {\n    throw new Error('useBulkOperation must be used within a BulkOperationProvider');\n  }\n  return context;\n};","import React from 'react';\nimport './ZoomedOut.css';\n\n// Helper function for grid tile colors\nexport const getGridBackgroundColor = (type) => {\n  switch (type) {\n    // Settlement grid types\n    case \"homestead\":\n    case \"homesteadSet\":\n      case \"homesteadSetN\":\n        case \"homesteadSetNE\":\n          case \"homesteadSetE\":\n            case \"homesteadSetSE\":\n              case \"homesteadSetS\":\n                case \"homesteadSetSW\":\n                  case \"homesteadSetW\":\n                    case \"homesteadSetNW\":\n      return 'var(--homestead-color)';\n    \n    // Valley types (both views)\n    case \"valley0\":\n    case \"valley1\":\n    case \"valley2\":\n    case \"valley3\":\n    case \"valley0Set\":  \n    case \"valley1Set\":\n    case \"valley2Set\":\n    case \"valley3Set\":\n      return 'var(--valley-color)';\n    \n    // Settlement-specific types\n    case \"reserved\":\n      return 'var(--reserved-color)';\n    case \"town\":\n      return 'var(--town-color)';\n    \n    default:\n      return 'var(--unknown-color)';\n  }\n};\n\nconst ZoomOut = ({ children }) => {\n  return (\n    <div className=\"zoom-out-container\">\n      {children}\n    </div>\n  );\n};\n\nexport default ZoomOut;\n","import React, { useRef, useEffect, memo } from 'react';\nimport { tileColors, BITS_TO_TILE_TYPE } from '../UI/Styles/tileColors';\n\n// Use centralized tile colors with fallback for unknown\nconst TILE_COLORS = { ...tileColors, unknown: '#808080' };\n\nconst BITS_PER_TILE = 4;\nconst GRID_SIZE = 64;\nconst TOTAL_TILES = GRID_SIZE * GRID_SIZE; // 4096 tiles\n\n/**\n * Decode Base64 encoded tiles to 2D array\n * @param {string} encodedTiles - Base64 encoded compressed tile data\n * @returns {Array<Array<string>>} - 64x64 2D array of tile types\n */\nfunction decodeTiles(encodedTiles) {\n  if (typeof encodedTiles !== 'string' || encodedTiles.length === 0) {\n    return null;\n  }\n\n  try {\n    // Decode from Base64\n    const binaryString = atob(encodedTiles);\n    const packedBytes = [];\n    for (let i = 0; i < binaryString.length; i++) {\n      packedBytes.push(binaryString.charCodeAt(i));\n    }\n\n    // Unpack bits to get tile types\n    const flatTiles = [];\n    let bitBuffer = 0;\n    let bitsInBuffer = 0;\n\n    for (const byte of packedBytes) {\n      // Add byte to bit buffer\n      bitBuffer = (bitBuffer << 8) | byte;\n      bitsInBuffer += 8;\n\n      // Extract 4-bit tile values while we have enough bits\n      while (bitsInBuffer >= BITS_PER_TILE && flatTiles.length < TOTAL_TILES) {\n        const tileBits = (bitBuffer >> (bitsInBuffer - BITS_PER_TILE)) & 0b1111;\n        const tileType = BITS_TO_TILE_TYPE[tileBits] || 'unknown';\n        flatTiles.push(tileType);\n        bitsInBuffer -= BITS_PER_TILE;\n        bitBuffer = bitBuffer & ((1 << bitsInBuffer) - 1);\n      }\n    }\n\n    // Pad with grass if not enough tiles\n    while (flatTiles.length < TOTAL_TILES) {\n      flatTiles.push('g');\n    }\n\n    // Convert flat array back to 2D\n    const tiles = [];\n    for (let y = 0; y < GRID_SIZE; y++) {\n      const row = [];\n      for (let x = 0; x < GRID_SIZE; x++) {\n        const index = y * GRID_SIZE + x;\n        row.push(flatTiles[index]);\n      }\n      tiles.push(row);\n    }\n\n    return tiles;\n  } catch (error) {\n    console.error('Error decoding tiles:', error);\n    return null;\n  }\n}\n\n/**\n * RenderVisitedGrid - Renders a 64x64 tile grid as a small canvas\n * Used in SettlementView to show visited grids\n */\nconst RenderVisitedGrid = memo(({\n  encodedTiles,\n  size = 64, // Canvas size in pixels (default 64x64)\n  className = '',\n  style = {}\n}) => {\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !encodedTiles) return;\n\n    const tiles = decodeTiles(encodedTiles);\n    if (!tiles) return;\n\n    const ctx = canvas.getContext('2d');\n    const pixelSize = size / GRID_SIZE; // Size of each tile pixel\n\n    // Clear canvas\n    ctx.clearRect(0, 0, size, size);\n\n    // If pixel size is less than 1, we need to scale\n    if (pixelSize < 1) {\n      // Create an offscreen canvas at 64x64\n      const offscreen = document.createElement('canvas');\n      offscreen.width = GRID_SIZE;\n      offscreen.height = GRID_SIZE;\n      const offCtx = offscreen.getContext('2d');\n\n      // Render each tile as a single pixel\n      for (let y = 0; y < GRID_SIZE; y++) {\n        for (let x = 0; x < GRID_SIZE; x++) {\n          const tileType = tiles[y][x];\n          offCtx.fillStyle = TILE_COLORS[tileType] || TILE_COLORS.unknown;\n          offCtx.fillRect(x, y, 1, 1);\n        }\n      }\n\n      // Scale down to target size\n      ctx.imageSmoothingEnabled = true;\n      ctx.drawImage(offscreen, 0, 0, size, size);\n    } else {\n      // Direct rendering at target size\n      for (let y = 0; y < GRID_SIZE; y++) {\n        for (let x = 0; x < GRID_SIZE; x++) {\n          const tileType = tiles[y][x];\n          ctx.fillStyle = TILE_COLORS[tileType] || TILE_COLORS.unknown;\n          ctx.fillRect(x * pixelSize, y * pixelSize, pixelSize, pixelSize);\n        }\n      }\n    }\n  }, [encodedTiles, size]);\n\n  // If no encoded tiles, show placeholder\n  if (!encodedTiles) {\n    return (\n      <canvas\n        ref={canvasRef}\n        width={size}\n        height={size}\n        className={className}\n        style={{\n          backgroundColor: TILE_COLORS.g,\n          ...style\n        }}\n      />\n    );\n  }\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={size}\n      height={size}\n      className={className}\n      style={{\n        imageRendering: 'pixelated',\n        ...style\n      }}\n    />\n  );\n});\n\nRenderVisitedGrid.displayName = 'RenderVisitedGrid';\n\nexport default RenderVisitedGrid;\n","import API_BASE from \"../config\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport \"./SettlementView.css\";\nimport { StatusBarContext } from \"../UI/StatusBar/StatusBar\";\nimport { changePlayerLocation } from \"../Utils/GridManagement\";\nimport { fetchTownSignpostPosition, fetchHomesteadSignpostPosition } from \"../Utils/worldHelpers\";\nimport settlementTileData from './SettlementTile.json';\nimport { useBulkOperation } from \"../UI/BulkOperationContext\";\nimport { getGridBackgroundColor } from './ZoomedOut';\nimport { centerCameraOnPlayer } from \"../PlayerMovement\";\nimport playersInGridManager from \"../GridState/PlayersInGrid\";\nimport { fetchHomesteadOwner } from \"../Utils/worldHelpers\";\nimport { updateGridStatus } from \"../Utils/GridManagement\";\nimport { processRelocation } from \"../Utils/Relocation\";\nimport { getVisitedGridCoords, isGridVisited } from \"../Utils/gridsVisitedUtils\";\nimport RenderVisitedGrid from \"./RenderVisitedGrid\";\n\n// Center camera on player's current grid in settlement view\nexport function centerCameraOnPlayerGrid(currentPlayer, settlementGrid) {\n  if (!currentPlayer?.location?.g || !settlementGrid || settlementGrid.length === 0) {\n    console.warn(\"Cannot center camera: missing player location or settlement grid\");\n    return;\n  }\n\n  const playerGridId = currentPlayer.location.g;\n  \n  // Find the player's grid position in the settlement\n  let playerRow = -1;\n  let playerCol = -1;\n  \n  for (let row = 0; row < settlementGrid.length; row++) {\n    for (let col = 0; col < settlementGrid[row].length; col++) {\n      if (settlementGrid[row][col]?.gridId === playerGridId) {\n        playerRow = row;\n        playerCol = col;\n        break;\n      }\n    }\n    if (playerRow !== -1) break;\n  }\n  \n  if (playerRow === -1 || playerCol === -1) {\n    console.warn(`Player's grid ${playerGridId} not found in settlement`);\n    return;\n  }\n\n  // Wait for next frame to ensure layout is complete\n  requestAnimationFrame(() => {\n    // Find the specific tile element instead of calculating position\n    const allTiles = document.querySelectorAll(\".settlement-tile\");\n    const tileIndex = playerRow * 8 + playerCol; // 8 columns per row\n    const playerTile = allTiles[tileIndex];\n    \n    if (!playerTile) {\n      console.warn(\"Player tile element not found\");\n      return;\n    }\n\n    // Scroll the tile into view with centering\n    playerTile.scrollIntoView({\n      behavior: \"smooth\",\n      block: \"center\",\n      inline: \"center\"\n    });\n    \n    // Fallback: If scrollIntoView doesn't work well, try manual scroll after a delay\n    setTimeout(() => {\n      const updatedRect = playerTile.getBoundingClientRect();\n      const isVisible = (\n        updatedRect.top >= 0 &&\n        updatedRect.left >= 0 &&\n        updatedRect.bottom <= window.innerHeight &&\n        updatedRect.right <= window.innerWidth\n      );\n      \n      if (!isVisible) {\n        // Calculate center manually using body scroll\n        const tileCenterX = updatedRect.left + (updatedRect.width / 2);\n        const tileCenterY = updatedRect.top + (updatedRect.height / 2);\n        const windowCenterX = window.innerWidth / 2;\n        const windowCenterY = window.innerHeight / 2;\n        \n        const scrollX = window.scrollX + (tileCenterX - windowCenterX);\n        const scrollY = window.scrollY + (tileCenterY - windowCenterY);\n        \n        window.scrollTo({\n          left: Math.max(0, scrollX),\n          top: Math.max(0, scrollY),\n          behavior: \"smooth\"\n        });\n      }\n    }, 500);\n  });\n}\n\nconst SettlementView = ({ \n  currentPlayer, \n  isDeveloper,\n  setZoomLevel, \n  isRelocating,\n  setIsRelocating,\n  setCurrentPlayer,            \n  setGridId,        \n  setGrid,      \n  setResources, \n  setTileTypes,  \n  TILE_SIZE,\n  masterResources,\n  closeAllPanels,\n  visibleSettlementId,\n  setVisibleSettlementId,\n}) => {\n\n  const [settlementGrid, setSettlementGrid] = useState([]);\n  const [players, setPlayers] = useState(new Map());  // Map player IDs to player data\n  const [error, setError] = useState(null);\n  const [NPCsInGrids, setGridStates] = useState({});  // Add new state for grid states\n  const [playersInGridMap, setPlayersInGrid] = useState({});\n  const [visitedGridTiles, setVisitedGridTiles] = useState({}); // Map gridCoord -> encoded tiles\n  const [tooltipData, setTooltipData] = useState({ visible: false, content: '', x: 0, y: 0 });\n  const { updateStatus } = useContext(StatusBarContext);\n  const bulkOperationContext = useBulkOperation();\n\n  // Added diagnostic log for player-to-ownerId matching\n  if (players) {\n    const ownerIdsInGrid = settlementGrid.flat().map(tile => tile.ownerId).filter(Boolean);\n    const unmatchedOwnerIds = ownerIdsInGrid.filter(id => !players.get(id));\n  }\n\n  // Fetch both settlement grid and player data\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        console.log(\" Fetching settlement bundle for ID:\", visibleSettlementId);\n        const response = await axios.post(`${API_BASE}/api/get-settlement-bundle`, { settlementId: visibleSettlementId });\n        console.log(\" Settlement bundle response:\", response.data);\n        const { gridStates, players: playersArray, settlement } = response.data;\n\n        // Transform playersArray (array) to playersById (object)\n        const playersById = {};\n        if (Array.isArray(playersArray)) {\n          for (const player of playersArray) {\n            playersById[player._id] = player;\n          }\n        }\n\n        setGridStates(gridStates || {});\n        setPlayers(new Map(Object.entries(playersById || {})));\n        setSettlementGrid(settlement?.grids || []);\n        console.log(\" Settlement grid set:\", settlement?.grids);\n\n        //  Fetch playersInGrid for all grids in this settlement\n        const gridIds = (settlement?.grids || []).flat().map(tile => tile.gridId).filter(Boolean);\n        const gridStateResponse = await axios.post(`${API_BASE}/api/get-multiple-grid-states`, { gridIds });\n        const mergedPlayersInGrid = {};\n\n        for (const gridId in gridStateResponse.data) {\n          const pcs = gridStateResponse.data[gridId]?.playersInGrid?.pcs || {};\n          mergedPlayersInGrid[gridId] = pcs;\n        }\n\n        setPlayersInGrid(mergedPlayersInGrid);\n\n      } catch (err) {\n        console.error(\"Error fetching settlement bundle:\", err);\n        setError(\"Failed to fetch settlement data\");\n      }\n    };\n\n    fetchData();\n  }, [visibleSettlementId]);\n\n  useEffect(() => {\n    if (isRelocating) {\n      updateStatus(125);\n    }\n  }, [isRelocating]);\n\n  // Fetch tiles for visited grids\n  useEffect(() => {\n    const fetchVisitedGridTiles = async () => {\n      if (!settlementGrid.length || !currentPlayer?.gridsVisited || !visibleSettlementId) return;\n\n      // Get all visited coords in SSGG format (from bit buffer)\n      const visitedSSGG = getVisitedGridCoords(currentPlayer.gridsVisited);\n\n      // Get settlement tiles with their full gridCoords\n      const settlementTiles = settlementGrid.flat()\n        .filter(tile => tile.gridCoord !== undefined && tile.gridId);\n\n      // Find intersection - compare SSGG parts (last 4 digits) of full gridCoords\n      // with the SSGG values from the visited buffer\n      const coordsToFetch = settlementTiles\n        .filter(tile => visitedSSGG.includes(tile.gridCoord % 10000))\n        .map(tile => tile.gridCoord);\n\n      if (coordsToFetch.length === 0) return;\n\n      try {\n        const response = await axios.post(`${API_BASE}/api/grids-tiles`, {\n          settlementId: visibleSettlementId,\n          gridCoords: coordsToFetch\n        });\n\n        if (response.data.success && response.data.tilesMap) {\n          setVisitedGridTiles(response.data.tilesMap);\n          console.log(` Fetched tiles for ${Object.keys(response.data.tilesMap).length} visited grids`);\n        }\n      } catch (err) {\n        console.error('Error fetching visited grid tiles:', err);\n      }\n    };\n\n    fetchVisitedGridTiles();\n  }, [settlementGrid, currentPlayer?.gridsVisited, visibleSettlementId]);\n\n  // Center camera on player's grid when settlement view loads\n  useEffect(() => {\n    if (settlementGrid.length > 0 && currentPlayer?.location?.g) {\n      // Delay to ensure DOM is ready and rendered\n      setTimeout(() => {\n        centerCameraOnPlayerGrid(currentPlayer, settlementGrid);\n      }, 300);\n    }\n  }, [settlementGrid, currentPlayer?.location?.g]);\n\n\n  const handleTileClick = async (tile, TILE_SIZE) => {\n    console.log(\"Clicked tile:\", tile);\n\n    if (tile.settlementId && tile.settlementId !== visibleSettlementId) {\n      console.log(\"Switching visible settlement to:\", tile.settlementId);\n      setVisibleSettlementId(tile.settlementId);\n      return;\n    }\n  \n    // Are we in RELOCATIONN mode?\n    if (isRelocating) {\n      if (tile.gridType !== 'homestead') {\n        updateStatus(123); return;\n      }\n      if (tile.available != true) {\n        updateStatus(124); return; \n      }\n      if (tile.available === true) {\n        // CONFIRMATION MOADAL\n        processRelocation(currentPlayer, setCurrentPlayer, currentPlayer.gridId, tile.gridCoord, settlementGrid);\n        setIsRelocating(false);\n        setZoomLevel('close');\n        updateStatus(121);\n      }\n      return;\n    }\n\n    // Clicking on the tile where the player already is - zoom in (works for everyone)\n    if (tile.gridId === currentPlayer.location.g) {\n      setZoomLevel(\"far\");\n      if ([\"valley0\", \"valley1\", \"valley2\", \"valley3\"].includes(tile.gridType)) {\n        updateStatus(16);\n      } else if (tile.gridType === \"town\") {\n        updateStatus(111);\n      } else {\n        const { username, gridType } = await fetchHomesteadOwner(currentPlayer.location.g);\n        await updateGridStatus(gridType, username, updateStatus, currentPlayer, currentPlayer.location.g);\n      }\n      let pcs = null;\n      let pc = null;\n      pcs = playersInGridManager.getPlayersInGrid(tile.gridId);\n      pc = pcs?.[currentPlayer.playerId];\n      centerCameraOnPlayer(pc.position, TILE_SIZE);\n      return;\n    }\n\n    // TEMPORARY: Non-developers cannot travel via SettlementView (investigating multi-grid bug)\n    // Silently ignore clicks - no message, no action\n    if (!isDeveloper) {\n      console.log(\" SettlementView travel disabled for non-developers\");\n      return;\n    }\n\n    // Developers can travel anywhere - skip Horse skill check\n\n    try {\n      // Default position\n      let arrivalX = 0;\n      let arrivalY = 0;\n      \n      // If clicking on a town tile, find the Train location\n      if (tile.gridType === \"town\") {\n        console.log(\" Clicking on town grid, fetching Train location...\");\n        const signpostPosition = await fetchTownSignpostPosition(tile.gridId);\n        arrivalX = signpostPosition.x;\n        arrivalY = signpostPosition.y;\n      }\n      // If clicking on a homestead tile, find the Signpost Town location\n      else if (tile.gridType === \"homestead\") {\n        console.log(\" Clicking on homestead grid, fetching Signpost Town location...\");\n        const signpostPosition = await fetchHomesteadSignpostPosition(tile.gridId);\n        arrivalX = signpostPosition.x;\n        arrivalY = signpostPosition.y;\n      }\n      \n      const toLocation = {\n        x: arrivalX,  \n        y: arrivalY,\n        g: tile.gridId,\n        s: currentPlayer.location.s,\n        f: currentPlayer.location.f,\n        gtype: tile.gridType || \"unknown\", \n        gridCoord: tile.gridCoord || 0,\n      };\n  \n      console.log(\"Built toLocation object:\", toLocation);\n      console.log(\"About to call changePlayerLocation from SettlementView;  current player = \",currentPlayer, \"toLocatoin = \", toLocation);\n     \n      // Call changePlayerLocation using the properly built toLocation\n      await changePlayerLocation(\n        currentPlayer,\n        currentPlayer.location,\n        toLocation,  \n        setCurrentPlayer,\n        setGridId,                //  Ensure this is passed\n        setGrid,                  //  Pass setGrid function\n        setTileTypes,             //  Pass setTileTypes function\n        setResources,             //  Pass setResources function\n        TILE_SIZE,\n        closeAllPanels,\n        updateStatus,\n        bulkOperationContext,\n        masterResources,\n        null, // strings not available in SettlementView\n        null  // masterTrophies not available in SettlementView\n      );\n      // Stay zoomed out for developer grid navigation\n      // setZoomLevel(\"far\"); \n\n    } catch (error) {\n      console.error(\"Error changing player location:\", error);\n      updateStatus(10); // General error\n    }\n  };\n\nconst getTooltip = (tile) => {\n    if (!tile.gridId) return '';\n    const pcs = playersInGridMap[tile.gridId];\n    if (!pcs || Object.keys(pcs).length === 0) return '';\n    return Object.values(pcs)\n      .map(pc => `${pc.username || 'Unknown'}: ${pc.hp || 0} HP`)\n      .join('\\n');\n  };\n\n  // Handle mouse movement over settlement tiles for cursor-following tooltip\n  const handleTileMouseMove = (e, tile) => {\n    const content = getTooltip(tile);\n    if (content) {\n      setTooltipData({\n        visible: true,\n        content,\n        x: e.clientX,\n        y: e.clientY\n      });\n    }\n  };\n\n  const handleTileMouseLeave = () => {\n    setTooltipData(prev => ({ ...prev, visible: false }));\n  };\n\n  const renderMiniGrid = (tile) => {\n    let gridType = tile.gridType;\n    if (gridType === \"homestead\") {\n      gridType = tile.available ? \"homesteadEmpty\" : \"homesteadOccupied\";\n    }\n\n    const tileData = settlementTileData[gridType] || Array(8).fill(Array(8).fill(\"\"));\n    const isPlayerHere = tile.gridId === currentPlayer.location.g;\n\n    let owner = null;\n    if (tile.ownerId && players) {\n      const ownerIdStr = typeof tile.ownerId === 'object' ? tile.ownerId._id : tile.ownerId;\n      owner = players.get(ownerIdStr);\n    }\n\n    if (tile.ownerId && !owner) {\n    }\n\n    let miniX = 0;\n    let miniY = 0;\n    const isValleyGrid = [\"valley0\", \"valley1\", \"valley2\", \"valley3\"].includes(gridType);\n    const isTownGrid = gridType === \"town\";\n    const usePixelRendering = isValleyGrid || isTownGrid; // Valley and Town use pixel rendering, Homestead does not\n    let playerPCs = null;\n    let playerPC = null;\n\n    if (isPlayerHere && isValleyGrid && tile.gridId) {\n      playerPCs = playersInGridManager.getPlayersInGrid(tile.gridId);\n      playerPC = playerPCs?.[currentPlayer.playerId];\n      if (playerPC?.position) {\n        miniX = Math.floor(playerPC.position.x / 8);\n        miniY = Math.floor(playerPC.position.y / 8);\n      }\n    }\n\n    // Check if this is a visited valley/town grid - render actual tiles instead of tree pattern\n    // Homestead grids keep their current emoji-based rendering\n    const hasVisitedTiles = tile.gridCoord !== undefined && visitedGridTiles[tile.gridCoord];\n    const isMarkedVisited = tile.gridCoord !== undefined && isGridVisited(currentPlayer.gridsVisited, tile.gridCoord);\n\n    if (usePixelRendering && hasVisitedTiles) {\n      // Render pixel tiles, with player icon overlay at correct miniX,miniY position if player is here\n      return (\n        <div className=\"mini-cell\" style={{ position: 'relative', width: '100%', height: '100%' }}>\n          <RenderVisitedGrid\n            encodedTiles={visitedGridTiles[tile.gridCoord]}\n            size={64}\n            className=\"visited-grid-canvas\"\n            style={{ width: '100%', height: '100%', display: 'block' }}\n          />\n          {isPlayerHere && (\n            <div style={{\n              position: 'absolute',\n              top: `${(miniY / 8) * 100}%`,\n              left: `${(miniX / 8) * 100}%`,\n              width: '12.5%',\n              height: '12.5%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '0.9em',\n              zIndex: 1\n            }}>\n              {currentPlayer.icon}\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    // Fallback: Grid is marked as visited but tile data not available (grid may not exist yet)\n    // Show a simple green background instead of tree pattern to indicate visited status\n    if (usePixelRendering && isMarkedVisited && !hasVisitedTiles) {\n      return (\n        <div className=\"mini-cell\" style={{\n          position: 'relative',\n          width: '100%',\n          height: '100%',\n          backgroundColor: 'var(--valley-visited-color)'\n        }}>\n          {isPlayerHere && (\n            <div style={{\n              position: 'absolute',\n              top: `${(miniY / 8) * 100}%`,\n              left: `${(miniX / 8) * 100}%`,\n              width: '12.5%',\n              height: '12.5%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '0.6em',\n              zIndex: 1\n            }}>\n              {currentPlayer.icon}\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"mini-grid\">\n        {tileData.map((row, rowIndex) =>\n          row.map((cell, colIndex) => {\n            let content = cell;\n  \n            if (isPlayerHere && isValleyGrid && rowIndex === miniY && colIndex === miniX) {\n              content = currentPlayer.icon;\n            }\n  \n            //  For homestead or other grid types, show icon at default corner\n            else if (isPlayerHere && !isValleyGrid && rowIndex === 0 && colIndex === 0) {\n              content = currentPlayer.icon;\n            }\n  \n            //  Homestead trade stall rendering\n            if (gridType === \"homesteadOccupied\") {\n              if (rowIndex === 7 && colIndex < 6) {\n                if (owner && Array.isArray(owner.tradeStall)) {\n                  const stall = owner.tradeStall[colIndex];\n                  // Only show the item if it hasn't been bought\n                  if (stall?.resource && !stall?.boughtBy) {\n                    const template = masterResources.find(r => r.type === stall.resource);\n                    if (template?.symbol) content = template.symbol;\n                  }\n                }\n              } else if (cell === \"username\") {\n                content = owner?.username || \"\";\n              } else if (cell === \"role\") {\n                content = owner?.role || \"Citizen\";\n              } else if (cell === \"netWorth\") {\n                content = `${owner?.netWorth?.toLocaleString() || \"0\"} (net worth)`;\n              }\n            }\n  \n            // Determine cell styling based on content type\n            let cellClasses = \"mini-cell\";\n            let contentClasses = \"\";\n            \n            // Check if this cell shows username\n            if (cell === \"username\" && content) {\n              contentClasses = \"username-text\";\n            }\n            \n            // Check if this cell shows role (Mayor)\n            if (cell === \"role\" && content === \"Mayor\") {\n              contentClasses = \"mayor-text\";\n            }\n            \n            // Check if this cell shows player icon on current grid\n            if (isPlayerHere && content === currentPlayer.icon) {\n              contentClasses = \"player-icon-current\";\n            }\n\n            return (\n              <div key={`${rowIndex}-${colIndex}`} className={cellClasses}>\n                <span className={contentClasses}>{content}</span>\n              </div>\n            );\n          })\n        )}\n      </div>\n    );\n  };\n\n  if (error) return <div>Error: {error}</div>;\n  if (!settlementGrid.length) return <div>Loading Settlement Grid...</div>;\n\n  return (\n    <>\n      <div className=\"settlement-grid\">\n        {settlementGrid.map((row, rowIndex) =>\n          row.map((tile, colIndex) => (\n            <div\n              key={`${rowIndex}-${colIndex}`}\n              className=\"settlement-tile\"\n              style={{\n                backgroundColor: getGridBackgroundColor(tile.gridType),\n              }}\n              onClick={() => handleTileClick(tile, TILE_SIZE)}\n              onMouseMove={(e) => handleTileMouseMove(e, tile)}\n              onMouseLeave={handleTileMouseLeave}\n            >\n              {renderMiniGrid(tile)}\n            </div>\n          ))\n        )}\n      </div>\n      {/* Cursor-following tooltip */}\n      {tooltipData.visible && tooltipData.content && (\n        <div\n          className=\"settlement-tooltip\"\n          style={{\n            position: 'fixed',\n            left: tooltipData.x + 12,\n            top: tooltipData.y - 10,\n            transform: 'translateY(-100%)',\n            pointerEvents: 'none',\n          }}\n        >\n          <p>Who's Here:</p>\n          {tooltipData.content}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default SettlementView;\n","import axios from \"axios\";\nimport API_BASE from \"../config\";\n\nexport const processRelocation = async (currentPlayer, setCurrentPlayer, fromGridId, targetGridCoord, settlementGrid) => {\n  console.log(\"At processRelocation; fromGridId =\", fromGridId, \"; targetGridCoord =\", targetGridCoord);\n  console.log(\"settlementGrid =\", settlementGrid);\n\n  try {\n    const relocationResponse = await axios.post(`${API_BASE}/api/relocate-homestead`, {\n      fromGridId,\n      targetGridCoord,\n    });\n\n    //  Refresh player data\n    try {\n      console.log(\" Fetching updated player data...\");\n      const playerResponse = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}`);\n      console.log(\" Updated player object:\", playerResponse.data);\n\n      if (playerResponse.data) {\n        setCurrentPlayer(playerResponse.data);\n        localStorage.setItem(\"player\", JSON.stringify(playerResponse.data));\n        console.log(\" setCurrentPlayer + localStorage update complete\");\n      }\n    } catch (error) {\n      console.error(\" Failed to refresh player data after relocation:\", error);\n    }\n\n    console.log(\" Relocation successful:\", relocationResponse.data);\n    return relocationResponse.data;\n  } catch (error) {\n    console.error(\" Relocation failed:\", error.response?.data || error.message);\n    return { success: false, error: error.response?.data || error.message };\n  }\n};","import API_BASE from \"../config\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport \"./FrontierView.css\";\nimport { StatusBarContext } from \"../UI/StatusBar/StatusBar\";\nimport { changePlayerLocation } from \"../Utils/GridManagement\";\nimport { fetchHomesteadSignpostPosition } from \"../Utils/worldHelpers\";\nimport frontierTileData from './FrontierTile.json';\nimport { useBulkOperation } from \"../UI/BulkOperationContext\";\nimport { getGridBackgroundColor } from './ZoomedOut';\nimport { showNotification } from '../UI/Notifications/Notifications';\nimport { useStrings } from '../UI/StringsContext';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\nimport { isGridVisited } from \"../Utils/gridsVisitedUtils\";\n\n\nconst FrontierView = ({ \n  currentPlayer, \n  isDeveloper,\n  setZoomLevel, \n  isRelocating,\n  setIsRelocating,\n  setCurrentPlayer,            \n  setGridId,                //  Ensure this is passed\n  setGrid,                  //  Pass setGrid function\n  setResources,             //  Pass setResources function\n  setTileTypes,             //  Pass setTileTypes function\n  TILE_SIZE,\n  closeAllPanels,\n  visibleSettlementId,\n  setVisibleSettlementId,\n  masterResources,          //  Add masterResources prop\n  masterTrophies,           //  Add masterTrophies prop\n}) => {\n\n  const [frontierGrid, setFrontierGrid] = useState([]);\n  const [settlementGrids, setSettlementGrids] = useState({}); // Store all settlement grids\n  const [error, setError] = useState(null);\n  const { updateStatus } = useContext(StatusBarContext);\n  const bulkOperationContext = useBulkOperation();\n  const strings = useStrings();\n \n  // Fetch Frontier Grid and Settlement Grids together\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/frontier-bundle/${currentPlayer.location.f}?playerSettlementId=${currentPlayer.location.s}`);\n        const { frontierGrid, settlementGrids = {} } = response.data;\n        setFrontierGrid(frontierGrid);\n        const settlementData = settlementGrids;\n        setSettlementGrids(settlementData);\n      } catch (err) {\n        console.error(\"Error fetching frontier bundle:\", err);\n        setError(\"Failed to fetch grid data\");\n      }\n    };\n    fetchData();\n  }, [currentPlayer.location.f]);\n\n  useEffect(() => {\n    if (isRelocating) {\n      updateStatus(125);\n    }\n  }, [isRelocating]);\n\n  // Show notification when zooming out to Frontier view (first time only)\n  useEffect(() => {\n    const checkAndShowFrontierTip = async () => {\n      // Check if player has already seen the frontier tip\n      const hasSawFrontierTip = currentPlayer.trophies?.some(trophy => trophy.name === \"SawFrontierTip\");\n      \n      if (!hasSawFrontierTip) {\n        console.log(' First time in Frontier view - awarding \"SawFrontierTip\" trophy');\n        \n        try {\n          // Award the invisible trophy to mark they've seen the tip\n          await earnTrophy(currentPlayer.playerId, \"SawFrontierTip\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          \n          // Show the notification\n          showNotification('Tip', {\n            title: strings[7001],\n            message: strings[7020]\n          });\n          \n          console.log(' Frontier tip shown and trophy awarded');\n        } catch (error) {\n          console.error(' Error awarding SawFrontierTip trophy:', error);\n          // Still show notification even if trophy award fails\n          showNotification('Tip', {\n            title: strings[7001],\n            message: strings[7020]\n          });\n        }\n      } else {\n        console.log(' Player already has SawFrontierTip trophy - skipping notification');\n      }\n    };\n    \n    if (currentPlayer?.playerId && strings && masterTrophies) {\n      checkAndShowFrontierTip();\n    }\n  }, [currentPlayer?.playerId, strings, masterTrophies]); // Re-run if these dependencies change\n\n  const handleTileClick = async (tile) => {\n    console.log(' Tile clicked:', tile);\n    console.log(' Current player state:', {\n      id: currentPlayer?._id,\n      playerId: currentPlayer?.playerId,\n      location: currentPlayer?.location,\n      gridId: currentPlayer?.gridId\n    });\n\n    // Are we in RELOCATION mode?\n    if (isRelocating) {\n      if (tile.settlementType.startsWith('homesteadSet')) {\n        if (tile.settlementId) { setVisibleSettlementId(tile.settlementId);}\n        setZoomLevel('settlement'); return;\n      } else { updateStatus(122); return; }\n    };\n\n    try {\n      // Add validation before attempting transit\n      if (!tile.settlementId) {\n        console.warn(' Missing settlementId in clicked tile');\n        updateStatus(\"Invalid destination\");\n        return;\n      }\n\n      // Case 1: Current settlement\n      if (tile.settlementId === currentPlayer.location.s) {\n          console.log(' Player clicked current settlement - zooming in');\n        setZoomLevel(\"settlement\");\n        updateStatus(12);\n        return;\n      }\n\n      // Case 2: Clicking on a tile where the player owns a homestead\n      if (tile.settlementType.startsWith('homesteadSet')) {\n        try {\n          // Fetch the settlement grid\n          const response = await axios.get(`${API_BASE}/api/get-settlement-grid/${tile.settlementId}`);\n          const grids = response.data.grid || [];\n          // Find the player's owned homestead\n          const ownedHomestead = grids.flat().find(\n            (grid) => grid.gridType === \"homestead\" && grid.gridId === currentPlayer.gridId\n          );    \n          if (ownedHomestead) {\n            console.log(\"Traveling to owned homestead:\", ownedHomestead);\n            \n            // Fetch the homestead grid data to find Signpost Town location\n            const signpostPosition = await fetchHomesteadSignpostPosition(ownedHomestead.gridId);\n            \n            const toLocation = {\n              x: signpostPosition.x,  \n              y: signpostPosition.y,\n              g: ownedHomestead.gridId, \n              s: tile.settlementId, \n              f: currentPlayer.location.f,\n              gtype: ownedHomestead.gridType, \n              gridCoord: ownedHomestead.gridCoord  \n            };\n            await changePlayerLocation(\n              currentPlayer,\n              currentPlayer.location, \n              toLocation,\n              setCurrentPlayer,\n              setGridId,                //  Ensure this is passed\n              setGrid,                  //  Pass setGrid function\n              setTileTypes,             //  Pass setTileTypes function\n              setResources,             //  Pass setResources function\n              TILE_SIZE,\n              closeAllPanels,\n              updateStatus,\n              bulkOperationContext,\n              masterResources,          //  Pass masterResources\n              strings,                  //  Pass strings for valley trophy check\n              null                      //  masterTrophies not available in FrontierView\n            ); \n            setZoomLevel(\"far\");\n            return;\n          }\n        } catch (error) {\n          console.error(\"Error checking for owned homestead:\", error);\n          updateStatus(8); // General error\n          return;\n        }\n        updateStatus(17); // Homestead tile clicked but no ownership\n        return;\n      }\n\n      // Case 3: Clicking on any other valley tile\n      if ([\"valley0Set\", \"valley1Set\", \"valley2Set\", \"valley3Set\"].includes(tile.settlementType)) {\n        updateStatus(9); // Valley tile clicked\n        return;\n      }\n\n    } catch (error) {\n      console.error(' Transit error details:', {\n        message: error.message,\n        response: error.response?.data,\n        status: error.response?.status,\n        tile: tile\n      });\n      updateStatus(99);\n    }\n  };\n\n  const renderMiniGrid = (tile, settlementRow, settlementCol) => {\n    const tileData = frontierTileData[tile.settlementType] || Array(8).fill(Array(8).fill(\"\"));\n    const settlementGrid = settlementGrids[tile.settlementId]?.grid || [];\n    const flatSettlementGrid = settlementGrid.flat();\n\n    // Check if this is a pure valley settlement (all grids are valleys)\n    const isPureValleySettlement = ['valley0Set', 'valley1Set', 'valley2Set', 'valley3Set'].includes(tile.settlementType);\n    // Check if this is a homestead settlement (mixed grids with dirt background)\n    const isHomesteadSettlement = tile.settlementType?.startsWith('homesteadSet');\n\n    return (\n      <div className=\"mini-grid\">\n        {tileData.map((row, rowIndex) =>\n          row.map((cell, colIndex) => {\n            const gridIndex = rowIndex * 8 + colIndex;\n            const gridData = flatSettlementGrid[gridIndex];\n\n            // Default content from tile data\n            let content = cell;\n            // Homestead settlements use dirt background as base color\n            let cellStyle = isHomesteadSettlement ? { backgroundColor: 'var(--color-bg-dirt)' } : {};\n\n            // Determine if this is a valley grid\n            // Use API data if available, otherwise infer from settlement type\n            let isValleyType = false;\n            if (gridData?.gridType) {\n              isValleyType = ['valley0', 'valley1', 'valley2', 'valley3'].includes(gridData.gridType);\n            } else if (isPureValleySettlement) {\n              // All grids in pure valley settlements are valley type\n              isValleyType = true;\n            }\n\n            // Calculate gridCoord (SSGG portion) from position\n            // This allows visited check to work even without API data\n            const calculatedSSGG = settlementRow * 1000 + settlementCol * 100 + rowIndex * 10 + colIndex;\n            const hasBeenVisited = isGridVisited(currentPlayer.gridsVisited, calculatedSSGG);\n\n            const isPlayerHere = gridData?.gridId && gridData.gridId === currentPlayer.location.g;\n\n            // Apply visited styling for valley grids (overrides dirt background if applicable)\n            if (isValleyType && hasBeenVisited) {\n              cellStyle = { backgroundColor: 'var(--valley-visited-color)' };\n              content = ''; // Remove tree emoji for visited grids\n            }\n\n            // Then apply content overlays\n            if (isPlayerHere) {\n              content = currentPlayer.icon;\n            } else if (gridData?.gridType === 'homestead' && !gridData.available) {\n              content = '';\n            } else if (gridData?.gridType === 'town') {\n              content = '';\n            }\n\n            return (\n              <div key={`${rowIndex}-${colIndex}`} className=\"mini-cell\" style={cellStyle}>\n                <span>{content}</span>\n              </div>\n            );\n          })\n        )}\n      </div>\n    );\n  };\n\n  if (error) return <div>Error: {error}</div>;\n  if (!frontierGrid.length) return <div>Loading Frontier Grid...</div>;\n\n  return (\n    <div className=\"frontier-grid\">\n      {frontierGrid.map((row, rowIndex) =>\n        row.map((tile, colIndex) => (\n          <div\n            key={`${rowIndex}-${colIndex}`}\n            className=\"frontier-tile\"\n            style={{\n              backgroundColor: getGridBackgroundColor(tile.settlementType),\n            }}\n            onClick={() => handleTileClick(tile)}\n          >\n            {renderMiniGrid(tile, rowIndex, colIndex)}\n          </div>\n        ))\n      )}\n    </div>\n  );\n};\n\nexport default FrontierView;\n","import React, { useMemo } from 'react';\nimport './FrontierMiniMap.css';\nimport { handleTransitSignpost } from '../GameFeatures/Transit/Transit';\n\n// FTUE Cave dungeon grid ID - this dungeon doesn't use the normal timer system\nconst FTUE_CAVE_GRID_ID = '695bd5b76545a9be8a36ee22';\n\n/**\n * Frontier Mini Map - 128x128 pixel representation (2x2 pixels per grid)\n * 64x64 grid representing all grids in the frontier (8x8 settlements, each with 8x8 grids)\n * Player location calculated from gridCoord, shown as yellow cell\n */\nconst FrontierMiniMap = ({ \n  currentPlayer, \n  strings, \n  setCurrentPlayer, \n  setGridId, \n  setGrid, \n  setTileTypes, \n  setResources, \n  updateStatus, \n  TILE_SIZE, \n  closeAllPanels, \n  bulkOperationContext, \n  masterResources, \n  masterTrophies, \n  transitionFadeControl,\n  timers,\n  countdowns\n}) => {\n  // Calculate player's position in the 64x64 grid from gridCoord\n  const playerGridPosition = useMemo(() => {\n    if (!currentPlayer?.location?.gridCoord) {\n      return null;\n    }\n\n    const gridCoord = currentPlayer.location.gridCoord;\n    console.log(' Calculating position from gridCoord:', gridCoord);\n    \n    // Convert gridCoord to string and pad to ensure consistent format\n    const gridCoordStr = gridCoord.toString().padStart(8, '0');\n    \n    // Parse gridCoord: TTIISSGG\n    // TT = tier (ignore)\n    // II = index (ignore) \n    // SS = settlement row & col (positions 4-5)\n    // GG = grid row & col within settlement (positions 6-7)\n    \n    const settlementRow = parseInt(gridCoordStr[4], 10);\n    const settlementCol = parseInt(gridCoordStr[5], 10);\n    const gridRow = parseInt(gridCoordStr[6], 10);\n    const gridCol = parseInt(gridCoordStr[7], 10);\n    \n    // Calculate final position in 64x64 grid\n    const finalRow = settlementRow * 8 + gridRow;\n    const finalCol = settlementCol * 8 + gridCol;\n    \n    console.log(' Parsed gridCoord:', {\n      gridCoord: gridCoordStr,\n      settlementRow, settlementCol,\n      gridRow, gridCol,\n      finalRow, finalCol\n    });\n    \n    return { row: finalRow, col: finalCol };\n  }, [currentPlayer?.location?.gridCoord]);\n\n  // Calculate homestead position from homesteadGridCoord\n  const homesteadGridPosition = useMemo(() => {\n    if (!currentPlayer?.homesteadGridCoord) {\n      return null;\n    }\n\n    const gridCoord = currentPlayer.homesteadGridCoord;\n    console.log(' Calculating homestead position from gridCoord:', gridCoord);\n    \n    // Convert gridCoord to string and pad to ensure consistent format\n    const gridCoordStr = gridCoord.toString().padStart(8, '0');\n    \n    // Parse gridCoord: TTIISSGG\n    const settlementRow = parseInt(gridCoordStr[4], 10);\n    const settlementCol = parseInt(gridCoordStr[5], 10);\n    const gridRow = parseInt(gridCoordStr[6], 10);\n    const gridCol = parseInt(gridCoordStr[7], 10);\n    \n    // Calculate final position in 64x64 grid\n    const finalRow = settlementRow * 8 + gridRow;\n    const finalCol = settlementCol * 8 + gridCol;\n    \n    console.log(' Parsed homestead gridCoord:', {\n      gridCoord: gridCoordStr,\n      settlementRow, settlementCol,\n      gridRow, gridCol,\n      finalRow, finalCol\n    });\n    \n    return { row: finalRow, col: finalCol };\n  }, [currentPlayer?.homesteadGridCoord]);\n\n  // Check if player is in a dungeon\n  const isInDungeon = currentPlayer?.location?.gtype === 'dungeon';\n\n  // Check if player is already in their home town (town grid in their home settlement)\n  const isInHomeTown = useMemo(() => {\n    if (currentPlayer?.location?.gtype !== 'town') return false;\n    if (!currentPlayer?.location?.s || !currentPlayer?.settlementId) return false;\n    return currentPlayer.location.s.toString() === currentPlayer.settlementId.toString();\n  }, [currentPlayer?.location?.gtype, currentPlayer?.location?.s, currentPlayer?.settlementId]);\n\n  // Generate the 64x64 grid (each cell represents one grid in the frontier)\n  const frontierGrid = useMemo(() => {\n    const grid = [];\n    \n    for (let row = 0; row < 64; row++) {\n      const gridRow = [];\n      for (let col = 0; col < 64; col++) {\n        // Check if this is the player's position\n        const isPlayerPosition = playerGridPosition && \n          playerGridPosition.row === row && \n          playerGridPosition.col === col;\n        \n        // Check if this is the homestead position\n        const isHomesteadPosition = homesteadGridPosition && \n          homesteadGridPosition.row === row && \n          homesteadGridPosition.col === col;\n\n        gridRow.push({\n          row,\n          col,\n          isPlayer: isPlayerPosition,\n          isHomestead: isHomesteadPosition,\n          key: `${row}-${col}`\n        });\n      }\n      grid.push(gridRow);\n    }\n    \n    return grid;\n  }, [playerGridPosition, homesteadGridPosition]);\n\n  // Get the current region name from player location\n  const currentRegion = currentPlayer?.location?.region;\n\n  // Compute the display title based on location\n  const displayTitle = useMemo(() => {\n    // 1. If in a dungeon, show \"In a Dungeon\"\n    if (isInDungeon) {\n      return strings[10186] || 'In a Dungeon';\n    }\n\n    // 2. If there's a region name, show that (takes precedence)\n    if (currentRegion) {\n      return currentRegion;\n    }\n\n    // 3. If at home grid (location.g matches player's homestead gridId)\n    if (currentPlayer?.location?.g && currentPlayer?.gridId) {\n      const currentGridId = currentPlayer.location.g.toString();\n      const homeGridId = currentPlayer.gridId.toString();\n      if (currentGridId === homeGridId) {\n        return strings[107] || 'Your Homestead';\n      }\n    }\n\n    // 4. If in a town grid that belongs to home settlement\n    if (currentPlayer?.location?.gtype === 'town' &&\n        currentPlayer?.location?.s &&\n        currentPlayer?.settlementId) {\n      const currentSettlementId = currentPlayer.location.s.toString();\n      const homeSettlementId = currentPlayer.settlementId.toString();\n      if (currentSettlementId === homeSettlementId) {\n        return strings[108] || 'Your Town';\n      }\n    }\n\n    // 5. If in a valley grid (valley0-3) with no region\n    const gtype = currentPlayer?.location?.gtype;\n    if (['valley0', 'valley1', 'valley2', 'valley3'].includes(gtype)) {\n      return strings[10184] || 'The Valley';\n    }\n\n    // 6. Default to \"Map\"\n    return strings[2] || 'Map';\n  }, [isInDungeon, currentRegion, currentPlayer?.location?.g, currentPlayer?.gridId,\n      currentPlayer?.location?.gtype, currentPlayer?.location?.s,\n      currentPlayer?.settlementId, strings]);\n\n  return (\n    <div className=\"frontier-mini-map\">\n      {/* Title row - show computed display title */}\n      <h3 style={{ textAlign: 'center', fontFamily: 'Berkshire Swash', margin: '0 0 8px 0' }}>\n        {displayTitle}\n      </h3>\n\n      {/* Map row with Home and Town buttons on sides */}\n      <div className=\"mini-map-row-container\">\n        {/* Home button column - right aligned */}\n        <div className=\"minimap-button-column home-column\">\n          {!isInDungeon && (\n            <span\n              className=\"minimap-signpost-button\"\n              onClick={() => handleTransitSignpost(\n                currentPlayer,\n                \"Signpost Home\",\n                setCurrentPlayer,\n                setGridId,\n                setGrid,\n                setTileTypes,\n                setResources,\n                updateStatus,\n                TILE_SIZE,\n                currentPlayer.skills,\n                closeAllPanels,\n                bulkOperationContext,\n                masterResources,\n                strings,\n                masterTrophies,\n                transitionFadeControl\n              )}\n              title={strings && strings[107] ? strings[107] : \"Go Home\"}\n            >\n              \n            </span>\n          )}\n        </div>\n\n        {/* Map in center */}\n        <div className=\"mini-map-grid\">\n        {frontierGrid.map((row, rowIndex) => (\n          <div key={rowIndex} className=\"mini-map-row\">\n            {row.map((cell) => {\n              // Determine cell type and class\n              let cellClass = 'default-cell';\n              let cellTitle = `Grid (${cell.row}, ${cell.col})`;\n\n              if (cell.isPlayer) {\n                cellClass = 'player-cell';\n                cellTitle = `You are here (${cell.row}, ${cell.col})`;\n              } else if (cell.isHomestead) {\n                cellClass = 'homestead-cell';\n                cellTitle = `Your homestead (${cell.row}, ${cell.col})`;\n              }\n\n              return (\n                <div\n                  key={cell.key}\n                  className={`mini-map-cell ${cellClass}`}\n                  title={cellTitle}\n                />\n              );\n            })}\n          </div>\n        ))}\n        </div>\n\n        {/* Town button column - left aligned */}\n        <div className=\"minimap-button-column town-column\">\n          {!isInDungeon && (\n            <span\n              className={`minimap-signpost-button${isInHomeTown ? ' disabled' : ''}`}\n              onClick={isInHomeTown ? undefined : () => handleTransitSignpost(\n                currentPlayer,\n                \"Signpost Town Home\",\n                setCurrentPlayer,\n                setGridId,\n                setGrid,\n                setTileTypes,\n                setResources,\n                updateStatus,\n                TILE_SIZE,\n                currentPlayer.skills,\n                closeAllPanels,\n                bulkOperationContext,\n                masterResources,\n                strings,\n                masterTrophies,\n                transitionFadeControl\n              )}\n              title={strings && strings[108] ? strings[108] : \"Go to Town\"}\n              style={isInHomeTown ? { opacity: 0.4, cursor: 'default' } : undefined}\n            >\n              \n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Only show dungeon timer when in dungeon (but not FTUE Cave which has no timer) */}\n      {isInDungeon && currentPlayer?.location?.g?.toString() !== FTUE_CAVE_GRID_ID && (\n        <div className=\"mini-map-dungeon-info\">\n          {(() => {\n            const countdown = countdowns?.dungeon || '--:--:--';\n            const days = countdown.match(/(\\d+)d/)?.[1] || '0';\n            const hours = countdown.match(/(\\d+)h/)?.[1] || '0';\n            const minutes = countdown.match(/(\\d+)m/)?.[1] || '0';\n            const isLessThanOneMinute = parseInt(days, 10) === 0 && parseInt(hours, 10) === 0 && parseInt(minutes, 10) === 0;\n\n            return (\n              <span style={{\n                color: isLessThanOneMinute ? '#a71616ff' : 'inherit',\n                fontWeight: isLessThanOneMinute ? 'bold' : 'normal'\n              }}>\n                Dungeon closes in {countdown}\n              </span>\n            );\n          })()}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FrontierMiniMap;","// src/UI/Modals/Modal.js\nimport React from 'react';\nimport './Modal.css';\nimport '../Buttons/SharedButtons.css';\n\nfunction Modal({ isOpen = true, onClose, title, children, custom, message, message2, size = \"standard\", className }) {\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className={`modal-container ${size === \"small\" ? \"modal-small\" : \"\"} ${className || \"\"}`}>\n        {/* Close Button (X style) */}\n        <button className=\"modal-close-btn\" onClick={onClose}>\n          &times;\n        </button>\n\n        {title && <h2 className=\"modal-title\">{title}</h2>}\n\n        <div className=\"modal-content\">\n          {message && <p className=\"modal-message\">{message}</p>}\n          {message2 && <p className=\"modal-message\">{message2}</p>}\n          {children}\n          {custom}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Modal;","var RELEASE_TRAIN = 'basil';\n\nvar runtimeVersionToUrlVersion = function runtimeVersionToUrlVersion(version) {\n  return version === 3 ? 'v3' : version;\n};\n\nvar ORIGIN = 'https://js.stripe.com';\nvar STRIPE_JS_URL = \"\".concat(ORIGIN, \"/\").concat(RELEASE_TRAIN, \"/stripe.js\");\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar STRIPE_JS_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/(v3|[a-z]+)\\/stripe\\.js(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar isStripeJSURL = function isStripeJSURL(url) {\n  return V3_URL_REGEX.test(url) || STRIPE_JS_URL_REGEX.test(url);\n};\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(ORIGIN, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!isStripeJSURL(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(STRIPE_JS_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"7.4.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise$1 = null;\nvar onErrorListener = null;\nvar onLoadListener = null;\n\nvar onError = function onError(reject) {\n  return function (cause) {\n    reject(new Error('Failed to load Stripe.js', {\n      cause: cause\n    }));\n  };\n};\n\nvar onLoad = function onLoad(resolve, reject) {\n  return function () {\n    if (window.Stripe) {\n      resolve(window.Stripe);\n    } else {\n      reject(new Error('Stripe.js not available'));\n    }\n  };\n};\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise$1 !== null) {\n    return stripePromise$1;\n  }\n\n  stripePromise$1 = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      } else if (script && onLoadListener !== null && onErrorListener !== null) {\n        var _script$parentNode;\n\n        // remove event listeners\n        script.removeEventListener('load', onLoadListener);\n        script.removeEventListener('error', onErrorListener); // if script exists, but we are reloading due to an error,\n        // reload script to trigger 'load' event\n\n        (_script$parentNode = script.parentNode) === null || _script$parentNode === void 0 ? void 0 : _script$parentNode.removeChild(script);\n        script = injectScript(params);\n      }\n\n      onLoadListener = onLoad(resolve, reject);\n      onErrorListener = onError(reject);\n      script.addEventListener('load', onLoadListener);\n      script.addEventListener('error', onErrorListener);\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  }); // Resets stripePromise on error\n\n  return stripePromise$1[\"catch\"](function (error) {\n    stripePromise$1 = null;\n    return Promise.reject(error);\n  });\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var pk = args[0];\n  var isTestKey = pk.match(/^pk_test/); // @ts-expect-error this is not publicly typed\n\n  var version = runtimeVersionToUrlVersion(maybeStripe.version);\n  var expectedVersion = RELEASE_TRAIN;\n\n  if (isTestKey && version !== expectedVersion) {\n    console.warn(\"Stripe.js@\".concat(version, \" was loaded on the page, but @stripe/stripe-js@\").concat(\"7.4.0\", \" expected Stripe.js@\").concat(expectedVersion, \". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning\"));\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar stripePromise;\nvar loadCalled = false;\n\nvar getStripePromise = function getStripePromise() {\n  if (stripePromise) {\n    return stripePromise;\n  }\n\n  stripePromise = loadScript(null)[\"catch\"](function (error) {\n    // clear cache on error\n    stripePromise = null;\n    return Promise.reject(error);\n  });\n  return stripePromise;\n}; // Execute our own script injection after a tick to give users time to do their\n// own script injection.\n\n\nPromise.resolve().then(function () {\n  return getStripePromise();\n})[\"catch\"](function (error) {\n  if (!loadCalled) {\n    console.warn(error);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now(); // if previous attempts are unsuccessful, will re-load script\n\n  return getStripePromise().then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import API_BASE from '../config';\nimport React, { useEffect, useState, useContext } from 'react';\nimport axios from 'axios';\nimport Modal from '../UI/Modals/Modal';\nimport './Store.css';\nimport '../UI/Buttons/SharedButtons.css';\nimport { StatusBarContext } from '../UI/StatusBar/StatusBar';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { updateBadge } from '../Utils/appUtils';\nimport { useStrings } from '../UI/StringsContext';\n\nexport const handlePurchase = async (offerId, currentPlayer, updateStatus) => {\n  try {\n    const response = await axios.post(`${API_BASE}/api/create-checkout-session`, {\n      playerId: currentPlayer.playerId,\n      offerId\n    });\n\n    if (response.data?.id) {\n      const stripe = await loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\n      await stripe.redirectToCheckout({ sessionId: response.data.id });\n    } else {\n      updateStatus(\" Failed to initiate checkout.\");\n    }\n  } catch (err) {\n    console.error(\" Error initiating checkout:\", err);\n    updateStatus(\" Error initiating checkout.\");\n  }\n};\n\nfunction Store({ onClose, currentPlayer, setCurrentPlayer, resources, openMailbox, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const [offers, setOffers] = useState([]);\n  const { updateStatus } = useContext(StatusBarContext);\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const purchaseSuccess = params.get(\"purchase\");\n    console.log(\" URL query params:\", {\n      purchaseSuccess,\n      playerId: params.get(\"playerId\"),\n      offerId: params.get(\"offerId\")\n    });\n    const playerId = params.get(\"playerId\");\n    const offerId = params.get(\"offerId\");\n\n    if (purchaseSuccess === \"success\" && playerId && offerId) {\n\n      //  Finalize fulfillment by notifying backend\n      axios.post(`${API_BASE}/api/purchase-store-offer`, {\n        playerId,\n        offerId\n      }).then(() => {\n        console.log(\" Called /api/purchase-store-offer successfully for:\", { playerId, offerId });\n        console.log(\" Store reward successfully delivered.\");\n        updateStatus(\" Purchase successful! Check your Inbox.\");\n        updateBadge(currentPlayer, () => {}, \"store\", false); // Clear store badge\n\n        axios.get(`${API_BASE}/api/player/${playerId}`).then((playerResponse) => {\n          setCurrentPlayer(playerResponse.data);\n        }).catch((err) => {\n          console.error(\" Failed to refresh player data:\", err);\n        });\n        \n      }).catch((err) => {\n        console.error(\" Error calling /api/purchase-store-offer with:\", { playerId, offerId });\n        console.error(\" Failed to deliver store reward:\", err);\n        updateStatus(\" Purchase may not have been delivered. Please contact support.\");\n      });\n\n      //  Optionally hit backend to finalize fulfillment if needed\n\n      //  Clean up query params from the URL\n      const url = new URL(window.location.href);\n      url.search = \"\";\n      window.history.replaceState({}, document.title, url.toString());\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchOffers();\n  }, []);\n\n  const fetchOffers = async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/api/store-offers`);\n      setOffers(response.data || []);\n    } catch (error) {\n      console.error(\" Failed to load store offers:\", error);\n    }\n  };\n\n  const isOfferExpired = (offer) => {\n    if (!offer.shelflifeDays || !currentPlayer?.created) return false;\n\n    const created = new Date(currentPlayer.created);\n    const now = new Date();\n    const daysSince = Math.floor((now - created) / (1000 * 60 * 60 * 24));\n\n    return daysSince > offer.shelflifeDays;\n  };\n\n  return (\n    <Modal\n      onClose={(args) => {\n        if (args?.openMailbox && typeof openMailbox === 'function') {\n          openMailbox();\n        }\n        onClose();\n      }}\n      title={strings[1701]}\n    >\n        <h3>{strings[1702]}</h3>\n        <h4>{strings[1703]}</h4>\n        <h4>{strings[1704]}</h4>\n\n      <div className=\"store-offers\">\n        {(() => {\n          const activeOffers = offers.filter((offer) => !isOfferExpired(offer));\n          const processedIds = new Set();\n          \n          return activeOffers.map((offer) => {\n            // Skip if already processed\n            if (processedIds.has(offer.id)) return null;\n            \n            // Process offers 3 & 4 together\n            if (offer.id === 3 || offer.id === 4) {\n              const offer3 = activeOffers.find(o => o.id === 3);\n              const offer4 = activeOffers.find(o => o.id === 4);\n              \n              if (offer3) processedIds.add(3);\n              if (offer4) processedIds.add(4);\n              \n              return (\n                <div key=\"group-3-4\" className=\"store-offer-row\">\n                  {offer3 && (\n                    <div className=\"store-offer-card store-offer-card-half\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer3.title}</h3>\n                        <p>{offer3.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer3.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer3.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer3.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer4 && (\n                    <div className=\"store-offer-card store-offer-card-half\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer4.title}</h3>\n                        <p>{offer4.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer4.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer4.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer4.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              );\n            }\n            \n            // Process offers 6, 7 & 8 together\n            if (offer.id === 6 || offer.id === 7 || offer.id === 8) {\n              const offer6 = activeOffers.find(o => o.id === 6);\n              const offer7 = activeOffers.find(o => o.id === 7);\n              const offer8 = activeOffers.find(o => o.id === 8);\n              \n              if (offer6) processedIds.add(6);\n              if (offer7) processedIds.add(7);\n              if (offer8) processedIds.add(8);\n              \n              return (\n                <div key=\"group-6-7-8\" className=\"store-offer-row\">\n                  {offer6 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer6.title}</h3>\n                        <p>{offer6.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer6.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer6.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer6.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer7 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer7.title}</h3>\n                        <p>{offer7.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer7.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer7.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer7.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  {offer8 && (\n                    <div className=\"store-offer-card store-offer-card-third store-offer-card-gem\">\n                      <div className=\"store-offer-left\">\n                        <h3>{offer8.title}</h3>\n                        <p>{offer8.body}</p>\n                        <p className=\"store-reward-line\">\n                          {offer8.rewards.map(r => {\n                            const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                            return `${symbol} ${r.qty} ${r.item}`;\n                          }).join(\", \")}\n                        </p>\n                      </div>\n                      <div className=\"store-offer-right\">\n                        <div className=\"store-price\">USD ${offer8.price.toFixed(2)}</div>\n                        <div className=\"shared-buttons\">\n                          <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer8.id, currentPlayer, updateStatus)}>Buy</button>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              );\n            }\n            \n            // Mark as processed and render normally\n            processedIds.add(offer.id);\n            \n            return (\n              <div key={offer.id} className={`store-offer-card${String(offer.id) === \"1\" ? ' store-offer-card-gold' : ''}`}>\n                <div className=\"store-offer-left\">\n                  <h3>{offer.title}</h3>\n                  <p>{offer.body}</p>\n                  <p className=\"store-reward-line\">\n                    {offer.rewards.map(r => {\n                      const symbol = resources.find(res => res.type === r.item)?.symbol || '';\n                      return `${symbol} ${r.qty} ${r.item}`;\n                    }).join(\", \")}\n                  </p>\n                </div>\n                <div className=\"store-offer-right\">\n                  <div className=\"store-price\">USD ${offer.price.toFixed(2)}</div>\n                  <div className=\"shared-buttons\">\n                    <button className=\"btn-basic btn-gold\" onClick={() => handlePurchase(offer.id, currentPlayer, updateStatus)}>Buy</button>\n                  </div>\n                </div>\n              </div>\n            );\n          });\n        })()}\n      </div>\n    </Modal>\n  );\n}\n\nexport default Store;","import React, { useState, useEffect } from 'react';\nimport './Modal.css';\nimport '../Buttons/SharedButtons.css';\nimport { handlePurchase } from '../../Store/Store';\nimport axios from 'axios';\nimport API_BASE from '../../config';\n\nfunction RevivalModal({\n  isOpen = true,\n  onAcceptDeath,\n  onRevive,\n  reviveCost = 50,\n  strings = {},\n  currentPlayer,\n  inventory,\n  updateStatus\n}) {\n  const [offers, setOffers] = useState({});\n\n  // Get player's gem count (safely handle if inventory is not an array)\n  const playerGems = Array.isArray(inventory)\n    ? (inventory.find(item => item.type === 'Gem')?.quantity || 0)\n    : 0;\n  const hasEnoughGems = playerGems >= reviveCost;\n\n  // Fetch store offers for gem purchase buttons\n  useEffect(() => {\n    if (!isOpen || hasEnoughGems) return;\n\n    const fetchOffers = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/store-offers`);\n        const offerData = response.data || [];\n        const offerMap = {};\n        offerData.forEach(offer => {\n          offerMap[offer.id] = offer;\n        });\n        setOffers(offerMap);\n      } catch (error) {\n        console.error(\" Failed to load store offers:\", error);\n      }\n    };\n    fetchOffers();\n  }, [isOpen, hasEnoughGems]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className={`modal-container ${hasEnoughGems ? 'modal-small' : 'modal-medium'}`}>\n        <h2 className=\"modal-title\">{strings[\"5004\"] || \" You have fallen!\"}</h2>\n\n        <div className=\"modal-content\">\n          <p className=\"modal-message\">{strings[\"5070\"] || \"Your journey doesn't have to end here...\"}</p>\n          <p className=\"modal-message\">{strings[\"5071\"] || \"Choose your fate:\"}</p>\n\n          <div className=\"shared-buttons\">\n            <button\n              className={`btn-basic ${hasEnoughGems ? 'btn-gold' : 'btn-neutral'} btn-modal`}\n              onClick={hasEnoughGems ? onRevive : null}\n              disabled={!hasEnoughGems}\n              style={{ marginRight: '10px', opacity: hasEnoughGems ? 1 : 0.7 }}\n            >\n              {strings[\"5072\"] || \"Revive for\"}<br />\n              <span style={{ color: hasEnoughGems ? '#2ecc71' : '#e74c3c' }}>\n                 {reviveCost} / {playerGems}\n              </span>\n            </button>\n\n            <button\n              className=\"btn-basic btn-danger btn-modal\"\n              onClick={onAcceptDeath}\n            >\n              {strings[\"5073\"] || \"Accept Your Death\"}\n            </button>\n          </div>\n\n          {/* Show gem purchase options when player doesn't have enough gems */}\n          {!hasEnoughGems && (\n            <div style={{ marginTop: '20px', borderTop: '1px solid var(--color-border)', paddingTop: '15px' }}>\n              <p style={{ textAlign: 'center', fontWeight: 'bold', marginBottom: '10px' }}>\n                {strings[5074] || \"Need more gems?\"}\n              </p>\n              <div className=\"shared-buttons\" style={{ display: 'flex', flexDirection: 'row', justifyContent: 'center', gap: '6px' }}>\n                <button\n                  className=\"btn-basic btn-gold\"\n                  onClick={() => handlePurchase(6, currentPlayer, updateStatus)}\n                >\n                   100 for {offers[6] ? `$${offers[6].price.toFixed(2)}` : '...'}\n                </button>\n                <button\n                  className=\"btn-basic btn-gold\"\n                  onClick={() => handlePurchase(7, currentPlayer, updateStatus)}\n                >\n                   250 for {offers[7] ? `$${offers[7].price.toFixed(2)}` : '...'}\n                </button>\n                <button\n                  className=\"btn-basic btn-gold\"\n                  onClick={() => handlePurchase(8, currentPlayer, updateStatus)}\n                >\n                   500 for {offers[8] ? `$${offers[8].price.toFixed(2)}` : '...'}\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default RevivalModal;\n","import React, { useState, useEffect } from 'react';\nimport './Modal.css';\nimport '../Buttons/SharedButtons.css';\nimport './LevelUpModal.css';\nimport { useStrings } from '../StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport questCache from '../../Utils/QuestCache';\n\n// Categories to show in unlock list\nconst ALLOWED_CATEGORIES = ['farmplot', 'crafting', 'skill', 'power', 'pet', 'deco', 'station'];\n\n// Check if resource should be shown in unlock list\nconst shouldShowResource = (resource) => {\n  if (!resource.category) return false;\n\n  // Direct category match\n  if (ALLOWED_CATEGORIES.includes(resource.category)) {\n    return true;\n  }\n\n  // NPC category with specific actions\n  if (resource.category === 'npc') {\n    return resource.action === 'graze' || resource.action === 'worker';\n  }\n\n  return false;\n};\n\nconst LevelUpModal = ({\n  isOpen,\n  onClose,\n  currentLevel,\n  previousLevel,\n  updateStatus,\n  masterResources\n}) => {\n\n  const strings = useStrings();\n  const [questGivers, setQuestGivers] = useState([]);\n\n  // Fetch quests and find givers with quests at this level\n  useEffect(() => {\n    if (!isOpen || !currentLevel) return;\n\n    const fetchQuestGivers = async () => {\n      try {\n        const allQuests = await questCache.getQuests();\n        // Find quests that unlock at this level\n        const questsAtLevel = allQuests.filter(quest => quest.level === currentLevel);\n        // Get unique quest givers with their symbols\n        const giverMap = new Map();\n        questsAtLevel.forEach(quest => {\n          if (quest.giver && !giverMap.has(quest.giver)) {\n            giverMap.set(quest.giver, quest.symbol || '');\n          }\n        });\n        setQuestGivers(Array.from(giverMap.entries()).map(([giver, symbol]) => ({ giver, symbol })));\n      } catch (error) {\n        console.error('Error fetching quests for level up modal:', error);\n        setQuestGivers([]);\n      }\n    };\n\n    fetchQuestGivers();\n  }, [isOpen, currentLevel]);\n\n  if (!isOpen) return null;\n\n  // Find resources unlocked at this level, filtered by allowed categories\n  const unlockedResources = masterResources?.filter(\n    resource => resource.level === currentLevel && shouldShowResource(resource)\n  ) || [];\n\n  const handleClose = () => {\n    if (updateStatus) {\n      updateStatus((strings[813] || 'Level up! You are now level {level}!').replace('{level}', currentLevel));\n    }\n    onClose();\n  };\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-container modal-medium level-up-modal\">\n        <button className=\"modal-close-btn\" onClick={handleClose}></button>\n\n        <div className=\"modal-title\"> {strings[811] || 'Level Up!'}</div>\n\n        <div className=\"modal-content\">\n          <div className=\"level-up-message\">\n             {(strings[812] || \"Congratulations! You've reached level {level}!\").replace('{level}', currentLevel)} \n          </div>\n\n          {unlockedResources.length > 0 && (\n            <div className=\"unlocked-resources\">\n              <div className=\"unlocked-title\">{strings[10138]}</div>\n              <ul className=\"unlocked-list\">\n                {unlockedResources.map((resource, index) => (\n                  <li key={index}>\n                    {resource.symbol} {getLocalizedString(resource.type, strings)}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          {questGivers.length > 0 && (\n            <div className=\"unlocked-resources\">\n              <div className=\"unlocked-title\">{strings[10139]}</div>\n              <ul className=\"unlocked-list\">\n                {questGivers.map((item, index) => (\n                  <li key={index}>\n                    {item.symbol} {getLocalizedString(item.giver, strings)}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic btn-success btn-modal\"\n              onClick={handleClose}\n            >\n              {strings[360]}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default LevelUpModal;","import API_BASE from '../../config';\nimport React, { useState } from 'react';\nimport './LanguagePickerModal.css';\nimport '../Buttons/SharedButtons.css';\nimport LANGUAGE_OPTIONS from '../Languages.json';\nimport axios from 'axios';\nimport { useStrings } from '../StringsContext';\n\n// Only these languages have been localized - exported for use in CreateAccount\nexport const enabledLanguages = ['en', 'es', 'fr', 'de'];\n\nexport default function LanguagePickerModal({ currentPlayer, setCurrentPlayer, updateStatus, onClose, onSave }) {\n  const strings = useStrings();\n  const [selectedLanguage, setSelectedLanguage] = useState(currentPlayer.language || '');\n\n  const handleLanguageClick = (langCode) => {\n    if (enabledLanguages.includes(langCode)) {\n      setSelectedLanguage(langCode);\n    }\n  };\n\nconst handleSave = async () => {\n  try {\n    const updatedPlayer = { ...currentPlayer, language: selectedLanguage };\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n    setCurrentPlayer(updatedPlayer);\n\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: currentPlayer._id,\n      updates: { language: selectedLanguage },\n    });\n\n    updateStatus && updateStatus('Language updated!');\n    onSave && onSave();\n\n    //  Only reload after successful DB update\n    window.location.reload();\n  } catch (error) {\n    console.error('Error saving language:', error);\n    updateStatus && updateStatus('Failed to update language');\n  }\n};\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose}>\n      <div className=\"modal-container modal-medium\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        <div className=\"modal-title\">{strings[130]}</div>\n        <ul className=\"language-list\">\n          {LANGUAGE_OPTIONS.map(({ code, label, flag }) => {\n            const isEnabled = enabledLanguages.includes(code);\n            return (\n              <li\n                key={code}\n                className={`language-item ${selectedLanguage === code ? 'selected' : ''} ${!isEnabled ? 'disabled' : ''}`}\n                onClick={() => handleLanguageClick(code)}\n                style={{\n                  opacity: isEnabled ? 1 : 0.4,\n                  cursor: isEnabled ? 'pointer' : 'not-allowed'\n                }}\n              >\n                <span className=\"flag\">{flag}</span> {label}\n              </li>\n            );\n          })}\n        </ul>\n        <div className=\"modal-buttons shared-buttons\">\n          <button className=\"btn-basic btn-modal btn-success\" onClick={handleSave}>{strings[131]}</button>\n        </div>\n      </div>\n    </div>\n  );\n}","// governmentUtils.js\nimport axios from 'axios';\nimport API_BASE from '../../config';\n\n/**\n * Fetches the mayor's username for a given settlementId.\n * Returns \"Vacant\" if no mayor is assigned,\n * \"Error\" if something went wrong,\n * or the mayor's username.\n */\nexport async function getMayorUsername(settlementId) {\n  if (!settlementId) {\n    console.warn(\" No settlementId provided to getMayorUsername.\");\n    return \"Error\";\n  }\n\n  try {\n    // Step 1: Fetch settlement data\n    const res = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n    const settlement = res.data;\n\n    // Step 2: Find the role entry for Mayor\n    const mayorRole = settlement.roles?.find(role => role.roleName === \"Mayor\");\n    if (!mayorRole || !mayorRole.playerId || mayorRole.playerId === \"Vacant\") {\n      return \"Vacant\";\n    }\n\n    // Step 3: Fetch player info\n    const playerRes = await axios.get(`${API_BASE}/api/player/${mayorRole.playerId}`);\n    return playerRes.data.username || \"Unknown\";\n    \n  } catch (err) {\n    console.error(\" Failed to fetch mayor username:\", err);\n    return \"Error\";\n  }\n}","import API_BASE from '../config';\nimport axios from 'axios';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { changePlayerLocation } from './GridManagement';\nimport { fetchTownSignpostPosition } from './worldHelpers';\n\n\n// Helper function to calculate derived level based on player XP\n// masterXPLevels is now an array of XP thresholds: [40, 100, 180, 270, ...]\n// Level 1 requires 40 XP, Level 2 requires 100 XP, etc.\nexport const getDerivedLevel = (currentPlayer, masterXPLevels = []) => {\n  const playerXP = currentPlayer?.xp || 0;\n  \n  if (!masterXPLevels || masterXPLevels.length === 0) {\n    return 1; // Default level if no data available\n  }\n  \n  // Find the highest level the player has reached\n  let level = 1;\n  for (let i = 0; i < masterXPLevels.length; i++) {\n    if (playerXP >= masterXPLevels[i]) {\n      level = i + 2; // Level is index + 2 (Level 1 = index 0, Level 2 = index 1, etc.)\n    } else {\n      break;\n    }\n  }\n  \n  return level;\n};\n\n// Helper function to get XP required for next level\nexport const getXpForNextLevel = (currentPlayer, masterXPLevels = []) => {\n  const playerXP = currentPlayer?.xp || 0;\n  \n  if (!masterXPLevels || masterXPLevels.length === 0) {\n    return 1000; // Default if no data available\n  }\n  \n  const currentLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const nextLevelIndex = currentLevel - 1; // Convert level to index (Level 2 = index 1)\n  \n  // If at max level, return current XP (no more levels to gain)\n  if (nextLevelIndex >= masterXPLevels.length) {\n    return playerXP;\n  }\n  \n  return masterXPLevels[nextLevelIndex];\n};\n\nexport const modifyPlayerStatsInGridState = async (statToMod, amountToMod, playerId, gridId) => {\n  try {\n    console.log('made it to modifyPlayerStatsInGridState');\n    console.log('statToMod = ', statToMod, '; amountToMod = ', amountToMod);\n\n    if (!statToMod || !amountToMod) { console.error('Invalid stat or amount to modify.'); return; }\n\n    // Use playersInGridManager to get PCs and update\n    const pcs = playersInGridManager.getPlayersInGrid(gridId);\n    const player = pcs?.[playerId];\n\n    if (!player) {\n      console.warn(` Player ${playerId} not found in playersInGrid for gridId ${gridId}`);\n      console.warn(' All available PCs:', Object.keys(pcs));\n      return;\n    }\n\n    // Modify stat safely\n    const updatedValue = (player[statToMod] || 0) + amountToMod;\n    playersInGridManager.updatePC(gridId, playerId, { [statToMod]: updatedValue });\n    console.log(` Modified ${statToMod} for player ${playerId} by +${amountToMod}. New value: ${updatedValue}`);\n\n  } catch (error) {\n    console.error('Error in modifyPlayerStats:', error);\n  }\n};\n\n\nexport const modifyPlayerStatsInPlayer = async (statToMod, amountToMod, playerId) => {\n  try {\n    console.log(' Modifying player stats in the Player Profile (DB)');\n    console.log('statToMod = ', statToMod, '; amountToMod = ', amountToMod);\n\n    if (!statToMod || !amountToMod) {\n      console.error(' Invalid stat or amount to modify.');\n      return null;\n    }\n\n    // Step 1: Fetch the current player data from the server\n    const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n    const currentPlayerData = response.data;\n\n    if (!currentPlayerData || !currentPlayerData.playerId) {\n      console.error(' Failed to fetch current player data from the server.');\n      return null;\n    }\n\n    // Step 2: Calculate new stat value by adding to the existing value\n    const currentStatValue = currentPlayerData[statToMod] || 0;  // Default to 0 if undefined\n    const newStatValue = currentStatValue + amountToMod;\n    console.log(` Updating ${statToMod}: ${currentStatValue} + ${amountToMod} = ${newStatValue}`);\n\n    // Step 3: Send the updated stat back to the database\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId,\n      updates: {\n        [statToMod]: newStatValue,  //  Now ADDING instead of replacing\n      },\n    });\n\n    console.log(` Successfully updated ${statToMod} in the database.`);\n\n    // Step 4: Return updated player data\n    currentPlayerData[statToMod] = newStatValue;\n    return currentPlayerData;\n\n  } catch (error) {\n    console.error(' Error in modifyPlayerStatsInPlayer:', error);\n    return null;\n  }\n};\n\n/**\n * Determines if a given stat should be stored in NPCsInGrid rather than the player document.\n * @param {string} stat - The name of the stat to check.\n * @returns {boolean} - Returns true if the stat belongs in NPCsInGrid, false otherwise.\n */\nexport const isAGridStateStat = (stat) => {\n  const NPCsInGridStats = new Set([\n    \"damage\",\n    \"armorclass\",\n    \"hp\",\n    \"maxhp\",\n    \"attackbonus\",\n    \"attackrange\",\n    \"speed\",\n    \"iscamping\",\n    \"isinboat\",\n  ]);\n\n  return NPCsInGridStats.has(stat);\n};\n\nexport const handlePlayerDeath = async (\n  player,\n  setCurrentPlayer,\n  setGridId,\n  setGrid,\n  setResources,\n  setTileTypes,\n  TILE_SIZE,\n  updateStatus,\n  setModalContent,\n  setIsModalOpen,\n  closeAllPanels,\n  offerRevival = true\n\n) => {\n  console.log(' Handling player death for', player.username);\n\n  try {\n    // Find the town grid in the player's home settlement\n    console.log(' Finding town grid for death respawn in settlement:', player.settlementId);\n    const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${player.settlementId}`);\n    const settlement = settlementResponse.data;\n\n    if (!settlement || !settlement.grids) {\n      console.error(' Could not find settlement for death respawn');\n      return;\n    }\n\n    // Find the town grid in this settlement\n    const townGrid = settlement.grids.flat().find((grid) => grid.gridType === \"town\" && grid.gridId);\n    if (!townGrid) {\n      console.error(' Could not find town grid in settlement for death respawn');\n      return;\n    }\n\n    console.log(' Found town grid for respawn:', townGrid.gridId);\n\n    // Fetch the Signpost Home position from the town grid (same as Town button logic)\n    const signpostPosition = await fetchTownSignpostPosition(townGrid.gridId);\n\n    // Determine respawn grid and coordinates - respawn at town, not homestead\n    const targetLocation = {\n      x: signpostPosition.x,\n      y: signpostPosition.y,\n      g: townGrid.gridId,\n      s: player.settlementId,\n      f: player.location.f, // Preserve frontier\n      gtype: \"town\",\n      gridCoord: townGrid.gridCoord,\n    };\n    // Preserve other location fields (frontier, settlement, gtype)\n    const updatedLocation = {\n      ...player.location,\n      ...targetLocation,\n    };\n\n    // Determine restored HP based on account status\n    let restoredHp = 40;\n    if (player.accountStatus === \"Gold\") {\n      restoredHp = Math.floor(player.baseMaxhp / 2); // use baseMaxhp or maxHp as appropriate\n    }\n    \n    // Calculate proper maxHP from base stats and equipment (don't let it get corrupted)\n    const properMaxHp = (player.baseMaxhp || 990) + (player.maxhpModifier || 0);\n    \n    console.log(` [HP DEBUG] Death recovery for ${player.username}:`);\n    console.log('  player.baseMaxhp:', player.baseMaxhp);\n    console.log('  player.maxhp (before):', player.maxhp);\n    console.log('  properMaxHp (calculated):', properMaxHp);\n    console.log('  restoredHp:', restoredHp);\n    \n    // Keep only Tent and Boat items in backpack, discard everything else\n    const filteredBackpack = player.backpack.filter((item) => item.type === \"Tent\" || item.type === \"Boat\");\n    const originalLocation = { ...player.location }; //  preserve the correct fromLocation\n    \n    // Create updated player object with restored HP and proper maxHP\n    const updatedPlayer = {\n      ...player,\n      hp: restoredHp,\n      maxhp: properMaxHp,  // Ensure maxHP is not corrupted\n      backpack: filteredBackpack,\n      location: updatedLocation,\n    };\n\n    // 1. **Update Player Data in the Database**\n    await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: player._id,\n      updates: {\n        backpack: filteredBackpack,  // Backpack now only contains Tent and Boat\n        hp: restoredHp,  // Use restored HP value\n        maxhp: properMaxHp,  // Ensure maxHP is preserved in database\n        location: updatedLocation,  // Update location\n        settings: player.settings,\n      },\n    });\n    setCurrentPlayer(updatedPlayer);\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n\n    // REMOVED: Don't update PlayersInGrid here - let changePlayerLocation handle the cleanup\n    // The player is dead and about to be moved, so we shouldn't update their HP in the current grid\n\n    console.log(`Player ${player.username} will be teleported to town grid with ${restoredHp} HP.`);\n    console.log(' Player before changePlayerLocation:', JSON.stringify(updatedPlayer, null, 2));\n\n    // 4. **Load New Grid & Add Player to GridState**\n    await changePlayerLocation(\n      updatedPlayer,\n      originalLocation,   // fromLocation\n      updatedLocation,   // toLocation\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      TILE_SIZE,\n      closeAllPanels,\n      updateStatus,\n      null, // bulkOperationContext not available\n      null, // masterResources not available\n      null, // strings not available\n      null  // masterTrophies not available\n    );\n\n    // 5. **Ensure HP is properly set in the grid state after teleportation**\n    console.log(` Ensuring player HP is set to ${restoredHp} in grid state`);\n    const playersInGridManager = await import('../GridState/PlayersInGrid').then(m => m.default);\n    await playersInGridManager.updatePC(townGrid.gridId, updatedPlayer._id, { hp: restoredHp });\n    \n    // Also ensure the currentPlayer state reflects the restored HP\n    setCurrentPlayer(prevPlayer => ({\n      ...prevPlayer,\n      hp: restoredHp\n    }));\n\n  } catch (error) {\n    console.error('Error during player death handling and teleportation:', error);\n  }\n};\n","import React, { useState } from 'react';\nimport './ChangeIconModal.css';\nimport '../Buttons/SharedButtons.css';\nimport { updatePlayerIcon } from '../../Authentication/ChangeIcon';\nimport ICON_OPTIONS from '../../Authentication/PlayerIcons.json';\nimport { handlePurchase } from '../../Store/Store';\nimport { useStrings } from '../StringsContext';\n\nexport default function ChangeIconModal({ currentPlayer, setCurrentPlayer, updateStatus, currentIcon, playerId, onClose, onSave, setModalContent, setModalIsOpen  }) {\n  const [selectedIcon, setSelectedIcon] = useState(currentIcon);\n  const strings = useStrings();\n  \n  const handleSave = async () => {\n    try {\n      // Save the emoji label instead of the ID\n      await updatePlayerIcon(currentPlayer, setCurrentPlayer, playerId, selectedIcon);\n      onSave(selectedIcon);\n    } catch (err) {\n      alert(\"Failed to update icon.\");\n    }\n  };\n\n  // Determine gold status\n  const isGold = currentPlayer.accountStatus === 'Gold';\n\n  // Split icons into free and paid\n  const freeIcons = ICON_OPTIONS.free || [];\n  const paidIcons = ICON_OPTIONS.paid || [];\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-container modal-medium\">\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        <div className=\"modal-title\">Choose Your Avatar</div>\n\n        <br />\n\n        <div className=\"icon-grid\">\n          {freeIcons.map(icon => (\n            <button\n              key={icon.value}\n              className={`icon-button ${selectedIcon === icon.value ? 'selected' : ''}`}\n              onClick={() => setSelectedIcon(icon.value)}\n              disabled={false}\n            >\n              {icon.value}\n            </button>\n          ))}\n        </div>\n\n        <h3>Premium Avatars</h3>\n\n        {!isGold && (\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-modal btn-gold\" style={{ width: '240px' }} onClick={() => handlePurchase(1, currentPlayer, updateStatus)}>Unlock Premium Avatars</button>\n          </div>\n        )}\n\n        <div className=\"icon-grid\">\n          {paidIcons.map(icon => {\n            const locked = !isGold;\n            return (\n              <button\n                key={icon.value}\n                className={`icon-button ${selectedIcon === icon.value ? 'selected' : ''} ${locked ? 'locked' : ''}`}\n                disabled={locked}\n                onClick={() => {\n                  if (!locked) setSelectedIcon(icon.value);\n                }}\n              >\n                {icon.value}\n              </button>\n            );\n          })}\n        </div>\n\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-modal\" onClick={handleSave}>Save</button>\n        </div>\n      </div>\n    </div>\n  );\n}","import axios from 'axios';\nimport API_BASE from '../config';\nimport playersInGridManager from '../GridState/PlayersInGrid';\n\nexport const updatePlayerIcon = async (currentPlayer, setCurrentPlayer, playerId, icon, updateStatus) => {\n\n    //  Validate that the icon is a proper emoji\n    const isEmoji = (icon) => {\n      return typeof icon === 'string' && /\\p{Emoji}/u.test(icon);\n    };\n\n    if (!isEmoji(icon)) {\n        console.error(' Attempted to set non-emoji icon:', icon);\n        updateStatus?.(\"Please select a valid emoji.\");\n        return;\n    }\n\n    const updates = { icon };\n\n    const res = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates\n    });\n    if (!res.data.success) {\n        throw new Error('Failed to update icon');\n    }\n\n    //  Proceed only if DB update was successful\n    const gridId = currentPlayer?.location?.g;\n    if (gridId) {\n        const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n        if (playerData) {\n            const updatedPlayerData = {\n                ...playerData,\n                icon: icon,\n            };\n            playersInGridManager.updatePC(gridId, currentPlayer.playerId, updatedPlayerData);\n            console.log(` Updated icon in playersInGrid: ${currentPlayer.playerId}  ${icon}`);\n        }\n    } else {\n        console.warn(\" No valid gridId found, skipping NPCsInGrid update.\");\n    }\n\n    const updatedCurrentPlayer = { ...currentPlayer, icon };\n    localStorage.setItem('player', JSON.stringify(updatedCurrentPlayer));\n    setCurrentPlayer(updatedCurrentPlayer); //  Trigger React state update\n    console.log(' Updated localStorage and state for currentPlayer:', icon);\n\n  return res.data.player;\n};","import React from 'react';\nimport Modal from './Modal';\nimport { useStrings } from '../StringsContext';\nimport '../Buttons/SharedButtons.css';\nimport './Modal.css';\n\nfunction GoldPassBenefitsModal({ isOpen, onClose }) {\n  const strings = useStrings();\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[10131] || \"Gold Pass Benefits\"} size=\"medium\">\n      <div style={{\n        textAlign: 'left',\n        padding: '0 10px',\n        fontFamily: 'var(--font-text-1-family)',\n        fontSize: 'var(--font-text-1-size)',\n        color: 'var(--font-text-1-color)',\n      }}>\n        <h3 style={{\n          textAlign: 'center',\n          marginBottom: '16px',\n          fontFamily: 'var(--font-title-3-family)',\n          fontSize: 'var(--font-title-3-size)',\n          fontWeight: 'var(--font-title-3-weight)',\n          color: 'var(--font-title-3-color)',\n        }}>\n          {strings[9050]}\n        </h3>\n        <p style={{ marginBottom: '8px' }}>{strings[9051]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9052]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9053]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9054]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9055]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9056]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9057]}</p>\n        <p style={{ marginBottom: '8px' }}>{strings[9058]}</p>\n      </div>\n\n      <div className=\"modal-buttons shared-buttons\">\n        <button className=\"btn-basic btn-success btn-modal\" onClick={onClose}>\n          OK\n        </button>\n      </div>\n    </Modal>\n  );\n}\n\nexport default GoldPassBenefitsModal;\n","import API_BASE from './config';\nimport axios from 'axios';\n\n/**\n * Update player settings both locally and on the server.\n */\nexport async function updatePlayerSettings(newSettings, currentPlayer, setCurrentPlayer) {\n  try {\n    // Prepare payload - merge with existing settings to preserve equippedWeapon/equippedArmor\n    const updatedPlayer = {\n      ...currentPlayer,\n      settings: { ...currentPlayer.settings, ...newSettings }, // Merge with existing settings\n    };\n\n    // Save to local storage first for immediate responsiveness\n    localStorage.setItem('player', JSON.stringify(updatedPlayer));\n    setCurrentPlayer(updatedPlayer);\n\n    // Send update to server using dot notation to preserve existing settings\n    const updates = {};\n    Object.keys(newSettings).forEach(key => {\n      updates[`settings.${key}`] = newSettings[key];\n    });\n\n    // Use _id for findByIdAndUpdate, fall back to playerId for compatibility\n    const playerIdForServer = currentPlayer._id || currentPlayer.playerId;\n\n    const response = await axios.post(`${API_BASE}/api/update-profile`, {\n      playerId: playerIdForServer,\n      updates\n    });\n\n    if (response.data.success) {\n      console.log('Settings updated successfully on server.');\n    } else {\n      console.error('Server update failed:', response.data.error);\n    }\n  } catch (error) {\n    console.error('Error updating player settings:', error);\n  }\n}","import React, { createContext, useContext, useState } from 'react';\n\n// Create a context\nconst ModalContext = createContext();\n\n// Hook to use context\nexport const useModalContext = () => useContext(ModalContext);\n\n// Provider to wrap the app\nexport const ModalProvider = ({ children, custom }) => {\n  const [activeModal, setActiveModal] = useState(null);\n\n  const openModal = (modalName) => {\n    console.log(`Opening modal: ${modalName}`);\n    setActiveModal(modalName);\n  };\n\n  const closeModal = () => {\n    setActiveModal(null);\n  };\n\n  return (\n    <ModalContext.Provider value={{ activeModal, setActiveModal, openModal, closeModal }}>\n      {children}\n      {custom}\n    </ModalContext.Provider>\n  );\n};\n","import API_BASE from '../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport ChangeIconModal from '../UI/Modals/ChangeIconModal';\nimport GoldPassBenefitsModal from '../UI/Modals/GoldPassBenefitsModal';\nimport axios from 'axios';\nimport '../UI/Panels/Panel.css'; // Use the standardized styles\nimport '../UI/Buttons/SharedButtons.css'; // Use the standardized buttons\nimport Panel from '../UI/Panels/Panel';\nimport { updatePlayerSettings } from '../settings';  \nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { StatusBarContext } from '../UI/StatusBar/StatusBar';\nimport LANGUAGE_OPTIONS from '../UI/Languages.json';\nimport { useModalContext } from '../UI/ModalContext';\nimport { useStrings } from '../UI/StringsContext';\n\nconst ProfilePanel = ({ onClose, currentPlayer, setCurrentPlayer, handleLogout, isRelocating, setIsRelocating, zoomLevel, setZoomLevel, handlePCClick, isDeveloper }) => {\n  const strings = useStrings();\n\n  const [showChangeIconModal, setShowChangeIconModal] = useState(false);\n  const [showGoldBenefitsModal, setShowGoldBenefitsModal] = useState(false);\n\n  const [formData, setFormData] = useState({\n    username: '',\n    icon: '',\n    password: '',\n    accountStatus: 'Free',\n    role: 'Citizen',\n  });\n\n  const { updateStatus } = useContext(StatusBarContext);\n  const [isSaving, setIsSaving] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  // Local settings to track changes independently\n  const [localSettings, setLocalSettings] = useState({\n    isStateMachineEnabled: false,\n    isTeleportEnabled: false,\n    toggleVFX: true,\n    seasonOverride: 'None',\n  });\n\n  // Initialize form fields and local settings\n  useEffect(() => {\n    if (currentPlayer) {\n      const { settings } = currentPlayer;\n      setLocalSettings({\n        isStateMachineEnabled: settings?.isStateMachineEnabled ?? false,\n        isTeleportEnabled: settings?.isTeleportEnabled ?? false,\n        toggleVFX: settings?.toggleVFX ?? true,\n        rangeOn: settings?.rangeOn ?? true,\n        seasonOverride: settings?.seasonOverride ?? 'None',\n      });\n  \n      setFormData({\n        username: currentPlayer.username || '',\n        icon: currentPlayer.icon || '',\n        password: '',\n        accountStatus: currentPlayer.accountStatus || 'Free',\n        role: currentPlayer.role || 'Citizen',\n      });\n  \n      setErrorMessage('');\n\n      console.log('Profile: curentPlayer = ',currentPlayer);\n    }\n  }, [currentPlayer]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: value,\n    }));\n  };\n\n  const handleToggleChange = (key) => {\n    setLocalSettings((prev) => {\n      const updatedSettings = {\n        ...prev,\n        [key]: !prev[key],\n      };\n\n      //  Call the centralized function to update local and server settings\n      updatePlayerSettings(updatedSettings, currentPlayer, setCurrentPlayer);\n      return updatedSettings;\n    });\n  };\n\n  const { setActiveModal } = useModalContext();\n\n  const handleLanguage = () => {\n    setActiveModal('LanguagePicker');\n  };\n\n  const handleSave = async () => {\n    setIsSaving(true);\n    setErrorMessage('');\n  \n    try {\n      // Validate username and icon inputs\n      if (!formData.username.trim()) {\n        throw new Error('Username cannot be empty.');\n      }\n  \n      // Prepare updates payload\n      const updates = {\n        username: formData.username.trim(),\n        icon: formData.icon.trim(),\n        ...(formData.password && { password: formData.password }),\n        accountStatus: formData.accountStatus,\n        role: formData.role,\n        // Use dot notation to update specific settings fields without replacing the entire object\n        \"settings.isStateMachineEnabled\": localSettings.isStateMachineEnabled,\n        \"settings.isTeleportEnabled\": localSettings.isTeleportEnabled,\n        \"settings.toggleVFX\": localSettings.toggleVFX,\n        \"settings.seasonOverride\": localSettings.seasonOverride,\n        \"settings.rangeOn\": localSettings.rangeOn,\n      };\n  \n      console.log('Saving updates:', updates);\n  \n      // Call API to update the player profile\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates,\n      });\n  \n      if (response.data.success) {\n        console.log('Profile and settings successfully updated:', response.data.player);\n\n        //  Update the React state\n        const updatedPlayer = {\n          ...currentPlayer,\n          settings: { ...currentPlayer.settings, ...localSettings },\n          username: formData.username.trim(),\n          icon: formData.icon.trim(),\n          accountStatus: formData.accountStatus,\n          role: formData.role,\n        };\n\n        setCurrentPlayer(updatedPlayer);\n        localStorage.setItem('player', JSON.stringify(updatedPlayer));\n        console.log('Updated localStorage after save:', updatedPlayer.settings);\n\n        //  Update the Settlement with the player's new role (only if it's not Citizen)\n        if (formData.role && formData.role !== 'Citizen') {\n          console.log(` Assigning player to role \"${formData.role}\" in the settlement...`);\n          \n          await axios.post(`${API_BASE}/api/update-settlement-role`, {\n            settlementId: currentPlayer.location.s, //  Settlement ID\n            playerId: currentPlayer._id,           //  Player's ID\n            roleName: formData.role                //  Role they are assigned to\n          });\n        }\n\n        //  Directly update playersInGrid via playersInGridManager\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n            const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n            if (playerData) {\n                const updatedPlayerData = {\n                    ...playerData,\n                    username: formData.username.trim(),\n                };\n\n                playersInGridManager.updatePC(gridId, currentPlayer.playerId, updatedPlayerData);\n\n                console.log(` Updated username in playersInGrid: ${currentPlayer.playerId}  ${formData.username.trim()}`);\n            }\n        } else {\n            console.warn(\" No valid gridId found, skipping NPCsInGrid update.\");\n        }\n\n        // Notify success and close panel\n        onClose();\n      } else {\n        const errorMessage = response.data.error || 'Failed to update profile.';\n        console.error(errorMessage);\n        setErrorMessage(errorMessage);\n      }\n    } catch (error) {\n      console.error('Error during save operation:', error);\n      //  Check if the error message contains \"TAKEN\"\n      if (error.response?.data?.error === \"TAKEN\") {\n        console.log(\" Username is already taken.\");\n        updateStatus(50); \n      }\n      setErrorMessage(error.message || 'An unexpected error occurred while saving.');\n    } finally {\n      setIsSaving(false);\n    }\n};\n\n\n  const handleRelocation = async () => {\n    if (isRelocating) {\n      setIsRelocating(false);\n      setZoomLevel('close');\n      updateStatus(0);\n    } else {\n      setIsRelocating(true);\n      setZoomLevel('frontier');\n    }\n  };\n\n\n\n\n\n\n  \n  return (\n    <Panel\n      onClose={() => {\n        setIsRelocating(false);\n        if (zoomLevel === 'settlement' || zoomLevel === 'frontier') {\n          setZoomLevel('close');\n          updateStatus(0);\n        }\n        onClose();\n      }}\n      titleKey=\"1119\"\n      panelName=\"ProfilePanel\"\n    >\n      <div className=\"standard-panel\">\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={() => {\n            onClose();\n            setTimeout(() => {\n              // Create PC data structure for current player to pass to SocialPanel\n              const currentPC = {\n                playerId: currentPlayer._id,\n                username: currentPlayer.username,\n                icon: currentPlayer.icon,\n                hp: currentPlayer.hp || 100,\n                position: { x: 0, y: 0 }, // Position not needed for own profile\n                iscamping: currentPlayer.iscamping,\n                isinboat: currentPlayer.isinboat\n              };\n              handlePCClick(currentPC);\n            }, 0);\n          }}>\n            Go to Player Character\n          </button>\n        </div>\n\n        <br />\n\n        <h3>{strings[4054]}</h3>\n\n        {/* User Details Form */}\n        <div className=\"form-group\">\n          <label>{strings[4052]}</label>\n          <input\n            name=\"username\"\n            type=\"text\"\n            value={formData.username}\n            onChange={handleInputChange}\n            placeholder=\"Enter your username\"\n          />\n        </div>\n        <div className=\"form-group\">\n          <label>{strings[4053]}</label>\n          <input\n            name=\"password\"\n            type=\"password\"\n            value={formData.password}\n            onChange={handleInputChange}\n            placeholder=\"Enter new password (optional)\"\n          />\n        </div>\n\n        <br />\n\n        {isDeveloper && (\n          <div className=\"form-group\">\n            <label>{strings[4055]}</label>\n            <select name=\"accountStatus\" value={formData.accountStatus} onChange={handleInputChange}>\n              <option value=\"Free\">Free</option>\n              <option value=\"Bronze\">Bronze</option>\n              <option value=\"Silver\">Silver</option>\n              <option value=\"Gold\">Gold</option>\n            </select>\n          </div>\n        )}\n        \n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleSave} disabled={isSaving}>\n            {isSaving ? 'Saving...' : strings[10128]}\n          </button>\n        </div>\n\n        <br />\n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-gold\" onClick={() => setShowGoldBenefitsModal(true)}>\n            {formData.accountStatus === 'Gold' ? strings[10130] : strings[10131]}\n          </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-danger\" onClick={handleLogout}>\n            {strings[4056]}\n          </button>\n        </div>\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const confirmed = window.confirm(\"Are you sure you want to delete your account? This action cannot be undone.\");\n              if (!confirmed) return;\n\n              try {\n                const response = await axios.post(`${API_BASE}/api/delete-player`, {\n                  playerId: currentPlayer.playerId,\n                });\n\n                if (response.data.success) {\n                  alert(\"Account deleted successfully.\");\n                  localStorage.removeItem('player');\n                  window.location.reload();\n                } else {\n                  alert(\"Failed to delete account.\");\n                }\n              } catch (err) {\n                console.error(\"Error deleting account:\", err);\n                alert(\"An error occurred while trying to delete your account.\");\n              }\n            }}\n          >\n            {strings[4057]}\n          </button>\n        </div>\n        <p>{strings[4058]} {currentPlayer?.playerId || 'N/A'}</p>\n        <p>Home Settlement ID: {currentPlayer?.settlementId || 'N/A'}</p>\n\n        <br/>\n\n\n        {/* Relocation Controls */}\n\n        <h3>{strings[4059]}</h3>\n        <p>{strings[4060]} <strong>{currentPlayer.relocations}</strong></p>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleRelocation} disabled={!currentPlayer.relocations}>\n            {isRelocating ? strings[10132] : strings[10133]}\n          </button>\n        </div>\n        <p>{strings[4061]}</p>\n\n\n        {/* Settings Toggles */}\n\n        <h3>{strings[4062]}</h3>\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleLanguage}>\n             {LANGUAGE_OPTIONS.find(l => l.code === currentPlayer.language)?.label || 'Language'}\n          </button>\n        </div>\n\n        <div className=\"shared-buttons\">\n          <button\n            className={`btn-basic ${localSettings.rangeOn ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => handleToggleChange('rangeOn')}\n          >\n            {strings[4064]}{localSettings.rangeOn ? 'is ON' : 'is OFF'}\n          </button>\n        </div>\n\n        {isDeveloper && (\n          <div className=\"shared-buttons\">\n            <button\n              className={`btn-basic ${localSettings.isTeleportEnabled ? 'btn-success' : 'btn-neutral'}`}\n              onClick={() => handleToggleChange('isTeleportEnabled')}\n            >\n              Teleport: {localSettings.isTeleportEnabled ? 'is ON' : 'is OFF'}\n            </button>\n          </div>\n        )}\n\n        <div className=\"shared-buttons\">\n          <button\n            className={`btn-basic ${localSettings.toggleVFX ? 'btn-success' : 'btn-neutral'}`}\n            onClick={() => handleToggleChange('toggleVFX')}\n          >\n            VFX: {localSettings.toggleVFX ? 'is ON' : 'is OFF'}\n          </button>\n        </div>\n\n        {isDeveloper && (\n          <>\n            <h4>Season Override</h4>\n            <div className=\"season-override-options\">\n              <label style={{ display: 'block', marginBottom: '10px' }}>\n                <input\n                  type=\"radio\"\n                  name=\"seasonOverride\"\n                  value=\"None\"\n                  checked={localSettings.seasonOverride === 'None'}\n                  onChange={() => {\n                    setLocalSettings(prev => ({\n                      ...prev,\n                      seasonOverride: 'None'\n                    }));\n                    updatePlayerSettings({ ...localSettings, seasonOverride: 'None' }, currentPlayer, setCurrentPlayer);\n                  }}\n                />\n                None (Use current season)\n              </label>\n              <label style={{ display: 'block', marginBottom: '10px' }}>\n                <input\n                  type=\"radio\"\n                  name=\"seasonOverride\"\n                  value=\"Spring\"\n                  checked={localSettings.seasonOverride === 'Spring'}\n                  onChange={() => {\n                    setLocalSettings(prev => ({\n                      ...prev,\n                      seasonOverride: 'Spring'\n                    }));\n                    updatePlayerSettings({ ...localSettings, seasonOverride: 'Spring' }, currentPlayer, setCurrentPlayer);\n                    setTimeout(() => window.location.reload(), 500);\n                  }}\n                />\n                Spring \n              </label>\n              <label style={{ display: 'block', marginBottom: '10px' }}>\n                <input\n                  type=\"radio\"\n                  name=\"seasonOverride\"\n                  value=\"Summer\"\n                  checked={localSettings.seasonOverride === 'Summer'}\n                  onChange={() => {\n                    setLocalSettings(prev => ({\n                      ...prev,\n                      seasonOverride: 'Summer'\n                    }));\n                    updatePlayerSettings({ ...localSettings, seasonOverride: 'Summer' }, currentPlayer, setCurrentPlayer);\n                    setTimeout(() => window.location.reload(), 500);\n                  }}\n                />\n                Summer \n              </label>\n              <label style={{ display: 'block', marginBottom: '10px' }}>\n                <input\n                  type=\"radio\"\n                  name=\"seasonOverride\"\n                  value=\"Fall\"\n                  checked={localSettings.seasonOverride === 'Fall'}\n                  onChange={() => {\n                    setLocalSettings(prev => ({\n                      ...prev,\n                      seasonOverride: 'Fall'\n                    }));\n                    updatePlayerSettings({ ...localSettings, seasonOverride: 'Fall' }, currentPlayer, setCurrentPlayer);\n                    setTimeout(() => window.location.reload(), 500);\n                  }}\n                />\n                Fall \n              </label>\n              <label style={{ display: 'block', marginBottom: '10px' }}>\n                <input\n                  type=\"radio\"\n                  name=\"seasonOverride\"\n                  value=\"Winter\"\n                  checked={localSettings.seasonOverride === 'Winter'}\n                  onChange={() => {\n                    setLocalSettings(prev => ({\n                      ...prev,\n                      seasonOverride: 'Winter'\n                    }));\n                    updatePlayerSettings({ ...localSettings, seasonOverride: 'Winter' }, currentPlayer, setCurrentPlayer);\n                    setTimeout(() => window.location.reload(), 500);\n                  }}\n                />\n                Winter \n              </label>\n            </div>\n          </>\n        )}\n\n        {showChangeIconModal && (\n          <ChangeIconModal\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            updateStatus={updateStatus}\n            currentIcon={formData.icon}\n            playerId={currentPlayer.playerId}\n            onClose={() => setShowChangeIconModal(false)}\n            onSave={(newIcon) => {\n              setFormData(prev => ({ ...prev, icon: newIcon }));\n              setShowChangeIconModal(false);\n            }}\n          />\n        )}\n\n        <GoldPassBenefitsModal\n          isOpen={showGoldBenefitsModal}\n          onClose={() => setShowGoldBenefitsModal(false)}\n        />\n      </div>\n    </Panel>\n    \n  );\n};\n\nexport default ProfilePanel;","/**\n * Conversion Tracking Utility\n * Handles conversion events for various advertising platforms\n */\n\n// Google Analytics 4 Event\nexport const trackGoogleAccountCreation = (username, userId) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'sign_up', {\n      method: 'email',\n      value: 1,\n      currency: 'USD',\n      user_id: userId,\n      custom_parameters: {\n        username: username\n      }\n    });\n    \n    // Google Ads will automatically import this conversion from GA4\n    // No need for separate Google Ads conversion tracking when using GA4\n  }\n};\n\n// Reddit Pixel Event\nexport const trackRedditAccountCreation = (userId) => {\n  if (typeof window.rdt !== 'undefined') {\n    // Reddit's SignUp event doesn't accept custom parameters\n    window.rdt('track', 'SignUp');\n  }\n};\n\n// Facebook/Meta Pixel Event\nexport const trackFacebookAccountCreation = (username, userId) => {\n  if (typeof window.fbq !== 'undefined') {\n    window.fbq('track', 'CompleteRegistration', {\n      value: 1.00,\n      currency: 'USD',\n      content_name: 'game_account',\n      status: true,\n      user_id: userId\n    });\n  }\n};\n\n// TikTok Pixel Event\nexport const trackTikTokAccountCreation = (userId) => {\n  if (typeof window.ttq !== 'undefined') {\n    window.ttq.track('CompleteRegistration', {\n      value: 1.00,\n      currency: 'USD',\n      content_id: userId\n    });\n  }\n};\n\n// Master function to track across all platforms\nexport const trackAccountCreation = (username, userId) => {\n  console.log(' Tracking account creation for:', username, userId);\n  \n  // Track on all platforms\n  trackGoogleAccountCreation(username, userId);\n  trackRedditAccountCreation(userId);\n  trackFacebookAccountCreation(username, userId);\n  trackTikTokAccountCreation(userId);\n  \n  // You can add more platforms here as needed\n};\n\n// Track other important events\nexport const trackTutorialComplete = (userId) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'tutorial_complete', {\n      user_id: userId\n    });\n  }\n  \n  if (typeof window.rdt !== 'undefined') {\n    window.rdt('track', 'Custom', {\n      customEventName: 'TutorialComplete'\n    });\n  }\n};\n\nexport const trackFirstPurchase = (userId, value) => {\n  if (typeof window.gtag !== 'undefined') {\n    window.gtag('event', 'purchase', {\n      value: value,\n      currency: 'USD',\n      user_id: userId,\n      items: [{\n        item_name: 'in_game_purchase',\n        price: value,\n        quantity: 1\n      }]\n    });\n  }\n  \n  if (typeof window.fbq !== 'undefined') {\n    window.fbq('track', 'Purchase', {\n      value: value,\n      currency: 'USD',\n      user_id: userId\n    });\n  }\n};","import API_BASE from '../config';\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport NPCsInGridManager from '../GridState/GridStateNPCs';\nimport { useStrings } from '../UI/StringsContext';\nimport LANGUAGE_OPTIONS from '../UI/Languages.json';\nimport { enabledLanguages } from '../UI/Modals/LanguagePickerModal';\nimport '../UI/Buttons/SharedButtons.css';\nimport './Authentication.css';\nimport { trackAccountCreation } from '../Utils/conversionTracking';\n\n// Detect browser type from userAgent\nconst getBrowserType = () => {\n  const userAgent = navigator.userAgent;\n  if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) return 'Chrome';\n  if (userAgent.includes('Firefox')) return 'Firefox';\n  if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) return 'Safari';\n  if (userAgent.includes('Edg')) return 'Edge';\n  if (userAgent.includes('Opera') || userAgent.includes('OPR')) return 'Opera';\n  return 'Unknown';\n};\n\n// Detect OS type and version from userAgent\nconst getOSType = () => {\n  const userAgent = navigator.userAgent;\n\n  // Windows: \"Windows NT 10.0\" -> \"Windows 10\" (NT 10.0 = Win 10/11, 6.3 = 8.1, 6.1 = 7)\n  const windowsMatch = userAgent.match(/Windows NT (\\d+\\.\\d+)/);\n  if (windowsMatch) {\n    const ntVersion = windowsMatch[1];\n    const versionMap = { '10.0': '10/11', '6.3': '8.1', '6.2': '8', '6.1': '7', '6.0': 'Vista', '5.1': 'XP' };\n    return `Windows ${versionMap[ntVersion] || ntVersion}`;\n  }\n\n  // macOS: \"Mac OS X 10_15_7\" or \"Mac OS X 10.15.7\"\n  const macMatch = userAgent.match(/Mac OS X (\\d+[._]\\d+(?:[._]\\d+)?)/);\n  if (macMatch) {\n    return `MacOS ${macMatch[1].replace(/_/g, '.')}`;\n  }\n\n  // iOS: \"iPhone OS 15_0\" or \"CPU OS 15_0\"\n  const iosMatch = userAgent.match(/(?:iPhone|iPad|iPod).*?OS (\\d+[._]\\d+)/);\n  if (iosMatch) {\n    return `iOS ${iosMatch[1].replace(/_/g, '.')}`;\n  }\n\n  // Android: \"Android 12\"\n  const androidMatch = userAgent.match(/Android (\\d+(?:\\.\\d+)?)/);\n  if (androidMatch) {\n    return `Android ${androidMatch[1]}`;\n  }\n\n  // Linux (no version typically available)\n  if (userAgent.includes('Linux')) return 'Linux';\n\n  return 'Unknown';\n};\n\n// Gather device and network diagnostics for analytics\nconst getDiagnostics = async () => {\n  // Measure latency with a ping\n  let latency = null;\n  try {\n    const pingStart = performance.now();\n    await axios.get(`${API_BASE}/api/ping`);\n    latency = Math.round(performance.now() - pingStart);\n  } catch {\n    latency = -1; // Failed to measure\n  }\n\n  // Check WebGL support\n  let webglSupported = false;\n  try {\n    const canvas = document.createElement('canvas');\n    webglSupported = !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));\n  } catch {\n    webglSupported = false;\n  }\n\n  return {\n    // Network\n    latency,\n    connectionType: navigator.connection?.effectiveType || null, // '4g', '3g', '2g', 'slow-2g'\n    downlink: navigator.connection?.downlink || null, // Mbps\n\n    // Screen and viewport\n    screenWidth: window.screen?.width || null,\n    screenHeight: window.screen?.height || null,\n    viewportWidth: window.innerWidth || null,\n    viewportHeight: window.innerHeight || null,\n    devicePixelRatio: window.devicePixelRatio || null,\n\n    // Device capabilities\n    deviceMemory: navigator.deviceMemory || null, // GB (Chrome only)\n    hardwareConcurrency: navigator.hardwareConcurrency || null, // CPU cores\n\n    // Platform detection\n    isMobile: /Mobile|Android|iPhone|iPad|iPod/i.test(navigator.userAgent),\n    isTouchDevice: 'ontouchstart' in window || navigator.maxTouchPoints > 0,\n\n    // Rendering capability\n    webglSupported,\n\n    // Timezone\n    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || null,\n  };\n};\n\nconst CreateAccount = ({ setCurrentPlayer, zoomLevel, setZoomLevel, setIsLoggedIn, closeModal }) => {\n  const strings = useStrings();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [language, setLanguage] = useState('en');\n  const [error, setError] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\nconst handleCreateAccount = async (e) => {\n  e.preventDefault();\n  if (isSubmitting) return;\n  setIsSubmitting(true);\n\n  try {\n    const frontierName = 'Valley View 1';\n\n    // 1. Fetch the Frontier by Name\n    const frontierResponse = await axios.get(`${API_BASE}/api/frontiers-by-name`, { params: { name: frontierName } });\n    if (!frontierResponse.data || frontierResponse.data.length === 0) throw new Error('Frontier not found');\n    const frontier = frontierResponse.data[0];\n\n    // 2. Locate an available homestead and town grid in a settlement\n    let assignedSettlementId = null;\n    let homesteadGridCoord = null;\n    let townGridId = null;\n\n    for (const settlementRow of frontier.settlements || []) {\n      for (const settlement of settlementRow) {\n        if (settlement.available !== true) continue;\n\n        const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlement.settlementId}`);\n        const settlementData = settlementResponse.data;\n\n        const flatGrids = settlementData.grids.flat();\n        const availableHomestead = flatGrids.find((grid) => grid.available === true && grid.gridType === 'homestead');\n        const townGrid = flatGrids.find((grid) => grid.gridType === 'town');\n\n        if (availableHomestead && townGrid) {\n          assignedSettlementId = settlement.settlementId;\n          homesteadGridCoord = availableHomestead.gridCoord;\n          townGridId = townGrid.gridId;\n          break;\n        }\n      }\n      if (homesteadGridCoord) break;\n    }\n\n    if (!assignedSettlementId || !homesteadGridCoord || !townGridId) {\n      throw new Error('No available sub-grids in the Frontier.');\n    }\n\n    // 3. Find the Signpost Home position in the town grid\n    let startX = 30;\n    let startY = 33;\n    try {\n      const townGridResponse = await axios.get(`${API_BASE}/api/load-grid/${townGridId}`);\n      const townGridData = townGridResponse.data;\n\n      if (townGridData.resources && Array.isArray(townGridData.resources)) {\n        const signpostHome = townGridData.resources.find(res => res.type === \"Signpost Home\");\n        if (signpostHome) {\n          startX = signpostHome.x;\n          startY = signpostHome.y + 1; // One tile down from the signpost\n          console.log(` Found Signpost Home at (${signpostHome.x}, ${signpostHome.y}), placing new player at (${startX}, ${startY})`);\n        } else {\n          console.warn(' Signpost Home not found in town grid, using default position');\n        }\n      }\n    } catch (err) {\n      console.warn(' Could not load town grid for spawn position, using default:', err.message);\n    }\n\n    // 4. Gather diagnostics (includes latency ping)\n    const diagnostics = await getDiagnostics();\n\n    // 5. Register player using unified endpoint (server will create the homestead grid)\n    const registerPayload = {\n      username,\n      password,\n      language,\n      location: {\n        x: startX,\n        y: startY,\n        gridCoord: homesteadGridCoord,\n        settlementId: assignedSettlementId,\n        frontierId: frontier._id,\n        gtype: 'homestead',\n      },\n      // Tell server the player should start in town\n      startInTown: true,\n      townGridId: townGridId,\n      // Browser and OS detection for analytics\n      browser: getBrowserType(),\n      os: getOSType(),\n      // Device and network diagnostics\n      diagnostics,\n    };\n\n    console.log('Calling /api/register-new-player with payload:', registerPayload);\n    const response = await axios.post(`${API_BASE}/api/register-new-player`, registerPayload);\n    if (!response.data.success || !response.data.player) {\n      throw new Error('Player registration failed');\n    }\n\n    const player = response.data.player;\n\n    // FTUE: Use the server-assigned location (Cave dungeon for first-time users)\n    // The server sets the correct starting location in auth.js\n    console.log(' Player registered with location:', player.location);\n\n    // Track the successful account creation for ad platforms\n    trackAccountCreation(player.username, player._id || player.playerId);\n\n    // 4. Finalize account setup\n    setCurrentPlayer(player);\n    localStorage.removeItem('player');\n    localStorage.setItem('player', JSON.stringify(player));\n\n    // 5. Save PC to the starting grid (server-assigned location)\n    const startingGridId = player.location.g;\n    const now = Date.now();\n    const newPC = {\n      playerId: player._id,\n      type: 'pc',\n      username: player.username,\n      position: { x: player.location.x, y: player.location.y },\n      icon: player.icon || '',\n      hp: player.baseHp || 25,\n      maxhp: player.baseMaxhp || 25,\n      attackbonus: player.baseAttackbonus || 1,\n      armorclass: player.baseArmorclass || 1,\n      damage: player.baseDamage || 1,\n      attackrange: player.baseAttackrange || 1,\n      speed: player.baseSpeed || 1,\n      iscamping: false,\n      isinboat: false,\n      lastUpdated: now,\n    };\n\n    const payload = {\n      gridId: startingGridId,\n      playerId: player._id,\n      pc: newPC,\n      lastUpdated: now,\n    };\n\n    await axios.post(`${API_BASE}/api/save-single-pc`, payload);\n\n    // Note: Server already set the correct location, no need to update it\n\n    // 7. Send welcome message\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId: player._id,\n        messageId: 1,\n      });\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n    }\n\n    // 8. Close modal and reload\n    if (closeModal) closeModal();\n    localStorage.setItem(\"initialZoomLevel\", \"close\");\n    window.location.reload();\n\n  } catch (err) {\n    console.error('Error during account creation:', err);\n    setError(err.response?.data?.error || 'Account creation failed. Please try again.');\n    setIsSubmitting(false);\n  }\n};\n\nreturn (\n  <div id=\"create-account-form\">\n    <h2>{strings[4002]}</h2>\n    <form onSubmit={handleCreateAccount}>\n      <input\n        type=\"text\"\n        placeholder={strings[4069] || \"Choose Username\"}\n        value={username}\n        onChange={(e) => setUsername(e.target.value)}\n      />\n      <input\n        type=\"password\"\n        placeholder={strings[4070] || \"Select a Password\"}\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n      />\n      <select\n        value={language}\n        onChange={(e) => setLanguage(e.target.value)}\n      >\n        <option value=\"\">{strings[4067]}</option>\n        {LANGUAGE_OPTIONS\n          .filter(({ code }) => enabledLanguages.includes(code))\n          .map(({ code, label }) => (\n            <option key={code} value={code}>\n              {label}\n            </option>\n          ))}\n      </select>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" type=\"submit\" disabled={isSubmitting}>\n          {strings[4068] || \"Begin!\"}\n        </button>\n      </div>\n    </form>\n\n    <div className=\"shared-buttons\">\n      <button className=\"btn-basic btn-neutral\"\n        type=\"button\"\n        onClick={() => setIsLoggedIn(false)}\n      >\n        {strings[4066]}\n      </button>\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n      </div>\n\n      <p> <strong>{strings[4004]}</strong></p>\n    </div>\n    \n  );\n};\n\nexport default CreateAccount;","import API_BASE from '../config';\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../UI/Panels/Panel';\nimport CreateAccount from './CreateAccount';\nimport '../UI/Panels/Panel.css';\nimport '../UI/Buttons/SharedButtons.css';\nimport './Authentication.css';\n\nimport { useStrings } from '../UI/StringsContext';\n\nconst LoginPanel = ({ onClose, setCurrentPlayer, zoomLevel, setZoomLevel, onLoginSuccess }) => {\n  const strings = useStrings();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [showCreateAccount, setShowCreateAccount] = useState(false);\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    try {\n      console.log('Login attempt:', { username, password });\n\n      const response = await axios.post(`${API_BASE}/api/login`, { username, password });\n      if (response.data.success) {\n        const player = response.data.player;\n        console.log('Login successful:', player);\n\n        setCurrentPlayer(player); // Set player data\n        localStorage.setItem('player', JSON.stringify(player)); // Store in local storage\n        onClose(); // Close panel\n\n        if (onLoginSuccess) {\n          onLoginSuccess(player); // Notify parent component\n        }\n      } else {\n        setError(response.data.error || 'Invalid username or password');\n      }\n    } catch (err) {\n      console.error('Error during login:', err);\n      setError('Login failed. Please try again.');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1021\" titleKey=\"1121\" panelName=\"LoginPanel\">\n      {showCreateAccount ? (\n        <CreateAccount\n          setCurrentPlayer={setCurrentPlayer}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel}\n          setIsLoggedIn={() => {\n            setShowCreateAccount(false);\n            onClose();\n          }}\n        />\n      ) : (\n        <div className=\"standard-panel\">\n\n            <div className=\"shared-buttons\">\n            <h3>{strings[4001]}</h3>\n              <button\n                type=\"button\"\n                className=\"btn-basic btn-success\"\n                onClick={() => setShowCreateAccount(true)}\n              >\n                {strings[4002]}\n              </button>\n            </div>  \n            <h4>{strings[4004]}</h4>\n            <h4>{strings[4005]}</h4>\n            <h3>{strings[5033]}</h3>\n\n          <div className=\"panel-buffer-space\" />\n            <h3>{strings[4010]}</h3>\n\n            <form onSubmit={handleLogin} className=\"panel-form login-panel-form\">\n            <div className=\"form-group\">\n\n              <input\n                id=\"username\"\n                type=\"text\"\n                className=\"login-form-input\"\n                placeholder={strings[4003] || \"Username\"}\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                required\n              />\n            </div>\n            <div className=\"form-group\">\n              <input\n                id=\"password\"\n                type=\"password\"\n                className=\"login-form-input\"\n                placeholder={strings[4006] || \"Password\"}\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n              />\n            </div>\n            {error && <p className=\"error-message\">{error}</p>}\n\n            <div className=\"shared-buttons\">\n              <button type=\"submit\" className=\"btn-basic btn-neutral\">\n                {strings[4007]}\n              </button>\n            </div>\n          </form>\n          <div className=\"panel-buffer-space\" />\n\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic btn-success\"\n              onClick={() => window.location.href = 'mailto:valleyviewgamedev@gmail.com'}\n            >\n              {strings[97]}\n            </button>\n          </div>\n\n        </div>\n        \n      )}\n    </Panel>\n  );\n};\n\nexport default LoginPanel;\n","// A small component to add to App.js Base Panel for visual debugging\nimport React from 'react';\nimport './GridStateDebug.css';\n\nconst GridStateDebugPanel = ({ gridId, gridCoord, gridType, settlementId, NPCsInGrid, playersInGrid }) => {\n  const formatJSON = (obj) => {\n    try {\n      return JSON.stringify(obj, null, 2);\n    } catch {\n      return '[Unserializable]';\n    }\n  };\n\n  const currentNPCs = NPCsInGrid?.[gridId] || 'Not loaded';\n  const currentPCs = playersInGrid?.[gridId] || 'Not loaded';\n\n  return (\n    <div className=\"grid-debug-panel\">\n      <h4 style={{ color: 'white' }}>Debug:</h4>\n      <br></br>\n      <h5>gridId:</h5>\n      <pre>{formatJSON(gridId)}</pre>\n      <h5>gridCoord: {formatJSON(gridCoord)}</h5>\n      <h5>gridType: {formatJSON(gridType)}</h5>\n      <h5>settlementId: {formatJSON(settlementId)}</h5>\n      <br></br>\n      <h5> NPCsInGrid?[gridId]</h5>\n      <pre>{formatJSON(currentNPCs)}</pre>\n      <h5> PlayersInGrid?[gridId]</h5>\n      <pre>{formatJSON(currentPCs)}</pre>\n    </div>\n  );\n};\n\nexport default GridStateDebugPanel;\n","import API_BASE from '../config'; \nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../UI/Panels/Panel';\nimport '../UI/Panels/Panel.css'; // Specific styles for Debug Panel\nimport '../UI/Buttons/SharedButtons.css'; // Specific styles for Debug Panel\nimport { fetchInventory, refreshPlayerAfterInventoryUpdate } from './InventoryManagement';\nimport { fetchGridData, changePlayerLocation } from './GridManagement';\nimport NPCsInGridManager from '../GridState/GridStateNPCs'; // Use default export for NPCsInGridManager\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport GridStateDebugPanel from './GridStateDebug';\nimport { generateTownGrids, createSingleValleyGrid } from './WorldGeneration';\nimport { updatePlayerSettings } from '../settings';\n\nconst DebugPanel = ({\n  onClose,\n  currentPlayer,\n  setCurrentPlayer,\n  setInventory,\n  setResources,\n  currentGridId,\n  updateStatus,\n  TILE_SIZE,\n  setGrid,\n  setGridId,\n  setTileTypes,\n  closeAllPanels\n}) => {\n  const [timers, setTimers] = useState([]);\n  const [npcs, setNPCs] = useState([]);\n  const [pcs, setPCs] = useState([]);\n  const [updatedNPCs, setUpdatedNPCs] = useState(npcs);\n  const [refreshDebug, setRefreshDebug] = useState(false);\n  const [singleGridCoord, setSingleGridCoord] = useState('');\n  const [toGridCoord, setToGridCoord] = useState('');\n  const [usernameToDelete, setUsernameToDelete] = useState('');\n  const [messageIdentifier, setMessageIdentifier] = useState('');\n  const [orphanedGridId, setOrphanedGridId] = useState('');\n\n  // V2 Tile Renderer toggle - always defaults to V2 (true)\n  const [useV2Tiles, setUseV2Tiles] = useState(() => {\n    const hasExplicitChoice = localStorage.getItem('useV2TilesExplicit') === 'true';\n    if (hasExplicitChoice) {\n      return localStorage.getItem('useV2Tiles') === 'true';\n    }\n    return true; // Default to V2 for all users\n  });\n  \n  // Performance monitoring state\n  const [performanceMetrics, setPerformanceMetrics] = useState({\n    fps: 0,\n    domElementCount: 0,\n    memoryUsage: 0,\n    renderMode: 'Unknown'\n  });\n  \n  // Fetch resources with timers when the panel opens or gridId changes\n  useEffect(() => {\n    if (!currentGridId) return;\n\n    const fetchTimers = async () => {\n        try {\n            console.log('Fetching timers for gridId:', currentGridId);\n            const gridData = await fetchGridData(currentGridId,updateStatus,currentPlayer);\n\n            //  Include both growEnd (Farming) and craftEnd (Crafting)\n            const resourcesWithTimers = (gridData.resources || []).filter(\n                (res) => res.growEnd || res.craftEnd\n            );\n\n            console.log(' Active Timers:', resourcesWithTimers);\n            setTimers(resourcesWithTimers);\n        } catch (error) {\n            console.error('Error fetching timers:', error);\n        }\n    };\n\n    fetchTimers();\n  }, [currentGridId]);\n\n  // Refresh timers periodically\n  useEffect(() => {\n    const timerInterval = setInterval(() => {\n      setTimers((prevTimers) =>\n        prevTimers.map((timer) => {\n          const growTimeRemaining = timer.growEnd ? Math.max(0, Math.floor((timer.growEnd - Date.now()) / 1000)) : null;\n          const craftTimeRemaining = timer.craftEnd ? Math.max(0, Math.floor((timer.craftEnd - Date.now()) / 1000)) : null;\n\n          return {\n            ...timer,\n            remainingTime: growTimeRemaining !== null ? growTimeRemaining : craftTimeRemaining, // Prioritize active timer\n          };\n        })\n      );\n    }, 1000);\n\n    return () => clearInterval(timerInterval);\n  }, []);\n\n  // Fetch NPCs and PCs from GridState\n  useEffect(() => {\n    if (!currentGridId) return;\n\n    const fetchGridStateEntities = () => {\n      const NPCsInGrid = NPCsInGridManager.getNPCsInGrid(currentGridId);\n      const playersInGrid = playersInGridManager.getPlayersInGrid(currentGridId);\n\n      if (!NPCsInGrid) {\n        console.warn(`No NPCsInGrid found for gridId: ${currentGridId}`);\n        setNPCs([]);\n      } else {\n        setNPCs(Object.values(NPCsInGrid.npcs || {}));\n      }\n\n      if (!playersInGrid) {\n        console.warn(`No playersInGrid found for gridId: ${currentGridId}`);\n        setPCs([]);\n      } else {\n        setPCs(Object.values(playersInGrid));\n      }\n    };\n\n    fetchGridStateEntities();\n  }, [currentGridId, refreshDebug]);\n  \n  // Synchronize updatedNPCs with npcs when npcs changes\n  useEffect(() => {\n    setUpdatedNPCs(npcs);\n  }, [npcs]);\n\n  // Performance monitoring useEffect\n  useEffect(() => {\n    let frameCount = 0;\n    let lastTime = performance.now();\n    let animationFrameId;\n\n    const measurePerformance = () => {\n      frameCount++;\n      const currentTime = performance.now();\n      \n      // Calculate FPS every second\n      if (currentTime - lastTime >= 1000) {\n        const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));\n        \n        // Count DOM elements\n        const domElementCount = document.querySelectorAll('*').length;\n        \n        // Detect render mode by checking for canvas vs DOM tiles\n        const hasCanvasTiles = document.querySelector('canvas[style*=\"position: absolute\"]') !== null;\n        const hasDOMTiles = document.querySelector('.tile-g, .tile-s, .tile-d, .tile-w, .tile-l, .tile-p, .tile-n, .tile-o') !== null;\n        let renderMode = 'Unknown';\n        if (hasCanvasTiles && !hasDOMTiles) {\n          renderMode = 'Canvas';\n        } else if (!hasCanvasTiles && hasDOMTiles) {\n          renderMode = 'DOM';\n        } else if (hasCanvasTiles && hasDOMTiles) {\n          renderMode = 'Mixed';\n        }\n        \n        // Get memory usage if available\n        let memoryUsage = 0;\n        if (performance.memory) {\n          memoryUsage = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024); // MB\n        }\n        \n        setPerformanceMetrics({\n          fps,\n          domElementCount,\n          memoryUsage,\n          renderMode\n        });\n        \n        frameCount = 0;\n        lastTime = currentTime;\n      }\n      \n      animationFrameId = requestAnimationFrame(measurePerformance);\n    };\n    \n    animationFrameId = requestAnimationFrame(measurePerformance);\n    \n    return () => {\n      if (animationFrameId) {\n        cancelAnimationFrame(animationFrameId);\n      }\n    };\n  }, []);\n\n\n\n\n  const handleResetGrid = async () => {\n    if (!currentGridId) { console.error('currentGridId is not defined.'); return; }\n    console.log('handleResetGrid: gridId:', currentGridId);\n  \n    try {\n      // Fetch settlement details using the player's current location\n      const settlementId = currentPlayer?.location?.s; // Fetch settlementId from current player location\n      if (!settlementId) {\n        console.error('Settlement ID not found for the current player.');\n        alert('Settlement ID not found for the current player.');\n        return;\n      }\n  \n      // Fetch settlement data to retrieve frontierId\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${settlementId}`);\n      const settlement = settlementResponse.data;\n  \n      if (!settlement || !settlement.frontierId) {\n        console.error('Settlement data is incomplete or missing frontierId.');\n        alert('Settlement data is incomplete or missing frontierId.');\n        return;\n      }\n  \n      const frontierId = settlement.frontierId; // Extract frontierId from the settlement\n      console.log('Settlement and frontierId resolved:', { settlementId, frontierId });\n  \n      // Fetch grid data to determine the gridType dynamically\n      const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${currentGridId}`);\n      const gridData = gridResponse.data;\n  \n      if (!gridData || !gridData.gridType) {\n        console.error('Grid data is incomplete or missing gridType.');\n        alert('Grid data is incomplete or missing gridType.');\n        return;\n      }\n  \n      const gridType = gridData.gridType;\n\n      let gridCoord = null;\n      for (const row of settlement.grids) {\n        for (const cell of row) {\n          if (cell.gridId && String(cell.gridId) === String(currentGridId)) {\n            gridCoord = cell.gridCoord;\n            break;\n          }\n        }\n        if (gridCoord !== null) break;\n      }\n\n      if (gridCoord === null) {\n        console.error('Could not resolve gridCoord from settlement.');\n        alert('Could not resolve gridCoord from settlement.');\n        return;\n      }\n\n      console.log('Extracted gridData: gridType=', gridType, '; gridCoord=', gridCoord);\n  \n      // Send request to reset the grid\n      const resetResponse = await axios.post(`${API_BASE}/api/reset-grid`, {\n        gridCoord,\n        gridId: currentGridId, // Use the Mongo `_id` of the grid\n        gridType,\n        settlementId,\n        frontierId,\n      });\n  \n      console.log(`Grid ${currentGridId} of type ${gridType} reset successfully:`, resetResponse.data);\n      updateStatus(903);\n      window.location.reload();\n    } catch (error) {\n      console.error(`Error resetting grid \"${currentGridId}\":`, error);\n      alert(`Failed to reset grid \"${currentGridId}\". Check the console for details.`);\n    }\n  }; \n\n  \n  const handleAddMoney = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) { console.error('No user logged in. Cannot add money.'); return; }\n      // Call delta-based inventory update\n      await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n        playerId,\n        delta: { type: 'Money', quantity: 10000, target: 'inventory' },\n      });\n\n      // Update local inventory state\n      const updatedInventory = await fetchInventory(playerId);\n      setInventory(updatedInventory);\n      // Update currentPlayer with the new inventory\n      setCurrentPlayer(prev => ({ ...prev, inventory: updatedInventory }));\n      // Refresh player data (but preserve the inventory we just set)\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, true);\n      console.log(' Added 10,000 Money successfully using delta update.');\n    } catch (error) {\n      console.error(' Error adding money:', error);\n    }\n  };\n\nconst handleGetRich = async () => {\n  try {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) {\n      console.error('No user logged in. Cannot perform Get Rich.');\n      return;\n    }\n\n    // Define resources to add\n    const resourcesToAdd = [\n      { type: 'Money', quantity: 100000 },\n      { type: 'Potion A', quantity: 50 },\n      { type: 'Potion B', quantity: 50 },\n      { type: 'Potion C', quantity: 50 },\n      { type: 'Gem', quantity: 20000 },\n      { type: 'Book', quantity: 100 },\n      { type: 'Wood', quantity: 1000 },\n      { type: 'Clay', quantity: 1000 },\n      { type: 'Stone', quantity: 1000 },\n      { type: 'Wheat', quantity: 1000 },\n      { type: 'Corn', quantity: 1000 },\n      { type: 'Carrot', quantity: 1000 },\n      { type: 'Grapes', quantity: 500 },\n      { type: 'Apple', quantity: 500 },\n      { type: 'Bread', quantity: 500 },\n      { type: 'Olive Oil', quantity: 500 },\n      { type: 'Honey', quantity: 500 },\n      { type: 'Flour', quantity: 500 },\n      { type: 'Butter', quantity: 500 },\n      { type: 'Egg', quantity: 500 },\n      { type: 'Sugar', quantity: 500 },\n      { type: 'Cream', quantity: 500 },\n      { type: 'Lemon', quantity: 500 },\n      { type: 'Orange', quantity: 500 },\n      { type: 'Cloth', quantity: 500 },\n      { type: 'Lumber', quantity: 500 },\n      { type: 'Thread', quantity: 500 },\n      { type: 'Milk', quantity: 500 },\n      { type: 'Aged Wine', quantity: 500 },\n      { type: 'Sweater', quantity: 500 },\n      { type: 'Cheese', quantity: 500 },\n      { type: 'Sugarcane', quantity: 500 },\n      { type: 'Strawberry', quantity: 500 },\n      { type: 'Diamond Ring', quantity: 500 },\n      { type: 'Feverfew', quantity: 100 },\n      { type: 'Golden Key', quantity: 100 },\n      { type: 'Skeleton Key', quantity: 100 },\n      { type: 'Furniture', quantity: 100 },\n      { type: 'Port', quantity: 100 },\n      { type: 'Wool', quantity: 500 },\n      { type: 'Scroll', quantity: 100 },\n      { type: 'Runic Tunic', quantity: 100 },\n      { type: 'Pumpkin Soup', quantity: 100 },\n      { type: 'Cornmeal', quantity: 100 },\n      { type: 'Pepper Cheese', quantity: 100 },\n      { type: 'Portrait', quantity: 10 },\n      { type: 'Trident', quantity: 10 },\n      { type: 'Yellow Heart', quantity: 1000 },\n      { type: 'Green Heart', quantity: 500 },\n      { type: 'Purple Heart', quantity: 500 },\n      { type: 'Saw', quantity: 10 },\n      { type: 'Shovel', quantity: 20 },\n      { type: 'Screwdriver', quantity: 30 },\n    ];\n\n    // Use delta endpoint for batched update, adding target: 'inventory' to each resource\n    await axios.post(`${API_BASE}/api/update-inventory-delta`, {\n      playerId,\n      delta: resourcesToAdd.map(item => ({ ...item, target: 'inventory' })),\n    });\n\n    // Update local inventory state\n    const updatedInventory = await fetchInventory(playerId);\n    setInventory(updatedInventory);\n    \n    // Update currentPlayer with the new inventory\n    setCurrentPlayer(prev => ({ ...prev, inventory: updatedInventory }));\n    \n    // Refresh player data after the batched update (preserve inventory)\n    await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer, true);\n\n    console.log(' Get Rich: Inventory updated successfully via delta.');\n  } catch (error) {\n    console.error(' Error performing Get Rich:', error);\n  }\n};\n  \n  const handleGetSkills = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No user logged in. Cannot add skills.');\n        return;\n      }\n  \n      // Fetch master resources\n      const response = await axios.get(`${API_BASE}/api/resources`);\n      const masterResources = response.data;\n  \n      if (!Array.isArray(masterResources)) {\n        console.error('Master resources are not an array:', masterResources);\n        return;\n      }\n  \n      // Filter resources of type \"skill\"\n      const skillResources = masterResources.filter((res) => res.category === 'skill');\n      if (skillResources.length === 0) {\n        console.warn('No skill resources found.');\n        alert('No skill resources available to add.');\n        return;\n      }\n  \n      // Fetch the latest skills\n      const skillsResponse = await axios.get(`${API_BASE}/api/skills/${playerId}`);\n      const currentSkills = skillsResponse.data.skills || [];\n  \n      // Create a new skills list by adding one of each skill\n      const updatedSkills = [...currentSkills];\n      skillResources.forEach((skill) => {\n        const existingSkill = updatedSkills.find((item) => item.type === skill.type);\n        if (existingSkill) {\n          existingSkill.quantity += 1;\n        } else {\n          updatedSkills.push({ type: skill.type, quantity: 1 });\n        }\n      });\n  \n      // Send the full updated skills list to the server\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId,\n        skills: updatedSkills,\n      });\n  \n      // Update the `currentPlayer` state with new skills\n      const updatedPlayer = { ...currentPlayer, skills: updatedSkills };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n      updateStatus(904);\n      console.log('Get Skills: Added skills successfully.');\n    } catch (error) {\n      console.error('Error adding skills:', error);\n      alert('Failed to add skills. Check console for details.');\n    }\n  };\n  \n  const handleClearTrophies = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear trophies.');\n        return;\n      }\n\n      // Clear trophies\n      const clearedTrophies = [];\n      console.log('Clearing all trophies.');\n      \n      // Update trophies on the server by setting to empty array\n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates: {\n          trophies: clearedTrophies\n        }\n      });\n      \n      console.log('Trophies cleared successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Update the local state for trophies\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        trophies: clearedTrophies\n      }));\n      \n      updateStatus('Trophies cleared successfully.');\n      console.log('Trophies cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing trophies:', error);\n    }\n  };\n  \n  const handleClearInventory = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear inventory.');\n        return;\n      }\n\n      // Retain only Money and Gems in the inventory\n      const filteredInventory = currentPlayer.inventory.filter(\n        (item) => item.type === 'Money' || item.type === 'Gem'\n      );\n      console.log('Filtered inventory to retain only Money and Gems:', filteredInventory);\n\n      // Update inventory on the server\n      await axios.post(`${API_BASE}/api/update-inventory`, {\n        playerId,\n        inventory: filteredInventory,\n        backpack: currentPlayer.backpack || [],\n      });\n      console.log('Inventory updated successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Force a re-fetch to confirm changes are saved\n      const updatedInventory = await fetchInventory(playerId);\n      console.log('Fetched inventory after clearing:', updatedInventory);\n\n      // Update the local state for inventory\n      setInventory(updatedInventory);\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        inventory: updatedInventory,\n      }));\n      updateStatus(900);\n      console.log('Inventory cleared successfully except for Money.');\n    } catch (error) {\n      console.error('Error clearing inventory:', error);\n    }\n  };\n\n  const handleClearSkillsAndPowers = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot clear skills and powers.');\n        return;\n      }\n\n      // Clear skills\n      const clearedSkills = [];\n      console.log('Clearing all skills.');\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId,\n        skills: clearedSkills,\n      });\n      console.log('Skills cleared successfully on the server.');\n\n      // Clear powers\n      const clearedPowers = [];\n      console.log('Clearing all powers.');\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId,\n        powers: clearedPowers,\n      });\n      console.log('Powers cleared successfully on the server.');\n\n      // Refresh player data after updates\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n      // Update the local state for skills and powers\n      setCurrentPlayer((prevPlayer) => ({\n        ...prevPlayer,\n        skills: clearedSkills,\n        powers: clearedPowers,\n      }));\n      updateStatus(905);\n      console.log('Skills and powers cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing skills and powers:', error);\n    }\n  };\n  \n  const handleClearQuestHistory = async () => {\n    try {\n        const playerId = currentPlayer?.playerId;\n        if (!playerId) {\n            console.error('No player logged in. Cannot clear quest history.');\n            return;\n        }\n\n        // Make the API request to clear both activeQuests and completedQuests\n        await axios.post(`${API_BASE}/api/clear-quest-history`, { playerId });\n\n        // Update the `currentPlayer` state to reflect changes\n        const updatedPlayer = {\n            ...currentPlayer,\n            activeQuests: [],\n            completedQuests: []\n        };\n        setCurrentPlayer(updatedPlayer);\n\n        console.log('Quest history cleared successfully.');\n        updateStatus(901); // Update with a debug-specific status code\n\n    } catch (error) {\n        console.error('Error clearing quest history:', error);\n    }\n  };\n\n  const handleClearRelationships = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player logged in. Cannot clear relationships.');\n        return;\n      }\n\n      // Keep only Kent and The Shepherd relationships\n      const protectedNPCs = ['Kent', 'The Shepherd'];\n      const filteredRelationships = (currentPlayer.relationships || []).filter(\n        (rel) => protectedNPCs.includes(rel.name)\n      );\n\n      // Update relationships on the server\n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates: {\n          relationships: filteredRelationships\n        }\n      });\n\n      // Update local state\n      const updatedPlayer = {\n        ...currentPlayer,\n        relationships: filteredRelationships\n      };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n\n      console.log('Relationships cleared successfully (kept Kent and The Shepherd).');\n      updateStatus(' Relationships cleared (kept Kent and The Shepherd).');\n    } catch (error) {\n      console.error('Error clearing relationships:', error);\n    }\n  };\n\n  const handleClearTradeStall = async () => {\n    try {\n      const username = currentPlayer?.username;\n      if (!username) {\n        console.error('No user logged in. Cannot clear Trade Stall.');\n        return;\n      }\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        username,\n        tradeStall: [], // Clear the trade stall\n      });\n\n      console.log('Trade Stall cleared successfully.');\n    } catch (error) {\n      console.error('Error clearing Trade Stall:', error);\n    }\n  };\n\n  const handleWelcomeMessage = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId,\n        messageId: 1, // Assuming 1 is the Welcome message ID\n      });\n      console.log(\" Welcome message added to mailbox.\");\n      updateStatus(\" Welcome message delivered.\");\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n      updateStatus(\" Failed to deliver welcome message.\");\n    }\n  };\n\n  const handleRewardMessage = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message`, {\n        playerId,\n        messageId: 101, \n      });\n      console.log(\" Welcome message added to mailbox.\");\n      updateStatus(\" Welcome message delivered.\");\n      await refreshPlayerAfterInventoryUpdate(playerId, setCurrentPlayer);\n\n    } catch (mailError) {\n      console.error(\" Failed to send welcome message:\", mailError);\n      updateStatus(\" Failed to deliver welcome message.\");\n    }\n  };\n\n  const sendMessageToAll = async (messageId) => {\n    try {\n      await axios.post(`${API_BASE}/api/send-mailbox-message-all`, {\n        messageId: messageId, // Send to all players\n      });\n      console.log(` Message ${messageId} added to mailbox for all users.`);\n      updateStatus(` Message ${messageId} delivered to all users.`);\n      // Optionally refresh current player\n      if (currentPlayer?.playerId) {\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      }\n    } catch (mailError) {\n      console.error(` Failed to send message ${messageId}:`, mailError);\n      updateStatus(` Failed to deliver message ${messageId}.`);\n    }\n  };\n  \n  const handleClearGridState = async (command) => {\n    switch (command) {\n      case 'cleargrid':\n        if (NPCsInGridManager.clearGridState(currentGridId)) {\n          updateStatus('Grid state cleared successfully');\n          // Clear from localStorage if you're using it\n          localStorage.removeItem(`NPCsInGrid_${currentGridId}`);\n        } else {\n          updateStatus('Failed to clear grid state');\n        }\n        break;\n\n      // Add other debug commands here\n      default:\n        console.warn(`Unknown debug command: ${command}`);\n    }\n  };\n\n  // Add Reset Combat Stats handler\n  const handleResetCombatStats = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot reset combat stats.');\n        return;\n      }\n\n      const combatStats = {\n        maxhp: currentPlayer.baseMaxhp,\n        attackbonus: currentPlayer.baseAttackbonus,\n        armorclass: currentPlayer.baseArmorclass,\n        damage: currentPlayer.baseDamage,\n        attackrange: currentPlayer.baseAttackrange,\n        speed: currentPlayer.baseSpeed,\n      };\n\n      await playersInGridManager.updatePC(currentGridId, playerId, combatStats);\n\n      console.log('Combat stats reset successfully using updatePC.');\n      updateStatus(906); // Optional: new debug status\n    } catch (error) {\n      console.error('Error resetting combat stats:', error);\n    }\n  };\n\n  const handleCreateNewFrontier = async () => {\n    try {\n      const response = await axios.post(`${API_BASE}/api/create-frontier`);\n      console.log('Create New Frontier response:', response.data);\n      alert('New Frontier created successfully!');\n    } catch (error) {\n      console.error('Error creating new Frontier:', error);\n      alert('Failed to create new Frontier. Check console for details.');\n    }\n  };\n\n  const handleGenerateTown = async () => {\n    try { await generateTownGrids({ currentPlayer }); } catch (error) {\n      console.error('Error generating town:', error);\n      alert('Failed to generate town. Check console for details.');\n    }\n  };\n\n  const handleDeleteAccount = async (username) => {\n    // Accept either {username} or username string for backward compatibility\n    if (typeof username === \"object\" && username?.username) {\n      username = username.username;\n    }\n    if (!username) {\n      alert(\"Please enter a username.\");\n      return;\n    }\n\n    try {\n      // Step 1: Look up the player by username\n      const lookupResponse = await axios.get(`${API_BASE}/api/get-player-by-username/${username}`);\n      const player = lookupResponse.data;\n\n      if (!player || !player._id) {\n        alert(`Player not found for username: ${username}`);\n        return;\n      }\n\n      const confirmed = window.confirm(`Are you sure you want to delete the account for \"${username}\"? This cannot be undone.`);\n      if (!confirmed) return;\n\n      // Step 2: Delete the player by ID\n      const deleteResponse = await axios.post(`${API_BASE}/api/delete-player`, {\n        playerId: player._id,\n      });\n\n      if (deleteResponse.data.success) {\n        alert(` Account for \"${username}\" deleted successfully.`);\n        console.log(` Account deleted for username: ${username}`);\n      } else {\n        alert(\" Failed to delete account. See console for details.\");\n        console.error(\"Delete failed:\", deleteResponse.data);\n      }\n    } catch (error) {\n      console.error(\" Error deleting account:\", error);\n      alert(\"An error occurred while trying to delete the account.\");\n    }\n  };\n\n  const handleTeleport = async (gridCoord) => {\n    if (!gridCoord || typeof gridCoord !== 'number' || isNaN(gridCoord)) {\n      console.error(' Invalid gridCoord passed to handleTeleport:', gridCoord);\n      updateStatus(' Invalid grid selected for teleport.');\n      return;\n    }\n\n    // Extract settlement row and col from the 4th and 5th digits\n    const coordStr = String(gridCoord).padStart(7, '0'); // Ensure string is long enough\n    const row = parseInt(coordStr[3], 10); // 4th digit\n    const col = parseInt(coordStr[4], 10); // 5th digit\n\n    console.log(` Parsed gridCoord ${gridCoord}  row=${row}, col=${col}`);\n\n    try {\n      // 1. Call backend to get settlement data\n      const response = await axios.get(`${API_BASE}/api/get-settlement-by-coords/${row}/${col}`);\n      const settlement = response.data;\n\n      if (!settlement || !settlement.grids || settlement.grids.length === 0) {\n        console.warn('No settlement or empty grids array found.');\n        updateStatus(' Settlement data not found.');\n        return;\n      }\n\n      // 2. Search through grids to find the matching gridCoord\n      let matchingGridObj = null;\n      for (const row of settlement.grids) {\n        for (const cell of row) {\n          if (cell.gridCoord === gridCoord) {\n            matchingGridObj = cell;\n            break;\n          }\n        }\n        if (matchingGridObj) break;\n      }\n\n      if (!matchingGridObj) {\n        console.warn(`GridCoord ${gridCoord} not found in settlement.`);\n        updateStatus(' Grid not found in settlement.');\n        return;\n      }\n\n      // 3. Build toLocation using found grid data\n      const fromLocation = currentPlayer.location;\n      const toLocation = {\n        x: 0,\n        y: 0,\n        g: matchingGridObj.gridId,\n        s: settlement._id,\n        f: currentPlayer.location.f,\n        gtype: matchingGridObj.gridType,\n        gridCoord: gridCoord,\n      };\n\n      // 4. Call changePlayerLocation\n      changePlayerLocation(\n        currentPlayer,\n        fromLocation,\n        toLocation,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        setResources,\n        TILE_SIZE,\n        closeAllPanels,\n        updateStatus,\n        null, // bulkOperationContext not available\n        null, // masterResources not available\n        null, // strings not available\n        null  // masterTrophies not available\n      );\n    } catch (error) {\n      console.error('Error during teleport:', error);\n      updateStatus(' Teleport failed due to error.');\n    }\n  };\n\n\n  const handleResetFTUE = async () => {\n    const playerId = currentPlayer?.playerId;\n    if (!playerId) { console.error(\" No player ID available.\"); return; }\n\n    try {\n      // Update player document on DB: player.firsttimeuser = true\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId,\n        updates: { firsttimeuser: true, ftuestep: 1 }, \n      });\n      \n      if (response.data.success) {\n        // Update in the local storage as well\n        const updatedPlayer = {\n          ...currentPlayer,\n          firsttimeuser: true,\n          ftuestep: 1, \n        };\n        localStorage.setItem('player', JSON.stringify(updatedPlayer));\n        \n        console.log(' FTUE reset successfully.');\n        updateStatus(' FTUE reset. Refreshing page...');\n        \n        // Refresh the window after a short delay\n        setTimeout(() => {\n          window.location.reload();\n        }, 1000);\n      } else {\n        console.error(' Failed to reset FTUE:', response.data.error);\n        updateStatus(' Failed to reset FTUE.');\n      }\n    } catch (error) {\n      console.error(' Error resetting FTUE:', error);\n      updateStatus(' Error resetting FTUE.');\n    }\n  };\n\n  const handleRemoveHomestead = async () => {\n    if (!currentGridId) {\n      console.error(' No grid ID available.');\n      updateStatus(' No grid ID available.');\n      return;\n    }\n\n    // Check if this is actually a homestead\n    const gridType = currentPlayer?.location?.gtype;\n    if (gridType !== 'homestead') {\n      alert(' This command only works on homestead grids.');\n      return;\n    }\n\n    const confirmed = window.confirm(\n      ` Are you absolutely sure you want to remove this homestead grid?\\n\\n` +\n      `Grid ID: ${currentGridId}\\n\\n` +\n      `This will:\\n` +\n      `1. Delete this grid from the database\\n` +\n      `2. Mark this location as available in the settlement\\n\\n` +\n      `This action CANNOT be undone!`\n    );\n\n    if (!confirmed) return;\n\n    try {\n      console.log(' Removing homestead grid:', currentGridId);\n      \n      const response = await axios.post(`${API_BASE}/api/remove-homestead`, {\n        gridId: currentGridId\n      });\n\n      if (response.data.success) {\n        console.log(' Homestead removed successfully');\n        updateStatus(' Homestead removed. Players relocated. Reloading...');\n        \n        // The server has relocated all players using relocateOnePlayerHome\n        // Just reload the page to reflect the new state\n        setTimeout(() => {\n          window.location.reload();\n        }, 1500);\n      } else {\n        console.error(' Failed to remove homestead:', response.data);\n        updateStatus(' Failed to remove homestead.');\n      }\n    } catch (error) {\n      console.error(' Error removing homestead:', error);\n      updateStatus(' Error removing homestead.');\n      alert('Failed to remove homestead. Check console for details.');\n    }\n  };\n\n  const handleSetAllGridsVisited = async () => {\n    try {\n      const playerId = currentPlayer?.playerId;\n      if (!playerId) {\n        console.error('No player ID found. Cannot set all grids visited.');\n        return;\n      }\n\n      const response = await axios.post(`${API_BASE}/api/set-all-grids-visited`, {\n        playerId\n      });\n\n      if (response.data.success) {\n        // Update local player state with the new gridsVisited buffer\n        setCurrentPlayer(prev => ({\n          ...prev,\n          gridsVisited: response.data.gridsVisited\n        }));\n\n        console.log(' All grids marked as visited');\n        updateStatus(' All 4096 grids marked as visited.');\n      } else {\n        console.error(' Failed to set all grids visited:', response.data);\n        updateStatus(' Failed to set all grids visited.');\n      }\n    } catch (error) {\n      console.error(' Error setting all grids visited:', error);\n      updateStatus(' Error setting all grids visited.');\n    }\n  };\n\n  const handleDeleteOrphanedGrid = async (gridId) => {\n    if (!gridId) {\n      alert(\"Please enter a Grid ID.\");\n      return;\n    }\n\n    const confirmed = window.confirm(\n      ` Are you sure you want to delete orphaned grid?\\n\\n` +\n      `Grid ID: ${gridId}\\n\\n` +\n      `This will:\\n` +\n      `1. Delete this grid from the database\\n` +\n      `2. Mark this location as available in the settlement\\n\\n` +\n      `This action CANNOT be undone!`\n    );\n\n    if (!confirmed) return;\n\n    try {\n      console.log(' Deleting orphaned grid:', gridId);\n\n      const response = await axios.post(`${API_BASE}/api/delete-orphaned-grid`, {\n        gridId\n      });\n\n      if (response.data.success) {\n        console.log(' Orphaned grid deleted successfully');\n        updateStatus(' Orphaned grid deleted and settlement updated.');\n        setOrphanedGridId(''); // Clear the input\n      } else {\n        console.error(' Failed to delete orphaned grid:', response.data);\n        updateStatus(` ${response.data.error || 'Failed to delete orphaned grid.'}`);\n      }\n    } catch (error) {\n      console.error(' Error deleting orphaned grid:', error);\n      updateStatus(' Error deleting orphaned grid.');\n      alert('Failed to delete orphaned grid. Check console for details.');\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} titleKey=\"1120\" panelName=\"DebugPanel\">\n      {/* Performance Metrics Section */}\n      <div style={{\n        backgroundColor: '#f0f0f0',\n        padding: '10px',\n        marginBottom: '15px',\n        borderRadius: '5px',\n        fontFamily: 'monospace',\n        fontSize: '11px'\n      }}>\n        <h3 style={{ margin: '0 0 8px 0', color: '#333', fontSize: '12px' }}> Performance Metrics</h3>\n\n        {/* Rendering Mode - label and value on separate lines */}\n        <div style={{ marginBottom: '8px', color: '#666' }}>\n          <div> Rendering Mode:</div>\n          <div><strong style={{ color: 'green' }}>Canvas (Forced)</strong></div>\n        </div>\n\n        {/* V2 Tile Renderer Toggle */}\n        <div style={{ marginTop: '10px', marginBottom: '8px', padding: '8px', backgroundColor: '#e8e8e8', borderRadius: '4px' }}>\n          <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', gap: '8px' }}>\n            <input\n              type=\"checkbox\"\n              checked={useV2Tiles}\n              onChange={(e) => {\n                const newValue = e.target.checked;\n                setUseV2Tiles(newValue);\n                localStorage.setItem('useV2Tiles', newValue);\n                localStorage.setItem('useV2TilesExplicit', 'true'); // Mark as explicit user choice\n                // Dispatch event to notify App.js\n                window.dispatchEvent(new CustomEvent('tileRendererChange', { detail: newValue }));\n              }}\n              style={{ width: '16px', height: '16px' }}\n            />\n            <span style={{ fontWeight: 'bold' }}>Use V2 Tile Renderer (Autotiling)</span>\n          </label>\n          <div style={{ fontSize: '10px', marginTop: '4px', color: '#888' }}>\n            Enables quarter-tile blending with grass blades at edges\n          </div>\n        </div>\n\n        {/* Two-column grid with labels and values on separate rows */}\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '2px 10px' }}>\n          {/* Row 1: Labels */}\n          <div><strong>FPS:</strong></div>\n          <div><strong>Render Mode:</strong></div>\n          {/* Row 2: Values */}\n          <div style={{ color: performanceMetrics.fps >= 30 ? 'green' : performanceMetrics.fps >= 15 ? 'orange' : 'red', marginBottom: '6px' }}>\n            {performanceMetrics.fps}\n          </div>\n          <div style={{ color: performanceMetrics.renderMode === 'Canvas' ? 'green' : 'blue', marginBottom: '6px' }}>\n            {performanceMetrics.renderMode}\n          </div>\n          {/* Row 3: Labels */}\n          <div><strong>DOM Elements:</strong></div>\n          <div><strong>Memory:</strong></div>\n          {/* Row 4: Values */}\n          <div>{performanceMetrics.domElementCount.toLocaleString()}</div>\n          <div>{performanceMetrics.memoryUsage > 0 ? `${performanceMetrics.memoryUsage} MB` : 'N/A'}</div>\n        </div>\n      </div>\n      \n        <h3>Teleport to Another Grid</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter GridCoord\"\n          value={toGridCoord}\n          onChange={(e) => setToGridCoord(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              try {\n                const parsedCoord = parseInt(toGridCoord, 10);\n                if (isNaN(parsedCoord)) {\n                  alert(\"Invalid gridCoord (not a number).\");\n                  return;\n                }\n                await handleTeleport(parsedCoord);\n              } catch (error) {\n                console.error(\"Error teleporting:\", error);\n                alert(\"Failed to teleport.\");\n              }\n            }}\n          >\n            Teleport\n          </button>\n        </div>\n\n    <h3>FTUE Step: {currentPlayer?.ftuestep || \"Not set\"}</h3>\n    <h3>Warehouse Level: {currentPlayer?.warehouseLevel ?? 0}</h3>\n\n      <div className=\"shared-buttons\">\n        <button \n          className=\"btn-basic btn-danger\" \n          onClick={async () => {\n            try {\n              const response = await axios.post(`${API_BASE}/api/make-it-snow/${currentGridId}`);\n              console.log(' Make it snow response:', response.data);\n              updateStatus(` Made it snow! ${response.data.tilesConverted} tiles converted.`);\n              window.location.reload(); // Refresh to see the changes\n            } catch (error) {\n              console.error(' Error making it snow:', error);\n              updateStatus(' Failed to make it snow.');\n            }\n          }}\n        > \n           Make It Snow \n        </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button \n          className=\"btn-basic btn-danger\" \n          onClick={async () => {\n            try {\n              const response = await axios.post(`${API_BASE}/api/melt-the-snow/${currentGridId}`);\n              console.log(' Melt the snow response:', response.data);\n              updateStatus(` Snow melted! ${response.data.tilesConverted} tiles converted.`);\n              window.location.reload(); // Refresh to see the changes\n            } catch (error) {\n              console.error(' Error melting snow:', error);\n              updateStatus(' Failed to melt snow.');\n            }\n          }}\n        > \n           Melt The Snow \n        </button>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleResetGrid}> Reset This Grid </button>\n      </div>\n\n    <br />\n\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleCreateNewFrontier}> Create New Frontier </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleRemoveHomestead}> Remove Homestead </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-danger\" onClick={handleGenerateTown}> Generate Town </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearInventory}> Clear Inventory </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearSkillsAndPowers}> Clear Skills & Powers </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleResetCombatStats}> Reset Combat Stats </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearQuestHistory}> Clear Quest History </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearRelationships}> Clear Relationships </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearGridState}> Clear Grid State </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearTradeStall}> Clear Trade Stall </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-neutral\" onClick={handleClearTrophies}> Clear Trophies </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleSetAllGridsVisited}> Set All Grids Visited </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleResetFTUE}> Reset FTUE </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleWelcomeMessage}> Resend Welcome Message </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleRewardMessage}> Resend Reward Message </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleAddMoney}> Add Money </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleGetRich}> Get Rich </button>\n      </div>\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\" onClick={handleGetSkills}> Get Skills </button>\n      </div>\n\n        <h3>Create Single Valley Grid</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter GridCoord\"\n          value={singleGridCoord}\n          onChange={(e) => setSingleGridCoord(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const settlementId = currentPlayer?.location?.s;\n              const frontierId = currentPlayer?.location?.f;\n              const gridType = currentPlayer?.location?.gtype || 'valley0';\n              if (!singleGridCoord || !settlementId || !frontierId) {\n                alert(\"Missing gridCoord, settlementId, or frontierId.\");\n                return;\n              }\n              try {\n                await createSingleValleyGrid({\n                  gridCoord: singleGridCoord,\n                });\n              } catch (error) {\n                console.error(\"Error creating single valley grid:\", error);\n                alert(\"Failed to create valley grid. See console for details.\");\n              }\n            }}\n          >\n            Create Grid\n          </button>\n        </div>\n\n        <h3>Delete User Account</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Username\"\n          value={usernameToDelete}\n          onChange={(e) => setUsernameToDelete(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              const confirmed = window.confirm(` Are you absolutely sure you want to permanently delete the account for \"${usernameToDelete}\"? This cannot be undone.`);\n              if (!confirmed) return;\n\n              try {\n                await handleDeleteAccount({\n                  username: usernameToDelete,\n                });\n              } catch (error) {\n                console.error(\"Error deleting user account:\", error);\n                alert(\"Failed to delete user account. See console for details.\");\n              }\n            }}\n          >\n            Delete\n          </button>\n        </div>\n\n        <h3>Delete Orphaned Grid</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Grid ID\"\n          value={orphanedGridId}\n          onChange={(e) => setOrphanedGridId(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={() => handleDeleteOrphanedGrid(orphanedGridId)}\n          >\n            Delete\n          </button>\n        </div>\n\n\n        <h3>Send Message to All Users</h3>\n        <input\n          type=\"text\"\n          placeholder=\"Enter Message ID\"\n          value={messageIdentifier}\n          onChange={(e) => setMessageIdentifier(e.target.value)}\n        />\n        <div className=\"shared-buttons\">\n          <button\n            className=\"btn-basic btn-danger\"\n            onClick={async () => {\n              if (!messageIdentifier) {\n                alert(\"Please enter a message ID.\");\n                return;\n              }\n              try {\n                await sendMessageToAll(Number(messageIdentifier));\n              } catch (error) {\n                console.error(\"Error sending message to all users:\", error);\n                alert(\"Failed to send message. See console for details.\");\n              }\n            }}\n          >\n            Send Message\n          </button>\n        </div>\n\n\n      <div className=\"debug-timers\">\n        <h3> Active Timers:</h3>\n        {timers.length > 0 ? (\n          <ul>\n            {timers.map((res, index) => (\n              <li key={index}>\n                {res.type} at ({res.x}, {res.y}) - \n                {res.growEnd ? `  Farming Timer Ends in ${res.remainingTime}s` : \"\"}\n                {res.craftedItem ? `  ${res.craftedItem}: ` : \"\"}\n                {res.craftEnd ? ` Ends in ${res.remainingTime}s` : \"\"}\n              </li>\n            ))}\n          </ul>\n        ) : (\n          <p>No active timers.</p>\n        )}\n      </div>\n          \n    <GridStateDebugPanel\n      gridId={currentGridId}\n      gridCoord={currentPlayer?.location?.gridCoord}\n      gridType={currentPlayer?.location?.gtype}\n      settlementId={currentPlayer?.location?.s}\n      NPCsInGrid={{ [currentGridId]: NPCsInGridManager.getNPCsInGrid(currentGridId) }}\n      playersInGrid={{ [currentGridId]: playersInGridManager.getPlayersInGrid(currentGridId) }}\n    />\n\n    </Panel>\n  );\n};\n\nexport default DebugPanel;","import API_BASE from '../config';\nimport axios from 'axios';\n\n\nexport async function generateTownGrids ({ currentPlayer })\n    {\n    try {\n      const settlementId = currentPlayer.location.s;\n      if (!settlementId) {\n        console.error('No settlement ID found for the current player.');\n        alert('No settlement ID found for the current player.');\n        return;\n      }\n  \n      // Fetch the settlement data\n      const response = await axios.get(\n        `${API_BASE}/api/get-settlement/${settlementId}`\n      );\n  \n      const settlement = response.data;\n      if (!settlement || !settlement.grids || settlement.grids.length === 0) {\n        console.error('Settlement data is incomplete or missing grids.');\n        alert('Settlement data is incomplete or missing grids.');\n        return;\n      }\n  \n      // Find all uninitialized town grids by looking for gridType === 'town' but no gridId\n      const townGrids = [];\n      settlement.grids.forEach((row) => {\n        row.forEach((grid) => {\n          if (grid.gridType === 'town' && !grid.gridId) {\n            // Instead of placeholderName, push the gridCoord\n            townGrids.push(grid.gridCoord);\n          }\n        });\n      });\n  \n      if (townGrids.length === 0) {\n        console.log('No uninitialized town grids found in this settlement.');\n        alert('No uninitialized town grids found in this settlement.');\n        return;\n      }\n  \n      console.log(`Found ${townGrids.length} uninitialized town grids. Processing grids...`);\n  \n      // Generate/create each town grid by passing gridCoord\n      for (const gridCoord of townGrids) {\n        try {\n          console.log(`Creating Town grid with gridCoord: ${gridCoord}`);\n  \n          const result = await axios.post(`${API_BASE}/api/create-grid`, {\n            gridCoord,             // instead of placeholderName\n            gridType: 'town',\n            settlementId,\n            frontierId: settlement.frontierId,\n          });\n  \n          console.log(`Processed town grid for gridCoord: ${gridCoord}`, result.data);\n  \n        } catch (gridError) {\n          console.error(`Failed to process grid for gridCoord: ${gridCoord}`, gridError);\n        }\n      }\n  \n      alert('Town grids created successfully!');\n    } catch (error) {\n      console.error('Error processing town grids:', error);\n      alert('Failed to create town grids. Check the console for details.');\n    }\n  };\n\n\n\n\nexport async function generateValleyGrids({ valleyType, currentPlayer }) {\n    try {\n      const frontierId = currentPlayer?.location?.f;\n      if (!frontierId) {\n        console.error(\"No frontier ID found for the current player.\");\n        alert(\"No frontier ID found for the current player.\");\n        return;\n      }\n      console.log(`Fetching frontier data for ID: ${frontierId}`);\n      const frontierResponse = await axios.get(`${API_BASE}/api/get-frontier/${frontierId}`);\n      const frontierData = frontierResponse.data;\n      if (!frontierData || !frontierData.settlements) {\n        console.error(\"Frontier data is incomplete or missing settlements.\");\n        alert(\"Frontier data is incomplete or missing settlements.\");\n        return;\n      }\n      console.log(`Searching settlements for valley${valleyType} grids.`);\n      const valleyGrids = [];\n  \n      // 1) For each settlement in the frontier, fetch its data\n      for (const settlementRow of frontierData.settlements) {\n        for (const settlement of settlementRow) {\n          if (!settlement?.settlementId) {\n            console.warn(\"Settlement is invalid or missing settlementId. Skipping.\");\n            continue;\n          }\n          try {\n            console.log(\"Fetching settlement data for settlement ID:\", settlement.settlementId);\n            const settlementResponse = await axios.get(\n              `${API_BASE}/api/get-settlement/${settlement.settlementId}`\n            );\n            const settlementData = settlementResponse.data;\n  \n            if (!settlementData?.grids) {\n              console.warn(`Settlement ${settlement.settlementId} has no grids. Skipping.`);\n              continue;\n            }\n            // 2) Find all uninitialized valleyX sub-grids (i.e., same valleyType, no gridId)\n            settlementData.grids.flat().forEach((grid) => {\n              if (grid.gridType === `valley${valleyType}` && !grid.gridId) {\n                valleyGrids.push({\n                  ...grid,\n                  settlementId: settlement.settlementId,\n                });\n              }\n            });\n          } catch (error) {\n            console.error(`Failed to fetch data for settlement ${settlement.settlementId}:`, error);\n          }\n        }\n      }\n  \n      if (valleyGrids.length === 0) {\n        console.log(`No valley${valleyType} grids found in this frontier.`);\n        alert(`No valley${valleyType} grids found in this frontier.`);\n        return;\n      }\n  \n      console.log(`Found ${valleyGrids.length} valley${valleyType} grids. Starting generation process.`);\n  \n      // 3) Create each valley grid via /create-grid, sending gridCoord instead of placeholderName\n      for (const valleyGrid of valleyGrids) {\n        try {\n          console.log(\n            `Creating valley${valleyType} grid with gridCoord: ${valleyGrid.gridCoord}, Settlement ID: ${valleyGrid.settlementId}`\n          );\n  \n          await axios.post(`${API_BASE}/api/create-grid`, {\n            gridCoord: valleyGrid.gridCoord,\n            gridType: valleyGrid.gridType, // 'valley0', 'valley1', 'valley2', or 'valley3'\n            settlementId: valleyGrid.settlementId,\n            frontierId: frontierId,\n          });\n  \n          console.log(`Successfully created valley${valleyType} grid for gridCoord: ${valleyGrid.gridCoord}`);\n        } catch (error) {\n          console.error(\n            `Error creating valley${valleyType} grid with gridCoord ${valleyGrid.gridCoord}:`,\n            error\n          );\n        }\n      }\n  \n      alert(`Valley${valleyType} grids processed successfully!`);\n    } catch (error) {\n      console.error(`Error processing valley${valleyType} grids:`, error);\n      alert(`Failed to process valley${valleyType} grids. Check the console for details.`);\n    }\n  };\n\n\nexport async function createSingleValleyGrid({ gridCoord }) {\n  try {\n    console.log(\" Fetching all settlements to determine gridType for gridCoord:\", gridCoord);\n    const settlementsResponse = await axios.get(`${API_BASE}/api/settlements`);\n    const settlements = settlementsResponse.data;\n\n    if (!settlements || settlements.length === 0) {\n      throw new Error(\"No settlements returned from the server\");\n    }\n\n    let foundGrid = null;\n    let foundSettlementId = null;\n    let foundFrontierId = null;\n\n    for (const settlement of settlements) {\n      if (!settlement.grids) continue;\n\n      for (const row of settlement.grids) {\n        for (const grid of row) {\n          console.log(` Checking gridCoord ${grid.gridCoord} (type: ${typeof grid.gridCoord}) against input ${gridCoord}`);\n          if (String(grid.gridCoord) === String(gridCoord)) {\n            foundGrid = grid;\n            foundSettlementId = settlement._id;\n            foundFrontierId = settlement.frontierId;\n            break;\n          }\n        }\n        if (foundGrid) break;\n      }\n      if (foundGrid) break;\n    }\n\n    if (!foundGrid) {\n      console.warn(` GridCoord ${gridCoord} not found in any settlement.`);\n      alert(\"GridCoord not found in any settlement data.\");\n      return;\n    }\n\n    const payload = {\n      gridCoord,\n      gridType: foundGrid.gridType,\n      settlementId: foundSettlementId,\n      frontierId: foundFrontierId,\n    };\n\n    console.log(\" Sending grid creation request with:\", payload);\n\n    const response = await axios.post(`${API_BASE}/api/create-grid`, payload);\n\n    console.log(` Grid created: ${gridCoord}`, response.data);\n    alert(`Grid ${gridCoord} created successfully!`);\n  } catch (error) {\n    console.error(` Failed to create grid ${gridCoord}:`, error);\n    alert(`Failed to create grid ${gridCoord}. See console for details.`);\n  }\n}","import React, { useState, useMemo } from 'react';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { useStrings } from '../../UI/StringsContext';\nimport { isCurrency } from '../../Utils/InventoryManagement';\nimport './ManageContentsModal.css';\nimport '../../UI/Buttons/SharedButtons.css';\n\nconst ManageContentsModal = ({\n  inventory,\n  masterResources,\n  showActions = false,\n  warehouseAmounts,\n  setWarehouseAmounts,\n  handleAmountChange,\n  handleDiscardWarehouseItem,\n  // New props for backpack mode\n  amounts,\n  setAmounts,\n  handleActionItem,\n  actionButtonText,\n  actionButtonClass = \"btn-danger\",\n  isActionDisabled,\n  // Props for second action button (To Backpack)\n  handleSecondAction,\n  secondActionButtonText,\n  secondActionButtonClass = \"btn-success\",\n  strings: passedStrings\n}) => {\n  const contextStrings = useStrings();\n  const strings = passedStrings || contextStrings;\n  const [sortField, setSortField] = useState('name');\n  const [sortDirection, setSortDirection] = useState('asc');\n\n  // Sort inventory data\n  const sortedInventory = useMemo(() => {\n    const filtered = inventory.filter(item => !isCurrency(item.type));\n    \n    return filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortField) {\n        case 'name':\n          aValue = getLocalizedString(a.type, strings).toLowerCase();\n          bValue = getLocalizedString(b.type, strings).toLowerCase();\n          break;\n        case 'quantity':\n          aValue = a.quantity;\n          bValue = b.quantity;\n          break;\n        case 'food':\n          const aResource = masterResources.find(r => r.type === a.type);\n          const bResource = masterResources.find(r => r.type === b.type);\n          aValue = (aResource?.hp > 0) ? 1 : 0;\n          bValue = (bResource?.hp > 0) ? 1 : 0;\n          break;\n        default:\n          return 0;\n      }\n      \n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [inventory, strings, sortField, sortDirection]);\n\n  const handleSort = (field) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (field) => {\n    if (sortField !== field) return '';\n    return sortDirection === 'asc' ? '' : '';\n  };\n\n  if (sortedInventory.length === 0) {\n    return <p>{strings[76]}</p>;\n  }\n\n  return (\n    <div className=\"manage-contents-container\">\n      <div className=\"manage-contents-header\">\n        <table>\n          <thead>\n            <tr>\n              <th onClick={() => handleSort('food')} className=\"sortable-header\">\n                {getSortIcon('food')}\n              </th>\n              <th onClick={() => handleSort('name')} className=\"sortable-header\">\n                {strings[191] || \"Item\"} {getSortIcon('name')}\n              </th>\n              <th onClick={() => handleSort('quantity')} className=\"sortable-header\">\n                {strings[185] || \"Quantity\"} {getSortIcon('quantity')}\n              </th>\n              {showActions && (\n                <>\n                  <th>{strings[186] || \"Amount\"}</th>\n                  <th>{strings[192] || \"Action\"}</th>\n                  {handleSecondAction && <th>{strings[192] || \"Action\"}</th>}\n                </>\n              )}\n            </tr>\n          </thead>\n        </table>\n      </div>\n      \n      <div className=\"manage-contents-scroll\">\n        <table>\n          <tbody>\n            {sortedInventory.map((item, index) => {\n              const resourceData = masterResources.find(r => r.type === item.type);\n              const isFood = resourceData?.hp > 0;\n              \n              return (\n                <tr key={index}>\n                  <td>\n                    {isFood ? ` +${resourceData.hp}` : ''}\n                  </td>\n                  <td>\n                    {resourceData?.symbol || ''} {getLocalizedString(item.type, strings)}\n                  </td>\n                  <td>{item.quantity.toLocaleString()}</td>\n                {showActions && (\n                  <>\n                    <td>\n                      <div className=\"amount-input\">\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, (warehouseAmounts[item.type] || 0) - 1, item.quantity)\n                          }\n                          disabled={(warehouseAmounts[item.type] || 0) <= 0}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"number\"\n                          value={warehouseAmounts[item.type] || 0}\n                          onChange={(e) =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, parseInt(e.target.value, 10) || 0, item.quantity)\n                          }\n                        />\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, (warehouseAmounts[item.type] || 0) + 1, item.quantity)\n                          }\n                          disabled={(warehouseAmounts[item.type] || 0) >= item.quantity}\n                        >\n                          +\n                        </button>\n                        <button\n                          onClick={() =>\n                            handleAmountChange(warehouseAmounts, setWarehouseAmounts, item.type, item.quantity, item.quantity)\n                          }\n                          style={{ marginLeft: '4px' }}\n                        >\n                          {strings[165]}\n                        </button>\n                      </div>\n                    </td>\n                    <td>\n                      {resourceData?.category !== 'special' && (\n                        <div className=\"shared-buttons\">\n                          <button\n                            className={`btn-basic ${actionButtonClass || \"btn-danger\"} btn-mini`}\n                            onClick={() => handleDiscardWarehouseItem(item)}\n                            disabled={!(warehouseAmounts[item.type] > 0 && warehouseAmounts[item.type] <= item.quantity)}\n                          >\n                            {actionButtonText || strings[188]}\n                          </button>\n                        </div>\n                      )}\n                    </td>\n                    {handleSecondAction && (\n                      <td>\n                        <div className=\"shared-buttons\">\n                          <button\n                            className={`btn-basic ${secondActionButtonClass} btn-mini`}\n                            onClick={() => handleSecondAction(item)}\n                            disabled={!((amounts || warehouseAmounts)[item.type] > 0 && (amounts || warehouseAmounts)[item.type] <= item.quantity)}\n                          >\n                            {secondActionButtonText || strings[180]}\n                          </button>\n                        </div>\n                      </td>\n                    )}\n                  </>\n                )}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default ManageContentsModal;","import API_BASE from '../../config';\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Panels/Panel.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport './InventoryPanel.css'; \nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { deriveWarehouseAndBackpackCapacity, isCurrency, hasRoomFor } from '../../Utils/InventoryManagement';\nimport ManageContentsModal from './ManageContentsModal';\n\nfunction InventoryPanel({ onClose, masterResources, globalTuning, currentPlayer, setCurrentPlayer, setInventory, setBackpack, updateStatus, openPanel, setActiveStation, setModalContent, setIsModalOpen }) {\n\n    const strings = useStrings();\n    const inventory = currentPlayer?.inventory || [];\n    const backpack = currentPlayer?.backpack || [];\n    const baseWarehouseCapacity = currentPlayer?.warehouseCapacity || 0;\n    const baseBackpackCapacity = currentPlayer?.backpackCapacity || 0;\n    const [showBackpackModal, setShowBackpackModal] = useState(false);\n    const [showWarehouseModal, setShowWarehouseModal] = useState(false);\n    const [inventorySortField, setInventorySortField] = useState('name');\n    const [inventorySortDirection, setInventorySortDirection] = useState('asc');\n    const [backpackSortField, setBackpackSortField] = useState('name');\n    const [backpackSortDirection, setBackpackSortDirection] = useState('asc');\n    const [backpackAmounts, setBackpackAmounts] = useState({}); // Store amounts per resource for backpack\n    const [warehouseAmounts, setWarehouseAmounts] = useState({}); // Store amounts per resource for warehouse\n    const hasBackpackSkill = currentPlayer?.skills?.some(item => item.type === 'Backpack');\n    const finalCapacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n    \n    // Get Gold bonuses from globalTuning prop\n    const warehouseGoldBonus = globalTuning?.warehouseCapacityGold || 100000;\n    const backpackGoldBonus = globalTuning?.backpackCapacityGold || 5000;\n    \n    const calculateTotalQuantity = (inventory) =>\n        inventory.filter((item) => !isCurrency(item.type)).reduce((total, item) => total + item.quantity, 0);\n    \n    // Inventory sorting functions\n    const handleInventorySort = (field) => {\n        if (inventorySortField === field) {\n            setInventorySortDirection(inventorySortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setInventorySortField(field);\n            setInventorySortDirection('asc');\n        }\n    };\n\n    const getInventorySortIcon = (field) => {\n        if (inventorySortField !== field) return '';\n        return inventorySortDirection === 'asc' ? '' : '';\n    };\n\n    const getSortedInventory = () => {\n        const filtered = inventory.filter(item => !isCurrency(item.type));\n        \n        return filtered.sort((a, b) => {\n            let aValue, bValue;\n            \n            switch (inventorySortField) {\n                case 'name':\n                    aValue = getLocalizedString(a.type, strings).toLowerCase();\n                    bValue = getLocalizedString(b.type, strings).toLowerCase();\n                    break;\n                case 'quantity':\n                    aValue = a.quantity;\n                    bValue = b.quantity;\n                    break;\n                default:\n                    return 0;\n            }\n            \n            if (aValue < bValue) return inventorySortDirection === 'asc' ? -1 : 1;\n            if (aValue > bValue) return inventorySortDirection === 'asc' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    // Backpack sorting functions\n    const handleBackpackSort = (field) => {\n        if (backpackSortField === field) {\n            setBackpackSortDirection(backpackSortDirection === 'asc' ? 'desc' : 'asc');\n        } else {\n            setBackpackSortField(field);\n            setBackpackSortDirection('asc');\n        }\n    };\n\n    const getBackpackSortIcon = (field) => {\n        if (backpackSortField !== field) return '';\n        return backpackSortDirection === 'asc' ? '' : '';\n    };\n\n    const getSortedBackpack = () => {\n        const filtered = backpack.filter(item => !isCurrency(item.type));\n        \n        return filtered.sort((a, b) => {\n            let aValue, bValue;\n            \n            switch (backpackSortField) {\n                case 'name':\n                    aValue = getLocalizedString(a.type, strings).toLowerCase();\n                    bValue = getLocalizedString(b.type, strings).toLowerCase();\n                    break;\n                case 'quantity':\n                    aValue = a.quantity;\n                    bValue = b.quantity;\n                    break;\n                default:\n                    return 0;\n            }\n            \n            if (aValue < bValue) return backpackSortDirection === 'asc' ? -1 : 1;\n            if (aValue > bValue) return backpackSortDirection === 'asc' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    const handleAmountChange = (amounts, setAmounts, type, value, maxValue) => {\n        const clampedValue = Math.min(Math.max(0, value), maxValue);\n        setAmounts((prev) => ({\n            ...prev,\n            [type]: clampedValue,\n        }));\n    };\n\n\n    const handleMoveItem = async (item) => {\n        const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n        const amount = backpackAmounts[item.type] || 0;\n        \n        if (amount <= 0) return;\n\n        try {\n            if (isAtHome) {\n                // Check warehouse capacity before moving\n                const currentWarehouseUsage = calculateTotalQuantity(inventory);\n                const spaceAvailable = finalCapacities.warehouse - currentWarehouseUsage;\n                \n                if (amount > spaceAvailable) {\n                    updateStatus(20); // Warehouse full message\n                    return;\n                }\n                \n                const updatedWarehouse = [...inventory];\n                const existingIndex = updatedWarehouse.findIndex(i => i.type === item.type);\n                if (existingIndex !== -1) {\n                    updatedWarehouse[existingIndex].quantity += amount;\n                } else {\n                    updatedWarehouse.push({ ...item, quantity: amount });\n                }\n\n                const updatedBackpack = backpack.map(i => {\n                    if (i.type === item.type) {\n                        const newQuantity = i.quantity - amount;\n                        return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                    }\n                    return i;\n                }).filter(Boolean);\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    inventory: updatedWarehouse,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    inventory: updatedWarehouse,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setInventory(updatedWarehouse);\n                setBackpack(updatedBackpack);\n\n                updateStatus(`Moved ${amount}x ${getLocalizedString(item.type, strings)} to warehouse`);\n            } else {\n                const updatedBackpack = backpack.map(i => {\n                    if (i.type === item.type) {\n                        const newQuantity = i.quantity - amount;\n                        return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                    }\n                    return i;\n                }).filter(Boolean);\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setBackpack(updatedBackpack);\n\n                updateStatus(` Discarded ${amount}x ${getLocalizedString(item.type, strings)}`);\n            }\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleMoveAll = async () => {\n        const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n\n        try {\n            if (isAtHome) {\n                // Filter out items with special category\n                const itemsToMove = backpack.filter((item) => {\n                    const resource = masterResources.find(r => r.type === item.type);\n                    return resource?.category !== 'special';\n                });\n                \n                // Calculate total quantity to move\n                const totalToMove = itemsToMove.reduce((sum, item) => sum + item.quantity, 0);\n                const currentWarehouseUsage = calculateTotalQuantity(inventory);\n                const spaceAvailable = finalCapacities.warehouse - currentWarehouseUsage;\n                \n                if (totalToMove > spaceAvailable) {\n                    updateStatus(20); // Warehouse full message\n                    return;\n                }\n\n                const updatedWarehouseInventory = [...inventory];\n\n                itemsToMove.forEach((item) => {\n                    const existingIndex = updatedWarehouseInventory.findIndex((invItem) => invItem.type === item.type);\n                    if (existingIndex !== -1) {\n                        updatedWarehouseInventory[existingIndex].quantity += item.quantity;\n                    } else {\n                        updatedWarehouseInventory.push(item);\n                    }\n                });\n\n                // Keep items with special category in backpack\n                const updatedBackpack = backpack.filter((item) => {\n                    const resource = masterResources.find(r => r.type === item.type);\n                    return resource?.category === 'special';\n                });\n\n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    inventory: updatedWarehouseInventory,\n                    backpack: updatedBackpack,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    inventory: updatedWarehouseInventory,\n                    backpack: updatedBackpack,\n                });\n                \n                // Also update parent component's state\n                setInventory(updatedWarehouseInventory);\n                setBackpack(updatedBackpack);\n\n                updateStatus(`Moved all items to warehouse`);\n            } else {\n                // When not at home, discard all items except those with special category\n                const itemsToKeep = backpack.filter((item) => {\n                    const resource = masterResources.find(r => r.type === item.type);\n                    return resource?.category === 'special';\n                });\n                \n                await axios.post(`${API_BASE}/api/update-inventory`, {\n                    playerId: currentPlayer.playerId,\n                    backpack: itemsToKeep,\n                });\n\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    backpack: itemsToKeep,\n                });\n                \n                // Also update parent component's state\n                setBackpack(itemsToKeep);\n\n                updateStatus(` Discarded all items except special items`);\n            }\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleDiscardWarehouseItem = async (item) => {\n        try {\n            const amount = warehouseAmounts[item.type] || 0;\n            \n            if (amount <= 0) return;\n            \n            const updatedWarehouse = inventory.map(i => {\n                if (i.type === item.type) {\n                    const newQuantity = i.quantity - amount;\n                    return newQuantity > 0 ? { ...i, quantity: newQuantity } : null;\n                }\n                return i;\n            }).filter(Boolean);\n\n            await axios.post(`${API_BASE}/api/update-inventory`, {\n                playerId: currentPlayer.playerId,\n                inventory: updatedWarehouse,\n            });\n\n            setCurrentPlayer({\n                ...currentPlayer,\n                inventory: updatedWarehouse,\n            });\n            \n            // Also update parent component's state\n            setInventory(updatedWarehouse);\n\n            updateStatus(` Discarded ${amount}x ${getLocalizedString(item.type, strings)}`);\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleDiscardAllWarehouse = async () => {\n        try {\n            await axios.post(`${API_BASE}/api/update-inventory`, {\n                playerId: currentPlayer.playerId,\n                inventory: [],\n            });\n\n            setCurrentPlayer({\n                ...currentPlayer,\n                inventory: [],\n            });\n            \n            // Also update parent component's state\n            setInventory([]);\n\n            updateStatus(` Discarded all warehouse items`);\n            setShowWarehouseModal(false);\n        } catch (error) {\n            console.error('Error updating inventory:', error);\n        }\n    };\n\n    const handleTransferToBackpack = async (item) => {\n        try {\n            const amount = warehouseAmounts[item.type] || 0;\n            \n            if (amount <= 0) return;\n\n            // Check backpack capacity before transferring\n            const hasRoom = hasRoomFor({\n                resource: item.type,\n                quantity: amount,\n                currentPlayer,\n                inventory,\n                backpack,\n                masterResources,\n                globalTuning\n            });\n            \n            if (!hasRoom) {\n                const currentBackpackUsage = calculateTotalQuantity(backpack);\n                const spaceAvailable = finalCapacities.backpack - currentBackpackUsage;\n                updateStatus(` Insufficient backpack capacity. Need ${amount - spaceAvailable} more slots.`);\n                return;\n            }\n\n            // Call the new transfer API\n            const response = await axios.post(`${API_BASE}/api/transfer-inventory`, {\n                playerId: currentPlayer.playerId,\n                transfers: [{ itemType: item.type, quantity: amount }],\n                direction: 'warehouse-to-backpack'\n            });\n\n            if (response.data.success) {\n                // Update local state with the response data\n                setCurrentPlayer({\n                    ...currentPlayer,\n                    inventory: response.data.inventory,\n                    backpack: response.data.backpack,\n                });\n                \n                // Also update parent component's state\n                setInventory(response.data.inventory);\n                setBackpack(response.data.backpack);\n\n                // Reset the amount for this item\n                setWarehouseAmounts(prev => ({\n                    ...prev,\n                    [item.type]: 0\n                }));\n\n                updateStatus(` Moved ${amount}x ${getLocalizedString(item.type, strings)} to backpack`);\n            }\n        } catch (error) {\n            console.error('Error transferring to backpack:', error);\n            if (error.response?.data?.error) {\n                updateStatus(` ${error.response.data.error}`);\n            } else {\n                updateStatus(' Transfer failed. Please try again.');\n            }\n        }\n    };\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1001\" titleKey=\"1101\" panelName=\"InventoryPanel\">\n            \n\n            {/* CURRENCIES */}\n            <div className=\"currency-section\">\n                <div className=\"currency-display\">\n                    {/* Column 1: Money, Gems, and Home Deed */}\n                    <div className=\"currency-column\">\n                        <div className=\"currency-item\" title={getLocalizedString('Money', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Money')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\" title={getLocalizedString('Gem', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Gem')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\" title={getLocalizedString('Home Deed', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Home Deed')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                    </div>\n                    {/* Column 2: Hearts */}\n                    <div className=\"currency-column\">\n                        <div className=\"currency-item\" title={getLocalizedString('Yellow Heart', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Yellow Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\" title={getLocalizedString('Green Heart', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Green Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                        <div className=\"currency-item\" title={getLocalizedString('Purple Heart', strings)} style={{ cursor: 'help' }}>\n                            <span className=\"currency-emoji\"></span>\n                            <span className=\"currency-amount\">{(inventory.find(item => item.type === 'Purple Heart')?.quantity || 0).toLocaleString('en-US')}</span>\n                        </div>\n                    </div>\n                </div>\n                {/* Row 3: Keys */}\n                <div className=\"currency-keys-row\" style={{ display: 'flex', justifyContent: 'flex-start', gap: '12px', marginTop: '8px', flexWrap: 'wrap' }}>\n                    {masterResources\n                        .filter(r => isCurrency(r.type) && r.type.includes('Key'))\n                        .map(resourceDef => {\n                            const quantity = inventory.find(item => item.type === resourceDef.type)?.quantity || 0;\n                            return (\n                                <div\n                                    key={resourceDef.type}\n                                    className=\"currency-item\"\n                                    title={getLocalizedString(resourceDef.type, strings)}\n                                    style={{ cursor: 'help' }}\n                                >\n                                    <span className=\"currency-emoji\">{resourceDef.symbol || ''}</span>\n                                    <span className=\"currency-amount\">{quantity}</span>\n                                </div>\n                            );\n                        })\n                    }\n                </div>\n            </div>\n\n            <hr className=\"inventory-divider\" />\n\n            {/* BACKPACK */}\n\n            <div className=\"inventory-section-header\">\n                <h3>{strings[182]}</h3>\n                {hasBackpackSkill && (\n                    <div className=\"capacity-info\">\n                        {calculateTotalQuantity(backpack)} / {\" \"}\n                        <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n                            {finalCapacities.backpack}\n                        </span>\n                    </div>\n                )}\n            </div>\n\n            {hasBackpackSkill ? (\n              <>\n                {currentPlayer?.accountStatus === \"Gold\" && (\n                    <div style={{fontSize: \"12px\", color: \"#666\", marginTop: \"-5px\", textAlign: \"center\", marginBottom: \"8px\"}}>\n                        (+{backpackGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n                    </div>\n                )}\n\n                {backpack.length > 0 && (\n                <div className=\"shared-buttons\" style={{ display: 'flex', gap: '8px' }}>\n                    <button className=\"btn-basic\" style={{ flex: 1 }} onClick={() => setShowBackpackModal(true)}>\n                    {strings[184]}\n                    </button>\n                    <div style={{ flex: 1 }}></div>\n                </div>\n                )}\n                <div className=\"backpack-table-container\" style={{height: 'auto', maxHeight: '300px'}}>\n                    {backpack.filter(item => !isCurrency(item.type)).length > 0 ? (\n                        <>\n                            <div className=\"backpack-table-header\">\n                                <table>\n                                    <thead>\n                                        <tr>\n                                            <th onClick={() => handleBackpackSort('name')} className=\"sortable-header\">\n                                                {strings[191] || \"Item\"} {getBackpackSortIcon('name')}\n                                            </th>\n                                            <th onClick={() => handleBackpackSort('quantity')} className=\"sortable-header\">\n                                                {strings[185] || \"Quantity\"} {getBackpackSortIcon('quantity')}\n                                            </th>\n                                        </tr>\n                                    </thead>\n                                </table>\n                            </div>\n                            <div className=\"backpack-table-scroll\">\n                                <table>\n                                    <tbody>\n                                        {getSortedBackpack().map((item, index) => (\n                                            <tr key={index}>\n                                                <td>{masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}</td>\n                                                <td>{item.quantity.toLocaleString()}</td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        </>\n                    ) : (\n                        <p>{strings[77]}</p>\n                    )}\n                </div>\n              </>\n            ) : (\n              <div className=\"capacity-display\">{strings[75]}</div>\n            )}\n\n            <hr className=\"inventory-divider\" />\n\n            {/* WAREHOUSE */}\n\n            <div className=\"inventory-section-header\">\n                <h3>{strings[181]}</h3>\n                <div className=\"capacity-info\">\n                    {calculateTotalQuantity(inventory)} / {\" \"}\n                    <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n                        {finalCapacities.warehouse}\n                    </span>\n                </div>\n            </div>\n\n            {currentPlayer?.accountStatus === \"Gold\" && (\n                <div style={{fontSize: \"12px\", color: \"#666\", marginTop: \"-5px\", textAlign: \"center\", marginBottom: \"8px\"}}>\n                    (+{warehouseGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n                </div>\n            )}\n\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '8px' }}>\n                {inventory.length > 0 && (\n                <button\n                    className=\"btn-basic\"\n                    style={{ flex: 1 }}\n                    onClick={() => setShowWarehouseModal(true)}\n                    disabled={currentPlayer.location.g !== currentPlayer.gridId}\n                    title={currentPlayer.location.g !== currentPlayer.gridId ? \"Must be at homestead to manage warehouse\" : \"\"}\n                >\n                {strings[184]}\n                </button>\n                )}\n                <button className=\"btn-basic btn-success\" style={{ flex: 1 }} onClick={() => {\n                    onClose();\n                    setTimeout(() => {\n                        openPanel('WarehousePanel');\n                    }, 0);\n                }}>\n                {strings[194]}\n                </button>\n            </div>\n\n            {/* INGREDIENT LIST */}\n\n            <div className=\"inventory-table-container\">\n                {inventory.filter(item => !isCurrency(item.type)).length > 0 ? (\n                    <>\n                        <div className=\"inventory-table-header\">\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th onClick={() => handleInventorySort('name')} className=\"sortable-header\">\n                                            {strings[191] || \"Item\"} {getInventorySortIcon('name')}\n                                        </th>\n                                        <th onClick={() => handleInventorySort('quantity')} className=\"sortable-header\">\n                                            {strings[185] || \"Quantity\"} {getInventorySortIcon('quantity')}\n                                        </th>\n                                    </tr>\n                                </thead>\n                            </table>\n                        </div>\n                        <div className=\"inventory-table-scroll\">\n                            <table>\n                                <tbody>\n                                    {getSortedInventory().map((item, index) => (\n                                        <tr key={index}>\n                                            <td>{masterResources.find(r => r.type === item.type)?.symbol || ''} {getLocalizedString(item.type, strings)}</td>\n                                            <td>{item.quantity.toLocaleString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    </>\n                ) : (\n                    <p>{strings[76]}</p>\n                )}\n            </div>\n\n\n            {showBackpackModal && (() => {\n                const isAtHome = currentPlayer.location.g === currentPlayer.gridId;\n                const nonSpecialItems = backpack.filter((item) => {\n                    const resource = masterResources.find(r => r.type === item.type);\n                    return resource?.category !== 'special';\n                });\n                const isAddAllDisabled = isAtHome ? (backpack.length === 0 || nonSpecialItems.length === 0) : \n                                        (backpack.length === 0 || nonSpecialItems.length === 0);\n                return (\n                    <div className=\"modal-overlay\">\n                        <div className=\"modal-container modal-large\">\n                            <button className=\"modal-close-btn\" onClick={() => setShowBackpackModal(false)}></button>\n                            <div className=\"modal-title\">{strings[187]}</div>\n\n                        <ManageContentsModal\n                            inventory={backpack}\n                            masterResources={masterResources}\n                            showActions={true}\n                            warehouseAmounts={backpackAmounts}\n                            setWarehouseAmounts={setBackpackAmounts}\n                            handleAmountChange={handleAmountChange}\n                            handleDiscardWarehouseItem={(item) => {\n                                const resource = masterResources.find(r => r.type === item.type);\n                                const isSpecialItem = resource?.category === 'special';\n                                \n                                if (isSpecialItem || !(backpackAmounts[item.type] > 0 && backpackAmounts[item.type] <= item.quantity)) {\n                                    return;\n                                }\n                                handleMoveItem(item);\n                            }}\n                            actionButtonText={isAtHome ? strings[196] : strings[188]}\n                            actionButtonClass=\"btn-success\"\n                            strings={strings}\n                        />\n\n                        <div className=\"modal-buttons shared-buttons\">\n                            <button \n                                className=\"btn-basic btn-modal btn-success\" \n                                onClick={handleMoveAll} \n                                disabled={isAddAllDisabled}\n                            >\n                                {isAtHome ? strings[189] : strings[190]}\n                            </button>\n                        </div>\n                    </div>\n                </div>\n                );\n            })()}\n\n            {showWarehouseModal && (\n                <div className=\"modal-overlay\">\n                    <div className=\"modal-container modal-large\">\n                        <button className=\"modal-close-btn\" onClick={() => setShowWarehouseModal(false)}></button>\n                        <div className=\"modal-title\">{strings[193]}</div>\n\n                        <ManageContentsModal\n                        inventory={inventory}\n                        masterResources={masterResources}\n                        showActions={true}\n                        warehouseAmounts={warehouseAmounts}\n                        setWarehouseAmounts={setWarehouseAmounts}\n                        handleAmountChange={handleAmountChange}\n                        handleDiscardWarehouseItem={handleDiscardWarehouseItem}\n                        handleSecondAction={handleTransferToBackpack}\n                        secondActionButtonText={strings[180]}\n                        secondActionButtonClass=\"btn-success\"\n                        strings={strings}\n                    />\n\n                    <div className=\"modal-buttons shared-buttons\">\n                        <button \n                            className=\"btn-basic btn-modal btn-danger\" \n                            onClick={() => {\n                            setModalContent({\n                                title: \"Are you sure?\",\n                                message: \"This will permanently discard ALL items in your warehouse!\",\n                                message2: \"This action cannot be undone.\",\n                                custom: (\n                                    <div className=\"shared-buttons\" style={{ marginTop: '20px' }}>\n                                        <button \n                                            className=\"btn-basic btn-danger\" \n                                            onClick={() => {\n                                                handleDiscardAllWarehouse();\n                                                setIsModalOpen(false);\n                                            }}\n                                        >\n                                            Yes, Discard All\n                                        </button>\n                                        <button \n                                            className=\"btn-basic btn-success\" \n                                            onClick={() => setIsModalOpen(false)}\n                                            style={{ marginLeft: '10px' }}\n                                        >\n                                            Cancel\n                                        </button>\n                                    </div>\n                                )\n                            });\n                            setIsModalOpen(true);\n                        }}\n                        >\n                            {strings[190]}\n                        </button>\n                    </div>\n                    </div>\n                </div>\n            )}\n        </Panel>\n    );\n}\n\nexport default InventoryPanel;","import React from 'react';\nimport { getLocalizedString } from '../Utils/stringLookup';\nimport { calculateGemSpeedupCost } from './EconomyUtils';\nimport './GemCosts.css';\n\n// Pure function that doesn't use hooks\nexport const calculateGemPurchase = ({ \n    resource, \n    inventory, \n    backpack, \n    masterResources,\n    currentPlayer,\n    strings,\n    overrideGemCost = null\n}) => {\n    // Ensure arrays are defined\n    const safeInventory = inventory || [];\n    const safeBackpack = backpack || [];\n    const safeMasterResources = masterResources || [];\n    \n    // Calculate total gems from inventory and backpack\n    const inventoryGems = safeInventory.find(item => item.type === 'Gem')?.quantity || 0;\n    const backpackGems = safeBackpack.find(item => item.type === 'Gem')?.quantity || 0;\n    const playerGems = inventoryGems + backpackGems;\n    const ownedSkills = currentPlayer?.skills || [];\n    \n    // Track what will be spent (simplified - only actual quantities)\n    const spendingItems = [];\n    \n    // Calculate for ingredient requirements - track what player can actually spend\n    for (let i = 1; i <= 10; i++) {\n        const ingredientType = resource[`ingredient${i}`];\n        const ingredientQty = resource[`ingredient${i}qty`];\n        \n        if (ingredientType && ingredientQty) {\n            const resourceData = safeMasterResources.find(r => r.type === ingredientType);\n            \n            // Calculate what player has\n            const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n            const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n            const playerQty = inventoryQty + backpackQty;\n            const willSpend = Math.min(playerQty, ingredientQty);\n            \n            // Track what will be spent\n            if (willSpend > 0) {\n                spendingItems.push({\n                    symbol: resourceData?.symbol || '',\n                    name: getLocalizedString(ingredientType, strings),\n                    amount: willSpend\n                });\n            }\n        }\n    }\n    \n    // Calculate for skill requirement\n    if (resource.requires) {\n        const requiredSkill = safeMasterResources.find(r => r.type === resource.requires);\n        \n        // Check if player has the required skill\n        const hasSkill = ownedSkills.some(skill => skill.type === resource.requires);\n        if (hasSkill) {\n            spendingItems.push({\n                symbol: requiredSkill?.symbol || '',\n                name: getLocalizedString(resource.requires, strings),\n                amount: '',\n                isSkill: true\n            });\n        }\n    }\n    \n    // Calculate gem cost using simplified approach\n    let gemCost;\n    \n    // If an override gem cost is provided (like for speedups), use it directly\n    if (overrideGemCost !== null && overrideGemCost !== undefined) {\n        gemCost = overrideGemCost;\n    } else {\n        // Only charge for missing ingredients - resource.gemcost is the total if you had nothing\n        // Calculate missing ingredient costs\n        let missingIngredientCost = 0;\n        for (let i = 1; i <= 10; i++) {\n            const ingredientType = resource[`ingredient${i}`];\n            const ingredientQty = resource[`ingredient${i}qty`];\n            \n            if (ingredientType && ingredientQty) {\n                const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n                const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const missingQty = Math.max(0, ingredientQty - playerQty);\n                \n                if (missingQty > 0) {\n                    const resourceData = safeMasterResources.find(r => r.type === ingredientType);\n                    const ingredientGemCost = resourceData?.gemcost || 1;\n                    missingIngredientCost += ingredientGemCost * missingQty;\n                }\n            }\n        }\n        \n        // Check missing skill cost\n        if (resource.requires) {\n            const hasSkill = ownedSkills.some(skill => skill.type === resource.requires);\n            if (!hasSkill) {\n                const requiredSkill = safeMasterResources.find(r => r.type === resource.requires);\n                const skillGemCost = requiredSkill?.gemcost || 1;\n                missingIngredientCost += skillGemCost;\n            }\n        }\n        \n        // Gem cost is ONLY the cost of missing ingredients\n        gemCost = Math.ceil(missingIngredientCost);\n        \n        // Minimum of 1 gem if there are any missing ingredients\n        if (gemCost === 0 && missingIngredientCost > 0) {\n            gemCost = 1;\n        }\n    }\n    \n    // Create a modified recipe for purchase\n    const getModifiedRecipe = () => {\n        const modifiedRecipe = { ...resource };\n        \n        // Adjust ingredient quantities to what player actually has\n        for (let i = 1; i <= 10; i++) {\n            const ingredientType = resource[`ingredient${i}`];\n            const ingredientQty = resource[`ingredient${i}qty`];\n            \n            if (ingredientType && ingredientQty) {\n                const inventoryQty = safeInventory.find(inv => inv.type === ingredientType)?.quantity || 0;\n                const backpackQty = safeBackpack.find(item => item.type === ingredientType)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                \n                // Set to what player can actually spend\n                modifiedRecipe[`ingredient${i}qty`] = Math.min(playerQty, ingredientQty);\n            }\n        }\n        \n        // Add gems as the next available ingredient slot\n        // Find the first empty slot after existing ingredients\n        let gemSlot = 1;\n        for (let i = 1; i <= 10; i++) {\n            if (!resource[`ingredient${i}`]) {\n                gemSlot = i;\n                break;\n            }\n        }\n        \n        modifiedRecipe[`ingredient${gemSlot}`] = 'Gem';\n        modifiedRecipe[`ingredient${gemSlot}qty`] = gemCost;\n        \n        return modifiedRecipe;\n    };\n    \n    const hasEnoughGems = playerGems >= gemCost;\n    \n    return {\n        render: () => (\n            <div className=\"gem-purchase-tooltip\">                \n                <div className=\"spending-summary\">\n                    <div className=\"spending-label\">Will use:</div>\n                    {spendingItems.map((item, index) => (\n                        <div key={index} className=\"spending-line\">\n                            {item.symbol} {item.amount} {item.isSkill ? '(Skill)' : ''}\n                        </div>\n                    ))}\n                    <div className=\"spending-line gem-line\">\n                         {gemCost}  (You have:  {playerGems})\n                    </div>\n                </div>\n                \n                \n                {!hasEnoughGems && (\n                    <div className=\"tooltip-footer\">\n                        Click for more \n                    </div>\n                )}\n            </div>\n        ),\n        getModifiedRecipe,\n        hasEnoughGems,\n        gemCost\n    };\n};\n\nexport default calculateGemPurchase;","import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { calculateGemPurchase } from '../../Economy/GemCosts';\nimport { useStrings } from '../StringsContext';\nimport { usePanelContext } from '../Panels/PanelContext';\nimport './ResourceButton.css';\n\n// Utility function to format numbers with locale-specific comma separators\nconst formatNumber = (number) => {\n  if (typeof number === 'number') {\n    return number.toLocaleString();\n  }\n  if (typeof number === 'string' && !isNaN(Number(number))) {\n    return Number(number).toLocaleString();\n  }\n  return number; // Return as-is if it's not a number\n};\n\n// Function to format numbers in HTML details strings\nconst formatDetailsForDisplay = (details) => {\n  if (!details || typeof details !== 'string') {\n    return details;\n  }\n  \n  // Replace standalone numbers (not part of words) with formatted versions\n  // This regex finds numbers that are either at word boundaries or surrounded by non-alphanumeric characters\n  return details.replace(/\\b(\\d{4,})\\b/g, (match, number) => {\n    return formatNumber(parseInt(number, 10));\n  });\n};\n \nconst ResourceButton = ({\n  symbol,\n  name,\n  details,\n  info,\n  disabled,\n  className,\n  style,\n  onClick,\n  hideInfo = false,\n  children,\n  // Transaction support props\n  transactionKey,\n  onTransactionAction,\n  isTransactionMode = false,\n  // Gem button props\n  gemCost = null,\n  onGemPurchase = null,\n  hideGem = false,\n  // Level requirement - if false, gem button is hidden (cannot bypass level with gems)\n  meetsLevelRequirement = true,\n  // For gem calculation\n  resource = null,\n  inventory = null,\n  backpack = null,\n  masterResources = null,\n  currentPlayer = null,\n  // Developer-only styling - applies danger/red tint to buttons for devonly resources\n  devOnly = false\n}) => { \n  const strings = useStrings();\n  const { openPanel } = usePanelContext();\n  const [showInfo, setShowInfo] = useState(false);\n  const [tooltipPosition, setTooltipPosition] = useState({ top: 0, left: 0 });\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [transactionId] = useState(() => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const [showGemTooltip, setShowGemTooltip] = useState(false);\n  const [gemTooltipPosition, setGemTooltipPosition] = useState({ top: 0, left: 0 });\n  const buttonRef = useRef(null);\n  \n  // Only create gem calculation when we have gem functionality enabled\n  const shouldCalculateGem = !!(resource && inventory && backpack && masterResources && currentPlayer && onGemPurchase && (gemCost || resource?.gemcost));\n  \n  const gemCalculation = useMemo(() => {\n    if (!shouldCalculateGem) {\n      return null;\n    }\n    \n    try {\n      return calculateGemPurchase({\n        resource,\n        inventory,\n        backpack,\n        masterResources,\n        currentPlayer,\n        strings,\n        overrideGemCost: gemCost // Pass the explicit gem cost if provided\n      });\n    } catch (error) {\n      console.error('Error creating gem calculation:', error);\n      return null;\n    }\n  }, [shouldCalculateGem, resource, inventory, backpack, masterResources, currentPlayer, strings]);\n\n  // Debug processing state changes\n  useEffect(() => {\n    if (isTransactionMode && transactionKey) {\n      console.log(` [RESOURCE_BUTTON] Processing state changed: ${isProcessing} for ${transactionKey}`);\n    }\n  }, [isProcessing, transactionKey, isTransactionMode]);\n\n  const updateTooltipPosition = (event) => {\n    setTooltipPosition({\n      top: event.clientY + window.scrollY + 10, //  Adjust Y position (below cursor)\n      left: event.clientX + window.scrollX + 15, //  Adjust X position (to the right of cursor)\n    });\n  };\n\n  const updateGemTooltipPosition = (event) => {\n    setGemTooltipPosition({\n      top: event.clientY + window.scrollY + 10,\n      left: event.clientX + window.scrollX + 15,\n    });\n  };\n\n  const handleClick = async (e) => {\n    if (disabled || isProcessing) return;\n\n    if (isTransactionMode && onTransactionAction && transactionKey) {\n      // Transaction mode - prevent multiple clicks\n      e.preventDefault();\n      e.stopPropagation();\n      \n      console.log(` [RESOURCE_BUTTON] Setting processing state for ${transactionKey}`);\n      setIsProcessing(true);\n      try {\n        await onTransactionAction(transactionId, transactionKey);\n        console.log(` [RESOURCE_BUTTON] Transaction completed for ${transactionKey}`);\n      } catch (error) {\n        console.error('Transaction failed:', error);\n      } finally {\n        console.log(` [RESOURCE_BUTTON] Clearing processing state for ${transactionKey}`);\n        setIsProcessing(false);\n      }\n    } else if (onClick) {\n      // Normal mode\n      onClick(e);\n    }\n  };\n\n  const handleGemClick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (onGemPurchase && gemCalculation) {\n      if (gemCalculation.hasEnoughGems) {\n        // Has enough gems - execute the purchase\n        const modifiedRecipe = gemCalculation.getModifiedRecipe();\n        onGemPurchase(modifiedRecipe);\n      } else {\n        // Not enough gems - open the HowToGemsPanel\n        openPanel('HowToGemsPanel');\n      }\n    }\n  };\n\n  return (\n    <>\n      <div\n        className=\"resource-button-wrapper\"\n      >\n        <button\n          ref={buttonRef}\n          className={`resource-button ${disabled || isProcessing ? 'disabled' : ''} ${className || ''} ${isProcessing ? 'processing' : ''} ${devOnly ? 'dev-only' : ''}`}\n          onClick={handleClick}\n          disabled={disabled || isProcessing}\n          style={{\n            opacity: (disabled || isProcessing) ? 0.6 : 1,\n            cursor: (disabled || isProcessing) ? 'not-allowed' : 'pointer',\n            ...style\n          }}\n        >\n\n          {/*  Ensure default content is displayed */}\n          <span className=\"resource-title\">\n            {isProcessing ? '' : symbol} {isProcessing ? 'Processing...' : name}\n          </span>\n          {!isProcessing && (\n            <span className=\"resource-details\" dangerouslySetInnerHTML={{\n              __html: details ? formatDetailsForDisplay(details) : details\n            }} />\n          )}\n\n\n          {/*  Render children properly (fixes missing text issue) */}\n          {children}\n          \n          {/*  Hide \"\" info button when `hideInfo` is true */}\n          {!hideInfo && info && (\n            <span\n              className=\"info-button\"\n              onMouseEnter={(event) => {\n                setShowInfo(true);\n                updateTooltipPosition(event);\n              }}\n              onMouseMove={updateTooltipPosition} //  Dynamically reposition on cursor move\n              onMouseLeave={() => setShowInfo(false)}\n            >\n              \n            </span>\n            )}\n\n        </button>\n\n        {/*  Gem button for gem purchases - moved outside button so it's always clickable */}\n        {/* Hidden when level requirement not met - cannot bypass level requirements with gems */}\n        {!hideGem && meetsLevelRequirement && shouldCalculateGem && gemCalculation && !isProcessing && (\n          <span\n            className=\"gem-button\"\n            onClick={handleGemClick}\n            onMouseEnter={(event) => {\n              setShowGemTooltip(true);\n              updateGemTooltipPosition(event);\n            }}\n            onMouseMove={updateGemTooltipPosition}\n            onMouseLeave={() => setShowGemTooltip(false)}\n          >\n            \n          </span>\n        )}\n      </div>\n\n      {/*  Render info toaster inside `document.body` for proper layering */}\n      {showInfo && info && ReactDOM.createPortal(\n        <div\n          className=\"info-toaster\"\n          style={{\n            top: tooltipPosition.top,\n            left: tooltipPosition.left,\n            position: 'absolute', //  Prevents clipping\n          }}\n        >\n          {typeof info === 'string' ? (\n            <p dangerouslySetInnerHTML={{ __html: info }} />\n          ) : (\n            <>{info}</> //  Supports JSX rendering\n          )}\n        </div>,\n        document.body\n      )}\n\n      {/*  Render gem tooltip inside `document.body` for proper layering */}\n      {showGemTooltip && gemCalculation && ReactDOM.createPortal(\n        <div\n          style={{\n            top: gemTooltipPosition.top,\n            left: gemTooltipPosition.left,\n            position: 'absolute',\n            zIndex: 99999,\n          }}\n        >\n          {gemCalculation.render()}\n        </div>,\n        document.body\n      )}\n    </>\n  );\n};\n\nexport default ResourceButton;","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { canAfford, isCurrency } from '../../Utils/InventoryManagement';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { deriveWarehouseAndBackpackCapacity } from '../../Utils/InventoryManagement';\nimport { handlePurchase } from '../../Store/Store';\nimport GoldPassBenefitsModal from '../../UI/Modals/GoldPassBenefitsModal';\nimport './WarehousePanel.css';\n\nconst WarehousePanel = ({\n  onClose,\n  setInventory,\n  currentPlayer,\n  setCurrentPlayer,\n  masterResources,\n  globalTuning,\n  masterWarehouse,\n  updateStatus,\n}) => {\n  const strings = useStrings();\n  const inventory = currentPlayer?.inventory || [];\n  const [currentLevel, setCurrentLevel] = useState(0);\n  const [nextLevel, setNextLevel] = useState(null);\n  const [needsLevelMigration, setNeedsLevelMigration] = useState(false);\n  const [showBenefitsModal, setShowBenefitsModal] = useState(false);\n\n  // Calculate current warehouse level and handle backward compatibility\n  useEffect(() => {\n    if (!masterWarehouse || masterWarehouse.length === 0) return;\n    \n    // Use the stored level if available\n    if (currentPlayer?.warehouseLevel !== undefined) {\n      setCurrentLevel(currentPlayer.warehouseLevel);\n      setNeedsLevelMigration(false);\n    } else {\n      // For backward compatibility, start at level 0\n      setCurrentLevel(0);\n      setNeedsLevelMigration(true);\n      \n      // Auto-migrate the level to the player document\n      if (currentPlayer?.playerId) {\n        migrateLevelToPlayer(0);\n      }\n    }\n    \n    // Get next level data\n    const level = currentPlayer?.warehouseLevel ?? currentLevel;\n    if (level < masterWarehouse.length - 1) {\n      setNextLevel(masterWarehouse[level + 1]);\n    } else {\n      setNextLevel(null);\n    }\n  }, [currentPlayer?.warehouseCapacity, currentPlayer?.warehouseLevel, masterWarehouse]);\n\n  // Function to migrate level to player document\n  const migrateLevelToPlayer = async (level) => {\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          warehouseLevel: level\n        }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer({\n          ...currentPlayer,\n          warehouseLevel: level\n        });\n        setNeedsLevelMigration(false);\n        console.log('Successfully migrated warehouse level to player document');\n      }\n    } catch (error) {\n      console.error('Error migrating warehouse level:', error);\n    }\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleUpgrade(modifiedRecipe);\n  };\n\n  const handleUpgrade = async (customRecipe = null) => {\n    if (!nextLevel) return;\n\n    const recipeToUse = customRecipe || nextLevel;\n\n    // Build ingredients array\n    const ingredients = [];\n    \n    // Add all 5 potential ingredients (including gems if present)\n    for (let i = 1; i <= 5; i++) {\n      const ingredientType = recipeToUse[`ingredient${i}`];\n      const ingredientQty = recipeToUse[`ingredient${i}qty`];\n      \n      if (ingredientType && ingredientQty) {\n        ingredients.push({\n          type: ingredientType,\n          quantity: ingredientQty\n        });\n      }\n    }\n    \n    console.log('Warehouse upgrade - Recipe to use:', recipeToUse);\n    console.log('Warehouse upgrade - Ingredients array:', ingredients);\n\n    // Check if player can afford (now handled by spendIngredients)\n    if (!customRecipe && !canAfford(nextLevel, inventory, null, 1)) {\n      updateStatus(16); // Cannot afford message\n      return;\n    }\n\n    try {\n      // Spend ingredients using the proper async function\n      const spendSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: recipeToUse,\n        inventory,\n        backpack: [],\n        setInventory,\n        setBackpack: () => {}, // Not using backpack for warehouse upgrades\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spendSuccess) {\n        console.warn('Failed to spend ingredients.');\n        return;\n      }\n      \n      // Calculate new capacity and level\n      const newCapacity = (currentPlayer.warehouseCapacity || 1000) + nextLevel.add;\n      const newLevel = nextLevel.Level;\n      \n      // Update player's warehouse capacity AND level\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          warehouseCapacity: newCapacity,\n          warehouseLevel: newLevel\n        }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer({\n          ...currentPlayer,\n          warehouseCapacity: newCapacity,\n          warehouseLevel: newLevel\n        });\n\n        updateStatus(`${strings[197] || \"Warehouse upgraded\"}`);\n      }\n    } catch (error) {\n      console.error('Error upgrading warehouse:', error);\n      updateStatus('Failed to upgrade warehouse');\n    }\n  };\n\n  // Get current capacity info\n  const finalCapacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n  \n  // Get Gold bonus from globalTuning prop\n  const warehouseGoldBonus = globalTuning?.warehouseCapacityGold || 100000;\n  \n  // Calculate total quantity in warehouse (excluding currencies)\n  const calculateTotalQuantity = (inventory) => {\n    if (!inventory || !Array.isArray(inventory)) return 0;\n    return inventory\n      .filter((item) => item && !isCurrency(item.type))\n      .reduce((total, item) => total + (item.quantity || 0), 0);\n  };\n  \n  const currentUsage = calculateTotalQuantity(inventory);\n\n  return (\n    <Panel \n      onClose={onClose} \n      titleKey=\"181\" // \"Warehouse\"\n      panelName=\"WarehousePanel\"\n    >\n      <div className=\"standard-panel\">\n        <div className=\"warehouse-capacity-display\">\n          <h3>\n            {strings[183]} {currentUsage} / {\" \"}\n            <span style={currentPlayer?.accountStatus === \"Gold\" ? {color: \"#B8860B\"} : {}}>\n              {finalCapacities.warehouse}\n            </span>\n          </h3>\n          {currentPlayer?.accountStatus === \"Gold\" && (\n            <p style={{fontSize: \"14px\", color: \"#666\", margin: \"5px 0\"}}>\n              (+{warehouseGoldBonus.toLocaleString()} {strings[89] || \"additional capacity for Gold Pass\"})\n            </p>\n          )}\n        </div>\n\n\n\n        {nextLevel ? (\n          <>\n            <div className=\"skills-options\">\n              <ResourceButton\n                symbol=\"\"\n                name={strings[2024] || \"Upgrade Warehouse\"}\n                details={(() => {\n                  // Build details string similar to CraftingStation\n                  const ingredients = [];\n                  for (let i = 1; i <= 5; i++) {\n                    const type = nextLevel[`ingredient${i}`];\n                    const qty = nextLevel[`ingredient${i}qty`];\n                    if (!type || !qty) continue;\n                    \n                    const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                    const playerQty = inventoryQty;\n                    const color = playerQty >= qty ? 'green' : 'red';\n                    const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                    ingredients.push(`<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`);\n                  }\n                  return `${strings[461] || \"Requires:\"}<div>${ingredients.join('')}</div>`;\n                })()}\n                info={`+${nextLevel.add} ${strings[2021] || \"capacity\"}`}\n                disabled={!canAfford(nextLevel, inventory, null, 1)}\n                onClick={() => handleUpgrade()}\n                // Don't pass gemCost prop - instead ensure resource has gemcost property\n                onGemPurchase={!canAfford(nextLevel, inventory, null, 1) ? handleGemPurchase : null}\n                resource={{...nextLevel, gemcost: 1}} // Add gemcost property to enable gem button\n                inventory={inventory}\n                backpack={[]}\n                masterResources={masterResources}\n                currentPlayer={currentPlayer}\n              />\n            </div>\n            <p className=\"upgrade-info\">\n              {strings[196] || \"Add\"} {nextLevel.add} {strings[198] || \"to warehouse capacity\"}\n            </p>\n          </>\n        ) : (\n          <div className=\"max-level\">\n            <p>{strings[88] || \"Your warehouse is at maximum capacity.\"}</p>\n          </div>\n        )}\n\n        {/* Gold Pass promotion for non-Gold users */}\n        {currentPlayer?.accountStatus !== 'Gold' && (\n          <>\n            <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%', margin: '20px 0' }}>\n              <button\n                className=\"btn-basic btn-gold\"\n                onClick={() => handlePurchase(1, currentPlayer, updateStatus)}\n              >\n                {strings[9061]}\n              </button>\n            </div>\n            <div className=\"gold-pass-info\" style={{ textAlign: 'center', marginBottom: '20px', fontSize: '14px', color: '#666' }}>\n              {strings[199]}\n            </div>\n          </>\n        )}\n\n        {/* Link to view Gold Pass benefits */}\n        <div style={{ textAlign: 'center', marginTop: '10px' }}>\n          <button\n            onClick={() => setShowBenefitsModal(true)}\n            style={{\n              background: 'none',\n              border: 'none',\n              color: '#B8860B',\n              textDecoration: 'underline',\n              cursor: 'pointer',\n              fontSize: '14px',\n            }}\n          >\n            {strings[10131] || \"Gold Pass Benefits\"}\n          </button>\n        </div>\n\n      </div>\n\n      {/* Gold Pass Benefits Modal */}\n      <GoldPassBenefitsModal\n        isOpen={showBenefitsModal}\n        onClose={() => setShowBenefitsModal(false)}\n      />\n    </Panel>\n  );\n};\n\nexport default WarehousePanel;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Panels/Panel.css';\nimport './TrophyPanel.css'; \nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport FloatingTextManager from '../../UI/FloatingText';\n\n\nfunction TrophyPanel({ onClose, masterResources, masterTrophies, currentPlayer, setCurrentPlayer, updateStatus, openPanel, setActiveStation, inventory, setInventory, backpack, setBackpack }) {\n\n    const strings = useStrings();\n    const [trophies, setTrophies] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [collecting, setCollecting] = useState(null); // Track which trophy is being collected\n    \n    useEffect(() => {\n        // Fetch trophies when panel opens\n        const fetchTrophies = async () => {\n            try {\n                setLoading(true);\n                const response = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}/trophies`);\n                if (response.data.success) {\n                    setTrophies(response.data.trophies || []);\n                }\n            } catch (error) {\n                console.error('Error fetching trophies:', error);\n                updateStatus('Failed to load trophies');\n            } finally {\n                setLoading(false);\n            }\n        };\n        \n        if (currentPlayer?.playerId) {\n            fetchTrophies();\n        }\n    }, [currentPlayer?.playerId]);\n    \n    // Handle collecting trophy reward\n    const handleCollectReward = async (trophyName) => {\n        try {\n            setCollecting(trophyName);\n            \n            const response = await axios.post(`${API_BASE}/api/collect-trophy-reward`, {\n                playerId: currentPlayer.playerId,\n                trophyName: trophyName\n            });\n            \n            if (response.data.success) {\n                const { gemReward, inventory } = response.data;\n                \n                // Update inventory from server response\n                if (inventory) {\n                    setInventory(inventory);\n                    setCurrentPlayer(prev => ({ ...prev, inventory }));\n                }\n                \n                // Update local trophy state to mark as collected\n                setTrophies(prevTrophies => \n                    prevTrophies.map(t => \n                        t.name === trophyName ? { ...t, collected: true } : t\n                    )\n                );\n                \n                FloatingTextManager.addFloatingText(`+${gemReward} `, window.innerWidth / 2, window.innerHeight / 2, 64);\n                updateStatus(` Earned ${gemReward} Gem${gemReward > 1 ? 's' : ''} from your trophy`);\n            } else {\n                updateStatus(response.data.message || 'Failed to collect reward');\n            }\n        } catch (error) {\n            console.error('Error collecting trophy reward:', error);\n            updateStatus('Failed to collect trophy reward');\n        } finally {\n            setCollecting(null);\n        }\n    };\n\n    // Helper function to get progress info\n    const getProgressInfo = (trophyDef, playerTrophy) => {\n        if (!trophyDef.progress || trophyDef.progress.length === 0) return null;\n        \n        const currentProgress = playerTrophy?.progress || 0;\n        const progressArray = trophyDef.progress;\n        \n        // Find last achieved milestone and next milestone\n        let lastAchievedMilestone = null;\n        let lastMilestone = 0; // For progress bar calculation\n        let nextMilestone = progressArray[0];\n        \n        for (let i = 0; i < progressArray.length; i++) {\n            if (currentProgress >= progressArray[i]) {\n                // This milestone has been achieved\n                lastAchievedMilestone = progressArray[i];\n                lastMilestone = progressArray[i];\n                // Look for next milestone\n                if (i + 1 < progressArray.length) {\n                    nextMilestone = progressArray[i + 1];\n                } else {\n                    // Max milestone reached\n                    nextMilestone = progressArray[i];\n                }\n            } else {\n                // Found the next milestone to achieve\n                nextMilestone = progressArray[i];\n                break;\n            }\n        }\n        \n        // For display, we show progress between current milestone boundaries\n        const progressBetweenMilestones = currentProgress - lastMilestone;\n        const milestoneDifference = nextMilestone - lastMilestone;\n        const percentage = milestoneDifference > 0 ? (progressBetweenMilestones / milestoneDifference) * 100 : 100;\n        \n        return {\n            current: currentProgress,\n            lastAchievedMilestone, // The actual milestone number to display on icon\n            lastMilestone, // For progress bar calculation\n            nextMilestone,\n            percentage: Math.min(100, Math.max(0, percentage)),\n            displayText: `${currentProgress} / ${nextMilestone}`,\n            hasAchievedAll: currentProgress >= progressArray[progressArray.length - 1]\n        };\n    };\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1035\" titleKey=\"1135\" panelName=\"TrophyPanel\">\n            \n            <div className=\"trophy-container\">\n                {loading ? (\n                    <div className=\"loading\">Loading trophies...</div>\n                ) : (\n                    <div className=\"trophy-grid\">\n                        {masterTrophies?.filter(trophy => trophy.visible !== false).sort((a, b) => {\n                            // Sort trophies by status:\n                            // 1. Earned but not collected (highest priority)\n                            // 2. Earned and collected\n                            // 3. Not earned (lowest priority)\n                            \n                            const playerTrophyA = trophies.find(t => t.name === a.name);\n                            const playerTrophyB = trophies.find(t => t.name === b.name);\n                            \n                            const isEarnedA = !!playerTrophyA;\n                            const isEarnedB = !!playerTrophyB;\n                            \n                            const hasUncollectedRewardA = isEarnedA && playerTrophyA?.collected === false;\n                            const hasUncollectedRewardB = isEarnedB && playerTrophyB?.collected === false;\n                            \n                            // If both have uncollected rewards, maintain original order\n                            if (hasUncollectedRewardA && hasUncollectedRewardB) return 0;\n                            // If only A has uncollected reward, A comes first\n                            if (hasUncollectedRewardA && !hasUncollectedRewardB) return -1;\n                            // If only B has uncollected reward, B comes first\n                            if (!hasUncollectedRewardA && hasUncollectedRewardB) return 1;\n                            \n                            // Neither has uncollected rewards, check if earned\n                            // If both are earned and collected, maintain original order\n                            if (isEarnedA && isEarnedB) return 0;\n                            // If only A is earned, A comes first\n                            if (isEarnedA && !isEarnedB) return -1;\n                            // If only B is earned, B comes first\n                            if (!isEarnedA && isEarnedB) return 1;\n                            \n                            // Neither is earned, maintain original order\n                            return 0;\n                        }).map((trophyDef, index) => {\n                            // Find if player has earned this trophy\n                            const playerTrophy = trophies.find(t => t.name === trophyDef.name);\n                            const isEarned = !!playerTrophy;\n                            const progressInfo = trophyDef.type === 'Progress' ? getProgressInfo(trophyDef, playerTrophy) : null;\n                            const hasUncollectedReward = isEarned && playerTrophy?.collected === false;\n                            const isCollecting = collecting === trophyDef.name;\n                            \n                            return (\n                                <div \n                                    key={index} \n                                    className={`trophy-card ${!isEarned ? 'unearned' : ''} trophy-${(trophyDef.type || 'Event').toLowerCase()}`}\n                                    data-tooltip={trophyDef.tooltip || ''}\n                                >\n                                    <div className=\"trophy-icon-wrapper\">\n                                        <div className=\"trophy-icon\"></div>\n                                        {isEarned && trophyDef.type === 'Progress' && progressInfo?.lastAchievedMilestone && (\n                                            <div className=\"progress-number\">{progressInfo.lastAchievedMilestone}</div>\n                                        )}\n                                    </div>\n                                    <div className=\"trophy-content\">\n                                        <div className=\"trophy-name\">\n                                            {getLocalizedString(trophyDef.name, strings)}\n                                        </div>\n                                        {trophyDef.type === 'Progress' && progressInfo && (\n                                            <div className=\"trophy-progress-container\">\n                                                <div className=\"progress-text\">\n                                                    {progressInfo.displayText}\n                                                </div>\n                                                <div className=\"progress-bar\">\n                                                    <div\n                                                        className=\"progress-fill\"\n                                                        style={{\n                                                            width: `${Math.min(100, Math.max(0, progressInfo.percentage))}%`\n                                                        }}\n                                                    />\n                                                </div>\n                                            </div>\n                                        )}\n                                        {trophyDef.type === 'Count' && isEarned && playerTrophy?.qty > 0 && (\n                                            <div className=\"trophy-count\">\n                                                <div className=\"count-text\">\n                                                    {playerTrophy.qty}x\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                    {hasUncollectedReward && (\n                                        <div \n                                            className=\"trophy-reward-gem\"\n                                            onClick={() => handleCollectReward(trophyDef.name)}\n                                            style={{\n                                                opacity: isCollecting ? 0.5 : 1,\n                                                cursor: isCollecting ? 'wait' : 'pointer'\n                                            }}\n                                        >\n                                            \n                                        </div>\n                                    )}\n                                </div>\n                            );\n                        })}\n                    </div>\n                )}\n            </div>\n  \n        </Panel>\n    );\n}\n\nexport default TrophyPanel;","import React, { memo } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { useStrings } from '../StringsContext';\n\nconst HowToPanel = memo(({ onClose }) => {\n  const strings = useStrings();\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1018\" titleKey=\"1118\" panelName=\"HowToPanel\">\n      <div className=\"panel-content\">\n        <h2>{strings[9001]}</h2>\n        <p>{strings[9002]}</p>\n        <p>{strings[9003]}</p>\n        <h3>{strings[9004]}</h3>\n        <p>{strings[9005]}</p>\n        <p>{strings[9006]}</p>\n        <p>{strings[9007]}</p>\n        <h3>{strings[9008]}</h3>\n        <p>{strings[9009]}</p>\n        <p>{strings[9010]}</p>\n        <p>{strings[9011]}</p>\n        <h3>{strings[9012]}</h3>\n        <p>{strings[9013]}</p>\n        <p>{strings[9014]}</p>\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToPanel;\n","import React, { memo } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { useStrings } from '../StringsContext';\n\nconst HowToMoneyPanel = memo(({ onClose }) => {\n\n  const strings = useStrings();\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1026\" titleKey=\"1126\" panelName=\"HowToMoneyPanel\">\n      <div className=\"panel-content\">\n\n        <h2>{strings[9020]}</h2>\n        <p>{strings[9021]}</p>\n        <p>{strings[9022]}</p>\n        <p>{strings[9023]}</p>\n        <p>{strings[9024]}</p>\n        <h2>{strings[9025]}</h2>\n        <p>{strings[9026]}</p>\n        <p>{strings[9027]}</p>\n\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToMoneyPanel;\n","import React, { memo, useState, useEffect } from 'react';\nimport Panel from './Panel'; // Importing the shared Panel component\nimport { handlePurchase } from '../../Store/Store';\nimport { useStrings } from '../StringsContext';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport '../Buttons/SharedButtons.css';\n\nconst HowToGemsPanel = memo(({ currentPlayer, updateStatus, onClose }) => {\n\n  const strings = useStrings();\n  const [offers, setOffers] = useState({});\n\n  useEffect(() => {\n    const fetchOffers = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/store-offers`);\n        const offerData = response.data || [];\n        // Convert array to object keyed by id for easy lookup\n        const offerMap = {};\n        offerData.forEach(offer => {\n          offerMap[offer.id] = offer;\n        });\n        setOffers(offerMap);\n      } catch (error) {\n        console.error(\" Failed to load store offers:\", error);\n      }\n    };\n    fetchOffers();\n  }, []);\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1034\" titleKey=\"1134\" panelName=\"HowToGemsPanel\">\n      <div className=\"panel-content\">\n\n        <h2>{strings[9030]}</h2>\n        <p>{strings[9031]}</p>\n        <p>{strings[9032]}</p>\n\n        <div className=\"shared-buttons\" style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '100%', gap: '10px' }}>\n        <p style={{ marginBottom: '0px', fontWeight: 'bold' }}>{strings[9040]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(6, currentPlayer, updateStatus)}>{strings[9041]}{offers[6] ? ` $${offers[6].price.toFixed(2)}` : ''}</button>\n        <p style={{ marginBottom: '0px', marginTop: '6px', fontWeight: 'bold' }}>{strings[9042]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(7, currentPlayer, updateStatus)}>{strings[9043]}{offers[7] ? ` $${offers[7].price.toFixed(2)}` : ''}</button>\n        <p style={{ marginBottom: '0px', marginTop: '6px', fontWeight: 'bold' }}>{strings[9044]}</p>\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(8, currentPlayer, updateStatus)}>{strings[9045]}{offers[8] ? ` $${offers[8].price.toFixed(2)}` : ''}</button>\n        </div>\n\n        <p>{strings[9033]}</p>\n\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default HowToGemsPanel;\n","import React from 'react';\nimport './QuestButton.css';\nimport { useStrings } from '../StringsContext';\n\nconst QuestButton = ({ quest, state, onClick }) => {\n  const strings = useStrings();\n  const { symbol, title, completed, goals = [], reward, rewardqty } = quest;\n\n  return (\n    <div\n      className={`quest-item ${state}`}\n      onClick={onClick}\n    >\n      <div className=\"quest-header\">\n        <h2>{symbol}</h2>\n        {state === 'reward' && <span className=\"quest-checkmark\"></span>}\n      </div>\n      <h2>{title}</h2>\n      <h4>{completed ? strings[206] : strings[207]}</h4>\n      {goals.map((goal, index) =>\n        goal.action && goal.item && goal.qty ? (\n          <p key={index}>\n            {goal.action} {goal.item} x{goal.qty}: {goal.progress} of {goal.qty}\n          </p>\n        ) : null\n      )}\n      {reward && rewardqty && (\n        <p>Reward: {rewardqty} {reward}</p>\n      )}\n    </div>\n  );\n};\n\nconst QuestGiverButton = ({ quest, state, onClick, xpReward, level, meetsLevelRequirement = true }) => {\n  const strings = useStrings();\n  const { symbol, title, reward, rewardqty, goals = [] } = quest;\n  const buttonText = state === 'reward' ? strings[208] : strings[209];\n  const isDisabled = !meetsLevelRequirement;\n\n  const handleClick = () => {\n    if (!isDisabled && onClick) {\n      onClick();\n    }\n  };\n\n  return (\n    <div\n      className={`quest-item ${state}${isDisabled ? ' disabled' : ''}`}\n      onClick={handleClick}\n      style={isDisabled ? { opacity: 0.6, cursor: 'not-allowed' } : {}}\n    >\n      <div className=\"quest-header\">\n        <h2>{symbol}</h2>\n        {state === 'reward' && <span className=\"quest-checkmark\"></span>}\n      </div>\n      <h2>{title}</h2>\n      {level && (\n        <p style={{ color: meetsLevelRequirement ? 'green' : 'red', margin: '2px 0', fontWeight: 'bold' }}>\n          {strings[10149] || 'Level'} {level}\n        </p>\n      )}\n      <div className=\"quest-goals\">\n        {goals.map((goal, index) =>\n          goal.action && goal.item && goal.qty ? (\n            <p key={index}>{goal.action} {goal.item} x{goal.qty}</p>\n          ) : null\n        )}\n      </div>\n      <p>Reward: {rewardqty} {reward}</p>\n      {xpReward && state === 'reward' && (\n        <p style={{ color: '#4CAF50', marginTop: '5px' }}> +{xpReward} XP</p>\n      )}\n      <button className=\"quest-giver-button\">{buttonText}</button>\n    </div>\n  );\n};\n\nexport { QuestButton, QuestGiverButton };","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport { QuestButton } from '../../UI/Buttons/QuestButton';\nimport '../../UI/Buttons/ResourceButton.css';\nimport '../../UI/Buttons/QuestButton.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction QuestPanel({ onClose, currentPlayer }) {\n  const strings = useStrings();\n  const [playerQuests, setPlayerQuests] = useState([]);\n  const [questTemplates, setQuestTemplates] = useState([]);\n\n  // Re-evaluate quest progress for \"Acquire\" quests\n  const reevaluateQuestProgress = async (quests) => {\n    if (!quests || quests.length === 0) return quests;\n    \n    let questsUpdated = false;\n    const updatedQuests = quests.map(quest => {\n      if (quest.completed || quest.rewardCollected) return quest;\n      \n      const updatedQuest = { ...quest };\n      const progress = { ...quest.progress };\n      let goalsCompleted = 0;\n      let totalGoals = 0;\n      \n      // Check each goal\n      for (let i = 1; i <= 3; i++) {\n        const goalAction = quest[`goal${i}action`];\n        const goalItem = quest[`goal${i}item`];\n        const goalQty = quest[`goal${i}qty`];\n        \n        if (!goalAction || !goalItem || !goalQty) continue;\n        totalGoals++;\n        \n        // Special handling for \"Acquire\" goals\n        if (goalAction === \"Acquire\") {\n          const playerHasSkill = currentPlayer.skills?.some(skill => skill.type === goalItem);\n          const playerHasPower = currentPlayer.powers?.some(power => power.type === goalItem);\n          \n          if (playerHasSkill || playerHasPower) {\n            // Mark this goal as completed if not already\n            if (progress[`goal${i}`] < goalQty) {\n              progress[`goal${i}`] = goalQty;\n              questsUpdated = true;\n            }\n          }\n        }\n        \n        // Check if goal is completed\n        if (progress[`goal${i}`] >= goalQty) {\n          goalsCompleted++;\n        }\n      }\n      \n      // Update quest completion status\n      if (goalsCompleted === totalGoals && totalGoals > 0 && !updatedQuest.completed) {\n        updatedQuest.completed = true;\n        questsUpdated = true;\n      }\n      \n      updatedQuest.progress = progress;\n      return updatedQuest;\n    });\n    \n    // If quests were updated, save to server\n    if (questsUpdated) {\n      try {\n        await axios.post(`${API_BASE}/api/update-player-quests`, {\n          playerId: currentPlayer.playerId,\n          activeQuests: updatedQuests,\n        });\n      } catch (error) {\n        console.error('Error updating quest progress:', error);\n      }\n    }\n    \n    return updatedQuests;\n  };\n\n  // Load active player quests\n  useEffect(() => {\n    if (currentPlayer?.activeQuests) {\n      // Re-evaluate quest progress before displaying\n      reevaluateQuestProgress(currentPlayer.activeQuests).then(updatedQuests => {\n        setPlayerQuests(updatedQuests);\n      });\n    }\n  }, [currentPlayer?.activeQuests, currentPlayer?.skills, currentPlayer?.powers, currentPlayer?.playerId]);\n\n  // Load all quest templates from tuning file\n  useEffect(() => {\n    const fetchQuestTemplates = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/quests`);\n        setQuestTemplates(response.data || []);\n      } catch (error) {\n        console.error('Error fetching quest templates:', error);\n      }\n    };\n    fetchQuestTemplates();\n  }, []);\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1006\" titleKey=\"1106\" panelName=\"QuestPanel\">\n      {(!playerQuests || playerQuests.length === 0) ? (\n        <p>{strings[203]}</p>\n      ) : (\n        <div className=\"standard-panel\">\n          {playerQuests.map((quest, index) => {\n            const template = questTemplates.find(t => t.title === quest.questId);\n            const goals = [\n              {\n                action: quest.goal1action,\n                item: quest.goal1item,\n                qty: quest.goal1qty,\n                progress: quest.progress?.goal1 || 0,\n              },\n              {\n                action: quest.goal2action,\n                item: quest.goal2item,\n                qty: quest.goal2qty,\n                progress: quest.progress?.goal2 || 0,\n              },\n              {\n                action: quest.goal3action,\n                item: quest.goal3item,\n                qty: quest.goal3qty,\n                progress: quest.progress?.goal3 || 0,\n              },\n            ].filter(goal => goal.action && goal.item && goal.qty);\n\n            return (\n              <QuestButton\n                key={index}\n                className={`resource-button ${quest.completed ? 'reward' : 'in-progress'}`}\n                quest={{\n                  symbol: quest.symbol,\n                  title: quest.questId,\n                  completed: quest.completed,\n                  goals,\n                  textbody: template?.textbody || '',\n                  reward: template?.reward || '',\n                  rewardqty: template?.rewardqty || 1,\n                }}\n                state={quest.completed ? 'reward' : 'in-progress'}\n                onClick={null}\n              />\n            );\n          })}\n        </div>\n      )}\n    </Panel>\n  );\n}\n\nexport default QuestPanel;","import axios from 'axios';\nimport API_BASE from '../../config';\nimport RelationshipMatrix from './RelationshipMatrix.json';\n\n/**\n * Central utility for managing relationship changes\n * Creates a new relationship if it doesn't exist, or updates existing one\n */\nexport const updateRelationship = async (currentPlayer, targetName, delta) => {\n  \n  try {\n    const playerId = currentPlayer._id || currentPlayer.playerId;\n    \n    // Check if relationship exists\n    const existingRelationship = currentPlayer.relationships?.find(rel => rel.name === targetName);\n    \n    if (!existingRelationship) {\n      // Create new relationship\n      const response = await axios.post(`${API_BASE}/api/add-relationship`, {\n        playerId,\n        targetName,\n        initialScore: delta\n      });\n      \n      return {\n        success: response.data.success,\n        player: response.data.player,\n        relationships: response.data.relationships\n      };\n    } else {\n      // Update existing relationship\n      const response = await axios.post(`${API_BASE}/api/update-relationship`, {\n        playerId,\n        targetName,\n        delta: delta\n      });\n      \n      return {\n        success: response.data.success,\n        player: response.data.player,\n        relationships: response.data.relationships,\n        relationship: response.data.relationship\n      };\n    }\n  } catch (error) {\n    console.error('Error updating relationship:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Update relationship status (friend, crush, love, married, rival, etc.)\n */\nexport const updateRelationshipStatus = async (currentPlayer, targetName, status, value) => {\n  try {\n    const playerId = currentPlayer._id || currentPlayer.playerId;\n    \n    const response = await axios.post(`${API_BASE}/api/add-or-update-relationship-status`, {\n      playerId,\n      name: targetName,\n      status: status,\n      value: value\n    });\n    \n    // Check for \"Meet the Cast\" trophy if status is \"met\" and value is true\n    if (response.data.success && status === 'met' && value === true) {\n      // Get all character names from RelationshipMatrix\n      const allCharacters = RelationshipMatrix\n        .filter(char => char.type)\n        .map(char => char.type);\n      \n      // Check if player has met all characters\n      const updatedPlayer = response.data.player;\n      const metCharacters = updatedPlayer.relationships.filter(rel => rel.met === true);\n      const hasMetAll = allCharacters.every(charName => \n        metCharacters.some(rel => rel.name === charName)\n      );\n      \n      if (hasMetAll) {\n        // Award \"Meet the Cast\" trophy\n        try {\n          const trophyResponse = await axios.post(`${API_BASE}/api/earn-trophy`, {\n            playerId,\n            trophyName: 'Meet the Cast'\n          });\n          \n          if (trophyResponse.data.success && trophyResponse.data.isNewMilestone) {\n            console.log(` Player earned Meet the Cast trophy!`);\n            // Trophy notification will be handled by the earn-trophy endpoint\n          }\n        } catch (trophyError) {\n          console.error('Error awarding Meet the Cast trophy:', trophyError);\n        }\n      }\n    }\n    \n    return {\n      success: response.data.success,\n      player: response.data.player,\n      relationship: response.data.relationship\n    };\n  } catch (error) {\n    console.error('Error updating relationship status:', error);\n    return { success: false, error: error.message };\n  }\n};\n\n/**\n * Get relationship status between player and target\n */\nexport const getRelationshipStatus = (currentPlayer, targetName) => {\n  if (!currentPlayer?.relationships) return null;\n  \n  return currentPlayer.relationships.find(rel => rel.name === targetName) || {\n    name: targetName,\n    relscore: 0\n  };\n};\n\n\n/**\n * Get NPC reactions when player forms a new relationship status\n * Returns an array of NPCs that would react and their relationship changes\n */\nexport const getNPCReactions = (targetNPC, newStatus) => {\n  const reactions = [];\n  \n  // RelationshipMatrix is now an array, so iterate through it\n  RelationshipMatrix.forEach((npcEntry) => {\n    // Get the NPC name from the 'type' field\n    const npc = npcEntry.type;\n    \n    // Skip the target NPC\n    if (npc === targetNPC) return;\n    \n    // Check if this NPC has a relationship with the target\n    const npcRelationshipWithTarget = npcEntry[targetNPC];\n    \n    if (npcRelationshipWithTarget) {\n      // If new status is love, and another NPC loves this NPC\n      if (newStatus === 'love' && npcRelationshipWithTarget === 'love') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n      // If new status is friend, and another NPC has Rival with this NPC\n      else if (newStatus === 'friend' && npcRelationshipWithTarget === 'rival') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n      // If new status is friend, and another NPC has Friend with this NPC\n      else if (newStatus === 'friend' && npcRelationshipWithTarget === 'friend') {\n        reactions.push({\n          npc: npc,\n          scoreChange: 30\n        });\n      }\n      // If new status is rival, and another NPC has Rival with this NPC\n      else if (newStatus === 'rival' && npcRelationshipWithTarget === 'rival') {\n        reactions.push({\n          npc: npc,\n          scoreChange: 50\n        });\n      }\n      // If new status is rival, and another NPC has Love with this NPC\n      else if (newStatus === 'rival' && npcRelationshipWithTarget === 'love') {\n        reactions.push({\n          npc: npc,\n          setScore: -50,\n          clearAllStatuses: true,\n          setStatus: 'rival'\n        });\n      }\n    }\n  });\n  \n  return reactions;\n};\n\n/**\n * Check if an interaction should be blocked based on other relationships\n * Returns { allowed: boolean, reason?: string }\n */\nexport const checkOtherRelationships = (currentPlayer, targetNPC, interaction) => {\n  // Check if this interaction would add a relationship status\n  if (!interaction.relbitadd) {\n    return { allowed: true };\n  }\n  \n  // Check for married status - can only be married to one NPC\n  if (interaction.relbitadd === 'married') {\n    const existingMarriage = currentPlayer.relationships?.find(rel => \n      rel.married === true && rel.name !== targetNPC\n    );\n    if (existingMarriage) {\n      return { \n        allowed: false, \n        reason: `You are already married to ${existingMarriage.name}` \n      };\n    }\n  }\n  \n  // Check for friend status with rivals\n  if (interaction.relbitadd === 'friend') {\n    // Get all NPCs that are rivals of the target\n    const targetRivals = [];\n    RelationshipMatrix.forEach((npcEntry) => {\n      const npc = npcEntry.type;\n      if (npcEntry[targetNPC] === 'rival') {\n        targetRivals.push(npc);\n      }\n    });\n    \n    // Check if player is friends with any of target's rivals\n    for (const rival of targetRivals) {\n      const playerRelWithRival = currentPlayer.relationships?.find(rel => rel.name === rival);\n      if (playerRelWithRival?.friend === true) {\n        return { \n          allowed: false, \n          reason: `${targetNPC} won't be friends with you because you're friends with ${rival}` \n        };\n      }\n    }\n  }\n  \n  // Check for love/crush status with NPCs who are already in love\n  if (interaction.relbitadd === 'love' || interaction.relbitadd === 'crush') {\n    // Check if target NPC already loves someone else\n    const targetNPCEntry = RelationshipMatrix.find(entry => entry.type === targetNPC);\n    if (targetNPCEntry) {\n      // Find who the target loves by checking all their relationships\n      const targetLoves = Object.entries(targetNPCEntry)\n        .filter(([key, value]) => key !== 'type' && key !== 'symbol' && value === 'love');\n      \n      if (targetLoves.length > 0) {\n        return { \n          allowed: false, \n          reason: `${targetNPC} is already in love with ${targetLoves[0][0]}` \n        };\n      }\n    }\n  }\n  \n  return { allowed: true };\n};\n\n/**\n * Generate a status message for relationship changes\n * @param {string} targetName - The NPC the player interacted with\n * @param {string} newStatus - The new relationship status (if any)\n * @param {boolean} success - Whether the interaction was successful\n * @param {Array} reactions - Array of NPC reactions from getNPCReactions\n * @param {Object} strings - The strings object from useStrings hook\n * @returns {string} The status message to display\n */\nexport const generateRelationshipStatusMessage = (targetName, newStatus, success, reactions = [], strings = {}) => {\n  let message = '';\n  \n  if (success && newStatus) {\n    // Generate primary status message based on the new status\n    switch (newStatus) {\n      case 'met':\n        message = `${strings[602]} ${targetName}.`;\n        break;\n      case 'friend':\n        message = `${strings[603]} ${targetName}.`;\n        break;\n      case 'crush':\n        message = `${strings[604]} ${targetName}.`;\n        break;\n      case 'love':\n        message = `${strings[605]} ${targetName}.`;\n        break;\n      case 'married':\n        message = `${strings[606]} ${targetName} ${strings[607]}`;\n        break;\n      case 'rival':\n        message = `${strings[606]} ${targetName} ${strings[608]}`;\n        break;\n      default:\n        message = `${strings[615]} ${targetName} ${strings[616]}`;\n    }\n    \n    // Add reaction messages if there are any\n    if (reactions && reactions.length > 0) {\n      const negativeReactions = reactions.filter(r => r.setStatus === 'rival' || r.scoreChange < 0);\n      const positiveReactions = reactions.filter(r => r.scoreChange > 0 && r.setStatus !== 'rival');\n      \n      if (negativeReactions.length > 0) {\n        if (negativeReactions.length === 1) {\n          const reaction = negativeReactions[0];\n          if (reaction.setStatus === 'rival') {\n            message += ` ${reaction.npc} ${strings[609]}`;\n          } else {\n            message += ` ${reaction.npc} ${strings[610]}`;\n          }\n        } else {\n          const npcNames = negativeReactions.map(r => r.npc).join(` ${strings[614]} `);\n          message += ` ${npcNames} ${strings[611]}`;\n        }\n      }\n      \n      if (positiveReactions.length > 0) {\n        if (positiveReactions.length === 1) {\n          const reaction = positiveReactions[0];\n          message += ` ${reaction.npc} ${strings[612]}`;\n        } else {\n          const npcNames = positiveReactions.map(r => r.npc).join(` ${strings[614]} `);\n          message += ` ${npcNames} ${strings[613]}`;\n        }\n      }\n    }\n  }\n  \n  return message;\n};\n\n/**\n * Get resource multiplier based on relationship status with an NPC\n * @param {string} npcName - The name of the NPC\n * @param {Object} currentPlayer - The current player object with relationships\n * @param {Object} strings - The localized strings object\n * @returns {Object} - { multiplier: number, bonusMessage: string }\n */\nexport const getRelationshipMultiplier = (npcName, currentPlayer, strings) => {\n\n  // Find the NPC in the RelationshipMatrix\n  const npcEntry = RelationshipMatrix.find(entry => entry.type === npcName);\n\n  // If no NPC entry found or no buffs defined, return default\n  if (!npcEntry || (!npcEntry.buff4friend && !npcEntry.buff4love && !npcEntry.buff4marriage)) {\n    return { multiplier: 1, bonusMessage: '' };\n  }\n  \n  // Find player's relationship with this NPC\n  const relationship = currentPlayer.relationships?.find(rel => rel.name === npcName);\n  \n  if (!relationship) {\n    return { multiplier: 1, bonusMessage: '' };\n  }\n  \n  // Check relationship status and apply appropriate buff\n  if (relationship.married === true && npcEntry.buff4marriage) {\n    return { \n      multiplier: npcEntry.buff4marriage, \n      bonusMessage: ` ${npcEntry.buff4marriage}x ${strings[621]}` \n    };\n  } else if (relationship.love === true && npcEntry.buff4love) {\n    return { \n      multiplier: npcEntry.buff4love, \n      bonusMessage: ` ${npcEntry.buff4love}x ${strings[623]}` \n    };\n  } else if (relationship.friend === true && npcEntry.buff4friend) {\n    return { \n      multiplier: npcEntry.buff4friend, \n      bonusMessage: ` ${npcEntry.buff4friend}x ${strings[622]}` \n    };\n  }\n  \n  return { multiplier: 1, bonusMessage: '' };\n};\n","import React, { useState, useEffect } from 'react';\nimport './Conversation.css';\nimport ConversationManager from './ConversationManager';\nimport RelationshipMatrix from './RelationshipMatrix.json';\nimport Topics from './Topics.json';\n\n// Track conversation results for chance modification\nlet conversationResults = {\n  matchingInterests: 0,\n  matchingRandom: 0,\n  matchingTopics: 0,\n  rivalTopics: 0,\n  totalRounds: 0\n};\n\n// Helper function to check NPC relationship between two NPCs\n// Returns 'rival', 'friend', 'love', or null\nconst checkNPCRelationship = (currentNpcType, targetNpcType) => {\n  if (!currentNpcType || !targetNpcType) return null;\n\n  const npcEntry = RelationshipMatrix.find(entry => entry.type === currentNpcType);\n  if (!npcEntry) return null;\n\n  // Check if the target NPC is defined as a relationship in the current NPC's entry\n  const relationship = npcEntry[targetNpcType];\n  if (relationship === 'rival' || relationship === 'friend' || relationship === 'love') {\n    return relationship;\n  }\n\n  return null;\n};\n\n// Helper function to find NPC type from symbol\nconst findNPCTypeFromSymbol = (symbol) => {\n  if (!symbol) return null;\n  const entry = RelationshipMatrix.find(entry => entry.symbol === symbol);\n  return entry?.type || null;\n};\n\n/**\n * Centralized topic comparison function\n * Determines match state and chance modifier based on player and NPC topics\n * Can have custom rules per interaction type and round number\n *\n * @param {string} playerTopic - The symbol shown by the player\n * @param {string} npcTopic - The symbol shown by the NPC\n * @param {string} npcId - The NPC being talked to\n * @param {object} interaction - The interaction definition (Talk, Joke, etc.)\n * @param {number} roundNum - Which round of conversation (1, 2, 3)\n * @returns {{ matchState: false|'match'|'rival', chanceModifier: number }}\n */\nconst compareTopics = (playerTopic, npcTopic, npcId, interaction, roundNum) => {\n  let matchState = false;\n  let chanceModifier = 0;\n\n  // Check if player showed an NPC character\n  const playerNpcType = findNPCTypeFromSymbol(playerTopic);\n\n  // For interactions involving NPC symbols (like Talk round 3), use relationship-based matching\n  if (playerNpcType) {\n    // Player showed an NPC - check NPC's relationship to that character\n    const relationship = checkNPCRelationship(npcId, playerNpcType);\n\n    if (relationship === 'rival') {\n      // NPC considers player's shown character a rival - always negative\n      matchState = 'rival';\n      chanceModifier = -0.15;\n    } else if (relationship === 'friend' || relationship === 'love') {\n      // NPC likes player's shown character - always positive\n      matchState = 'match';\n      chanceModifier = 0.1;\n    } else if (playerTopic === npcTopic) {\n      // Neutral relationship but exact match (coincidental) - positive\n      matchState = 'match';\n      chanceModifier = 0.1;\n    }\n    // If neutral and no match, matchState stays false (neutral)\n  } else {\n    // Player showed a non-NPC symbol (resource, emoji, etc.)\n    if (playerTopic === npcTopic) {\n      // Exact match on non-NPC symbols\n      matchState = 'match';\n      chanceModifier = 0.1;\n    }\n    // No match = neutral\n  }\n\n  // Future: Add custom rules per interaction type\n  // if (interaction?.interaction === 'Joke') { ... }\n  // if (interaction?.interaction === 'Compliment') { ... }\n\n  return { matchState, chanceModifier };\n};\n\n// Calculate modified chance based on conversation results\nexport const calculateModifiedChance = (baseChance, interaction, conversationResults, currentPlayer, targetName) => {\n  let modifiedChance = baseChance || 1.0;\n\n  // 1. Add bonus for matching topics during conversation (any topic type)\n  if (interaction.interaction === 'Talk' && conversationResults.matchingTopics > 0) {\n    // Add 0.1 for each matching topic (compounding effect for all 3 rounds)\n    modifiedChance += (0.1 * conversationResults.matchingTopics);\n  }\n\n  // 2. Subtract penalty for rival topics during conversation\n  if (interaction.interaction === 'Talk' && conversationResults.rivalTopics > 0) {\n    // Subtract 0.15 for each rival topic (significant penalty)\n    modifiedChance -= (0.15 * conversationResults.rivalTopics);\n  }\n\n  // 3. Add bonus for relationship status buffs\n  // Note: Statuses are stored as boolean properties on relationship (e.g., rel.friend = true)\n  if (currentPlayer && currentPlayer.relationships) {\n    const relationship = currentPlayer.relationships.find(rel => rel.name === targetName);\n    if (relationship) {\n      // Check relbuff1, relbuff2, relbuff3\n      for (let i = 1; i <= 3; i++) {\n        const buffField = interaction[`relbuff${i}`];\n        if (buffField && relationship[buffField] === true) {\n          // Add the buff amount (default 0.2 if not specified)\n          modifiedChance += (interaction.relbuff || 0.2);\n          break; // Only apply buff once\n        }\n      }\n    }\n  }\n  \n  // Cap at 1.0 (100% chance)\n  return Math.min(modifiedChance, 1.0);\n};\n\n// Main conversation sequence handler\nexport const playConversation = async (\n  playerPosition,\n  npcPosition,\n  playerEmoji = '',\n  npcEmoji = '',\n  TILE_SIZE,\n  onComplete,\n  playerId = null,\n  npcId = null,\n  interaction = null,\n  currentPlayer = null,\n  masterResources = null\n) => {\n  \n  // Reset conversation results\n  conversationResults = {\n    matchingInterests: 0,\n    matchingRandom: 0,\n    matchingTopics: 0,\n    rivalTopics: 0,\n    totalRounds: 0\n  };\n  \n  // Use rounds from interaction if available, otherwise random 1-3\n  const numExchanges = interaction?.rounds || (Math.floor(Math.random() * 3) + 1);\n  \n  // Helper function to get current TILE_SIZE dynamically\n  const getCurrentTileSize = () => {\n    // Try to get the actual tile size from the DOM element\n    const gameContainer = document.querySelector('.homestead');\n    if (gameContainer) {\n      const gridElement = gameContainer.querySelector('.grid');\n      if (gridElement) {\n        const firstTile = gridElement.querySelector('.tile');\n        if (firstTile) {\n          return firstTile.offsetWidth;\n        }\n      }\n    }\n    return TILE_SIZE; // Fallback to passed TILE_SIZE\n  };\n\n  \n  // Create context for topic resolution\n  const topicContext = {\n    playerIcon: currentPlayer?.icon || playerEmoji,\n    npcIcon: npcEmoji,\n    currentPlayer: currentPlayer,\n    interaction: interaction,\n    masterResources: masterResources,\n    npcId: npcId\n  };\n  \n  // Add relationship score if it exists\n  if (currentPlayer?.relationships && npcId) {\n    const relationship = currentPlayer.relationships.find(rel => rel.name === npcId);\n    if (relationship) {\n      topicContext.relscore = relationship.relscore;\n    }\n  }\n  \n  // Play conversation sequence\n  for (let i = 0; i < numExchanges; i++) {\n    const roundNum = i + 1;\n    conversationResults.totalRounds = roundNum;\n    \n    // Player speaks - use provided ID or position-based ID\n    const playerSpeakerId = playerId || `player_${Math.floor(playerPosition.x)}_${Math.floor(playerPosition.y)}`;\n    const playerTopicKey = interaction?.[`playertopic${roundNum}`];\n    const playerTopic = playerTopicKey ? getTopicSymbol(playerTopicKey, topicContext, true) : '';\n    \n    await showSpeech('player', playerSpeakerId, playerEmoji, playerTopic);\n    // Removed character animation\n    await delay(1200);\n    await hideSpeech(playerSpeakerId);\n\n    await delay(400); // Brief pause between speakers\n\n    // NPC responds - use provided ID or position-based ID\n    const npcSpeakerId = npcId || `npc_${Math.floor(npcPosition.x)}_${Math.floor(npcPosition.y)}`;\n    const npcTopicKey = interaction?.[`npctopic${roundNum}`];\n\n    // Pass player's topic to context so NPC can react dynamically\n    topicContext.playerTopic = playerTopic;\n    topicContext.roundNum = roundNum;\n\n    const npcTopic = npcTopicKey ? getTopicSymbol(npcTopicKey, topicContext, false) : '';\n\n    // Use centralized comparison function to determine match state\n    const { matchState, chanceModifier } = compareTopics(\n      playerTopic,\n      npcTopic,\n      npcId,\n      interaction,\n      roundNum\n    );\n\n    // Track results for chance calculation\n    if (matchState === 'match') {\n      conversationResults.matchingTopics++;\n    } else if (matchState === 'rival') {\n      conversationResults.rivalTopics++;\n    }\n\n    await showSpeech('npc', npcSpeakerId, npcEmoji, npcTopic, matchState);\n    // Removed character animation\n    await delay(1200);\n    await hideSpeech(npcSpeakerId);\n\n    await delay(400); // Brief pause before next exchange\n  }\n  \n  // Conversation complete - trigger callback with results\n  if (onComplete) {\n    onComplete(conversationResults);\n  }\n};\n\n\n// Convert topic key to actual symbol/emoji\nexport const getTopicSymbol = (topicKey, context = {}, isPlayerTurn = false) => {\n  if (!topicKey) return ''; // Default fallback\n  \n  // Handle emoji shortcuts\n  if (topicKey.startsWith('emoji_')) {\n    const emojiMap = {\n      'emoji_heart': '',\n      'emoji_pinkheart': '',\n      'emoji_friend': '',\n      'emoji_diamond': '',\n      'emoji_forgive': '',\n      'emoji_questionmark': '',\n      'emoji_annoyed': '',\n      'emoji_laughing': '',\n      'emoji_blush': '',\n      'emoji_hug': '',\n      'emoji_wink': '',\n      'emoji_kiss': '',\n      'emoji_angry': '',\n      'emoji_sad': '',\n      'emoji_happy': '',\n      'emoji_thinking': '',\n      'emoji_wow': '',\n      'emoji_love': '',\n      'emoji_cool': '',\n      'emoji_party': '',\n      'emoji_sleepy': '',\n      'emoji_hungry': '',\n      'emoji_brokenheart': ''\n    };\n    return emojiMap[topicKey] || '';\n  }\n  \n  // Handle special context-based topics\n  switch (topicKey) {\n    case 'player':\n      return context.playerIcon || '';\n      \n    case 'npc':\n      return context.npcIcon || '';\n      \n    case 'interest':\n      // Show player's top resources from backpack (priority) or inventory (fallback)\n      if (isPlayerTurn && context.currentPlayer && context.masterResources) {\n        const inventory = context.currentPlayer.inventory || [];\n        const backpack = context.currentPlayer.backpack || [];\n\n        // Use backpack if it has items, otherwise fall back to inventory\n        const itemSource = backpack.length > 0 ? backpack : inventory;\n\n        // Sort by quantity and get top 5, only from doober category resources\n        const topItems = itemSource\n          .filter(item => {\n            const resource = context.masterResources.find(r => r.type === item.type);\n            return resource && resource.category === 'doober';\n          })\n          .sort((a, b) => b.quantity - a.quantity)\n          .slice(0, 5)\n          .map(item => {\n            const resource = context.masterResources.find(r => r.type === item.type);\n            return resource?.symbol || item.type;\n          })\n          .filter(symbol => symbol); // Remove any undefined\n\n        // Return random item from top 5, or fallback\n        if (topItems.length > 0) {\n          return topItems[Math.floor(Math.random() * topItems.length)];\n        }\n      }\n      \n      // For NPC turn, check RelationshipMatrix for interests\n      if (!isPlayerTurn && context.npcId && context.masterResources) {\n        const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n        if (npcEntry) {\n          // Collect all defined interests (interest1, interest2, interest3, etc.)\n          const npcInterests = [];\n          let i = 1;\n          while (npcEntry[`interest${i}`]) {\n            // Look up the interest in masterResources to get its symbol\n            const interest = npcEntry[`interest${i}`];\n            const resource = context.masterResources.find(r => r.type === interest);\n            if (resource && resource.symbol) {\n              npcInterests.push(resource.symbol);\n            }\n            i++;\n          }\n          \n          // If NPC has interests defined, return one randomly\n          if (npcInterests.length > 0) {\n            return npcInterests[Math.floor(Math.random() * npcInterests.length)];\n          }\n        }\n      }\n      \n      // Fallback to default interests\n      return Topics.fallbackInterests[Math.floor(Math.random() * Topics.fallbackInterests.length)];\n\n    case 'npcinterest1':\n      // NPC's first interest from RelationshipMatrix\n      if (context.npcId && context.masterResources) {\n        const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n        if (npcEntry && npcEntry.interest1) {\n          const resource = context.masterResources.find(r => r.type === npcEntry.interest1);\n          if (resource && resource.symbol) {\n            return resource.symbol;\n          }\n        }\n      }\n      return '';\n\n    case 'npcinterest2':\n      // NPC's second interest from RelationshipMatrix\n      if (context.npcId && context.masterResources) {\n        const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n        if (npcEntry && npcEntry.interest2) {\n          const resource = context.masterResources.find(r => r.type === npcEntry.interest2);\n          if (resource && resource.symbol) {\n            return resource.symbol;\n          }\n        }\n      }\n      return '';\n\n    case 'relationship':\n      // TODO: Add logic based on relationship status\n      return '';\n      \n    case 'random':\n      // Random topic selection - includes NPC's interest2 if available\n      if (context.relscore > 80) {\n        // If relscore is high, use secret topics\n        return Topics.secretTopics[Math.floor(Math.random() * Topics.secretTopics.length)];\n      } else {\n        // Base random topics (copy array so we can modify it)\n        const randomTopics = [...Topics.randomTopics];\n\n        // For NPC turn, add their interest2 to the pool\n        if (!isPlayerTurn && context.npcId && context.masterResources) {\n          const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n          if (npcEntry && npcEntry.interest2) {\n            const resource = context.masterResources.find(r => r.type === npcEntry.interest2);\n            if (resource && resource.symbol) {\n              randomTopics.push(resource.symbol);\n            }\n          }\n        }\n\n        return randomTopics[Math.floor(Math.random() * randomTopics.length)];\n      }\n\n    case 'people':\n      // Generic \"people\" topic - behavior differs for player vs NPC\n      if (isPlayerTurn) {\n        // PLAYER: Show their best relationship (married > highest relscore)\n        if (context.currentPlayer && context.masterResources) {\n          const relationships = context.currentPlayer.relationships || [];\n\n          if (relationships.length > 0) {\n            // First, check for any married relationships\n            const marriedRels = relationships.filter(rel => rel.married === true);\n            if (marriedRels.length > 0) {\n              const chosen = marriedRels[Math.floor(Math.random() * marriedRels.length)];\n              const npcEntry = RelationshipMatrix.find(entry => entry.type === chosen.name);\n              return npcEntry?.symbol || '';\n            }\n\n            // No married, find highest relscore\n            const maxScore = Math.max(...relationships.map(rel => rel.relscore || 0));\n            const topRels = relationships.filter(rel => (rel.relscore || 0) === maxScore);\n            const chosen = topRels[Math.floor(Math.random() * topRels.length)];\n            const npcEntry = RelationshipMatrix.find(entry => entry.type === chosen.name);\n            return npcEntry?.symbol || '';\n          }\n\n          // No relationships at all, fallback to Kent\n          const kentEntry = RelationshipMatrix.find(entry => entry.type === 'Kent');\n          return kentEntry?.symbol || '';\n        }\n        return '';\n\n      } else {\n        // NPC: Be reactive to player's shown NPC, or pick interest3/random\n        if (context.npcId && context.masterResources) {\n          const npcEntry = RelationshipMatrix.find(entry => entry.type === context.npcId);\n\n          // Check if player showed an NPC character\n          const playerShownNpcType = context.playerTopic ? findNPCTypeFromSymbol(context.playerTopic) : null;\n\n          if (playerShownNpcType) {\n            // Player showed an NPC - check if we have a relationship with them\n            const relationship = checkNPCRelationship(context.npcId, playerShownNpcType);\n\n            if (relationship === 'rival' || relationship === 'friend' || relationship === 'love') {\n              // NPC has strong feelings about player's shown character - ECHO it\n              return context.playerTopic;\n            }\n          }\n\n          // Player showed someone neutral (or not an NPC) - pick our own topic\n          if (npcEntry) {\n            // First try interest3\n            if (npcEntry.interest3) {\n              const resource = context.masterResources.find(r => r.type === npcEntry.interest3);\n              if (resource && resource.symbol) {\n                return resource.symbol;\n              }\n            }\n          }\n\n          // No interest3 defined - pick a random NPC character (trade or quest action)\n          const npcCharacters = context.masterResources.filter(\n            r => r.action === 'trade' || r.action === 'quest'\n          );\n          if (npcCharacters.length > 0) {\n            const randomNpc = npcCharacters[Math.floor(Math.random() * npcCharacters.length)];\n            return randomNpc.symbol || '';\n          }\n        }\n        return '';\n      }\n\n    case 'quest':\n      return '';\n      \n    case 'trade':\n      return '';\n      \n    case 'skill':\n      return '';\n      \n    case 'location':\n      return '';\n      \n    case 'weather':\n      const weatherTopics = ['', '', '', ''];\n      return weatherTopics[Math.floor(Math.random() * weatherTopics.length)];\n      \n    case 'time':\n      return '';\n      \n    default:\n      // If it's not a recognized key, just return it as-is (might be an emoji already)\n      return topicKey;\n  }\n};\n\n\n// Show speech bubble for a character\n// matchState can be: false, 'match', or 'rival'\nconst showSpeech = async (speakerType, speakerId, emoji, topic, matchState = false) => {\n  ConversationManager.addSpeech(speakerId, emoji, topic || emoji, matchState);\n};\n\n// Hide speech bubble for a character\nconst hideSpeech = async (speakerId) => {\n  ConversationManager.removeSpeech(speakerId);\n};\n\n\n// Utility delay function\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n// Component for rendering conversation UI if needed\nconst ConversationUI = ({ isActive, playerData, npcData }) => {\n  if (!isActive) return null;\n  \n  return (\n    <div className=\"conversation-overlay\">\n      {/* This can be used for additional UI elements if needed */}\n    </div>\n  );\n};\n\nexport default ConversationUI;","import React, { useState, useEffect } from 'react';\nimport {\n  updateRelationship,\n  updateRelationshipStatus,\n  getNPCReactions,\n  checkOtherRelationships,\n  generateRelationshipStatusMessage\n} from './RelationshipUtils';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { playConversation, calculateModifiedChance } from './Conversation';\nimport ConversationManager from './ConversationManager';\nimport '../../UI/Buttons/SharedButtons.css';\n\n// Mapping of interaction names (lowercase) to their success/failure reaction emojis\nconst INTERACTION_EMOJIS = {\n  'talk': { success: '', failure: '' },\n  'make friends': { success: '', failure: '' },\n  'profess love': { success: '', failure: '' },\n  'propose': { success: '', failure: '' },\n  'divorce': { success: '', failure: '' },\n  'end friendship': { success: '', failure: '' },\n  'end marriage': { success: '', failure: '' },\n  'insult': { success: '', failure: '' },\n  'compliment': { success: '', failure: '' },\n  'flatter': { success: '', failure: '' },\n  'give gift': { success: '', failure: '' },\n  'apologize': { success: '', failure: '' },\n  'flirt': { success: '', failure: '' },\n  'kiss': { success: '', failure: '' },\n  'hug': { success: '', failure: '' },\n  'joke': { success: '', failure: '' },\n  'gossip': { success: '', failure: '' },\n  'greet': { success: '', failure: '' },\n  'taunt': { success: '', failure: '' },\n  'tease': { success: '', failure: '' },\n  // Default fallback for any interaction not specifically mapped\n  'default': { success: '', failure: '' }\n};\n\n// Helper function to get emoji for an interaction outcome\n// Uses case-insensitive lookup with trimmed whitespace\nconst getInteractionEmoji = (interactionName, isSuccess) => {\n  const normalizedName = (interactionName || '').toLowerCase().trim();\n  const emojis = INTERACTION_EMOJIS[normalizedName] || INTERACTION_EMOJIS['default'];\n  const result = isSuccess ? emojis.success : emojis.failure;\n  console.log(' getInteractionEmoji:', { interactionName, normalizedName, isSuccess, emojis, result });\n  return result;\n};\n\nconst RelationshipCard = ({\n  currentPlayer,\n  setCurrentPlayer,\n  targetName,\n  targetType = 'npc', // 'npc' or 'player'\n  targetEmoji = null, // Optional emoji for the target\n  onRelationshipChange,\n  showActions = true,\n  compact = false,\n  masterInteractions = [],\n  updateStatus,\n  checkDistance = null, // Optional function to check if target is in range\n  onInteractionClick = null, // Optional function to handle zoom/camera when interaction is clicked\n  playerPosition = null, // Player's grid position for conversation\n  targetPosition = null, // Target's grid position for conversation\n  TILE_SIZE = 30, // Tile size for positioning speech bubbles\n  masterResources = [], // Master resources for topic resolution\n  isDeveloper = false // Show debug info for chance calculations\n}) => {\n  const [relationship, setRelationship] = useState(null);\n  const [isInitializing, setIsInitializing] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const strings = useStrings();\n\n  useEffect(() => {\n    loadOrCreateRelationship();\n  }, [currentPlayer?.playerId, targetName]);\n\n  const loadOrCreateRelationship = async () => {\n    if (!currentPlayer || !targetName) {\n      return;\n    }\n\n    // Find existing relationship\n    const existingRel = currentPlayer.relationships?.find(rel => rel.name === targetName);\n    \n    if (existingRel) {\n      setRelationship(existingRel);\n    } else if (!isInitializing) {\n      // Create new relationship with score 0\n      setIsInitializing(true);\n      const result = await updateRelationship(currentPlayer, targetName, 0);\n      \n      if (result.success && result.player) {\n        // Update the currentPlayer with the new data\n        setCurrentPlayer(result.player);\n        const newRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(newRel || {\n          name: targetName,\n          relscore: 0\n        });\n      }\n      setIsInitializing(false);\n    }\n  };\n\n  const handleInteraction = async (interaction) => {\n    if (!relationship || isProcessing) return;\n    \n    setIsProcessing(true);\n    \n    // Check distance first, before any zoom/camera operations\n    if (checkDistance && !checkDistance()) {\n      if (updateStatus) {\n        updateStatus(620); // \"You are too far away\"\n      }\n      setIsProcessing(false);\n      return;\n    }\n    \n    // Handle zoom and camera centering only after distance check passes\n    if (onInteractionClick) {\n      await onInteractionClick();\n    }\n    \n    // Check if interaction is allowed based on other relationships\n    const relationshipCheck = checkOtherRelationships(currentPlayer, targetName, interaction);\n    if (!relationshipCheck.allowed) {\n      if (updateStatus) {\n        updateStatus(` ${relationshipCheck.reason}`);\n      }\n      setIsProcessing(false);\n      return;\n    }\n    \n    // Play conversation sequence if positions are provided\n    if (playerPosition && targetPosition) {\n      const playerEmoji = currentPlayer.icon || '';\n      const defaultTargetEmoji = targetType === 'npc' ? '' : '';\n      const conversationTargetEmoji = targetEmoji || defaultTargetEmoji;\n      \n      // Use player ID for consistent tracking\n      const playerId = currentPlayer._id?.toString() || currentPlayer.playerId;\n      const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n      \n      // Store conversation results for chance calculation\n      let conversationResults = null;\n      \n      await playConversation(\n        playerPosition,\n        targetPosition,\n        playerEmoji,\n        conversationTargetEmoji,\n        TILE_SIZE,\n        (results) => {\n          // Store conversation results\n          conversationResults = results;\n        },\n        playerId,\n        targetId,\n        interaction,\n        currentPlayer,\n        masterResources\n      );\n      \n      // Calculate modified chance based on conversation results\n      const baseChance = interaction.chance || 1.0;\n      const modifiedChance = conversationResults\n        ? calculateModifiedChance(baseChance, interaction, conversationResults, currentPlayer, targetName)\n        : baseChance;\n\n      console.log(' Chance calculation:', {\n        baseChance,\n        conversationResults,\n        modifiedChance\n      });\n\n      // Roll for success based on modified chance\n      const randomRoll = Math.random();\n      const success = randomRoll <= modifiedChance;\n\n      // Show debug info for developers\n      if (isDeveloper && updateStatus) {\n        const matchBonus = conversationResults?.matchingTopics ? conversationResults.matchingTopics * 0.1 : 0;\n        const rivalPenalty = conversationResults?.rivalTopics ? conversationResults.rivalTopics * 0.15 : 0;\n\n        // Calculate relbuff for debug display\n        // Note: Statuses are stored as boolean properties on relationship (e.g., rel.friend = true)\n        let relBuffBonus = 0;\n        if (currentPlayer?.relationships) {\n          const rel = currentPlayer.relationships.find(r => r.name === targetName);\n          if (rel) {\n            for (let i = 1; i <= 3; i++) {\n              const buffField = interaction[`relbuff${i}`];\n              if (buffField && rel[buffField] === true) {\n                relBuffBonus = interaction.relbuff || 0.2;\n                break;\n              }\n            }\n          }\n        }\n\n        // On failure, score change is negative of relscoreresult\n        const scoreChange = success ? (interaction.relscoreresult || 0) : -(interaction.relscoreresult || 0);\n        const scoreStr = scoreChange >= 0 ? `+${scoreChange}` : `${scoreChange}`;\n        const relBuffStr = relBuffBonus > 0 ? ` + RelBuff ${relBuffBonus.toFixed(2)}` : '';\n        const debugStr = ` ${interaction.interaction}: Base ${baseChance.toFixed(2)} + Match ${matchBonus.toFixed(2)} - Rival ${rivalPenalty.toFixed(2)}${relBuffStr} = Threshold ${modifiedChance.toFixed(2)} | Roll ${randomRoll.toFixed(2)}  ${modifiedChance.toFixed(2)}?  ${success ? '' : ''} (${scoreStr})`;\n        updateStatus(debugStr);\n      }\n\n      // Continue with success/failure handling\n      await handleInteractionOutcome(success, interaction);\n    } else {\n      // No conversation - use base chance\n      const baseChance = interaction.chance || 1.0;\n      const randomRoll = Math.random();\n      const success = randomRoll <= baseChance;\n\n      // Show debug info for developers\n      if (isDeveloper && updateStatus) {\n        // On failure, score change is negative of relscoreresult\n        const scoreChange = success ? (interaction.relscoreresult || 0) : -(interaction.relscoreresult || 0);\n        const scoreStr = scoreChange >= 0 ? `+${scoreChange}` : `${scoreChange}`;\n        const debugStr = ` ${interaction.interaction}: Threshold ${baseChance.toFixed(2)} | Roll ${randomRoll.toFixed(2)}  ${baseChance.toFixed(2)}?  ${success ? '' : ''} (${scoreStr})`;\n        updateStatus(debugStr);\n      }\n\n      // Continue with success/failure handling\n      await handleInteractionOutcome(success, interaction);\n    }\n  };\n  \n  // Helper function to handle interaction outcome\n  const handleInteractionOutcome = async (success, interaction) => {\n    if (success) {\n      // Update relationship score\n      const scoreChange = interaction.relscoreresult || 0;\n      const result = await updateRelationship(currentPlayer, targetName, scoreChange);\n      \n      if (result.success && result.player) {\n        setCurrentPlayer(result.player);\n        let updatedRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(updatedRel);\n        \n        // Add relationship status if specified\n        if (interaction.relbitadd) {\n          const statusResult = await updateRelationshipStatus(\n            currentPlayer, \n            targetName, \n            interaction.relbitadd, \n            true\n          );\n          \n          if (statusResult.success && statusResult.player) {\n            setCurrentPlayer(statusResult.player);\n            updatedRel = statusResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n            \n            // Check for NPC reactions only if this is an NPC\n            let npcReactions = [];\n            if (targetType === 'npc') {\n              npcReactions = getNPCReactions(targetName, interaction.relbitadd);\n              \n              // Apply each reaction\n              for (const reaction of npcReactions) {\n                // Clear all statuses if needed\n                if (reaction.clearAllStatuses) {\n                  // First, set the score to the exact value\n                  const scoreResult = await updateRelationship(\n                    statusResult.player, \n                    reaction.npc, \n                    reaction.setScore - (statusResult.player.relationships?.find(r => r.name === reaction.npc)?.relscore || 0)\n                  );\n                  \n                  if (scoreResult.success && scoreResult.player) {\n                    // Clear all statuses dynamically from masterInteractions\n                    const statuses = masterInteractions\n                      .filter(item => item.isaninteraction === false)\n                      .map(item => item.interaction.toLowerCase());\n                    for (const status of statuses) {\n                      await updateRelationshipStatus(scoreResult.player, reaction.npc, status, false);\n                    }\n                    \n                    // Set new status\n                    if (reaction.setStatus) {\n                      // First ensure they are \"met\"\n                      const metResult = await updateRelationshipStatus(\n                        scoreResult.player, \n                        reaction.npc, \n                        'met', \n                        true\n                      );\n                      \n                      // Then set the reaction status\n                      const finalResult = await updateRelationshipStatus(\n                        metResult.success ? metResult.player : scoreResult.player, \n                        reaction.npc, \n                        reaction.setStatus, \n                        true\n                      );\n                      if (finalResult.success && finalResult.player) {\n                        setCurrentPlayer(finalResult.player);\n                      }\n                    }\n                  }\n                } else if (reaction.scoreChange) {\n                  // Just change the score\n                  const scoreResult = await updateRelationship(\n                    statusResult.player, \n                    reaction.npc, \n                    reaction.scoreChange\n                  );\n                  if (scoreResult.success && scoreResult.player) {\n                    // Ensure they are \"met\" if relationship exists and score is positive\n                    const updatedRelWithReactor = scoreResult.player.relationships?.find(r => r.name === reaction.npc);\n                    if (updatedRelWithReactor && !updatedRelWithReactor.met) {\n                      const metResult = await updateRelationshipStatus(\n                        scoreResult.player, \n                        reaction.npc, \n                        'met', \n                        true\n                      );\n                      if (metResult.success && metResult.player) {\n                        setCurrentPlayer(metResult.player);\n                      } else {\n                        setCurrentPlayer(scoreResult.player);\n                      }\n                    } else {\n                      setCurrentPlayer(scoreResult.player);\n                    }\n                  }\n                }\n              }\n            }\n            \n            // Generate and display status message for successful interaction\n            if (updateStatus) {\n              const statusMessage = generateRelationshipStatusMessage(\n                targetName, \n                interaction.relbitadd, \n                true, \n                npcReactions,\n                strings\n              );\n              if (statusMessage) {\n                updateStatus(statusMessage);\n              }\n            }\n          }\n        }\n        \n        // Remove relationship status if specified\n        if (interaction.relbitremove) {\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer, \n            targetName, \n            interaction.relbitremove, \n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n        \n        // Check if any relationship statuses should be removed due to score falling below minimum\n        const statusesToRemove = masterInteractions.filter(item => {\n          // Only check non-interaction status items\n          if (item.isaninteraction !== false) return false;\n          \n          // Check if this status has a minimum score requirement\n          if (typeof item.relscoremin !== 'number') return false;\n          \n          // Check if the new score is below the minimum and the relationship has this status\n          const statusKey = item.interaction.toLowerCase();\n          return updatedRel.relscore < item.relscoremin && updatedRel[statusKey] === true;\n        });\n        \n        // Remove any statuses that no longer meet minimum score requirements\n        for (const statusItem of statusesToRemove) {\n          const statusKey = statusItem.interaction.toLowerCase();\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer,\n            targetName,\n            statusKey,\n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n      \n        // Show relationship outcome VFX with interaction-specific emoji\n        // Show for any score change OR when a relationship status is added (e.g., Make Friends adds \"friend\" status with 0 score change)\n        if (scoreChange !== 0 || interaction.relbitadd) {\n          const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n          const emoji = getInteractionEmoji(interaction.interaction, true);\n          ConversationManager.showOutcome(targetId, true, emoji);\n        }\n        \n      }\n    } else {\n      // Failed interaction - decrease score by same amount\n      const scoreChange = -(interaction.relscoreresult || 0);\n      const result = await updateRelationship(currentPlayer, targetName, scoreChange);\n      \n      if (result.success && result.player) {\n        setCurrentPlayer(result.player);\n        let updatedRel = result.player.relationships.find(rel => rel.name === targetName);\n        setRelationship(updatedRel);\n        \n        // Check if any relationship statuses should be removed due to score falling below minimum\n        const statusesToRemove = masterInteractions.filter(item => {\n          // Only check non-interaction status items\n          if (item.isaninteraction !== false) return false;\n          \n          // Check if this status has a minimum score requirement\n          if (typeof item.relscoremin !== 'number') return false;\n          \n          // Check if the new score is below the minimum and the relationship has this status\n          const statusKey = item.interaction.toLowerCase();\n          return updatedRel.relscore < item.relscoremin && updatedRel[statusKey] === true;\n        });\n        \n        // Remove any statuses that no longer meet minimum score requirements\n        for (const statusItem of statusesToRemove) {\n          const statusKey = statusItem.interaction.toLowerCase();\n          const removeResult = await updateRelationshipStatus(\n            currentPlayer,\n            targetName,\n            statusKey,\n            false\n          );\n          \n          if (removeResult.success && removeResult.player) {\n            setCurrentPlayer(removeResult.player);\n            updatedRel = removeResult.player.relationships.find(rel => rel.name === targetName);\n            setRelationship(updatedRel);\n          }\n        }\n      }\n      \n      // Show relationship outcome VFX for failed interaction with interaction-specific emoji\n      // Show for any score penalty OR when interaction would have added a status (e.g., failed Make Friends)\n      if (scoreChange < 0 || interaction.relbitadd) {\n        const targetId = targetType === 'npc' ? targetName : targetName; // For NPCs, use name as ID\n        const emoji = getInteractionEmoji(interaction.interaction, false);\n        ConversationManager.showOutcome(targetId, false, emoji);\n      }\n    }\n    \n    // Call the parent's relationship change handler\n    if (onRelationshipChange) {\n      onRelationshipChange(interaction, success);\n    }\n    \n    setIsProcessing(false);\n  };\n\n  if (!relationship) {\n    return null;\n  }\n\n  // Determine color based on score\n  const getScoreColor = (score) => {\n    if (score > 50) return '#4CAF50'; // Green\n    if (score > 0) return '#8BC34A'; // Light Green\n    if (score === 0) return '#9E9E9E'; // Gray\n    if (score > -50) return '#FF9800'; // Orange\n    return '#F44336'; // Red\n  };\n\n  const scoreColor = getScoreColor(relationship.relscore);\n\n  // Get visible relationship statuses early so we can use in both compact and full views\n  const visibleStatuses = masterInteractions.filter(item => {\n    // Only consider non-interaction items\n    if (item.isaninteraction !== false) return false;\n    \n    // Check if visible and if the relationship has this status\n    const statusKey = item.interaction.toLowerCase();\n    return item.isvisible && relationship[statusKey] === true;\n  });\n\n  if (compact) {\n    // Compact version for inline display\n    return (\n      <div className=\"relationship-card-compact\">\n        <span className=\"relationship-name\">{targetName}</span>\n        <span className=\"relationship-score\" style={{ color: scoreColor }}>\n          [{relationship.relscore}]\n        </span>\n        {/* Status flags */}\n        {visibleStatuses.map((status) => (\n          <span key={status.interaction} className=\"relationship-status\">\n             {getLocalizedString(status.interaction, strings)}\n          </span>\n        ))}\n      </div>\n    );\n  }\n\n  // Get available interactions based on visibility and relationship score\n  const availableInteractions = masterInteractions.filter(interaction => {\n    // Only include actual interactions\n    if (interaction.isaninteraction === false) return false;\n    // Only show visible interactions\n    if (!interaction.isvisible) return false;\n    // Check if relationship score is within min/max range\n    const minScore = interaction.relscoremin ?? -100;\n    const maxScore = interaction.relscoremax ?? 100;\n    if (relationship.relscore < minScore || relationship.relscore > maxScore) return false;\n    \n    // Check if required relationship status exists\n    if (interaction.relbitrequired && !relationship[interaction.relbitrequired]) {\n      return false; // Doesn't have required status\n    }\n    \n    // Check relbitblock fields - hide interaction if any blocked status exists\n    for (let i = 1; i <= 3; i++) {\n      const blockField = interaction[`relbitblock${i}`];\n      if (blockField) {\n        if (blockField === 'all') {\n          // Block if ANY relationship status exists\n          const hasAnyStatus = relationship.met || relationship.friend || \n                             relationship.crush || relationship.love || \n                             relationship.married || relationship.rival;\n          if (hasAnyStatus) return false;\n        } else if (relationship[blockField]) {\n          // Block if specific status exists\n          return false;\n        }\n      }\n    }\n    \n    return true;\n  });\n\n  // Full card version\n  return (\n    <div className=\"relationship-card\">\n      <div className=\"relationship-card-content\">\n        <h3 className=\"relationship-title\">{strings[601]}</h3>\n        \n        <div className=\"relationship-score-bar-container\">\n          <div className=\"relationship-score-gradient\">\n            <div \n              className=\"relationship-score-marker\"\n              style={{ \n                left: `${((relationship.relscore + 100) / 200) * 100}%`\n              }}\n            />\n          </div>\n        </div>\n\n        {/* Status flags display */}\n        <div className=\"relationship-status-display\">\n          {visibleStatuses.map((status) => (\n            <span \n              key={status.interaction}\n              className={`relationship-status-badge ${status.interaction.toLowerCase()}`}\n            >\n              {getLocalizedString(status.interaction, strings)}\n            </span>\n          ))}\n        </div>\n\n        {showActions && availableInteractions.length > 0 && (\n          <div className=\"relationship-actions shared-buttons\">\n            {availableInteractions.map((interaction) => (\n              <button\n                key={interaction.interaction} \n                className=\"btn-basic\"\n                onClick={() => handleInteraction(interaction)}\n                disabled={isProcessing}\n              >\n                {getLocalizedString(interaction.interaction, strings)}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(RelationshipCard);","import React, { useEffect, useRef } from 'react';\nimport ConversationManager from '../Relationships/ConversationManager';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\n\nconst HealerInteraction = ({\n  isHealing,\n  currentPlayer,\n  TILE_SIZE,\n  healAmount,\n  onHealingComplete\n}) => {\n  const animationTimeoutRef = useRef(null);\n  const conversationTimeoutRef = useRef(null);\n\n  useEffect(() => {\n    // Get player position for speech bubble\n    const gridId = currentPlayer?.location?.g;\n    const playerId = currentPlayer._id?.toString();\n    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    const speakerId = playerId || `player_${Math.floor(playerInGridState?.position?.x || 0)}_${Math.floor(playerInGridState?.position?.y || 0)}`;\n    \n    if (isHealing && currentPlayer && playerInGridState?.position) {\n      console.log(' Starting heal animation');\n      // Show prayer bubble over player\n      ConversationManager.addSpeech(speakerId, '', '', false);\n      \n      // Removed player bounce animation\n      \n      // Remove speech bubble after animation\n      conversationTimeoutRef.current = setTimeout(() => {\n        console.log(' Removing speech bubble after timeout');\n        ConversationManager.removeSpeech(speakerId);\n      }, 1500);\n    }\n    \n    // Cleanup function - runs when isHealing changes or component unmounts\n    return () => {\n      console.log(' Cleanup - isHealing changed to:', isHealing);\n      if (animationTimeoutRef.current) {\n        clearTimeout(animationTimeoutRef.current);\n      }\n      if (conversationTimeoutRef.current) {\n        clearTimeout(conversationTimeoutRef.current);\n      }\n      \n      // Ensure speech bubble is removed\n      ConversationManager.removeSpeech(speakerId);\n      \n      // Removed animation cleanup - no longer animating\n    };\n  }, [isHealing, currentPlayer, TILE_SIZE]);\n  \n  // Removed animatePlayer function - no longer bouncing\n  \n  // This component doesn't render anything visible - it just manages the animation\n  return null;\n};\n\nexport default HealerInteraction;","import API_BASE from '../../config';\nimport React, { useState, useEffect, useRef } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Buttons/SharedButtons.css';\nimport '../Crafting/ScrollStation.css'; // Import for shared station panel styles\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { canAfford, hasRoomFor } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { gainIngredients, spendIngredients } from '../../Utils/InventoryManagement';\nimport { QuestGiverButton } from '../../UI/Buttons/QuestButton';\nimport { modifyPlayerStatsInGridState, getDerivedLevel } from '../../Utils/playerManagement';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport RelationshipCard from '../Relationships/RelationshipCard';\nimport RelationshipMatrix from '../Relationships/RelationshipMatrix.json';\nimport { getRelationshipStatus, getRelationshipMultiplier } from '../Relationships/RelationshipUtils';\nimport '../Relationships/Relationships.css';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { checkDeveloperStatus } from '../../Utils/appUtils';\nimport questCache from '../../Utils/QuestCache';\nimport { calculateDistance, getDerivedRange } from '../../Utils/worldHelpers';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport HealerInteraction from './HealerInteraction';\nimport StoryModal from '../../UI/Modals/StoryModal';\nimport { tryAdvanceFTUEByTrigger } from '../FTUE/FTUEutils';\n\nconst NPCPanel = ({\n  onClose,\n  npcData,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterInteractions,\n  masterTraders,\n  masterTrophies,\n  masterXPLevels,\n  zoomLevel,\n  setZoomLevel,\n  centerCameraOnPlayer,\n  globalTuning,\n  isDeveloper,\n}) => {\n  const strings = useStrings();\n  const [questList, setQuestList] = useState([]);\n  const [healRecipes, setHealRecipes] = useState([]);\n  const [tradeRecipes, setTradeRecipes] = useState([]);\n  const [statusMessage, setStatusMessage] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [canQuest, setCanQuest] = useState(false);\n  const [hasHiddenQuests, setHasHiddenQuests] = useState(false);\n  const [questThreshold, setQuestThreshold] = useState(0);\n  const [canTrade, setCanTrade] = useState(false);\n  const [tradeThreshold, setTradeThreshold] = useState(0);\n  const [hasHiddenTrades, setHasHiddenTrades] = useState(false);\n  const [isHealing, setIsHealing] = useState(false); // Prevent spam-clicking heal button\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const COOLDOWN_DURATION = 1500; // 1500ms cooldown (3x longer than terraform)\n\n  // StoryModal state for relationship milestone dialogs\n  const [storyModalOpen, setStoryModalOpen] = useState(false);\n  const [storyRelationshipType, setStoryRelationshipType] = useState(null);\n\n  // Ref to track relationship status before an interaction\n  const preInteractionRelationshipRef = useRef(null);\n\n\n  // Ensure npcData has default values\n  if (!npcData) {\n    console.warn(\"NPCPanel was opened with missing npcData.\");\n    npcData = { type: \"Unknown NPC\", symbol: \"\" }; // Provide default fallback values\n  }\n\n  // Check if player has required skill for a trade recipe\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  // Check if player meets the level requirement for a trade recipe\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n  // Check if player can quest based on relationship\n  useEffect(() => {\n    if (masterInteractions && npcData && npcData.action === 'quest') {\n      // Find the quest interaction threshold\n      const questInteraction = masterInteractions.find(interaction => \n        interaction.interaction === 'Quest' || interaction.interaction === 'quest'\n      );\n      \n      if (questInteraction) {\n        setQuestThreshold(questInteraction.relscoremin || 0);\n        \n        // Get current relationship status\n        const relationship = getRelationshipStatus(currentPlayer, npcData.type);\n        const currentScore = relationship?.relscore || 0;\n        \n        setCanQuest(currentScore >= questInteraction.relscoremin);\n      } else {\n        // If no quest threshold defined, allow questing\n        setCanQuest(true);\n      }\n    }\n    \n    // Check if player can trade based on relationship\n    if (npcData && npcData.action === 'trade') {\n      const tradeInteraction = masterInteractions.find(interaction => \n        interaction.interaction === 'Trade' || interaction.interaction === 'trade'\n      );\n      \n      if (tradeInteraction) {\n        setTradeThreshold(tradeInteraction.relscoremin || 0);\n        \n        // Get current relationship status\n        const relationship = getRelationshipStatus(currentPlayer, npcData.type);\n        const currentScore = relationship?.relscore || 0;\n        \n        setCanTrade(currentScore >= tradeInteraction.relscoremin);\n      } else {\n        // If no trade threshold defined, allow trading\n        setCanTrade(true);\n      }\n    }\n  }, [masterInteractions, npcData, currentPlayer]);\n\n  // Handle quests or healing logic\n  useEffect(() => {\n    if (!npcData || !npcData.type) return;\n\n    if (npcData.action === 'quest') {\n      // Add a small delay to debounce rapid changes\n      const timeoutId = setTimeout(() => {\n        fetchQuests();\n      }, 100);\n      \n      return () => clearTimeout(timeoutId);\n    } else if (npcData.action === 'heal') {\n      const filteredRecipes = masterResources.filter((resource) => resource.type === npcData.type);\n      setHealRecipes(filteredRecipes);\n    } else if (npcData.action === 'trade') {\n      // Find all trades for this trader in masterTraders (new flat format)\n      const traderOffers = masterTraders?.filter(t => t.trader === npcData.type);\n\n      if (traderOffers && traderOffers.length > 0) {\n        // Get player's relationship with this NPC\n        const relationship = currentPlayer.relationships?.find(rel => rel.name === npcData.type);\n\n        // Check if any trades are hidden due to relationship requirements\n        const tradesHiddenByRelationship = traderOffers.some((offer) => {\n          if (offer.rel) {\n            // If no relationship exists with this NPC, trade is hidden\n            if (!relationship) return true;\n            // Check relationship status requirement (e.g., \"friend\", \"met\", \"love\")\n            if (relationship[offer.rel] !== true) return true;\n          }\n          return false;\n        });\n        setHasHiddenTrades(tradesHiddenByRelationship);\n\n        // Filter offers by relationship requirements, then transform\n        const filteredOffers = traderOffers.filter((offer) => {\n          if (offer.rel) {\n            // If no relationship exists with this NPC, exclude the trade\n            if (!relationship) return false;\n            // Check relationship status requirement\n            if (relationship[offer.rel] !== true) return false;\n          }\n          return true;\n        });\n\n        // Transform each offer into the format expected by the rest of the component\n        const filteredRecipes = filteredOffers.map(offer => {\n          // Get the symbol from masterResources\n          const resourceDef = masterResources.find(r => r.type === offer.gives);\n\n          const recipe = {\n            type: offer.gives,\n            symbol: resourceDef?.symbol || '?',\n            tradeqty: offer.givesqty || 1,\n            source: npcData.type,\n            gemcost: resourceDef?.gemcost || null,\n            index: offer.index, // Keep track of which offer this is\n            repeat: offer.repeat, // Store the repeat flag from trader offer\n            level: resourceDef?.level, // Level requirement from resource definition\n            requires: resourceDef?.requires // Skill requirement from resource definition\n          };\n\n          // Collect all requires fields into ingredient format\n          let ingredientCount = 1;\n          for (let i = 1; i <= 7; i++) { // Support up to 7 ingredients like Oracle\n            const requiresField = `requires${i}`;\n            const requiresQtyField = `requires${i}qty`;\n\n            if (offer[requiresField]) {\n              recipe[`ingredient${ingredientCount}`] = offer[requiresField];\n              recipe[`ingredient${ingredientCount}qty`] = offer[requiresQtyField] || 1;\n              ingredientCount++;\n            }\n          }\n\n          return recipe;\n        });\n\n        setTradeRecipes(filteredRecipes);\n      } else {\n        // Fallback to old method if masterTraders is not available\n        const filteredRecipes = masterResources.filter((resource) => resource.source === npcData.type);\n        setTradeRecipes(filteredRecipes);\n        setHasHiddenTrades(false);\n      }\n    }\n  }, [npcData, currentPlayer?.activeQuests, currentPlayer?.completedQuests, currentPlayer?.relationships, masterResources, masterTraders]);\n\n  \n  ////////////////////////////////////////////////////////////\n  ////////////////////// Fetch QUESTS for QUEST NPCs\n  const fetchQuests = async () => {\n    try {\n      // Use cached quests instead of direct API call\n      const allQuests = await questCache.getQuests();\n\n      // Use new quest filtering logic\n      let npcQuests = allQuests\n        .filter((quest) => quest.giver === npcData.type)\n        .filter((quest) => {\n          const activeQuest = currentPlayer.activeQuests.find(q => q.questId === quest.title);\n          const isInCompleted = currentPlayer.completedQuests.some(q => q.questId === quest.title);        \n          if (activeQuest) {\n            const shouldShow = activeQuest.completed && !activeQuest.rewardCollected;\n            return shouldShow;\n          }          \n          const shouldShow = (quest.repeatable === true || quest.repeatable === 'true') || !isInCompleted;\n          return shouldShow;\n        });\n\n      // Check if any quests exist that are hidden due to relationship requirements\n      const relationship = currentPlayer.relationships?.find(rel => rel.name === npcData.type);\n      const questsHiddenByRelationship = npcQuests.some((quest) => {\n        // Check if quest has relationship requirements that aren't met\n        if (quest.rel || quest.relscore) {\n          // If no relationship exists with this NPC, quest is hidden\n          if (!relationship) return true;\n          // Check relationship status requirement\n          if (quest.rel && relationship[quest.rel] !== true) return true;\n          // Check relationship score requirement\n          if (quest.relscore && (relationship.relscore || 0) < quest.relscore) return true;\n        }\n        return false;\n      });\n\n      // Filter by relationship requirements (existing logic)\n      npcQuests = npcQuests.filter((quest) => {\n        // Check if quest has relationship requirements\n        if (quest.rel || quest.relscore) {\n          // If no relationship exists with this NPC, exclude the quest\n          if (!relationship) return false;\n          // Check relationship status requirement\n          if (quest.rel && relationship[quest.rel] !== true) { return false; }\n          // Check relationship score requirement\n          if (quest.relscore && (relationship.relscore || 0) < quest.relscore) { return false; }\n        }\n        return true;\n      });\n\n      setQuestList(npcQuests);\n      setHasHiddenQuests(questsHiddenByRelationship);\n    } catch (error) {\n      console.error('Error fetching quests:', error);\n    }\n  };\n\n  const handleAcceptQuest = async (questTitle) => {\n    if (!questTitle) return;\n    // Find the accepted quest in questList\n    const acceptedQuest = questList.find(q => q.title === questTitle);\n    if (!acceptedQuest) {\n        console.error(`Quest \"${questTitle}\" not found in available quests.`);\n        return;\n    }\n    // Prepare progress tracking for skill-based goals\n    let initialProgress = { goal1: 0, goal2: 0, goal3: 0 }; // Explicitly initialize\n    let goalsCompleted = 0;\n    let totalGoals = 0;\n\n    for (let i = 1; i <= 3; i++) {\n      const goalAction = acceptedQuest[`goal${i}action`];\n      const goalItem = acceptedQuest[`goal${i}item`];\n      const goalQty = acceptedQuest[`goal${i}qty`];\n\n      if (!goalAction || !goalItem || !goalQty) continue; // Skip undefined goals\n      totalGoals++; // Count valid goals\n\n      if (goalAction === \"Acquire\") {\n          // Check if player already has the required skill or power\n          const playerHasSkill = currentPlayer.skills?.some(skill => skill.type === goalItem);\n          const playerHasPower = currentPlayer.powers?.some(power => power.type === goalItem);\n          if (playerHasSkill || playerHasPower) {\n              initialProgress[`goal${i}`] = 1; // Pre-mark as completed\n              goalsCompleted++;\n          } else {\n              initialProgress[`goal${i}`] = 0; // Start at 0\n          }\n      } else if (goalAction === \"Craft\") {\n          // Check if crafted item already exists as an NPC on the homestead (e.g., Rancher, Farmer)\n          const homesteadNPCs = Object.values(NPCsInGridManager.getNPCsInGrid(currentPlayer.gridId) || {});\n          const itemExistsOnHomestead = homesteadNPCs.some(npc => npc.type === goalItem);\n          if (itemExistsOnHomestead) {\n              initialProgress[`goal${i}`] = 1; // Pre-mark as completed\n              goalsCompleted++;\n          } else {\n              initialProgress[`goal${i}`] = 0; // Start at 0\n          }\n      } else {\n          initialProgress[`goal${i}`] = 0; // Default progress for other goals\n      }\n    }\n    // If all goals are completed before even accepting, mark the quest as completed\n    const isQuestCompleted = totalGoals > 0 && goalsCompleted === totalGoals;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/add-player-quest`, {\n        playerId: currentPlayer.playerId,\n        questId: questTitle,\n        startTime: Date.now(),\n        progress: initialProgress, // Send pre-computed progress\n        completed: isQuestCompleted, // If all goals are done, mark it completed\n      });\n\n      if (response.data.success) {\n        setCurrentPlayer(response.data.player); // Update player after quest is added\n        updateStatus(202);\n        // No need to invalidate cache when accepting quests\n      } else {\n        setStatusMessage(`Failed to accept quest: ${response.data.error}`);\n      }\n    } catch (error) {\n      console.error('Error accepting quest:', error);\n      setStatusMessage('Error accepting quest. Check console.');\n    }\n  };\n\nconst handleGetReward = async (quest) => {\n    try {\n      // Get relationship-based multiplier from RelationshipMatrix data\n      const { multiplier, bonusMessage } = getRelationshipMultiplier(npcData.type, currentPlayer, strings);\n      const rewardQuantity = Math.floor((quest.rewardqty || 1) * multiplier);\n      \n      // Ensure inventory and backpack are valid arrays\n      const safeInventory = Array.isArray(inventory) ? inventory : [];\n      const safeBackpack = Array.isArray(backpack) ? backpack : [];\n      \n      const success = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: quest.reward,\n        quantity: rewardQuantity,\n        inventory: safeInventory,\n        backpack: safeBackpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n      // Check if gainIngredients failed (returns object with success: false, or falsy value)\n      if (success !== true && (!success || success.success === false)) return;\n\n      // Award trophies for specific quest rewards\n      try {\n        if (quest.reward === \"Prospero's Orb\") {\n          console.log(` Awarding Prospero's Orb trophy for collecting ${rewardQuantity} orb(s)`);\n          \n          // Award the Count-type trophy for each orb collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Prospero's Orb\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Prospero's Orb trophy instance(s)`);\n        } else if (quest.reward === \"Skeleton Key\") {\n          console.log(` Awarding Skeleton Key trophy for collecting ${rewardQuantity} key(s)`);\n          \n          // Award the Count-type trophy for each key collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Skeleton Key\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Skeleton Key trophy instance(s)`);\n        } else if (quest.reward === \"Golden Key\") {\n          console.log(` Awarding Golden Key trophy for collecting ${rewardQuantity} key(s)`);\n          \n          // Award the Count-type trophy for each key collected\n          for (let i = 0; i < rewardQuantity; i++) {\n            await earnTrophy(currentPlayer.playerId, \"Golden Key\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n          }\n          \n          console.log(` Successfully awarded ${rewardQuantity} Golden Key trophy instance(s)`);\n        }\n        \n      } catch (error) {\n        console.error(' Error awarding quest reward trophy:', error);\n        // Don't fail the quest completion if trophy awarding fails\n      }\n\n      // Track quest progress for \"Collect\" type quests (use multiplied quantity)\n      await trackQuestProgress(currentPlayer, 'Collect', quest.reward, rewardQuantity, setCurrentPlayer);\n\n      // Award XP for completing quest with NPC\n      const npcResourceForXP = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n      const xpToAward = npcResourceForXP?.xp || 1;\n      try {\n        const xpResponse = await axios.post(`${API_BASE}/api/addXP`, {\n          playerId: currentPlayer.playerId,\n          xpAmount: xpToAward\n        });\n\n        if (xpResponse.data.success) {\n          // Update current player's XP locally\n          setCurrentPlayer(prev => ({\n            ...prev,\n            xp: xpResponse.data.newXP\n          }));\n        }\n      } catch (error) {\n        console.error(' Error awarding XP for quest completion:', error);\n        // Don't fail the quest completion if XP award fails, just log it\n      }\n\n      let updatedCompletedQuests = currentPlayer.completedQuests.map((q) =>\n        q.questId === quest.title ? { ...q, rewardCollected: true } : q\n      );\n      const alreadyCompleted = updatedCompletedQuests.some(q => q.questId === quest.title);\n      if (!alreadyCompleted) {\n        updatedCompletedQuests.push({\n          questId: quest.title,\n          rewardCollected: true,\n          timestamp: Date.now(),\n        });\n      }\n\n      // Remove the quest from activeQuests\n      const updatedActiveQuests = currentPlayer.activeQuests.filter(q => q.questId !== quest.title);\n\n      const updatedPlayer = {\n        ...currentPlayer,\n        completedQuests: updatedCompletedQuests,\n        activeQuests: updatedActiveQuests,\n      };\n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: {\n          completedQuests: updatedPlayer.completedQuests,\n          activeQuests: updatedActiveQuests,\n        },\n      }).then((result) => {\n      });\n      // Don't call refreshPlayerAfterInventoryUpdate here - gainIngredients already updated the state\n      // and calling refresh would overwrite the local updates with potentially stale server data\n      // Update player with quest progress but preserve the inventory that was just updated\n      setCurrentPlayer(prev => ({\n        ...prev,\n        completedQuests: updatedPlayer.completedQuests,\n        activeQuests: updatedActiveQuests,\n      }));\n      setQuestList((prevList) => prevList.filter((q) => q.title !== quest.title));\n      \n      // Show quest complete message with bonus if applicable\n      if (bonusMessage) {\n        updateStatus(`Action item complete! Received ${rewardQuantity} ${getLocalizedString(quest.reward, strings)}. ${bonusMessage}`);\n      } else {\n        updateStatus(201);\n      }\n\n    } catch (error) {\n      console.error('Error collecting quest reward:', error);\n      alert('Failed to collect quest reward.');\n    }\n  };\n\n\nconst handleGemPurchase = async (modifiedRecipe, actionType) => {\n    // This is called by the gem button with a recipe modified to include gems\n    // Route to the appropriate handler based on action type\n    if (actionType === 'heal') {\n      return handleHeal(modifiedRecipe);\n    } else if (actionType === 'trade') {\n      return handleTrade(modifiedRecipe);\n    }\n  };\n\nconst handleHeal = async (recipe) => {\n    setErrorMessage('');\n\n    const itemKey = `heal-${recipe.type}`;\n    if (!recipe || isHealing || coolingDownItems.has(itemKey)) {\n      if (!recipe) setErrorMessage('Invalid healing recipe selected.');\n      return;\n    }\n    \n    // Set healing flag and cooldown to prevent spam clicks\n    setIsHealing(true);\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n    \n    // Set timeout for cooldown removal\n    setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n    // Fetch current HP and Max HP from playersInGridManager\n    const gridId = currentPlayer?.location?.g;\n    const playerId = currentPlayer._id?.toString();\n    const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n    if (!playerInGridState) {\n      console.error(`Player ${currentPlayer.username} not found in NPCsInGrid.`);\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    const currentHp = playerInGridState.hp;\n    const maxHp = playerInGridState.maxhp;\n  \n    // Check if healer has HP remaining\n    const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n    if (healerInGrid && healerInGrid.hp !== undefined && healerInGrid.hp <= 0) {\n      updateStatus(`${getLocalizedString(npcData.type, strings)} has no heals remaining.`);\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    \n    // Healing logic with NPCsInGrid HP\n    if (npcData.output === 'hp') {\n      if (currentHp >= maxHp) {\n        updateStatus(401);  // Player is already at full HP\n        setTimeout(() => {\n          setIsHealing(false);\n        }, COOLDOWN_DURATION);\n        return;\n      }\n    }\n    const spendResult = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!spendResult) {\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n      return;\n    }\n    \n    // Refresh player to update money display\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    const healAmount = npcData.qtycollected;\n    const statToMod = 'hp';\n    const amountToMod = Math.min(healAmount, maxHp - currentHp);  // Ensure it doesn't exceed max HP\n\n    try {\n      await modifyPlayerStatsInGridState(statToMod, amountToMod, currentPlayer._id, gridId);\n      setCurrentPlayer((prev) => ({\n        ...prev,\n        hp: Math.min(prev.maxhp, prev.hp + amountToMod),\n      }));  \n      updateStatus(`${strings[405]}${amountToMod}`);\n\n      // Deduct 1 HP from the healer NPC\n      const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n      if (healerInGrid && healerInGrid.hp !== undefined) {\n        const newHealerHP = healerInGrid.hp - 1;\n        \n        if (newHealerHP <= 0) {\n          // Remove the healer from the grid when HP reaches 0\n          await NPCsInGridManager.removeNPC(gridId, npcData.id);\n          updateStatus(`${getLocalizedString(npcData.type, strings)} has been exhausted and disappeared.`);\n          onClose(); // Close the panel since the NPC is gone\n        } else {\n          // Update the healer's HP in the grid\n          await NPCsInGridManager.updateNPC(gridId, npcData.id, { hp: newHealerHP });\n        }\n      }\n\n    } catch (error) {\n      console.error('Error applying healing:', error);\n    } finally {\n      // Clear the healing flag after cooldown duration to sync with animation\n      setTimeout(() => {\n        setIsHealing(false);\n      }, COOLDOWN_DURATION);\n    }\n\n  };\n\n  const handleTrade = async (recipe) => {\n    setErrorMessage('');\n    if (!recipe) {\n      setErrorMessage('Invalid recipe selected.');\n      return;\n    }\n\n    let quantityToGive = recipe.tradeqty || 1;\n    \n    // Get relationship-based multiplier from RelationshipMatrix data\n    const { multiplier, bonusMessage } = getRelationshipMultiplier(npcData.type, currentPlayer, strings);\n    quantityToGive = Math.floor(quantityToGive * multiplier);\n    \n    // Check if we have room for the trade reward BEFORE spending ingredients\n    const hasRoom = hasRoomFor({\n      resource: recipe.type,\n      quantity: quantityToGive,\n      currentPlayer,\n      inventory: inventory,  // Use current prop\n      backpack: backpack,    // Use current prop\n      masterResources,\n      globalTuning\n    });\n    \n    // Create safe copies after the capacity check\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n    \n    if (!hasRoom) {\n      const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n      const isMoney = recipe.type === \"Money\";\n      const isGem = recipe.type === \"Gem\";\n      \n      if (!isMoney && !isGem && !isHomestead) {\n        // Check if player has backpack skill\n        const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n        if (!hasBackpackSkill) {\n          updateStatus(19); // Missing backpack\n        } else {\n          updateStatus(21); // Backpack full\n        }\n      } else {\n        updateStatus(20); // Warehouse full\n      }\n      return;\n    }\n\n    const spendResult = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendResult || (spendResult.success !== undefined && !spendResult.success)) {\n      setErrorMessage('Not enough ingredients.');\n      return;\n    }\n    \n    // Use the updated inventory and backpack from spendIngredients\n    const gained = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: recipe.type,\n      quantity: quantityToGive,\n      inventory: spendResult.updatedInventory,  // Use the updated inventory\n      backpack: spendResult.updatedBackpack,   // Use the updated backpack\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n    \n    if (!gained) {\n      setErrorMessage('Failed to complete trade.');\n      return;\n    }\n\n    // Track quest progress for trading (using 'Collect' action to match quest system)\n    await trackQuestProgress(currentPlayer, 'Collect', recipe.type, quantityToGive, setCurrentPlayer);\n\n    // Award trophies for specific trade rewards\n    try {\n      if (recipe.type === \"Home Deed\") {\n        console.log(` Awarding Homesteader trophy for trading Home Deed`);\n        await earnTrophy(currentPlayer.playerId, \"Homesteader\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n        // Try to advance FTUE if this is the player's first Home Deed purchase\n        await tryAdvanceFTUEByTrigger('BoughtHomeDeed', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n      } else if (recipe.type === \"Brass Bell\") {\n        console.log(` Awarding Brass Bell trophy for trading Brass Bell`);\n        await earnTrophy(currentPlayer.playerId, \"Brass Bell\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      } else if (recipe.type === \"Hope\") {\n        console.log(` Awarding Hope trophy for trading Hope`);\n        await earnTrophy(currentPlayer.playerId, \"Hope\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      } else if (recipe.type === \"Town Key\") {\n        // Try to advance FTUE when acquiring Town Key from Constable Elbow\n        await tryAdvanceFTUEByTrigger('AcquiredTownKey', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n      }\n    } catch (error) {\n      console.error(' Error awarding trade trophy:', error);\n      // Don't fail the trade if trophy awarding fails\n    }\n\n    // Award XP for trading with NPC\n    const npcResourceForXP = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n    const xpToAward = npcResourceForXP?.xp || 1;\n    try {\n      const xpResponse = await axios.post(`${API_BASE}/api/addXP`, {\n        playerId: currentPlayer.playerId,\n        xpAmount: xpToAward\n      });\n\n      if (xpResponse.data.success) {\n        // Update current player's XP locally\n        setCurrentPlayer(prev => ({\n          ...prev,\n          xp: xpResponse.data.newXP\n        }));\n      }\n    } catch (error) {\n      console.error(' Error awarding XP for NPC trade:', error);\n      // Don't fail the trade if XP award fails, just log it\n    }\n\n    // Build ingredient list for status message\n    const ingredientList = [];\n    \n    // Check if using new format with requiresArray\n    if (recipe.requiresArray && Array.isArray(recipe.requiresArray)) {\n      recipe.requiresArray.forEach(req => {\n        if (req.type && req.quantity) {\n          ingredientList.push(`${req.quantity} ${req.type}`);\n        }\n      });\n    } else {\n      // Legacy format - check all numbered ingredients\n      for (let i = 1; i <= 10; i++) {\n        const ingredientType = recipe[`ingredient${i}`];\n        const ingredientQty = recipe[`ingredient${i}qty`];\n        if (ingredientType && ingredientQty) {\n          ingredientList.push(`${ingredientQty} ${ingredientType}`);\n        }\n      }\n    }\n    const ingredientString = ingredientList.join(', ');\n    \n    // Show success message with bonus if applicable\n    updateStatus(`Exchanged ${ingredientString} for ${quantityToGive} ${getLocalizedString(recipe.type, strings)}.${bonusMessage}`);\n  };\n\n  const handleSellNPC = async () => {\n    // Verify developer status before executing\n    const isStillDeveloper = await checkDeveloperStatus(currentPlayer?.username);\n    if (!isStillDeveloper) {\n      updateStatus(' Developer access required.');\n      return;\n    }\n\n    if (!npcData || !npcData.id) {\n      console.error('Cannot sell NPC: Missing NPC data or ID');\n      return;\n    }\n\n    try {\n      const gridId = currentPlayer.location.g;\n      await NPCsInGridManager.removeNPC(gridId, npcData.id);\n      updateStatus(`${getLocalizedString(npcData.type, strings)} has been removed from the grid.`);\n      onClose(); // Close the panel after selling\n    } catch (error) {\n      console.error('Error selling NPC:', error);\n      updateStatus(` Failed to remove ${getLocalizedString(npcData.type, strings)}.`);\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1013\" title={`${npcData.symbol} ${getLocalizedString(npcData.type, strings)}`} panelName=\"NPCPanel\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n\n{/* //////////////////// QUESTS //////////////////////// */}\n\n      {npcData.action === 'quest' && (\n        <div className=\"quest-options\">\n\n          {/* NPC Interests Section - only show if player has met this NPC */}\n          {(() => {\n            // Check if player has met this NPC\n            const playerRelationship = currentPlayer?.relationships?.find(r => r.name === npcData.type);\n            if (!playerRelationship?.met) return null;\n\n            const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n            if (!npcMatrix) return null;\n\n            const interests = [npcMatrix.interest1, npcMatrix.interest2, npcMatrix.interest3].filter(Boolean);\n            const uniqueInterests = [...new Set(interests)];\n\n            if (uniqueInterests.length === 0) return null;\n\n            const interestSymbols = uniqueInterests.map(interest => {\n              const resource = masterResources.find(r => r.type === interest);\n              return resource ? { type: interest, symbol: resource.symbol } : null;\n            }).filter(Boolean);\n\n            if (interestSymbols.length === 0) return null;\n\n            return (\n              <div style={{ marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '8px' }}>\n                <h3 style={{ margin: 0 }}>{strings[619]}</h3>\n                {interestSymbols.map((item, index) => (\n                  <span key={index} title={item.type} style={{ fontSize: '1.5em' }}>\n                    {item.symbol}\n                  </span>\n                ))}\n              </div>\n            );\n          })()}\n\n          {/* NPC Relationship Status Section - shows who this NPC loves/is friends with/rivals with/married to */}\n          {/* Only show if player has met this NPC */}\n          {(() => {\n            // Check if player has met this NPC\n            const playerRelationship = currentPlayer?.relationships?.find(r => r.name === npcData.type);\n            if (!playerRelationship?.met) return null;\n\n            const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n            if (!npcMatrix) return null;\n\n            // Find all NPC-to-NPC relationships by checking for relationship values\n            const relationshipTypes = ['love', 'friend', 'rival', 'married'];\n            const relationships = [];\n\n            Object.entries(npcMatrix).forEach(([key, value]) => {\n              if (relationshipTypes.includes(value)) {\n                // Find the target NPC's symbol from RelationshipMatrix\n                const targetNPC = RelationshipMatrix.find(r => r.type === key);\n                if (targetNPC) {\n                  relationships.push({\n                    targetName: key,\n                    targetSymbol: targetNPC.symbol,\n                    relationshipType: value\n                  });\n                }\n              }\n            });\n\n            if (relationships.length === 0) return null;\n\n            // Group relationships by type\n            const grouped = {\n              love: relationships.filter(r => r.relationshipType === 'love'),\n              friend: relationships.filter(r => r.relationshipType === 'friend'),\n              rival: relationships.filter(r => r.relationshipType === 'rival'),\n              married: relationships.filter(r => r.relationshipType === 'married')\n            };\n\n            // String mappings: 660 = love, 661 = friend, 662 = rival, 663 = married\n            const stringMap = { love: 660, friend: 661, rival: 662, married: 663 };\n\n            return (\n              <div style={{ marginBottom: '10px' }}>\n                {Object.entries(grouped).map(([type, rels]) => {\n                  if (rels.length === 0) return null;\n                  return (\n                    <div key={type} style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>\n                      <h3 style={{ margin: 0 }}>{strings[stringMap[type]]}</h3>\n                      {rels.map((rel, index) => (\n                        <span key={index} title={rel.targetName} style={{ fontSize: '1.5em', cursor: 'help' }}>\n                          {rel.targetSymbol}\n                        </span>\n                      ))}\n                    </div>\n                  );\n                })}\n              </div>\n            );\n          })()}\n\n          {/* Relationship Card - only show if NPC doesn't have output='noRel' */}\n          {(() => {\n            const npcResource = masterResources.find(r => r.type === npcData.type && r.category === 'npc');\n            const shouldHideRelationship = npcResource?.output === 'noRel';\n\n            if (shouldHideRelationship) {\n              return null;\n            }\n\n            return (\n              <RelationshipCard\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            targetName={npcData.type}\n            targetType=\"npc\"\n            targetEmoji={npcData.symbol}\n            showActions={true}\n            compact={false}\n            masterInteractions={masterInteractions}\n            updateStatus={updateStatus}\n            masterResources={masterResources}\n            playerPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              return playerInGridState?.position || null;\n            })()}\n            targetPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              return npcInGrid?.position || null;\n            })()}\n            TILE_SIZE={TILE_SIZE}\n            checkDistance={() => {\n              // No range restriction on own homestead\n              const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n              if (isOnOwnHomestead) return true;\n\n              // Get player position\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              if (!playerInGridState?.position) return false;\n\n              // Get NPC position\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              if (!npcInGrid?.position) return false;\n\n              // Calculate distance\n              const distance = calculateDistance(playerInGridState.position, npcInGrid.position);\n              const playerRange = getDerivedRange(currentPlayer, masterResources);\n\n              return distance <= playerRange;\n            }}\n            onInteractionClick={() => {\n              return new Promise((resolve) => {\n                // Capture relationship state before interaction for StoryModal check\n                const rel = currentPlayer.relationships?.find(r => r.name === npcData.type);\n                preInteractionRelationshipRef.current = rel ? { ...rel } : null;\n\n                // Just center camera on player using current zoom level\n                const gridId = currentPlayer?.location?.g;\n                const playerId = currentPlayer._id?.toString();\n                const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                if (playerInGridState?.position) {\n                  centerCameraOnPlayer(playerInGridState.position, TILE_SIZE);\n                }\n                resolve();\n              });\n            }}\n            onRelationshipChange={(interaction, success) => {\n              // Check if a new relationship status was added\n              if (success && interaction.relbitadd) {\n                const statusKey = interaction.relbitadd.toLowerCase();\n                const preRel = preInteractionRelationshipRef.current;\n\n                // If status wasn't present before, show StoryModal\n                if (!preRel || !preRel[statusKey]) {\n                  // Check if this NPC has dialog for this relationship type\n                  const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n                  const dialogKeyMap = {\n                    met: 'dialogOnMet',\n                    friend: 'dialogOnFriend',\n                    married: 'dialogOnMarried',\n                    love: 'dialogOnLove',\n                    rival: 'dialogOnRival',\n                  };\n                  const dialogKey = dialogKeyMap[statusKey];\n\n                  if (npcMatrix && dialogKey && npcMatrix[dialogKey]) {\n                    setStoryRelationshipType(statusKey);\n                    setStoryModalOpen(true);\n                  }\n                }\n              }\n            }}\n            isDeveloper={isDeveloper}\n          />\n            );\n          })()}\n\n          {/* Show message if quest interaction is not available due to relationship */}\n          {!canQuest && (\n            <div style={{\n              padding: '10px',\n              backgroundColor: 'var(--color-bg-light)',\n              borderRadius: '5px',\n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: 'var(--color-text-muted)'\n            }}>\n              {strings[625]}{npcData.type}.\n            </div>\n          )}\n\n          {canQuest && hasHiddenQuests && (\n            <div style={{\n              padding: '10px',\n              backgroundColor: 'var(--color-bg-light)',\n              borderRadius: '5px',\n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: 'var(--color-text-muted)'\n            }}>\n              {strings[627]?.replace('{npc}', npcData?.type || '')}\n            </div>\n          )}\n\n          {canQuest && questList.length === 0 && !hasHiddenQuests && (\n            <div style={{\n              padding: '10px',\n              backgroundColor: 'var(--color-bg-light)',\n              borderRadius: '5px',\n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: 'var(--color-text-muted)'\n            }}>\n              {strings[205]}\n            </div>\n          )}\n\n          {canQuest && (\n            <>\n              {questList.length > 0 && (\n                <h3>{strings[204]}</h3>\n              )}\n              {questList.map((quest) => {\n            const isRewardable = currentPlayer.activeQuests.some(\n              (q) => q.questId === quest.title && q.completed && !q.rewardCollected\n            );\n\n            const state = isRewardable ? 'reward' : 'accept';\n            const questMeetsLevel = meetsLevelRequirement(quest.level);\n            const onClick = state === 'reward'\n              ? () => handleGetReward(quest)\n              : () => handleAcceptQuest(quest.title);\n\n            // Get XP for this NPC\n            const npcResourceForXP = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n            const xpToAward = npcResourceForXP?.xp || 1;\n\n            return (\n              <QuestGiverButton\n                key={quest.title}\n                quest={{\n                  symbol: quest.symbol,\n                  title: quest.title,\n                  textbody: quest.textbody,\n                  goals: [\n                    { action: quest.goal1action, item: quest.goal1item, qty: quest.goal1qty },\n                    { action: quest.goal2action, item: quest.goal2item, qty: quest.goal2qty },\n                    { action: quest.goal3action, item: quest.goal3item, qty: quest.goal3qty },\n                  ],\n                  reward: quest.reward,\n                  rewardqty: quest.rewardqty,\n                }}\n                state={state}\n                onClick={onClick}\n                xpReward={xpToAward}\n                level={quest.level}\n                meetsLevelRequirement={questMeetsLevel}\n              />\n            );\n              })}\n            </>\n          )}\n          \n        </div>\n      )}\n\n\n{/* //////////////////// HEALING //////////////////////// */}\n\n      {npcData.action === 'heal' && healRecipes.length > 0 && (\n        <div className=\"heal-options\">\n          {/* Render healer interaction animation when healing */}\n          <HealerInteraction\n            isHealing={isHealing}\n            currentPlayer={currentPlayer}\n            TILE_SIZE={TILE_SIZE}\n            healAmount={npcData.qtycollected}\n            onHealingComplete={() => setIsHealing(false)}\n          />\n<br />\n          {/* Fetch and display player's HP from playersInGridManager */}\n          {(() => {\n            const gridId = currentPlayer?.location?.g;\n            const playerId = currentPlayer._id?.toString();\n            const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n<br />\n            if (playerInGridState) {\n              return (\n                <>\n                  <h3>{strings[511]} <br />{playerInGridState.hp} / {playerInGridState.maxhp}</h3>\n                </>\n              );\n            } else {\n              return <h4>{strings[512]}</h4>;\n            }\n          })()}\n<br />\n          {healRecipes.map((recipe) => {\n            const ingredients = getIngredientDetails(recipe, masterResources);\n            const affordable = canAfford(recipe, inventory, 1);\n            const healAmount = recipe.qtycollected; // Healing value\n\n            const itemKey = `heal-${recipe.type}`;\n            const isCoolingDown = coolingDownItems.has(itemKey);\n            \n            // Check if healer has HP remaining\n            const gridId = currentPlayer?.location?.g;\n            const healerInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n            const healerOutOfHP = healerInGrid && healerInGrid.hp !== undefined && healerInGrid.hp <= 0;\n            \n            // Get the NPC template from masterResources to find maxhp\n            const npcTemplate = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n            const totalHeals = npcTemplate?.maxhp || 'Unknown';\n            \n            return (\n              <div key={recipe.type}>\n                <ResourceButton\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  details={`${strings[463]}  +${healAmount}<br>${strings[461]} ${ingredients.join(', ') || 'None'}`}\n                  info={`${strings[51]}${totalHeals}`}\n                  disabled={!affordable || isHealing || isCoolingDown || healerOutOfHP}\n                  onClick={() => handleHeal(recipe)}\n                  className={isCoolingDown ? 'cooldown' : ''}\n                  style={isCoolingDown ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                  // Gem purchase props\n                  gemCost={recipe.gemcost || null}\n                  onGemPurchase={(recipe.gemcost && !affordable && !isHealing && !isCoolingDown && !healerOutOfHP) ? (modifiedRecipe) => handleGemPurchase(modifiedRecipe, 'heal') : null}\n                  resource={recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                />\n                {/* Display healer's HP below the ResourceButton */}\n                {healerInGrid && healerInGrid.hp !== undefined && (\n                  <div className=\"healer-hp-text\">\n                    {strings[49]} {healerInGrid.hp}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n      )}\n\n{/* //////////////////// TRADING //////////////////////// */}\n\n      {npcData.action === 'trade' && (\n        <div className=\"trade-options\">\n\n          {/* NPC Interests Section - only show if player has met this NPC */}\n          {(() => {\n            // Check if player has met this NPC\n            const playerRelationship = currentPlayer?.relationships?.find(r => r.name === npcData.type);\n            if (!playerRelationship?.met) return null;\n\n            const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n            if (!npcMatrix) return null;\n\n            const interests = [npcMatrix.interest1, npcMatrix.interest2, npcMatrix.interest3].filter(Boolean);\n            const uniqueInterests = [...new Set(interests)];\n\n            if (uniqueInterests.length === 0) return null;\n\n            const interestSymbols = uniqueInterests.map(interest => {\n              const resource = masterResources.find(r => r.type === interest);\n              return resource ? { type: interest, symbol: resource.symbol } : null;\n            }).filter(Boolean);\n\n            if (interestSymbols.length === 0) return null;\n\n            return (\n              <div style={{ marginBottom: '10px', display: 'flex', alignItems: 'center', gap: '8px' }}>\n                <h3 style={{ margin: 0 }}>{strings[619]}</h3>\n                {interestSymbols.map((item, index) => (\n                  <span key={index} title={item.type} style={{ fontSize: '1.5em' }}>\n                    {item.symbol}\n                  </span>\n                ))}\n              </div>\n            );\n          })()}\n\n          {/* NPC Relationship Status Section - shows who this NPC loves/is friends with/rivals with/married to */}\n          {/* Only show if player has met this NPC */}\n          {(() => {\n            // Check if player has met this NPC\n            const playerRelationship = currentPlayer?.relationships?.find(r => r.name === npcData.type);\n            if (!playerRelationship?.met) return null;\n\n            const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n            if (!npcMatrix) return null;\n\n            // Find all NPC-to-NPC relationships by checking for relationship values\n            const relationshipTypes = ['love', 'friend', 'rival', 'married'];\n            const relationships = [];\n\n            Object.entries(npcMatrix).forEach(([key, value]) => {\n              if (relationshipTypes.includes(value)) {\n                // Find the target NPC's symbol from RelationshipMatrix\n                const targetNPC = RelationshipMatrix.find(r => r.type === key);\n                if (targetNPC) {\n                  relationships.push({\n                    targetName: key,\n                    targetSymbol: targetNPC.symbol,\n                    relationshipType: value\n                  });\n                }\n              }\n            });\n\n            if (relationships.length === 0) return null;\n\n            // Group relationships by type\n            const grouped = {\n              love: relationships.filter(r => r.relationshipType === 'love'),\n              friend: relationships.filter(r => r.relationshipType === 'friend'),\n              rival: relationships.filter(r => r.relationshipType === 'rival'),\n              married: relationships.filter(r => r.relationshipType === 'married')\n            };\n\n            // String mappings: 660 = love, 661 = friend, 662 = rival, 663 = married\n            const stringMap = { love: 660, friend: 661, rival: 662, married: 663 };\n\n            return (\n              <div style={{ marginBottom: '10px' }}>\n                {Object.entries(grouped).map(([type, rels]) => {\n                  if (rels.length === 0) return null;\n                  return (\n                    <div key={type} style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '4px' }}>\n                      <h3 style={{ margin: 0 }}>{strings[stringMap[type]]}</h3>\n                      {rels.map((rel, index) => (\n                        <span key={index} title={rel.targetName} style={{ fontSize: '1.5em', cursor: 'help' }}>\n                          {rel.targetSymbol}\n                        </span>\n                      ))}\n                    </div>\n                  );\n                })}\n              </div>\n            );\n          })()}\n\n          {/* Relationship Card - only show if NPC doesn't have output='noRel' */}\n          {(() => {\n            const npcResource = masterResources.find(r => r.type === npcData.type && r.category === 'npc');\n            const shouldHideRelationship = npcResource?.output === 'noRel';\n\n            if (shouldHideRelationship) {\n              return null;\n            }\n\n            return (\n              <RelationshipCard\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            targetName={npcData.type}\n            targetType=\"npc\"\n            targetEmoji={npcData.symbol}\n            showActions={true}\n            compact={false}\n            masterInteractions={masterInteractions}\n            updateStatus={updateStatus}\n            masterResources={masterResources}\n            playerPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              return playerInGridState?.position || null;\n            })()}\n            targetPosition={(() => {\n              const gridId = currentPlayer?.location?.g;\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              return npcInGrid?.position || null;\n            })()}\n            TILE_SIZE={TILE_SIZE}\n            checkDistance={() => {\n              // No range restriction on own homestead\n              const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n              if (isOnOwnHomestead) return true;\n\n              // Get player position\n              const gridId = currentPlayer?.location?.g;\n              const playerId = currentPlayer._id?.toString();\n              const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n              if (!playerInGridState?.position) return false;\n\n              // Get NPC position\n              const npcInGrid = NPCsInGridManager.getNPCsInGrid(gridId)?.[npcData.id];\n              if (!npcInGrid?.position) return false;\n\n              // Calculate distance\n              const distance = calculateDistance(playerInGridState.position, npcInGrid.position);\n              const playerRange = getDerivedRange(currentPlayer, masterResources);\n\n              return distance <= playerRange;\n            }}\n            onInteractionClick={() => {\n              return new Promise((resolve) => {\n                // Capture relationship state before interaction for StoryModal check\n                const rel = currentPlayer.relationships?.find(r => r.name === npcData.type);\n                preInteractionRelationshipRef.current = rel ? { ...rel } : null;\n\n                // Just center camera on player using current zoom level\n                const gridId = currentPlayer?.location?.g;\n                const playerId = currentPlayer._id?.toString();\n                const playerInGridState = playersInGridManager.getPlayersInGrid(gridId)?.[playerId];\n                if (playerInGridState?.position) {\n                  centerCameraOnPlayer(playerInGridState.position, TILE_SIZE);\n                }\n                resolve();\n              });\n            }}\n            onRelationshipChange={(interaction, success) => {\n              // Check if a new relationship status was added\n              if (success && interaction.relbitadd) {\n                const statusKey = interaction.relbitadd.toLowerCase();\n                const preRel = preInteractionRelationshipRef.current;\n\n                // If status wasn't present before, show StoryModal\n                if (!preRel || !preRel[statusKey]) {\n                  // Check if this NPC has dialog for this relationship type\n                  const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n                  const dialogKeyMap = {\n                    met: 'dialogOnMet',\n                    friend: 'dialogOnFriend',\n                    married: 'dialogOnMarried',\n                    love: 'dialogOnLove',\n                    rival: 'dialogOnRival',\n                  };\n                  const dialogKey = dialogKeyMap[statusKey];\n\n                  if (npcMatrix && dialogKey && npcMatrix[dialogKey]) {\n                    setStoryRelationshipType(statusKey);\n                    setStoryModalOpen(true);\n                  }\n                }\n              }\n            }}\n            isDeveloper={isDeveloper}\n          />\n            );\n          })()}\n\n          {/* Show message if trade interaction is not available due to relationship */}\n          {!canTrade && (\n            <div style={{\n              padding: '10px',\n              backgroundColor: 'var(--color-bg-light)',\n              borderRadius: '5px',\n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: 'var(--color-text-muted)'\n            }}>\n              {strings[626]}{npcData.type}.\n            </div>\n          )}\n\n          {/* Show message if some trades are hidden due to relationship requirements */}\n          {canTrade && hasHiddenTrades && (\n            <div style={{\n              padding: '10px',\n              backgroundColor: 'var(--color-bg-light)',\n              borderRadius: '5px',\n              marginTop: '10px',\n              textAlign: 'center',\n              fontStyle: 'italic',\n              color: 'var(--color-text-muted)'\n            }}>\n              {strings[628]?.replace('{npc}', npcData?.type || '')}\n            </div>\n          )}\n\n          {canTrade && (\n            <>\n              <h3>{strings[420]}</h3>\n              {tradeRecipes.length > 0 ? (\n                (() => {\n                  const filteredRecipes = tradeRecipes.filter((recipe) => {\n                    // Check the trader offer's repeat flag (from traders.json)\n                    // If repeat is false and player already has it, filter it out\n                    if (recipe.repeat === false) {\n                      // Check if player has this item in inventory or backpack\n                      const hasInInventory = inventory?.some(item => item.type === recipe.type);\n                      const hasInBackpack = backpack?.some(item => item.type === recipe.type);\n\n                      if (hasInInventory || hasInBackpack) {\n                        return false; // Don't show this offer\n                      }\n                    }\n\n                    return true; // Show all other offers\n                  });\n                  \n                  // If all trades were filtered out, show a message\n                  if (filteredRecipes.length === 0) {\n                    return <p>{strings[423]}</p>;\n                  }\n                  \n                  return filteredRecipes.map((recipe) => {\n                  const affordable = canAfford(recipe, inventory, backpack, 1);\n                  // For traders, treat 'devonly' as no skill requirement (devonly is used to hide from FarmHand, not traders)\n                  const meetsSkillRequirement = recipe.requires === 'devonly' ? true : hasRequiredSkill(recipe.requires);\n                  const meetsLevel = meetsLevelRequirement(recipe.level);\n                  const requirementsMet = meetsSkillRequirement && meetsLevel;\n                  const quantityToGive = recipe.tradeqty || 1;\n\n                  // Format costs with color per ingredient (matching CraftingStation.js style)\n                  // Support dynamic number of ingredients based on whether data comes from masterTraders or legacy format\n                  let formattedCosts = '';\n\n                  // Check if this recipe has a 'requiresArray' array (from masterTraders)\n                  if (recipe.requiresArray && Array.isArray(recipe.requiresArray)) {\n                    // New format from masterTraders - dynamic number of ingredients\n                    formattedCosts = recipe.requiresArray.map((req) => {\n                      const type = req.type;\n                      const qty = req.quantity;\n                      if (!type || !qty) return '';\n\n                      const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n                      const color = playerQty >= qty ? 'green' : 'red';\n                      const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                      return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n                    }).join('');\n                  } else {\n                    // Legacy format - check ingredient1 through ingredientN\n                    const ingredientsList = [];\n                    for (let i = 1; i <= 10; i++) { // Check up to 10 ingredients for safety\n                      const type = recipe[`ingredient${i}`];\n                      const qty = recipe[`ingredient${i}qty`];\n                      if (!type || !qty) continue;\n\n                      const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n                      const color = playerQty >= qty ? 'green' : 'red';\n                      const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                      ingredientsList.push(`<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`);\n                    }\n                    formattedCosts = ingredientsList.join('');\n                  }\n\n                  // Get XP for this NPC\n                  const npcResourceForXP = masterResources.find(res => res.type === npcData.type && res.category === 'npc');\n                  const xpToAward = npcResourceForXP?.xp || 1;\n\n                  const levelColor = meetsLevel ? 'green' : 'red';\n                  const details =\n                    (recipe.level ? `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${recipe.level}</span>` : '') +\n                    `${strings[461]}<div>${formattedCosts}</div><div style=\"margin-top: 8px; color: #4CAF50;\"> +${xpToAward} XP</div>`;\n\n                  const isDisabled = !affordable || !requirementsMet;\n\n                  return (\n                    <ResourceButton\n                      key={`${recipe.source}-${recipe.index}`}\n                      symbol={recipe.symbol}\n                      name={`${quantityToGive} ${getLocalizedString(recipe.type, strings)}`}\n                      details={details}\n                      disabled={isDisabled}\n                      onClick={() => handleTrade(recipe)}\n                      // Gem purchase props\n                      gemCost={recipe.gemcost || null}\n                      onGemPurchase={(recipe.gemcost && (!affordable || !requirementsMet)) ? (modifiedRecipe) => handleGemPurchase(modifiedRecipe, 'trade') : null}\n                      meetsLevelRequirement={meetsLevel}\n                      resource={recipe}\n                      inventory={inventory}\n                      backpack={backpack}\n                      masterResources={masterResources}\n                      currentPlayer={currentPlayer}\n                      devOnly={recipe.requires === 'devonly'}\n                    />\n                  );\n                  });\n                })()\n              ) : (\n                <p>{strings[423]}</p>\n              )}\n              \n            </>\n          )}\n\n          {/* Separator bar before story quote */}\n          <hr style={{ margin: '16px 0', border: 'none', borderTop: '1px solid var(--color-border, #444)' }} />\n\n          {/* Trader story text - only shown if player has met this NPC */}\n          {(() => {\n            // Check if player has met this NPC\n            const relationship = currentPlayer.relationships?.find(r => r.name === npcData.type);\n            if (!relationship?.met) return null;\n\n            const npcMatrix = RelationshipMatrix.find(r => r.type === npcData.type);\n            const dialogStringId = npcMatrix?.dialogOnMet;\n\n            if (dialogStringId && strings[dialogStringId]) {\n              // Replace {username} placeholder with actual player username\n              const storyText = strings[dialogStringId].replace(/\\{username\\}/gi, currentPlayer?.username || 'Adventurer');\n              return (\n                <div className=\"trader-story\">\n                  <p>{storyText}</p>\n                </div>\n              );\n            }\n            return null;\n          })()}\n        </div>\n      )}\n\n        </div>\n        \n        {/* Pinned footer with sell/refund button */}\n        {isDeveloper && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <button \n                className=\"btn-basic btn-danger\" \n                onClick={handleSellNPC}\n              >\n                {strings[490]}\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Story Modal for relationship milestone dialogs */}\n      <StoryModal\n        isOpen={storyModalOpen}\n        onClose={() => {\n          setStoryModalOpen(false);\n          // Advance FTUE when first meeting Constable Elbow\n          if (npcData?.type === 'Constable Elbow' && storyRelationshipType === 'met') {\n            tryAdvanceFTUEByTrigger('MetConstableElbow', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n          }\n        }}\n        npcName={npcData?.type}\n        relationshipType={storyRelationshipType}\n        username={currentPlayer?.username}\n      />\n    </Panel>\n  );\n};\n\nexport default React.memo(NPCPanel);\n","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails, hasRequiredSkill as checkRequiredSkill, isVisibleToPlayer } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/Panels/PanelContext';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { getMayorUsername } from '../Government/GovUtils';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\nimport { updatePlayerSettings } from '../../settings';\n\nconst BuildPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, // Added for quest tracking\n  masterSkills, // Uncomment if needed for skill checks\n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n  masterXPLevels,\n  cursorMode,\n  setCursorMode,\n}) => {\n  const { closePanel } = usePanelContext(); // Use closePanel from context\n  const [buildOptions, setBuildOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [isMayor, setIsMayor] = useState(false);\n  const strings = useStrings();\n  const [placeWithCursor, setPlaceWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n\n  // Toggle handler - persists to player settings\n  const handleToggleChange = (checked) => {\n    setPlaceWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings (uses same setting as farming panel)\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting an item for cursor mode\n  const handleCursorModeSelect = (item) => {\n    setCursorMode({\n      type: 'build',\n      item: item.type,\n      emoji: item.symbol || '',\n      range: item.range || 1,\n      buildOptions: buildOptions,\n    });\n  };\n\n  // Fetch inventory and build options when the panel initializes\n  useEffect(() => {\n    console.log(' BuildPanel opened with currentPlayer:', {\n      username: currentPlayer?.username,\n      role: currentPlayer?.role,\n      homeSettlementId: currentPlayer?.settlementId,\n      currentLocation: currentPlayer?.location,\n      isDeveloper\n    });\n    \n    const fetchData = async () => {\n      //setIsContentLoading(true);\n      try {\n        // Check if player is mayor ONLY if we're in a town\n        let isPlayerMayor = false;\n        if (currentPlayer.location.gtype === 'town' && currentPlayer.location.s) {\n          console.log(' In town, checking if player is mayor...');\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n          console.log(' Mayor check:', { mayorUsername, playerUsername: currentPlayer.username, isPlayerMayor });\n        }\n        setIsMayor(isPlayerMayor);\n        \n        // Fetch inventory\n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        // Fetch all resources and filter for build options\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        \n        // Debug: Show all BuildTown resources\n        const buildTownResources = allResourcesData.filter(r => r.source === 'BuildTown');\n        console.log(' BuildTown resources found:', buildTownResources.map(r => r.type));\n        //  Filter build options based on the player's location\n        const validBuildOptions = allResourcesData.filter(resource => {\n          // Filter out devonly resources unless player is a developer\n          if (!isVisibleToPlayer(resource, isDeveloper)) return false;\n\n          // Check if resource is a valid build option based on source and location\n          // Convert to strings for comparison to handle ObjectId vs string issues\n          const currentSettlementStr = String(currentPlayer.location.s || '');\n          const homeSettlementStr = String(currentPlayer.settlementId || '');\n          const settlementsMatch = currentSettlementStr === homeSettlementStr;\n          \n          if (resource.source === 'BuildTown') {\n            console.log(`BuildPanel: Checking ${resource.type}:`, {\n              source: resource.source,\n              gtype: currentPlayer.location.gtype,\n              isPlayerMayor,\n              currentSettlement: currentPlayer.location.s,\n              homeSettlement: currentPlayer.settlementId,\n              currentSettlementStr,\n              homeSettlementStr,\n              settlementsMatch,\n              isDeveloper\n            });\n          }\n          \n          const isValidSource = resource.source === 'Build' || \n            (resource.source === 'BuildTown' && currentPlayer.location.gtype === 'town' && (isPlayerMayor || isDeveloper) && \n             (settlementsMatch || isDeveloper)) ||\n            (resource.source === 'BuildValley' && currentPlayer.location.gtype != 'homestead');\n          \n          if (!isValidSource) return false;\n          \n          // Check seasonal restriction\n          if (resource.season && currentSeason && resource.season !== currentSeason) {\n            return false;\n          }\n          \n          // Pet-specific filtering\n          if (resource.category === 'pet') {\n            console.log(` Checking pet ${resource.type}...`);\n            \n            // Only allow pets on homesteads (unless isDeveloper)\n            if (currentPlayer.location.gtype !== 'homestead' && !isDeveloper) {\n              console.log(` Filtering out pet ${resource.type} - not on homestead`);\n              return false;\n            }\n            \n            // Check if player already has this pet type on their homestead\n            // Resources on the grid use layoutkey to identify their type\n            const existingPetOfType = resources.find(r => \n              r.layoutkey === resource.type || r.type === resource.type\n            );\n            \n            if (existingPetOfType && !isDeveloper) {\n              console.log(` Filtering out pet ${resource.type} - already exists on grid (layoutkey: ${existingPetOfType.layoutkey}, type: ${existingPetOfType.type})`);\n              return false; // Already have one of this pet type\n            }\n            \n            console.log(` Pet ${resource.type} is available to build`);\n          }\n          \n          return true;\n        });\n        \n        // Debug: Show what will be displayed\n        const buildTownInFinal = validBuildOptions.filter(r => r.source === 'BuildTown');\n        console.log(' Final BuildPanel options:', {\n          totalOptions: validBuildOptions.length,\n          buildTownIncluded: buildTownInFinal.map(r => r.type),\n          shouldHaveBuildTown: currentPlayer.location.gtype === 'town' && \n                               (isPlayerMayor || isDeveloper) && \n                               (String(currentPlayer.location.s) === String(currentPlayer.settlementId) || isDeveloper)\n        });\n        \n        setBuildOptions(validBuildOptions); \n      } catch (error) {\n        console.error('Error fetching build panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [currentPlayer, currentPlayer?.location?.s, currentPlayer?.location?.gtype, currentPlayer?.settlementId, isDeveloper, currentSeason]);\n\n  // Local wrapper for the utility function\n  const hasRequiredSkill = (requiredSkill) => checkRequiredSkill(requiredSkill, currentPlayer);\n\n  // Check if player meets the level requirement for a resource\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n  // Count BuildTown buildings on the current grid\n  const countTownBuildings = () => {\n    if (!resources || !allResources) return 0;\n    \n    return resources.filter(resource => {\n      // Find the master resource to check if it's a BuildTown source\n      const masterResource = allResources.find(mr => mr.type === resource.type);\n      return masterResource && masterResource.source === 'BuildTown';\n    }).length;\n  };\n\n  const maxTownBuildings = globalTuning?.maxTownBuildings || 500; // Default to 50 if not set\n  const currentTownBuildings = countTownBuildings();\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n\n  \n  return (\n    <Panel onClose={closePanel} descriptionKey=\"1002\" titleKey=\"1102\" panelName=\"BuildPanel\">\n      <div className=\"standard-panel\">\n        {/* Place with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n          gap: '8px',\n          marginBottom: '10px',\n          padding: '5px 0'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Place with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={placeWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buildOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory, backpack);\n              const meetsSkillRequirement = hasRequiredSkill(item.requires);\n              const meetsLevel = meetsLevelRequirement(item.level);\n              const requirementsMet = meetsSkillRequirement && meetsLevel;\n\n              // Check if this is a BuildTown building and if we've hit the limit\n              const isTownBuilding = item.source === 'BuildTown' && currentPlayer.location.gtype !== 'homestead';\n              const townBuildingLimitReached = isTownBuilding && currentTownBuildings >= maxTownBuildings;\n              const isDisabled = !affordable || !requirementsMet || townBuildingLimitReached;\n              const isSelectedForCursor = cursorMode?.type === 'build' && cursorMode?.item === item.type;\n\n              // Build className based on state\n              let buttonClassName = '';\n              if (isSelectedForCursor) buttonClassName += 'cursor-selected ';\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(bpItem => bpItem.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = meetsSkillRequirement ? 'green' : 'red';\n              const levelColor = meetsLevel ? 'green' : 'red';\n              const details =\n                (townBuildingLimitReached ? `<span style=\"color: red;\">${strings[407]}</span>` : '') +\n                (item.level ? `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${item.level}</span>` : '') +\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              const info = `\n                ${strings[820]}${\n                  allResources\n                    .filter((res) => res.source === item.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None'\n                }\n              `;\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  info={info}\n                  disabled={isDisabled}\n                  className={buttonClassName}\n                  onClick={() => {\n                    if (isDisabled) return;\n                    if (placeWithCursor) {\n                      // In cursor mode: select this item for placing via clicks\n                      handleCursorModeSelect(item);\n                    } else {\n                      // Normal mode: build at player position immediately\n                      handleConstruction({\n                        TILE_SIZE,\n                        selectedItem: item.type,\n                        buildOptions,\n                        inventory,\n                        setInventory,\n                        backpack,\n                        setBackpack,\n                        resources,\n                        setResources,\n                        setErrorMessage: console.error,\n                        currentPlayer,\n                        setCurrentPlayer,\n                        gridId,\n                        updateStatus,\n                      });\n                    }\n                  }}\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet) && !townBuildingLimitReached) ? handleGemPurchase : null}\n                  meetsLevelRequirement={meetsLevel}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  devOnly={item.requires === 'devonly'}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>   \n    </Panel>\n  );\n};\n\nexport default React.memo(BuildPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect, useMemo } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails, hasRequiredSkill as checkRequiredSkill, isVisibleToPlayer } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/Panels/PanelContext';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\nimport { updatePlayerSettings } from '../../settings';\n\nconst BuyPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  NPCsInGrid,\n  globalTuning,\n  masterXPLevels,\n  cursorMode,\n  setCursorMode,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n  const [placeWithCursor, setPlaceWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n\n  // Toggle handler - persists to player settings\n  const handleToggleChange = (checked) => {\n    setPlaceWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings (uses same setting as farming panel)\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting an item for cursor mode\n  const handleCursorModeSelect = (item) => {\n    setCursorMode({\n      type: 'build',\n      item: item.type,\n      emoji: item.symbol || '',\n      range: item.range || 1,\n      buildOptions: buyOptions,\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Filter out devonly resources unless player is a developer\n            if (!isVisibleToPlayer(resource, isDeveloper)) return false;\n\n            // Check if resource is a buy item\n            if (resource.source !== 'Buy') return false;\n\n            // Check passability based on location\n            if (!isDeveloper && !isHomestead && resource.passable === false) return false;\n\n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n\n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  // Local wrapper for the utility function\n  const hasRequiredSkill = (requiredSkill) => checkRequiredSkill(requiredSkill, currentPlayer);\n\n  // Check if player meets the level requirement for a resource\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  // Count current farm animals on the grid\n  const countFarmAnimals = () => {\n    if (!NPCsInGrid?.[gridId]?.npcs) return 0;\n    return Object.values(NPCsInGrid[gridId].npcs).filter(npc => npc.action === 'graze').length;\n  };\n  \n  const maxFarmAnimals = globalTuning?.maxFarmAnimals || 10; // Default to 10 if not set\n  const currentFarmAnimals = countFarmAnimals();\n\n  return (\n    <Panel onClose={closePanel} descriptionKey=\"1003\" titleKey=\"1103\" panelName=\"BuyPanel\">\n      <div className=\"standard-panel\">\n        {/* Place with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n          gap: '8px',\n          marginBottom: '10px',\n          padding: '5px 0'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Place with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={placeWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const meetsSkillRequirement = hasRequiredSkill(item.requires);\n              const meetsLevel = meetsLevelRequirement(item.level);\n              const requirementsMet = meetsSkillRequirement && meetsLevel;\n\n              // Check if this is a farm animal and if we've hit the limit\n              const isFarmAnimal = item.passable && item.action === 'graze';\n              const farmAnimalLimitReached = isFarmAnimal && currentFarmAnimals >= maxFarmAnimals;\n              const isDisabled = !affordable || !requirementsMet || farmAnimalLimitReached;\n              const isSelectedForCursor = cursorMode?.type === 'build' && cursorMode?.item === item.type;\n\n              // Build className based on state\n              let buttonClassName = '';\n              if (isSelectedForCursor) buttonClassName += 'cursor-selected ';\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(bpItem => bpItem.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = meetsSkillRequirement ? 'green' : 'red';\n              const levelColor = meetsLevel ? 'green' : 'red';\n              const details =\n                (farmAnimalLimitReached ? `<span style=\"color: red;\">${strings[407]} (${maxFarmAnimals})</span>` : '') +\n                (item.level ? `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${item.level}</span>` : '') +\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              // Create info tooltip content\n              const info = (\n                <div className=\"info-content\">\n                  <div>{strings[820]}{item.output ? `${allResources.find(r => r.type === item.output)?.symbol || ''} ${getLocalizedString(item.output, strings)}` : 'Nothing'}</div>\n                  <div>{strings[821]}{item.qtycollected || 1}</div>\n                </div>\n              );\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  info={info}\n                  disabled={isDisabled}\n                  className={buttonClassName}\n                  onClick={() => {\n                    if (isDisabled) return;\n                    if (placeWithCursor) {\n                      // In cursor mode: select this item for placing via clicks\n                      handleCursorModeSelect(item);\n                    } else {\n                      // Normal mode: buy at player position immediately\n                      handleConstruction({\n                        TILE_SIZE,\n                        selectedItem: item.type,\n                        buildOptions: buyOptions,\n                        inventory,\n                        setInventory,\n                        backpack,\n                        setBackpack,\n                        resources,\n                        setResources,\n                        setErrorMessage: console.error,\n                        currentPlayer,\n                        setCurrentPlayer,\n                        gridId,\n                        updateStatus,\n                      });\n                    }\n                  }}\n                  onGemPurchase={(item.gemcost && (!affordable || !requirementsMet) && !farmAnimalLimitReached) ? handleGemPurchase : null}\n                  meetsLevelRequirement={meetsLevel}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  devOnly={item.requires === 'devonly'}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(BuyPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails, hasRequiredSkill as checkRequiredSkill, isVisibleToPlayer } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/Panels/PanelContext';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { updatePlayerSettings } from '../../settings';\n\nconst PetsPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory, \n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, \n  masterSkills, \n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  cursorMode,\n  setCursorMode,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n  const [placeWithCursor, setPlaceWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n\n  // Toggle handler - persists to player settings\n  const handleToggleChange = (checked) => {\n    setPlaceWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings (uses same setting as farming panel)\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting an item for cursor mode\n  const handleCursorModeSelect = (item) => {\n    setCursorMode({\n      type: 'build',\n      item: item.type,\n      emoji: item.symbol || '',\n      range: item.range || 1,\n      buildOptions: buyOptions,\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Filter out devonly resources unless player is a developer\n            if (!isVisibleToPlayer(resource, isDeveloper)) return false;\n\n            // Check if resource is a buy item\n            if (resource.source !== 'Zoo') return false;\n\n            // Check passability based on location\n            if (!isDeveloper && !isHomestead) return false;\n\n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n\n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  // Local wrapper for the utility function\n  const hasRequiredSkill = (requiredSkill) => checkRequiredSkill(requiredSkill, currentPlayer);\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  return (\n    <Panel onClose={closePanel} descriptionKey=\"1039\" titleKey=\"1139\" panelName=\"PetsPanel\">\n      <div className=\"standard-panel\">\n        {/* Place with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n          gap: '8px',\n          marginBottom: '10px',\n          padding: '5px 0'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Place with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={placeWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              const isDisabled = !affordable || !requirementsMet;\n              const isSelectedForCursor = cursorMode?.type === 'build' && cursorMode?.item === item.type;\n\n              // Build className based on state\n              let buttonClassName = '';\n              if (isSelectedForCursor) buttonClassName += 'cursor-selected ';\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  hideInfo={true}\n                  disabled={isDisabled}\n                  className={buttonClassName}\n                  onClick={() => {\n                    if (isDisabled) return;\n                    if (placeWithCursor) {\n                      // In cursor mode: select this item for placing via clicks\n                      handleCursorModeSelect(item);\n                    } else {\n                      // Normal mode: place at player position immediately\n                      handleConstruction({\n                        TILE_SIZE,\n                        selectedItem: item.type,\n                        buildOptions: buyOptions,\n                        inventory,\n                        setInventory,\n                        backpack,\n                        setBackpack,\n                        resources,\n                        setResources,\n                        setErrorMessage: console.error,\n                        currentPlayer,\n                        setCurrentPlayer,\n                        gridId,\n                        updateStatus,\n                      });\n                    }\n                  }}\n                  onGemPurchase={(item.gemcost && isDisabled) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  devOnly={item.requires === 'devonly'}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(PetsPanel);","import API_BASE from '../../config'; \nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { handleConstruction, handleConstructionWithGems } from '../BuildAndBuy';\nimport { getIngredientDetails, hasRequiredSkill as checkRequiredSkill, isVisibleToPlayer } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { usePanelContext } from '../../UI/Panels/PanelContext';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { updatePlayerSettings } from '../../settings';\n\nconst BuyDecoPanel = ({\n  TILE_SIZE,\n  resources,\n  setResources,\n  inventory,\n  setInventory, \n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources, \n  masterSkills, \n  updateStatus,\n  isDeveloper,\n  currentSeason,\n  cursorMode,\n  setCursorMode,\n}) => {\n  const { closePanel } = usePanelContext();\n  const [buyOptions, setBuyOptions] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const strings = useStrings();\n  const [placeWithCursor, setPlaceWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n\n  // Toggle handler - persists to player settings\n  const handleToggleChange = (checked) => {\n    setPlaceWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings (uses same setting as farming panel)\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting an item for cursor mode\n  const handleCursorModeSelect = (item) => {\n    setCursorMode({\n      type: 'build',\n      item: item.type,\n      emoji: item.symbol || '',\n      range: item.range || 1,\n      buildOptions: buyOptions,\n    });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n//      setIsContentLoading(true);\n      try { \n        const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(inventoryResponse.data.inventory || []);\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        const allResourcesData = resourcesResponse.data;\n        setAllResources(allResourcesData);\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const purchasableItems = allResourcesData.filter(\n          (resource) => {\n            // Filter out devonly resources unless player is a developer\n            if (!isVisibleToPlayer(resource, isDeveloper)) return false;\n\n            // Check if resource is a deco item\n            if (resource.source !== 'Deco') return false;\n\n            // Check passability based on location\n            if (!isDeveloper && !isHomestead && resource.passable === false) return false;\n\n            // Check seasonal restriction\n            if (resource.season && currentSeason && resource.season !== currentSeason) {\n              return false;\n            }\n\n            return true;\n          }\n        );\n        setBuyOptions(purchasableItems);\n      } catch (error) {\n        console.error('Error fetching buy panel data:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    }; \n\n    fetchData();\n  }, [currentPlayer]);\n\n  // Local wrapper for the utility function\n  const hasRequiredSkill = (requiredSkill) => checkRequiredSkill(requiredSkill, currentPlayer);\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handleConstructionWithGems({\n      TILE_SIZE,\n      selectedItem: modifiedRecipe.type,\n      buildOptions: buyOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      modifiedRecipe, // Pass the gem-modified recipe\n    });\n  };\n\n  return (\n    <Panel onClose={closePanel} descriptionKey=\"1031\" titleKey=\"1131\" panelName=\"BuyDecoPanel\">\n      <div className=\"standard-panel\">\n        {/* Place with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n          gap: '8px',\n          marginBottom: '10px',\n          padding: '5px 0'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Place with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={placeWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {buyOptions.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              const isDisabled = !affordable || !requirementsMet;\n              const isSelectedForCursor = cursorMode?.type === 'build' && cursorMode?.item === item.type;\n\n              // Build className based on state\n              let buttonClassName = '';\n              if (isSelectedForCursor) buttonClassName += 'cursor-selected ';\n\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={item.symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  details={details}\n                  disabled={isDisabled}\n                  className={buttonClassName}\n                  onClick={() => {\n                    if (isDisabled) return;\n                    if (placeWithCursor) {\n                      // In cursor mode: select this item for placing via clicks\n                      handleCursorModeSelect(item);\n                    } else {\n                      // Normal mode: place at player position immediately\n                      handleConstruction({\n                        TILE_SIZE,\n                        selectedItem: item.type,\n                        buildOptions: buyOptions,\n                        inventory,\n                        setInventory,\n                        backpack,\n                        setBackpack,\n                        resources,\n                        setResources,\n                        setErrorMessage: console.error,\n                        currentPlayer,\n                        setCurrentPlayer,\n                        gridId,\n                        updateStatus,\n                      });\n                    }\n                  }}\n                  gemCost={item.gemcost || null}\n                  onGemPurchase={(item.gemcost && isDisabled) ? handleGemPurchase : null}\n                  resource={item}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  devOnly={item.requires === 'devonly'}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(BuyDecoPanel);","// Shared function to format countdown timers consistently across the app\n//  Ensures endTime is a valid Date object before doing calculations.\nexport const formatCountdown = (endTime, now) => {\n    if (!endTime || endTime <= now) return \"0s\"; \n  \n    const timeDiff = endTime - now;\n    const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);\n  \n    // Build the string dynamically, only showing non-zero values\n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`); // Always show seconds if nothing else\n    \n    return parts.join(' ');\n};\n\n// Shared function to format static durations (e.g., \"Time needed: X\")\n// Only shows non-zero time units, stopping at the smallest non-zero unit\nexport const formatDuration = (seconds) => {\n    if (!seconds || seconds <= 0) return \"0s\";\n    \n    const days = Math.floor(seconds / 86400);\n    const hours = Math.floor((seconds % 86400) / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = Math.floor(seconds % 60);\n    \n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (secs > 0 || parts.length === 0) parts.push(`${secs}s`); // Always show seconds if nothing else\n    \n    // For static durations, only show the first 2 most significant units\n    // e.g., \"2d 16h\" instead of \"2d 16h 0m 0s\"\n    return parts.slice(0, 2).join(' ');\n}; ","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { getIngredientDetails, hasRequiredSkill as checkRequiredSkill, isVisibleToPlayer } from '../../Utils/ResourceHelpers';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { handleFarmPlotPlacement } from './Farming';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { formatDuration } from '../../UI/Timers';\nimport { updatePlayerSettings } from '../../settings';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\n\nconst FarmingPanel = ({\n  onClose,\n  TILE_SIZE,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  tiles,\n  tileTypes,\n  setTileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources,\n  masterSkills,\n  updateStatus,\n  currentSeason,\n  isDeveloper,\n  cursorMode,\n  setCursorMode\n}) => {\n\n  const strings = useStrings();\n  const [farmPlots, setFarmPlots] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const [plantWithCursor, setPlantWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n  const COOLDOWN_DURATION = 450;\n\n  // Toggle handler - persists to player settings\n  const handleToggleChange = (checked) => {\n    setPlantWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting a crop for cursor mode\n  const handleCursorModeSelect = (item) => {\n    // Find the output crop symbol (what grows from this plot)\n    const outputCrop = allResources.find((res) => res.source === item.type);\n    const outputSymbol = outputCrop?.symbol || item.symbol || '';\n\n    setCursorMode({\n      type: 'plant',\n      item: item,\n      emoji: outputSymbol\n    });\n  };\n\n \n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    //setIsContentLoading(true);\n    try {\n      const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(inventoryResponse.data.inventory || []);\n\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      const allResourcesData = resourcesResponse.data;\n      setAllResources(allResourcesData);\n\n      const farmPlotItems = allResourcesData.filter((resource) => {\n        // Check if resource is a farm plot\n        if (resource.category !== 'farmplot') return false;\n        // Filter out devonly resources unless player is a developer\n        if (!isVisibleToPlayer(resource, isDeveloper)) return false;\n        return true;\n      });\n      \n      // Add isOffSeason flag to each farmplot\n      const farmPlotsWithSeasonInfo = farmPlotItems.map(item => ({\n        ...item,\n        isOffSeason: item.season && currentSeason && item.season !== currentSeason\n      }));\n      \n      setFarmPlots(farmPlotsWithSeasonInfo);\n    } catch (error) {\n      console.error('Error fetching farming panel data:', error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  // Local wrapper for the utility function\n  const hasRequiredSkill = (requiredSkill) => checkRequiredSkill(requiredSkill, currentPlayer);\n\n\n  // Wrap for Farm Plot Placement\n  const handleFarmPlacementWithCooldown = async (item) => {\n    const itemKey = `plot-${item.type}`;\n    if (coolingDownItems.has(itemKey)) return;\n    \n    // Apply cooldown immediately for instant response\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n    \n    // Set timeout immediately (like Bank does) for proper sync\n    const cooldownTimer = setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n    \n    // Attempt the placement\n    const result = await handleFarmPlotPlacement({\n      selectedItem: item,\n      TILE_SIZE,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      gridId,\n      masterResources,\n      masterSkills,\n      updateStatus,\n    });\n    \n    // If placement failed, immediately remove cooldown and cancel timer\n    if (result !== true) {\n      clearTimeout(cooldownTimer);\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1004\" titleKey=\"1104\" panelName=\"FarmingPanel\">\n      <div className=\"standard-panel\">\n        {/* Plant with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          padding: '2px 12px',\n          marginBottom: '6px',\n          backgroundColor: 'var(--color-bg-tertiary)',\n          borderRadius: '8px'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Plant with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={plantWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n\n            {/* Farm Plot Options */}\n            {farmPlots.map((item) => {\n              const ingredients = getIngredientDetails(item, allResources);\n              const affordable = canAfford(item, inventory, backpack, 1);\n              const requirementsMet = hasRequiredSkill(item.requires);\n              const isOffSeason = item.isOffSeason;\n\n              const symbol = item.symbol || '';\n\n              // For off-season items, show simplified information\n              if (isOffSeason) {\n                return (\n                  <ResourceButton\n                    key={item.type}\n                    symbol={symbol}\n                    name={getLocalizedString(item.type, strings)}\n                    details=\"Off season\"\n                    info={null}\n                    disabled={true}\n                    onClick={() => {}}\n                  />\n                );\n              }\n\n              // Regular (in-season) item display\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = item[`ingredient${i}`];\n                const qty = item[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = requirementsMet ? 'green' : 'red';\n\n              const details =\n                (item.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(item.requires, strings)}</span><br>` : '') +\n                (item.growtime ? `${strings[458]}${formatDuration(item.growtime)}<br>` : '') +\n                `${strings[461]}<div>${formattedCosts}</div>`;\n\n              const info =\n                `${strings[820]}${\n                  allResources\n                    .filter((res) => res.source === item.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None'\n                }`;\n\n              const itemKey = `plot-${item.type}`;\n              const isCoolingDown = coolingDownItems.has(itemKey);\n              const isSelectedForCursor = cursorMode?.type === 'plant' && cursorMode?.item?.type === item.type;\n\n              // Build className based on state\n              let buttonClassName = '';\n              if (isCoolingDown) buttonClassName += 'cooldown ';\n              if (isSelectedForCursor) buttonClassName += 'cursor-selected ';\n\n              return (\n                <ResourceButton\n                  key={item.type}\n                  symbol={symbol}\n                  name={getLocalizedString(item.type, strings)}\n                  className={buttonClassName.trim()}\n                  style={isCoolingDown ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                  details={details}\n                  info={info}\n                  disabled={isCoolingDown || !affordable || !requirementsMet}\n                  onClick={() => {\n                    if (!affordable || !requirementsMet) return;\n                    if (plantWithCursor) {\n                      // In cursor mode: select this crop for planting via clicks\n                      handleCursorModeSelect(item);\n                    } else {\n                      // Normal mode: plant at player position immediately\n                      handleFarmPlacementWithCooldown(item);\n                    }\n                  }}\n                  devOnly={item.requires === 'devonly'}\n                />\n              );\n            })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}; \n\nexport default React.memo(FarmingPanel);","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { handleTerraform } from './Farming';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { updatePlayerSettings } from '../../settings';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\n\n// Default symbols for tiles that don't have one defined\nconst DEFAULT_TILE_SYMBOLS = {\n  'd': '',  // dirt\n  'g': '',  // grass\n  'p': '',  // pavement\n  's': '',  // slate/stone\n  'x': '',  // cobblestone\n  'w': '',  // water\n  'l': '',  // lava\n  'n': '',  // sand\n  'o': '',  // snow\n  'z': '',  // moss\n  'c': '',  // clay\n  'y': '',  // dungeon\n};\n\n// Info string keys for tiles (from strings file)\nconst TILE_INFO_KEYS = {\n  'd': 310,  // Till Land\n  'g': 311,  // Plant Grass\n  'p': 312,  // Lay Pavement\n  's': 312,  // Lay Stone\n  'x': 313,  // Lay Cobblestone\n};\n\nconst ToolsPanel = ({\n  onClose,\n  TILE_SIZE,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  resources,\n  setResources,\n  tiles,\n  tileTypes,\n  setTileTypes,\n  currentPlayer,\n  setCurrentPlayer,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterXPLevels,\n  updateStatus,\n  isDeveloper,\n  cursorMode,\n  setCursorMode\n}) => {\n\n  const strings = useStrings();\n  const [farmPlots, setFarmPlots] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [coolingDownItems, setCoolingDownItems] = useState(new Set());\n  const [useWithCursor, setUseWithCursor] = useState(\n    currentPlayer?.settings?.plantWithCursor ?? false\n  );\n  const COOLDOWN_DURATION = 500;\n\n  // Toggle handler - persists to player settings (shared with FarmingPanel)\n  const handleToggleChange = (checked) => {\n    setUseWithCursor(checked);\n    if (!checked) {\n      setCursorMode(null);\n    }\n    // Persist to player settings (uses same setting as FarmingPanel)\n    updatePlayerSettings({ plantWithCursor: checked }, currentPlayer, setCurrentPlayer);\n  };\n\n  // Handle selecting a terraform action for cursor mode\n  const handleCursorModeSelect = (tileType, emoji) => {\n    setCursorMode({\n      type: 'terraform',\n      tileType: tileType,\n      emoji: emoji\n    });\n  };\n\n \n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    //setIsContentLoading(true);\n    try {\n      const inventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(inventoryResponse.data.inventory || []);\n\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      const allResourcesData = resourcesResponse.data;\n      setAllResources(allResourcesData);\n\n      const farmPlotItems = allResourcesData.filter((resource) => resource.category === 'farmplot');\n      setFarmPlots(farmPlotItems);\n    } catch (error) {\n      console.error('Error fetching farming panel data:', error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  const hasRequiredSkill = (requiredSkill) => {\n    // devonly is handled separately, not as a skill check\n    if (requiredSkill === 'devonly') return true;\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n  // Check if player meets the level requirement\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n\n  // Wrap for Terraform Actions - now uses tileType directly\n  const handleTerraformWithCooldown = async (tileType) => {\n    const itemKey = `terraform-${tileType}`;\n    if (coolingDownItems.has(itemKey)) return;\n\n    // Apply cooldown immediately for instant response\n    setCoolingDownItems(prev => new Set(prev).add(itemKey));\n\n    // Set timeout immediately for proper sync with CSS animation\n    setTimeout(() => {\n      setCoolingDownItems(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemKey);\n        return newSet;\n      });\n    }, COOLDOWN_DURATION);\n\n    await handleTerraform({\n      TILE_SIZE,\n      tileType,\n      gridId,\n      currentPlayer,\n      tileTypes,\n      setTileTypes,\n      isDeveloper,\n    });\n  };\n\n\n  // Helper to build className for buttons\n  const getButtonClassName = (tileType) => {\n    const isCoolingDown = coolingDownItems.has(`terraform-${tileType}`);\n    const isSelectedForCursor = cursorMode?.type === 'terraform' && cursorMode?.tileType === tileType;\n    let className = '';\n    if (isCoolingDown) className += 'cooldown ';\n    if (isSelectedForCursor) className += 'cursor-selected ';\n    return className.trim();\n  };\n\n  // Helper to handle button clicks (cursor mode or direct action)\n  const handleButtonClick = (tileType, emoji, requiredSkill, level) => {\n    if (requiredSkill && requiredSkill !== 'devonly' && !hasRequiredSkill(requiredSkill)) return;\n    if (level && !meetsLevelRequirement(level)) return;\n    if (useWithCursor) {\n      handleCursorModeSelect(tileType, emoji);\n    } else {\n      handleTerraformWithCooldown(tileType);\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1033\" titleKey=\"1133\" panelName=\"ToolsPanel\">\n      <div className=\"standard-panel\">\n        {/* Terraform with cursor toggle */}\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          padding: '2px 12px',\n          marginBottom: '6px',\n          backgroundColor: 'var(--color-bg-tertiary)',\n          borderRadius: '8px'\n        }}>\n          <label style={{ fontFamily: 'var(--font-title-4-family)', fontSize: 'var(--font-title-4-size)', cursor: 'pointer' }}>\n            {strings[10187] || 'Use with cursor'}\n          </label>\n          <input\n            type=\"checkbox\"\n            checked={useWithCursor}\n            onChange={(e) => handleToggleChange(e.target.checked)}\n            style={{ width: '18px', height: '18px', cursor: 'pointer' }}\n          />\n        </div>\n\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {/* Dynamically render all tile tools from masterResources */}\n            {masterResources\n              ?.filter(r => r.category === 'tile')\n              .map((tileResource) => {\n                const tileType = tileResource.type;\n                const requiredSkill = tileResource.requires || null;\n                const requiredLevel = tileResource.level || null;\n\n                // Skip devonly tiles if not developer\n                if (requiredSkill === 'devonly' && !isDeveloper) {\n                  return null;\n                }\n\n                const meetsSkill = hasRequiredSkill(requiredSkill);\n                const meetsLevel = meetsLevelRequirement(requiredLevel);\n                const isCoolingDown = coolingDownItems.has(`terraform-${tileType}`);\n                const isDisabled = isCoolingDown || !meetsSkill || !meetsLevel;\n\n                // Get symbol - use from resource or fall back to defaults\n                const symbol = tileResource.symbol || DEFAULT_TILE_SYMBOLS[tileType] || '';\n\n                // Get display name from action field, capitalize first letter\n                const actionName = tileResource.action || tileType;\n                const displayName = actionName.charAt(0).toUpperCase() + actionName.slice(1);\n\n                // Build details string with level and skill requirements\n                const skillColor = meetsSkill ? 'green' : 'red';\n                const levelColor = meetsLevel ? 'green' : 'red';\n                let details = '';\n                if (requiredLevel) {\n                  details += `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${requiredLevel}</span>`;\n                }\n                if (requiredSkill && requiredSkill !== 'devonly') {\n                  details += `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(requiredSkill, strings)}</span>`;\n                }\n                if (requiredSkill === 'devonly') {\n                  details += `<span style=\"color: orange;\">Developer Only</span>`;\n                }\n                details += `${strings[461]} None`;\n\n                // Get info text from predefined keys or generate default\n                const infoKey = TILE_INFO_KEYS[tileType];\n                const infoText = infoKey ? strings[infoKey] : `Creates a ${displayName.toLowerCase()} tile`;\n\n                return (\n                  <ResourceButton\n                    key={tileType}\n                    symbol={symbol}\n                    name={getLocalizedString(displayName, strings)}\n                    className={getButtonClassName(tileType)}\n                    style={isCoolingDown ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                    details={details}\n                    disabled={isDisabled}\n                    info={infoText}\n                    onClick={() => handleButtonClick(tileType, symbol, requiredSkill, requiredLevel)}\n                    devOnly={requiredSkill === 'devonly'}\n                  />\n                );\n              })}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}; \n\nexport default React.memo(ToolsPanel);","import API_BASE from '../config';\nimport axios from 'axios';\nimport { createCollectEffect } from '../VFX/VFX';\nimport GlobalGridStateTilesAndResources from '../GridState/GlobalGridStateTilesAndResources';\nimport { updateGridResource } from './GridManagement';\nimport { checkDeveloperStatus } from './appUtils';\n\n// Generate unique transaction ID\nfunction generateTransactionId() {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Protected selling function for all panels\n// devOnly: if true, verifies developer status before proceeding\nexport async function handleProtectedSelling({\n  currentPlayer,\n  setInventory,\n  setBackpack,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  onClose,\n  devOnly = false\n}) {\n  // If devOnly is true, verify developer status before proceeding\n  if (devOnly) {\n    const isStillDeveloper = await checkDeveloperStatus(currentPlayer?.username);\n    if (!isStillDeveloper) {\n      updateStatus(' Developer access required.');\n      return { success: false, error: 'Developer access required' };\n    }\n  }\n  console.log(` [PROTECTED SELLING] Starting protected sale for ${stationType} at (${currentStationPosition.x}, ${currentStationPosition.y})`);\n  \n  // Debug: Check what resources exist at this position\n  const allResources = GlobalGridStateTilesAndResources.getResources();\n  const resourcesAtPosition = allResources.filter(res => {\n    // Check exact position\n    if (res.x === currentStationPosition.x && res.y === currentStationPosition.y) {\n      return true;\n    }\n    // Check if this position is covered by a multi-tile resource\n    const range = res.range || 1;\n    if (range > 1) {\n      return currentStationPosition.x >= res.x && currentStationPosition.x < res.x + range &&\n             currentStationPosition.y <= res.y && currentStationPosition.y > res.y - range;\n    }\n    return false;\n  });\n  \n  console.log(` Resources at/covering position (${currentStationPosition.x}, ${currentStationPosition.y}):`, resourcesAtPosition);\n  \n  // Generate  transaction ID and key\n  const transactionId = generateTransactionId();\n  const transactionKey = `sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`;\n  \n  try {\n    const response = await axios.post(`${API_BASE}/api/sell-for-refund`, {\n      playerId: currentPlayer.playerId,\n      gridId,\n      stationX: currentStationPosition.x,\n      stationY: currentStationPosition.y,\n      stationType,\n      transactionId,\n      transactionKey\n    });\n\n    if (response.data.success) {\n      const { refundIngredients, totalMoneyRefund, inventory, removedStation } = response.data;\n      \n      // Update inventory from server response\n      if (inventory) {\n        setInventory(inventory);\n        setCurrentPlayer(prev => ({ ...prev, inventory }));\n      }\n\n      // Find the resource to check if it has shadows\n      const soldResource = GlobalGridStateTilesAndResources.getResources().find(\n        (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n      );\n      \n      // Remove ONLY the main resource from DB (shadows only exist in local state)\n      await updateGridResource(gridId, {\n        x: currentStationPosition.x,\n        y: currentStationPosition.y,\n        type: null\n      }, true);\n      \n      console.log(` Removed main resource from database`);\n      \n      // Update local state to reflect removal of station and shadows\n      const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n        (res) => {\n          // Remove the sold station\n          if (res.x === currentStationPosition.x && res.y === currentStationPosition.y) return false;\n          \n          // Remove any shadows belonging to this station\n          if (soldResource && soldResource.range && soldResource.range > 1 && res.type === 'shadow') {\n            // Generate the anchorKey the same way we do when creating shadows\n            const anchorKey = soldResource.anchorKey || `${soldResource.type}-${soldResource.x}-${soldResource.y}`;\n            if (res.parentAnchorKey === anchorKey) {\n              return false;\n            }\n          }\n          return true;\n        }\n      );\n      GlobalGridStateTilesAndResources.setResources(filteredResources);\n      setResources(filteredResources);\n\n      // Visual feedback\n      createCollectEffect(currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n      \n      console.log(` Station ${stationType} sold successfully for ${totalMoneyRefund} Money.`);\n      updateStatus(`Sold ${stationType} for ${totalMoneyRefund} Money.`);\n      \n      // Close the panel\n      onClose();\n      \n      return { success: true, totalMoneyRefund };\n    }\n  } catch (error) {\n    console.error('Error in protected station selling:', error);\n    \n    if (error.response?.status === 429) {\n      updateStatus(471);\n    } else if (error.response?.status === 400) {\n      console.error(' 400 Error details:', error.response?.data);\n      updateStatus(` Cannot sell: ${error.response?.data?.error || 'Invalid request'}`);\n    } else {\n      updateStatus(' Failed to sell station');\n    }\n    \n    return { success: false, error: error.response?.data?.error || 'Unknown error' };\n  }\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { spendIngredients, gainIngredients, hasRoomFor } from '../../Utils/InventoryManagement';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\n\nconst SkillsPanel = ({\n    onClose,\n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer,\n    setCurrentPlayer,\n    stationType,\n    stationCategory,\n    currentStationPosition,\n    gridId,\n    isDeveloper,\n    TILE_SIZE,\n    updateStatus,\n    masterSkills,\n    setResources,\n    masterResources,\n    masterXPLevels,\n}) => {\n  const strings = useStrings();\n  const [entryPoint, setEntryPoint] = useState(stationType || \"Skills Panel\"); \n  const [allResources, setAllResources] = useState([]);\n  const [skillsToAcquire, setSkillsToAcquire] = useState([]);\n  const [ownedSkills, setOwnedSkills] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [stationEmoji, setStationEmoji] = useState(''); // Default emoji for Skills Panel\n\n  //  Update `entryPoint` when `stationType` changes\n  useEffect(() => {\n    if (!stationType) {\n      setEntryPoint(\"Basic Skills\"); //  Ensure default entry point when coming from the UI button\n      // NOTE: This \"Basic Skills\" string comes from resources.json\n    } else if (stationType !== entryPoint) {\n      setEntryPoint(stationType);\n    }\n  }, [stationType]);\n\n  //  Fetch resources when `entryPoint` changes\n  useEffect(() => {\n    const fetchResourcesAndInventory = async () => {\n      setIsContentLoading(true);\n      try {\n        console.log(\"Fetching skills and inventory for:\", entryPoint);\n        \n        const [inventoryResponse, skillsResponse, resourcesResponse] = await Promise.all([\n          axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`),\n          axios.get(`${API_BASE}/api/skills/${currentPlayer.playerId}`),\n          axios.get(`${API_BASE}/api/resources`),\n        ]);\n\n        const serverInventory = inventoryResponse.data.inventory || [];\n        const serverBackpack = inventoryResponse.data.backpack || [];\n        const serverSkills = skillsResponse.data.skills || [];\n        const allResourcesData = resourcesResponse.data;\n\n        setInventory(serverInventory);\n        setBackpack(serverBackpack);\n        setAllResources(allResourcesData);\n\n        const stationResource = allResourcesData.find((resource) => resource.type === stationType);\n        setStationEmoji(stationResource?.symbol || '');\n\n        //  Filter owned skills\n        const ownedSkills = serverSkills.filter(skill =>\n          allResourcesData.some(res => res.type === skill.type && res.category === 'skill')\n        );\n        setOwnedSkills(ownedSkills);\n\n        //  Filter available skills based on `entryPoint`\n        // For trainingAndShop stations, also include 'special' category items (like Tent, Boat)\n        // Include ALL skills from this station (owned ones will be shown differently)\n        const validCategories = stationCategory === 'trainingAndShop'\n          ? ['skill', 'special']\n          : ['skill'];\n        const availableSkills = allResourcesData.filter(\n          res => validCategories.includes(res.category) &&\n          res.source === entryPoint\n        );\n\n        setSkillsToAcquire(availableSkills);\n      } catch (error) {\n        console.error('Error fetching resources, inventory, or skills:', error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n\n    fetchResourcesAndInventory();\n  }, [entryPoint, currentPlayer?.playerId, stationCategory]); //  Re-fetch when `entryPoint`, player, or category changes\n\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill ||\n        ownedSkills.some((owned) => owned.type === requiredSkill);\n  };\n\n  // Check if player meets the level requirement for a resource\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n\nconst handleGemPurchase = async (modifiedRecipe) => {\n  // This is called by the gem button with a recipe modified to include gems\n  return handlePurchase(modifiedRecipe.type, modifiedRecipe);\n};\n\nconst handlePurchase = async (resourceType, customRecipe = null) => {\n  const resource = skillsToAcquire.find((item) => item.type === resourceType);\n  const recipeToUse = customRecipe || resource;\n\n  // Check if this is an item (special category) vs a skill\n  const isItem = resource.category === 'special';\n\n  // For items, check if there's room before spending money\n  if (isItem) {\n    const quantity = resource.qtycollected || 1;\n    const hasRoom = hasRoomFor({\n      resource: resource.type,\n      quantity: quantity,\n      currentPlayer,\n      inventory: inventory,\n      backpack: backpack,\n      masterResources: allResources,\n      globalTuning: null\n    });\n\n    if (!hasRoom) {\n      const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n      if (!isHomestead) {\n        const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n        if (!hasBackpackSkill) {\n          updateStatus(19); // Missing backpack\n        } else {\n          updateStatus(21); // Backpack full\n        }\n      } else {\n        updateStatus(20); // Warehouse full\n      }\n      return;\n    }\n  }\n\n  const spendSuccess = await spendIngredients({\n    playerId: currentPlayer.playerId,\n    recipe: recipeToUse,\n    inventory,\n    backpack,\n    setInventory,\n    setBackpack,\n    setCurrentPlayer,\n    updateStatus,\n  });\n\n  if (!spendSuccess) {\n    console.warn('Failed to spend ingredients.');\n    return;\n  }\n\n  if (isItem) {\n    // Handle as an item - add to inventory\n    const gainSuccess = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: resource.type,\n      quantity: resource.qtycollected || 1,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources: allResources,\n      globalTuning: null,\n    });\n\n    if (!gainSuccess) {\n      console.warn(`Failed to gain ${resource.type}`);\n      return;\n    }\n\n    await trackQuestProgress(currentPlayer, 'Buy', resource.type, 1, setCurrentPlayer);\n    updateStatus(`${strings[80]} ${getLocalizedString(resource.type, strings)}.`);\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n  } else {\n    // Handle as a skill\n    const updatedSkills = [...ownedSkills];\n    // Add the new skill\n    updatedSkills.push({ type: resource.type, category: resource.category, quantity: 1 });\n    setOwnedSkills(updatedSkills);\n    updateStatus(` ${getLocalizedString(resource.type, strings)} skill acquired.`);\n\n    try {\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId: currentPlayer.playerId,\n        skills: updatedSkills,\n      });\n      await trackQuestProgress(currentPlayer, 'Acquire', resource.type, 1, setCurrentPlayer);\n      await earnTrophy(currentPlayer.playerId, 'Skill Builder', 1, currentPlayer, null, setCurrentPlayer);\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      // Instead of re-fetching, update the acquire list locally\n      setSkillsToAcquire(prev => prev.filter(skill => skill.type !== resource.type));\n\n    } catch (error) {\n      console.error('Error updating player on server:', error);\n      setErrorMessage('Error updating player on server.');\n    }\n  }\n};\n\n  const handleSellStation = async () => {\n    try {\n      const success = await handleProtectedSelling({\n        currentPlayer,\n        stationType,\n        currentStationPosition,\n        gridId,\n        setResources,\n        setInventory,\n        setCurrentPlayer,\n        updateStatus,\n        onClose,\n        devOnly: true,\n      });\n\n      if (success) {\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error selling station:', error);\n      updateStatus('Failed to sell station');\n    }\n  };\n\n  // Handler for removing training buildings (no refund)\n  const handleRemoveTrainingBuilding = async () => {\n    try {\n      // Find the resource to check if it has shadows (for multi-tile resources)\n      const soldResource = GlobalGridStateTilesAndResources.getResources().find(\n        (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n      );\n\n      // Remove the resource from database\n      await updateGridResource(gridId, {\n        x: currentStationPosition.x,\n        y: currentStationPosition.y,\n        type: null\n      }, true);\n\n      // Update local state to reflect removal of station and shadows\n      const filteredResources = GlobalGridStateTilesAndResources.getResources().filter(\n        (res) => {\n          // Remove the station\n          if (res.x === currentStationPosition.x && res.y === currentStationPosition.y) return false;\n\n          // Remove any shadows belonging to this station\n          if (soldResource && soldResource.range && soldResource.range > 1 && res.type === 'shadow') {\n            const anchorKey = soldResource.anchorKey || `${soldResource.type}-${soldResource.x}-${soldResource.y}`;\n            if (res.parentAnchorKey === anchorKey) {\n              return false;\n            }\n          }\n          return true;\n        }\n      );\n      GlobalGridStateTilesAndResources.setResources(filteredResources);\n      setResources(filteredResources);\n\n      // Visual feedback\n      createCollectEffect(currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n\n      updateStatus(`${getLocalizedString(stationType, strings)} ${strings[438]?.toLowerCase() || 'removed'}.`);\n      onClose();\n    } catch (error) {\n      console.error('Error removing training building:', error);\n      updateStatus('Failed to remove training building');\n    }\n  };\n\n  // Check if we should show the sell button\n  const showSellButton = isDeveloper && entryPoint !== \"Basic Skills\" && currentStationPosition && gridId;\n\n  // Check if this is a training building (no refund, just remove)\n  const stationResource = allResources.find(r => r.type === stationType);\n  const isTrainingBuilding = stationResource?.category === 'training';\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1005\" title={`${stationEmoji} ${entryPoint}`} panelName=\"SkillsPanel\">\n      <div className=\"standard-panel\">\n            \n      {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            <div className=\"skills-to-acquire\">\n              <div className=\"skills-options\">\n                {skillsToAcquire.map((resource) => {\n                  // Check if this skill is already owned\n                  const isOwned = ownedSkills.some(owned => owned.type === resource.type);\n\n                  // Build info tooltip (used for both owned and unowned)\n                  const attributeModifier = resource.output\n                    ? `+${resource.qtycollected || 1} to ${strings[resource.output] || resource.output}`\n                    : null;\n\n                  let buffText = '';\n                  const buffedItems = masterSkills[resource.type];\n                  if (buffedItems && typeof buffedItems === 'object') {\n                    const items = Object.keys(buffedItems);\n                    if (items.length > 0) {\n                      const prettyList = items.join(', ');\n                      buffText = `Collection multiplied: ${prettyList}`;\n                    }\n                  }\n\n                  const unlocks = allResources\n                    .filter((res) => res.requires === resource.type)\n                    .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                    .join(', ') || 'None';\n\n                  const info = (\n                    <div className=\"info-content\">\n                      {attributeModifier && <div>{attributeModifier}</div>}\n                      {unlocks !== 'None' && (\n                        <div style={{ display: 'block', marginBottom: '3px' }}>\n                          <strong>Unlocks:</strong> {unlocks}\n                        </div>\n                      )}\n                      {buffText && <div style={{ color: 'blue' }}>{buffText}</div>}\n                    </div>\n                  );\n\n                  // If already owned, show as mini disabled button\n                  if (isOwned) {\n                    return (\n                      <ResourceButton\n                        key={resource.type}\n                        symbol={resource.symbol}\n                        name={getLocalizedString(resource.type, strings)}\n                        className=\"mini\"\n                        info={info}\n                        disabled={true}\n                        hideGem={true}\n                      />\n                    );\n                  }\n\n                  // Not owned - show full ResourceButton for purchase\n                  const affordable = canAfford(resource, inventory, backpack, 1);\n                  const meetsSkillRequirement = hasRequiredSkill(resource.requires);\n                  const meetsLevel = meetsLevelRequirement(resource.level);\n                  const requirementsMet = meetsSkillRequirement && meetsLevel;\n\n                  const formattedCosts = [1, 2, 3, 4].map((i) => {\n                    const type = resource[`ingredient${i}`];\n                    const qty = resource[`ingredient${i}qty`];\n                    if (!type || !qty) return '';\n\n                    const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                    const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                    const playerQty = inventoryQty + backpackQty;\n                    const color = playerQty >= qty ? 'green' : 'red';\n                    const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                    return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n                  }).join('');\n\n                  const skillColor = meetsSkillRequirement ? 'green' : 'red';\n                  const levelColor = meetsLevel ? 'green' : 'red';\n                  const details =\n                    (resource.level ? `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${resource.level}</span>` : '') +\n                    (resource.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(resource.requires, strings)}</span>` : '') +\n                    `${strings[461]}<div>${formattedCosts}</div>`;\n\n                  return (\n                    <ResourceButton\n                      key={resource.type}\n                      symbol={resource.symbol}\n                      name={getLocalizedString(resource.type, strings)}\n                      details={details}\n                      info={info}\n                      disabled={!affordable || !requirementsMet}\n                      onClick={() => handlePurchase(resource.type)}\n                      // Don't pass gemCost - let ResourceButton calculate it based on missing ingredients\n                      onGemPurchase={(resource.gemcost && (!affordable || !requirementsMet)) ? handleGemPurchase : null}\n                      meetsLevelRequirement={meetsLevel}\n                      resource={resource}\n                      inventory={inventory}\n                      backpack={backpack}\n                      masterResources={masterResources || allResources}\n                      currentPlayer={currentPlayer}\n                      devOnly={resource.requires === 'devonly'}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n\n          <h3>{strings[10175]}</h3>\n\n            {(entryPoint === \"Basic Skills\") && (\n              <div className=\"skills-owned\">\n                <br></br>\n                <h2>{strings[1303]}</h2>\n                {ownedSkills.length > 0 ? (\n                  ownedSkills.map((skill) => {\n                    // Look up full resource data for this skill\n                    const resource = allResources.find(r => r.type === skill.type);\n                    if (!resource) return null;\n\n                    // Build info tooltip (same logic as skills to acquire)\n                    const attributeModifier = resource.output\n                      ? `+${resource.qtycollected || 1} to ${strings[resource.output] || resource.output}`\n                      : null;\n\n                    let buffText = '';\n                    const buffedItems = masterSkills[resource.type];\n                    if (buffedItems && typeof buffedItems === 'object') {\n                      const items = Object.keys(buffedItems);\n                      if (items.length > 0) {\n                        const prettyList = items.join(', ');\n                        buffText = `Collection multiplied: ${prettyList}`;\n                      }\n                    }\n\n                    const unlocks = allResources\n                      .filter((res) => res.requires === resource.type)\n                      .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                      .join(', ') || 'None';\n\n                    const info = (\n                      <div className=\"info-content\">\n                        {attributeModifier && <div>{attributeModifier}</div>}\n                        {unlocks !== 'None' && (\n                          <div style={{ display: 'block', marginBottom: '3px' }}>\n                            <strong>Unlocks:</strong> {unlocks}\n                          </div>\n                        )}\n                        {buffText && <div style={{ color: 'blue' }}>{buffText}</div>}\n                      </div>\n                    );\n\n                    return (\n                      <ResourceButton\n                        key={skill.type}\n                        symbol={resource.symbol}\n                        name={getLocalizedString(skill.type, strings)}\n                        className=\"mini\"\n                        info={info}\n                        disabled={true}\n                        hideGem={true}\n                      />\n                    );\n                  })\n                ) : (\n                  <p>{strings[1305]}</p>\n                )}\n              </div>\n            )}\n\n      {showSellButton && (\n        <div className=\"shared-buttons\">\n          <TransactionButton\n            className=\"btn-basic btn-danger\"\n            onAction={isTrainingBuilding ? handleRemoveTrainingBuilding : handleSellStation}\n            transactionKey={`${isTrainingBuilding ? 'remove' : 'sell-refund'}-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n          >\n            {isTrainingBuilding ? strings[438] : strings[490]}\n          </TransactionButton>\n        </div>\n      )}\n\n          </>\n        )}\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(SkillsPanel);","/**\n * Calculates settlement population by counting occupied homesteads\n * This is the unified method for determining settlement population across the application\n * @param {Object} settlementData - The settlement data object containing grids\n * @returns {number} The population count based on occupied homesteads\n */\nexport const calculateSettlementPopulation = (settlementData) => {\n  if (!settlementData || !settlementData.grids) {\n    console.warn('calculateSettlementPopulation: No settlement data or grids provided');\n    return 0;\n  }\n\n  const allGrids = settlementData.grids?.flat() || [];\n  const occupiedHomesteads = allGrids.filter(grid => \n    grid.gridType === \"homestead\" && grid.available === false\n  ).length || 0;\n  \n  return occupiedHomesteads;\n};","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport { getMayorUsername } from './GovUtils';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\n\nfunction GovPanel({ onClose, currentPlayer, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [settlementData, setSettlementData] = useState(null);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [taxRate, setTaxRate] = useState(0);\n  const [population, setPopulation] = useState(0);\n  const [taxLog, setTaxLog] = useState([]);\n  const [mayor, setMayor] = useState(\"\");\n  // Community Buildings counts\n  const resources = GlobalGridStateTilesAndResources.getResources() || [];\n  const buildingCounts = {\n      School: 0,\n      Hospital: 0,\n      Library: 0\n  };\n  resources.forEach(res => {\n      if (res.type === 'School') buildingCounts.School++;\n      if (res.type === 'Hospital') buildingCounts.Hospital++;\n      if (res.type === 'Library') buildingCounts.Library++;\n  });\n  \n  useEffect(() => {\n    const fetchGovernmentData = async () => {\n      setIsContentLoading(true);\n      if (!currentPlayer || !currentPlayer.settlementId) {\n        console.warn(\" currentPlayer or settlementId is not available yet.\");\n        return; \n      }\n  \n      try {\n        console.log(\" Fetching full settlement data for ID:\", currentPlayer.settlementId);\n        \n        const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n        const settlement = settlementResponse.data;\n        setSettlementData(settlement);\n        setTaxLog(settlement.taxlog || []);\n        setTaxRate(settlement.taxrate || 0);\n        \n        const population = calculateSettlementPopulation(settlement);\n        setPopulation(population);\n        \n        const mayorName = await getMayorUsername(currentPlayer.settlementId);\n        setMayor(mayorName);\n          \n      } catch (error) {\n        console.error(\" Error fetching government data:\", error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n  \n    fetchGovernmentData();\n  }, [currentPlayer]);\n\n  const handleShowTaxLog = async () => {\n    if (!currentPlayer?.settlementId) {\n      console.warn(\" Cannot show tax log: settlementId missing.\");\n      return;\n    }\n\n    console.log(\" Requesting tax log for settlement ID:\", currentPlayer.settlementId);\n \n    try {\n      const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/taxlog`);\n      console.log(\" Tax log response:\", response.data);\n      const taxlog = response.data.taxlog || [];\n\n      console.log(\" Parsed taxlog:\", taxlog);\n\n      const taxLogTable = (\n        <table className=\"tax-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5102\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5103\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5104\"]}</th>\n              <th style={{ padding: \"6px 12px\" }}>{strings[\"5105\"]}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...taxlog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.totalcollected}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.currentmayor}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.mayortake}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: strings[\"5100\"],\n        size: \"large\",\n        message: taxlog.length === 0\n          ? strings[\"5101\"]\n          : undefined,\n        custom: taxLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch tax log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load tax log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1007\" titleKey=\"1107\" panelName=\"GovPanel\">\n      <div className=\"standard-panel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n            {/* Settlement Information */}\n            {settlementData && (\n              <>\n                <h3><strong>{strings[\"3001\"]}</strong></h3>  \n                <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{settlementData.displayName || settlementData.name || 'Unnamed Settlement'}</strong></h2>\n                <h3>{strings[\"3002\"]} <strong>{population}</strong></h3>\n              </>\n            )}\n\n            {/* Taxes Section */}\n            <h3>{strings[\"3003\"]} {taxRate}%</h3>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-success\" onClick={handleShowTaxLog}>{strings[3020]}</button>            \n            </div>\n            <p>{strings[\"3004\"]}</p>\n            \n\n{/* CURRENT MAYOR section */}\n            <h3>{strings[2085]}</h3>\n            <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{mayor || \"Vacant\"}</strong></h2>\n\n            <p>{strings[\"3005\"]}</p>\n            <p>{strings[\"3009\"]}</p>\n            <p>{strings[\"3010\"]}</p>\n            <p>{strings[\"3011\"]}</p>\n            <p>{strings[\"3012\"]}</p>\n            <p>{strings[\"3013\"]}</p>\n\n            {/* COMMUNITY BUILDINGS section - only show in towns */}\n            {currentPlayer?.location?.gtype === 'town' && (\n              <>\n                <h3>{strings[\"2090\"]}</h3>\n                <p>{buildingCounts.School > 0 ? `${strings[\"2092\"]}${buildingCounts.School}` : strings[\"2093\"]}</p>\n                <p>{buildingCounts.Hospital > 0 ? `${strings[\"2094\"]}${buildingCounts.Hospital}` : strings[\"2095\"]}</p>\n                <p>{buildingCounts.Library > 0 ? `${strings[\"2098\"]}${buildingCounts.Library}` : strings[\"2099\"]}</p>\n              </>\n            )}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n}\n\nexport default GovPanel;","import React from 'react';\nimport { useStrings } from '../../UI/StringsContext';\n\n/**\n * HopeQuest Component\n *\n * A reusable component that displays the 7 boxes representing Oracle quest progress.\n * This component is pure/presentational - it does not make any API calls.\n *\n * @param {Array} inventory - Player's inventory items\n * @param {Array} backpack - Player's backpack items\n * @param {Array} masterResources - Master resources list (for symbols)\n * @param {Array} masterTraders - Master traders list (for Oracle recipe)\n * @param {boolean} showTitle - Whether to show the \"Hope Quest\" title (default: true)\n * @param {string} size - Size variant: 'normal' or 'small' (default: 'normal')\n */\nfunction HopeQuest({\n  inventory = [],\n  backpack = [],\n  masterResources = [],\n  masterTraders = [],\n  showTitle = true,\n  size = 'normal'\n}) {\n  const strings = useStrings();\n\n  // Dynamically load Oracle recipe items from masterTraders\n  const oracleRecipe = masterTraders?.find(trader => trader.trader === 'Oracle');\n  const oracleItems = [];\n\n  if (oracleRecipe) {\n    // Extract all requires fields from the Oracle recipe\n    for (let i = 1; i <= 7; i++) {\n      const requiresKey = `requires${i}`;\n      const qtyKey = `requires${i}qty`;\n      if (oracleRecipe[requiresKey]) {\n        oracleItems.push({\n          name: oracleRecipe[requiresKey],\n          qty: oracleRecipe[qtyKey] || 1\n        });\n      }\n    }\n  }\n\n  // Helper to check if player has enough of the item\n  const hasEnoughItems = (itemName, requiredQty) => {\n    const invItem = inventory?.find(item => item?.type === itemName);\n    const bpItem = backpack?.find(item => item?.type === itemName);\n\n    // Try both 'qty' and 'quantity' for both inventory and backpack\n    const invQty = invItem?.qty || invItem?.quantity || 0;\n    const bpQty = bpItem?.qty || bpItem?.quantity || 0;\n    const totalQty = invQty + bpQty;\n\n    return totalQty >= requiredQty;\n  };\n\n  // Helper to get resource symbol\n  const getSymbol = (itemName) => {\n    const resource = masterResources?.find(r => r.type === itemName);\n    return resource?.symbol || '?';\n  };\n\n  // Size-based styling\n  const fontSize = size === 'small' ? '14px' : '20px';\n  const gap = size === 'small' ? '2px' : '4px';\n  const marginBottom = size === 'small' ? '8px' : '16px';\n\n  return (\n    <>\n      {showTitle && (\n        <h2 style={{ textAlign: 'center', marginBottom: '10px' }}>\n          {strings[200801]}\n        </h2>\n      )}\n      <div style={{\n        display: 'flex',\n        justifyContent: 'space-between',\n        gap: gap,\n        marginBottom: marginBottom,\n        width: '100%'\n      }}>\n        {oracleItems.map((item, index) => {\n          const playerHasItem = hasEnoughItems(item.name, item.qty);\n          const symbol = getSymbol(item.name);\n\n          return (\n            <div key={index} style={{\n              flex: 1,\n              aspectRatio: '1',\n              borderRadius: '4px',\n              backgroundColor: playerHasItem ? 'var(--color-btn-primary)' : 'rgb(154, 106, 22)',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: fontSize\n            }}>\n              {playerHasItem ? symbol : ''}\n            </div>\n          );\n        })}\n      </div>\n    </>\n  );\n}\n\nexport default HopeQuest;\n","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport './Leaderboard.css';\nimport HopeQuest from '../Social/HopeQuest';\nimport { getDerivedLevel, getXpForNextLevel } from '../../Utils/playerManagement';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction LeaderboardPanel({ onClose, currentPlayer, setModalContent, setIsModalOpen, masterResources, masterTraders, masterXPLevels }) {\n  const strings = useStrings();\n  const [isLoading, setIsLoading] = useState(true);\n  const [leaderboardData, setLeaderboardData] = useState([]);\n\n  useEffect(() => {\n    const fetchLeaderboardData = async () => {\n      if (!currentPlayer || !currentPlayer.frontierId) {\n        console.warn(\"\u000f currentPlayer or frontierId is not available yet.\");\n        return;\n      }\n\n      setIsLoading(true);\n      try {\n        console.log(\" Fetching leaderboard data for frontier:\", currentPlayer.frontierId);\n\n        // Get summary player data\n        const response = await axios.get(`${API_BASE}/api/players-by-frontier-with-dev-status/${currentPlayer.frontierId}`);\n        const players = response.data;\n\n        // Sort players by net worth, excluding developers, and get top 10\n        const topPlayers = players\n          .filter(player => !player.isDeveloper)\n          .sort((a, b) => (b.netWorth || 0) - (a.netWorth || 0))\n          .slice(0, 10);\n\n        console.log(\" Top 10 players summary:\", topPlayers);\n\n        // Fetch full player data for each top player\n        const fullPlayerDataPromises = topPlayers.map(async (player) => {\n          try {\n            // Determine the correct ID field (could be playerId, _id, or id)\n            const playerId = player.playerId || player._id || player.id;\n            console.log(` Fetching full data for ${player.username} using ID:`, playerId);\n\n            if (!playerId) {\n              console.error(` No ID found for player ${player.username}:`, player);\n              throw new Error('No player ID found');\n            }\n\n            // Fetch full player data using playerId\n            const fullPlayerResponse = await axios.get(`${API_BASE}/api/player/${playerId}`);\n            const fullPlayer = fullPlayerResponse.data;\n            console.log(` Full data for ${player.username}:`, fullPlayer);\n\n            return {\n              username: fullPlayer.username || player.username,\n              icon: fullPlayer.icon || '',\n              netWorth: player.netWorth || 0,\n              xp: fullPlayer.xp || 0,\n              inventory: fullPlayer.inventory || [],\n              backpack: fullPlayer.backpack || []\n            };\n          } catch (error) {\n            console.error(` Error fetching full data for player ${player.username}:`, error);\n            // Return partial data if fetch fails\n            return {\n              username: player.username,\n              icon: '',\n              netWorth: player.netWorth || 0,\n              xp: 0,\n              inventory: [],\n              backpack: []\n            };\n          }\n        });\n\n        const sortedPlayers = await Promise.all(fullPlayerDataPromises);\n\n        setLeaderboardData(sortedPlayers);\n        setIsLoading(false);\n      } catch (error) {\n        console.error(\" Error fetching leaderboard data:\", error);\n        setIsLoading(false);\n      }\n    };\n\n    fetchLeaderboardData();\n  }, [currentPlayer]);\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1040\" titleKey=\"1140\" panelName=\"LeaderboardPanel\">\n      {isLoading ? (\n        <p>Loading leaderboard...</p>\n      ) : (\n        <>\n          <h2 className=\"leaderboard-title\">Top players by net worth:</h2>\n          {leaderboardData.length > 0 ? (\n            <div className=\"leaderboard-container\">\n              {leaderboardData.slice(0, 10).map((player, index) => {\n                const playerLevel = getDerivedLevel(player, masterXPLevels);\n                const xpForNextLevel = getXpForNextLevel(player, masterXPLevels);\n\n                // Calculate XP progress percentage (same logic as PlayerPanel)\n                // masterXPLevels is an array of XP thresholds: [40, 100, 180, ...]\n                const currentLevelIndex = playerLevel - 2; // Level 1 = no threshold, Level 2 = index 0\n                const currentLevelXP = currentLevelIndex >= 0 ? (masterXPLevels?.[currentLevelIndex] || 0) : 0;\n                const xpIntoLevel = player.xp - currentLevelXP;\n                const xpRangeForLevel = xpForNextLevel - currentLevelXP;\n                const xpProgress = xpRangeForLevel <= 0 ? 100 : Math.min(100, Math.max(0, (xpIntoLevel / xpRangeForLevel) * 100));\n\n                return (\n                  <div key={index} className=\"player-card\">\n                    <div className=\"player-header\">\n                      <div className=\"player-rank\">\n                        #{index + 1}\n                      </div>\n                      <div className=\"player-info\">\n                        {player.icon} <strong>{player.username}</strong>\n                      </div>\n                    </div>\n                    <div className=\"player-networth\">\n                       {player.netWorth.toLocaleString()}\n                    </div>\n\n                    {/* Level Display */}\n                    <div className=\"player-stats\">\n                      {strings[10150]} {playerLevel}\n                    </div>\n\n                    {/* XP Display */}\n                    <div className=\"player-stats\">\n                      {strings[10151]} {player.xp} / {xpForNextLevel}\n                    </div>\n\n                    {/* XP Progress Bar */}\n                    <div className=\"xp-bar-container\">\n                      <div className=\"xp-bar-fill\" style={{\n                        width: `${xpProgress}%`\n                      }}>\n                      </div>\n                    </div>\n\n                    <HopeQuest\n                      inventory={player.inventory}\n                      backpack={player.backpack}\n                      masterResources={masterResources}\n                      masterTraders={masterTraders}\n                      showTitle={false}\n                      size=\"small\"\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          ) : (\n            <p>No leaderboard data available.</p>\n          )}\n        </>\n      )}\n    </Panel>\n  );\n}\n\nexport default LeaderboardPanel;\n","import React from 'react';\nimport { useStrings } from '../StringsContext';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\nimport './LevelLock.css';\n\n/**\n * LevelLock Component\n *\n * A reusable component that checks if a player meets a level requirement.\n * If not met, displays a locked message. If met, renders children.\n *\n * Usage:\n *   <LevelLock\n *     currentPlayer={currentPlayer}\n *     masterXPLevels={masterXPLevels}\n *     requiredLevel={9}\n *     featureName=\"Train\"\n *   >\n *     <YourPanelContent />\n *   </LevelLock>\n *\n * @param {Object} currentPlayer - The player object with xp field\n * @param {Array} masterXPLevels - Array of XP thresholds for each level\n * @param {number} requiredLevel - The minimum level required to access the content\n * @param {React.ReactNode} children - Content to render if level requirement is met\n * @param {string} featureName - Name of the feature being locked (e.g., \"Train\", \"Windmill\")\n */\nconst LevelLock = ({\n  currentPlayer,\n  masterXPLevels,\n  requiredLevel,\n  children,\n  featureName\n}) => {\n  const strings = useStrings();\n\n  // Calculate player's current level\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n\n  // Check if player meets the level requirement\n  const meetsRequirement = playerLevel >= requiredLevel;\n\n  if (meetsRequirement) {\n    return <>{children}</>;\n  }\n\n  // Render locked state\n  // String 814: \"The {feature} unlocks at level {level}.\"\n  // String 815: \"Your current level: {level}\"\n  return (\n    <div className=\"level-lock-container\">\n      <div className=\"level-lock-icon\"></div>\n      <div className=\"level-lock-message\">\n        {(strings[814] || 'The {feature} unlocks at level {level}.')\n          .replace('{feature}', featureName || 'feature')\n          .replace('{level}', requiredLevel)}\n      </div>\n      <div className=\"level-lock-current\">\n        {(strings[815] || 'Your current level: {level}').replace('{level}', playerLevel)}\n      </div>\n    </div>\n  );\n};\n\nexport default LevelLock;\n","import API_BASE from '../../config.js';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport LevelLock from '../../UI/Panels/LevelLock';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport { formatCountdown } from '../../UI/Timers.js';\nimport { useStrings } from '../../UI/StringsContext';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport '../../UI/Buttons/SharedButtons.css';\n\nfunction BankPanel({\n    onClose,\n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    masterXPLevels,\n    globalTuning,\n    setResources,\n    currentStationPosition,\n    gridId,\n    TILE_SIZE,\n    isDeveloper })\n{\n    const strings = useStrings();\n\n    // Get Bank level requirement from masterResources\n    const bankResource = masterResources?.find(r => r.type === 'Bank');\n    const bankRequiredLevel = bankResource?.level || 1;\n\n    const [isContentLoading, setIsContentLoading] = useState(false);\n    const [bankOffers, setBankOffers] = useState([]);\n    const [bankTimer, setBankTimer] = useState(\"\");\n    const [bankPhase, setBankPhase] = useState(\"\");\n    const [coolingDownButtons, setCoolingDownButtons] = useState(new Set());\n    const COOLDOWN_DURATION = 1500; // 3x longer for bank transactions\n\n    // Fetch data - separated from timer logic\n    const fetchBankOffers = async () => {\n       setIsContentLoading(true);\n       try {\n            const response = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n            setBankOffers(response.data.bank?.offers || []);\n            setBankPhase(response.data.bank?.phase || \"\");\n        } catch (error) {\n            console.error(' Error fetching bank offers:', error);\n        } finally {\n            setIsContentLoading(false);\n        }\n    };\n\n    // Timer + Phase Change Detection\n    useEffect(() => {\n        const updateCountdown = () => {\n            const now = Date.now();\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            const bankTimerData = storedTimers.bank || {};\n            \n            // Check for phase change\n            if (bankTimerData.phase !== bankPhase) {\n                console.log(\" Bank phase changed, fetching new data...\");\n                fetchBankOffers();\n            }\n            \n            setBankTimer(formatCountdown(bankTimerData.endTime, now));\n        };\n\n        updateCountdown();\n        const interval = setInterval(updateCountdown, 1000);\n        return () => clearInterval(interval);\n    }, [bankPhase, currentPlayer?.frontierId]);\n\n    // Initial load\n    useEffect(() => {\n        if (currentPlayer?.frontierId) {\n            fetchBankOffers();\n        }\n    }, [currentPlayer?.frontierId]);\n\n    //  Handle trade transaction\n    const handleTrade = async (offer) => {\n        if (!offer || !currentPlayer) return;\n\n        // Spend ingredients\n        const success = await spendIngredients({\n          playerId: currentPlayer.playerId,\n          recipe: {\n            ingredient1: offer.itemBought,\n            ingredient1qty: offer.qtyBought,\n          },\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n        });\n\n        if (!success) return;\n\n        // Gain the given item (usually Money)\n        const gainSuccess = await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: offer.itemGiven,\n          quantity: offer.qtyGiven,\n          inventory,\n          backpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n\n        if (!gainSuccess) return;\n\n        await trackQuestProgress(currentPlayer,'Sell',offer.itemBought,offer.qtyBought,setCurrentPlayer);\n\n        updateStatus(` Exchanged ${offer.qtyBought} ${offer.itemBought} for ${offer.qtyGiven} ${offer.itemGiven}.`);\n    };\n\n    // Wrap handleTrade with cooldown to prevent spam clicking\n    const handleTradeWithCooldown = async (offer, buttonIndex) => {\n        if (coolingDownButtons.has(buttonIndex)) return;\n        \n        console.log(`Starting cooldown for button ${buttonIndex}, duration: ${COOLDOWN_DURATION}ms (${COOLDOWN_DURATION / 1000}s)`);\n        \n        // Add this button to cooling down set\n        setCoolingDownButtons(prev => new Set(prev).add(buttonIndex));\n        \n        setTimeout(() => {\n            console.log(`Ending cooldown for button ${buttonIndex}`);\n            // Remove this button from cooling down set\n            setCoolingDownButtons(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(buttonIndex);\n                return newSet;\n            });\n        }, COOLDOWN_DURATION);\n\n        await handleTrade(offer);\n    };\n\n    //  Lookup function for symbols from `masterResources`\n    const getSymbol = (resourceType) => {\n        const resource = masterResources.find(res => res.type === resourceType);\n        return resource?.symbol || \"\"; // Default to question mark if no symbol found\n    };\n\n    const handleSellStation = async (transactionId, transactionKey) => {\n        await handleProtectedSelling({\n            currentPlayer,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            setResources,\n            stationType: 'Bank',\n            currentStationPosition,\n            gridId,\n            TILE_SIZE,\n            updateStatus,\n            onClose,\n            devOnly: true,\n        });\n    };\n\n    return (\n      <Panel onClose={onClose} descriptionKey=\"1017\" titleKey=\"1117\" panelName=\"BankPanel\">\n        <LevelLock\n          currentPlayer={currentPlayer}\n          masterXPLevels={masterXPLevels}\n          requiredLevel={bankRequiredLevel}\n          featureName=\"Bank\"\n        >\n          {/* Check if player is in their home settlement */}\n          {(() => {\n            const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n            console.log(' Bank access check:', {\n              currentSettlement: currentPlayer.location.s,\n              homeSettlement: currentPlayer.settlementId,\n              isInHomeSettlement\n            });\n            return !isInHomeSettlement;\n          })() ? (\n            <div style={{ textAlign: 'center', padding: '20px' }}>\n              <h2>{strings[2050] || \"This is not your home settlement. You cannot access banking services in any settlement but your own.\"}</h2>\n            </div>\n          ) : isContentLoading ? (\n            <p>{strings[98]}</p>\n          ) : (\n            <>\n              {/* Active phase showing current offers */}\n              {bankPhase === \"active\" ? (\n                <>\n                  <h3>{strings[\"1402\"]}</h3> {/* \"These offers good for\" */}\n                  <h2 className=\"countdown-timer\">{bankTimer}</h2>\n                  {bankOffers.length > 0 ? (\n                    bankOffers.map((offer, index) => {\n                      // Calculate player's total quantity from inventory and backpack\n                      const inventoryQty = inventory?.find(item => item.type === offer.itemBought)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === offer.itemBought)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n\n                      return (\n                        <ResourceButton\n                          key={index}\n                          className={coolingDownButtons.has(index) ? 'cooldown' : ''}\n                          style={coolingDownButtons.has(index) ? { '--cooldown-duration': `${COOLDOWN_DURATION / 1000}s` } : {}}\n                          onClick={() => handleTradeWithCooldown(offer, index)}\n                          disabled={coolingDownButtons.has(index) || !canAfford({\n                            ingredient1: offer.itemBought,\n                            ingredient1qty: offer.qtyBought\n                          }, inventory, backpack, 1)}\n                          hideInfo={true}\n                        >\n                          <div className=\"resource-details\">\n                            <span><strong>{strings[\"1403\"]}</strong></span> {/* \"Will buy\" */}\n                            {getSymbol(offer.itemBought)} {offer.itemBought} x{offer.qtyBought} / {playerQty}\n                            <br />\n                            {strings[\"1404\"]} {getSymbol(offer.itemGiven)} {offer.qtyGiven} {/* \"for\" */}\n                          </div>\n                        </ResourceButton>\n                      );\n                    })\n                  ) : (\n                    <p>{strings[\"1405\"]}</p>\n                  )}\n                </>\n              ) : (\n                <>\n                  <h3>{strings[\"1406\"]}</h3> {/* \"New offers\" */}\n                  <h3>{bankTimer}</h3>\n                  <p>{strings[\"1407\"]}</p> {/* \"Generating new orders. Thank you for your patience.\" */}\n                </>\n              )}\n            </>\n          )}\n\n          {isDeveloper && (\n            <div className=\"station-panel-footer\">\n              <div className=\"shared-buttons\">\n                <TransactionButton\n                  className=\"btn-basic btn-danger\"\n                  onAction={handleSellStation}\n                  transactionKey={`sell-refund-Bank-${currentStationPosition?.x}-${currentStationPosition?.y}-${gridId}`}\n                >\n                  {strings[425] || \"Sell for Refund\"}\n                </TransactionButton>\n              </div>\n            </div>\n          )}\n        </LevelLock>\n      </Panel>\n    );\n}\n\nexport default BankPanel;","import { isACrop } from '../../Utils/ResourceHelpers';\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\n\n/**\n * Generates new Kent offers based on player skills and available resources\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @param {Array} masterXPLevels - Array of XP thresholds for level calculation\n * @returns {Array} Array of new Kent offers\n */\nexport function generateNewKentOffers(currentPlayer, masterResources, globalTuning, currentSeason, masterXPLevels) {\n    const playerSkills = currentPlayer?.skills || [];\n    const playerSkillTypes = playerSkills.map(skill => skill.type);\n    const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n\n    console.log(' Kent offer generation:', {\n        isFirstTimeUser: currentPlayer?.firsttimeuser,\n        playerSkills: playerSkillTypes,\n        playerLevel: playerLevel\n    });\n    \n    // Filter eligible resources for Kent offers\n    const eligibleResources = masterResources.filter(resource => {\n        // Must be a doober\n        if (resource.category !== 'doober') return false;\n        \n        // Exclude resources with noBank output\n        if (resource.output === 'noBank') return false;\n        \n        // Check if player has required skills\n        if (resource.requires && !playerSkillTypes.includes(resource.requires)) {\n            return false;\n        }\n        \n        // Check if resource is seasonal and matches current season\n        if (resource.season && resource.season !== currentSeason) {\n            return false;\n        }\n        \n        // Check if any ingredients are out of season\n        const ingredients = [\n            resource.ingredient1,\n            resource.ingredient2, \n            resource.ingredient3,\n            resource.ingredient4\n        ].filter(Boolean);\n        \n        for (const ingredient of ingredients) {\n            const ingredientResource = masterResources.find(r => r.type === ingredient);\n            if (ingredientResource && ingredientResource.season && ingredientResource.season !== currentSeason) {\n                return false;\n            }\n        }\n        \n        // === FIRST-TIME USER ONLY FILTERS ===\n        // If player is first time user, only show crops\n        if (currentPlayer?.firsttimeuser === true) {\n            if (!isACrop(resource.type, masterResources)) {\n                return false;\n            }\n        }\n        \n        // === FILTERS FOR ALL USERS (including first-time users) ===\n        // Filter out epic and legendary scroll chance items\n        if (resource.scrollchance === 'epic' || resource.scrollchance === 'legendary') {\n            return false;\n        }\n        \n        // Filter out valley source items\n        if (resource.source === 'valley') {\n            return false;\n        }\n        \n        // Filter out resources where the source requires skills the player doesn't have\n        const sourceResource = masterResources.find(r => r.type === resource.source);\n        \n        console.log(` Checking ${resource.type} (source: ${resource.source}):`, {\n            foundSourceResource: !!sourceResource,\n            sourceType: sourceResource?.type,\n            sourceRequires: sourceResource?.requires,\n            playerSkills: playerSkillTypes,\n            hasRequiredSkill: sourceResource?.requires ? playerSkillTypes.includes(sourceResource.requires) : 'N/A',\n            shouldFilter: sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)\n        });\n        \n        // If source resource exists and requires a skill the player doesn't have, exclude\n        if (sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)) {\n            console.log(` Filtering out ${resource.type} - source ${resource.source} requires ${sourceResource.requires} skill`);\n            return false;\n        }\n        \n        // Filter out resources that are outputs of attack resources if player doesn't have \"Explore the Valley\" trophy\n        const hasExploreValleyTrophy = currentPlayer?.trophies?.some(trophy => trophy.title === \"Explore the Valley\");\n        if (!hasExploreValleyTrophy) {\n            const attackResource = masterResources.find(r =>\n                r.action === 'attack' && r.output === resource.type\n            );\n\n            if (attackResource) {\n                console.log(` Filtering out ${resource.type} - output of attack resource ${attackResource.type}, player lacks \"Explore the Valley\" trophy`);\n                return false;\n            }\n        }\n\n        // Filter out resources where resource.level is above the player's level\n        if (resource.level && resource.level > playerLevel) {\n            return false;\n        }\n\n        return true;\n    });\n    \n    if (eligibleResources.length === 0) {\n        console.warn('No eligible resources found for Kent offers');\n        return [];\n    }\n    \n    const newOffers = [];\n    const maxOffers = globalTuning?.maxKentOffers || 6;\n    const currentOfferCount = currentPlayer?.kentOffers?.offers?.length || 0;\n    \n    // Determine how many new offers to generate\n    let offersToGenerate = 2; // Default to 2\n    if (currentOfferCount + 2 > maxOffers) {\n        offersToGenerate = Math.max(0, maxOffers - currentOfferCount);\n    }\n    \n    // For players under level 10, ensure half the offers are crops\n    const requireCropBalance = playerLevel < 10;\n    const cropOffersNeeded = requireCropBalance ? Math.ceil(offersToGenerate / 2) : 0;\n    let cropOffersGenerated = 0;\n\n    for (let i = 0; i < offersToGenerate; i++) {\n        // Get all existing Kent offers to check for duplicates\n        const allExistingOffers = [...(currentPlayer?.kentOffers?.offers || []), ...newOffers];\n\n        // Count how many offers already exist for each resource type\n        const resourceCounts = {};\n        allExistingOffers.forEach(offer => {\n            resourceCounts[offer.item] = (resourceCounts[offer.item] || 0) + 1;\n        });\n\n        // Filter out resources that already have 2 or more offers\n        let availableResources = eligibleResources.filter(resource =>\n            (resourceCounts[resource.type] || 0) < 2\n        );\n\n        // If player is under level 10, enforce crop balance\n        if (requireCropBalance) {\n            const remainingOffers = offersToGenerate - i;\n            const cropOffersStillNeeded = cropOffersNeeded - cropOffersGenerated;\n\n            // If we still need crop offers and this is one of the slots for crops, filter to crops only\n            if (cropOffersStillNeeded > 0 && cropOffersStillNeeded >= remainingOffers - (remainingOffers - cropOffersStillNeeded)) {\n                const cropResources = availableResources.filter(r => isACrop(r.type, masterResources));\n                if (cropResources.length > 0) {\n                    availableResources = cropResources;\n                }\n            }\n        }\n\n        // If no resources available (all have 2+ offers), break out of loop\n        if (availableResources.length === 0) {\n            console.log(' No more unique resources available (all have 2+ offers)');\n            break;\n        }\n\n        const randomResource = availableResources[Math.floor(Math.random() * availableResources.length)];\n\n        // Track crop offers generated\n        if (isACrop(randomResource.type, masterResources)) {\n            cropOffersGenerated++;\n        }\n        \n        // Determine quantity based on crop status and first-time user status\n        let quantity;\n        if (isACrop(randomResource.type, masterResources)) {\n            if (currentPlayer?.firsttimeuser === true) {\n                quantity = Math.floor(Math.random() * 9) + 4; // Random from 4 to 12 for first-time users\n            } else {\n                quantity = Math.floor(Math.random() * 37) + 4; // Random from 4 to 40 for regular users\n            }\n        } else {\n            quantity = Math.floor(Math.random() * 10) + 1; // Random from 1 to 10\n        }\n        \n        // Calculate primary reward (Money = maxprice * quantity)\n        const rewardAmount = (randomResource.maxprice || 100) * quantity;\n        \n        const rewards = [\n            {\n                item: 'Money',\n                quantity: rewardAmount\n            }\n        ];\n\n        // Check for bonus valley resource reward (same method as warehouse ingredients)\n        const dropRate = globalTuning?.harvestDropRate || 0.1; // Use same drop rate as warehouse ingredients\n        const bonusRoll = Math.random();\n        \n        console.log(` Kent bonus reward check for ${randomResource.type}:`);\n        console.log(`   globalTuning.harvestDropRate: ${globalTuning?.harvestDropRate}`);\n        console.log(`   Resolved drop rate: ${dropRate} (${(dropRate * 100).toFixed(1)}%)`);\n        console.log(`   Roll: ${bonusRoll.toFixed(3)}`);\n        console.log(`   Success: ${bonusRoll <= dropRate ? 'YES' : 'NO'}`);\n        \n        if (bonusRoll <= dropRate) {\n            console.log(` Kent bonus reward roll succeeded!`);\n            \n            // Get all valley resources from masterResources\n            const valleyResources = masterResources.filter(res => res.source === 'valley' && res.scrollchance);\n            \n            console.log(`   Found ${valleyResources.length} valley resources with scrollchance:`);\n            valleyResources.forEach(res => {\n                console.log(`     - ${res.type} (${res.scrollchance})`);\n            });\n            \n            if (valleyResources.length > 0) {\n                // Use weighted random selection based on scrollchance rarity\n                const selectedValleyResource = selectWeightedRandomItem(valleyResources, 1);\n                \n                console.log(`   Selected valley resource: ${selectedValleyResource?.type || 'NONE'}`);\n                \n                if (selectedValleyResource) {\n                    // Valley resources drop 1-3 quantity based on rarity\n                    let bonusQuantity = 1;\n                    switch(selectedValleyResource.scrollchance) {\n                        case 'legendary':\n                        case 'epic':\n                            bonusQuantity = 1;\n                            break;\n                        case 'rare':\n                            bonusQuantity = Math.floor(Math.random() * 2) + 1; // 1-2\n                            break;\n                        case 'uncommon':\n                        case 'common':\n                        default:\n                            bonusQuantity = Math.floor(Math.random() * 3) + 1; // 1-3\n                            break;\n                    }\n                    \n                    rewards.push({\n                        item: selectedValleyResource.type,\n                        quantity: bonusQuantity\n                    });\n                    \n                    console.log(` ADDED valley bonus reward: ${selectedValleyResource.type} x${bonusQuantity} (${selectedValleyResource.scrollchance})`);\n                } else {\n                    console.log(` selectWeightedRandomItem returned null`);\n                }\n            } else {\n                console.log(` No valley resources found with scrollchance`);\n            }\n        } else {\n            console.log(` Kent bonus reward roll failed: ${bonusRoll.toFixed(3)} > ${dropRate}`);\n        }\n        \n        const newOffer = {\n            item: randomResource.type,\n            quantity: quantity,\n            rewards: rewards\n        };\n        \n        newOffers.push(newOffer);\n    }\n    \n    console.log(`Generated ${newOffers.length} new Kent offers:`, newOffers);\n    return newOffers;\n}\n\n/**\n * Removes a completed offer from the player's Kent offers and returns the position\n * @param {Object} kentOffers - Current kentOffers object\n * @param {Object} completedOffer - The offer that was just completed\n * @returns {Object} { kentOffers: updated kentOffers object, removedIndex: position of removed offer }\n */\nexport function removeCompletedOffer(kentOffers, completedOffer) {\n    if (!kentOffers || !kentOffers.offers) {\n        return { kentOffers, removedIndex: -1 };\n    }\n    \n    // Find the index of the completed offer\n    const removedIndex = kentOffers.offers.findIndex(offer => \n        offer.item === completedOffer.itemBought && \n        offer.quantity === completedOffer.qtyBought\n    );\n    \n    // Remove the completed offer\n    const updatedOffers = kentOffers.offers.filter((offer, index) => index !== removedIndex);\n    \n    return {\n        kentOffers: {\n            ...kentOffers,\n            offers: updatedOffers\n        },\n        removedIndex\n    };\n}\n\n/**\n * Updates Kent offers after a trade: removes completed offer and adds new ones\n * @param {Object} currentPlayer - The current player object\n * @param {Object} completedOffer - The offer that was just completed\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @param {Array} masterXPLevels - Array of XP thresholds for level calculation\n * @returns {Object} Updated kentOffers object\n */\nexport function updateKentOffersAfterTrade(currentPlayer, completedOffer, masterResources, globalTuning, currentSeason, masterXPLevels) {\n    // Remove the completed offer and get its position\n    const { kentOffers: kentOffersWithoutCompleted, removedIndex } = removeCompletedOffer(currentPlayer.kentOffers, completedOffer);\n\n    // Generate new offers (limit to 1 to replace the removed offer)\n    const newOffers = generateNewKentOffers(\n        { ...currentPlayer, kentOffers: kentOffersWithoutCompleted },\n        masterResources,\n        globalTuning,\n        currentSeason,\n        masterXPLevels\n    );\n    \n    // Insert the new offer at the same position as the removed one\n    const updatedOffers = [...kentOffersWithoutCompleted.offers];\n    \n    if (newOffers.length > 0 && removedIndex >= 0) {\n        // Insert the first new offer at the exact position of the removed offer\n        updatedOffers.splice(removedIndex, 0, newOffers[0]);\n        \n        // Add any additional new offers at the end\n        if (newOffers.length > 1) {\n            updatedOffers.push(...newOffers.slice(1));\n        }\n    } else if (newOffers.length > 0) {\n        // If we couldn't find the position, just add at the end\n        updatedOffers.push(...newOffers);\n    }\n    \n    return {\n        ...kentOffersWithoutCompleted,\n        offers: updatedOffers\n    };\n}","import API_BASE from '../../config.js';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { updateKentOffersAfterTrade, generateNewKentOffers } from './KentOfferLogic';\nimport { tryAdvanceFTUEByTrigger } from '../FTUE/FTUEutils';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport './Kent.css'; // Kent-specific styles\nimport { formatCountdown } from '../../UI/Timers.js';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\n\nfunction KentPanel({\n    onClose,\n    inventory,\n    setInventory,\n    backpack,\n    setBackpack,\n    currentPlayer,\n    setCurrentPlayer,\n    updateStatus,\n    masterResources,\n    globalTuning,\n    currentSeason,\n    masterXPLevels }) \n{\n    const strings = useStrings();\n    const [isContentLoading, setIsContentLoading] = useState(false);\n    const [kentOffers, setKentOffers] = useState([]);\n    const [kentTimer, setKentTimer] = useState(\"\");\n    const [kentPhase, setKentPhase] = useState(\"\");\n    const [isTrading, setIsTrading] = useState(false); \n\n    // Generate fallback Kent offer and save to DB\n    const generateFallbackKentOffer = async () => {\n        try {\n            // Find Wheat's maxprice from masterResources\n            const wheatResource = masterResources.find(res => res.type === 'Wheat');\n            const wheatMaxPrice = wheatResource?.maxprice || 100; // fallback to 100 if not found\n            \n            const fallbackKentOffers = {\n                endTime: 0, // Available immediately\n                offers: [{\n                    item: 'Wheat',\n                    quantity: 4,\n                    rewards: [{\n                        item: 'Money',\n                        quantity: wheatMaxPrice * 4\n                    }]\n                }]\n            };\n            \n            // Save to player's kentOffers in DB\n            const response = await axios.post(`${API_BASE}/api/update-profile`, {\n                playerId: currentPlayer.playerId,\n                updates: { kentOffers: fallbackKentOffers }\n            });\n\n            if (response.data.success) {\n                console.log(' Generated fallback Kent offers:', fallbackKentOffers);\n                // Update parent currentPlayer state so canvas can see the new offers\n                setCurrentPlayer(prev => ({\n                    ...prev,\n                    kentOffers: fallbackKentOffers\n                }));\n                return fallbackKentOffers;\n            }\n        } catch (error) {\n            console.error(' Error generating fallback Kent offer:', error);\n        }\n        return { endTime: 0, offers: [] };\n    };\n\n    // Fetch Kent offers from player data\n    const fetchKentOffers = async () => {\n        setIsContentLoading(true);\n        try {\n            // Get Kent offers from currentPlayer data\n            const kentData = currentPlayer?.kentOffers;\n            \n            // If no kentOffers exist or offers array is empty, generate fallback\n            if (!kentData || !kentData.offers || kentData.offers.length === 0) {\n                console.log(' No Kent offers found, generating fallback...');\n                const fallbackKentOffers = await generateFallbackKentOffer();\n                setKentOffers(fallbackKentOffers.offers || []);\n            } else {\n                setKentOffers(kentData.offers || []);\n            }\n            \n            setKentPhase('active'); // Kent is always active\n        } catch (error) {\n            console.error(' Error fetching Kent offers:', error);\n        } finally {\n            setIsContentLoading(false);\n        }\n    };\n\n    // Kent timer logic\n    useEffect(() => {\n        const updateKentTimer = () => {\n            const now = Date.now();\n            const kentData = currentPlayer?.kentOffers;\n            const endTime = kentData?.endTime || 0;\n\n            if (endTime > now) {\n                // Timer is active - panel locked\n                setKentTimer(formatCountdown(endTime, now));\n                setKentPhase('locked');\n            } else {\n                // Timer expired - offers available\n                setKentTimer(strings[45]);\n                setKentPhase('active');\n            }\n        };\n\n        updateKentTimer();\n        const interval = setInterval(updateKentTimer, 1000);\n        return () => clearInterval(interval);\n    }, [currentPlayer?.kentOffers?.endTime]);\n\n    // Initial load\n    useEffect(() => {\n        if (currentPlayer?.playerId) {\n            fetchKentOffers();\n        }\n    }, [currentPlayer?.playerId]);\n\n    //  Handle trade transaction with protection against spam clicking\n    const handleTrade = async (offer) => {\n        if (!offer || !currentPlayer || isTrading) return;\n        \n        //  EXPLOIT FIX: Check Kent timer before allowing any trade\n        if (isKentOnCooldown()) {\n            console.log(' Kent trade blocked: Timer still active');\n            updateStatus(' Kent is not available yet. Please wait for the timer to expire.');\n            return;\n        }\n        \n        // Set trading flag to prevent spam clicks\n        setIsTrading(true);\n        \n        try {\n\n            // Spend ingredients\n            const success = await spendIngredients({\n              playerId: currentPlayer.playerId,\n              recipe: {\n                ingredient1: offer.itemBought,\n                ingredient1qty: offer.qtyBought,\n              },\n              inventory,\n              backpack,\n              setInventory,\n              setBackpack,\n              setCurrentPlayer,\n              updateStatus,\n            });\n\n            if (!success) return;\n\n            // Gain all rewards\n            let allRewardsSuccess = true;\n            const originalOffer = kentOffers.find(kentOffer => \n              kentOffer.item === offer.itemBought && kentOffer.quantity === offer.qtyBought\n            );\n            \n            if (originalOffer && originalOffer.rewards) {\n              for (const reward of originalOffer.rewards) {\n                const gainSuccess = await gainIngredients({\n                  playerId: currentPlayer.playerId,\n                  currentPlayer,\n                  resource: reward.item,\n                  quantity: reward.quantity,\n                  inventory,\n                  backpack,\n                  setInventory,\n                  setBackpack,\n                  setCurrentPlayer,\n                  updateStatus,\n                  masterResources,\n                  globalTuning,\n                });\n                \n                if (!gainSuccess) {\n                  allRewardsSuccess = false;\n                  break;\n                }\n              }\n            } else {\n              // Fallback to old single reward system\n              const gainSuccess = await gainIngredients({\n                playerId: currentPlayer.playerId,\n                currentPlayer,\n                resource: offer.itemGiven,\n                quantity: offer.qtyGiven,\n                inventory,\n                backpack,\n                setInventory,\n                setBackpack,\n                setCurrentPlayer,\n                updateStatus,\n                masterResources,\n                globalTuning,\n              });\n              allRewardsSuccess = gainSuccess;\n            }\n\n            if (!allRewardsSuccess) return;\n\n            // Award XP for the trade\n            const xpToAward = calculateKentXP(originalOffer);\n            try {\n              const xpResponse = await axios.post(`${API_BASE}/api/addXP`, {\n                playerId: currentPlayer.playerId,\n                xpAmount: xpToAward\n              });\n              \n              if (xpResponse.data.success) {\n                // Update current player's XP locally\n                setCurrentPlayer(prev => ({\n                  ...prev,\n                  xp: xpResponse.data.newXP\n                }));\n              }\n            } catch (error) {\n              console.error(' Error awarding XP for Kent trade:', error);\n              // Don't fail the trade if XP award fails, just log it\n            }\n\n            // Create status message for multiple rewards\n            const rewardText = originalOffer && originalOffer.rewards \n              ? originalOffer.rewards.map(reward => `${reward.quantity} ${reward.item}`).join(', ')\n              : `${offer.qtyGiven} ${offer.itemGiven}`;\n\n            await refreshOffersAndSetTimer(offer, ` Exchanged ${offer.qtyBought} ${offer.itemBought} for ${rewardText} and +${xpToAward} XP.`);\n            await trackQuestProgress(currentPlayer,'Sell',offer.itemBought,offer.qtyBought,setCurrentPlayer);\n\n            // Try to advance FTUE if this is the player's first sale to Kent\n            await tryAdvanceFTUEByTrigger('SoldToKent', currentPlayer.playerId, currentPlayer, setCurrentPlayer);\n\n        } catch (error) {\n            console.error(' Error in Kent trade:', error);\n            updateStatus(' Trade failed. Please try again.');\n        } finally {\n            // Always clear the trading flag\n            setIsTrading(false);\n        }\n    };\n\n    //  Handle dismissing an offer without trading\n    const handleDismiss = async (offer) => {\n        if (!offer || !currentPlayer || isTrading) return;\n\n        //  EXPLOIT FIX: Check Kent timer before allowing any dismiss\n        if (isKentOnCooldown()) {\n            console.log(' Kent dismiss blocked: Timer still active');\n            updateStatus(' Kent is not available yet. Please wait for the timer to expire.');\n            return;\n        }\n\n        // Set trading flag to prevent spam clicks\n        setIsTrading(true);\n\n        try {\n            await refreshOffersAndSetTimer(offer, ` Dismissed offer for ${offer.itemBought}.`);\n        } catch (error) {\n            console.error(' Error dismissing Kent offer:', error);\n            updateStatus(' Failed to dismiss offer. Please try again.');\n        } finally {\n            // Always clear the trading flag\n            setIsTrading(false);\n        }\n    };\n\n    //  Handle dismissing all offers at once\n    const handleDismissAll = async () => {\n        if (!currentPlayer || isTrading || kentOffers.length === 0) return;\n\n        // Check Kent timer before allowing dismiss\n        if (isKentOnCooldown()) {\n            console.log(' Kent dismiss all blocked: Timer still active');\n            updateStatus(' Kent is not available yet. Please wait for the timer to expire.');\n            return;\n        }\n\n        setIsTrading(true);\n\n        try {\n            // Reset Kent timer\n            const kentRefreshSeconds = globalTuning?.kentRefreshTimerSeconds || 5;\n            const newEndTime = Date.now() + (kentRefreshSeconds * 1000);\n\n            // Generate completely new offers (pass empty kentOffers to generate fresh set)\n            const playerWithEmptyOffers = { ...currentPlayer, kentOffers: { offers: [] } };\n            const newOffers = generateNewKentOffers(\n                playerWithEmptyOffers,\n                masterResources,\n                globalTuning,\n                currentSeason,\n                masterXPLevels\n            );\n\n            const updatedKentOffers = {\n                endTime: newEndTime,\n                offers: newOffers\n            };\n\n            // Update player's kentOffers\n            const updateResponse = await axios.post(`${API_BASE}/api/update-profile`, {\n                playerId: currentPlayer.playerId,\n                updates: { kentOffers: updatedKentOffers }\n            });\n\n            if (updateResponse.data.success) {\n                setCurrentPlayer(prev => ({\n                    ...prev,\n                    kentOffers: updatedKentOffers\n                }));\n                setKentOffers(updatedKentOffers.offers || []);\n            }\n\n            updateStatus(` Dismissed all offers.`);\n        } catch (error) {\n            console.error(' Error dismissing all Kent offers:', error);\n            updateStatus(' Failed to dismiss offers. Please try again.');\n        } finally {\n            setIsTrading(false);\n        }\n    };\n\n    //  Shared function to refresh offers and set timer\n    const refreshOffersAndSetTimer = async (offer, statusMessage) => {\n        // Reset Kent timer and update offers\n        const kentRefreshSeconds = globalTuning?.kentRefreshTimerSeconds || 5;\n        const newEndTime = Date.now() + (kentRefreshSeconds * 1000);\n        \n        // Update Kent offers: remove completed offer and add new ones\n        const updatedKentOffers = updateKentOffersAfterTrade(\n            currentPlayer,\n            offer,\n            masterResources,\n            globalTuning,\n            currentSeason,\n            masterXPLevels\n        );\n        \n        // Set the new timer\n        updatedKentOffers.endTime = newEndTime;\n        \n        // Update player's kentOffers with new timer\n        const updateResponse = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { kentOffers: updatedKentOffers }\n        });\n        \n        if (updateResponse.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n                ...prev,\n                kentOffers: updatedKentOffers\n            }));\n            \n            // Update local kentOffers display\n            setKentOffers(updatedKentOffers.offers || []);\n        }\n\n        updateStatus(statusMessage);\n    };\n\n\n    //  Helper function to check if Kent is currently on cooldown\n    const isKentOnCooldown = () => {\n        const now = Date.now();\n        const kentData = currentPlayer?.kentOffers;\n        const endTime = kentData?.endTime || 0;\n        return endTime > now;\n    };\n\n    //  Lookup function for symbols from `masterResources`\n    const getSymbol = (resourceType) => {\n        const resource = masterResources.find(res => res.type === resourceType);\n        return resource?.symbol || \"\"; // Default to question mark if no symbol found\n    };\n\n    // Calculate XP for Kent offer based on resource.xp value\n    const calculateKentXP = (offer) => {\n        // Find the resource being sold and get its XP value\n        const resource = masterResources.find(res => res.type === offer.item);\n        const baseXP = resource?.xp || 1; // Default to 1 XP if no xp value defined\n        return baseXP * 2; // 2x Kent multiplier\n    };\n\n    return (\n      <Panel onClose={onClose}  titleKey=\"1138\" panelName=\"KentPanel\">\n        {isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            {/* Show timer at top with fixed height */}\n            <div className=\"kent-header-area\">\n              {kentPhase === 'locked' ? (\n                <h2>{strings[46]} <span className=\"countdown-timer\">{kentTimer}</span></h2>\n              ) : (\n                <h2 className=\"countdown-timer\">{kentTimer}</h2>\n              )}\n            </div>\n            \n            {/* Always show offers, but disable during cooldown */}\n            <>\n              {kentOffers.length > 0 ? (\n                <>\n                  {kentOffers.map((offer, index) => {\n                      // Calculate player's total quantity from inventory and backpack\n                      const inventoryQty = inventory?.find(item => item.type === offer.item)?.quantity || 0;\n                      const backpackQty = backpack?.find(item => item.type === offer.item)?.quantity || 0;\n                      const playerQty = inventoryQty + backpackQty;\n\n                      // Convert Kent offer format to bank offer format for compatibility\n                      const convertedOffer = {\n                          itemBought: offer.item,\n                          qtyBought: offer.quantity,\n                          itemGiven: offer.rewards[0]?.item || 'Money',\n                          qtyGiven: offer.rewards[0]?.quantity || 0\n                      };\n\n                      // Check if Kent panel is locked (use both phase state and real-time check)\n                      const isLocked = kentPhase === 'locked' || isKentOnCooldown();\n\n                      return (\n                        <div key={index} className=\"kent-offer-wrapper\">\n                          <ResourceButton\n                            className={`kent-offer-button ${isLocked ? 'disabled' : ''}`}\n                            onClick={() => !isLocked && !isTrading && handleTrade(convertedOffer)}\n                            disabled={isLocked || isTrading || !canAfford({\n                              ingredient1: convertedOffer.itemBought,\n                              ingredient1qty: convertedOffer.qtyBought\n                            }, inventory, backpack, 1)}\n                            hideInfo={true}\n                          >\n                            <div className=\"resource-details\">\n                              <div className=\"kent-offer-content\">\n                                <div className=\"kent-offer-symbol\">\n                                  {getSymbol(convertedOffer.itemBought)}\n                                </div>\n                                <div className=\"kent-offer-details\">\n                                  <div className=\"kent-offer-requirement\">\n                                    <span className={`kent-offer-item ${playerQty < convertedOffer.qtyBought ? 'insufficient' : 'sufficient'}`}>\n                                      {getLocalizedString(convertedOffer.itemBought, strings)} x{convertedOffer.qtyBought} / {playerQty}\n                                    </span>\n                                  </div>\n                                  <div className=\"kent-offer-reward\">\n                                    {strings[42]} {offer.rewards.map((reward, rewardIndex) =>\n                                      `${getSymbol(reward.item)} ${reward.quantity.toLocaleString()}${rewardIndex < offer.rewards.length - 1 ? ', ' : ''}`\n                                    ).join('')},  {calculateKentXP(offer)}\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </ResourceButton>\n                          <div\n                            className={`kent-dismiss-button ${isLocked || isTrading ? 'disabled' : ''}`}\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              if (!isLocked && !isTrading) {\n                                handleDismiss(convertedOffer);\n                              }\n                            }}\n                          >\n                            \n                          </div>\n                        </div>\n                      );\n                  })}\n                  {/* Dismiss all link */}\n                  <div\n                    className={`kent-dismiss-all-link ${(kentPhase === 'locked' || isKentOnCooldown() || isTrading) ? 'disabled' : ''}`}\n                    onClick={() => {\n                      if (!(kentPhase === 'locked' || isKentOnCooldown() || isTrading)) {\n                        handleDismissAll();\n                      }\n                    }}\n                  >\n                    {strings[190] || \"Dismiss all\"}\n                  </div>\n                </>\n              ) : (\n                <p>No offers available from Kent.</p>\n              )}\n            </>\n          </>\n        )}\n      </Panel>\n    );\n}\n\nexport default KentPanel;","import { isACrop } from '../../Utils/ResourceHelpers';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\n\n/**\n * Generates new Train offers based on player skills and available resources\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @param {Array} masterXPLevels - Array of XP thresholds for level calculation\n * @returns {Array} Array of new Train offers\n */\nexport function generateNewTrainOffers(currentPlayer, masterResources, globalTuning, currentSeason, masterXPLevels) {\n    const playerSkills = currentPlayer?.skills || [];\n    const playerSkillTypes = playerSkills.map(skill => skill.type);\n    const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n\n    console.log(' Train offer generation:', {\n        isFirstTimeUser: currentPlayer?.firsttimeuser,\n        playerSkills: playerSkillTypes,\n        playerLevel: playerLevel\n    });\n    \n    // Filter eligible resources for Train offers\n    const eligibleResources = masterResources.filter(resource => {\n        // Must be a doober\n        if (resource.category !== 'doober') return false;\n        \n        // Exclude resources with noBank output\n        if (resource.output === 'noBank') return false;\n        \n        // Exclude resources that don't have a source defined (player cannot create them)\n        if (!resource.source) return false;\n        \n        // Check if player has required skills\n        if (resource.requires && !playerSkillTypes.includes(resource.requires)) {\n            return false;\n        }\n        \n        // Check if resource is seasonal and matches current season\n        if (resource.season && resource.season !== currentSeason) {\n            return false;\n        }\n        \n        // Check if any ingredients are out of season\n        const ingredients = [\n            resource.ingredient1,\n            resource.ingredient2, \n            resource.ingredient3,\n            resource.ingredient4\n        ].filter(Boolean);\n        \n        for (const ingredient of ingredients) {\n            const ingredientResource = masterResources.find(r => r.type === ingredient);\n            if (ingredientResource && ingredientResource.season && ingredientResource.season !== currentSeason) {\n                return false;\n            }\n        }\n        \n        // === FIRST-TIME USER ONLY FILTERS ===\n        // If player is first time user, only show crops\n        if (currentPlayer?.firsttimeuser === true) {\n            if (!isACrop(resource.type, masterResources)) {\n                return false;\n            }\n        }\n        \n        // === FILTERS FOR ALL USERS (including first-time users) ===\n        // Filter out epic and legendary scroll chance items\n        if (resource.scrollchance === 'epic' || resource.scrollchance === 'legendary') {\n            return false;\n        }\n        \n        // Filter out valley source items\n        if (resource.source === 'valley') {\n            return false;\n        }\n        \n        // Filter out resources where the source requires skills the player doesn't have\n        const sourceResource = masterResources.find(r => r.type === resource.source);\n        \n        // If source resource exists and requires a skill the player doesn't have, exclude\n        if (sourceResource && sourceResource.requires && !playerSkillTypes.includes(sourceResource.requires)) {\n            return false;\n        }\n        \n        // Filter out resources that are outputs of attack resources if player doesn't have \"Explore the Valley\" trophy\n        const hasExploreValleyTrophy = currentPlayer?.trophies?.some(trophy => trophy.title === \"Explore the Valley\");\n        if (!hasExploreValleyTrophy) {\n            const attackResource = masterResources.find(r =>\n                r.action === 'attack' && r.output === resource.type\n            );\n\n            if (attackResource) {\n                return false;\n            }\n        }\n\n        // Filter out resources where resource.level is above the player's level\n        if (resource.level && resource.level > playerLevel) {\n            return false;\n        }\n\n        return true;\n    });\n    \n    if (eligibleResources.length === 0) {\n        console.warn('No eligible resources found for Train offers');\n        return [];\n    }\n    \n    const newOffers = [];\n    const maxOffers = globalTuning?.maxTrainOffers || 8; // Trains typically have more offers than Kent\n    \n    // Generate offers (typically 6-8 for trains)\n    const offersToGenerate = Math.min(maxOffers, eligibleResources.length);\n    \n    for (let i = 0; i < offersToGenerate; i++) {\n        // Avoid duplicates by tracking used resources\n        const usedResources = newOffers.map(offer => offer.item);\n        const availableResources = eligibleResources.filter(resource => \n            !usedResources.includes(resource.type)\n        );\n        \n        if (availableResources.length === 0) {\n            console.log(' No more unique resources available for train offers');\n            break;\n        }\n        \n        const randomResource = availableResources[Math.floor(Math.random() * availableResources.length)];\n        \n        // Determine quantity - trains typically want larger quantities than Kent\n        let quantity;\n        if (isACrop(randomResource.type, masterResources)) {\n            if (currentPlayer?.firsttimeuser === true) {\n                quantity = Math.floor(Math.random() * 16) + 5; // Random from 5 to 20 for first-time users\n            } else {\n                quantity = Math.floor(Math.random() * 46) + 5; // Random from 5 to 50 for regular users\n            }\n        } else {\n            quantity = Math.floor(Math.random() * 15) + 2; // Random from 2 to 16\n        }\n        \n        const newOffer = {\n            item: randomResource.type,\n            quantity: quantity\n        };\n        \n        newOffers.push(newOffer);\n    }\n    \n    console.log(`Generated ${newOffers.length} new Train offers:`, newOffers);\n    return newOffers;\n}\n\n/**\n * Calculates scaled XP reward based on player level\n * - Base: 10 XP\n * - Every 5 levels: +50% (compounding)\n * - Cap: 200 XP base (before random variance)\n * - Random variance: 15%\n * @param {number} playerLevel - The player's current level\n * @returns {number} The XP reward amount\n */\nfunction calculateScaledXPReward(playerLevel) {\n    const BASE_XP = 10;\n    const LEVEL_INTERVAL = 5;\n    const MULTIPLIER_PER_INTERVAL = 1.5;\n    const MAX_BASE_XP = 200;\n\n    // Calculate how many 5-level intervals the player has completed\n    const intervals = Math.floor(playerLevel / LEVEL_INTERVAL);\n\n    // Apply compounding 50% increase for each interval\n    let scaledBase = BASE_XP * Math.pow(MULTIPLIER_PER_INTERVAL, intervals);\n\n    // Cap at 200 XP base\n    scaledBase = Math.min(scaledBase, MAX_BASE_XP);\n\n    // Apply random variance of 15%\n    const variance = 0.15;\n    const randomFactor = 1 + (Math.random() * 2 - 1) * variance; // Range: 0.85 to 1.15\n    const finalXP = Math.round(scaledBase * randomFactor);\n\n    console.log(` XP calculation: level=${playerLevel}, intervals=${intervals}, scaledBase=${scaledBase.toFixed(1)}, finalXP=${finalXP}`);\n\n    return finalXP;\n}\n\n/**\n * Generates new Train rewards based on train offers and current season\n * @param {Array} trainOffers - Array of train offers\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season (Spring, Summer, Fall, Winter)\n * @param {Array} masterXPLevels - Array of XP thresholds for level calculation\n * @returns {Array} Array of train rewards\n */\nexport function generateTrainRewards(trainOffers, currentPlayer, masterResources, globalTuning, currentSeason, masterXPLevels) {\n    const rewards = [];\n\n    console.log(' Train reward generation for season:', currentSeason);\n\n    // Get player level for scaled XP rewards\n    const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n\n    // Convert season to lowercase to match globalTuning format\n    const seasonKey = currentSeason ? currentSeason.toLowerCase() : 'spring';\n    console.log(' Looking for season key:', seasonKey);\n\n    // Get train rewards from globalTuning based on current season\n    const seasonalRewards = globalTuning?.trainRewards?.[seasonKey];\n    console.log(' Seasonal rewards found:', seasonalRewards);\n\n    if (!seasonalRewards || !Array.isArray(seasonalRewards)) {\n        console.warn(' No train rewards found for season:', seasonKey, 'in globalTuning');\n        console.warn(' Available keys:', Object.keys(globalTuning?.trainRewards || {}));\n        return rewards;\n    }\n\n    console.log(' Available seasonal rewards:', seasonalRewards);\n\n    // Special case: If XP is in the seasonal rewards, ALWAYS include it with scaled amount\n    const hasXP = seasonalRewards.includes('XP');\n    if (hasXP) {\n        const xpQuantity = calculateScaledXPReward(playerLevel);\n        rewards.push({\n            item: 'XP',\n            quantity: xpQuantity\n        });\n        console.log(' XP reward (scaled by level):', xpQuantity);\n    }\n\n    // Filter out XP from the random selection pool since we've already handled it\n    const rewardsForRandomSelection = seasonalRewards.filter(reward => reward !== 'XP');\n\n    // Generate seasonal resource rewards (1-3 different rewards from the season's trainRewards)\n    const numSeasonalRewards = Math.floor(Math.random() * Math.min(3, rewardsForRandomSelection.length)) + 1; // 1 to 3 or max available\n    const usedRewards = new Set();\n\n    for (let i = 0; i < numSeasonalRewards; i++) {\n        // Filter out already used rewards\n        const availableRewards = rewardsForRandomSelection.filter(reward => !usedRewards.has(reward));\n\n        if (availableRewards.length === 0) break;\n\n        const randomReward = availableRewards[Math.floor(Math.random() * availableRewards.length)];\n        usedRewards.add(randomReward);\n\n        // Determine reward quantity (typically smaller quantities for special items)\n        let quantity;\n        if (isACrop(randomReward, masterResources)) {\n            quantity = Math.floor(Math.random() * 10) + 1; // 1 to 10 for crops\n        } else {\n            quantity = Math.floor(Math.random() * 3) + 1; // 1 to 3 for special items like hearts\n        }\n\n        rewards.push({\n            item: randomReward,\n            quantity: quantity\n        });\n    }\n\n    console.log(`Generated ${rewards.length} train rewards:`, rewards);\n    return rewards;\n}\n\n/**\n * Generates complete train data for a player (both offers and rewards)\n * @param {Object} currentPlayer - The current player object\n * @param {Array} masterResources - Array of all available resources\n * @param {Object} globalTuning - Global tuning configuration\n * @param {string} currentSeason - Current season\n * @param {number} trainNumber - The train number to generate for\n * @param {Array} masterXPLevels - Array of XP thresholds for level calculation\n * @returns {Object} { offers: [], rewards: [] }\n */\nexport function generateCompleteTrainData(currentPlayer, masterResources, globalTuning, currentSeason, trainNumber, masterXPLevels) {\n    console.log(` Generating complete train data for train #${trainNumber} in ${currentSeason}`);\n\n    const offers = generateNewTrainOffers(currentPlayer, masterResources, globalTuning, currentSeason, masterXPLevels);\n    const rewards = generateTrainRewards(offers, currentPlayer, masterResources, globalTuning, currentSeason, masterXPLevels);\n\n    return {\n        offers,\n        rewards\n    };\n}","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport LevelLock from '../../UI/Panels/LevelLock';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { generateCompleteTrainData } from './TrainOfferLogic';\nimport './Train.css';\nimport { formatCountdown } from '../../UI/Timers';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction NewTrainPanel({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  setModalContent,\n  setIsModalOpen,\n  globalTuning,\n  currentSeason,\n  masterXPLevels\n  })\n{\n  const strings = useStrings();\n\n  // Get Train level requirement from masterResources\n  const trainResource = masterResources?.find(r => r.type === 'Train');\n  const trainRequiredLevel = trainResource?.level || 1;\n\n  const [trainPhase, setTrainPhase] = useState(\"loading\");\n  const [trainTimer, setTrainTimer] = useState(\"\");\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [playerTrainNumber, setPlayerTrainNumber] = useState(0);\n  const [settlementTrainNumber, setSettlementTrainNumber] = useState(0);\n  const [settlementTrainPhase, setSettlementTrainPhase] = useState(\"\");\n  const [currentTrainOffers, setCurrentTrainOffers] = useState([]);\n  const [currentTrainRewards, setCurrentTrainRewards] = useState([]);\n  const [nextTrainOffers, setNextTrainOffers] = useState([]);\n  const [nextTrainRewards, setNextTrainRewards] = useState([]);\n  const [isTrading, setIsTrading] = useState(false);\n  const [rewardsDeliveredMessage, setRewardsDeliveredMessage] = useState(\"\");\n\n  // Initialize train data on component load\n  useEffect(() => {\n    if (currentPlayer?.playerId && currentPlayer?.settlementId) {\n      initializeTrainData();\n    }\n  }, [currentPlayer?.playerId, currentPlayer?.settlementId]);\n\n  // Update timer from localStorage\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = Date.now();\n      const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n      const trainTimerData = storedTimers.train || {};\n\n      const phase = trainTimerData.phase;\n      setTrainPhase(phase || \"unknown\");\n      setSettlementTrainPhase(phase || \"unknown\");\n\n      const endTime = trainTimerData.endTime;\n      if (!endTime || isNaN(endTime)) {\n        setTrainTimer(\"N/A\");\n        return;\n      } else {\n        setTrainTimer(formatCountdown(endTime, now));\n      }\n    };\n\n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Watch for train phase changes and trigger reward delivery\n  useEffect(() => {\n    if (!currentPlayer?.playerId || !settlementTrainPhase) return;\n    \n    const checkForRewardDelivery = async () => {\n      const playerTrainNum = currentPlayer?.train?.currentTrainNumber || 0;\n      const lastRewardDelivery = currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0;\n      \n      // Check if we should deliver rewards for current train when it starts departing/arriving\n      const shouldDeliverRewards = (\n        playerTrainNum === settlementTrainNumber && \n        (settlementTrainPhase === 'departing' || settlementTrainPhase === 'arriving') &&\n        playerTrainNum > lastRewardDelivery\n      );\n      \n      if (shouldDeliverRewards) {\n        console.log(' [Reactive] Train phase changed to departing/arriving - checking for reward delivery');\n        await checkAndDeliverCurrentTrainRewards(playerTrainNum);\n      }\n    };\n    \n    checkForRewardDelivery();\n  }, [settlementTrainPhase, currentPlayer?.train?.currentTrainNumber, settlementTrainNumber]);\n\n  // Clear rewards message when entering loading phase (new train cycle)\n  useEffect(() => {\n    if (trainPhase === \"loading\" && rewardsDeliveredMessage) {\n      setRewardsDeliveredMessage(\"\");\n    }\n  }, [trainPhase, rewardsDeliveredMessage]);\n\n\n  const initializeTrainData = async () => {\n    setIsContentLoading(true);\n    try {\n      console.log(' Initializing personalized train data...');\n      \n      // Step 1: Get settlement train number\n      const settlementResponse = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n      const trainlog = settlementResponse.data?.trainlog || [];\n      const currentTrainLog = trainlog.find(log => log.status === \"Current Train\");\n      const currentSettlementTrainNumber = currentTrainLog?.trainnumber || 1;\n      \n      setSettlementTrainNumber(currentSettlementTrainNumber);\n      console.log(' Settlement train number:', currentSettlementTrainNumber);\n\n      // Step 2: Get player's current train number\n      const currentPlayerTrainNumber = currentPlayer?.train?.currentTrainNumber || 0;\n      setPlayerTrainNumber(currentPlayerTrainNumber);\n      console.log(' Player train number:', currentPlayerTrainNumber);\n\n      // Step 3: Determine which train data to show based on comparison\n      await determineTrainDataToShow(currentPlayerTrainNumber, currentSettlementTrainNumber, settlementTrainPhase);\n\n    } catch (error) {\n      console.error(\" Error initializing train data:\", error);\n    } finally {\n      setIsContentLoading(false);\n    }\n  };\n\n  const determineTrainDataToShow = async (playerTrainNum, settlementTrainNum, settlementPhase) => {\n    console.log(' Determining train data to show:', { \n      playerTrainNum, \n      settlementTrainNum, \n      settlementPhase,\n      lastRewardDelivery: currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0 \n    });\n    \n    // Check if we should deliver rewards for current train when it starts departing\n    const shouldDeliverRewards = (\n      playerTrainNum === settlementTrainNum && \n      (settlementPhase === 'departing' || settlementPhase === 'arriving') &&\n      playerTrainNum > (currentPlayer?.train?.lastRewardDeliveryTrainNumber || 0)\n    );\n    \n    // Check if player is behind on train numbers\n    const isPlayerBehind = playerTrainNum < settlementTrainNum;\n    \n    if (shouldDeliverRewards) {\n      // Player is on current train and it's departing/arriving - deliver rewards then show current data\n      console.log(' Train is departing/arriving - checking for reward delivery');\n      await checkAndDeliverCurrentTrainRewards(playerTrainNum);\n      await showCurrentTrainData();\n    } else if (isPlayerBehind) {\n      // Player is behind - advance them to current train\n      console.log(' Player is behind, advancing to current train');\n      await advancePlayerToCurrentTrain(settlementTrainNum);\n    } else if (playerTrainNum === settlementTrainNum) {\n      // Player is on current train - show existing data or generate if missing\n      console.log(' Player is on current train');\n      await showCurrentTrainData();\n    } else {\n      // Player is ahead (shouldn't happen, but handle gracefully)\n      console.log(' Player is ahead of settlement train - this should not happen');\n      await showCurrentTrainData();\n    }\n  };\n\n  const showCurrentTrainData = async () => {\n    // Use existing player train data if available\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    const existingNextOffers = currentPlayer?.train?.nextTrainOffers || [];\n    const existingNextRewards = currentPlayer?.train?.nextTrainRewards || [];\n\n    if (existingCurrentOffers.length === 0) {\n      // Generate new train data for current train\n      console.log(' Generating new current train data');\n      await generateAndSaveTrainData(settlementTrainNumber);\n    } else {\n      // Use existing data\n      console.log(' Using existing current train data');\n      setCurrentTrainOffers(existingCurrentOffers);\n      setCurrentTrainRewards(existingCurrentRewards);\n      setNextTrainOffers(existingNextOffers);\n      setNextTrainRewards(existingNextRewards);\n    }\n  };\n\n  const checkAndDeliverCurrentTrainRewards = async (trainNumber) => {\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    \n    // Check if all current offers were completed\n    if (existingCurrentOffers.length > 0) {\n      const allOffersCompleted = existingCurrentOffers.every(offer => offer.completed === true);\n      \n      if (allOffersCompleted && existingCurrentRewards.length > 0) {\n        console.log(' All current train offers completed! Delivering rewards to mailbox:', existingCurrentRewards);\n        \n        // Generate a unique message ID based on timestamp\n        const messageId = Date.now();\n        \n        // Create the message for the mailbox\n        const newMessage = {\n          messageId: 101,\n          timestamp: new Date(),\n          rewards: existingCurrentRewards.map(reward => ({\n            item: reward.item,\n            qty: reward.quantity\n          })),\n          read: false,\n          collected: false,\n          neverPurge: false\n        };\n        \n        try {\n          // Add the message to player's messages array AND update lastRewardDeliveryTrainNumber\n          const currentMessages = currentPlayer?.messages || [];\n          const updatedMessages = [...currentMessages, newMessage];\n          \n          const updatedTrainData = {\n            ...currentPlayer.train,\n            lastRewardDeliveryTrainNumber: trainNumber\n          };\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { \n              messages: updatedMessages,\n              train: updatedTrainData\n            }\n          });\n          \n          if (response.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n              ...prev,\n              messages: updatedMessages,\n              train: updatedTrainData\n            }));\n            \n            // Create reward summary for status message\n            const rewardSummary = existingCurrentRewards.map(reward => \n              `${getSymbol(reward.item)} ${reward.quantity} ${reward.item}`\n            ).join(', ');\n            \n            updateStatus(` Train rewards delivered to your mailbox: ${rewardSummary}`);\n            setRewardsDeliveredMessage(strings[2016] || \"Train rewards have been delivered to your mailbox!\");\n            console.log(' Current train rewards successfully delivered to mailbox');\n          }\n        } catch (error) {\n          console.error(' Error delivering current train rewards to mailbox:', error);\n        }\n      } else {\n        // Some offers were not completed\n        const completedCount = existingCurrentOffers.filter(offer => offer.completed === true).length;\n        console.log(` Train departing with ${completedCount}/${existingCurrentOffers.length} offers completed`);\n        \n        // Still update lastRewardDeliveryTrainNumber to prevent future attempts\n        try {\n          const updatedTrainData = {\n            ...currentPlayer.train,\n            lastRewardDeliveryTrainNumber: trainNumber\n          };\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { train: updatedTrainData }\n          });\n          \n          if (response.data.success) {\n            setCurrentPlayer(prev => ({\n              ...prev,\n              train: updatedTrainData\n            }));\n          }\n        } catch (error) {\n          console.error(' Error updating lastRewardDeliveryTrainNumber:', error);\n        }\n      }\n    }\n  };\n\n  const checkAndDeliverPreviousTrainRewards = async () => {\n    const existingCurrentOffers = currentPlayer?.train?.currentTrainOffers || [];\n    const existingCurrentRewards = currentPlayer?.train?.currentTrainRewards || [];\n    \n    // Check if all current offers were completed\n    if (existingCurrentOffers.length > 0) {\n      const allOffersCompleted = existingCurrentOffers.every(offer => offer.completed === true);\n      \n      if (allOffersCompleted && existingCurrentRewards.length > 0) {\n        console.log(' All train offers completed! Delivering rewards to mailbox:', existingCurrentRewards);\n        \n        // Generate a unique message ID based on timestamp\n        const messageId = Date.now();\n        \n        // Create the message for the mailbox\n        const newMessage = {\n          messageId: 101,\n          timestamp: new Date(),\n          rewards: existingCurrentRewards.map(reward => ({\n            item: reward.item,\n            qty: reward.quantity\n          })),\n          read: false,\n          collected: false,\n          neverPurge: false\n        };\n        \n        try {\n          // Add the message to player's messages array\n          const currentMessages = currentPlayer?.messages || [];\n          const updatedMessages = [...currentMessages, newMessage];\n          \n          const response = await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { messages: updatedMessages }\n          });\n          \n          if (response.data.success) {\n            // Update local player state\n            setCurrentPlayer(prev => ({\n              ...prev,\n              messages: updatedMessages\n            }));\n            \n            // Create reward summary for status message\n            const rewardSummary = existingCurrentRewards.map(reward => \n              `${getSymbol(reward.item)} ${reward.quantity} ${reward.item}`\n            ).join(', ');\n            \n            updateStatus(` Train rewards delivered to your mailbox: ${rewardSummary}`);\n            setRewardsDeliveredMessage(strings[2016] || \"Train rewards have been delivered to your mailbox!\");\n            console.log(' Train rewards successfully delivered to mailbox');\n          }\n        } catch (error) {\n          console.error(' Error delivering train rewards to mailbox:', error);\n        }\n      } else if (existingCurrentOffers.length > 0) {\n        // Some offers were not completed\n        const completedCount = existingCurrentOffers.filter(offer => offer.completed === true).length;\n        console.log(` Train expired with ${completedCount}/${existingCurrentOffers.length} offers completed`);\n        updateStatus(` Previous train left with ${completedCount}/${existingCurrentOffers.length} orders completed`);\n      }\n    }\n  };\n\n  const advancePlayerToCurrentTrain = async (newTrainNumber) => {\n    console.log(' Advancing player to train', newTrainNumber);\n    \n    // Check if player completed all previous train offers and deliver rewards\n    await checkAndDeliverPreviousTrainRewards();\n    \n    // Move next train data to current (if exists)\n    const existingNextOffers = currentPlayer?.train?.nextTrainOffers || [];\n    const existingNextRewards = currentPlayer?.train?.nextTrainRewards || [];\n    \n    let newCurrentOffers = [];\n    let newCurrentRewards = [];\n    \n    if (existingNextOffers.length > 0) {\n      // Use existing next train data as current\n      newCurrentOffers = existingNextOffers;\n      newCurrentRewards = existingNextRewards;\n      console.log(' Using existing next train data as current');\n    } else {\n      // Generate new current train data\n      console.log(' Generating new current train data');\n      const trainData = generateCompleteTrainData(\n        currentPlayer,\n        masterResources,\n        globalTuning,\n        currentSeason,\n        newTrainNumber,\n        masterXPLevels\n      );\n      newCurrentOffers = trainData.offers;\n      newCurrentRewards = trainData.rewards;\n    }\n\n    // Generate new next train data\n    const nextTrainData = generateCompleteTrainData(\n      currentPlayer,\n      masterResources,\n      globalTuning,\n      currentSeason,\n      newTrainNumber + 1,\n      masterXPLevels\n    );\n\n    // Update player in database\n    const updatedTrainData = {\n      currentTrainNumber: newTrainNumber,\n      currentTrainOffers: newCurrentOffers,\n      currentTrainRewards: newCurrentRewards,\n      nextTrainOffers: nextTrainData.offers,\n      nextTrainRewards: nextTrainData.rewards\n    };\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setPlayerTrainNumber(newTrainNumber);\n        setCurrentTrainOffers(newCurrentOffers);\n        setCurrentTrainRewards(newCurrentRewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        console.log(' Player advanced to train', newTrainNumber);\n      }\n    } catch (error) {\n      console.error(' Error advancing player train:', error);\n    }\n  };\n\n  const generateAndSaveTrainData = async (trainNumber) => {\n    // Generate current and next train data\n    const currentTrainData = generateCompleteTrainData(\n      currentPlayer,\n      masterResources,\n      globalTuning,\n      currentSeason,\n      trainNumber,\n      masterXPLevels\n    );\n\n    const nextTrainData = generateCompleteTrainData(\n      currentPlayer,\n      masterResources,\n      globalTuning,\n      currentSeason,\n      trainNumber + 1,\n      masterXPLevels\n    );\n\n    const updatedTrainData = {\n      currentTrainNumber: trainNumber,\n      currentTrainOffers: currentTrainData.offers,\n      currentTrainRewards: currentTrainData.rewards,\n      nextTrainOffers: nextTrainData.offers,\n      nextTrainRewards: nextTrainData.rewards\n    };\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(currentTrainData.offers);\n        setCurrentTrainRewards(currentTrainData.rewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        console.log(' Generated and saved new train data');\n      }\n    } catch (error) {\n      console.error(' Error saving train data:', error);\n    }\n  };\n\n  const getSymbol = (type) => {\n    return masterResources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n  // Check if loading phase has expired based on client timer\n  const isLoadingPhaseExpired = () => {\n    const now = Date.now();\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n    const trainTimerData = storedTimers.train || {};\n    const endTime = trainTimerData.endTime;\n    const phase = trainTimerData.phase;\n    \n    // If we're in loading phase and the timer has expired, consider it expired\n    if (phase === \"loading\" && endTime && now >= endTime) {\n      return true;\n    }\n    \n    // If we're already in departing or arriving phase, definitely expired\n    if (phase === \"departing\" || phase === \"arriving\") {\n      return true;\n    }\n    \n    return false;\n  };\n\n  const handleFulfillOffer = async (offer) => {\n    if (!offer || !currentPlayer || isTrading) return;\n    \n    // Check if loading phase has expired (client-side authority)\n    if (isLoadingPhaseExpired()) {\n      updateStatus(' Train has already departed! Cannot fulfill orders.');\n      return;\n    }\n    \n    // Set trading flag to prevent spam clicks\n    setIsTrading(true);\n    \n    try {\n      // Spend the ingredients (the item being delivered)\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          type: offer.item, \n          ingredient1: offer.item, \n          ingredient1qty: offer.quantity \n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) return;\n      // Calculate money reward\n      const resource = masterResources.find(r => r.type === offer.item);\n      const moneyReward = (resource?.maxprice || 100) * offer.quantity;\n\n      // Award money for fulfillment\n      await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: \"Money\",\n        quantity: moneyReward,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Mark the fulfilled offer as completed instead of removing it\n      const updatedCurrentOffers = currentTrainOffers.map(o => {\n        if (o.item === offer.item && o.quantity === offer.quantity && !o.completed) {\n          return { ...o, completed: true };\n        }\n        return o;\n      });\n\n      // Update player train data in database\n      const updatedTrainData = {\n        ...currentPlayer.train,\n        currentTrainOffers: updatedCurrentOffers\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(updatedCurrentOffers);\n        updateStatus(` Delivered ${offer.quantity} ${offer.item} for ${getSymbol('Money')} ${moneyReward.toLocaleString()}.`);\n      }\n    } catch (error) {\n      console.error(\" Error fulfilling train offer:\", error);\n      updateStatus(' Trade failed. Please try again.');\n    } finally {\n      // Always clear the trading flag\n      setIsTrading(false);\n    }\n  };\n\n  const handleGenerateOffers = async () => {\n    if (isTrading) return;\n    \n    // Set trading flag to prevent spam clicks\n    setIsTrading(true);\n    \n    console.log(' [DEBUG] Regenerating train offers...');\n    \n    try {\n      // Generate new current train data\n      const currentTrainData = generateCompleteTrainData(\n        currentPlayer,\n        masterResources,\n        globalTuning,\n        currentSeason,\n        playerTrainNumber,\n        masterXPLevels\n      );\n\n      // Generate new next train data\n      const nextTrainData = generateCompleteTrainData(\n        currentPlayer,\n        masterResources,\n        globalTuning,\n        currentSeason,\n        playerTrainNumber + 1,\n        masterXPLevels\n      );\n\n      const updatedTrainData = {\n        ...currentPlayer.train,\n        currentTrainOffers: currentTrainData.offers,\n        currentTrainRewards: currentTrainData.rewards,\n        nextTrainOffers: nextTrainData.offers,\n        nextTrainRewards: nextTrainData.rewards\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { train: updatedTrainData }\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          train: updatedTrainData\n        }));\n        \n        setCurrentTrainOffers(currentTrainData.offers);\n        setCurrentTrainRewards(currentTrainData.rewards);\n        setNextTrainOffers(nextTrainData.offers);\n        setNextTrainRewards(nextTrainData.rewards);\n        \n        updateStatus(' [DEBUG] Generated new train offers and rewards!');\n        console.log(' [DEBUG] Train offers regenerated successfully');\n      }\n    } catch (error) {\n      console.error(\" [DEBUG] Error regenerating train offers:\", error);\n      updateStatus(' Failed to generate new offers');\n    } finally {\n      // Always clear the trading flag\n      setIsTrading(false);\n    }\n  };\n\n  const renderCurrentOffers = () => {\n    if (currentTrainOffers.length === 0) return null;\n\n    return (\n      <div className=\"offer-section\">\n        <h4>Your Train Orders</h4>\n        {currentTrainOffers.map((offer, index) => {\n          const isCompleted = offer.completed || false;\n          const playerQty = inventory?.find(item => item.type === offer.item)?.quantity || 0;\n          const backpackQty = backpack?.find(item => item.type === offer.item)?.quantity || 0;\n          const totalQty = playerQty + backpackQty;\n          const loadingExpired = isLoadingPhaseExpired();\n          const affordable = totalQty >= offer.quantity && !isCompleted && !loadingExpired;\n\n          // Calculate money reward\n          const resource = masterResources.find(r => r.type === offer.item);\n          const moneyReward = (resource?.maxprice || 100) * offer.quantity;\n\n          let costDisplay, details, buttonText;\n          \n          if (isCompleted) {\n            costDisplay = `<span style=\"color: green;\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity}</span>`;\n            details = `<div>${costDisplay}</div>Completed`;\n            buttonText = '';\n          } else if (loadingExpired) {\n            costDisplay = `<span style=\"color: gray;\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity} / ${totalQty}</span>`;\n            details = `<div>${costDisplay}</div>Train Departed`;\n            buttonText = '';\n          } else {\n            const costColor = affordable ? 'green' : 'red';\n            costDisplay = `<span style=\"color: ${costColor};\">${getSymbol(offer.item)} ${offer.item} ${offer.quantity} / ${totalQty}</span>`;\n            const rewardDisplay = `${getSymbol('Money')} ${moneyReward.toLocaleString()}`;\n            details = `<div>${costDisplay}</div>${strings[42]} ${rewardDisplay}`;\n            buttonText = '';\n          }\n\n          return (\n            <div key={index} style={{ position: 'relative' }}>\n              <ResourceButton\n                className={`train-offer-card ${isCompleted ? 'completed' : ''}`}\n                onClick={() => !isTrading && affordable && !isCompleted ? handleFulfillOffer(offer) : null}\n                disabled={isCompleted || !affordable || isTrading}\n                details={details}\n              >\n                {buttonText}\n              </ResourceButton>\n              {isCompleted && (\n                <div style={{\n                  position: 'absolute',\n                  top: '50%',\n                  right: '10px',\n                  transform: 'translateY(-50%)',\n                  fontSize: '2em',\n                  color: 'green',\n                  pointerEvents: 'none',\n                  zIndex: 10\n                }}>\n                  \n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const renderCurrentRewards = () => {\n    return (\n      <div className=\"reward-section\">\n        <h4>{strings[2019]}</h4>\n        {currentTrainRewards.length > 0 ? (\n          <div className=\"train-rewards-container\">\n            {currentTrainRewards.map((reward, index) => (\n              <div key={index} className=\"train-reward-item\">\n                {getSymbol(reward.item)} {reward.quantity} {reward.item}\n              </div>\n            ))}\n          </div>\n        ) : (\n          <p>No rewards available</p>\n        )}\n      </div>\n    );\n  };\n\n  const renderNextTrain = () => {\n    if (nextTrainOffers.length === 0) return null;\n\n    return (\n      <div className=\"next-shipment-preview\">\n        <h4>{strings[2003]}</h4>\n        <div className=\"next-shipment-container\">\n          <div style={{ marginBottom: '10px' }}>\n            <strong>Orders:</strong>\n          </div>\n          {nextTrainOffers.map((offer, index) => (\n            <div key={index} className=\"next-shipment-item\">\n              {getSymbol(offer.item)} {offer.item}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1022\" titleKey=\"1122\" panelName=\"NewTrainPanel\">\n      <LevelLock\n        currentPlayer={currentPlayer}\n        masterXPLevels={masterXPLevels}\n        requiredLevel={trainRequiredLevel}\n        featureName=\"Train\"\n      >\n        {(() => {\n          const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n          return !isInHomeSettlement;\n        })() ? (\n          <div style={{ textAlign: 'center', padding: '20px' }}>\n            <h2>{strings[2050] || \"This is not your home settlement.\"}</h2>\n          </div>\n        ) : isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            <h3>Train is {trainPhase} (#{playerTrainNumber})</h3>\n            <h2 className=\"countdown-timer\"> {trainTimer}</h2>\n\n            {rewardsDeliveredMessage && (trainPhase === \"departing\" || trainPhase === \"arriving\") && (\n              <div style={{\n                backgroundColor: 'var(--color-success)',\n                color: 'var(--color-text-white)',\n                padding: '10px',\n                margin: '10px 0',\n                borderRadius: '5px',\n                textAlign: 'center',\n                fontWeight: 'bold'\n              }}>\n                 {rewardsDeliveredMessage}\n              </div>\n            )}\n\n            {trainPhase === \"loading\" && (\n              <>\n                {renderCurrentRewards()}\n                {renderCurrentOffers()}\n              </>\n            )}\n\n            {(trainPhase === \"loading\" || trainPhase === \"departing\") && renderNextTrain()}\n          </>\n        )}\n      </LevelLock>\n    </Panel>\n  );\n}\n\nexport default NewTrainPanel;","import API_BASE from '../../config';\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport LevelLock from '../../UI/Panels/LevelLock';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport './Carnival.css';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { formatCountdown } from '../../UI/Timers';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction CarnivalPanel({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  masterResources,\n  masterXPLevels,\n  setModalContent,\n  setIsModalOpen,\n  globalTuning\n  })\n{\n  const strings = useStrings();\n\n  // Get Carnival level requirement from masterResources\n  const carnivalResource = masterResources?.find(r => r.type === 'Carnival');\n  const carnivalRequiredLevel = carnivalResource?.level || 1;\n\n  const [carnivalOffers, setCarnivalOffers] = useState([]);\n  const [carnivalPhase, setCarnivalPhase] = useState(\"here\");\n  const [carnivalTimer, setCarnivalTimer] = useState(\"\");\n  const [nextOffers, setNextOffers] = useState([]);\n  const [carnivalRewards, setCarnivalRewards] = useState([]);\n  const [latestInventory, setLatestInventory] = useState([]);\n  const [playerUsernames, setPlayerUsernames] = useState({}); // Map of playerId -> username\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const [currentCarnivalNumber, setCurrentCarnivalNumber] = useState(null);\n\n  // 1. Initial load for the player\n  useEffect(() => {\n    const fetchInventory = async () => {\n      if (!currentPlayer?.playerId) return;\n      setIsContentLoading(true);\n      try {\n        const response = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setLatestInventory(response.data.inventory || []);\n      } catch (error) {\n        console.error(\" Error fetching latest inventory:\", error);\n      } finally {\n        setIsContentLoading(false);\n      }\n    };\n    fetchInventory();\n\n    if (currentPlayer?.settlementId) {\n      fetchCarnivalOffers();\n    }\n  }, [currentPlayer?.playerId, currentPlayer?.settlementId]);\n\n\n  // 2. Fetch fresh carnival offers on *every* phase change\n  useEffect(() => {\n    if (currentPlayer?.settlementId) {\n      fetchCarnivalOffers(); //  fixes stale data after phase transitions\n    }\n  }, [carnivalPhase]);\n\n\n  useEffect(() => {\n    const updateCountdown = () => {\n      const now = Date.now();\n\n      const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n      const carnivalTimerData = storedTimers.carnival || {};\n\n      const phase = carnivalTimerData.phase;\n      setCarnivalPhase(phase || \"unknown\");\n\n      const endTime = carnivalTimerData.endTime;\n      if (!endTime || isNaN(endTime)) {\n        setCarnivalTimer(\"N/A\");\n        return;\n      } else {\n        setCarnivalTimer(formatCountdown(endTime, now));\n      }\n    };\n\n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetchCarnivalOffers = async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n      const offers = response.data?.carnival?.currentoffers || [];\n      setCarnivalOffers(offers);\n      setNextOffers(response.data?.carnival?.nextoffers || []);\n      // Get current carnival info from carnivallog\n      const carnivallog = response.data?.carnival?.carnivallog || [];\n      const currentCarnival = carnivallog.find(log => log.status === \"Current Carnival\");\n      if (currentCarnival) {\n        // Use rewards from the current carnival log entry\n        setCarnivalRewards(currentCarnival.rewards || []);\n        if (currentCarnival.carnivalnumber) {\n          setCurrentCarnivalNumber(currentCarnival.carnivalnumber);\n        }\n      } else {\n        // No current carnival, clear rewards\n        setCarnivalRewards([]);\n      }\n      \n      // Fetch usernames for claimed/completed offers\n      await fetchUsernames(offers);\n    } catch (error) {\n      console.error(\" Error fetching carnival offers:\", error);\n    }\n  };\n\n  const fetchUsernames = async (offers) => {\n    try {\n      // Find all unique player IDs that have claimed or completed offers\n      const playerIds = [...new Set(\n        offers\n          .filter(offer => offer.claimedBy)\n          .map(offer => offer.claimedBy)\n      )];\n\n      if (playerIds.length === 0) return;\n\n      // Fetch usernames for these player IDs\n      const usernamePromises = playerIds.map(async (playerId) => {\n        try {\n          const response = await axios.get(`${API_BASE}/api/player/${playerId}`);\n          return { playerId, username: response.data.username };\n        } catch (error) {\n          console.error(` Error fetching username for player ${playerId}:`, error);\n          return { playerId, username: 'Unknown' };\n        }\n      });\n\n      const usernameResults = await Promise.all(usernamePromises);\n      \n      // Convert to map and update state\n      const usernameMap = usernameResults.reduce((acc, { playerId, username }) => {\n        acc[playerId] = username;\n        return acc;\n      }, {});\n\n      setPlayerUsernames(prev => ({ ...prev, ...usernameMap }));\n    } catch (error) {\n      console.error(\" Error fetching usernames:\", error);\n    }\n  };\n\n  const [showLogicModal, setShowLogicModal] = useState(false);\n  const [logicModalData, setLogicModalData] = useState({ logic: '', carnivalNumber: null });\n\n  const handleShowLogic = (logicText, carnivalNumber) => {\n    setLogicModalData({ logic: logicText, carnivalNumber });\n    setShowLogicModal(true);\n  };\n\n  const handleShowCarnivalLog = async () => {\n    if (!setModalContent || !setIsModalOpen) {\n      console.warn(\"Modal context functions not available.\");\n      return;\n    }\n\n    if (!currentPlayer?.settlementId) {\n      console.warn(\" Cannot show carnival log: settlementId missing.\");\n      return;\n    }\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/carnivallog`);\n      const carnivallog = response.data.carnivallog || [];\n\n      const carnivalLogTable = (\n        <table className=\"carnival-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>Carnival #</th>\n              <th style={{ padding: \"6px 12px\" }}>Date</th>\n              <th style={{ padding: \"6px 12px\" }}>Status</th>\n              <th style={{ padding: \"6px 12px\" }}>Offers Filled</th>\n              <th style={{ padding: \"6px 12px\" }}>Total Winners</th>\n              <th style={{ padding: \"6px 12px\" }}>Reward Summary</th>\n              <th style={{ padding: \"6px 12px\" }}>Logic</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...carnivallog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>{entry.carnivalnumber || '-'}</td>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.status || ''}</td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Carnival' || entry.status === 'Current Carnival' ? 'n/a' : entry.alloffersfilled ? '' : ''}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.status === 'Next Carnival' || entry.status === 'Current Carnival' ? 'n/a' : entry.totalwinners}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {(() => {\n                    // Combine rewards of the same type for display\n                    const combinedRewards = {};\n                    (entry.rewards || []).forEach((reward) => {\n                      if (combinedRewards[reward.item]) {\n                        combinedRewards[reward.item] += reward.qty;\n                      } else {\n                        combinedRewards[reward.item] = reward.qty;\n                      }\n                    });\n                    return Object.entries(combinedRewards).map(([item, totalQty]) => `${totalQty} ${item}`).join(', ');\n                  })()}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>\n                  {entry.logic ? (\n                    <button \n                      onClick={() => handleShowLogic(entry.logic, entry.carnivalnumber)}\n                      className=\"carnival-logic-button\"\n                    >\n                      Logic\n                    </button>\n                  ) : (\n                    '-'\n                  )}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: \"Carnival Log\",\n        size: \"large\",\n        message: carnivallog.length === 0 ? \"No recent carnival activity.\" : undefined,\n        custom: carnivalLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch carnival log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load carnival log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n  const getSymbol = (type) => {\n    return masterResources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n  const handleClaim = async (offer) => {\n    if (!offer || offer.claimedBy) return;\n\n    //  Check if player already has a claimed offer\n    const alreadyClaimed = carnivalOffers.some(\n      (o) => o.claimedBy === currentPlayer.playerId && !o.filled\n    );\n    if (alreadyClaimed) {\n      updateStatus(2014); //  Already claimed an offer\n      return;\n    }\n\n    try {\n      // Find the exact index of the offer to ensure uniqueness\n      const offerIndex = carnivalOffers.findIndex(\n        (o) => o.itemBought === offer.itemBought &&\n              o.qtyBought === offer.qtyBought &&\n              !o.claimedBy &&\n              !o.filled\n      );\n      if (offerIndex === -1) {\n        console.warn(\" No matching unclaimed offer found to claim.\");\n        return;\n      }\n\n      const updatedOffer = {\n        ...carnivalOffers[offerIndex],\n        claimedBy: currentPlayer.playerId,\n      };\n\n      const response = await axios.post(`${API_BASE}/api/update-carnival-offer/${currentPlayer.settlementId}`, {\n        updateOffer: updatedOffer,\n      });\n\n      if (response.status === 200) {\n        setCarnivalOffers(prev => {\n          const newOffers = [...prev];\n          newOffers[offerIndex] = updatedOffer;\n          return newOffers;\n        });\n        \n        // Add current player's username to the map immediately\n        setPlayerUsernames(prev => ({\n          ...prev,\n          [currentPlayer.playerId]: currentPlayer.username\n        }));\n      }\n    } catch (err) {\n      console.error(\" Error claiming carnival offer:\", err);\n      \n      // Handle case where offer was already claimed\n      if (err.response?.status === 409) {\n        updateStatus(2017); // This order has already been claimed.\n        // Refresh offers to get latest state\n        fetchCarnivalOffers();\n      } else {\n        updateStatus(505); // Generic error\n      }\n    }\n  };\n\n  const handleFulfill = async (offer) => {\n    if (!offer || offer.claimedBy !== currentPlayer.playerId) return;\n\n    // Spend the ingredients (the item being delivered)\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: { \n        type: offer.itemBought, \n        ingredient1: offer.itemBought, \n        ingredient1qty: offer.qtyBought \n      },\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!success) return;\n\n    try {\n      // First update the carnival offer\n      await axios.post(`${API_BASE}/api/update-carnival-offer/${currentPlayer.settlementId}`, {\n        updateOffer: {\n          ...offer,\n          filled: true,\n        },\n      });\n\n    // Award Money for fulfillment\n    await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: \"Money\",\n      quantity: offer.qtyGiven,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n      // Update local state in correct order\n      setCarnivalOffers(prev => {\n        const index = prev.findIndex(o =>\n          o.itemBought === offer.itemBought &&\n          o.qtyBought === offer.qtyBought &&\n          o.claimedBy === currentPlayer.playerId &&\n          !o.filled\n        );\n        if (index === -1) return prev;\n        const newOffers = [...prev];\n        newOffers[index] = { ...newOffers[index], filled: true };\n        return newOffers;\n      });\n\n      updateStatus(` Delivered ${offer.qtyBought} ${offer.itemBought}.`);\n\n    } catch (error) {\n      console.error(\" Error fulfilling offer:\", error);\n      fetchCarnivalOffers(); // Refresh offers on error to ensure sync\n    }\n  };\n\n  const renderNextShipment = () => {\n    if (![\"here\", \"departing\"].includes(carnivalPhase)) return null;\n    if (!nextOffers.length) return null;\n  \n    //  Deduplicate by itemBought\n    const seen = new Set();\n    const uniqueOffers = nextOffers.filter((offer) => {\n      if (seen.has(offer.itemBought)) return false;\n      seen.add(offer.itemBought);\n      return true;\n    });\n  \n    return (\n      <div className=\"next-shipment-preview\">\n        <h4>{strings[2018]}</h4>\n        <div className=\"next-shipment-container\">\n          {uniqueOffers.map((offer, index) => (\n            <div key={index} className=\"next-shipment-item\">\n              {getSymbol(offer.itemBought)} {offer.itemBought}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderRewardSection = () => {\n    if (!carnivalRewards.length || carnivalPhase !== \"here\") return null;\n  \n    //  Combine rewards of the same type\n    const combinedRewards = {};\n    carnivalRewards.forEach((reward) => {\n      if (combinedRewards[reward.item]) {\n        combinedRewards[reward.item] += reward.qty;\n      } else {\n        combinedRewards[reward.item] = reward.qty;\n      }\n    });\n  \n    return (\n      <div className=\"reward-section\">\n        <h4>{strings[2004]}</h4>\n        <div className=\"carnival-rewards-container\">\n          {Object.entries(combinedRewards).map(([item, totalQty], index) => (\n            <div key={index} className=\"carnival-reward-item\">\n              {getSymbol(item)} {totalQty} {item}\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const renderOfferSection = (title, offers) => {\n    if (!offers.length) return null;\n    return (\n      <div className=\"offer-section\">\n        <h4>{title}</h4>\n        {offers.map((offer, index) => {\n          const isYours = offer.claimedBy === currentPlayer.playerId;\n          const isCompleted = offer.filled;\n          const affordable = latestInventory?.some(\n            (item) => item.type === offer.itemBought && item.quantity >= offer.qtyBought\n          ) || false;\n\n          const playerQty = latestInventory?.find(inv => inv.type === offer.itemBought)?.quantity || 0;\n          const costColor = playerQty >= offer.qtyBought ? 'green' : 'red';\n          const costDisplay = `<span style=\"color: ${costColor};\">${getSymbol(offer.itemBought)} ${offer.itemBought} ${offer.qtyBought} / ${playerQty}</span>`;\n          const rewardDisplay = `${getSymbol(offer.itemGiven)} ${offer.qtyGiven.toLocaleString()}`;\n          const details = `<div>${costDisplay}</div><br>${strings[42]}: ${rewardDisplay}`;\n\n          let buttonText = '';\n          if (isCompleted) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = username;\n          } else if (isYours && affordable) {\n            buttonText = strings[2005];\n          } else if (isYours) {\n            buttonText = strings[2006];\n          } else if (offer.claimedBy) {\n            const username = playerUsernames[offer.claimedBy] || 'Unknown';\n            buttonText = `${strings[2007]} (${username})`;\n          } else {\n            buttonText = strings[2008];\n          }\n\n          return (\n            <ResourceButton\n              key={index}\n              name={isCompleted || offer.claimedBy ? (playerUsernames[offer.claimedBy] || 'Unknown') : ''}\n              className={`carnival-offer-card ${\n                !offer.claimedBy ? 'unclaimed' : \n                'resource-button'\n              }`}\n              onClick={() =>\n                isCompleted ? null :\n                isYours ? handleFulfill(offer) :\n                !offer.claimedBy ? handleClaim(offer) : null\n              }\n              disabled={isCompleted || (!isYours && offer.claimedBy) || (isYours && !affordable)}\n              details={details}\n            >\n              <strong>{!isCompleted && !offer.claimedBy ? buttonText : \n               !isCompleted && offer.claimedBy ? strings[2007] : ''}</strong>\n            </ResourceButton>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const claimedByYou = carnivalOffers.filter(o => o.claimedBy === currentPlayer.playerId && !o.filled);\n  const available = carnivalOffers.filter(o => !o.claimedBy);\n  const claimedByOthers = carnivalOffers.filter(o => o.claimedBy && o.claimedBy !== currentPlayer.playerId && !o.filled);\n  const completed = carnivalOffers.filter(o => o.filled);\n\n  const allOrdersFilled = carnivalPhase === 'departing' || carnivalPhase === 'arriving'\n  ? carnivalOffers.length > 0 && carnivalOffers.every(o => o.filled)\n  : false;\n\n\n  return (\n    <>\n    <Panel onClose={onClose} descriptionKey=\"1037\" titleKey=\"1137\" panelName=\"CarnivalPanel\">\n      <LevelLock\n        currentPlayer={currentPlayer}\n        masterXPLevels={masterXPLevels}\n        requiredLevel={carnivalRequiredLevel}\n        featureName=\"Carnival\"\n      >\n        {/* Check if player is in their home settlement */}\n        {(() => {\n          const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n          console.log(' Carnival access check:', {\n            currentSettlement: currentPlayer.location.s,\n            homeSettlement: currentPlayer.settlementId,\n            isInHomeSettlement\n          });\n          return !isInHomeSettlement;\n        })() ? (\n          <div style={{ textAlign: 'center', padding: '20px' }}>\n            <h2>{strings[1352] || \"This is not your home settlement.\"}</h2>\n          </div>\n        ) : isContentLoading ? (\n          <p>{strings[98]}</p>\n        ) : (\n          <>\n            <h3>{strings[1352]} {carnivalPhase} {currentCarnivalNumber ? `(#${currentCarnivalNumber})` : ''}</h3>\n            <h2 className=\"countdown-timer\"> {carnivalTimer}</h2>\n\n            {carnivalPhase === \"here\" && (\n              <>\n                {renderRewardSection()}\n                {renderOfferSection(strings[2009], claimedByYou)}\n                {renderOfferSection(strings[2010], available)}\n                {renderOfferSection(strings[2011], claimedByOthers)}\n                {renderOfferSection(strings[2012], completed)}\n              </>\n            )}\n\n            {allOrdersFilled && (\n              <div className=\"carnival-rewards-banner\">\n                {strings[2016]}\n              </div>\n            )}\n\n            {(carnivalPhase === \"here\" || carnivalPhase === \"departing\") && renderNextShipment()}\n\n            <div className=\"shared-buttons\" style={{ margin: '2px 0' }}>\n              <button className=\"btn-basic btn-neutral\" onClick={() => handleShowCarnivalLog()}>\n                {strings[1351]}\n              </button>\n            </div>\n          </>\n        )}\n      </LevelLock>\n    </Panel>\n    \n    {showLogicModal && (\n      <div className=\"carnival-logic-modal-overlay\">\n        <div className=\"carnival-logic-modal\">\n          <button \n            onClick={() => setShowLogicModal(false)}\n            className=\"carnival-logic-modal-close\"\n          >\n            \n          </button>\n          <h3>\n            Carnival #{logicModalData.carnivalNumber || '?'} Logic\n          </h3>\n          <pre>\n            {logicModalData.logic || 'No logic information available'}\n          </pre>\n        </div>\n      </div>\n    )}\n    </>\n  );\n}\n\nexport default CarnivalPanel;","import API_BASE from '../../config';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport LevelLock from '../../UI/Panels/LevelLock';\nimport Modal from '../../UI/Modals/Modal';\nimport axios from 'axios';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport './Courthouse.css';\nimport '../../UI/Panels/Panel.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { getMayorUsername } from './GovUtils';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\nimport { formatCountdown } from '../../UI/Timers';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { refreshPlayerAfterInventoryUpdate, canAfford, spendIngredients } from '../../Utils/InventoryManagement';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/Buttons/ResourceButton.css';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\nconst CourthousePanel = ({\n  onClose,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  setResources,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  isDeveloper,\n  masterResources,\n  masterSkills,\n  masterXPLevels,\n  updateStatus: updateStatusProp\n}) => {\n\n    const strings = useStrings();\n\n    // Get Courthouse level requirement from masterResources\n    const courthouseResource = masterResources?.find(r => r.type === 'Courthouse');\n    const courthouseRequiredLevel = courthouseResource?.level || 1;\n    const [settlement, setSettlement] = useState(null);\n    const [taxRate, setTaxRate] = useState(0);\n    const [isMayor, setIsMayor] = useState(false);\n    const [electionPhase, setElectionPhase] = useState('');\n    const [countdown, setCountdown] = useState('');\n    const { updateStatus: contextUpdateStatus } = useContext(StatusBarContext);\n    const updateStatus = updateStatusProp || contextUpdateStatus;\n    const [campaignPromises, setCampaignPromises] = useState([]);\n    const [newPromise, setNewPromise] = useState('');\n    const [selectedCandidate, setSelectedCandidate] = useState(null);\n    const [hasVoted, setHasVoted] = useState(false);\n    const [votedFor, setVotedFor] = useState('');\n    const [candidateList, setCandidateList] = useState([]);\n    const [tempTaxRate, setTempTaxRate] = useState(0); // Temporary UI state for the slider\n    const [hoveredCandidate, setHoveredCandidate] = useState(null);\n    const [tooltipPosition, setTooltipPosition] = useState({ x: 0, y: 0 });\n    const [tempSettlementName, setTempSettlementName] = useState('');\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [modalContent, setModalContent] = useState(null);\n    const [mayor, setMayor] = useState(\"\");\n    const [population, setPopulation] = useState(0);\n    \n    // Skills-related state\n    const [courthouseSkills, setCourthouseSkills] = useState([]);\n    const [ownedSkills, setOwnedSkills] = useState([]);\n    const [isLoadingSkills, setIsLoadingSkills] = useState(false);\n\n    \n    const handleViewElectionLog = async () => {\n        if (!currentPlayer?.settlementId) {\n          console.warn(\" Cannot show election log: settlementId missing.\");\n          return;\n        }\n\n        console.log(\" Show Election Log clicked\");\n        console.log(\" Fetching election log for settlement:\", currentPlayer.settlementId);\n\n        try {\n          const response = await axios.get(`${API_BASE}/api/settlement/${currentPlayer.settlementId}/electionlog`);\n          console.log(\" Election log API response:\", response.data);\n\n          const electionlog = response.data.electionlog || [];\n\n          const electionLogTable = (\n            <table className=\"election-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n              <thead>\n                <tr>\n                  <th style={{ padding: \"6px 12px\" }}>Date</th>\n                  <th style={{ padding: \"6px 12px\" }}>Candidates</th>\n                  <th style={{ padding: \"6px 12px\" }}>Elected Mayor</th>\n                </tr>\n              </thead>\n              <tbody>\n                {[...electionlog].reverse().map((entry, i) => (\n                  <tr key={i}>\n                    <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                    <td style={{ padding: \"6px 12px\" }}>\n                      {entry.candidates?.length > 0 ? (\n                        entry.candidates.map((c, j) => (\n                          <div key={j}>{c.username}: {c.votes} votes</div>\n                        ))\n                      ) : (\n                        <em>No candidates</em>\n                      )}\n                    </td>\n                    <td style={{ padding: \"6px 12px\" }}>{entry.electedmayor || 'None'}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          );\n\n          setModalContent({\n            title: \"Recent Election Results\",\n            size: \"large\",\n            message: electionlog.length === 0\n              ? \"No election results recorded yet.\"\n              : undefined,\n            custom: electionLogTable,\n          });\n          setIsModalOpen(true);\n        } catch (error) {\n          console.error(\" Failed to fetch election log:\", error);\n          setModalContent({\n            title: \"Error\",\n            message: \"Failed to load election log.\",\n            size: \"small\",\n          });\n          setIsModalOpen(true);\n        }\n    };\n\n    // Effect for initial data load only\n    useEffect(() => {\n        fetchElectionData();\n    }, [currentPlayer.settlementId]);\n\n    // Combined countdown and phase monitor effect\n    useEffect(() => {\n        const updateTimerAndPhase = () => {\n            const now = Date.now();\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            const electionData = storedTimers.elections || {};\n            \n            // Update phase first\n            const newPhase = electionData.phase || \"Administration\";\n            if (newPhase !== electionPhase) {\n                console.log(\" Election phase changing to:\", newPhase);\n                setElectionPhase(newPhase);\n            }\n\n            // Then update countdown using shared formatCountdown function\n            const endTime = electionData.endTime;\n            if (!endTime || isNaN(endTime)) {\n                setCountdown(\"N/A\");\n                return;\n            }\n\n            setCountdown(formatCountdown(endTime, now));\n        };\n\n        updateTimerAndPhase(); // Initial run\n        const interval = setInterval(updateTimerAndPhase, 1000);\n        return () => clearInterval(interval);\n    }, []); // No dependencies needed\n\n    // Effect to fetch fresh data on phase changes\n    useEffect(() => {\n        console.log(\" Phase changed to:\", electionPhase);\n        if (electionPhase === \"Counting\") {\n            setCampaignPromises([]);\n            setCandidateList([]);\n        }\n        fetchElectionData();\n    }, [electionPhase]);\n\n    // Effect to fetch skills for Courthouse\n    useEffect(() => {\n        const fetchSkills = async () => {\n            if (!masterResources || !currentPlayer) return;\n            \n            setIsLoadingSkills(true);\n            try {\n                // Fetch player's owned skills\n                const skillsResponse = await axios.get(`${API_BASE}/api/skills/${currentPlayer.playerId}`);\n                const serverSkills = skillsResponse.data.skills || [];\n                \n                // Filter for actual skills owned\n                const owned = serverSkills.filter(skill =>\n                    masterResources.some(res => res.type === skill.type && res.category === 'skill')\n                );\n                setOwnedSkills(owned);\n\n                // Filter for skills available at Courthouse\n                const availableSkills = masterResources.filter(\n                    res => res.category === 'skill' &&\n                    res.source === 'Courthouse' &&\n                    !owned.some(o => o.type === res.type)\n                );\n                setCourthouseSkills(availableSkills);\n                \n            } catch (error) {\n                console.error('Error fetching skills:', error);\n            } finally {\n                setIsLoadingSkills(false);\n            }\n        };\n        \n        fetchSkills();\n    }, [masterResources, currentPlayer?.playerId]);\n\n    const fetchElectionData = async () => {\n        try {\n            const settlementResponse = await axios.get(\n                `${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`\n            );\n            const settlementData = settlementResponse.data;\n            \n            setSettlement(settlementData);\n            setTaxRate(settlementData.taxrate || 0);\n            setTempTaxRate(settlementData.taxrate || 0);\n            setCampaignPromises(settlementData.campaignPromises || []);\n            setTempSettlementName(settlementData.displayName || '');\n            \n            // Update mayor status\n            const mayorRole = settlementData.roles.find(role => role.roleName === 'Mayor');\n            setIsMayor(mayorRole && mayorRole.playerId.toString() === currentPlayer._id.toString());\n            \n            // Fetch mayor username\n            const mayorName = await getMayorUsername(currentPlayer.settlementId);\n            setMayor(mayorName);\n            \n            // Calculate population\n            const populationCount = calculateSettlementPopulation(settlementData);\n            setPopulation(populationCount);\n\n            // Always reset hasVoted and votedFor before checking\n            setHasVoted(false);\n            setVotedFor('');\n            if (settlementData.votes) {\n                const playerVote = settlementData.votes.find(v => String(v.voterId) === String(currentPlayer._id));\n                if (playerVote) {\n                    setHasVoted(true);\n                    const votedCandidate = settlementData.campaignPromises?.find(p => \n                        String(p.playerId) === String(playerVote.candidateId)\n                    );\n                    setVotedFor(votedCandidate?.username || 'Unknown');\n                }\n            }\n\n            // Only update candidates list if in voting phase and haven't voted\n            if (electionPhase === \"Voting\" && !hasVoted) {\n                const uniqueCandidates = settlementData.campaignPromises?.reduce((acc, promise) => {\n                    if (!acc.find((c) => c.playerId === promise.playerId)) {\n                        acc.push({ playerId: promise.playerId, username: promise.username });\n                    }\n                    return acc;\n                }, []) || [];\n                setCandidateList(uniqueCandidates);\n            }\n        } catch (error) {\n            console.error(' Error fetching election data:', error);\n        }\n    };\n    \n    // Helper function to check if player has required skill\n    const hasRequiredSkill = (requiredType) => {\n        if (!requiredType) return true;\n        return ownedSkills.some(owned => owned.type === requiredType);\n    };\n    \n    // Handle skill purchase\n    const handlePurchaseSkill = async (resourceType) => {\n        const resource = masterResources.find(r => r.type === resourceType);\n        if (!resource) return;\n        \n        // Check if player meets requirements\n        if (resource.requires && !hasRequiredSkill(resource.requires)) {\n            updateStatus(strings[465] || 'You need the required skill first.');\n            return;\n        }\n        \n        // Spend ingredients\n        const spendSuccess = await spendIngredients({\n            playerId: currentPlayer.playerId,\n            recipe: resource,\n            inventory,\n            backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n        });\n        \n        if (!spendSuccess) {\n            console.warn('Failed to spend ingredients.');\n            return;\n        }\n        \n        // Add the new skill\n        const updatedSkills = [...ownedSkills];\n        updatedSkills.push({ type: resource.type, category: resource.category, quantity: 1 });\n        setOwnedSkills(updatedSkills);\n        updateStatus(` ${getLocalizedString(resource.type, strings)} skill acquired.`);\n        \n        try { \n            await axios.post(`${API_BASE}/api/update-skills`, {\n                playerId: currentPlayer.playerId,\n                skills: updatedSkills,\n            });\n            await trackQuestProgress(currentPlayer, 'Acquire', resource.type, 1, setCurrentPlayer);\n            await earnTrophy(currentPlayer.playerId, 'Skill Builder', 1, currentPlayer, null, setCurrentPlayer);    \n            await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n            \n            // Update the skills list locally\n            setCourthouseSkills(prev => prev.filter(skill => skill.type !== resource.type));\n        } catch (error) {\n            console.error('Error updating player on server:', error);\n            updateStatus('Error updating player on server.');\n        }\n    };\n\n    const handleAddCampaignPromise = async () => {\n        if (!newPromise.trim()) return;\n        if (newPromise.length > 200) {\n            updateStatus('Campaign promises cannot exceed 200 characters.');\n            return;\n        }\n        try {\n            const response = await axios.post(`${API_BASE}/api/save-campaign-promise`, {\n                settlementId: currentPlayer.settlementId,\n                playerId: currentPlayer._id,\n                username: currentPlayer.username,\n                text: newPromise,\n            });\n\n            if (response.data.message) {\n                console.log(` ${response.data.message}`);\n                updateStatus(' Campaign promise submitted.');\n                setCampaignPromises(response.data.campaignPromises);\n                setNewPromise('');\n            }\n        } catch (error) {\n            console.error(' Error submitting campaign promise:', error);\n            updateStatus(' Failed to submit campaign promise.');\n        }\n    };\n\n    const handleVote = async () => {\n        if (!selectedCandidate) return;\n\n        try {\n            const response = await axios.post(`${API_BASE}/api/cast-vote`, {\n                settlementId: currentPlayer.settlementId,\n                voterId: currentPlayer._id,\n                candidateId: selectedCandidate,\n            });\n\n            if (response.data.message) {\n                console.log(` ${response.data.message}`);\n                updateStatus(' Vote successfully cast.');\n                setHasVoted(true);\n                // Store the username of the voted candidate\n                const votedCandidate = candidateList.find(c => c.playerId === selectedCandidate);\n                setVotedFor(votedCandidate?.username || 'Unknown');\n                await trackQuestProgress(currentPlayer, 'Vote', 'Election', 1);\n                fetchElectionData();\n            }\n        } catch (error) {\n            console.error(' Error casting vote:', error);\n            if (error.response.data.error === \"Already voted.\") {\n                updateStatus(' You already voted.');\n            } else {\n                updateStatus(' Failed to cast vote.');\n            }\n        }\n    };\n\n    const handleSaveTaxRate = async () => {\n        if (!isMayor) return;\n    \n        try {\n            console.log(` Saving new tax rate: ${tempTaxRate}%`);\n    \n            const response = await axios.post(`${API_BASE}/api/update-settlement`, {\n                settlementId: currentPlayer.settlementId,\n                updates: { taxrate: tempTaxRate }, //  Save the new tax rate\n            });\n    \n            if (response.data.success) {\n                console.log(` Tax rate updated successfully.`);\n                updateStatus(` Tax rate set to ${tempTaxRate}%`);\n                //  Sync stored tax rate with UI slider\n                setTaxRate(tempTaxRate);\n            } else {\n                console.error(` Failed to update tax rate:`, response.data.error);\n                updateStatus(\" Error updating tax rate.\");\n            }\n        } catch (error) {\n            console.error(' Error saving tax rate:', error);\n            updateStatus(\" Failed to save tax rate.\");\n        }\n    };\n\n    const handleSaveSettlementName = async () => {\n        if (!isMayor || !tempSettlementName.trim()) return;\n\n        try {\n            const response = await axios.post(`${API_BASE}/api/update-settlement`, {\n                settlementId: currentPlayer.settlementId,\n                updates: { displayName: tempSettlementName } // Changed from name to displayName\n            });\n\n            if (response.data.success) {\n                updateStatus(`Settlement renamed to ${tempSettlementName}`);\n                setSettlement(prev => ({ ...prev, displayName: tempSettlementName }));\n            } else {\n                updateStatus(\" Error updating settlement name.\");\n            }\n        } catch (error) {\n            console.error(' Error saving settlement name:', error);\n            updateStatus(\" Failed to save settlement name.\");\n        }\n    };\n\n    const getCandidatePromise = (candidateId) => {\n        return campaignPromises.find(promise => \n            promise.playerId === candidateId\n        )?.text || \"No campaign promise made.\";\n    };\n\n    const handleSellStation = async (transactionId, transactionKey) => {\n        await handleProtectedSelling({\n            currentPlayer,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            setResources,\n            stationType: 'Courthouse',\n            currentStationPosition,\n            gridId,\n            TILE_SIZE,\n            updateStatus,\n            onClose,\n            devOnly: true,\n        });\n    };\n\n    console.log(\"hasVoted:\", hasVoted);\n    console.log(\"electionPhase:\", electionPhase);\n\n\n\n\n    return (\n        <Panel onClose={onClose} descriptionKey=\"1012\" titleKey=\"1112\" panelName=\"Courthouse\">\n            <LevelLock\n                currentPlayer={currentPlayer}\n                masterXPLevels={masterXPLevels}\n                requiredLevel={courthouseRequiredLevel}\n                featureName=\"Courthouse\"\n            >\n            <div className=\"panel-content courthouse-panel\">\n            {/* Check if player is in their home settlement */}\n            {(() => {\n                const isInHomeSettlement = String(currentPlayer.location.s) === String(currentPlayer.settlementId);\n                console.log(' Courthouse access check:', {\n                    currentSettlement: currentPlayer.location.s,\n                    homeSettlement: currentPlayer.settlementId,\n                    isInHomeSettlement\n                });\n                return !isInHomeSettlement;\n            })() ? (\n                <div style={{ textAlign: 'center', padding: '20px' }}>\n                    <h3>{strings[2050] || \"This is not your home settlement.\"}</h3>\n                </div>\n            ) : (\n                <>\n\n                {/* Skills Section */}\n\n                {courthouseSkills.length > 0 && (\n                    <>\n                        <div className=\"skills-options\">\n                            {isLoadingSkills ? (\n                                <p>{strings[98] || \"Loading...\"}</p>\n                            ) : (\n                                courthouseSkills.map((resource) => {\n                                    const affordable = canAfford(resource, inventory, backpack, 1);\n                                    const meetsRequirement = hasRequiredSkill(resource.requires);\n\n                                    const formattedCosts = [1, 2, 3, 4].map((i) => {\n                                        const type = resource[`ingredient${i}`];\n                                        const qty = resource[`ingredient${i}qty`];\n                                        if (!type || !qty) return '';\n\n                                        const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                                        const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                                        const playerQty = inventoryQty + backpackQty;\n                                        const color = playerQty >= qty ? 'green' : 'red';\n                                        const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                                        return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n                                    }).join('');\n\n                                    const skillColor = meetsRequirement ? 'green' : 'red';\n                                    const details =\n                                        (resource.requires ? `<span style=\"color: ${skillColor};\">${strings[460] || \"Requires:\"} ${getLocalizedString(resource.requires, strings)}</span><br>` : '') +\n                                        `${strings[461] || \"Cost:\"}<div>${formattedCosts}</div>`;\n\n                                    // Check if this skill modifies a player attribute\n                                    const attributeModifier = resource.output\n                                        ? `+${resource.qtycollected || 1} to ${strings[resource.output] || resource.output}`\n                                        : null;\n\n                                    // Check if this skill provides a collection buff\n                                    let buffText = '';\n                                    const buffedItems = masterSkills?.[resource.type];\n                                    if (buffedItems && typeof buffedItems === 'object') {\n                                        const items = Object.keys(buffedItems);\n                                        if (items.length > 0) {\n                                            const prettyList = items.join(', ');\n                                            buffText = `Collection multiplied: ${prettyList}`;\n                                        }\n                                    }\n\n                                    const unlocks = masterResources\n                                        .filter((res) => res.requires === resource.type)\n                                        .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                                        .join(', ') || 'None';\n\n                                    const info = (\n                                        <div className=\"info-content\">\n                                            {attributeModifier && <div>{attributeModifier}</div>}\n                                            {unlocks !== 'None' && (\n                                                <div style={{ display: 'block', marginBottom: '3px' }}>\n                                                    <strong>Unlocks:</strong> {unlocks}\n                                                </div>\n                                            )}\n                                            {buffText && <div style={{ color: 'blue' }}>{buffText}</div>}\n                                        </div>\n                                    );\n\n                                    return (\n                                        <ResourceButton\n                                            key={resource.type}\n                                            symbol={resource.symbol}\n                                            name={getLocalizedString(resource.type, strings)}\n                                            details={details}\n                                            info={info}\n                                            disabled={!affordable || !meetsRequirement}\n                                            onClick={() => handlePurchaseSkill(resource.type)}\n                                            resource={resource}\n                                            inventory={inventory}\n                                            backpack={backpack}\n                                            masterResources={masterResources}\n                                            currentPlayer={currentPlayer}\n                                        />\n                                    );\n                                })\n                            )}\n                        </div>\n                        <hr className=\"inventory-divider\" />\n                    </>\n                )}\n                \n                {isMayor && <h2>{strings[2080]}</h2>}\n                \n                <div className=\"debug-buttons\">\n\n\n{/* Settlement name section */}\n                    <h3>{strings[2082]}</h3>\n                    {isMayor ? (\n                        <div className=\"settlement-name-editor\">\n                            <input\n                                type=\"text\"\n                                value={tempSettlementName}\n                                onChange={(e) => setTempSettlementName(e.target.value)}\n                                placeholder={strings[2081]}\n                            />\n                            <div className=\"shared-buttons\" style={{ display: 'inline-block', marginLeft: '8px' }}>\n                                <button \n                                    className=\"btn-basic btn-success btn-modal-small\" \n                                    onClick={handleSaveSettlementName}\n                                    disabled={!tempSettlementName.trim()}\n                                    style={{ width: 'auto' }}\n                                >\n                                    {strings[2083]}\n                                </button>\n                            </div>\n                        </div>\n                    ) : (\n                        <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{settlement?.displayName || 'Unnamed'}</strong></h2>\n                    )}\n \n{/* POPULATION section */}\n                    <h3>{strings[\"3002\"]} <strong>{population}</strong></h3>\n\n{/* TAX RATE section */} \n \n                    <h3>{strings[2041]} {taxRate}%</h3>\n\n{/* MAYOR Tax section */} \n\n                    {isMayor && (\n                        <div className=\"tax-rate-editor\">\n                            <input\n                                type=\"range\" min=\"0\" max=\"20\" value={tempTaxRate}\n                                onChange={(e) => setTempTaxRate(Number(e.target.value))}\n                            />\n                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '8px' }}>\n                            <span style={{ flex: 1 }}>{strings[2042]} {tempTaxRate}%</span>\n                            <button\n                                className=\"btn-basic btn-success btn-modal-small\"\n                                onClick={handleSaveTaxRate}\n                                style={{\n                                width: 'auto',\n                                maxWidth: '100px',\n                                flexShrink: 0\n                                }}\n                            >\n                                {strings[\"2043\"]}\n                            </button>\n                            </div>\n                        </div>\n                    )}\n\n{/* CURRENT MAYOR section - only show if player is not the mayor */}\n\n<br></br>\n                    {!isMayor && (\n                        <>\n                            <h3>{strings[2085]}</h3>\n                            <h2 style={{ color: 'rgb(154, 106, 22)' }}><strong>{mayor || \"Vacant\"}</strong></h2>\n                        </>\n                    )}\n\n                    {!isMayor && <h2>{strings[2079]}</h2>}\n\n                    <p>{strings[2084]}</p>\n\n\n{/* ELECTIONS section */} \n\n<br></br>\n                    <h3>{strings[2045]}</h3>\n\n                    <h3><strong>\n                        {electionPhase === \"Counting\" && strings[\"2062\"]}\n                        {electionPhase === \"Voting\" && strings[\"2061\"]}\n                        {electionPhase === \"Campaigning\" && strings[\"2060\"]}\n                        {electionPhase === \"Administration\" && strings[\"2063\"]}\n                    </strong> {\"  \"} {countdown}</h3>\n                    <br></br>\n                    \n{/*  Campaigning Phase */}\n\n                    {electionPhase === \"Campaigning\" && (\n                        <>\n                            <h3>{strings[2048]}</h3>\n                            \n                            {/*  Scrollable List of Promises */}\n                            <div className=\"campaign-promises\">\n                                {campaignPromises.length > 0 ? (\n                                    campaignPromises.map((promise, index) => (\n                                        <div key={index} className=\"campaign-entry\">\n                                            <strong>{promise.username}:</strong> {promise.text}\n                                        </div>\n                                    ))\n                                ) : (\n                                    <p>{strings[2071]}</p>\n                                )}\n                            </div>\n\n                            {/*  Player Can Submit a Promise */}\n                            {!campaignPromises.some(p => p.playerId === currentPlayer._id) && (\n                                <>\n                                    <textarea\n                                        value={newPromise}\n                                        onChange={(e) => setNewPromise(e.target.value)}\n                                        placeholder={strings[2072]}\n                                    />\n                                    <div className=\"shared-buttons\">\n                                        <button className=\"btn-basic btn-success\" onClick={handleAddCampaignPromise}>{strings[2073]}</button>\n                                    </div>\n                                </>\n                            )}\n                        </>\n                    )}\n\n{/* Voting Phase UI */}\n                    {electionPhase === 'Voting' && (\n                        <div className=\"voting-section\">\n                            {hasVoted ? (\n                                <p>{strings[2077]}</p>\n                            ) : candidateList.length > 0 ? (\n                                <>\n                                    <h3>{strings[2074]}</h3>\n                                    {candidateList.map((candidate, index) => (\n                                        <div \n                                            key={candidate.playerId || index}\n                                            className=\"candidate-row\"\n                                            onMouseEnter={(e) => {\n                                                setHoveredCandidate(candidate.playerId);\n                                                setTooltipPosition({\n                                                    x: e.clientX + 10,\n                                                    y: e.clientY - 40\n                                                });\n                                            }}\n                                            onMouseLeave={() => setHoveredCandidate(null)}\n                                        >\n                                            <input \n                                                type=\"radio\" \n                                                name=\"vote\" \n                                                value={candidate.playerId}\n                                                onChange={() => {\n                                                    setSelectedCandidate(candidate.playerId);\n                                                }}\n                                            />\n                                            <div style={{ marginLeft: '10px' }}>\n                                                <strong>{candidate.username}</strong>\n                                                <div style={{ fontSize: '0.9em', color: '#666', marginTop: '4px' }}>\n                                                    \"{getCandidatePromise(candidate.playerId)}\"\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                    <div className=\"shared-buttons\">\n                                        <button \n                                            className=\"btn-basic btn-success\"\n                                            onClick={handleVote} \n                                            disabled={!selectedCandidate}\n                                        >\n                                            {strings[2074]}\n                                        </button>\n                                    </div>\n\n                                    {/* Tooltip */}\n                                    {hoveredCandidate && (\n                                        <div \n                                            className=\"candidate-tooltip\"\n                                            style={{\n                                                left: tooltipPosition.x,\n                                                top: tooltipPosition.y,\n                                            }}\n                                        >\n                                            <strong>{strings[2076]}</strong><br />\n                                            \"{getCandidatePromise(hoveredCandidate)}\"\n                                        </div>\n                                    )}\n                                </>\n                            ) : (\n                                <p>{strings[2078]}</p>\n                            )}\n\n\n                            {/*  Extra message if no one ran */}\n                            {candidateList.length === 0 && (\n                                <p><em>No one ran for mayor this election cycle.</em></p>\n                            )}\n                            \n                        </div>\n                    )}\n        <div className=\"shared-buttons\"><button className=\"btn-basic btn-success\" onClick={handleViewElectionLog}>Recent Election Results</button></div>\n                </div>\n                </>\n            )}\n\n            {isDeveloper && (\n                <div className=\"station-panel-footer\">\n                    <div className=\"shared-buttons\">\n                        <TransactionButton \n                            className=\"btn-basic btn-danger\" \n                            onAction={handleSellStation}\n                            transactionKey={`sell-refund-Courthouse-${currentStationPosition?.x}-${currentStationPosition?.y}-${gridId}`}\n                        >\n                            {strings[425] || \"Sell for Refund\"}\n                        </TransactionButton>\n                    </div>\n                </div>\n            )}\n            </div>\n            {isModalOpen && (\n                <Modal\n                    isOpen={isModalOpen}\n                    onClose={() => setIsModalOpen(false)}\n                    title={modalContent?.title}\n                    size={modalContent?.size}\n                    message={modalContent?.message}\n                    custom={modalContent?.custom}\n                />\n            )}\n            </LevelLock>\n        </Panel>\n    );\n};\n\nexport default CourthousePanel;","/**\n * Economy utility functions for gem costs and calculations\n */\n\n/**\n * Calculate gem cost for speeding up crafting based on remaining time\n * @param {number} remainingTimeMs - Remaining time in milliseconds\n * @returns {number} - Number of gems required\n */\nexport function calculateGemSpeedupCost(remainingTimeMs) {\n  if (remainingTimeMs <= 0) return 0;\n  \n  const remainingMinutes = remainingTimeMs / (1000 * 60);\n  \n  // Use formula: gem cost = (remainingMinutes)^0.45\n  // This gives approximately:\n  // - 40 minutes  ~5 gems\n  // - 100 minutes  ~8 gems\n  const gemCost = Math.ceil(Math.pow(remainingMinutes, 0.45));\n  \n  return gemCost;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport '../../UI/Buttons/ResourceButton.css';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { calculateGemSpeedupCost } from '../../Economy/EconomyUtils';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { canAfford, calculateSkillMultiplier, applySkillMultiplier } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport { formatSingleCollection } from '../../UI/StatusBar/CollectionFormatters';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { getMayorUsername } from '../Government/GovUtils';\nimport './ScrollStation.css'; // Import for shared station panel styles\n\nconst CraftingStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  resources,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  TILE_SIZE,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n}) => {\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n  const [stationRefreshKey, setStationRefreshKey] = useState(0);\n  const [isMayor, setIsMayor] = useState(false);\n\n   //  Check for active crafting timers\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n\n    console.log(' Checking GlobalGridStateTilesAndResources for active crafting timers...');\n    \n    const station = GlobalGridStateTilesAndResources.getResources()?.find(\n      (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n    );\n\n    if (station && station.craftEnd) {\n        \n        setCraftedItem(station.craftedItem);\n        setIsCrafting(true);\n        setActiveTimer(true);  //  Ensure UI treats this as an active timer\n\n        const updateCountdown = () => {\n          const remainingTime = Math.max(0, Math.floor((station.craftEnd - Date.now()) / 1000));\n          setCraftingCountdown(remainingTime);\n\n          if (remainingTime === 0) {\n              console.log(' Crafting complete! Ready to collect.');\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n          }\n      };\n\n        updateCountdown();\n        const timer = setInterval(updateCountdown, 1000);\n        return () => clearInterval(timer);\n    } else {\n        console.log(' No active crafting timer found.');\n        setCraftedItem(null);\n        setIsCrafting(false);\n        setIsReadyToCollect(false);\n        setCraftingCountdown(null);\n        setActiveTimer(false);\n    }\n  }, [stationType, currentStationPosition, GlobalGridStateTilesAndResources.getResources(), craftingCountdown]); //  Ensure state triggers re-render\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => {\n        // Check if resource source matches station type\n        if (resource.source !== stationType) return false;\n        \n        // Check seasonal restriction\n        if (resource.season && currentSeason && resource.season !== currentSeason) {\n          return false;\n        }\n        \n        return true;\n      });\n      \n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n  // Check if player is mayor for town building selling permissions\n  useEffect(() => {\n    const checkMayorStatus = async () => {\n      let isPlayerMayor = false;\n      if (currentPlayer?.location?.gtype === 'town' && currentPlayer?.location?.s) {\n        try {\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n        } catch (error) {\n          console.error('Error checking mayor status:', error);\n        }\n      }\n      setIsMayor(isPlayerMayor);\n    };\n\n    if (currentPlayer) {\n      checkMayorStatus();\n    }\n  }, [currentPlayer?.location?.s, currentPlayer?.username]);\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Protected function to start crafting using transaction system\n  const handleCraft = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected craft for ${recipe.type}`);\n    console.log('Current station state:', { craftedItem, isCrafting, isReadyToCollect, craftingCountdown });\n    setErrorMessage('');\n    \n    if (!recipe) { \n      setErrorMessage('Invalid recipe selected.'); \n      return; \n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update only the specific station resource in global state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state immediately\n        setCraftedItem(craftedItem);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        FloatingTextManager.addFloatingText(404, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        updateStatus(`${strings[440]} ${getLocalizedString(recipe.type, strings)}`);\n\n        console.log(` ${recipe.type} crafting started using protected endpoint.`);\n      }\n    } catch (error) {\n      console.error('Error in protected crafting start:', error);\n      if (error.response?.status === 429) {\n        updateStatus(451);\n      } else if (error.response?.status === 400) {\n        updateStatus(450);\n      } else {\n        updateStatus(452);\n      }\n    }\n  };\n\n\n  // Protected function to collect crafted items using transaction system\n  const handleCollect = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected collection for ${recipe.type}`);\n    \n    if (!recipe) { \n      console.error(\" No valid crafted item to collect.\"); \n      return; \n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { collectedItem, isNPC, inventory, updatedStation } = response.data;\n\n        //  Apply skill buffs to crafted collection (station-based)\n        console.log('MasterSkills:', masterSkills);\n        console.log('Station Type:', stationType);\n\n        // Use shared skill calculation utility\n        const skillInfo = calculateSkillMultiplier(stationType, currentPlayer.skills || [], masterSkills);\n\n        // Apply multiplier to quantity (default to 1 if not provided by backend)\n        const baseQtyCollected = 1;\n        const finalQtyCollected = applySkillMultiplier(baseQtyCollected, skillInfo.multiplier);\n\n        console.log('[DEBUG] qtyCollected after multiplier:', finalQtyCollected);\n\n        // Handle NPC spawning client-side\n        if (isNPC) {\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: currentStationPosition.x, y: currentStationPosition.y });\n            // Trigger refresh to update available recipes\n            setNpcRefreshKey(prev => prev + 1);\n          }\n          // Show floating text for NPCs immediately since they don't need inventory space\n          FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        } else {\n          // Only add non-NPC items to inventory\n          // Update inventory with buffed quantity\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: finalQtyCollected,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          // Check if gainIngredients failed (returns object with success: false, or falsy value)\n          if (gained !== true && (!gained || gained.success === false)) {\n            console.error(' Failed to add buffed crafted item to inventory.');\n            return; // Exit early - don't clear crafting state if we couldn't collect\n          }\n          \n          // Show floating text only after successful collection\n          FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        }\n\n        // Only clear crafting state if we successfully collected (or it's an NPC)\n        \n        // Track quest progress for all crafted items (both NPCs and regular items)\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, finalQtyCollected, setCurrentPlayer);\n\n        // Update grid resources to remove crafting state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n\n        // Force a refresh of the station state\n        setStationRefreshKey(prev => prev + 1);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Use shared formatter for status message\n        const statusMessage = formatSingleCollection('craft', collectedItem, finalQtyCollected, \n          skillInfo.hasSkills ? skillInfo : null, strings, getLocalizedString);\n        updateStatus(statusMessage);\n\n        console.log(`${recipe.type} collected successfully using protected endpoint.`);\n      }\n    } catch (error) {\n      console.error('Error in protected crafting collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect item');\n      }\n    }\n  };\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    // Mayor can sell town buildings, homestead owners can sell at home\n    const isTownMayorSelling = stationDetails?.source === 'BuildTown' && currentPlayer.location.gtype === 'town' && isMayor;\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: !isHomestead && !isTownMayorSelling, // Only verify developer status when NOT on homestead and NOT mayor selling town building\n    });\n  };\n\n  // Handle gem speedup for crafting\n  const handleGemSpeedup = async (recipe) => {\n    if (!isCrafting || !craftingCountdown) {\n      console.error(' No active crafting to speed up');\n      return;\n    }\n\n    const remainingTimeMs = craftingCountdown * 1000;\n    const gemCost = calculateGemSpeedupCost(remainingTimeMs);\n    \n    // Check if player has enough gems\n    const currentGems = (currentPlayer.inventory?.find(item => item.type === 'Gem')?.quantity || 0) +\n                       (currentPlayer.backpack?.find(item => item.type === 'Gem')?.quantity || 0);\n    \n    if (currentGems < gemCost) {\n      updateStatus(`Need ${gemCost} gems to speed up crafting`);\n      return;\n    }\n\n    try {\n      // Spend gems to complete crafting instantly\n      const spentResult = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          ingredient1: 'Gem',\n          ingredient1qty: gemCost,\n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spentResult) {\n        console.error(' Failed to spend gems for speedup');\n        return;\n      }\n\n      // Update the station in the database to mark crafting as complete\n      const updateResponse = await updateGridResource(\n        gridId,\n        {\n          type: stationType,\n          x: currentStationPosition.x,\n          y: currentStationPosition.y,\n          craftEnd: Date.now(), // Set to current time to complete immediately\n          craftedItem\n        },\n        true\n      );\n\n      if (updateResponse?.success) {\n        // Update global state to reflect the database change\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: Date.now(), craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftingCountdown(0);\n        setIsCrafting(false);\n        setIsReadyToCollect(true);\n\n        updateStatus(`Used ${gemCost} gems to complete crafting instantly`);\n        FloatingTextManager.addFloatingText(`-${gemCost} `, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        console.log(` Crafting completed instantly using ${gemCost} gems`);\n      } else {\n        throw new Error('Failed to update crafting station in database');\n      }\n    } catch (error) {\n      console.error(' Error in gem speedup:', error);\n      updateStatus(' Failed to speed up crafting');\n    }\n  };\n\n  // Handle gem purchase for instant crafting\n  const handleGemPurchase = async (modifiedRecipe) => {\n    console.log(' [GEM DEBUG] handleGemPurchase called with:', modifiedRecipe);\n    \n    // This is called by the gem button with a recipe modified to include gems\n    // First spend the ingredients (including gems)\n    const spendSuccess = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: modifiedRecipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendSuccess) {\n      console.warn('Failed to spend ingredients for gem purchase.');\n      return;\n    }\n    \n    console.log(' [GEM DEBUG] Ingredients spent successfully');\n\n    // For regular crafting items, add them to inventory immediately\n    const craftedResource = allResources.find(res => res.type === modifiedRecipe.type);\n    if (craftedResource) {\n      // Add the item to inventory\n      const gained = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: modifiedRecipe.type,\n        quantity: 1,\n        inventory: currentPlayer.inventory,\n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Check if gainIngredients succeeded (returns true on success, object with success: false on failure)\n      if (gained === true || (gained && gained.success === true)) {\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Craft', modifiedRecipe.type, 1, setCurrentPlayer);\n        \n        // Update status and effects\n        updateStatus(` ${getLocalizedString(modifiedRecipe.type, strings)} crafted instantly!`);\n        FloatingTextManager.addFloatingText(`+1 ${getLocalizedString(modifiedRecipe.type, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      } else {\n        updateStatus(' Failed to add crafted item to inventory');\n      }\n    } else {\n      updateStatus('Gem purchase not supported for this item type');\n    }\n  };\n  \n  // Generate skill bonus message\n  const getSkillBonusMessage = () => {\n    // Find all skills that apply to this station\n    const applicableSkills = Object.entries(masterSkills || {})\n      .filter(([skillName, stations]) => {\n        return stations && typeof stations === 'object' && stations[stationType] > 1;\n      })\n      .map(([skillName, stations]) => ({\n        skillName,\n        multiplier: stations[stationType],\n        hasSkill: currentPlayer.skills?.some(item => item.type === skillName)\n      }));\n    \n    if (applicableSkills.length === 0) return null;\n    \n    // Separate owned and unowned skills\n    const ownedSkills = applicableSkills.filter(skill => skill.hasSkill);\n    const unownedSkills = applicableSkills.filter(skill => !skill.hasSkill);\n    \n    // Calculate combined multiplier for owned skills\n    const combinedMultiplier = ownedSkills.reduce((total, skill) => total * skill.multiplier, 1);\n    \n    let messages = [];\n    \n    // Message for owned skills\n    if (ownedSkills.length > 0) {\n      if (ownedSkills.length === 1) {\n        // Single skill: \"Your [skill] Skill increases the base output of this station by [X].\"\n        messages.push(`${strings[805]}${getLocalizedString(ownedSkills[0].skillName, strings)}${strings[806]}${ownedSkills[0].multiplier}x.`);\n      } else {\n        // Multiple skills: list them with their multipliers and show combined effect\n        const skillsList = ownedSkills\n          .map(skill => `${getLocalizedString(skill.skillName, strings)} (${skill.multiplier}x)`)\n          .join(' & ');\n        messages.push(`Your ${skillsList} skills combine to increase output by ${combinedMultiplier}x.`);\n      }\n    }\n    \n    // Message for unowned skills\n    if (unownedSkills.length > 0) {\n      unownedSkills.forEach(skill => {\n        const skillResource = allResources.find(res => res.type === skill.skillName);\n        const skillSource = skillResource?.source || 'Skill Shop';\n        // \"Acquire the [skill] Skill at the [source] to increase the output of this station by [X]x.\"\n        messages.push(`${strings[801]}${getLocalizedString(skill.skillName, strings)}${strings[802]}${getLocalizedString(skillSource, strings)}${strings[803]}${skill.multiplier}x.`);\n      });\n    }\n    \n    return messages.join(' ');\n  };\n\n  const skillMessage = getSkillBonusMessage();\n\n  // Count hospitals on the current grid\n  const countHospitals = () => {\n    if (!resources || !allResources) return 0;\n    \n    return resources.filter(resource => {\n      // Find the master resource to check if it's a Hospital\n      const masterResource = allResources.find(mr => mr.type === resource.type);\n      return masterResource && masterResource.type === 'Hospital';\n    }).length;\n  };\n\n  // Count existing healers on the current grid\n  const countHealers = () => {\n    const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n    if (!npcsInGrid) return 0;\n    \n    return Object.values(npcsInGrid).filter(npc => npc && npc.action === 'heal').length;\n  };\n\n  // Calculate maximum healers allowed based on hospitals and doctorsPerHospital setting\n  const getMaxHealersAllowed = () => {\n    const hospitalCount = countHospitals();\n    const doctorsPerHospital = globalTuning?.doctorsPerHospital || 1; // Default to 1 if not set\n    return hospitalCount * doctorsPerHospital;\n  };\n\n  const currentHealers = countHealers();\n  const maxHealersAllowed = getMaxHealersAllowed();\n\n  return (\n    <Panel onClose={onClose} title={`${stationEmoji} ${getLocalizedString(stationType, strings)}`} panelName=\"CraftingStation\">\n      <div className=\"station-panel-container\">\n        {/* Check if Library or Hospital requires home settlement */}\n        {(stationType === 'Library' || stationType === 'Hospital') && \n         String(currentPlayer.location.s) !== String(currentPlayer.settlementId) ? (\n          <div style={{ textAlign: 'center', padding: '20px' }}>\n            <h2>{strings[2050] || \"This is not your home settlement. You cannot access community services in any settlement but your own.\"}</h2>\n          </div>\n        ) : (\n          <>\n            {skillMessage && (\n              <div className=\"station-panel-header\" style={{\n                padding: '10px',\n                backgroundColor: 'var(--color-bg-light)',\n                borderRadius: '5px',\n                fontStyle: 'italic',\n                marginBottom: '10px'\n              }}>\n                {skillMessage}\n              </div>\n            )}\n            <div className=\"station-panel-content\">\n        \n          {recipes?.length > 0 ? (\n            recipes.map((recipe) => {\n              const ingredients = getIngredientDetails(recipe, allResources || []);\n              const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n              const requirementsMet = hasRequiredSkill(recipe.requires);\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const isCrafting = craftedItem === recipe.type && craftingCountdown > 0;\n              const isReadyToCollect = craftedItem === recipe.type && craftingCountdown === 0;\n              \n              // Check if this is a healer and if we've hit the hospital capacity limit\n              const isHealer = recipe.action === 'heal';\n              const healerLimitReached = isHealer && currentHealers >= maxHealersAllowed;\n              \n              // Calculate gem speedup cost for this crafting item\n              // craftingCountdown is already in seconds, so we don't multiply by 1000\n              const gemSpeedupCost = isCrafting ? calculateGemSpeedupCost(craftingCountdown * 1000) : 0;\n\n              \n              const craftTimeText = isCrafting\n              ? `${strings[441]} ${formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}`\n              : isReadyToCollect\n              ? strings[457] \n              : recipe.crafttime\n              ? `${strings[458]} ${formatDuration(recipe.crafttime)}`\n              : strings[459];\n              \n              const info = (\n                <div className=\"info-content\">\n                  <div>\n                    <strong>{strings[421]}</strong>{' '}\n                    {allResources\n                      .filter((res) =>\n                        [res.ingredient1, res.ingredient2, res.ingredient3, res.ingredient4].includes(recipe.type)\n                      )\n                      .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                      .join(', ') || 'None'}\n                  </div>\n                  <div><strong>{strings[422]}</strong>  {recipe.minprice || 'n/a'}</div>\n                  {/* Show healer maxhp info for Hospital buildings with healer NPCs */}\n                  {stationType === 'Hospital' && recipe.action === 'heal' && (\n                    <div><strong>{strings[51]}</strong> {recipe.maxhp || 'n/a'}</div>\n                  )}\n                </div>\n              );\n              \n              // Format costs with color per ingredient (now using display: block and no <br>)\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  className={`resource-button ${isCrafting ? 'in-progress' : isReadyToCollect ? 'ready btn-sell' : ''}`}\n                  details={\n                    isCrafting ? craftTimeText :\n                    (\n                      (healerLimitReached ? `<span style=\"color: red;\">${strings[408]}</span><br>` : '') +\n                      (recipe.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(recipe.requires, strings)}</span><br>` : '') +\n                      `${craftTimeText}<br>` +\n                      (isReadyToCollect ? '' : `${strings[461]}<div>${formattedCosts}</div>`)\n                    )\n                  }\n                  info={info}\n                  disabled={!isReadyToCollect && (craftedItem !== null || !affordable || !requirementsMet || healerLimitReached)}\n                  onClick={undefined} // Remove direct onClick since we're using transaction mode\n                  // Transaction mode props for both craft start and collect\n                  isTransactionMode={true}\n                  transactionKey={isReadyToCollect ? \n                    `crafting-collect-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}` : \n                    `crafting-start-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}`}\n                  onTransactionAction={isReadyToCollect ? \n                    (transactionId, transactionKey) => handleCollect(transactionId, transactionKey, recipe) :\n                    (transactionId, transactionKey) => handleCraft(transactionId, transactionKey, recipe)}\n                  // Gem purchase props (for instant purchase) or speedup props (for active crafting)\n                  gemCost={isCrafting ? gemSpeedupCost : null}\n                  onGemPurchase={isCrafting ? \n                    () => handleGemSpeedup(recipe) : \n                    ((recipe.gemcost && (!affordable || !requirementsMet) && craftedItem === null && !healerLimitReached) ? handleGemPurchase : null)}\n                  resource={isCrafting ? { \n                    type: 'CraftingSpeedup', \n                    gemcost: gemSpeedupCost // Main gem cost, no ingredients\n                  } : recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                  // Hide gem button logic:\n                  // - If ready to collect: hide\n                  // - If this item is crafting: show speedup button\n                  // - If another item is crafting: hide\n                  // - If nothing is crafting and no gem cost: hide\n                  // - If nothing is crafting and has gem cost: show purchase button\n                  // - If healer limit reached: hide\n                  hideGem={isReadyToCollect || \n                           (!isCrafting && craftedItem !== null) || \n                           (!isCrafting && !recipe.gemcost) ||\n                           healerLimitReached}\n                >\n                </ResourceButton>\n              );\n            })\n          ) : <p>{strings[424]}</p>}\n\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n        \n            {(currentPlayer.location.gtype === 'homestead' || \n              isDeveloper || \n              (stationDetails?.source === 'BuildTown' && currentPlayer.location.gtype === 'town' && isMayor)) && (\n              <div className=\"station-panel-footer\">\n                <div className=\"shared-buttons\">\n                  <TransactionButton \n                    className=\"btn-basic btn-success\" \n                    onAction={handleSellStation}\n                    transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n                  >\n                    {strings[425]}\n                  </TransactionButton>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(CraftingStation);","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport '../../UI/Buttons/ResourceButton.css';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport { calculateGemSpeedupCost } from '../../Economy/EconomyUtils';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { createCollectEffect } from '../../VFX/VFX';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport '../../UI/Buttons/SharedButtons.css';\nimport workerPlacementData from './WorkerPlacement.json';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\n\nconst FarmHouse = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  globalTuning,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n\n   //  Check for active crafting timers\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n    \n    const station = GlobalGridStateTilesAndResources.getResources()?.find(\n      (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n    );\n\n    if (station && station.craftEnd) {\n        console.log(` Active crafting found: ${station.craftedItem} until ${new Date(station.craftEnd).toLocaleTimeString()}`);\n        \n        setCraftedItem(station.craftedItem);\n        setIsCrafting(true);\n        setActiveTimer(true);  //  Ensure UI treats this as an active timer\n\n        const updateCountdown = () => {\n          const remainingTime = Math.max(0, Math.floor((station.craftEnd - Date.now()) / 1000));\n          setCraftingCountdown(remainingTime);\n\n          if (remainingTime === 0) {\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n          }\n      };\n\n        updateCountdown();\n        const timer = setInterval(updateCountdown, 1000);\n        return () => clearInterval(timer);\n    } else {\n        console.log(' No active crafting timer found.');\n        setCraftedItem(null);\n        setIsCrafting(false);\n        setIsReadyToCollect(false);\n        setCraftingCountdown(null);\n        setActiveTimer(false);\n    }\n  }, [stationType, currentStationPosition, GlobalGridStateTilesAndResources.getResources(), craftingCountdown]); //  Ensure state triggers re-render\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => resource.source === stationType);\n\n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);\n        \n        console.log('Existing NPC types on grid:', existingNPCTypes);\n        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n\n\n  // Protected function to start crafting using transaction system\n  const handleCraft = async (transactionId, transactionKey, recipe) => {\n    console.log(` [PROTECTED CRAFTING] Starting protected craft for ${recipe.type}`);\n    setErrorMessage('');\n    \n    if (!recipe) { \n      setErrorMessage('Invalid recipe selected.'); \n      return; \n    }\n\n    try {\n      const payload = {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe,\n        transactionId,\n        transactionKey,\n        // Add flag to indicate if this is a gem purchase (ingredients already paid)\n        isGemPurchase: transactionKey && transactionKey.includes('crafting-gem-')\n      };\n      \n      console.log(' [CRAFT DEBUG] Sending to server:', payload);\n      \n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, payload);\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update only the specific station resource in global state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state immediately\n        setCraftedItem(craftedItem);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        FloatingTextManager.addFloatingText(404, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        updateStatus(`${strings[440]} ${getLocalizedString(recipe.type, strings)}`);\n\n      }\n    } catch (error) {\n      console.error('Error in protected crafting start:', error);\n      console.error('Error response data:', error.response?.data);\n      if (error.response?.status === 429) {\n        updateStatus(451);\n      } else if (error.response?.status === 400) {\n        updateStatus(450);\n      } else {\n        updateStatus(452);\n      }\n    }\n  };\n\n\n  // Protected function to collect crafted items using transaction system\n  const handleCollect = async (transactionId, transactionKey, recipe) => {\n    \n    if (!recipe) { console.error(\" No valid crafted item to collect.\"); return; }\n\n    console.log(' [COLLECT DEBUG] Starting collection:', {\n      craftedItem,\n      recipeType: recipe?.type,\n      ftuestep: currentPlayer.ftuestep,\n      firsttimeuser: currentPlayer.firsttimeuser,\n      stationType\n    });\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { collectedItem, isNPC, inventory, updatedStation } = response.data;\n        \n        console.log(' [COLLECT DEBUG] Server response:', {\n          collectedItem,\n          isNPC,\n          hasInventory: !!inventory\n        });\n\n        //  Apply skill buffs to crafted collection\n        console.log('MasterSkills:', masterSkills);\n\n        // Extract player skills\n        const playerBuffs = (currentPlayer.skills || [])\n          .filter((item) => {\n            const resourceDetails = allResources.find((res) => res.type === item.type);\n            const isSkill = resourceDetails?.category === 'skill';\n            const appliesToResource = (masterSkills?.[item.type]?.[collectedItem] || 1) > 1;\n            return isSkill && appliesToResource;\n          })\n          .map((buffItem) => buffItem.type);\n\n        // Calculate skill multiplier\n        const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n          const buffValue = masterSkills?.[buff]?.[collectedItem] || 1;\n          return multiplier * buffValue;\n        }, 1);\n\n        // Apply multiplier to quantity (default to 1 if not provided by backend)\n        const baseQtyCollected = 1;\n        const finalQtyCollected = baseQtyCollected * skillMultiplier;\n\n        console.log('[DEBUG] qtyCollected after multiplier:', finalQtyCollected);\n        FloatingTextManager.addFloatingText(`+${finalQtyCollected} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n\n        // Handle NPC spawning client-side\n        if (isNPC) {\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            // Get placement offset from WorkerPlacement.json\n            const placementData = workerPlacementData.find(data => data.workerType === collectedItem);\n            const offsetX = placementData?.offsetX || 0;\n            const offsetY = placementData?.offsetY || 0;\n            \n            const spawnPosition = {\n              x: currentStationPosition.x + offsetX,\n              y: currentStationPosition.y + offsetY\n            };\n            \n            console.log(`Spawning ${collectedItem} at offset (${offsetX}, ${offsetY}) from Farm House, final position: (${spawnPosition.x}, ${spawnPosition.y})`);\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, spawnPosition);\n            \n            // Check for First Farm Worker trophy\n            if (craftedResource.action === 'worker') {\n              await earnTrophy(currentPlayer.playerId, 'First Farm Worker', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n            }\n            \n            // Trigger refresh to update available recipes\n            setNpcRefreshKey(prev => prev + 1);\n          }\n        } else {\n          // Only add non-NPC items to inventory\n          // Update inventory with buffed quantity\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: finalQtyCollected,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          if (!gained) {\n            console.error(' Failed to add buffed crafted item to inventory.');\n          }\n        }\n\n        // Track quest progress for all crafted items (both NPCs and regular items)\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, finalQtyCollected, setCurrentPlayer);\n        // Update grid resources to remove crafting state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      }\n    } catch (error) {\n      console.error('Error in protected crafting collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(454);\n      }\n    }\n  };\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: true, // Developer-only action\n    });\n  };\n\n  // Handle gem speedup for crafting\n  const handleGemSpeedup = async (recipe) => {\n    if (!isCrafting || !craftingCountdown) {\n      console.error(' No active crafting to speed up');\n      return;\n    }\n\n    const remainingTimeMs = craftingCountdown * 1000;\n    const gemCost = calculateGemSpeedupCost(remainingTimeMs);\n    \n    // Check if player has enough gems\n    const currentGems = (currentPlayer.inventory?.find(item => item.type === 'Gem')?.quantity || 0) +\n                       (currentPlayer.backpack?.find(item => item.type === 'Gem')?.quantity || 0);\n    \n    if (currentGems < gemCost) {\n      updateStatus(`Need ${gemCost} gems to speed up crafting`);\n      return;\n    }\n\n    try {\n      // Spend gems to complete crafting instantly\n      const spentResult = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: { \n          ingredient1: 'Gem',\n          ingredient1qty: gemCost,\n        },\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!spentResult) {\n        console.error(' Failed to spend gems for speedup');\n        return;\n      }\n\n      // Update the station in the database to mark crafting as complete\n      const updateResponse = await updateGridResource(\n        gridId,\n        {\n          type: stationType,\n          x: currentStationPosition.x,\n          y: currentStationPosition.y,\n          craftEnd: Date.now(), // Set to current time to complete immediately\n          craftedItem\n        },\n        true\n      );\n\n      if (updateResponse?.success) {\n        // Update global state to reflect the database change\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: Date.now(), craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftingCountdown(0);\n        setIsCrafting(false);\n        setIsReadyToCollect(true);\n\n        updateStatus(`Used ${gemCost} gems to complete crafting instantly`);\n        FloatingTextManager.addFloatingText(`-${gemCost} `, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        \n        console.log(` Crafting completed instantly using ${gemCost} gems`);\n      } else {\n        throw new Error('Failed to update crafting station in database');\n      }\n    } catch (error) {\n      console.error(' Error in gem speedup:', error);\n      updateStatus(' Failed to speed up crafting');\n    }\n  };\n  \n  // Handle gem purchase\n  const handleGemPurchase = async (modifiedRecipe) => {\n    console.log(' [GEM DEBUG] handleGemPurchase called with:', modifiedRecipe);\n    \n    // This is called by the gem button with a recipe modified to include gems\n    // First spend the ingredients (including gems)\n    const spendSuccess = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: modifiedRecipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spendSuccess) {\n      console.warn('Failed to spend ingredients for gem purchase.');\n      return;\n    }\n    \n    console.log(' [GEM DEBUG] Ingredients spent successfully');\n\n    // For gem purchases with NPCs, spawn them immediately\n    const craftedResource = allResources.find(res => res.type === modifiedRecipe.type);\n    if (craftedResource && craftedResource.category === 'npc') {\n      // Get placement offset from WorkerPlacement.json\n      const placementData = workerPlacementData.find(data => data.workerType === modifiedRecipe.type);\n      const offsetX = placementData?.offsetX || 0;\n      const offsetY = placementData?.offsetY || 0;\n      \n      const spawnPosition = {\n        x: currentStationPosition.x + offsetX,\n        y: currentStationPosition.y + offsetY\n      };\n      \n      console.log(`Spawning ${modifiedRecipe.type} at offset (${offsetX}, ${offsetY}) from Farm House`);\n      NPCsInGridManager.spawnNPC(gridId, craftedResource, spawnPosition);\n      \n      // Check for First Farm Worker trophy\n      if (craftedResource.action === 'worker') {\n        await earnTrophy(currentPlayer.playerId, 'First Farm Worker', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      }\n      \n      // Track quest progress\n      await trackQuestProgress(currentPlayer, 'Craft', modifiedRecipe.type, 1, setCurrentPlayer);\n      \n      \n      // Update status and effects\n      updateStatus(` ${getLocalizedString(modifiedRecipe.type, strings)} hired instantly!`);\n      FloatingTextManager.addFloatingText(`+1 ${getLocalizedString(modifiedRecipe.type, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n      \n      // Trigger refresh\n      setNpcRefreshKey(prev => prev + 1);\n      \n      // Refresh player data\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    } else {\n      // For non-NPC items, we would need different handling\n      updateStatus('Gem purchase not supported for this item type');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1032\" titleKey=\"1132\" panelName=\"FarmHouse\">\n      <div className=\"standard-panel\">\n        \n          {recipes?.length > 0 ? (\n            recipes.map((recipe) => {\n              const ingredients = getIngredientDetails(recipe, allResources || []);\n              const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n              const requirementsMet = hasRequiredSkill(recipe.requires);\n              const skillColor = requirementsMet ? 'green' : 'red';\n              const isCrafting = craftedItem === recipe.type && craftingCountdown > 0;\n              const isReadyToCollect = craftedItem === recipe.type && craftingCountdown === 0;\n              \n              // Calculate gem speedup cost for this crafting item\n              const remainingTimeMs = isCrafting ? craftingCountdown * 1000 : 0;\n              const gemSpeedupCost = isCrafting ? calculateGemSpeedupCost(remainingTimeMs) : 0;\n\n              \n              const craftTimeText = isCrafting\n              ? `${strings[441]} ${formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}`\n              : isReadyToCollect\n              ? strings[457] \n              : recipe.crafttime\n              ? `${strings[458]} ${formatDuration(recipe.crafttime)}`\n              : strings[459];\n              \n              // Custom tooltips for workers\n              let info;\n              if (recipe.type === 'Farm Hand') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[350]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Rancher') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[351]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Lumberjack') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[352]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Crafter') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[353]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'Kent') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[354]}</div>\n                  </div>\n                );\n              } else if (recipe.type === 'The Shepherd') {\n                info = (\n                  <div className=\"info-content\">\n                    <div>{strings[355]}</div>\n                  </div>\n                );\n              } else {\n                // Default info for non-worker recipes\n                info = (\n                  <div className=\"info-content\">\n                    <div>\n                      <strong>{strings[421]}</strong>{' '}\n                      {allResources\n                        .filter((res) =>\n                          [res.ingredient1, res.ingredient2, res.ingredient3, res.ingredient4].includes(recipe.type)\n                        )\n                        .map((res) => `${res.symbol || ''} ${getLocalizedString(res.type, strings)}`)\n                        .join(', ') || 'None'}\n                    </div>\n                    <div><strong>{strings[422]}</strong>  {recipe.minprice || 'n/a'}</div>\n                  </div>\n                );\n              }\n              \n              // Format costs with color per ingredient (now using display: block and no <br>)\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n\n                const inventoryQty = inventory?.find(item => item.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = allResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${getLocalizedString(type, strings)} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={getLocalizedString(recipe.type, strings)}\n                  className={`resource-button ${isCrafting ? 'in-progress' : isReadyToCollect ? 'ready btn-sell' : ''}`}\n                  details={\n                    isCrafting ? craftTimeText :\n                    (\n                      (recipe.requires ? `<span style=\"color: ${skillColor};\">${strings[460]}${getLocalizedString(recipe.requires, strings)}</span><br>` : '') +\n                      `${craftTimeText}<br>` +\n                      (isReadyToCollect ? '' : `${strings[461]}<div>${formattedCosts}</div>`)\n                    )\n                  }\n                  info={info}\n                  disabled={!isReadyToCollect && (craftedItem !== null || !affordable || !requirementsMet)}\n                  onClick={undefined} // Remove direct onClick since we're using transaction mode\n                  // Transaction mode props for both craft start and collect\n                  isTransactionMode={true}\n                  transactionKey={isReadyToCollect ? \n                    `crafting-collect-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}` : \n                    `crafting-start-${recipe.type}-${currentStationPosition.x}-${currentStationPosition.y}`}\n                  onTransactionAction={isReadyToCollect ? \n                    (transactionId, transactionKey) => handleCollect(transactionId, transactionKey, recipe) :\n                    (transactionId, transactionKey) => handleCraft(transactionId, transactionKey, recipe)}\n                  // Gem purchase props (for instant purchase) or speedup props (for active crafting)\n                  gemCost={isCrafting ? gemSpeedupCost : null}\n                  onGemPurchase={isCrafting ? \n                    () => handleGemSpeedup(recipe) : \n                    ((recipe.gemcost && (!affordable || !requirementsMet) && craftedItem === null) ? handleGemPurchase : null)}\n                  resource={isCrafting ? { \n                    type: 'CraftingSpeedup', \n                    gemcost: gemSpeedupCost // Main gem cost, no ingredients\n                  } : recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources || allResources}\n                  currentPlayer={currentPlayer}\n                  // Hide gem button logic:\n                  // - If ready to collect: hide\n                  // - If this item is crafting: show speedup button\n                  // - If another item is crafting: hide\n                  // - If nothing is crafting and no gem cost: hide\n                  // - If nothing is crafting and has gem cost: show purchase button\n                  hideGem={isReadyToCollect || \n                           (!isCrafting && craftedItem !== null) || \n                           (!isCrafting && !recipe.gemcost)}\n                >\n                </ResourceButton>\n              );\n            })\n          ) : <p>{strings[456]}</p>}\n\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n        {(isDeveloper) && (\n          <>\n            <hr />\n              <div className=\"shared-buttons\">\n                <TransactionButton \n                  className=\"btn-basic btn-danger\" \n                  onAction={handleSellStation}\n                  transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n                >\n                  {strings[490]}\n                </TransactionButton>\n              </div>\n\n          </>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(FarmHouse);","import React, { useState, useEffect } from 'react';\nimport Modal from './Modal';\nimport './ProgressModal.css';\n\nfunction ProgressModal({ isOpen, title, message }) {\n  const [frame, setFrame] = useState(0);\n  const hourglassFrames = ['', ''];\n  \n  useEffect(() => {\n    if (!isOpen) {\n      setFrame(0);\n      return;\n    }\n    \n    // Animate hourglass every 500ms\n    const timer = setInterval(() => {\n      setFrame(prev => (prev + 1) % hourglassFrames.length);\n    }, 500);\n    \n    return () => clearInterval(timer);\n  }, [isOpen]);\n  \n  if (!isOpen) return null;\n  \n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={() => {}} // No close button during operation\n      title={title}\n      size=\"small\"\n      className=\"progress-modal\"\n    >\n      <div className=\"progress-modal-content\">\n        <div className=\"progress-message\">{message}</div>\n        \n        <div className=\"progress-hourglass\">\n          {hourglassFrames[frame]}\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default ProgressModal;","import React, { createContext, useContext, useState } from 'react';\n\nconst NPCOverlayContext = createContext();\n\nexport const NPCOverlayProvider = ({ children }) => {\n  // Map of npcId -> { overlay: 'hourglass'|'exclamation'|'attack'|etc, clickable: boolean }\n  const [npcOverlays, setNpcOverlays] = useState({});\n  \n  const setNPCOverlay = (npcId, overlayType, clickable = true) => {\n    console.log(` NPC ${npcId}: ${overlayType ? `setting overlay '${overlayType}'` : 'clearing overlay'} (clickable: ${clickable})`);\n    setNpcOverlays(prev => ({\n      ...prev,\n      [npcId]: overlayType ? { overlay: overlayType, clickable } : undefined\n    }));\n  };\n  \n  const clearNPCOverlay = (npcId) => {\n    setNPCOverlay(npcId, null);\n  };\n  \n  const getNPCOverlay = (npcId) => {\n    return npcOverlays[npcId];\n  };\n  \n  // Helper methods for common overlay types\n  const setBusyOverlay = (npcId) => setNPCOverlay(npcId, 'hourglass', false);\n  const setQuestOverlay = (npcId) => setNPCOverlay(npcId, 'exclamation', true);\n  const setAttackOverlay = (npcId) => setNPCOverlay(npcId, 'attack', true);\n  \n  return (\n    <NPCOverlayContext.Provider value={{ \n      npcOverlays,\n      setNPCOverlay,\n      clearNPCOverlay,\n      getNPCOverlay,\n      setBusyOverlay,\n      setQuestOverlay,\n      setAttackOverlay\n    }}>\n      {children}\n    </NPCOverlayContext.Provider>\n  );\n};\n\nexport const useNPCOverlay = () => useContext(NPCOverlayContext);","import React, { useState } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport Modal from '../../UI/Modals/Modal';\nimport { calculateBulkHarvestCapacity, buildBulkHarvestOperations } from './BulkHarvestUtils';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { calculateBulkWarehouseDrops, aggregateWarehouseDrops } from '../../Utils/WarehouseMaterials';\nimport { gainIngredients } from '../../Utils/InventoryManagement';\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\nimport '../../UI/Buttons/SharedButtons.css';\n\n// Component for the bulk harvest selection modal\nexport function BulkHarvestModal({ \n  isOpen, \n  onClose, \n  crops, \n  getFreshCrops,\n  onExecute,\n  showBulkReplant,\n  hasRequiredSkill,\n  strings,\n  currentSeason,\n  masterResources\n}) {\n  const [selectedCropTypes, setSelectedCropTypes] = useState({});\n  const [selectedReplantTypes, setSelectedReplantTypes] = useState({});\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && crops.length > 0) {\n      // Select all crops by default\n      const defaultSelection = {};\n      crops.forEach(crop => {\n        defaultSelection[crop.type] = true;\n      });\n      setSelectedCropTypes(defaultSelection);\n      \n      // Select replant options if available\n      if (showBulkReplant) {\n        const defaultReplantSelection = {};\n        crops.forEach(crop => {\n          // Repeatable crops are always selected for replant (auto-replant for free)\n          if (crop.repeatable) {\n            defaultReplantSelection[crop.type] = true;\n            return;\n          }\n\n          // Check if player has required skill\n          const hasSkill = hasRequiredSkill(crop.replantRequires);\n\n          // Check if crop is in season\n          let isInSeason = true;\n          if (currentSeason && masterResources) {\n            const farmplot = masterResources.find(r =>\n              r.category === 'farmplot' && r.output === crop.type\n            );\n            if (farmplot && farmplot.season) {\n              isInSeason = farmplot.season === currentSeason;\n            }\n          }\n\n          if (hasSkill && isInSeason) {\n            defaultReplantSelection[crop.type] = true;\n          }\n        });\n        setSelectedReplantTypes(defaultReplantSelection);\n      }\n    }\n  }, [isOpen, crops, showBulkReplant, hasRequiredSkill, currentSeason, masterResources]);\n\n  const handleToggleCrop = (cropType) => {\n    // Find if this crop is repeatable\n    const crop = crops.find(c => c.type === cropType);\n    const isRepeatable = crop?.repeatable === true;\n\n    setSelectedCropTypes(prev => {\n      const newValue = !prev[cropType];\n      // If unchecking harvest, also uncheck replant\n      if (!newValue) {\n        setSelectedReplantTypes(replantPrev => ({\n          ...replantPrev,\n          [cropType]: false\n        }));\n      } else if (isRepeatable) {\n        // If checking harvest for repeatable crop, auto-check replant\n        setSelectedReplantTypes(replantPrev => ({\n          ...replantPrev,\n          [cropType]: true\n        }));\n      }\n      return {\n        ...prev,\n        [cropType]: newValue\n      };\n    });\n  };\n\n  const handleToggleReplant = (cropType) => {\n    // Find if this crop is repeatable - repeatable crops cannot be toggled\n    const crop = crops.find(c => c.type === cropType);\n    if (crop?.repeatable === true) {\n      return; // Cannot toggle repeatable crops\n    }\n\n    setSelectedReplantTypes(prev => {\n      const newValue = !prev[cropType];\n      // If checking replant, also check harvest\n      if (newValue) {\n        setSelectedCropTypes(cropPrev => ({\n          ...cropPrev,\n          [cropType]: true\n        }));\n      }\n      return {\n        ...prev,\n        [cropType]: newValue\n      };\n    });\n  };\n\n  const handleExecute = async () => {\n    if (isProcessing) return;\n\n    setIsProcessing(true);\n    try {\n      // If getFreshCrops is provided, validate selections against fresh data\n      if (getFreshCrops) {\n        const freshCrops = await getFreshCrops();\n\n        // Filter selections to only include crops that still exist\n        const validCropTypes = {};\n        const validReplantTypes = {};\n\n        freshCrops.forEach(crop => {\n          if (selectedCropTypes[crop.type]) {\n            validCropTypes[crop.type] = true;\n            // For repeatable crops, include in replant if being harvested\n            if (crop.repeatable) {\n              validReplantTypes[crop.type] = true;\n            } else if (selectedReplantTypes[crop.type]) {\n              validReplantTypes[crop.type] = true;\n            }\n          }\n        });\n\n        onExecute(validCropTypes, validReplantTypes);\n      } else {\n        // For repeatable crops, include in replant only if being harvested\n        const finalReplantTypes = { ...selectedReplantTypes };\n        crops.forEach(crop => {\n          if (crop.repeatable && selectedCropTypes[crop.type]) {\n            finalReplantTypes[crop.type] = true;\n          }\n        });\n        onExecute(selectedCropTypes, finalReplantTypes);\n      }\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[315] || \"Select Crops to Harvest\"} size=\"medium\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>\n        <div style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px' }}>\n            <button\n              className=\"btn-basic btn-success btn-modal-small\"\n              onClick={() => {\n                const allSelected = {};\n                const repeatableReplants = {};\n                crops.forEach(crop => {\n                  allSelected[crop.type] = true;\n                  // Auto-check replant for repeatable crops when selecting all harvests\n                  if (crop.repeatable) {\n                    repeatableReplants[crop.type] = true;\n                  }\n                });\n                setSelectedCropTypes(allSelected);\n                setSelectedReplantTypes(prev => ({ ...prev, ...repeatableReplants }));\n              }}\n            >\n              {strings[316] || 'Select All'}\n            </button>\n            <button\n              className=\"btn-basic btn-neutral btn-modal-small\"\n              onClick={() => {\n                setSelectedCropTypes({});\n                // When deselecting all harvest, also deselect all replant (including repeatable)\n                setSelectedReplantTypes({});\n              }}\n            >\n              {strings[317] || 'Deselect All'}\n            </button>\n          </div>\n          \n          {showBulkReplant && (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', marginLeft: 'auto' }}>\n              <button\n                className=\"btn-basic btn-success btn-modal-small\"\n                onClick={() => {\n                  const allReplantSelected = {};\n                  const allHarvestSelected = {};\n                  crops.forEach(crop => {\n                    // Repeatable crops: keep replant checked if harvest is checked\n                    if (crop.repeatable) {\n                      if (selectedCropTypes[crop.type]) {\n                        allReplantSelected[crop.type] = true;\n                      }\n                      allHarvestSelected[crop.type] = selectedCropTypes[crop.type] || false;\n                      return;\n                    }\n\n                    // Check if player has required skill\n                    const hasSkill = hasRequiredSkill(crop.replantRequires);\n\n                    // Check if crop is in season\n                    let isInSeason = true;\n                    if (currentSeason && masterResources) {\n                      const farmplot = masterResources.find(r =>\n                        r.category === 'farmplot' && r.output === crop.type\n                      );\n                      if (farmplot && farmplot.season) {\n                        isInSeason = farmplot.season === currentSeason;\n                      }\n                    }\n\n                    if (hasSkill && isInSeason) {\n                      allReplantSelected[crop.type] = true;\n                      // When selecting replant, also select harvest\n                      allHarvestSelected[crop.type] = true;\n                    } else {\n                      // Keep existing harvest selection for crops that can't be replanted\n                      allHarvestSelected[crop.type] = selectedCropTypes[crop.type] || false;\n                    }\n                  });\n                  setSelectedReplantTypes(allReplantSelected);\n                  setSelectedCropTypes(prev => ({\n                    ...prev,\n                    ...allHarvestSelected\n                  }));\n                }}\n              >\n                {strings[316] || 'Select All'}\n              </button>\n              <button\n                className=\"btn-basic btn-neutral btn-modal-small\"\n                onClick={() => {\n                  // Keep repeatable crops selected only if they're being harvested\n                  const keepRepeatable = {};\n                  crops.forEach(crop => {\n                    if (crop.repeatable && selectedCropTypes[crop.type]) {\n                      keepRepeatable[crop.type] = true;\n                    }\n                  });\n                  setSelectedReplantTypes(keepRepeatable);\n                }}\n              >\n                {strings[317] || 'Deselect All'}\n              </button>\n            </div>\n          )}\n        </div>\n        \n        {showBulkReplant && (\n          <div style={{ display: 'flex', marginBottom: '10px', fontSize: '14px', fontWeight: 'bold' }}>\n            <div style={{ width: '30px', paddingLeft: '5px' }}>{strings[342] || 'Harvest?'}</div>\n            <div style={{ flex: 1 }}></div>\n            <div style={{ width: '140px', textAlign: 'center' }}>{strings[343] || 'Replant?'}</div>\n          </div>\n        )}\n        \n        <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n          {crops.map(crop => {\n            // Check if player has required skill\n            const hasSkill = hasRequiredSkill(crop.replantRequires);\n            \n            // Check if crop is in season\n            let isInSeason = true;\n            if (currentSeason && masterResources) {\n              // Find the farmplot that produces this crop to check its season\n              const farmplot = masterResources.find(r => \n                r.category === 'farmplot' && r.output === crop.type\n              );\n              if (farmplot && farmplot.season) {\n                isInSeason = farmplot.season === currentSeason;\n              }\n            }\n            \n            const canReplant = hasSkill && isInSeason;\n            const isRepeatable = crop.repeatable === true;\n            // Repeatable crops follow harvest state and cannot be manually toggled\n            const replantChecked = selectedReplantTypes[crop.type] || false;\n            const replantDisabled = isRepeatable || !canReplant;\n\n            return (\n              <div key={crop.type} style={{ display: 'flex', alignItems: 'center', marginBottom: '8px', padding: '5px', borderBottom: '1px solid #eee' }}>\n                <div style={{ width: '30px' }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedCropTypes[crop.type] || false}\n                    onChange={() => handleToggleCrop(crop.type)}\n                    style={{ width: '20px' }}\n                  />\n                </div>\n                <div style={{ flex: 1, textAlign: 'left' }}>\n                  {crop.symbol} {getLocalizedString(crop.type, strings)} ({crop.count})\n                </div>\n                {showBulkReplant && (() => {\n                  return (\n                    <div style={{ marginLeft: '60px', width: '100px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                      {!isRepeatable && !isInSeason && (\n                        <span style={{ fontSize: '12px', color: '#888', marginRight: '5px' }}>off season</span>\n                      )}\n                      <input\n                        type=\"checkbox\"\n                        checked={replantChecked}\n                        onChange={() => !isRepeatable && canReplant && handleToggleReplant(crop.type)}\n                        disabled={replantDisabled}\n                        style={{\n                          width: '20px',\n                          opacity: canReplant ? 1 : 0.5,\n                          cursor: replantDisabled ? 'not-allowed' : 'pointer'\n                        }}\n                        title={isRepeatable ? 'Auto-replants for free' : (canReplant ? '' : (!isInSeason ? `${crop.type} is not available in current season` : `Requires ${crop.replantRequires || 'unknown skill'} to replant ${crop.type}`))}\n                      />\n                    </div>\n                  );\n                })()}\n              </div>\n            );\n          })}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className={`btn-basic ${isProcessing ? 'btn-neutral' : 'btn-success'} btn-modal`}\n            onClick={handleExecute}\n            disabled={isProcessing || Object.values(selectedCropTypes).every(selected => !selected)}\n          >\n            {isProcessing ? 'Processing...' : (strings[318] || 'Harvest Selected')}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk harvest\nexport async function executeBulkHarvest({\n  selectedCropTypes,\n  selectedReplantTypes,\n  resources,\n  masterResources,\n  masterSkills,\n  currentPlayer,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  setResources,\n  gridId,\n  showBulkReplant,\n  strings,\n  refreshPlayerAfterInventoryUpdate,\n  globalTuning\n}) {\n  // Get selected crop types\n  const selectedTypes = Object.keys(selectedCropTypes).filter(type => selectedCropTypes[type]);\n  \n  if (selectedTypes.length === 0) {\n    return { success: false, error: strings[449] || 'No crops selected for harvest.' };\n  }\n  \n  // Sync FarmState before proceeding to ensure client/server consistency\n  const farmState = await import('../../FarmState').then(m => m.default);\n  \n  await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n  \n  // Get fresh resources after initial sync\n  const GlobalGridStateTilesAndResources = await import('../../GridState/GlobalGridStateTilesAndResources').then(m => m.default);\n  let currentResources = GlobalGridStateTilesAndResources.getResources();\n  \n  // Find all farmplots that might still be converting to crops\n  const pendingFarmplots = currentResources.filter(res => {\n    if (res.category === 'farmplot' && res.growEnd) {\n      const now = Date.now();\n      return res.growEnd <= now; // Should have converted but might not be synced yet\n    }\n    return false;\n  });\n  \n  if (pendingFarmplots.length > 0) {\n    // Wait up to 5 seconds for conversions to complete\n    let attempts = 0;\n    const maxAttempts = 50;\n    \n    while (attempts < maxAttempts) {\n      await new Promise(resolve => setTimeout(resolve, 100));\n      attempts++;\n      \n      // Get fresh resources\n      currentResources = GlobalGridStateTilesAndResources.getResources();\n      \n      // Check if all pending farmplots have been converted\n      const stillPending = pendingFarmplots.filter(farmplot => {\n        const resourceAtPosition = currentResources.find(res => \n          res.x === farmplot.x && res.y === farmplot.y\n        );\n        \n        if (!resourceAtPosition) return false;\n        \n        if (resourceAtPosition.category === 'farmplot' && resourceAtPosition.growEnd) {\n          return true; // Still a farmplot waiting to convert\n        }\n        \n        return false;\n      });\n      \n      if (stillPending.length === 0) {\n        break;\n      }\n    }\n    \n    if (attempts === maxAttempts) {\n      // One more force sync attempt\n      await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n      await new Promise(resolve => setTimeout(resolve, 200));\n    }\n  }\n  \n  // Final sync to catch any last-minute conversions\n  await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n  await new Promise(resolve => setTimeout(resolve, 100));\n  \n  // Final resource fetch\n  const freshResources = GlobalGridStateTilesAndResources.getResources();\n  \n\n  // First, calculate capacity to check if we can harvest\n  const capacityCheck = await calculateBulkHarvestCapacity(\n    selectedTypes,\n    freshResources,  // Use the fresh resources we just validated\n    masterResources,\n    masterSkills,\n    currentPlayer,\n    globalTuning\n  );\n  \n\n  // Check if we have enough space\n  if (!capacityCheck.canHarvest) {\n    const spaceNeeded = capacityCheck.totalCapacityNeeded;\n    const spaceAvailable = capacityCheck.availableSpace;\n    return { \n      success: false, \n      error: `${strings[447] || 'Not enough space'}: ${spaceNeeded} needed, ${spaceAvailable} available` \n    };\n  }\n\n  // If replanting, check seeds\n  if (showBulkReplant && !capacityCheck.canReplantAll) {\n    const missingSeeds = Object.entries(capacityCheck.hasEnoughSeeds)\n      .filter(([_, data]) => !data.enough)\n      .map(([type, data]) => `${getLocalizedString(type, strings)}: ${data.needed - data.has} more needed`)\n      .join(', ');\n    \n    // Still proceed with harvest, but warn about replanting\n    console.log(` Not enough seeds for replanting: ${missingSeeds}`);\n  }\n\n  // Build operations for API call (pass masterResources to detect repeatable crops for free replant)\n  const operations = buildBulkHarvestOperations(capacityCheck, selectedReplantTypes, masterResources);\n  \n  // Generate transaction ID for idempotency\n  const transactionId = `bulk-harvest-${currentPlayer._id}-${Date.now()}`;\n  const transactionKey = `bulk-harvest-${gridId}`;\n\n  // Make the bulk harvest API call\n  try {\n    const response = await axios.post(`${API_BASE}/api/bulk-harvest`, {\n      playerId: currentPlayer._id,\n      gridId: gridId,\n      operations: operations,\n      transactionId: transactionId,\n      transactionKey: transactionKey\n    });\n\n\n    if (response.data.success) {\n      const results = response.data.results;\n    \n    // Update local inventory state\n    if (response.data.inventory) {\n      setInventory(response.data.inventory.warehouse || []);\n      setBackpack(response.data.inventory.backpack || []);\n      \n      // Update player state with new inventory\n      setCurrentPlayer(prev => ({\n        ...prev,\n        inventory: response.data.inventory.warehouse || [],\n        backpack: response.data.inventory.backpack || []\n      }));\n    }\n\n    // Remove harvested resources from local state\n    const harvestedPositions = new Set();\n    if (results.harvested) {\n      Object.values(results.harvested).forEach(data => {\n        if (data && data.positions && Array.isArray(data.positions)) {\n          data.positions.forEach(pos => harvestedPositions.add(`${pos.x},${pos.y}`));\n        }\n      });\n    }\n    \n    \n    const updatedResources = freshResources.filter(res => \n      !harvestedPositions.has(`${res.x},${res.y}`)\n    );\n    \n    // Add replanted resources\n    if (results.replanted) {\n      Object.entries(results.replanted).forEach(([cropType, data]) => {\n        \n        // Find the farmplot that produces this crop\n        const farmplot = masterResources.find(r => \n          r.category === 'farmplot' && r.output === cropType\n        );\n        \n        if (farmplot && data.positions && Array.isArray(data.positions)) {\n          data.positions.forEach((pos, index) => {\n            // Calculate growEnd from current time + growtime\n            // The server gives us growtime in seconds, but we need milliseconds\n            const growTimeMs = (data.growtime || farmplot.growtime || 300) * 1000;\n            const growEnd = Date.now() + growTimeMs;\n            \n            \n            // Create the farmplot resource with all necessary properties\n            updatedResources.push({\n              ...farmplot, // Include all properties from the farmplot template\n              x: pos.x,\n              y: pos.y,\n              type: farmplot.type, // This will be \"Wheat Plot\", not \"Wheat\"\n              growEnd: growEnd,\n              stage: 1,\n              category: 'farmplot', // Ensure category is set\n              output: farmplot.output // Ensure output is set for crop conversion\n            });\n          });\n        }\n      });\n    }\n    \n    GlobalGridStateTilesAndResources.setResources(updatedResources);\n    setResources(updatedResources);\n    \n    // Re-initialize FarmState with the updated resources\n    farmState.initializeFarmState(updatedResources);\n\n    // Calculate which skills were applied for each harvested type using shared utility\n    const harvestSkillsInfo = {};\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([cropType, data]) => {\n        if (data) {\n          const skillInfo = calculateSkillMultiplier(cropType, currentPlayer.skills || [], masterSkills);\n          if (skillInfo.hasSkills) {\n            harvestSkillsInfo[cropType] = skillInfo;\n          }\n        }\n      });\n    }\n    \n    // Transform harvest results to simple format for shared formatter\n    const harvestResults = {};\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (data && typeof data.quantity !== 'undefined') {\n          harvestResults[type] = data.quantity;\n        }\n      });\n    }\n    \n    \n    // Transform replant info\n    const replantInfo = {};\n    if (results.replanted) {\n      Object.entries(results.replanted).forEach(([type, data]) => {\n        replantInfo[type] = data.count;\n      });\n    }\n\n    // Calculate warehouse ingredient drops based on number of non-Wheat plots harvested (not skill-modified quantities)\n    // Exclude Wheat to prevent exploit\n    let numPlotsHarvestedExcludingWheat = 0;\n    if (results.harvested) {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (type !== 'Wheat' && data && data.positions && Array.isArray(data.positions)) {\n          numPlotsHarvestedExcludingWheat += data.positions.length;\n        }\n      });\n    }\n    \n    console.log(' Calculating warehouse drops for', numPlotsHarvestedExcludingWheat, 'non-Wheat plots harvested');\n    const warehouseDropsArray = calculateBulkWarehouseDrops(numPlotsHarvestedExcludingWheat, {\n      masterResources,\n      globalTuning,\n      selectWeightedRandomItem,\n      playerId: currentPlayer.playerId\n    });\n    \n    // Aggregate warehouse drops by type\n    const aggregatedWarehouseDrops = aggregateWarehouseDrops(warehouseDropsArray);\n    console.log(' Aggregated warehouse drops:', aggregatedWarehouseDrops);\n\n    // Add warehouse ingredients to inventory if any were found\n    if (warehouseDropsArray.length > 0) {\n      try {\n        for (const drop of warehouseDropsArray) {\n          const warehouseGained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: drop.type,\n            quantity: drop.quantity,\n            inventory: response.data.inventory?.warehouse || [],\n            backpack: response.data.inventory?.backpack || [],\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus: () => {}, // No status updates during bulk operation\n            masterResources,\n            globalTuning,\n          });\n\n          if (warehouseGained) {\n            console.log(` Added warehouse ingredient: ${drop.type} x${drop.quantity}`);\n            \n            // Track quest progress for warehouse ingredients\n            await trackQuestProgress(currentPlayer, 'Collect', drop.type, drop.quantity, setCurrentPlayer);\n          } else {\n            console.warn(` Failed to add warehouse ingredient: ${drop.type} x${drop.quantity} (inventory full?)`);\n          }\n        }\n      } catch (error) {\n        console.error(' Error adding warehouse ingredients to inventory:', error);\n      }\n    }\n\n    // Track quest progress for harvested items\n    if (results.harvested && typeof results.harvested === 'object') {\n      Object.entries(results.harvested).forEach(([type, data]) => {\n        if (data && data.quantity) {\n          trackQuestProgress({\n            questProgressCategory: 'collect',\n            itemName: type,\n            quantity: data.quantity,\n            currentPlayer,\n            setCurrentPlayer,\n            masterResources\n          });\n        }\n      });\n    }\n\n    // Track quest progress for seeds used in replanting\n    Object.entries(results.seedsUsed || {}).forEach(([type, quantity]) => {\n      trackQuestProgress({\n        questProgressCategory: 'spend',\n        itemName: type,\n        quantity: quantity,\n        currentPlayer,\n        setCurrentPlayer,\n        masterResources\n      });\n    });\n    \n    // Return results object for modal display instead of status message\n    return {\n      success: true,\n      harvestResults,\n      replantInfo,\n      harvestSkillsInfo,\n      warehouseDrops: aggregatedWarehouseDrops,\n      seedsUsed: results.seedsUsed || {},\n      statusMessage: formatCollectionResults('harvest', harvestResults, harvestSkillsInfo, replantInfo, strings, getLocalizedString)\n    };\n  } else {\n    return { success: false, error: strings[448] || 'Bulk harvest failed' };\n  }\n  } catch (error) {\n    console.error(' Bulk harvest error:', error);\n    return { \n      success: false, \n      error: error.response?.data?.message || error.message || 'Bulk harvest failed' \n    };\n  }\n}\n\n// Function to prepare crops for the modal\nexport function prepareBulkHarvestData(resources, masterResources) {\n  // Group crops by type\n  const cropCounts = {};\n  \n  const readyCrops = resources.filter(res => {\n    // Check if this resource is a crop\n    const isCrop = isACrop(res.type, masterResources);\n    \n    \n    return isCrop;\n  });\n\n  readyCrops.forEach((crop) => {\n    if (!cropCounts[crop.type]) {\n      const baseCrop = masterResources.find(r => r.type === crop.type);\n      const farmplot = masterResources.find(r =>\n        r.category === 'farmplot' && r.output === crop.type\n      );\n      cropCounts[crop.type] = {\n        count: 0,\n        symbol: baseCrop?.symbol || '',\n        replantRequires: farmplot?.requires,\n        // Check repeatable on the crop itself (from grid resource or master definition)\n        repeatable: crop.repeatable === true || baseCrop?.repeatable === true\n      };\n    }\n    cropCounts[crop.type].count++;\n  });\n\n  // Convert to array format\n  const result = Object.entries(cropCounts).map(([type, data]) => ({\n    type,\n    count: data.count,\n    symbol: data.symbol,\n    replantRequires: data.replantRequires,\n    repeatable: data.repeatable // Include repeatable in output\n  }));\n  \n  return result;\n}","import { deriveWarehouseAndBackpackCapacity, calculateSkillMultiplier, isCurrency } from '../../Utils/InventoryManagement';\n\n/**\n * Calculate total capacity needed for bulk harvest operation\n * @param {Array} selectedTypes - Array of crop types to harvest\n * @param {Array} resources - Current grid resources\n * @param {Array} masterResources - Master resource definitions\n * @param {Object} masterSkills - Master skill definitions\n * @param {Object} currentPlayer - Current player data\n * @param {Object} globalTuning - Global tuning configuration\n * @returns {Object} Capacity check results\n */\nexport async function calculateBulkHarvestCapacity(\n  selectedTypes, \n  resources, \n  masterResources, \n  masterSkills, \n  currentPlayer,\n  globalTuning\n) {\n  let totalCapacityNeeded = 0;\n  const harvestDetails = [];\n  \n  // Get player's current inventory usage (exclude currencies from capacity calculations)\n  const currentWarehouseUsage = (currentPlayer.inventory || [])\n    .filter(item => !isCurrency(item.type))\n    .reduce((sum, item) => sum + (item.quantity || 0), 0);\n  const currentBackpackUsage = (currentPlayer.backpack || [])\n    .filter(item => !isCurrency(item.type))\n    .reduce((sum, item) => sum + (item.quantity || 0), 0);\n  \n  // Get total capacities with skills using the existing function\n  const capacities = deriveWarehouseAndBackpackCapacity(currentPlayer, masterResources, globalTuning);\n  const warehouseCapacity = capacities.warehouse || 0;\n  const backpackCapacity = capacities.backpack || 0;\n  \n  const totalCapacity = warehouseCapacity + backpackCapacity;\n  const currentTotalUsage = currentWarehouseUsage + currentBackpackUsage;\n  const availableSpace = totalCapacity - currentTotalUsage;\n  \n  \n  // Calculate yield for each crop type\n  for (const cropType of selectedTypes) {\n    const crops = resources.filter(res => res.type === cropType);\n    if (crops.length === 0) continue;\n    \n    const baseCrop = masterResources.find(r => r.type === cropType);\n    if (!baseCrop) continue;\n    \n    // Use shared utility for skill calculations\n    const skillInfo = calculateSkillMultiplier(cropType, currentPlayer.skills || [], masterSkills);\n    \n    const baseYield = baseCrop.qtycollected || 1;\n    const yieldPerCrop = Math.floor(baseYield * skillInfo.multiplier);\n    const totalYield = crops.length * yieldPerCrop;\n    \n    harvestDetails.push({\n      type: cropType,\n      count: crops.length,\n      baseYield,\n      skillMultiplier: skillInfo.multiplier,\n      skillInfo,\n      yieldPerCrop,\n      totalYield,\n      positions: crops.map(c => ({ x: c.x, y: c.y })),\n      symbol: baseCrop.symbol || ''\n    });\n    \n    totalCapacityNeeded += totalYield;\n  }\n  \n  // Calculate seeds needed for replanting\n  const replantDetails = [];\n  const seedsNeeded = {};\n  \n  for (const detail of harvestDetails) {\n    // Find the farmplot that produces this crop\n    const farmplot = masterResources.find(r => \n      r.category === 'farmplot' && r.output === detail.type\n    );\n    \n    if (farmplot) {\n      // Check if this farmplot requires seeds (has ingredient cost)\n      for (let i = 1; i <= 4; i++) {\n        const ingredientType = farmplot[`ingredient${i}`];\n        const ingredientQty = farmplot[`ingredient${i}qty`];\n        \n        if (ingredientType && ingredientQty) {\n          const totalNeeded = ingredientQty * detail.count;\n          seedsNeeded[ingredientType] = (seedsNeeded[ingredientType] || 0) + totalNeeded;\n        }\n      }\n      \n      replantDetails.push({\n        farmplotType: farmplot.type,\n        cropType: detail.type,\n        count: detail.count,\n        positions: detail.positions,\n        growtime: farmplot.growtime || 60\n      });\n    }\n  }\n  \n  // Check if player has enough seeds\n  const hasEnoughSeeds = {};\n  let canReplantAll = true;\n  \n  Object.entries(seedsNeeded).forEach(([seedType, needed]) => {\n    const inInventory = currentPlayer.inventory?.find(item => item.type === seedType)?.quantity || 0;\n    const inBackpack = currentPlayer.backpack?.find(item => item.type === seedType)?.quantity || 0;\n    const totalHas = inInventory + inBackpack;\n    \n    hasEnoughSeeds[seedType] = {\n      needed,\n      has: totalHas,\n      enough: totalHas >= needed\n    };\n    \n    if (totalHas < needed) {\n      canReplantAll = false;\n    }\n  });\n  \n  return {\n    canHarvest: availableSpace >= totalCapacityNeeded,\n    totalCapacityNeeded,\n    availableSpace,\n    currentTotalUsage,\n    totalCapacity,\n    warehouseCapacity,\n    backpackCapacity,\n    harvestDetails,\n    replantDetails,\n    seedsNeeded,\n    hasEnoughSeeds,\n    canReplantAll\n  };\n}\n\n/**\n * Build operations array for bulk harvest API call\n * @param {Object} capacityCheck - Results from calculateBulkHarvestCapacity\n * @param {Object} selectedReplantTypes - Which crops to replant\n * @param {Array} masterResources - Master resource definitions (optional, for checking repeatable)\n * @returns {Array} Operations array for API\n */\nexport function buildBulkHarvestOperations(capacityCheck, selectedReplantTypes, masterResources = []) {\n  const operations = [];\n\n  // Group by crop type for efficiency\n  capacityCheck.harvestDetails.forEach(detail => {\n    const shouldReplant = selectedReplantTypes[detail.type] || false;\n\n    // Check if this crop has repeatable=true (replants for free)\n    let freeReplant = false;\n    if (shouldReplant && masterResources.length > 0) {\n      // The repeatable property is on the crop resource, not the farmplot\n      const cropResource = masterResources.find(r => r.type === detail.type);\n      freeReplant = cropResource?.repeatable === true;\n    }\n\n    operations.push({\n      cropType: detail.type,\n      positions: detail.positions,\n      replant: shouldReplant,\n      freeReplant: freeReplant, // Server should not charge seeds for this\n      expectedYield: detail.totalYield\n    });\n  });\n\n  return operations;\n}\n\n","import React from 'react';\nimport Modal from '../../UI/Modals/Modal';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/Buttons/SharedButtons.css';\nimport './BulkHarvestResultsModal.css';\n\n/**\n * Modal to display results of bulk harvest operation\n * Shows harvested crops, replanted seeds, warehouse ingredients, and skills applied\n */\nexport function BulkHarvestResultsModal({ \n  isOpen, \n  onClose, \n  results,\n  strings,\n  masterResources\n}) {\n  if (!isOpen || !results) return null;\n\n  const { \n    harvestResults = {}, \n    replantInfo = {}, \n    harvestSkillsInfo = {}, \n    warehouseDrops = {},\n    seedsUsed = {}\n  } = results;\n\n  // Check if we have any content to show\n  const hasHarvestResults = Object.keys(harvestResults).length > 0;\n  const hasReplantInfo = Object.keys(replantInfo).length > 0;\n  const hasWarehouseDrops = Object.keys(warehouseDrops).length > 0;\n  const hasSkillsApplied = Object.keys(harvestSkillsInfo).length > 0;\n\n  return (\n    <Modal \n      isOpen={isOpen} \n      onClose={onClose} \n      title={strings[356] || \"Bulk Harvest Results\"} \n      size=\"medium\"\n      className=\"bulk-harvest-results-modal\"\n    >\n      <div className=\"bulk-harvest-results-content\">\n        \n        {/* Harvested Crops Section */}\n        {hasHarvestResults && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header crops\">\n               {strings[357] || \"Crops Harvested\"}\n            </h3>\n            <div className=\"crop-rows\">\n              {Object.entries(harvestResults).map(([cropType, quantity]) => {\n                const skillInfo = harvestSkillsInfo[cropType];\n                const hasSkillBonus = skillInfo && skillInfo.hasSkills;\n                \n                // Find the crop symbol from masterResources\n                const cropResource = masterResources?.find(r => r.type === cropType);\n                const cropSymbol = cropResource?.symbol || '';\n                \n                return (\n                  <div key={cropType} className=\"crop-row\">\n                    <span className=\"crop-symbol\">{cropSymbol}</span>\n                    <span className=\"crop-name\">{getLocalizedString(cropType, strings)}</span>\n                    <span className=\"crop-quantity\">+{quantity}</span>\n                    {hasSkillBonus && (\n                      <span className=\"crop-skills\">\n                        Skills applied ({skillInfo.multiplier}x): {skillInfo.skills.join(', ')}\n                      </span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Replanted Seeds Section */}\n        {hasReplantInfo && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header replanting\">\n               {strings[358] || \"Crops Replanted\"}\n            </h3>\n            <div className=\"replant-rows\">\n              {Object.entries(replantInfo).map(([cropType, count]) => {\n                // Find the crop symbol from masterResources\n                const cropResource = masterResources?.find(r => r.type === cropType);\n                const cropSymbol = cropResource?.symbol || '';\n                const seedsUsedForCrop = seedsUsed[cropType];\n                \n                return (\n                  <div key={cropType} className=\"replant-row\">\n                    <span className=\"replant-symbol\">{cropSymbol}</span>\n                    <span className=\"replant-name\">{getLocalizedString(cropType, strings)}</span>\n                    <span className=\"replant-quantity\">{count}</span>\n                    {seedsUsedForCrop && (\n                      <span className=\"replant-seeds-used\">\n                        {strings[361] || \"Seeds used\"}: -{seedsUsedForCrop}\n                      </span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Warehouse Ingredients Section */}\n        {hasWarehouseDrops && (\n          <div className=\"results-section\">\n            <h3 className=\"results-section-header warehouse\">\n               {strings[359] || \"Warehouse Ingredients Found\"}\n            </h3>\n            <div className=\"results-grid-warehouse\">\n              {Object.entries(warehouseDrops).map(([ingredientType, data]) => (\n                <div key={ingredientType} className=\"result-item warehouse\">\n                  <div className=\"result-item-label\">\n                    <span className=\"result-item-name\">\n                      {data.symbol} {getLocalizedString(ingredientType, strings)}\n                    </span>\n                  </div>\n                  <span className=\"result-item-quantity warehouse\">+{data.quantity}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Close Button - using shared button styles */}\n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', marginTop: '20px' }}>\n          <button \n            onClick={onClose}\n            className=\"btn-basic btn-success btn-modal\"\n            style={{ fontSize: '16px', padding: '10px 20px' }}\n          >\n            {strings[360] || \"Continue\"}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default BulkHarvestResultsModal;","import React, { useState } from 'react';\nimport Modal from '../../UI/Modals/Modal';\nimport { handleNPCClick } from '../NPCs/NPCUtils';\nimport { calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport '../../UI/Buttons/SharedButtons.css';\n\n// Component for the bulk animal collection selection modal\nexport function BulkAnimalModal({ \n  isOpen, \n  onClose, \n  animals, \n  onExecute,\n  strings \n}) {\n  const [selectedAnimalTypes, setSelectedAnimalTypes] = useState({});\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && animals.length > 0) {\n      // Select all animals by default\n      const defaultSelection = {};\n      animals.forEach(animal => {\n        defaultSelection[animal.type] = true;\n      });\n      setSelectedAnimalTypes(defaultSelection);\n    }\n  }, [isOpen, animals]);\n\n  const handleToggleAnimal = (animalType) => {\n    setSelectedAnimalTypes(prev => ({\n      ...prev,\n      [animalType]: !prev[animalType]\n    }));\n  };\n\n  const handleExecute = () => {\n    onExecute();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[319] || \"Select Animals to Collect\"} size=\"medium\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>           \n        <div className=\"shared-buttons\" style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal-small\"\n            onClick={() => {\n              const allSelected = {};\n              animals.forEach(animal => {\n                allSelected[animal.type] = true;\n              });\n              setSelectedAnimalTypes(allSelected);\n            }}\n          >\n            {strings[316] || 'Select All'}\n          </button>\n          <button \n            className=\"btn-basic btn-danger btn-modal-small\"\n            onClick={() => setSelectedAnimalTypes({})}\n          >\n            {strings[317] || 'Deselect All'}\n          </button>\n        </div>\n        \n        <div style={{ marginBottom: '20px' }}>\n          {animals.map((animal, index) => (\n            <div key={animal.type} style={{\n              display: 'flex',\n              alignItems: 'center',\n              marginBottom: '10px',\n              padding: '5px',\n              backgroundColor: index % 2 === 0 ? 'transparent' : 'var(--color-bg-light)'\n            }}>\n              <input\n                type=\"checkbox\"\n                checked={selectedAnimalTypes[animal.type] || false}\n                onChange={(e) => {\n                  setSelectedAnimalTypes(prev => ({\n                    ...prev,\n                    [animal.type]: e.target.checked\n                  }));\n                }}\n                style={{ marginRight: '10px' }}\n              />\n              <span>{animal.symbol} {getLocalizedString(animal.type, strings)} ({animal.count})</span>\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal\"\n            onClick={handleExecute}\n            disabled={Object.values(selectedAnimalTypes).every(selected => !selected)}\n          >\n            {strings[318] || 'Collect Selected'}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk animal collection\nexport async function executeBulkAnimalCollect({\n  selectedAnimalTypes,\n  gridId,\n  currentPlayer,\n  setCurrentPlayer,\n  setInventory,\n  setBackpack,\n  setResources,\n  updateStatus,\n  TILE_SIZE,\n  masterResources,\n  masterSkills,\n  strings\n}) {\n  // Get selected animal types\n  const selectedTypes = Object.keys(selectedAnimalTypes).filter(type => selectedAnimalTypes[type]);\n  \n  if (selectedTypes.length === 0) {\n    return 'No animals selected for collection.';\n  }\n\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const animalsToCollect = npcs.filter(npc => \n    npc.state === 'processing' && selectedTypes.includes(npc.type)\n  );\n\n  const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n  const successfulCollects = {};\n  const animalSkillsInfo = {};\n\n  // Process each animal\n  for (const npc of animalsToCollect) {\n    const result = await handleNPCClick(\n      npc,\n      npc.position.y,\n      npc.position.x,\n      setInventory,\n      setBackpack,  \n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      TILE_SIZE,\n      masterResources,\n      masterSkills,\n      gridId,\n      () => {}, // setModalContent (not used here)\n      () => {}, // setIsModalOpen (not used here)\n      updateStatus,\n      () => {}, // openPanel (not used here)\n      () => {}, // setActiveStation (not used here)\n      strings\n    );\n\n    // Check if collection was successful\n    if (result && result.type === 'success' && result.collectedItem) {\n      const { collectedItem, collectedQuantity, skillsApplied } = result;\n      \n      // Track successful collects\n      successfulCollects[collectedItem] = (successfulCollects[collectedItem] || 0) + collectedQuantity;\n      \n      // Track skill info for this item type - use what server provided\n      if (!animalSkillsInfo[collectedItem] && skillsApplied && skillsApplied.length > 0) {\n        // The server already tells us which skills were applied\n        // We need to calculate the multiplier from the quantity\n        // Each animal gives base 1, so multiplier = collectedQuantity / 1\n        const multiplier = collectedQuantity;\n        \n        animalSkillsInfo[collectedItem] = {\n          skills: skillsApplied,\n          multiplier: multiplier,\n          hasSkills: true\n        };\n      }\n    }\n    \n    await wait(100); // avoid overloading server\n  }\n\n  // Small delay to ensure all state updates have propagated\n  await wait(100);\n  \n  // Refresh player data from server, including fresh inventory\n  await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer, false);\n\n  // Use shared formatter for status message\n  if (Object.keys(successfulCollects).length > 0) {\n    const statusMessage = formatCollectionResults('animal', successfulCollects, animalSkillsInfo, null, strings, getLocalizedString);\n    return statusMessage;\n  } else {\n    return 'Failed to collect from any animals.';\n  }\n}\n\n// Function to prepare animal data for the modal\nexport function prepareBulkAnimalData(gridId, masterResources) {\n  const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n  const processingAnimals = npcs.filter(npc => npc.state === 'processing');\n  \n  // Count how many of each animal type is ready\n  const animalCounts = {};\n  processingAnimals.forEach((npc) => {\n    animalCounts[npc.type] = (animalCounts[npc.type] || 0) + 1;\n  });\n\n  // Create array of available animals with counts and symbols\n  return Object.entries(animalCounts).map(([animalType, count]) => {\n    const resourceDef = masterResources.find(res => res.type === animalType);\n    return {\n      type: animalType,\n      count,\n      symbol: resourceDef?.symbol || ''\n    };\n  });\n}","import React, { useState } from 'react';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport Modal from '../../UI/Modals/Modal';\nimport { canAfford, spendIngredients, gainIngredients, calculateSkillMultiplier } from '../../Utils/InventoryManagement';\nimport { formatCollectionResults, formatRestartResults } from '../../UI/StatusBar/CollectionFormatters';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport '../../UI/Buttons/SharedButtons.css';\n\n// Component for the bulk crafting selection modal\nexport function BulkCraftingModal({ \n  isOpen, \n  onClose, \n  stationGroups, \n  onExecute,\n  hasBulkRestartCraft,\n  strings,\n  masterResources,\n  inventory,\n  backpack \n}) {\n  const [selectedGroups, setSelectedGroups] = useState([]);\n  const [selectedRestartStations, setSelectedRestartStations] = useState({});\n\n  // Initialize selections when modal opens\n  React.useEffect(() => {\n    if (isOpen && stationGroups.length > 0) {\n      // Select all station groups by default\n      setSelectedGroups(stationGroups);\n      \n      // Select all restart options by default (if bulk restart skill is available)\n      if (hasBulkRestartCraft) {\n        const defaultRestartSelection = {};\n        stationGroups.forEach(group => {\n          if (group.canRestart) {\n            const key = `${group.stationType}-${group.craftedItem}`;\n            defaultRestartSelection[key] = true;\n          }\n        });\n        setSelectedRestartStations(defaultRestartSelection);\n      }\n    }\n  }, [isOpen, stationGroups, hasBulkRestartCraft]);\n\n  const handleToggleGroup = (group) => {\n    setSelectedGroups(prev => {\n      const isSelected = prev.some(g => \n        g.stationType === group.stationType && g.craftedItem === group.craftedItem\n      );\n      \n      if (isSelected) {\n        // If unchecking collect, also uncheck restart\n        const key = `${group.stationType}-${group.craftedItem}`;\n        setSelectedRestartStations(restartPrev => ({\n          ...restartPrev,\n          [key]: false\n        }));\n        \n        return prev.filter(g => \n          !(g.stationType === group.stationType && g.craftedItem === group.craftedItem)\n        );\n      } else {\n        return [...prev, group];\n      }\n    });\n  };\n\n  const handleToggleRestart = (group) => {\n    const key = `${group.stationType}-${group.craftedItem}`;\n    setSelectedRestartStations(prev => {\n      const newValue = !prev[key];\n      // If checking restart, also check collect\n      if (newValue) {\n        setSelectedGroups(groupsPrev => {\n          const isAlreadySelected = groupsPrev.some(g => \n            g.stationType === group.stationType && g.craftedItem === group.craftedItem\n          );\n          if (!isAlreadySelected) {\n            return [...groupsPrev, group];\n          }\n          return groupsPrev;\n        });\n      }\n      return {\n        ...prev,\n        [key]: newValue\n      };\n    });\n  };\n\n  const handleExecute = () => {\n    onExecute(selectedGroups, selectedRestartStations);\n  };\n\n  const isGroupSelected = (group) => {\n    return selectedGroups.some(g => \n      g.stationType === group.stationType && g.craftedItem === group.craftedItem\n    );\n  };\n\n  if (!isOpen) return null;\n\n  const getRestartLabel = (group) => {\n    if (!hasBulkRestartCraft) {\n      return strings[345] || 'Requires skill';\n    }\n    if (!group.canRestart) {\n      return strings[346] || 'Locked';\n    }\n    if (!group.affordable) {\n      return null;  // Don't show text for insufficient ingredients\n    }\n    return null;\n  };\n\n  const isRestartDisabled = (group) => {\n    return !hasBulkRestartCraft || !group.canRestart || !group.affordable;\n  };\n\n  // Calculate total ingredient needs for a group\n  const calculateGroupNeeds = (group) => {\n    if (!group.recipe || !group.stationCount) return null;\n    \n    const needs = {};\n    \n    // Calculate needs for each ingredient\n    for (let i = 1; i <= 4; i++) {\n      const ingredientType = group.recipe[`ingredient${i}`];\n      const ingredientQty = group.recipe[`ingredient${i}qty`];\n      \n      if (ingredientType && ingredientQty) {\n        const totalNeeded = ingredientQty * group.stationCount;\n        const inventoryQty = inventory?.find(item => item.type === ingredientType)?.quantity || 0;\n        const backpackQty = backpack?.find(item => item.type === ingredientType)?.quantity || 0;\n        const totalAvailable = inventoryQty + backpackQty;\n        \n        needs[ingredientType] = {\n          needed: totalNeeded,\n          available: totalAvailable,\n          symbol: masterResources.find(r => r.type === ingredientType)?.symbol || ''\n        };\n      }\n    }\n    \n    return needs;\n  };\n\n  const selectAll = () => {\n    setSelectedGroups(stationGroups);\n  };\n\n  const selectNone = () => {\n    setSelectedGroups([]);\n    // When deselecting all collections, also deselect all restarts\n    setSelectedRestartStations({});\n  };\n\n  const selectAllRestarts = () => {\n    const allRestartSelection = {};\n    const groupsToSelect = [];\n    stationGroups.forEach(group => {\n      if (group.canRestart && group.affordable) {\n        const key = `${group.stationType}-${group.craftedItem}`;\n        allRestartSelection[key] = true;\n        // Also select the group for collection\n        if (!isGroupSelected(group)) {\n          groupsToSelect.push(group);\n        }\n      }\n    });\n    setSelectedRestartStations(prev => ({\n      ...prev,\n      ...allRestartSelection\n    }));\n    setSelectedGroups(prev => [...prev, ...groupsToSelect]);\n  };\n\n  const selectNoneRestarts = () => {\n    setSelectedRestartStations({});\n  };\n\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} title={strings[341] || \"Select Crafting Stations to Collect:\"} size=\"large\">\n      <div style={{ padding: '20px', fontSize: '16px' }}>\n        <div style={{ marginBottom: '15px', display: 'flex', gap: '10px' }}>\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px' }}>\n            <button \n              className=\"btn-basic btn-success btn-modal-small\"\n              onClick={selectAll}\n            >\n              {strings[316] || 'Select All'}\n            </button>\n            <button \n              className=\"btn-basic btn-neutral btn-modal-small\"\n              onClick={selectNone}\n            >\n              {strings[317] || 'Deselect All'}\n            </button>\n          </div>\n          \n          {hasBulkRestartCraft && (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', marginLeft: 'auto', marginRight: '20px' }}>\n              <button \n                className=\"btn-basic btn-success btn-modal-small\"\n                onClick={selectAllRestarts}\n              >\n                {strings[316] || 'Select All'}\n              </button>\n              <button \n                className=\"btn-basic btn-neutral btn-modal-small\"\n                onClick={selectNoneRestarts}\n              >\n                {strings[317] || 'Deselect All'}\n              </button>\n            </div>\n          )}\n        </div>\n        \n        <div style={{ display: 'flex', marginBottom: '10px', fontSize: '14px', fontWeight: 'bold' }}>\n          <div style={{ width: '60px', textAlign: 'center' }}>{strings[346] || 'Collect?'}</div>\n          <div style={{ width: '200px', textAlign: 'left', paddingLeft: '10px' }}>{strings[476] || 'Station'}</div>\n          <div style={{ width: '270px', textAlign: 'left' }}>{strings[161] || 'Item'}</div>\n          {hasBulkRestartCraft && (\n            <div style={{ width: '80px', textAlign: 'center' }}>{strings[475]}</div>\n          )}\n          <div style={{ width: '150px', textAlign: 'center' }}>{strings[177]}</div>\n        </div>\n        \n        <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n          {stationGroups.map((group, index) => {\n            const key = `${group.stationType}-${group.craftedItem}`;\n            const needs = calculateGroupNeeds(group);\n            return (\n              <div key={index} style={{ display: 'flex', alignItems: 'center', marginBottom: '8px', padding: '5px', borderBottom: '1px solid #eee' }}>\n                <div style={{ width: '60px', textAlign: 'center' }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={isGroupSelected(group)}\n                    onChange={() => handleToggleGroup(group)}\n                    style={{ width: '20px' }}\n                  />\n                </div>\n                <div style={{ width: '200px', textAlign: 'left', fontWeight: 'bold', paddingLeft: '10px' }}>\n                  {group.stationSymbol} {getLocalizedString(group.stationType, strings)}\n                </div>\n                <div style={{ width: '270px', textAlign: 'left' }}>\n                  {group.craftedSymbol} {getLocalizedString(group.craftedItem, strings)} ({group.stationCount})\n                </div>\n                {hasBulkRestartCraft ? (() => {\n                  const restartLabel = getRestartLabel(group);\n                  return (\n                    <div style={{ marginLeft: '0px', width: '80px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedRestartStations[key] || false}\n                        onChange={() => !isRestartDisabled(group) && handleToggleRestart(group)}\n                        disabled={isRestartDisabled(group)}\n                        style={{ \n                          width: '20px',\n                          opacity: isRestartDisabled(group) ? 0.5 : 1,\n                          cursor: isRestartDisabled(group) ? 'not-allowed' : 'pointer'\n                        }}\n                        title={restartLabel || ''}\n                      />\n                      {restartLabel && (\n                        <span style={{ fontSize: '11px', color: 'red', marginTop: '2px' }}>\n                          {restartLabel}\n                        </span>\n                      )}\n                    </div>\n                  );\n                })() : null}\n                {/* Needs column */}\n                <div style={{ width: '150px', textAlign: 'center', fontSize: '12px' }}>\n                  {needs && Object.entries(needs).map(([type, data], idx) => {\n                    const color = data.available >= data.needed ? 'green' : 'red';\n                    return (\n                      <div key={idx} style={{ color }}>\n                        {data.symbol} {data.needed}/{data.available}\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        \n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center' }}>\n          <button \n            className=\"btn-basic btn-success btn-modal\"\n            onClick={handleExecute}\n            disabled={selectedGroups.length === 0}\n          >\n            {strings[318] || 'Collect'}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\n// Main function to execute bulk crafting collection\nexport async function executeBulkCrafting({\n  selectedGroups,\n  selectedRestartStations,\n  hasBulkRestartCraft,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  setResources,\n  gridId,\n  masterResources,\n  masterSkills,\n  strings,\n  updateStatus,\n  globalTuning\n}) {\n  if (selectedGroups.length === 0) {\n    return 'No crafting stations selected for collection.';\n  }\n\n  // Flatten all selected stations\n  const stationsToCollect = selectedGroups.flatMap(group => group.stations);\n  \n  // Prepare batch data for all stations\n  const batchStations = stationsToCollect.map(station => {\n    const key = `${station.type}-${station.craftedItem}`;\n    const shouldRestart = hasBulkRestartCraft && selectedRestartStations[key];\n    \n    // Find the recipe if we need to restart\n    let restartRecipe = null;\n    if (shouldRestart) {\n      const stationGroup = selectedGroups.find(g => \n        g.stationType === station.type && g.craftedItem === station.craftedItem\n      );\n      if (stationGroup && stationGroup.recipe && stationGroup.affordable) {\n        restartRecipe = stationGroup.recipe;\n      }\n    }\n    \n    return {\n      x: station.x,\n      y: station.y,\n      type: station.type,\n      craftedItem: station.craftedItem,\n      transactionId: `bulk-craft-collect-${Date.now()}-${Math.random()}`,\n      shouldRestart: shouldRestart && restartRecipe !== null,\n      restartRecipe: restartRecipe\n    };\n  });\n  \n  const transactionId = `bulk-craft-collect-${currentPlayer._id}-${Date.now()}`;\n  const transactionKey = `bulk-craft-collect-${gridId}`;\n  \n  // Make single API call for both collection and restart\n  \n  try {\n    const response = await axios.post(`${API_BASE}/api/crafting/collect-bulk`, {\n      playerId: currentPlayer.playerId || currentPlayer._id,\n      gridId,\n      stations: batchStations,\n      transactionId,\n      transactionKey\n    });\n    \n    if (response.data.success && response.data.results) {\n      const results = response.data.results;\n      let updatedResources = [...GlobalGridStateTilesAndResources.getResources()];\n      \n      // Track successful collections and applied skills\n      const successfulCollects = {};\n      const successfulRestarts = {};\n      const appliedSkillsInfo = {};\n      \n      // Process each result and build a map of station updates\n      const stationUpdates = {};\n      \n      for (const result of results) {\n        if (result.collected || result.success) {\n          const { station, collectedItem, craftedItem, isNPC } = result;\n          const itemCollected = collectedItem || craftedItem;\n          const key = `${station.x}-${station.y}`;\n          \n          if (result.restarted && result.newCraftEnd) {\n            // Restarted - update with new craft state\n            stationUpdates[key] = { \n              craftEnd: result.newCraftEnd, \n              craftedItem: result.newCraftedItem || itemCollected \n            };\n          } else {\n            // Just collected - clear craft state\n            stationUpdates[key] = { \n              craftEnd: undefined, \n              craftedItem: undefined \n            };\n          }\n          \n          // Calculate skill info\n          const stationType = station.stationType || station.type;\n          const playerBuffs = (currentPlayer.skills || [])\n            .filter((item) => {\n              const resourceDetails = masterResources.find((res) => res.type === item.type);\n              const isSkill = resourceDetails?.category === 'skill';\n              const appliesToStation = (masterSkills?.[item.type]?.[stationType] || 1) > 1;\n              return isSkill && appliesToStation;\n            })\n            .map((buffItem) => buffItem.type);\n          \n          // Calculate skill multiplier\n          const skillMultiplier = playerBuffs.reduce((multiplier, buff) => {\n            const buffValue = masterSkills?.[buff]?.[stationType] || 1;\n            return multiplier * buffValue;\n          }, 1);\n          \n          // Base quantity is 1 per crafting station (matching individual crafting)\n          const baseQtyCollected = 1;\n          const finalQtyCollected = baseQtyCollected * skillMultiplier;\n          \n          // Handle NPC spawning\n          if (isNPC) {\n            const craftedResource = masterResources.find(res => res.type === itemCollected);\n            if (craftedResource) {\n              NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: station.x, y: station.y });\n            }\n          } else {\n            // Server doesn't add items - client handles with skill buffs\n            // Track successful collects with skill bonuses\n            successfulCollects[itemCollected] = (successfulCollects[itemCollected] || 0) + finalQtyCollected;\n            \n            // Track skills applied for this item type (only need to do once per item type)\n            if (!appliedSkillsInfo[itemCollected] && playerBuffs.length > 0) {\n              appliedSkillsInfo[itemCollected] = {\n                skills: playerBuffs,\n                multiplier: skillMultiplier,\n                hasSkills: true\n              };\n            }\n          }\n          \n          // Track restart info\n          if (result.restarted) {\n            const restartedItem = result.newCraftedItem || result.restartedItem || itemCollected;\n            if (restartedItem) {\n              successfulRestarts[restartedItem] = (successfulRestarts[restartedItem] || 0) + 1;\n            }\n          }\n        }\n      }\n      \n      // Now apply all station updates in one pass using map pattern (like single crafting)\n      updatedResources = updatedResources.map(res => {\n        const key = `${res.x}-${res.y}`;\n        if (stationUpdates[key]) {\n          return { ...res, ...stationUpdates[key] };\n        }\n        return res;\n      });\n      \n      // Update inventory from server response if provided\n      if (response.data.inventory) {\n        // Update local inventory with what server says we have after spending for restarts\n        setInventory(response.data.inventory.warehouse || response.data.inventory);\n        setBackpack(response.data.inventory.backpack || []);\n        setCurrentPlayer(prev => ({\n          ...prev,\n          inventory: response.data.inventory.warehouse || response.data.inventory,\n          backpack: response.data.inventory.backpack || []\n        }));\n      }\n      \n      // NOW update global resources with all changes (collections + restarts) - ONLY ONCE\n      // Just like single crafting does it - simple and clean\n      GlobalGridStateTilesAndResources.setResources(updatedResources);\n      setResources(updatedResources);\n      \n      // Use fresh inventory state from server response\n      const currentInventory = response.data.inventory?.warehouse || inventory;\n      const currentBackpack = response.data.inventory?.backpack || backpack;\n      \n      // Add collected items to inventory with skills applied\n      for (const [collectedItem, quantity] of Object.entries(successfulCollects)) {\n        await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer: {\n            ...currentPlayer,\n            inventory: currentInventory,\n            backpack: currentBackpack\n          },\n          resource: collectedItem,\n          quantity: quantity,\n          inventory: currentInventory,\n          backpack: currentBackpack,\n          setInventory,\n          setBackpack,\n          setCurrentPlayer,\n          updateStatus,\n          masterResources,\n          globalTuning,\n        });\n        \n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Craft', collectedItem, quantity, setCurrentPlayer);\n      }\n      \n      // Refresh player state to ensure everything is in sync\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer, false);\n      \n      // Check if we have any successful operations\n      const hasCollections = Object.keys(successfulCollects).length > 0;\n      const hasRestarts = Object.keys(successfulRestarts).length > 0;\n      const totalProcessed = results.filter(r => r.collected || r.success).length;\n      \n      if (hasCollections || hasRestarts) {\n        const parts = [];\n        \n        if (hasCollections) {\n          parts.push(formatCollectionResults('craft', successfulCollects, appliedSkillsInfo, null, strings, getLocalizedString));\n        }\n        \n        if (hasRestarts) {\n          parts.push(formatRestartResults(successfulRestarts, 'craft', strings, getLocalizedString));\n        }\n        \n        return parts.join(' | ');\n      } else if (totalProcessed > 0) {\n        // Items were processed but maybe all were NPCs\n        return `Collected from ${totalProcessed} crafting station${totalProcessed > 1 ? 's' : ''}.`;\n      } else {\n        return 'Failed to collect any crafted items.';\n      }\n    } else {\n      return 'Failed to collect crafted items.';\n    }\n  } catch (error) {\n    console.error(' Bulk crafting error:', error);\n    return error.response?.data?.message || error.message || 'Bulk crafting failed';\n  }\n}\n\n// Function to prepare crafting station data for the modal\nexport function prepareBulkCraftingData(masterResources, inventory, backpack, currentPlayer, hasRequiredSkill) {\n  const now = Date.now();\n  const resources = GlobalGridStateTilesAndResources.getResources() || [];\n  \n  // Find all crafting stations with completed crafts\n  const readyStations = resources.filter(res => {\n    // Check if this is a crafting station\n    const stationDef = masterResources.find(r => r.type === res.type);\n    if (!stationDef || stationDef.category !== 'crafting') return false;\n    \n    // Check if it has a completed craft\n    return res.craftEnd && res.craftEnd <= now && res.craftedItem;\n  });\n\n  // Group stations by type and crafted item\n  const stationGroups = {};\n  readyStations.forEach(station => {\n    const key = `${station.type}-${station.craftedItem}`;\n    if (!stationGroups[key]) {\n      const stationResource = masterResources.find(r => r.type === station.type);\n      const craftedResource = masterResources.find(r => r.type === station.craftedItem);\n      // Find the recipe that produces this item from this station\n      const recipe = masterResources.find(r => \n        r.source === station.type && r.type === station.craftedItem\n      );\n      stationGroups[key] = {\n        stationType: station.type,\n        stationSymbol: stationResource?.symbol || '',\n        craftedItem: station.craftedItem,\n        craftedSymbol: craftedResource?.symbol || '',\n        stations: [],\n        recipe: recipe,\n        canRestart: !!recipe && hasRequiredSkill(recipe?.requires),\n        affordable: recipe ? canAfford(recipe, inventory, backpack, 1) : false\n      };\n    }\n    stationGroups[key].stations.push(station);\n  });\n\n  // Convert to array and add counts\n  const groupsArray = Object.values(stationGroups).map(group => ({\n    ...group,\n    stationCount: group.stations.length\n  }));\n  \n  // Sort by station type first (alphabetically), then by crafted item (alphabetically)\n  groupsArray.sort((a, b) => {\n    // First compare station types\n    const stationCompare = a.stationType.localeCompare(b.stationType);\n    if (stationCompare !== 0) return stationCompare;\n    \n    // If same station type, compare crafted items\n    return a.craftedItem.localeCompare(b.craftedItem);\n  });\n  \n  return groupsArray;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport ProgressModal from '../../UI/Modals/ProgressModal';\nimport '../../UI/Buttons/ResourceButton.css';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { canAfford } from '../../Utils/InventoryManagement';\nimport { refreshPlayerAfterInventoryUpdate, gainIngredients, spendIngredients } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleDooberClick, handleSourceConversion } from '../../ResourceClicking'; // adjust path if necessary\nimport FloatingTextManager from '../../UI/FloatingText';\nimport NPCsInGridManager from \"../../GridState/GridStateNPCs\";\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useNPCOverlay } from '../../UI/NPCOverlayContext';\nimport { useBulkOperation } from '../../UI/BulkOperationContext';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { BulkHarvestModal, executeBulkHarvest, prepareBulkHarvestData } from './BulkHarvest';\nimport BulkHarvestResultsModal from './BulkHarvestResultsModal';\nimport { BulkAnimalModal, executeBulkAnimalCollect } from './BulkAnimalCollect';\nimport { BulkCraftingModal, executeBulkCrafting, prepareBulkCraftingData } from './BulkCrafting';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { getDerivedLevel } from '../../Utils/playerManagement';\n\nconst FarmHandPanel = ({\n  onClose,\n  npc,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  resources,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterSkills,\n  currentSeason,\n  globalTuning,\n  isDeveloper = false,\n  masterXPLevels = [],\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const [stationDetails, setStationDetails] = useState(null);\n  const [workerSkills, setFarmhandSkills] = useState([]);\n  const [workerUpgrades, setFarmhandUpgrades] = useState([]);\n  const [isHarvestModalOpen, setIsHarvestModalOpen] = useState(false);\n  const [availableCrops, setAvailableCrops] = useState([]);\n  const [bulkHarvestResults, setBulkHarvestResults] = useState(null);\n  const [isResultsModalOpen, setIsResultsModalOpen] = useState(false);\n  const [isAnimalModalOpen, setIsAnimalModalOpen] = useState(false);\n  const [selectedAnimalTypes, setSelectedAnimalTypes] = useState({});\n  const [availableAnimals, setAvailableAnimals] = useState([]);\n  const [isCraftingModalOpen, setIsCraftingModalOpen] = useState(false);\n  const [selectedCraftingStations, setSelectedCraftingStations] = useState({});\n  const [selectedRestartStations, setSelectedRestartStations] = useState({});\n  const [availableCraftingStations, setAvailableCraftingStations] = useState([]);\n  const skills = currentPlayer.skills || [];\n  const hasBulkReplant = skills.some(skill => skill.type === 'Bulk Replant');\n  const hasBulkRestartCraft = skills.some(skill => skill.type === 'Bulk Restart Craft');\n  const [bulkProgressModal, setBulkProgressModal] = useState({ isOpen: false, message: '' });\n  const { setBusyOverlay, clearNPCOverlay } = useNPCOverlay();\n  const { startBulkOperation, endBulkOperation } = useBulkOperation();\n  \n  // Shared function for executing bulk operations with progress modal\n  async function executeBulkOperation(operationName, operationId, workerNPC, asyncOperation) {\n    let pendingStatusMessage = null;\n    \n    // Show progress modal\n    setBulkProgressModal({ \n      isOpen: true, \n      message: strings[477] || 'Processing...'\n    });\n    \n    try {\n      // Run the async operation\n      pendingStatusMessage = await asyncOperation();\n    } catch (error) {\n      console.error(`${operationName} failed:`, error);\n      pendingStatusMessage = error.message || `Failed to complete ${operationName}.`;\n    } finally {\n      // Close modal and cleanup\n      setBulkProgressModal({ isOpen: false, message: '' });\n      if (workerNPC) clearNPCOverlay(workerNPC.id);\n      endBulkOperation(operationId);\n      \n      // Show the status message\n      if (pendingStatusMessage) {\n        updateStatus(pendingStatusMessage);\n      }\n    }\n  }\n  \n  // Determine which features to show based on NPC type\n  const npcType = npc?.type || stationType; // Use NPC type from the npc object, fallback to stationType\n  const showBulkHarvest = ['Farmer', 'Farm Hand'].includes(npcType);\n  const showBulkReplant = ['Farmer', 'Farm Hand'].includes(npcType) && hasBulkReplant;\n  const showBulkAnimalCollect = ['Farmer', 'Rancher'].includes(npcType);\n  const showLogging = ['Farmer', 'Lumberjack'].includes(npcType);\n  const showCropPurchase = ['Farmer', 'Farm Hand'].includes(npcType);\n  const showBulkCrafting = ['Farmer', 'Crafter'].includes(npcType);\n  \n  // Helper function to check if player has required skill (same logic as FarmingPanel)\n  const hasRequiredSkill = (requiredSkill) => {\n    return !requiredSkill || currentPlayer.skills?.some((owned) => owned.type === requiredSkill);\n  };\n  \n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Calculate player level for filtering crops\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n\n  useEffect(() => {\n    try {\n      // Combine inventory and backpack for quantity checks\n      const safeInventory = Array.isArray(inventory) ? inventory : [];\n      const safeBackpack = Array.isArray(backpack) ? backpack : [];\n\n      const filteredRecipes = masterResources.filter((res) => {\n        // Must be a crop (output of a farmplot)\n        if (!isACrop(res.type, masterResources)) return false;\n\n        // Check devonly restriction (allow if isDeveloper)\n        if (res.requires === 'devonly' && !isDeveloper) return false;\n\n        // Check seasonal restriction (allow if isDeveloper)\n        if (!isDeveloper && res.season && currentSeason && res.season !== currentSeason) {\n          return false;\n        }\n\n        // Check level restriction (allow if isDeveloper)\n        if (!isDeveloper && res.level && res.level > playerLevel) {\n          return false;\n        }\n\n        // Hide crops the player already has 10+ of (this is a safety net, not a primary source)\n        const inventoryQty = safeInventory.find(item => item.type === res.type)?.quantity || 0;\n        const backpackQty = safeBackpack.find(item => item.type === res.type)?.quantity || 0;\n        if (inventoryQty + backpackQty > 9) {\n          return false;\n        }\n\n        return true;\n      });\n      setRecipes(filteredRecipes);\n\n      const stationResource = masterResources.find((res) => res.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n    } catch (error) {\n      console.error('Error loading worker offers:', error);\n    }\n  }, [stationType, masterResources, currentSeason, isDeveloper, playerLevel, inventory, backpack]);\n\n  useEffect(() => {\n    const ownedTypes = currentPlayer.skills?.map(skill => skill.type) || [];\n    \n    // Get skills from multiple sources based on NPC type\n    let validSources = ['Farm Hand']; // Always include Farm Hand skills\n    if (npcType === 'Crafter' || npcType === 'Farmer') {\n      validSources.push('Crafter'); // Include Crafter skills for Crafter and Farmer NPCs\n    }\n    if (npcType === 'Rancher' || npcType === 'Farmer') {\n      validSources.push('Rancher'); // Include Rancher skills for Rancher and Farmer NPCs\n    }\n    \n    let skills = masterResources.filter(res =>\n      res.category === 'skill' &&\n      validSources.includes(res.source) &&\n      !ownedTypes.includes(res.type)\n    );\n\n    // Filter skills based on NPC type\n    if (npcType === 'Farm Hand') {\n      skills = skills.filter(res => ['Bulk Harvest', 'Bulk Replant'].includes(res.type));\n    } else if (npcType === 'Rancher') {\n      skills = skills.filter(res => res.type === 'Bulk Animal Collect');\n    } else if (npcType === 'Lumberjack') {\n      skills = skills.filter(res => ['Logging', 'Better Logging'].includes(res.type));\n    } else if (npcType === 'Crafter') {\n      skills = skills.filter(res => ['Bulk Crafting', 'Bulk Restart Craft'].includes(res.type));\n    }\n    // For 'Farmer', show all skills from all valid sources\n\n    setFarmhandSkills(skills);\n  }, [masterResources, currentPlayer, npcType]);\n\n  const handleTrade = async (resource) => {\n    setErrorMessage('');\n    const cost = (resource.maxprice || 100) * 10;\n\n    const recipe = {\n      ingredient1: 'Money',\n      ingredient1qty: cost,\n      type: resource.type,\n    };\n\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n\n    const spent = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spent) {\n      setErrorMessage('Not enough money.');\n      return;\n    }\n\n    const gained = await gainIngredients({\n      playerId: currentPlayer.playerId,\n      currentPlayer,\n      resource: resource.type,\n      quantity: 1,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n      masterResources,\n      globalTuning,\n    });\n\n    if (!gained) {\n      setErrorMessage('Not enough space to carry that item.');\n      return;\n    }\n\n    updateStatus(`Bought 1 ${resource.type} for ${cost} Money.`);\n  };\n\n  const handlePurchaseSkill = async (resource) => {\n    setErrorMessage('');\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n\n    const spent = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: resource,\n      inventory: safeInventory,\n      backpack: safeBackpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!spent) {\n      setErrorMessage('Not enough ingredients.');\n      return;\n    }\n\n    const updatedSkills = [...(currentPlayer.skills || []), { type: resource.type, category: resource.category, quantity: 1 }];\n    await axios.post(`${API_BASE}/api/update-skills`, {\n      playerId: currentPlayer.playerId,\n      skills: updatedSkills,\n    });\n\n    await trackQuestProgress(currentPlayer, 'Acquire', resource.type, 1, setCurrentPlayer);\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    updateStatus(`${resource.type} acquired.`);\n  };\n\n  function handleBulkAnimalCollect() {\n    \n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const processingAnimals = npcs.filter(npc => npc.state === 'processing');\n    \n\n    if (processingAnimals.length === 0) {\n      updateStatus('No animals are ready to collect.');\n      return;\n    }\n    \n    // Find the appropriate worker NPC to apply busy overlay (Farmer or Rancher)\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Count how many of each animal type is ready\n    const animalCounts = {};\n    processingAnimals.forEach((npc) => {\n      animalCounts[npc.type] = (animalCounts[npc.type] || 0) + 1;\n    });\n\n    // Create array of available animals with counts and symbols\n    const animalsWithDetails = Object.entries(animalCounts).map(([animalType, count]) => {\n      const resourceDef = masterResources.find(res => res.type === animalType);\n      return {\n        type: animalType,\n        count,\n        symbol: resourceDef?.symbol || ''\n      };\n    });\n\n    setAvailableAnimals(animalsWithDetails);\n    \n    // Select all animals by default\n    const defaultSelection = {};\n    animalsWithDetails.forEach(animal => {\n      defaultSelection[animal.type] = true;\n    });\n    setSelectedAnimalTypes(defaultSelection);\n    \n    setIsAnimalModalOpen(true);\n  }\n\n  async function executeSelectiveAnimalCollect() {\n    setIsAnimalModalOpen(false);\n    onClose();\n    setErrorMessage('');\n    \n    // Find the appropriate worker NPC to apply busy overlay (Farmer or Rancher)\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-animal-collect-${Date.now()}`;\n    startBulkOperation('bulk-animal-collect', operationId);\n\n    // Execute bulk operation with shared function\n    await executeBulkOperation('bulk-animal-collect', operationId, workerNPC, async () => {\n      return await executeBulkAnimalCollect({\n        selectedAnimalTypes,\n        gridId,\n        currentPlayer,\n        setCurrentPlayer,\n        setInventory,\n        setBackpack,\n        setResources,\n        updateStatus,\n        TILE_SIZE,\n        masterResources,\n        masterSkills,\n        strings\n      });\n    });\n    \n    onClose();\n  }\n\n\n\n  async function handleLogging() {\n    console.log(' Logging initiated ');\n    onClose();\n    setErrorMessage('');\n\n    const safeInventory = Array.isArray(inventory) ? inventory : [];\n    const safeBackpack = Array.isArray(backpack) ? backpack : [];\n    \n    // Find the appropriate worker NPC to apply busy overlay (Lumberjack or Farmer)\n    let npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Lumberjack'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-logging-${Date.now()}`;\n    startBulkOperation('bulk-logging', operationId);\n\n    try {\n      // Step 1: Determine how many trees we can chop\n      const loggingSkills = (currentPlayer.skills || []).filter(\n        (skill) => ['Logging', 'Better Logging'].includes(skill.type)\n      );\n      const maxTrees = loggingSkills.reduce((sum, skill) => {\n        const resourceDef = masterResources.find(res => res.type === skill.type);\n        return sum + (resourceDef?.qtycollected || 0);\n      }, 0);\n\n      if (maxTrees === 0) {\n        updateStatus(\"No logging skills available.\");\n        return;\n      }\n\n      // Step 2: Find the center position for tree selection (Lumberjack  Farmer  Player)\n      const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n      const lumberjackNPC = npcs.find(npc => npc.type === 'Lumberjack');\n      const farmerNPC = npcs.find(npc => npc.type === 'Farmer' || npc.type === 'Farm Hand');\n      \n      let centerPos;\n      let centerType;\n      \n      if (lumberjackNPC) {\n        centerPos = lumberjackNPC.position;\n        centerType = \"Lumberjack\";\n      } else if (farmerNPC) {\n        centerPos = farmerNPC.position;\n        centerType = \"Farmer\";\n      } else {\n        // Use player position as fallback\n        const playerData = playersInGridManager.getPlayersInGrid(gridId)?.[currentPlayer.playerId];\n        if (playerData && playerData.position) {\n          centerPos = playerData.position;\n          centerType = \"Player\";\n        } else {\n          // Ultimate fallback to (0,0) if no player position found\n          centerPos = { x: 0, y: 0 };\n          centerType = \"Default\";\n        }\n      }\n      \n      console.log(` Using ${centerType} position as center: (${centerPos.x}, ${centerPos.y})`);\n\n      // Step 3: Get all trees from resources and calculate distances from center position\n      const treeResources = resources\n        .filter(res => res.type === 'Oak Tree')\n        .map(tree => ({\n          ...tree,\n          distance: Math.sqrt(\n            Math.pow(tree.x - centerPos.x, 2) + \n            Math.pow(tree.y - centerPos.y, 2)\n          )\n        }))\n        .sort((a, b) => a.distance - b.distance); // Sort by distance from center\n\n      if (treeResources.length === 0) {\n        updateStatus(strings[437] || 'No trees available to chop.');\n        return;\n      }\n\n      // Select the closest trees up to maxTrees limit\n      const treesToChop = treeResources.slice(0, maxTrees);\n      console.log(` Found ${treeResources.length} trees, will chop ${treesToChop.length} closest to Lumberjack`);\n      const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n      // ---- Two-phase processing ----\n      const choppedTreePositions = [];\n\n      // Phase 1: Chop trees and remember positions\n      for (const tree of treesToChop) {\n        await handleSourceConversion(\n          tree,\n          tree.y,\n          tree.x,\n          resources,\n          setResources,\n          safeInventory,\n          setInventory,\n          safeBackpack,\n          setBackpack,\n          gridId,\n          FloatingTextManager.addFloatingText,\n          TILE_SIZE,\n          currentPlayer,\n          setCurrentPlayer,\n          masterResources,\n          () => {}, // setModalContent\n          () => {}, // setIsModalOpen\n          updateStatus,\n          strings\n        );\n        choppedTreePositions.push({ x: tree.x, y: tree.y });\n        await wait(100);\n      }\n\n      await wait(300); // give state time to update\n\n      // Phase 2: Click doobers at chopped positions\n      setTimeout(async () => {\n        for (const pos of choppedTreePositions) {\n          // Get the most up-to-date resources state\n          const latestResources = typeof setResources === 'function'\n            ? await new Promise(resolve => {\n                setResources(prev => {\n                  resolve(prev);\n                  return prev;\n                });\n              })\n            : resources;\n          const wood = latestResources.find(\n            res => res.x === pos.x && res.y === pos.y && res.category === 'doober'\n          );\n          console.log(' Found wood doober at', pos, ':', wood);\n          if (wood) {\n            console.log('Calling handleDooberClick');\n            await handleDooberClick(\n              wood,\n              wood.y,\n              wood.x,\n              resources,\n              setResources,\n              setInventory,\n              setBackpack,\n              safeInventory,\n              safeBackpack,\n              currentPlayer.skills,\n              gridId,\n              FloatingTextManager.addFloatingText,\n              TILE_SIZE,\n              currentPlayer,\n              setCurrentPlayer,\n              updateStatus,\n              masterResources,\n              masterSkills,\n              strings,\n              null, // openPanel\n              globalTuning\n            );\n            await wait(100);\n          } else {\n            console.warn(' No doober found at position:', pos);\n          }\n        }\n        updateStatus(` Logging complete: ${treesToChop.length} trees chopped and collected.`);\n      }, 50);\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n    } catch (error) {\n      console.error('Logging failed:', error);\n      setErrorMessage('Failed to auto-chop trees.');\n    } finally {\n      // End bulk operation tracking\n      endBulkOperation(operationId);\n      \n      // Clear busy overlay when operation completes\n      const npcsCleanup = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n      const workerNPCCleanup = npcsCleanup.find(npc => npc.action === 'worker' && ['Farmer', 'Lumberjack'].includes(npc.type));\n      if (workerNPCCleanup) {\n        clearNPCOverlay(workerNPCCleanup.id);\n      }\n    }\n  }\n\n\n  async function handleBulkHarvest() {\n    // First, force FarmState to process any pending seeds\n    const farmState = await import('../../FarmState').then(m => m.default);\n    await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n    \n    // Stop FarmState timer to prevent conversions during modal\n    farmState.stopSeedTimer();\n    \n    // Wait a moment for state updates to propagate\n    await new Promise(resolve => setTimeout(resolve, 200));\n    \n    // Now get fresh resources from global state\n    const freshResources = GlobalGridStateTilesAndResources.getResources();\n    const crops = prepareBulkHarvestData(freshResources, masterResources);\n\n    if (crops.length === 0) {\n      updateStatus(strings[344] || 'No crops ready for harvest.');\n      // Restart FarmState timer if no crops\n      farmState.initializeFarmState(freshResources);\n      farmState.startSeedTimer({ gridId, setResources, masterResources });\n      return;\n    }\n    \n    setAvailableCrops(crops);\n    setIsHarvestModalOpen(true);\n  }\n  \n  // Function to get fresh crop data at any time\n  const getFreshCropData = React.useCallback(async () => {\n    // Force sync before getting data\n    const farmState = await import('../../FarmState').then(m => m.default);\n    await farmState.forceProcessPendingSeeds({ gridId, setResources, masterResources });\n    await new Promise(resolve => setTimeout(resolve, 100));\n    \n    const freshResources = GlobalGridStateTilesAndResources.getResources();\n    return prepareBulkHarvestData(freshResources, masterResources);\n  }, [gridId, setResources, masterResources]);\n \n  async function executeSelectiveHarvest(selectedCropTypes, selectedReplantTypes) {\n    setIsHarvestModalOpen(false);\n    setErrorMessage('');\n\n    // Find the Farmer NPC to apply busy overlay\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const farmerNPC = npcs.find(npc => npc.action === 'worker');\n    if (farmerNPC) {\n      setBusyOverlay(farmerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-harvest-${Date.now()}`;\n    startBulkOperation('bulk-harvest', operationId);\n\n    try {\n      // Execute bulk operation with shared function\n      await executeBulkOperation('bulk-harvest', operationId, farmerNPC, async () => {\n        const result = await executeBulkHarvest({\n          selectedCropTypes,\n          selectedReplantTypes,\n          resources: GlobalGridStateTilesAndResources.getResources(),  // Always use fresh resources\n          masterResources,\n          masterSkills,\n          currentPlayer,\n          setCurrentPlayer,\n          setInventory,\n          setBackpack,\n          setResources,\n          gridId,\n          showBulkReplant,\n          strings,\n          refreshPlayerAfterInventoryUpdate,\n          globalTuning\n        });\n\n        // Handle the new results format\n        if (result.success) {\n          // Store results for modal display\n          setBulkHarvestResults(result);\n          // Show results modal after a brief delay\n          setTimeout(() => {\n            setIsResultsModalOpen(true);\n          }, 500);\n          // Return status message for any fallback displays\n          return result.statusMessage;\n        } else {\n          // Return error message\n          return result.error;\n        }\n      });\n    } finally {\n      // Always restart FarmState timer after harvest\n      const farmState = await import('../../FarmState').then(m => m.default);\n      const currentResources = GlobalGridStateTilesAndResources.getResources();\n      farmState.initializeFarmState(currentResources);\n      farmState.startSeedTimer({ gridId, setResources, masterResources });\n    }\n  }\n\n\n  function handleBulkCrafting() {\n    console.log(' Opening selective crafting modal');\n    \n    const stationGroups = prepareBulkCraftingData(masterResources, inventory, backpack, currentPlayer, hasRequiredSkill);\n    \n    if (stationGroups.length === 0) {\n      updateStatus(strings[466] || 'No crafting stations ready to collect.');\n      return;\n    }\n    \n    const stationsWithDetails = stationGroups;\n    setAvailableCraftingStations(stationsWithDetails);\n    \n    // Select all stations by default\n    const defaultSelection = {};\n    stationsWithDetails.forEach(group => {\n      defaultSelection[`${group.stationType}-${group.craftedItem}`] = true;\n    });\n    setSelectedCraftingStations(defaultSelection);\n    \n    // If player has Bulk Restart Craft skill, pre-select restart options only if player has enough ingredients\n    if (hasBulkRestartCraft) {\n      const defaultRestartSelection = {};\n      const playerInventory = {};\n      \n      // Combine inventory and backpack\n      [...(inventory || []), ...(backpack || [])].forEach(item => {\n        playerInventory[item.type] = (playerInventory[item.type] || 0) + item.quantity;\n      });\n      \n      stationsWithDetails.forEach(group => {\n        const craftedResource = masterResources.find(r => r.type === group.craftedItem);\n        if (craftedResource) {\n          // Check if player has all ingredients\n          let hasAllIngredients = true;\n          for (let i = 1; i <= 5; i++) {\n            const ingredientType = craftedResource[`ingredient${i}`];\n            const ingredientQty = craftedResource[`ingredient${i}qty`] || 1;\n            if (ingredientType) {\n              const needed = ingredientQty * group.count;\n              const has = playerInventory[ingredientType] || 0;\n              if (has < needed) {\n                hasAllIngredients = false;\n                break;\n              }\n            }\n          }\n          \n          // Only pre-select if player has all ingredients\n          if (hasAllIngredients) {\n            defaultRestartSelection[`${group.stationType}-${group.craftedItem}`] = true;\n          }\n        }\n      });\n      setSelectedRestartStations(defaultRestartSelection);\n    } else {\n      setSelectedRestartStations({});\n    }\n    \n    setIsCraftingModalOpen(true);\n  }\n\n  async function executeSelectiveCrafting(selectedGroups, selectedRestartStations) {\n    setIsCraftingModalOpen(false);\n    setErrorMessage('');\n    \n    // Find the appropriate worker NPC to apply busy overlay\n    const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n    const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Crafter'].includes(npc.type));\n    if (workerNPC) {\n      setBusyOverlay(workerNPC.id);\n    }\n\n    // Start bulk operation tracking\n    const operationId = `bulk-crafting-${Date.now()}`;\n    startBulkOperation('bulk-crafting', operationId);\n\n    // Execute bulk operation with shared function\n    await executeBulkOperation('bulk-crafting', operationId, workerNPC, async () => {\n      return await executeBulkCrafting({\n        selectedGroups,\n        selectedRestartStations,\n        hasBulkRestartCraft,\n        currentPlayer,\n        setCurrentPlayer,\n        inventory,\n        setInventory,\n        backpack,\n        setBackpack,\n        setResources,\n        gridId,\n        masterResources,\n        masterSkills,\n        strings,\n        updateStatus,\n        globalTuning\n      });\n    });\n    \n    onClose();\n  }\n\n  async function restartCrafting(station, recipe, strings) {\n    if (!recipe) {\n      console.log(`No recipe found for restarting craft at station (${station.x}, ${station.y})`);\n      return false;\n    }\n\n    // Check affordability using the same logic as CraftingStation\n    const affordable = canAfford(recipe, inventory, Array.isArray(backpack) ? backpack : [], 1);\n    if (!affordable) {\n      console.log(`Cannot afford to restart ${recipe.type} at station (${station.x}, ${station.y})`);\n      return false;\n    }\n\n    // Check skill requirements\n    const requirementsMet = !recipe.requires || currentPlayer.skills?.some((owned) => owned.type === recipe.requires);\n    if (!requirementsMet) {\n      console.log(`Missing required skill ${recipe.requires} to restart ${recipe.type}`);\n      return false;\n    }\n\n    // Call crafting API directly\n    const transactionId = `bulk-restart-${Date.now()}-${Math.random()}`;\n    const transactionKey = `crafting-start-${recipe.type}-${station.x}-${station.y}`;\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: station.x,\n        stationY: station.y,\n        recipe,\n        transactionId,\n        transactionKey\n      });\n      \n      if (response.data.success) {\n        // Update global state with new craft\n        const { craftEnd, craftedItem, inventory: newInventory, backpack: newBackpack } = response.data;\n        \n        // Update inventory from server response\n        if (newInventory) {\n          setInventory(newInventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory: newInventory }));\n        }\n        if (newBackpack) {\n          setBackpack(newBackpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack: newBackpack }));\n        }\n        \n        // Update the specific station resource in global state\n        const updatedResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === station.x && res.y === station.y\n            ? { ...res, craftEnd, craftedItem }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedResources);\n        setResources(updatedResources);\n        \n        FloatingTextManager.addFloatingText(404, station.x, station.y, TILE_SIZE);\n        // Status update will be handled in bulk after all operations complete\n        console.log(` Restarted crafting ${recipe.type} at station (${station.x}, ${station.y})`);\n        return true;\n      }\n    } catch (error) {\n      console.error(`Failed to restart crafting at station (${station.x}, ${station.y}):`, error);\n      if (error.response?.status === 400) {\n        console.log('Not enough ingredients to restart crafting');\n      }\n    }\n    \n    return false;\n  }\n\n  const getSkillTooltip = (skillType) => {\n    switch (skillType) {\n      case 'Bulk Harvest':\n        return strings[427]; // \"Purchase the Farm Hand's Bulk Harvest skill in order to harvest all crops at once.\"\n      case 'Bulk Animal Collect':\n        return strings[431]; // Add a new string in your strings file if needed\n      case 'Logging':\n        return strings[432]; // Add a new string in your strings file if needed\n      case 'Better Logging':\n        return strings[433]; // Add a new string in your strings file if needed\n      case 'Bulk Crafting':\n        return strings[464]; // Add a new string in your strings file if needed\n      case 'Bulk Restart Craft':\n        return strings[468] || 'Automatically restart crafting after collection'; // Add a new string in your strings file if needed\n      default:\n        return '';\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1023\" title={npc?.symbol ? `${npc.symbol} ${npcType}` : npcType} panelName=\"FarmHandPanel\">\n      <div className=\"standard-panel\">\n\n        {showBulkHarvest && skills?.some(item => item.type === 'Bulk Harvest') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Harvest', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[428]}\n              onClick={handleBulkHarvest}\n            />\n          </div>\n        )}\n        {showBulkAnimalCollect && skills?.some(item => item.type === 'Bulk Animal Collect') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Animal Collect', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[434]}\n              onClick={handleBulkAnimalCollect}\n            />\n          </div>\n        )}\n        {showLogging && skills?.some(item => item.type === 'Logging') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Logging', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[435]}\n              onClick={handleLogging}\n            />\n          </div>\n        )}\n        {showBulkCrafting && skills?.some(item => item.type === 'Bulk Crafting') && (\n          <div>\n            <ResourceButton\n              symbol=\"\"\n              name={getLocalizedString('Bulk Crafting', strings)}\n              className=\"resource-button bulk-skill\"\n              details={strings[465]}\n              onClick={handleBulkCrafting}\n            />\n          </div>\n        )}\n\n        {workerSkills.length > 0 && (\n          <>\n            <h3>{strings[430]}</h3>\n\n            {workerSkills.map((resource) => {\n              const affordable = canAfford(resource, inventory, 1, backpack);\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = resource[`ingredient${i}`];\n                const qty = resource[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n                const playerQty = (inventory.find((item) => item.type === type)?.quantity || 0) +\n                                  (backpack.find((item) => item.type === type)?.quantity || 0);\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${type} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const details = `Costs:<div>${formattedCosts}</div>`;\n\n              return (\n                <ResourceButton\n                  key={resource.type}\n                  symbol={resource.symbol}\n                  name={resource.type}\n                  className=\"resource-button\"\n                  details={details}\n                  onClick={() => handlePurchaseSkill(resource)}\n                  disabled={!affordable}\n                  info={getSkillTooltip(resource.type) ? <div>{getSkillTooltip(resource.type)}</div> : undefined}\n                />\n              );\n            })}\n          </>\n        )}\n\n        {showCropPurchase && (\n          <>\n            <h3>{strings[426]}</h3>\n            {recipes?.length > 0 ? (\n              recipes.map((resource) => {\n                const cost = (resource.maxprice || 100) * 10;\n                const playerMoney = (inventory.find((item) => item.type === 'Money')?.quantity || 0) +\n                                    (backpack.find((item) => item.type === 'Money')?.quantity || 0);\n                const affordable = playerMoney >= cost;\n                const details = `${strings[347]}  ${cost}`;\n                return (\n                  <ResourceButton\n                    key={resource.type}\n                    symbol={resource.symbol}\n                    name={resource.type}\n                    className=\"resource-button\"\n                    details={details}\n                    disabled={!affordable}\n                    onClick={() => handleTrade(resource)}\n                  />\n                );\n              })\n            ) : <p>{strings[423]}</p>}\n          </>\n        )}\n\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n\n      </div>\n      \n      {/* Selective Harvest Modal */}\n\n      <BulkHarvestModal\n        isOpen={isHarvestModalOpen}\n        onClose={async () => {\n          setIsHarvestModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker');\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n          \n          // Restart FarmState timer\n          const farmState = await import('../../FarmState').then(m => m.default);\n          const currentResources = GlobalGridStateTilesAndResources.getResources();\n          farmState.initializeFarmState(currentResources);\n          farmState.startSeedTimer({ gridId, setResources, masterResources });\n        }}\n        crops={availableCrops}\n        getFreshCrops={getFreshCropData}\n        onExecute={executeSelectiveHarvest}\n        showBulkReplant={showBulkReplant}\n        hasRequiredSkill={hasRequiredSkill}\n        strings={strings}\n        currentSeason={currentSeason}\n        masterResources={masterResources}\n      />\n      \n      {/* Selective Animal Collect Modal */}\n\n      <BulkAnimalModal\n        isOpen={isAnimalModalOpen}\n        onClose={() => {\n          setIsAnimalModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Rancher'].includes(npc.type));\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n        }}\n        animals={availableAnimals}\n        onExecute={() => executeSelectiveAnimalCollect()}\n        strings={strings}\n      />\n      \n      {/* Selective Crafting Modal */}\n\n      <BulkCraftingModal\n        isOpen={isCraftingModalOpen}\n        onClose={() => {\n          setIsCraftingModalOpen(false);\n          // Clear busy overlay when modal is closed\n          const npcs = Object.values(NPCsInGridManager.getNPCsInGrid(gridId) || {});\n          const workerNPC = npcs.find(npc => npc.action === 'worker' && ['Farmer', 'Crafter'].includes(npc.type));\n          if (workerNPC) {\n            clearNPCOverlay(workerNPC.id);\n          }\n        }}\n        stationGroups={availableCraftingStations}\n        onExecute={executeSelectiveCrafting}\n        hasBulkRestartCraft={hasBulkRestartCraft}\n        strings={strings}\n        masterResources={masterResources}\n        inventory={inventory}\n        backpack={backpack}\n      />\n      \n      {/* Bulk Operation Progress Modal */}\n\n      <ProgressModal\n        isOpen={bulkProgressModal.isOpen}\n        title={strings[478] || \"Processing...\"}\n        message={bulkProgressModal.message}\n      />\n\n      {/* Bulk Harvest Results Modal */}\n      <BulkHarvestResultsModal\n        isOpen={isResultsModalOpen}\n        onClose={() => {\n          setIsResultsModalOpen(false);\n          setBulkHarvestResults(null);\n        }}\n        results={bulkHarvestResults}\n        strings={strings}\n        masterResources={masterResources}\n      />\n    </Panel>\n  );\n\n\n};\n\nexport default React.memo(FarmHandPanel);","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport '../../UI/Buttons/ResourceButton.css';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport { canAfford, hasRoomFor } from '../../Utils/InventoryManagement';\nimport { spendIngredients, gainIngredients, refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useStrings } from '../../UI/StringsContext';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport './ScrollStation.css'; // Import for shared station panel styles\nimport { getDerivedLevel } from '../../Utils/playerManagement';\n\nconst ShopStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  masterTraders,\n  masterTrophies,\n  isDeveloper,\n  globalTuning,\n  masterXPLevels,\n}) => {\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [stationEmoji, setStationEmoji] = useState('');\n  const [stationDetails, setStationDetails] = useState(null);\n  const [fetchTrigger, setFetchTrigger] = useState(0);\n\n  const hasRequirement = (requirement) => {\n    return (\n      !requirement ||\n      currentPlayer.skills?.some(skill => skill.type === requirement) ||\n      currentPlayer.powers?.some(power => power.type === requirement)\n    );\n  };\n\n  // Check if player meets the level requirement for a resource\n  const playerLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n  const meetsLevelRequirement = (resourceLevel) => {\n    if (!resourceLevel) return true; // No level requirement\n    return playerLevel >= resourceLevel;\n  };\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  useEffect(() => {\n    if (!masterResources || !stationType) return;\n\n    // First check if this shop has trades defined in masterTraders\n    const traderOffers = masterTraders?.filter(t => t.trader === stationType);\n\n    if (traderOffers && traderOffers.length > 0) {\n      // Transform each trader offer into the recipe format expected by the component\n      const filteredRecipes = traderOffers.map(offer => {\n        const resourceDef = masterResources.find(r => r.type === offer.gives);\n\n        const recipe = {\n          type: offer.gives,\n          symbol: resourceDef?.symbol || '?',\n          qtycollected: offer.givesqty || 1,\n          source: stationType,\n          gemcost: resourceDef?.gemcost || null,\n          index: offer.index,\n          repeat: offer.repeat,\n          level: resourceDef?.level,\n          requires: resourceDef?.requires,\n          category: resourceDef?.category\n        };\n\n        // Collect all requires fields into ingredient format\n        let ingredientCount = 1;\n        for (let i = 1; i <= 7; i++) {\n          const requiresField = `requires${i}`;\n          const requiresQtyField = `requires${i}qty`;\n\n          if (offer[requiresField]) {\n            recipe[`ingredient${ingredientCount}`] = offer[requiresField];\n            recipe[`ingredient${ingredientCount}qty`] = offer[requiresQtyField] || 1;\n            ingredientCount++;\n          }\n        }\n\n        return recipe;\n      });\n\n      // Filter out powers the player already has\n      const finalRecipes = filteredRecipes.filter(recipe =>\n        recipe.category !== 'power' ||\n        !currentPlayer.powers?.some(p => p.type === recipe.type)\n      );\n\n      setRecipes(finalRecipes);\n    } else {\n      // Fallback to old method using masterResources.source\n      const filteredRecipes = masterResources.filter((resource) =>\n        resource.source === stationType &&\n        (!currentPlayer.powers || !currentPlayer.powers.some(p => p.type === resource.type))\n      );\n      setRecipes(filteredRecipes);\n    }\n\n    const stationResource = masterResources.find((resource) => resource.type === stationType);\n    setStationEmoji(stationResource?.symbol || '');\n    setStationDetails(stationResource);\n  }, [stationType, fetchTrigger, masterResources, masterTraders, currentPlayer.powers]);\n\n\n  const handleGemPurchase = async (modifiedRecipe) => {\n    // This is called by the gem button with a recipe modified to include gems\n    return handlePurchase(modifiedRecipe);\n  };\n\n  const handlePurchase = async (recipe) => {\n    setErrorMessage('');\n    if (!recipe) {\n      setErrorMessage('Invalid recipe selected.');\n      return;\n    }\n\n    // For non-power items, check if there's room before spending money\n    if (recipe.category !== \"power\") {\n      const quantity = recipe.qtycollected || 1;\n      const hasRoom = hasRoomFor({\n        resource: recipe.type,\n        quantity: quantity,\n        currentPlayer,\n        inventory: inventory,\n        backpack: backpack,\n        masterResources,\n        globalTuning\n      });\n      \n      if (!hasRoom) {\n        const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n        const isMoney = recipe.type === \"Money\";\n        const isGem = recipe.type === \"Gem\";\n        \n        if (!isMoney && !isGem && !isHomestead) {\n          // Check if player has backpack skill\n          const hasBackpackSkill = currentPlayer?.skills?.some((item) => item.type === 'Backpack' && item.quantity > 0);\n          if (!hasBackpackSkill) {\n            updateStatus(19); // Missing backpack\n          } else {\n            updateStatus(21); // Backpack full\n          }\n        } else {\n          updateStatus(20); // Warehouse full\n        }\n        return;\n      }\n    }\n\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe,\n      inventory,\n      backpack,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      updateStatus,\n    });\n    if (!success) return;\n\n    // Refresh player to update money display after any purchase\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    const tradedQty = 1;\n\n    if (recipe.category === \"power\") {\n      const updatedPowers = [...(currentPlayer.powers || [])];\n      const powerIndex = updatedPowers.findIndex(p => p.type === recipe.type);\n      if (powerIndex >= 0) {\n        updatedPowers[powerIndex].quantity += tradedQty;\n      } else {\n        updatedPowers.push({ type: recipe.type, quantity: tradedQty });\n      }\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId: currentPlayer.playerId,\n        powers: updatedPowers,\n      });\n      setCurrentPlayer(prev => ({\n        ...prev,\n        powers: updatedPowers,\n      }));\n      // Helper functions to categorize powers\n      const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n      const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n      const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n      \n      // Only update combat stats for magic enhancements (not weapons/armor)\n      if (isMagicEnhancement(recipe)) {\n        const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer.playerId];\n        if (gridPlayer) {\n          const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n          const statUpdates = {};\n          \n          // Check for combat attributes on this power\n          combatAttributes.forEach(attr => {\n            if (typeof recipe[attr] === 'number') {\n              const oldValue = gridPlayer[attr] || 0;\n              const newValue = oldValue + recipe[attr];\n              statUpdates[attr] = newValue;\n              console.log(` Updated ${attr} for player ${currentPlayer.playerId}: ${oldValue} -> ${newValue}`);\n            }\n          });\n          \n          // Update all modified stats at once\n          if (Object.keys(statUpdates).length > 0) {\n            await playersInGridManager.updatePC(gridId, currentPlayer.playerId, statUpdates);\n          }\n        }\n      } else {\n        // Weapons and armor don't update combat stats until equipped\n        console.log(`${recipe.type} added to inventory - equip in Combat Panel to apply stats`);\n        \n        // Send notification for newly purchased equipment\n        showNotification('Message', {\n          title: strings[7004] || 'Note:',\n          message: strings[7017] || 'Equip in Combat Panel to use'\n        });\n      }\n    }\n    else {\n      const gainSuccess = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: recipe.type,\n        quantity: recipe.qtycollected || 1,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      if (!gainSuccess) {\n        console.warn(`Failed to gain ${recipe.type}`);\n        return;\n      }\n    }\n\n    await trackQuestProgress(currentPlayer, 'Buy', recipe.type, tradedQty, setCurrentPlayer);\n\n    updateStatus(`${strings[80]} ${recipe.type}.`);\n    \n    // Award Mariner trophy if purchased a Boat\n    if (recipe.type === 'Boat' && currentPlayer?.playerId) {\n      earnTrophy(currentPlayer.playerId, 'Mariner', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n    }\n\n    // Award King's Crown trophy if purchased King's Crown\n    if (recipe.type === \"King's Crown\" && currentPlayer?.playerId) {\n      earnTrophy(currentPlayer.playerId, \"King's Crown\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n    }\n\n    // Award Trident trophy if purchased Trident\n    if (recipe.type === \"Trident\" && currentPlayer?.playerId) {\n      earnTrophy(currentPlayer.playerId, \"Trident\", 1, currentPlayer, masterTrophies, setCurrentPlayer);\n    }\n\n    setFetchTrigger(prev => prev + 1);\n  };\n\n  const handleSellStation = async () => {\n    try {\n      const success = await handleProtectedSelling({\n        currentPlayer,\n        stationType,\n        currentStationPosition,\n        gridId,\n        setResources,\n        setInventory,\n        setCurrentPlayer,\n        updateStatus,\n        onClose,\n        devOnly: true,\n      });\n      \n      if (success) {\n        onClose();\n      }\n    } catch (error) {\n      console.error('Error selling station:', error);\n      updateStatus('Failed to sell station');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1025\" title={`${stationEmoji} ${stationType}`} panelName=\"ShopStation\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n          {/*  Conditional TENT text for the Store */}\n          {stationType === \"Store\" && (\n            <p style={{ fontWeight: \"bold\", color: \"#4CAF50\" }}>\n              {strings[\"410\"]}\n            </p>\n          )}\n          {recipes?.length > 0 ? (\n            (() => {\n              // Filter out non-repeatable items the player already has\n              const filteredRecipes = recipes.filter((recipe) => {\n                if (recipe.repeat === false) {\n                  const hasInInventory = inventory?.some(item => item.type === recipe.type);\n                  const hasInBackpack = backpack?.some(item => item.type === recipe.type);\n                  if (hasInInventory || hasInBackpack) {\n                    return false;\n                  }\n                }\n                return true;\n              });\n\n              // If all trades were filtered out, show a message\n              if (filteredRecipes.length === 0) {\n                return <p>{strings[423]}</p>;\n              }\n\n              return filteredRecipes.map((recipe) => {\n              const affordable = canAfford(recipe, inventory, backpack, 1);\n              const meetsSkillRequirement = hasRequirement(recipe.requires);\n              const meetsLevel = meetsLevelRequirement(recipe.level);\n              const requirementsMet = meetsSkillRequirement && meetsLevel;\n\n              // Handle multiple combat attributes for powers\n              let outputSummary = null;\n              if (recipe.category === 'power') {\n                const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                const effects = [];\n                \n                combatAttributes.forEach(attr => {\n                  if (typeof recipe[attr] === 'number') {\n                    const label = strings[attr] || attr;\n                    effects.push(`${recipe[attr] > 0 ? '+' : ''}${recipe[attr]} ${label}`);\n                  }\n                });\n                \n                \n                if (effects.length > 0) {\n                  outputSummary = <span style={{ color: 'blue' }}>{effects.join(', ')}</span>;\n                }\n              }\n\n              // Format costs in UI standard style\n              const formattedCosts = [1, 2, 3, 4].map((i) => {\n                const type = recipe[`ingredient${i}`];\n                const qty = recipe[`ingredient${i}qty`];\n                if (!type || !qty) return '';\n                const inventoryQty = inventory?.find(inv => inv.type === type)?.quantity || 0;\n                const backpackQty = backpack?.find(item => item.type === type)?.quantity || 0;\n                const playerQty = inventoryQty + backpackQty;\n                const color = playerQty >= qty ? 'green' : 'red';\n                const symbol = masterResources.find(r => r.type === type)?.symbol || '';\n                return `<span style=\"color: ${color}; display: block;\">${symbol} ${type} ${qty} / ${playerQty}</span>`;\n              }).join('');\n\n              const skillColor = meetsSkillRequirement ? 'green' : 'red';\n              const levelColor = meetsLevel ? 'green' : 'red';\n\n              // Build details string with multiple combat attributes for powers\n              let effectsHtml = '';\n              if (recipe.category === 'power') {\n                const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                const effects = [];\n                \n                combatAttributes.forEach(attr => {\n                  if (typeof recipe[attr] === 'number') {\n                    const label = strings[attr] || attr;\n                    effects.push(`${recipe[attr] > 0 ? '+' : ''}${recipe[attr]} ${label}`);\n                  }\n                });\n                \n                \n                if (effects.length > 0) {\n                  effectsHtml = `<span style=\"color: blue;\">${effects.join(', ')}</span><br>`;\n                }\n              }\n\n              const details =\n                effectsHtml +\n                (recipe.level ? `<span style=\"color: ${levelColor};\">${strings[10149] || 'Level'} ${recipe.level}</span>` : '') +\n                (recipe.requires ? `<span style=\"color: ${skillColor};\">${strings[460] || 'Requires:'} ${recipe.requires}</span>` : '') +\n                `${strings[461] || 'Costs:'}<div>${formattedCosts}</div>`;\n\n              let infoContent = null;\n              \n              // Special tooltip content for Tent and Boat at General Store\n              if (stationType === \"Store\" || stationType === \"General Store\") {\n                if (recipe.type === \"Tent\") {\n                  infoContent = <div>{strings[81]}</div>; // \"Pitching a tent in Town or the Valley prevents you from being attacked.\"\n                } else if (recipe.type === \"Boat\") {\n                  infoContent = <div>{strings[82]}</div>; // \"A boat will allow you to travel by water.\"\n                }\n              }\n              \n              // For other items (like powers), show combat attributes\n              if (!infoContent && outputSummary) {\n                infoContent = (\n                  <div style={{ marginBottom: '4px' }}>\n                    <strong>{outputSummary}</strong>\n                  </div>\n                );\n              }\n              \n              const info = infoContent ? (\n                <div className=\"info-content\">\n                  {infoContent}\n                </div>\n              ) : null;\n              \n              return (\n                <ResourceButton\n                  key={recipe.type}\n                  symbol={recipe.symbol}\n                  name={recipe.type}\n                  className=\"resource-button\"\n                  details={details}\n                  info={info}\n                  disabled={!affordable || !requirementsMet}\n                  onClick={() => handlePurchase(recipe)}\n                  // Gem purchase props - don't pass gemCost to allow dynamic calculation\n                  gemCost={null}\n                  onGemPurchase={(recipe.gemcost && (!affordable || !requirementsMet)) ? handleGemPurchase : null}\n                  meetsLevelRequirement={meetsLevel}\n                  resource={recipe}\n                  inventory={inventory}\n                  backpack={backpack}\n                  masterResources={masterResources}\n                  currentPlayer={currentPlayer}\n                >\n                </ResourceButton>\n              );\n            });\n            })()\n          ) : <p>{strings[423]}</p>}\n\n          {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n        \n        {isDeveloper && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <TransactionButton\n                className=\"btn-basic btn-danger\"\n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[490]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(ShopStation);","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport '../../UI/Buttons/ResourceButton.css';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport NPCsInGridManager from '../../GridState/GridStateNPCs';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients } from '../../Utils/InventoryManagement';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { getRandomScrollReveal, getRevealDisplayString, canAffordReveal } from './ScrollReveal';\nimport { gainSkillOrPower } from '../../Utils/SkillPowerManagement';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport './ScrollStation.css';\n\nconst ScrollStation = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  currentSeason,\n  globalTuning,\n}) => {\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const strings = useStrings();\n  const [recipes, setRecipes] = useState([]);\n  const [allResources, setAllResources] = useState([]);\n  const [stationEmoji, setStationEmoji] = useState('');\n  const { updateStatus } = useContext(StatusBarContext);\n  const [stationDetails, setStationDetails] = useState(null);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [craftedItem, setCraftedItem] = useState(null);\n  const [craftingCountdown, setCraftingCountdown] = useState(null);\n  const [isCrafting, setIsCrafting] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [npcRefreshKey, setNpcRefreshKey] = useState(0);\n  const [scrollCount, setScrollCount] = useState(0);\n  const [revealedItemQty, setRevealedItemQty] = useState(1);\n  const [isCollecting, setIsCollecting] = useState(false);\n\n   //  Check for active crafting timers or revealed items\n   useEffect(() => {\n    if (!stationType || !currentStationPosition) return;\n\n    const checkStation = () => {\n      const station = GlobalGridStateTilesAndResources.getResources()?.find(\n        (res) => res.x === currentStationPosition.x && res.y === currentStationPosition.y\n      );\n      \n\n      if (station && station.craftEnd && station.craftedItem) {\n          // Check if this is a revealed item (craftEnd in the past)\n          const now = Date.now();\n          const isRevealed = station.craftEnd < now;\n          \n          setCraftedItem(station.craftedItem);\n          setRevealedItemQty(station.qty || 1);\n          \n          if (isRevealed) {\n              setIsCrafting(false);\n              setIsReadyToCollect(true);\n              setCraftingCountdown(0);\n              setActiveTimer(false);\n          } else {\n              // Normal crafting timer\n              setIsCrafting(true);\n              setActiveTimer(true);\n              \n              const remainingTime = Math.max(0, Math.floor((station.craftEnd - now) / 1000));\n              setCraftingCountdown(remainingTime);\n              \n              if (remainingTime === 0) {\n                  setIsCrafting(false);\n                  setIsReadyToCollect(true);\n              }\n          }\n      } else {\n          // Only reset if we actually had something before\n          if (craftedItem || isCrafting || isReadyToCollect) {\n            setCraftedItem(null);\n            setIsCrafting(false);\n            setIsReadyToCollect(false);\n            setCraftingCountdown(null);\n            setActiveTimer(false);\n            setRevealedItemQty(1);\n          }\n      }\n    };\n\n    // Initial check\n    checkStation();\n\n    // Set up interval to check for updates\n    const timer = setInterval(checkStation, 1000);\n    return () => clearInterval(timer);\n  }, [stationType, currentStationPosition, craftedItem, isCrafting, isReadyToCollect]); // Include state to ensure fresh closures\n\n\n  // Sync inventory with local storage and server\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n\n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  // Calculate scroll count from inventory and backpack\n  useEffect(() => {\n    const allItems = [...(inventory || []), ...(backpack || [])];\n    const scrolls = allItems.find(item => item.type === 'Scroll');\n    setScrollCount(scrolls?.quantity || 0);\n  }, [inventory, backpack]);\n\n  // Fetch recipes and resources (refactored: use masterResources directly)\n  useEffect(() => {\n    try {\n      let filteredRecipes = masterResources.filter((resource) => {\n        // Check if resource source matches station type\n        if (resource.source !== stationType) return false;\n        \n        // Check seasonal restriction\n        if (resource.season && currentSeason && resource.season !== currentSeason) {\n          return false;\n        }\n        \n        return true;\n      });\n      \n      // Filter out non-repeatable resources that already exist on the grid\n      const npcsInGrid = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (npcsInGrid) {\n        // Get all NPC types currently on the grid\n        // NPCs are stored directly under NPCsInGrid with their ID as the key\n        const existingNPCTypes = Object.values(npcsInGrid)\n          .filter(npc => npc && npc.type) // Filter out any null/undefined entries\n          .map(npc => npc.type);\n        \n        console.log('Existing NPC types on grid:', existingNPCTypes);\n        \n        // Filter out non-repeatable recipes that already exist\n        filteredRecipes = filteredRecipes.filter(recipe => {\n          // If it's not repeatable and already exists, filter it out\n          if (recipe.repeatable === false && existingNPCTypes.includes(recipe.type)) {\n            console.log(`Filtering out non-repeatable ${recipe.type} - already exists on grid`);\n            return false;\n          }\n          return true;\n        });\n      }\n      \n      setRecipes(filteredRecipes);\n      const stationResource = masterResources.find((resource) => resource.type === stationType);\n      setStationEmoji(stationResource?.symbol || '');\n      setStationDetails(stationResource);\n      setAllResources(masterResources || []);\n    } catch (error) {\n      console.error('Error processing masterResources:', error);\n    }\n  }, [stationType, masterResources, gridId, npcRefreshKey]);\n  \n  // Periodically refresh to check for NPC changes\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setNpcRefreshKey(prev => prev + 1);\n    }, 2000); // Check every 2 seconds\n    \n    return () => clearInterval(interval);\n  }, []);\n\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: !isHomestead, // Only verify developer status when NOT on homestead\n    });\n  };\n  \n  // Generate skill bonus message\n  const getSkillBonusMessage = () => {\n    // Find all skills that apply to this station\n    const applicableSkills = Object.entries(masterSkills || {})\n      .filter(([skillName, stations]) => {\n        return stations && typeof stations === 'object' && stations[stationType] > 1;\n      })\n      .map(([skillName, stations]) => ({\n        skillName,\n        multiplier: stations[stationType],\n        hasSkill: currentPlayer.skills?.some(item => item.type === skillName)\n      }));\n    \n    if (applicableSkills.length === 0) return null;\n    \n    // Separate owned and unowned skills\n    const ownedSkills = applicableSkills.filter(skill => skill.hasSkill);\n    const unownedSkills = applicableSkills.filter(skill => !skill.hasSkill);\n    \n    // Calculate combined multiplier for owned skills\n    const combinedMultiplier = ownedSkills.reduce((total, skill) => total * skill.multiplier, 1);\n    \n    let messages = [];\n    \n    // Message for owned skills\n    if (ownedSkills.length > 0) {\n      if (ownedSkills.length === 1) {\n        // Single skill: \"Your [skill] Skill increases the base output of this station by [X].\"\n        messages.push(`${strings[805]}${getLocalizedString(ownedSkills[0].skillName, strings)}${strings[806]}${ownedSkills[0].multiplier}x.`);\n      } else {\n        // Multiple skills: list them with their multipliers and show combined effect\n        const skillsList = ownedSkills\n          .map(skill => `${getLocalizedString(skill.skillName, strings)} (${skill.multiplier}x)`)\n          .join(' & ');\n        messages.push(`Your ${skillsList} skills combine to increase output by ${combinedMultiplier}x.`);\n      }\n    }\n    \n    // Message for unowned skills\n    if (unownedSkills.length > 0) {\n      unownedSkills.forEach(skill => {\n        const skillResource = allResources.find(res => res.type === skill.skillName);\n        const skillSource = skillResource?.source || 'Skill Shop';\n        // \"Acquire the [skill] Skill at the [source] to increase the output of this station by [X]x.\"\n        messages.push(`${strings[801]}${getLocalizedString(skill.skillName, strings)}${strings[802]}${getLocalizedString(skillSource, strings)}${strings[803]}${skill.multiplier}x.`);\n      });\n    }\n    \n    return messages.join(' ');\n  };\n\n  const skillMessage = getSkillBonusMessage();\n\n\n  // Handle reveal scroll - spend scroll and start crafting random item\n  const handleRevealScroll = async (transactionId, transactionKey) => {\n    \n    if (scrollCount === 0) {\n      updateStatus(strings[820] || 'You need at least 1 scroll to reveal');\n      return;\n    }\n\n    try {\n      // First, spend the scroll\n      const spentSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        recipe: { ingredient1: 'Scroll', ingredient1qty: 1 },\n        inventory: currentPlayer.inventory,  \n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n      });\n\n      if (!spentSuccess) {\n        updateStatus(strings[820] || 'Failed to spend scroll');\n        return;\n      }\n\n      // Generate random reward\n      const reward = getRandomScrollReveal(masterResources);\n      const rewardDisplay = getRevealDisplayString(reward, masterResources);\n      \n      // Get the Reveal Scroll resource to get crafttime\n      const revealScrollResource = masterResources.find(r => r.type === 'Reveal Scroll');\n      const craftTime = revealScrollResource?.crafttime || 30; // Default 30 seconds\n\n      // Now start crafting the revealed item using standard craft API\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        recipe: {\n          type: reward.type,\n          crafttime: craftTime,\n          // No ingredients since we already spent the scroll\n        },\n        qty: reward.quantity,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response if provided\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update station resource in global state with qty\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd, craftedItem, qty: reward.quantity }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setCraftedItem(craftedItem);\n        setRevealedItemQty(reward.quantity);\n        setCraftingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsCrafting(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Update status\n        FloatingTextManager.addFloatingText(strings[829], currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n\n        // Track quest progress for scroll spending\n        await trackQuestProgress(currentPlayer, 'Spend', 'Scroll', 1, setCurrentPlayer);\n\n      }\n    } catch (error) {\n      console.error('Error in scroll reveal process:', error);\n      updateStatus(strings[830]);\n    }\n  };\n\n  // Handle collection of revealed items (reuse standard collect logic)\n  const handleCollectReveal = async (transactionId, transactionKey) => {\n    \n    if (!craftedItem || isCollecting) { \n      console.error(\" No revealed item to collect or already collecting.\"); \n      return; \n    }\n\n    setIsCollecting(true);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentStationPosition.x,\n        stationY: currentStationPosition.y,\n        craftedItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        const { collectedItem, isNPC } = response.data;\n        const collectedQty = revealedItemQty || 1;\n\n        // Find the revealed item in master resources to check its category\n        const revealedResource = allResources.find(res => res.type === collectedItem);\n        \n        // Handle collection based on item category\n        if (isNPC) {\n          // Spawn NPC\n          const craftedResource = allResources.find(res => res.type === collectedItem);\n          if (craftedResource) {\n            NPCsInGridManager.spawnNPC(gridId, craftedResource, { x: currentStationPosition.x, y: currentStationPosition.y });\n          }\n          FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        } else if (revealedResource && (revealedResource.category === 'skill' || revealedResource.category === 'power')) {\n          // Check if player already has this skill/power\n          const alreadyOwned = revealedResource.category === 'skill' \n            ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n            : currentPlayer.powers?.some(power => power.type === collectedItem);\n          \n          if (alreadyOwned) {\n            // Player already has this item - show special message\n            updateStatus(strings[828] || 'You already have this');\n            \n            // Still create floating text to show what was attempted\n            const displayName = getLocalizedString(collectedItem, strings);\n            const categoryEmoji = revealedResource.category === 'skill' ? '' : \n                                revealedResource.category === 'power' ? '' : '';\n            FloatingTextManager.addFloatingText(`${categoryEmoji} ${displayName} (Already Owned)`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n          } else {\n            // Handle skills, powers, and upgrades\n            const success = await gainSkillOrPower({\n              item: revealedResource,\n              currentPlayer,\n              setCurrentPlayer,\n              updateStatus,\n              strings,\n              gridId,\n              quantity: collectedQty\n            });\n            \n            if (!success) {\n              console.error(' Failed to add skill/power to player.');\n              setIsCollecting(false);\n              return;\n            }\n            \n            // Create floating text\n            const displayName = getLocalizedString(collectedItem, strings);\n            const categoryEmoji = revealedResource.category === 'skill' ? '' : \n                                revealedResource.category === 'power' ? '' : '';\n            FloatingTextManager.addFloatingText(`${categoryEmoji} ${displayName}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n            \n            // Handle combat stats updates for powers (mimic ShopStation logic)\n            if (revealedResource.category === 'power') {\n              // Helper functions to categorize powers\n              const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n              const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n              const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n              \n              if (isMagicEnhancement(revealedResource)) {\n                // Update combat stats for magic enhancements\n                const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer._id];\n                if (gridPlayer) {\n                  const combatAttributes = ['hp', 'maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                  const statUpdates = {};\n                  \n                  // Check for combat attributes on this power\n                  combatAttributes.forEach(attr => {\n                    if (typeof revealedResource[attr] === 'number') {\n                      const oldValue = gridPlayer[attr] || 0;\n                      const newValue = oldValue + revealedResource[attr];\n                      statUpdates[attr] = newValue;\n                      console.log(` Updated ${attr} for player ${currentPlayer._id}: ${oldValue} -> ${newValue}`);\n                    }\n                  });\n                  \n                  // Update all modified stats at once\n                  if (Object.keys(statUpdates).length > 0) {\n                    await playersInGridManager.updatePC(gridId, currentPlayer._id, statUpdates);\n                  }\n                }\n              } else {\n                // Weapons and armor require equipping - send notification\n                showNotification('Message', {\n                  title: strings[7001] || 'Tip',\n                  message: strings[7017] || 'Equip in Combat Panel to use'\n                });\n              }\n            }\n          }\n        } else {\n          // Handle regular doobers - add to inventory\n          const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: collectedQty,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n          });\n\n          if (!gained) {\n            console.error(' Failed to add revealed item to inventory.');\n            setIsCollecting(false);\n            return;\n          }\n          \n          FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentStationPosition.x, currentStationPosition.y, TILE_SIZE);\n        }\n\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQty, setCurrentPlayer);\n\n        // Clear station state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentStationPosition.x && res.y === currentStationPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined, qty: 1 }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setCraftedItem(null);\n        setCraftingCountdown(null);\n        setIsReadyToCollect(false);\n        setRevealedItemQty(1);\n\n        // Update status - only if we're not dealing with already owned skills/powers\n        if (!(revealedResource && (revealedResource.category === 'skill' || revealedResource.category === 'power') &&\n            (revealedResource.category === 'skill'\n              ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n              : currentPlayer.powers?.some(power => power.type === collectedItem)))) {\n          updateStatus(`${strings[469] || 'Collected'} ${collectedQty}x ${getLocalizedString(collectedItem, strings)}`);\n        }\n\n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Award Scroll Revealer trophy for successful scroll reveals\n        if (currentPlayer?.playerId) {\n          earnTrophy(currentPlayer.playerId, 'Scroll Revealer', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n        }\n\n        // Clear collecting state after a brief delay\n        setTimeout(() => {\n          setIsCollecting(false);\n        }, 100);\n      } else {\n        setIsCollecting(false);\n      }\n    } catch (error) {\n      console.error('Error collecting revealed item:', error);\n      updateStatus(' Failed to collect item');\n      setIsCollecting(false);\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1036\" title={strings[1136] || 'Ancient Temple'} panelName=\"ScrollStation\">\n      <div className=\"station-panel-container\">\n        <div className=\"station-panel-content\">\n\n        {/* Scroll count display */}\n\n        <div style={{\n          padding: '10px',\n          textAlign: 'center',\n          fontSize: '16px',\n          fontWeight: 'bold',\n         }}>\n          {strings[825]}: <br></br>{scrollCount}  {scrollCount > 1 ? strings[826] : strings[827]}\n        </div>\n\n\n        {skillMessage && (\n          <div style={{\n            marginBottom: '15px',\n            padding: '10px',\n            backgroundColor: 'var(--color-bg-light)',\n            borderRadius: '5px',\n            fontStyle: 'italic'\n          }}>\n            {skillMessage}\n          </div>\n        )}\n\n        {/* Show crafting item if active, otherwise show Reveal Scroll button */}\n\n        {craftedItem && (isCrafting || isReadyToCollect) ? (\n          // Show animated scroll reveal or dramatic collect interface\n          isCrafting ? (\n            // Animated scroll emoji during crafting\n            <div className=\"scroll-reveal-animation\">\n              <div className=\"scroll-emoji\"></div>\n              <div className=\"scroll-revealing-text\">Revealing Scroll...</div>\n              <div className=\"scroll-countdown-text\">{formatCountdown(Date.now() + craftingCountdown * 1000, Date.now())}</div>\n            </div>\n          ) : (\n            // Use standard ResourceButton for collect state\n            (() => {\n              const revealedResource = masterResources.find(r => r.type === craftedItem);\n              const rarity = revealedResource?.scrollchance || 'common';\n              const rarityText = typeof rarity === 'string' ? rarity.toUpperCase() : 'COMMON';\n              \n              return (\n                <ResourceButton\n                  symbol={revealedResource?.symbol || ''}\n                  name={`\\n${getLocalizedString(craftedItem, strings)}${revealedItemQty > 1 ? ` (${revealedItemQty})` : ''}`}\n                  className={`resource-button scroll-collect-button rarity-${typeof rarity === 'string' ? rarity : 'common'} ${isCollecting ? 'collecting' : 'ready'}`}\n                  details={rarityText} \n                  disabled={!isReadyToCollect || isCollecting}\n                  isTransactionMode={isReadyToCollect && !isCollecting}\n                  transactionKey={isReadyToCollect ? `scroll-collect-${craftedItem}-${currentStationPosition.x}-${currentStationPosition.y}` : undefined}\n                  onTransactionAction={isReadyToCollect ? handleCollectReveal : undefined}\n                />\n              );\n            })()\n          )\n        ) : scrollCount > 0 && !isCollecting ? (\n          // Show reveal scroll button when not crafting and not collecting\n          <ResourceButton\n            name={strings[831]}\n            className=\"resource-button\"\n            details={`${strings[461]} 1x  ${strings[827]}`}\n            disabled={false}\n            isTransactionMode={true}\n            transactionKey={`scroll-reveal-${currentStationPosition.x}-${currentStationPosition.y}`}\n            onTransactionAction={handleRevealScroll}\n          />\n        ) : null}\n        \n        {/* Show message when no scrolls */}\n        {scrollCount === 0 && !craftedItem && (\n          <p style={{ textAlign: 'center', padding: '20px', color: '#666' }}>\n            {strings[832]}\n          </p>\n        )}\n\n        </div>\n        \n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"station-panel-footer\">\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-danger\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(ScrollStation);","import axios from 'axios';\nimport API_BASE from '../config';\nimport { refreshPlayerAfterInventoryUpdate } from './InventoryManagement';\nimport { trackQuestProgress } from '../GameFeatures/Quests/QuestGoalTracker';\nimport { earnTrophy } from '../GameFeatures/Trophies/TrophyUtils';\nimport playersInGridManager from '../GridState/PlayersInGrid';\nimport { getLocalizedString } from './stringLookup';\n\n/**\n * Shared utility for adding skills, upgrades, or powers to a player\n * Handles all the necessary API calls and state updates\n * \n * @param {Object} params - Parameters object\n * @param {Object} params.item - The skill/upgrade/power resource object to add\n * @param {Object} params.currentPlayer - Current player object\n * @param {Function} params.setCurrentPlayer - Function to update player state\n * @param {Function} params.updateStatus - Function to update status bar\n * @param {Object} params.strings - Localized strings object\n * @param {string} params.gridId - Current grid ID (needed for combat stats)\n * @param {number} params.quantity - Quantity to add (default 1)\n * @returns {Promise<boolean>} - Success status\n */\nexport async function gainSkillOrPower({\n  item,\n  currentPlayer,\n  setCurrentPlayer,\n  updateStatus,\n  strings,\n  gridId,\n  quantity = 1\n}) {\n  try {\n    if (!item || !item.type || !item.category) {\n      console.error('Invalid item provided to gainSkillOrPower:', item);\n      return false;\n    }\n\n    console.log(` Adding ${item.category}: ${item.type} x${quantity}`);\n\n    // Handle different categories\n    if (item.category === 'skill') {\n      // Skills are stored in the skills array\n      const currentSkills = currentPlayer.skills || [];\n      const updatedSkills = [...currentSkills];\n      \n      // Check if already owned\n      const existingIndex = updatedSkills.findIndex(s => s.type === item.type);\n      if (existingIndex >= 0) {\n        // Update quantity if already owned\n        updatedSkills[existingIndex].quantity = (updatedSkills[existingIndex].quantity || 1) + quantity;\n      } else {\n        // Add new skill/upgrade\n        updatedSkills.push({ \n          type: item.type, \n          category: item.category, \n          quantity: quantity \n        });\n      }\n\n      // Update on server\n      await axios.post(`${API_BASE}/api/update-skills`, {\n        playerId: currentPlayer.playerId,\n        skills: updatedSkills\n      });\n\n      // Update local state\n      setCurrentPlayer(prev => ({\n        ...prev,\n        skills: updatedSkills\n      }));\n\n      // Track quest progress\n      await trackQuestProgress(currentPlayer, 'Acquire', item.type, quantity, setCurrentPlayer);\n      \n      // Earn trophy for skills\n      if (item.category === 'skill') {\n        await earnTrophy(currentPlayer.playerId, 'Skill Builder', 1, currentPlayer, null, setCurrentPlayer);\n      }\n\n\n    } else if (item.category === 'power') {\n      // Powers are stored separately\n      const currentPowers = currentPlayer.powers || [];\n      const updatedPowers = [...currentPowers];\n      \n      // Check if already owned\n      const existingIndex = updatedPowers.findIndex(p => p.type === item.type);\n      if (existingIndex >= 0) {\n        updatedPowers[existingIndex].quantity = (updatedPowers[existingIndex].quantity || 1) + quantity;\n      } else {\n        updatedPowers.push({ \n          type: item.type, \n          quantity: quantity \n        });\n      }\n\n      // Update on server\n      await axios.post(`${API_BASE}/api/update-powers`, {\n        playerId: currentPlayer.playerId,\n        powers: updatedPowers\n      });\n\n      // Update local state\n      setCurrentPlayer(prev => ({\n        ...prev,\n        powers: updatedPowers\n      }));\n\n      // Handle combat stat modifications if the power has output\n      if (item.output && typeof item.qtycollected === 'number') {\n        if (item.output === 'range') {\n          // Range is stored on the player document\n          const updatedRange = (currentPlayer.range || 0) + item.qtycollected;\n          \n          await axios.post(`${API_BASE}/api/update-profile`, {\n            playerId: currentPlayer.playerId,\n            updates: { range: updatedRange }\n          });\n\n          // Update local player state and localStorage\n          const updatedPlayer = {\n            ...currentPlayer,\n            range: updatedRange\n          };\n          setCurrentPlayer(updatedPlayer);\n          localStorage.setItem('player', JSON.stringify(updatedPlayer));\n          \n          console.log(` Updated range on player document: ${updatedRange}`);\n        } else {\n          // Other combat stats updated in playersInGrid\n          const gridPlayer = playersInGridManager.getAllPCs(gridId)?.[currentPlayer.playerId];\n          if (gridPlayer) {\n            const oldValue = gridPlayer[item.output] || 0;\n            const newValue = oldValue + item.qtycollected;\n            \n            await playersInGridManager.updatePC(gridId, currentPlayer.playerId, {\n              [item.output]: newValue\n            });\n            \n            console.log(` Updated ${item.output} for player ${currentPlayer.playerId}: ${oldValue} -> ${newValue}`);\n          }\n        }\n      }\n\n    } else {\n      console.error('Unknown item category:', item.category);\n      return false;\n    }\n\n    // Refresh player data to ensure consistency\n    await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n    return true;\n\n  } catch (error) {\n    console.error('Error in gainSkillOrPower:', error);\n    updateStatus(`Failed to acquire ${item.type}`);\n    return false;\n  }\n}\n\n/**\n * Check if player has a specific skill, upgrade, or power\n * @param {Object} player - Player object\n * @param {string} requirementType - Type of skill/upgrade/power to check for\n * @returns {boolean}\n */\nexport function hasSkillOrPower(player, requirementType) {\n  if (!requirementType) return true;\n  \n  return (\n    player.skills?.some(skill => skill.type === requirementType) ||\n    player.powers?.some(power => power.type === requirementType)\n  );\n}","/**\n * ScrollReveal.js\n * Helper functions for determining random scroll reveal outcomes\n */\n\nimport { selectWeightedRandomItem } from '../../Economy/DropRates';\n\n/**\n * Determines the random doober reward from revealing a scroll\n * @param {Array} masterResources - Master resource list\n * @param {Object} playerStats - Optional player stats for future scaling\n * @param {number} rollCount - Number of internal rolls to make (default: 3)\n * @returns {Object} { type: string, quantity: number }\n */\nexport function getRandomScrollReveal(masterResources, playerStats = null, rollCount = 3) {\n  // Filter resources that can be obtained from scrolls - any item with scrollchance defined\n  const scrollableItems = masterResources.filter(item => item.scrollchance);\n\n  if (scrollableItems.length === 0) {\n    console.warn('No scrollable items found in masterResources, using fallback');\n    return { type: 'Wood', quantity: 10 };\n  }\n\n  // Use the shared utility to select a weighted random item\n  // Scrolls are always level 1 for now (no level multiplier)\n  const selectedItem = selectWeightedRandomItem(scrollableItems, 1);\n  \n  if (selectedItem) {\n    const quantity = selectedItem.scrollqty || 1;\n    console.log(` Scroll reveal: ${selectedItem.type} x${quantity} (rarity: ${selectedItem.scrollchance})`);\n    \n    return {\n      type: selectedItem.type,\n      quantity: quantity\n    };\n  }\n  \n  // Fallback (shouldn't reach here)\n  const fallbackItem = scrollableItems[0];\n  return { \n    type: fallbackItem.type, \n    quantity: fallbackItem.scrollqty || 1 \n  };\n}\n\n/**\n * Get display name for scroll reveal result\n * @param {Object} reveal - The reveal result from getRandomScrollReveal\n * @param {Array} masterResources - Master resource list\n * @returns {string} Display string like \"5x Wood\"\n */\nexport function getRevealDisplayString(reveal, masterResources) {\n  const resource = masterResources.find(r => r.type === reveal.type);\n  const symbol = resource?.symbol || '';\n  return `${reveal.quantity}x ${symbol} ${reveal.type}`;\n}\n\n/**\n * Check if player can afford to reveal a scroll\n * @param {Object} recipe - The Reveal Scroll recipe\n * @param {Array} inventory - Player inventory\n * @param {Array} backpack - Player backpack\n * @returns {boolean}\n */\nexport function canAffordReveal(recipe, inventory, backpack) {\n  const playerItems = [...(inventory || []), ...(backpack || [])];\n  \n  // Check each ingredient requirement\n  for (let i = 1; i <= 5; i++) {\n    const ingredientType = recipe[`ingredient${i}`];\n    const ingredientQty = recipe[`ingredient${i}qty`] || 1;\n    \n    if (ingredientType) {\n      const playerQty = playerItems\n        .filter(item => item.type === ingredientType)\n        .reduce((sum, item) => sum + item.quantity, 0);\n        \n      if (playerQty < ingredientQty) {\n        return false;\n      }\n    }\n  }\n  \n  return true;\n}","import API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport ResourceButton from '../../UI/Buttons/ResourceButton';\nimport FloatingTextManager from '../../UI/FloatingText';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport GlobalGridStateTilesAndResources from '../../GridState/GlobalGridStateTilesAndResources';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { spendIngredients, gainIngredients, canAfford } from '../../Utils/InventoryManagement';\nimport { getIngredientDetails } from '../../Utils/ResourceHelpers';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport { formatCountdown } from '../../UI/Timers';\nimport { showNotification } from '../../UI/Notifications/Notifications';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport { selectWeightedRandomItem, getDropQuantity } from '../../Economy/DropRates';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport { getPersonalizedPetRewards } from '../../Utils/WarehouseMaterials';\nimport '../../UI/Buttons/SharedButtons.css';\nimport '../../UI/Buttons/ResourceButton.css'; \nimport './PetPanel.css';\n\n// Helper function to get a random reward from pets source with rarity weighting\nconst getRandomPetReward = (masterResources, petRewardRarity = 1, playerId) => {\n  // Get all resources with source === 'pets'\n  const petRewards = masterResources.filter(res => res.source === 'pets');\n  \n  if (petRewards.length === 0) {\n    console.warn('No pet rewards found in masterResources');\n    return null;\n  }\n  \n  // Apply personalized rarity to warehouse ingredients\n  const personalizedRewards = getPersonalizedPetRewards(petRewards, playerId);\n  \n  // Use the shared drop rate utility with pet reward rarity multiplier\n  // Higher rarity pets have better drop rates (rarity 2 = 2x rates, rarity 5 = 5x rates)\n  const selectedReward = selectWeightedRandomItem(personalizedRewards, petRewardRarity);\n  \n  if (!selectedReward) {\n    return null;\n  }\n  \n  // Determine quantity based on rarity using shared utility\n  const quantity = getDropQuantity(selectedReward.scrollchance || 'common');\n  \n  return {\n    type: selectedReward.type,\n    quantity,\n    rarity: selectedReward.scrollchance || 'common'\n  };\n};\n\nconst PetPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  petResource, // The specific pet resource that was clicked\n  currentPetPosition,\n  gridId,\n  masterResources,\n  masterSkills,\n  masterTrophies,\n  TILE_SIZE,\n  isDeveloper,\n  globalTuning,\n}) => {\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const strings = useStrings();\n  const { updateStatus } = useContext(StatusBarContext);\n  const [activeTimer, setActiveTimer] = useState(false);\n  const [rewardItem, setRewardItem] = useState(null);\n  const [feedingCountdown, setFeedingCountdown] = useState(null);\n  const [isFeeding, setIsFeeding] = useState(false);\n  const [isReadyToCollect, setIsReadyToCollect] = useState(false);\n  const [revealedRewardQty, setRevealedRewardQty] = useState(1);\n  const [revealedRewardRarity, setRevealedRewardRarity] = useState('common');\n  const [isCollecting, setIsCollecting] = useState(false);\n  const [canAffordFeeding, setCanAffordFeeding] = useState(false);\n\n  // Get pet details from the resource\n  const petName = petResource?.type || 'Pet';\n  const petSymbol = petResource?.symbol || '=\u0015';\n  const feedIngredient = petResource?.output || 'Milk'; // What the pet needs to be fed\n  const feedQuantity = petResource?.qtycollected || 1; // How much of the ingredient is needed\n  const feedingTime = petResource?.crafttime || 60; // How long the pet takes to find rewards\n\n  // Check if we can afford to feed the pet\n  useEffect(() => {\n    const checkAffordability = () => {\n      const affordable = canAfford(\n        { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n        [...(inventory || []), ...(backpack || [])]\n      );\n      setCanAffordFeeding(affordable);\n    };\n    \n    checkAffordability();\n  }, [inventory, backpack, feedIngredient, feedQuantity]);\n\n  // Check for active feeding timer or ready rewards\n  useEffect(() => {\n    if (!petResource || !currentPetPosition) return;\n\n    const checkPetState = () => {\n      const pet = GlobalGridStateTilesAndResources.getResources()?.find(\n        (res) => res.x === currentPetPosition.x && res.y === currentPetPosition.y\n      );\n      \n      if (pet && pet.craftEnd && pet.craftedItem) {\n        // Check if this is a revealed reward (craftEnd in the past)\n        const now = Date.now();\n        const isRevealed = pet.craftEnd < now;\n        \n        setRewardItem(pet.craftedItem);\n        setRevealedRewardQty(pet.qty || 1);\n        setRevealedRewardRarity(pet.rarity || 'common');\n        \n        if (isRevealed) {\n          setIsFeeding(false);\n          setIsReadyToCollect(true);\n          setFeedingCountdown(0);\n          setActiveTimer(false);\n        } else {\n          // Pet is still searching for rewards\n          setIsFeeding(true);\n          setActiveTimer(true);\n          \n          const remainingTime = Math.max(0, Math.floor((pet.craftEnd - now) / 1000));\n          setFeedingCountdown(remainingTime);\n          \n          if (remainingTime === 0) {\n            setIsFeeding(false);\n            setIsReadyToCollect(true);\n          }\n        }\n      } else {\n        // Only reset if we actually had something before\n        if (rewardItem || isFeeding || isReadyToCollect) {\n          setRewardItem(null);\n          setIsFeeding(false);\n          setIsReadyToCollect(false);\n          setFeedingCountdown(null);\n          setActiveTimer(false);\n          setRevealedRewardQty(1);\n          setRevealedRewardRarity('common');\n        }\n      }\n    };\n\n    // Initial check\n    checkPetState();\n\n    // Set up interval to check for updates\n    const timer = setInterval(checkPetState, 1000);\n    return () => clearInterval(timer);\n  }, [petResource, currentPetPosition, rewardItem, isFeeding, isReadyToCollect]);\n\n  // Handle feeding the pet\n  const handleFeedPet = async (transactionId, transactionKey) => {\n    if (!canAffordFeeding) {\n      updateStatus(`You need ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)} to feed ${getLocalizedString(petName, strings)}`);\n      return;\n    }\n\n    try {\n      // First, spend the feed ingredients\n      const spentSuccess = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        recipe: { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n        inventory: currentPlayer.inventory,\n        backpack: currentPlayer.backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n      });\n\n      if (!spentSuccess) {\n        updateStatus(`Failed to feed ${getLocalizedString(petName, strings)}`);\n        return;\n      }\n\n      // Generate random reward using pet's qtycollected for better drop rates\n      const petRewardRarity = petResource?.qtycollected || 1; // Default to rarity 1 if not specified\n      const reward = getRandomPetReward(masterResources, petRewardRarity, currentPlayer.playerId);\n      \n      if (!reward) {\n        console.error('Failed to generate pet reward');\n        updateStatus('Something went wrong while feeding the pet');\n        return;\n      }\n\n      // Start the feeding timer using standard craft API\n      const response = await axios.post(`${API_BASE}/api/crafting/start-craft`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentPetPosition.x,\n        stationY: currentPetPosition.y,\n        recipe: {\n          type: reward.type,\n          crafttime: feedingTime,\n          // No ingredients since we already spent them\n        },\n        qty: reward.quantity,\n        rarity: reward.rarity, // Store rarity for display\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { craftEnd, craftedItem, inventory, backpack } = response.data;\n        \n        // Update inventory from server response if provided\n        if (inventory) {\n          setInventory(inventory);\n          setCurrentPlayer(prev => ({ ...prev, inventory }));\n        }\n        if (backpack) {\n          setBackpack(backpack);\n          setCurrentPlayer(prev => ({ ...prev, backpack }));\n        }\n\n        // Update pet resource in global state with qty and rarity\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentPetPosition.x && res.y === currentPetPosition.y\n            ? { ...res, craftEnd, craftedItem, qty: reward.quantity, rarity: reward.rarity }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Update UI state\n        setRewardItem(craftedItem);\n        setRevealedRewardQty(reward.quantity);\n        setRevealedRewardRarity(reward.rarity);\n        setFeedingCountdown(Math.max(0, Math.floor((craftEnd - Date.now()) / 1000)));\n        setActiveTimer(true);\n        setIsFeeding(true);\n        setIsReadyToCollect(false);\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Update status\n        const feedMessage = `Fed ${getLocalizedString(petName, strings)} ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)}`;\n        FloatingTextManager.addFloatingText(feedMessage, currentPetPosition.x, currentPetPosition.y, TILE_SIZE);\n        updateStatus(`${getLocalizedString(petName, strings)}${strings[8014] || ' is searching for treasures...'}`);\n\n        // Track quest progress for feeding pets\n        await trackQuestProgress(currentPlayer, 'Feed', petName, 1, setCurrentPlayer);\n      }\n    } catch (error) {\n      console.error('Error in pet feeding process:', error);\n      updateStatus(`Failed to feed ${getLocalizedString(petName, strings)}`);\n    }\n  };\n\n  // Handle collection of pet rewards\n  const handleCollectReward = async (transactionId, transactionKey) => {\n    if (!rewardItem || isCollecting) {\n      console.error(\"L No reward to collect or already collecting.\");\n      return;\n    }\n\n    setIsCollecting(true);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/crafting/collect-item`, {\n        playerId: currentPlayer.playerId,\n        gridId,\n        stationX: currentPetPosition.x,\n        stationY: currentPetPosition.y,\n        craftedItem: rewardItem,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        const { collectedItem, isNPC } = response.data;\n        const collectedQty = revealedRewardQty || 1;\n\n        // Find the reward item in master resources to check its category\n        const rewardResource = masterResources.find(res => res.type === collectedItem);\n        \n        const gained = await gainIngredients({\n            playerId: currentPlayer.playerId,\n            currentPlayer,\n            resource: collectedItem,\n            quantity: collectedQty,\n            inventory: currentPlayer.inventory,\n            backpack: currentPlayer.backpack,\n            setInventory,\n            setBackpack,\n            setCurrentPlayer,\n            updateStatus,\n            masterResources,\n            globalTuning,\n        });\n\n        if (!gained) {\n            console.error('L Failed to add pet reward to inventory.');\n            setIsCollecting(false);\n            return;\n        }\n        \n        FloatingTextManager.addFloatingText(`+${collectedQty} ${getLocalizedString(collectedItem, strings)}`, currentPetPosition.x, currentPetPosition.y, TILE_SIZE);\n\n        // Award XP for collecting from pet\n        const petResourceForXP = masterResources.find(res => res.type === petName);\n        const xpToAward = petResourceForXP?.xp || 1;\n        try {\n          const xpResponse = await axios.post(`${API_BASE}/api/addXP`, {\n            playerId: currentPlayer.playerId,\n            xpAmount: xpToAward\n          });\n\n          if (xpResponse.data.success) {\n            // Update current player's XP locally\n            setCurrentPlayer(prev => ({\n              ...prev,\n              xp: xpResponse.data.newXP\n            }));\n          }\n        } catch (error) {\n          console.error(' Error awarding XP for pet collection:', error);\n          // Don't fail the collection if XP award fails, just log it\n        }\n\n        // Track quest progress\n        await trackQuestProgress(currentPlayer, 'Collect', collectedItem, collectedQty, setCurrentPlayer);\n\n        // Clear pet state\n        const updatedGlobalResources = GlobalGridStateTilesAndResources.getResources().map(res =>\n          res.x === currentPetPosition.x && res.y === currentPetPosition.y\n            ? { ...res, craftEnd: undefined, craftedItem: undefined, qty: 1, rarity: undefined }\n            : res\n        );\n        GlobalGridStateTilesAndResources.setResources(updatedGlobalResources);\n        setResources(updatedGlobalResources);\n\n        // Reset UI state\n        setActiveTimer(false);\n        setRewardItem(null);\n        setFeedingCountdown(null);\n        setIsReadyToCollect(false);\n        setRevealedRewardQty(1);\n        setRevealedRewardRarity('common');\n\n        // Update status - only if we're not dealing with already owned skills/powers\n        if (!(rewardResource && (rewardResource.category === 'skill' || rewardResource.category === 'power') &&\n            (rewardResource.category === 'skill'\n              ? currentPlayer.skills?.some(skill => skill.type === collectedItem)\n              : currentPlayer.powers?.some(power => power.type === collectedItem)))) {\n          updateStatus(`${getLocalizedString(petName, strings)} found ${collectedQty}x ${getLocalizedString(collectedItem, strings)}!`);\n        }\n\n        // Refresh player data\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        // Clear collecting state after a brief delay\n        setTimeout(() => {\n          setIsCollecting(false);\n        }, 100);\n      } else {\n        setIsCollecting(false);\n      }\n    } catch (error) {\n      console.error('Error collecting pet reward:', error);\n      updateStatus('L Failed to collect reward');\n      setIsCollecting(false);\n    }\n  };\n\n  // Handle selling the pet for a refund\n  const handleSellPet = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType: petResource?.type || petName, // Use pet resource type\n      currentStationPosition: currentPetPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: !isHomestead, // Only verify developer status when NOT on homestead\n    });\n  };\n\n  return (\n    <Panel onClose={onClose} title={getLocalizedString(petName, strings)} panelName=\"PetPanel\">\n      <div className=\"pet-panel-container\">\n        <div className=\"pet-panel-content\">\n\n          {/* Pet display */}\n          <div className=\"pet-display\">{petSymbol}</div>\n\n          {/* Pet info */}\n          <div className=\"pet-info\">\n\n            <p className=\"pet-status\">\n              {isFeeding ? (\n                `${getLocalizedString(petName, strings)}${strings[8014] || ' is searching for treasures...'}`\n              ) : isReadyToCollect ? (\n                `${getLocalizedString(petName, strings)}${strings[8016] || ' has found something!'}`\n              ) : (\n                <>\n                  {strings[8010] || 'This pet is hungry.'}<br/>\n                  {strings[8011] || 'Feed'} {feedQuantity}x {getLocalizedString(feedIngredient, strings)}{strings[8012] || ' to send it searching.'}\n                </>\n              )}\n            </p>\n          </div>\n\n          {/* Show feeding/collection state */}\n          {rewardItem && (isFeeding || isReadyToCollect) ? (\n            // Show animated pet searching or reward collection interface\n            isFeeding ? (\n              // Animated pet searching\n              <div className=\"pet-searching\">\n                <div className=\"pet-searching-countdown\">{formatCountdown(Date.now() + feedingCountdown * 1000, Date.now())}</div>\n              </div>\n            ) : (\n              // Use standard ResourceButton for collect state\n              (() => {\n                const rewardResource = masterResources.find(r => r.type === rewardItem);\n                const petResourceForXP = masterResources.find(res => res.type === petName);\n                const xpToAward = petResourceForXP?.xp || 1;\n\n                return (\n                  <ResourceButton\n                    symbol={rewardResource?.symbol || ''}\n                    name={`${getLocalizedString(rewardItem, strings)}${revealedRewardQty > 1 ? ` (${revealedRewardQty})` : ''}`}\n                    details={`(+ ${xpToAward})`}\n                    className={`resource-button pet-collect-button scroll-collect-button rarity-${revealedRewardRarity} ${isCollecting ? 'collecting' : 'ready'}`}\n                    disabled={!isReadyToCollect || isCollecting}\n                    isTransactionMode={isReadyToCollect && !isCollecting}\n                    transactionKey={isReadyToCollect ? `pet-collect-${rewardItem}-${currentPetPosition.x}-${currentPetPosition.y}` : undefined}\n                    onTransactionAction={isReadyToCollect ? handleCollectReward : undefined}\n                    hideInfo={true}\n                  />\n                );\n              })()\n            )\n          ) : !isCollecting ? (\n            // Show feed pet button when not feeding and not collecting\n            <ResourceButton\n              name={`${strings[8011] || 'Feed'} ${getLocalizedString(petName, strings)}`}\n              className=\"resource-button\"\n              details={`${strings[461] || 'Requires'} ${feedQuantity}x ${getLocalizedString(feedIngredient, strings)}`}\n              ingredientDetails={getIngredientDetails(\n                { ingredient1: feedIngredient, ingredient1qty: feedQuantity },\n                masterResources\n              )}\n              disabled={!canAffordFeeding}\n              isValid={canAffordFeeding}\n              isTransactionMode={canAffordFeeding}\n              transactionKey={canAffordFeeding ? `pet-feed-${petName}-${currentPetPosition.x}-${currentPetPosition.y}` : undefined}\n              onTransactionAction={canAffordFeeding ? handleFeedPet : undefined}\n              hideInfo={true}\n            />\n          ) : null}\n\n        </div>\n        \n        {/* Sell/refund button - homesteads or developers */}\n        {(isHomestead || isDeveloper) && (\n          <div className=\"pet-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellPet}\n                transactionKey={`sell-refund-${petName}-${currentPetPosition.x}-${currentPetPosition.y}-${gridId}`}\n              >\n                {strings[425] || 'Sell for refund'}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n};\n\nexport default React.memo(PetPanel);","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport './AnimalStall.css';\n\nconst AnimalStall = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  isDeveloper,\n}) => {\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const [stallDetails, setStallDetails] = useState(null);\n  const [outputDetails, setOutputDetails] = useState(null);\n  const strings = useStrings();\n\n  console.log('Inside Animal Stall:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const stallResource = masterResources.find((res) => res.type === stationType);\n    setStallDetails(stallResource);\n  }, [stationType, masterResources]);\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: !isHomestead, // Only verify developer status when NOT on homestead\n    });\n  };\n  \n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1011\" titleKey=\"1111\" panelName=\"AnimalStall\" >\n      <div className=\"animalstall-panel-container\">\n        <div className=\"animalstall-panel-content\">\n          <h2>\n              {stallDetails?.symbol || ''} {stationType}\n          </h2>\n        </div>\n\n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"animalstall-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(AnimalStall);\n","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport { updateGridResource } from '../../Utils/GridManagement';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nconst CropPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  currentResource,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  globalTuning,\n}) => {\n  const [isActionCoolingDown, setIsActionCoolingDown] = useState(false);\n  const COOLDOWN_DURATION = 2000;\n  const [cropDetails, setCropDetails] = useState(null);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n  const strings = useStrings();\n\n  console.log('--------Inside Crop Panel:', { stationType, currentStationPosition, currentResource });\n\n  useEffect(() => {\n    const cropResource = masterResources.find((res) => res.type === stationType);\n    setCropDetails(cropResource);\n  }, [stationType, masterResources]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Function to generate countdown text like the tooltip\n  const getCropStatusText = () => {\n    if (!currentResource || !currentResource.growEnd) return \"Unknown status\";\n    \n    const remainingTime = Math.max(0, currentResource.growEnd - currentTime);\n    \n    if (remainingTime <= 0) {\n      return \"Ready for harvest!\";\n    }\n    \n    const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);\n    \n    const parts = [];\n    if (days > 0) parts.push(`${days}d`);\n    if (hours > 0) parts.push(`${hours}h`);\n    if (minutes > 0) parts.push(`${minutes}m`);\n    if (seconds > 0 || parts.length === 0) parts.push(`${seconds}s`);\n    \n    return `${parts.join(' ')} remaining`;\n  };\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const removeCrop = async () => {\n    if (isActionCoolingDown) return;\n    setIsActionCoolingDown(true);\n    setTimeout(() => {\n      setIsActionCoolingDown(false);\n    }, COOLDOWN_DURATION);\n\n    try {\n      // Remove the crop resource from the grid (no refund)\n      await updateGridResource(\n        gridId,\n        { type: null, x: currentStationPosition.x, y: currentStationPosition.y },\n        setResources,\n        true\n      );\n\n      setResources(prevResources =>\n        prevResources.filter(res => !(res.x === currentStationPosition.x && res.y === currentStationPosition.y))\n      );\n\n      console.log(`Removed ${stationType} successfully (no refund).`);\n      updateStatus(439);\n      onClose();\n    } catch (error) {\n      console.error('Error removing the crop:', error);\n    }\n  };\n  \n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1030\" titleKey=\"1130\" panelName=\"CropPanel\" >\n      <div className=\"standard-panel\">\n        <h2>\n            {cropDetails?.symbol || ''} {stationType}\n        </h2>\n\n        {/* Show crop growth status */}\n        <p>\n          {getCropStatusText()}\n        </p>\n\n        <hr />\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-danger\" onClick={removeCrop} disabled={isActionCoolingDown}>\n            {strings[438]}\n          </button>\n        </div>\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(CropPanel);\n","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport './DecoPanel.css';\n\nconst DecoPanel = ({\n  onClose,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  currentPlayer,\n  setCurrentPlayer,\n  setResources,\n  stationType,\n  currentStationPosition,\n  gridId,\n  TILE_SIZE,\n  updateStatus,\n  masterResources,\n  isDeveloper,\n}) => {\n  const [resourceDetails, setResourceDetails] = useState(null);\n  const isHomestead = currentPlayer?.location?.gtype === 'homestead';\n  const strings = useStrings();\n\n  console.log('Inside Deco Panel:', { stationType, currentStationPosition });\n\n  useEffect(() => {\n    const availableResource = masterResources.find((res) =>\n      res.type === stationType &&\n      (isHomestead || res.passable !== false)\n    );\n    setResourceDetails(availableResource);\n  }, [stationType, masterResources, isHomestead]);\n\n  useEffect(() => {\n    const syncInventory = async () => {\n      try {\n        const storedInventory = JSON.parse(localStorage.getItem('inventory')) || [];\n        setInventory(storedInventory);\n  \n        const serverResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        const serverInventory = serverResponse.data.inventory || [];\n        if (JSON.stringify(storedInventory) !== JSON.stringify(serverInventory)) {\n          setInventory(serverInventory);\n          localStorage.setItem('inventory', JSON.stringify(serverInventory));\n        }\n      } catch (error) {\n        console.error('Error syncing inventory:', error);\n      }\n    };\n    syncInventory();\n  }, [currentPlayer]);\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: !isHomestead, // Only verify developer status when NOT on homestead\n    });\n  };\n  \n\n  return (\n    <Panel onClose={onClose} titleKey=\"1128\" panelName=\"DecoPanel\" >\n      <div className=\"deco-panel-container\">\n        <div className=\"deco-panel-content\">\n          <h2>\n              {resourceDetails?.symbol || ''} {getLocalizedString(stationType, strings)}\n          </h2>\n        </div>\n\n        {(currentPlayer.location.gtype === 'homestead' || isDeveloper) && (\n          <div className=\"deco-panel-footer\">\n            <hr />\n            <div className=\"shared-buttons\">\n              <TransactionButton \n                className=\"btn-basic btn-success\" \n                onAction={handleSellStation}\n                transactionKey={`sell-refund-${stationType}-${currentStationPosition.x}-${currentStationPosition.y}-${gridId}`}\n              >\n                {strings[425]}\n              </TransactionButton>\n            </div>\n          </div>\n        )}\n      </div>\n    </Panel>\n  );\n  \n};\n\nexport default React.memo(DecoPanel);\n","import React, { useState, useMemo } from 'react';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport TransactionButton from '../Buttons/TransactionButton';\nimport { useStrings } from '../StringsContext';\nimport './TradingInventoryModal.css';\n\nconst TradingInventoryModal = ({\n  isOpen,\n  onClose,\n  inventory,\n  resourceData,\n  amounts,\n  handleAmountChange,\n  handleAddToSlot,\n  getSlotConfig,\n  selectedSlotIndex,\n  transactionKeyPrefix = 'add-to-trade-slot',\n  isRequestMode = false,\n  playerMoney = 0\n}) => {\n  const strings = useStrings();\n  const [sortField, setSortField] = useState('name');\n  const [sortDirection, setSortDirection] = useState('asc');\n\n  // Sort inventory data\n  const sortedInventory = useMemo(() => {\n    const filtered = inventory.filter(item => item.type !== 'Money' && item.type !== 'Gem');\n    \n    return filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortField) {\n        case 'name':\n          aValue = getLocalizedString(a.type, strings).toLowerCase();\n          bValue = getLocalizedString(b.type, strings).toLowerCase();\n          break;\n        case 'quantity':\n          aValue = a.quantity;\n          bValue = b.quantity;\n          break;\n        case 'price':\n          const aResource = resourceData.find(res => res.type === a.type);\n          const bResource = resourceData.find(res => res.type === b.type);\n          aValue = aResource?.maxprice || 0;\n          bValue = bResource?.maxprice || 0;\n          break;\n        case 'amount':\n          aValue = amounts[a.type] || 0;\n          bValue = amounts[b.type] || 0;\n          break;\n        default:\n          return 0;\n      }\n      \n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [inventory, resourceData, amounts, strings, sortField, sortDirection]);\n\n  const handleSort = (field) => {\n    if (sortField === field) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const getSortIcon = (field) => {\n    if (sortField !== field) return '';\n    return sortDirection === 'asc' ? '' : '';\n  };\n\n  if (!isOpen) return null;\n\n  const slotConfig = getSlotConfig(selectedSlotIndex);\n\n  return (\n    <div className=\"inventory-modal wider\">\n      <button className=\"close-button\" onClick={onClose}></button>\n\n      <h2>{isRequestMode ? strings[10180] : strings[160]}</h2>\n\n      <p className=\"trading-modal-subtitle\">\n        {slotConfig.maxAmount} {isRequestMode ? strings[10181] : strings[158]}\n      </p>\n      \n      <div className=\"inventory-modal-container\">\n        <div className=\"inventory-modal-header\">\n          <table>\n            <thead>\n              <tr>\n                <th onClick={() => handleSort('name')} className=\"sortable-header\">\n                  {strings[161]} {getSortIcon('name')}\n                </th>\n                <th onClick={() => handleSort('quantity')} className=\"sortable-header\">\n                  {strings[162]} {getSortIcon('quantity')}\n                </th>\n                <th onClick={() => handleSort('price')} className=\"sortable-header\">\n                  {strings[163]} {getSortIcon('price')}\n                </th>\n                <th onClick={() => handleSort('amount')} className=\"sortable-header\">\n                  {isRequestMode ? 'Amount to Request' : strings[164]} {getSortIcon('amount')}\n                </th>\n                <th></th>\n              </tr>\n            </thead>\n          </table>\n        </div>\n        \n        <div className=\"inventory-modal-scroll\">\n          <table>\n            <tbody>\n              {sortedInventory.map((item) => {\n                const resourceDetails = resourceData.find((res) => res.type === item.type);\n                const price = resourceDetails?.maxprice || 0;\n                const currentAmount = amounts[item.type] || 0;\n                const totalCost = currentAmount * price;\n\n                // Calculate max affordable amount in request mode\n                const maxAffordable = isRequestMode ? Math.floor(playerMoney / price) : item.quantity;\n                const maxAllowed = Math.min(isRequestMode ? maxAffordable : item.quantity, slotConfig.maxAmount);\n\n                return (\n                  <tr key={item.type}>\n                    <td>{resourceDetails?.symbol} {getLocalizedString(item.type, strings)}</td>\n                    <td>{item.quantity}</td>\n                    <td> {price}</td>\n                    <td>\n                      <div className=\"amount-input\">\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, currentAmount - 1)\n                          }\n                          disabled={currentAmount <= 0}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"number\"\n                          value={currentAmount}\n                          onChange={(e) =>\n                            handleAmountChange(item.type, parseInt(e.target.value, 10) || 0)\n                          }\n                        />\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, currentAmount + 1)\n                          }\n                          disabled={currentAmount >= maxAllowed}\n                        >\n                          +\n                        </button>\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, maxAllowed)\n                          }\n                          style={{ marginLeft: '4px' }}\n                        >\n                          {strings[165]}\n                        </button>\n                      </div>\n                    </td>\n                    <td>\n                      <TransactionButton\n                        className=\"add-button\"\n                        onAction={(transactionId, transactionKey) =>\n                          handleAddToSlot(transactionId, transactionKey, item.type)\n                        }\n                        transactionKey={`${transactionKeyPrefix}-${item.type}`}\n                        disabled={\n                          isRequestMode\n                            ? !(currentAmount > 0 && totalCost <= playerMoney)\n                            : !(currentAmount > 0 && currentAmount <= item.quantity)\n                        }\n                      >\n                        {isRequestMode ? 'Request' : strings[166]}\n                      </TransactionButton>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TradingInventoryModal;","import React, { useState, useEffect } from 'react';\nimport Modal from '../../UI/Modals/Modal';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport axios from 'axios';\nimport API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport '../../UI/Buttons/SharedButtons.css';\nimport './GlobalMarketModal.css';\n\n/**\n * Global Market Modal - Shows all players in settlement with items for sale\n * Displays one user per row with their tradestall slots and buy buttons\n */\nfunction GlobalMarketModal({\n  isOpen,\n  onClose,\n  currentPlayer,\n  onBuyItem,\n  onFulfillRequest,\n  masterResources,\n  globalTuning\n}) {\n  const strings = useStrings();\n  const [settlementPlayers, setSettlementPlayers] = useState([]);\n  const [playerTradeStalls, setPlayerTradeStalls] = useState({});\n  const [playerTradeRequests, setPlayerTradeRequests] = useState({});\n  const [resourceData, setResourceData] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [activeTab, setActiveTab] = useState('buy'); // 'buy' or 'sell'\n\n  // Fetch all players and their trade stalls when modal opens\n  useEffect(() => {\n    if (!isOpen || !currentPlayer?.location?.s) return;\n\n    const fetchGlobalMarketData = async () => {\n      setIsLoading(true);\n      try {\n        // Fetch players in settlement\n        const settlementResponse = await axios.get(`${API_BASE}/api/players-in-settlement`, {\n          params: { settlementId: currentPlayer.location.s },\n        });\n        const players = settlementResponse.data.players || [];\n        setSettlementPlayers(players);\n\n        // Fetch resource data for symbols\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        setResourceData(resourcesResponse.data);\n\n        // Fetch trade stalls for all players in parallel\n        const tradeStallPromises = players.map(player => \n          axios.get(`${API_BASE}/api/player-trade-stall`, {\n            params: { playerId: player.playerId },\n          }).then(response => ({\n            playerId: player.playerId,\n            tradeStall: response.data.tradeStall || []\n          })).catch(error => ({\n            playerId: player.playerId,\n            tradeStall: []\n          }))\n        );\n\n        const tradeStallResults = await Promise.all(tradeStallPromises);\n        const tradeStallsData = {};\n        tradeStallResults.forEach(result => {\n          tradeStallsData[result.playerId] = result.tradeStall;\n        });\n\n        setPlayerTradeStalls(tradeStallsData);\n\n        // Fetch trade requests for all players in parallel\n        const tradeRequestPromises = players.map(player =>\n          axios.get(`${API_BASE}/api/player-trade-stall-requests`, {\n            params: { playerId: player.playerId },\n          }).then(response => ({\n            playerId: player.playerId,\n            tradeStallRequests: response.data.tradeStallRequests || []\n          })).catch(() => ({\n            playerId: player.playerId,\n            tradeStallRequests: []\n          }))\n        );\n\n        const tradeRequestResults = await Promise.all(tradeRequestPromises);\n        const tradeRequestsData = {};\n        tradeRequestResults.forEach(result => {\n          tradeRequestsData[result.playerId] = result.tradeStallRequests;\n        });\n\n        console.log('[Global Market] Trade request results:', tradeRequestResults);\n        console.log('[Global Market] Trade requests data object:', tradeRequestsData);\n        setPlayerTradeRequests(tradeRequestsData);\n      } catch (error) {\n        console.error('Error fetching global market data:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchGlobalMarketData();\n  }, [isOpen, currentPlayer?.location?.s]);\n\n  // Filter players who have items for sale (excluding current player)\n  const getPlayersWithItems = () => {\n    return settlementPlayers.filter(player => {\n      // Exclude current player from the list\n      if (player.playerId === currentPlayer.playerId) {\n        return false;\n      }\n\n      const stall = playerTradeStalls[player.playerId];\n      return stall && stall.some(slot =>\n        slot?.resource &&\n        slot?.amount > 0 &&\n        !slot?.boughtBy // Not sold - that's all we need to check\n      );\n    }).sort((a, b) => {\n      // Sort by username alphabetically\n      return a.username.localeCompare(b.username);\n    });\n  };\n\n  // Filter players who have active requests (excluding current player)\n  const getPlayersWithRequests = () => {\n    console.log('[Global Market] Filtering players with requests...');\n    console.log('[Global Market] Settlement players:', settlementPlayers);\n    console.log('[Global Market] Player trade requests state:', playerTradeRequests);\n    console.log('[Global Market] Current player ID:', currentPlayer.playerId);\n\n    const filtered = settlementPlayers.filter(player => {\n      // Exclude current player from the list\n      if (player.playerId === currentPlayer.playerId) {\n        console.log(`[Global Market] Excluding current player: ${player.username}`);\n        return false;\n      }\n\n      const requests = playerTradeRequests[player.playerId];\n      console.log(`[Global Market] Player ${player.username} (${player.playerId}) requests:`, requests);\n\n      if (!requests) {\n        console.log(`[Global Market]   -> No requests found`);\n        return false;\n      }\n\n      const hasActive = requests.some(slot => {\n        const isActive = slot?.resource && slot?.amount > 0 && slot?.moneyCommitted > 0;\n        if (slot?.resource) {\n          console.log(`[Global Market]   -> Slot:`, slot, `Active: ${isActive}`);\n        }\n        return isActive;\n      });\n\n      console.log(`[Global Market]   -> Has active requests: ${hasActive}`);\n      return hasActive;\n    });\n\n    console.log('[Global Market] Filtered players with requests:', filtered);\n\n    return filtered.sort((a, b) => {\n      // Sort by username alphabetically\n      return a.username.localeCompare(b.username);\n    });\n  };\n\n  // Get symbol for a resource type\n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n\n  // Handle buying an item - delegates to parent component\n  const handleBuyItem = async (playerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      await onBuyItem(playerId, slotIndex, transactionId, transactionKey);\n\n      // Refresh the trade stall data for this player after purchase\n      const response = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId },\n      });\n\n      setPlayerTradeStalls(prev => ({\n        ...prev,\n        [playerId]: response.data.tradeStall || []\n      }));\n    } catch (error) {\n      console.error('Error in global market buy:', error);\n    }\n  };\n\n  // Handle fulfilling a request (selling to a player's request)\n  const handleFulfillRequest = async (playerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      await onFulfillRequest(playerId, slotIndex, transactionId, transactionKey);\n\n      // Refresh the trade requests data for this player after fulfillment\n      const requestsResponse = await axios.get(`${API_BASE}/api/player-trade-stall-requests`, {\n        params: { playerId },\n      });\n\n      setPlayerTradeRequests(prev => ({\n        ...prev,\n        [playerId]: requestsResponse.data.tradeStallRequests || []\n      }));\n    } catch (error) {\n      console.error('Error fulfilling request:', error);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  const playersWithItems = getPlayersWithItems();\n  const playersWithRequests = getPlayersWithRequests();\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title={strings[362] || \"Global Market\"}\n      size=\"large\"\n      className=\"global-market-modal\"\n    >\n      <div className=\"global-market-content\">\n        {/* TAB NAVIGATION */}\n        <div className=\"tab-navigation\">\n          <button\n            className={`tab-button ${activeTab === 'buy' ? 'active' : ''}`}\n            onClick={() => setActiveTab('buy')}\n          >\n            Buy\n          </button>\n          <button\n            className={`tab-button ${activeTab === 'sell' ? 'active' : ''}`}\n            onClick={() => setActiveTab('sell')}\n          >\n            Sell (Player Requests)\n          </button>\n        </div>\n\n        {isLoading ? (\n          <div className=\"loading-container\">\n            <div className=\"loading-text\">{strings[98] || \"Loading...\"}</div>\n          </div>\n        ) : activeTab === 'buy' ? (\n          playersWithItems.length === 0 ? (\n            <div className=\"no-items-container\">\n              <div className=\"no-items-text\">{strings[363] || \"No items currently available for purchase\"}</div>\n            </div>\n          ) : (\n          <div className=\"players-list\">\n            {playersWithItems.map(player => {\n              const stall = playerTradeStalls[player.playerId] || [];\n              const availableSlots = stall.filter(slot => \n                slot?.resource && \n                slot?.amount > 0 && \n                !slot?.boughtBy // Show all unsold items, regardless of timer\n              );\n\n              return (\n                <div key={player.playerId} className=\"player-row\">\n                  <div className=\"player-info\">\n                    <div className=\"player-username\">\n                      {player.icon && <span className=\"player-icon\">{player.icon}</span>}\n                      {player.username}\n                    </div>\n                    <div className=\"player-items-count\">\n                      {availableSlots.length} {strings[364] || \"items available\"}\n                    </div>\n                  </div>\n                  \n                  <div className=\"player-slots\">\n                    {availableSlots.map((slot, slotIndex) => {\n                      // Find the actual slot index in the full stall\n                      const actualSlotIndex = stall.findIndex(s => s === slot);\n                      const totalCost = slot.amount * slot.price;\n                      \n                      return (\n                        <div key={actualSlotIndex} className=\"slot-item\">\n                          <div className=\"slot-info\">\n                            <div className=\"slot-item-name\">\n                              {slot.amount}x {getSymbol(slot.resource)} {getLocalizedString(slot.resource, strings)}\n                            </div>\n                          </div>\n                          \n                          <div className=\"slot-button\">\n                            <div className=\"shared-buttons\">\n                              <TransactionButton\n                                className=\"btn-basic btn-success\"\n                                transactionKey={`global-market-buy-${player.playerId}-${actualSlotIndex}`}\n                                onAction={(transactionId, transactionKey) => \n                                  handleBuyItem(player.playerId, actualSlotIndex, transactionId, transactionKey)\n                                }\n                              >\n                                {strings[365] || \"Buy\"} {totalCost.toLocaleString()}\n                              </TransactionButton>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n          )\n        ) : (\n          // SELL TAB - Player Requests\n          playersWithRequests.length === 0 ? (\n            <div className=\"no-items-container\">\n              <div className=\"no-items-text\">No player requests currently available</div>\n            </div>\n          ) : (\n          <div className=\"players-list\">\n            {playersWithRequests.map(player => {\n              const requests = playerTradeRequests[player.playerId] || [];\n              const activeRequests = requests.filter(slot =>\n                slot?.resource &&\n                slot?.amount > 0 &&\n                slot?.moneyCommitted > 0\n              );\n\n              return (\n                <div key={player.playerId} className=\"player-row\">\n                  <div className=\"player-info\">\n                    <div className=\"player-username\">\n                      {player.icon && <span className=\"player-icon\">{player.icon}</span>}\n                      {player.username}\n                    </div>\n                    <div className=\"player-items-count\">\n                      {activeRequests.length} {strings[364] || \"requests available\"}\n                    </div>\n                  </div>\n\n                  <div className=\"player-slots\">\n                    {activeRequests.map((slot) => {\n                      // Find the actual slot index in the full requests array\n                      const actualSlotIndex = requests.findIndex(s => s === slot);\n\n                      // Check if current player has enough of this resource\n                      const playerInventoryItem = currentPlayer.inventory?.find(\n                        item => item.type === slot.resource\n                      );\n                      const playerHasAmount = playerInventoryItem?.quantity || 0;\n                      const canFulfill = playerHasAmount >= slot.amount;\n\n                      return (\n                        <div\n                          key={actualSlotIndex}\n                          className={`slot-item ${!canFulfill ? 'unfulfillable' : ''}`}\n                        >\n                          <div className=\"slot-info\">\n                            <div className=\"slot-item-name\">\n                              {slot.amount}x {getSymbol(slot.resource)} {getLocalizedString(slot.resource, strings)}\n                            </div>\n                          </div>\n\n                          <div className=\"slot-button\">\n                            <div className=\"shared-buttons\">\n                              <TransactionButton\n                                className=\"btn-basic btn-success\"\n                                transactionKey={`fulfill-request-${player.playerId}-${actualSlotIndex}`}\n                                onAction={(transactionId, transactionKey) =>\n                                  handleFulfillRequest(player.playerId, actualSlotIndex, transactionId, transactionKey)\n                                }\n                                disabled={!canFulfill}\n                              >\n                                {strings[167] || \"Sell\"} {slot.moneyCommitted.toLocaleString()}\n                              </TransactionButton>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n          )\n        )}\n      </div>\n\n      <div className=\"global-market-footer\">\n        <div className=\"shared-buttons\">\n          <button \n            onClick={onClose}\n            className=\"btn-basic btn-neutral\"\n          >\n            {strings[366] || \"Close\"}\n          </button>\n        </div>\n      </div>\n    </Modal>\n  );\n}\n\nexport default GlobalMarketModal;","import API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel'; // Use Panel instead of Modal\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport TradingInventoryModal from '../../UI/Modals/TradingInventoryModal';\nimport axios from 'axios';\nimport './TradeStall.css';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { spendIngredients, gainIngredients, refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { handlePurchase } from '../../Store/Store';\nimport GlobalMarketModal from './GlobalMarketModal';\n\nfunction TradeStall({ onClose, inventory, setInventory, backpack, setBackpack, currentPlayer, setCurrentPlayer, globalTuning, setModalContent, setIsModalOpen, masterResources }) {\n\n  const strings = useStrings();\n  const [tradeSlots, setTradeSlots] = useState([]);\n  const [requestSlots, setRequestSlots] = useState([]);\n  const [activeTab, setActiveTab] = useState('sell'); // 'sell' or 'request'\n  const [selectedSlotIndex, setSelectedSlotIndex] = useState(null);\n  const [selectedRequestSlotIndex, setSelectedRequestSlotIndex] = useState(null);\n  const [amounts, setAmounts] = useState({}); // Store amounts per resource\n  const [requestAmounts, setRequestAmounts] = useState({}); // Store amounts for request modal\n  const [totalSellValue, setTotalSellValue] = useState(0);\n  const [resourceData, setResourceData] = useState([]); // Store resource data\n  const { updateStatus } = useContext(StatusBarContext);\n  const [isLoadingInitial, setIsLoadingInitial] = useState(true); // Loading state for initial data fetch\n  const [isGlobalMarketOpen, setIsGlobalMarketOpen] = useState(false); // Global Market modal state\n\n  const tradeStallSlotConfig = globalTuning?.tradeStallSlots || [];\n  const tradeStallRequestConfig = globalTuning?.tradeStallRequests || [];\n  \n  // Get slot-specific configuration\n  const getSlotConfig = (slotIndex) => {\n    const config = tradeStallSlotConfig.find(slot => slot.slotIndex === slotIndex);\n    return config || {\n      maxAmount: 50,\n      sellWaitTime: 300000,\n      unlocked: slotIndex === 0,\n      unlockCost: 0,\n      requiresGoldPass: false\n    };\n  };\n\n  // Get request slot-specific configuration\n  const getRequestSlotConfig = (slotIndex) => {\n    const config = tradeStallRequestConfig.find(slot => slot.slotIndex === slotIndex);\n    return config || {\n      maxAmount: 10,\n      unlocked: slotIndex === 0,\n      unlockCost: 0,\n      requiresGoldPass: false\n    };\n  };\n\n  const isRequestSlotUnlocked = (slotIndex) => {\n    const slot = requestSlots[slotIndex];\n    const config = getRequestSlotConfig(slotIndex);\n\n    if (!slot) return false;\n\n    if (slot.locked === undefined) {\n      if (slot.resource && slot.amount > 0) return true;\n      return slotIndex === 0;\n    }\n\n    if (slot.locked === true) {\n      if (config.requiresGoldPass && currentPlayer.accountStatus === 'Gold') {\n        return true;\n      }\n      return false;\n    }\n\n    return true;\n  };\n  \n  const isSlotUnlocked = (slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    const config = getSlotConfig(slotIndex);\n    \n    // If slot doesn't exist\n    if (!slot) {\n      return false;\n    }\n    \n    // Handle backward compatibility - if locked field is undefined\n    if (slot.locked === undefined) {\n      // For backward compatibility: slots with items are considered unlocked\n      if (slot.resource && slot.amount > 0) {\n        return true;\n      }\n      // Otherwise, only first slot is unlocked by default\n      return slotIndex === 0;\n    }\n    \n    // If slot is explicitly locked\n    if (slot.locked === true) {\n      // Check if it's a Gold Pass slot and user has Gold Pass\n      if (config.requiresGoldPass && currentPlayer.accountStatus === 'Gold') {\n        return true; // Gold Pass overrides the locked state\n      }\n      return false;\n    }\n    \n    return true; // If not locked, it's unlocked\n  };\n  \n  const handleUnlockSlot = async (slotIndex) => {\n    const config = getSlotConfig(slotIndex);\n    if (!config || config.requiresGoldPass) return;\n    \n    try {\n      // First, use spendIngredients to handle the wood cost properly\n      const tempRecipe = { \n        ingredient1: 'Wood', \n        ingredient1qty: config.unlockCost \n      };\n      \n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: tempRecipe,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {}, // No-op\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) {\n        console.warn('Not enough Wood to unlock this slot.');\n        updateStatus(`${strings[177]} ${config.unlockCost} ${getSymbol('Wood')} ${strings[176]} ${strings[178]}`);\n        return;\n      }\n      \n      // If wood was spent successfully, update only this specific slot\n      const updatedSlots = tradeSlots.map((slot, index) => {\n        if (index === slotIndex) {\n          return {\n            ...slot,\n            locked: false\n          };\n        }\n        return slot;\n      });\n      \n      // Update the trade stall on the server\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: currentPlayer.playerId,\n        tradeStall: updatedSlots\n      });\n      \n      // Update local state\n      setTradeSlots(updatedSlots);\n      setCurrentPlayer({\n        ...currentPlayer,\n        tradeStall: updatedSlots\n      });\n      \n      // Refresh player data to ensure consistency\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      \n      // Re-fetch trade stall data to ensure UI is in sync\n      await fetchDataForViewedPlayer(true); // Skip inventory fetch since it was just updated\n      \n      updateStatus(`${strings[170]}`);\n    } catch (error) {\n      console.error('Error unlocking slot:', error);\n      updateStatus('Failed to unlock slot');\n    }\n  };\n\n\n  // Lift fetchDataForViewedPlayer out of useEffect for reuse\n  const fetchDataForViewedPlayer = async (skipInventoryFetch = false) => {\n    try {\n      if (!skipInventoryFetch) {\n        setIsLoadingInitial(true);\n      }\n      // Fetch resource data (e.g., for prices)\n      const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n      setResourceData(resourcesResponse.data);\n\n      // Only fetch inventory if not skipping (to avoid overwriting during collections)\n      if (!skipInventoryFetch) {\n        const currentInventoryResponse = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n        setInventory(currentInventoryResponse.data.inventory || []);\n      }\n\n      // Fetch trade stall data for the current player\n      const tradeStallResponse = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId: currentPlayer.playerId },\n      });\n\n      // Always show all 6 slots\n      const serverSlots = tradeStallResponse.data.tradeStall || [];\n\n      // Ensure we have exactly 6 slots from server, preserve existing slot data\n      const allSlots = Array.from({ length: 6 }, (_, index) => {\n        const existingSlot = serverSlots.find(slot => slot && slot.slotIndex === index);\n        if (existingSlot) {\n          // Preserve all existing slot data including locked state\n          return existingSlot;\n        }\n        // Only create default locked slot if it doesn't exist on server\n        return {\n          slotIndex: index,\n          locked: true,\n          resource: null,\n          amount: 0,\n          price: 0,\n          sellTime: null,\n          boughtBy: null,\n          boughtFor: null\n        };\n      });\n\n      setTradeSlots(allSlots);\n\n      // Fetch request slots data\n      const requestSlotsResponse = await axios.get(`${API_BASE}/api/player-trade-stall-requests`, {\n        params: { playerId: currentPlayer.playerId },\n      });\n\n      const serverRequestSlots = requestSlotsResponse.data.tradeStallRequests || [];\n      const allRequestSlots = Array.from({ length: 3 }, (_, index) => {\n        const existingSlot = serverRequestSlots.find(slot => slot && slot.slotIndex === index);\n        if (existingSlot) {\n          return existingSlot;\n        }\n        return {\n          slotIndex: index,\n          locked: true,\n          resource: null,\n          amount: 0,\n          price: 0,\n          moneyCommitted: 0\n        };\n      });\n\n      setRequestSlots(allRequestSlots);\n\n      // Calculate total sell value for current player's stall\n      const total = allSlots.reduce((sum, slot) => {\n        if (slot?.resource && slot?.amount && slot?.price && !slot?.boughtBy) {\n          return sum + slot.amount * slot.price;\n        }\n        return sum;\n      }, 0);\n      setTotalSellValue(total);\n    } catch (error) {\n      console.error('Error fetching TradeStall data:', error);\n    } finally {\n      setIsLoadingInitial(false);\n    }\n  };\n\n  useEffect(() => {\n    // Only fetch data for current player's own trade stall\n    fetchDataForViewedPlayer();\n  }, [currentPlayer?.playerId]); // Only depend on current player\n  \n  // Handle buying from global market\n  const handleGlobalMarketBuy = async (playerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      // Re-fetch latest data to confirm availability\n      const tradeStallResponse = await axios.get(`${API_BASE}/api/player-trade-stall`, {\n        params: { playerId },\n      });\n      const latestSlots = tradeStallResponse.data.tradeStall || [];\n      const currentSlot = latestSlots[slotIndex];\n      \n      if (!currentSlot || currentSlot.boughtBy) {\n        updateStatus(155); // Item was already purchased\n        return;\n      }\n\n      const totalCost = currentSlot.amount * currentSlot.price;\n      const currentMoney = inventory.find((item) => item.type === 'Money')?.quantity || 0;\n\n      if (totalCost > currentMoney) {\n        console.warn('Not enough money to complete the purchase.');\n        updateStatus(152);\n        return;\n      }\n\n      // Use the same purchase logic as the original handleBuy\n      const tempRecipe = { ingredient1: 'Money', ingredient1qty: totalCost };\n\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: tempRecipe,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n      });\n      \n      if (!success) {\n        console.warn('Not enough Money to buy this item.');\n        return;\n      }\n\n      const gainResult = await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: currentSlot.resource,\n        quantity: currentSlot.amount,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Check if gaining items failed (e.g., warehouse full)\n      if (gainResult && gainResult.success === false) {\n        console.warn('Failed to add items to inventory:', gainResult.error?.message);\n\n        // Rollback the money that was spent\n        await gainIngredients({\n          playerId: currentPlayer.playerId,\n          currentPlayer,\n          resource: 'Money',\n          quantity: totalCost,\n          inventory: currentPlayer.inventory || inventory,\n          backpack: currentPlayer.backpack || [],\n          setInventory,\n          setBackpack: () => {},\n          setCurrentPlayer,\n          updateStatus: () => {}, // Don't show status for refund\n          masterResources,\n          globalTuning,\n        });\n\n        // Don't mark the item as sold, just return\n        // Note: updateStatus was already called by gainIngredients to show warehouse full\n        return;\n      }\n\n      // Update the seller's TradeStall to mark the slot as purchased\n      const updatedSlots = [...latestSlots];\n      updatedSlots[slotIndex] = {\n        ...currentSlot,\n        sellTime: null,\n        boughtBy: currentPlayer.username,\n        boughtFor: totalCost,\n      };\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: playerId,\n        tradeStall: updatedSlots,\n      });\n\n      updateStatus(22); // Purchase successful\n    } catch (error) {\n      console.error('Error processing global market purchase:', error);\n      throw error;\n    }\n  };\n\n  // Handle fulfilling a request from global market (selling to a player's request)\n  const handleGlobalMarketFulfillRequest = async (buyerPlayerId, slotIndex, transactionId, transactionKey) => {\n    try {\n      const response = await axios.post(`${API_BASE}/api/trade-stall/fulfill-request`, {\n        sellerPlayerId: currentPlayer.playerId,\n        buyerPlayerId,\n        slotIndex,\n        transactionId,\n        transactionKey: `${transactionKey}-${slotIndex}`\n      });\n\n      if (response.data.success) {\n        // Update seller's (current player's) inventory using the returned data\n        setInventory(response.data.sellerInventory);\n        setCurrentPlayer(prev => ({\n          ...prev,\n          inventory: response.data.sellerInventory\n        }));\n\n        updateStatus(`Sold ${response.data.amount}x ${getLocalizedString(response.data.resource, strings)} for ${response.data.earned}`);\n      }\n    } catch (error) {\n      console.error('Error fulfilling request:', error);\n      if (error.response?.status === 400) {\n        updateStatus(error.response.data.error || 'Failed to fulfill request');\n      } else {\n        updateStatus(' Failed to fulfill request');\n      }\n      throw error;\n    }\n  };\n\n  const handleSlotClick = (index) => {\n    const slot = tradeSlots[index];\n    const isEmpty = !slot?.resource;\n    const slotUnlocked = isSlotUnlocked(index);\n    const config = getSlotConfig(index);\n    \n    console.log('Slot clicked:', index, 'Is unlocked:', slotUnlocked, 'Is empty:', isEmpty);\n\n    // If slot is locked\n    if (!slotUnlocked) {\n      if (config.requiresGoldPass && currentPlayer.accountStatus !== 'Gold') {\n        // Gold Pass required - do nothing, button will handle it\n        return;\n      } else if (!config.requiresGoldPass) {\n        // Regular unlock with wood - do nothing, button will handle it\n        return;\n      }\n    }\n    \n    // Only allow slot clicks for empty, unlocked slots\n    if (isEmpty && slotUnlocked) {\n      setSelectedSlotIndex(index); // Open inventory modal\n      // Reset amounts when opening modal to prevent quantity persistence bug\n      setAmounts({});\n    }\n    // All other clicks do nothing\n  };\n  \n\n  \n  \n  const handleAmountChange = (type, value) => {\n    const resourceInInventory = inventory.find((item) => item.type === type);\n    const inventoryAmount = resourceInInventory ? resourceInInventory.quantity : 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    const maxAmount = Math.min(inventoryAmount, slotConfig.maxAmount);\n  \n    setAmounts((prev) => ({\n      ...prev,\n      [type]: Math.min(Math.max(0, value), maxAmount), // Ensure value is within 0 and maxAmount\n    }));\n  };\n\n  const handleAddToSlot = async (transactionId, transactionKey, resource) => {\n    let amount = amounts[resource] || 0;\n    const resourceInInventory = inventory.find((item) => item.type === resource);\n\n    if (selectedSlotIndex === null || amount <= 0 || !resourceInInventory || amount > resourceInInventory.quantity) {\n      console.warn('Invalid amount or resource exceeds available quantity.');\n      return;\n    }\n    \n    // Get slot configuration and enforce max amount limit\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    if (amount > slotConfig.maxAmount) {\n      amount = slotConfig.maxAmount;\n      console.log(`Amount adjusted to slot limit: ${amount} (max: ${slotConfig.maxAmount})`);\n    }\n\n    // Check if selling all of a crop item\n    if (amount === resourceInInventory.quantity && isACrop(resource, masterResources)) {\n      // Check if the plot for this crop has a cost\n      const plotResource = masterResources.find(res => res.output === resource && res.category === 'farmplot');\n      const plotHasCost = plotResource && plotResource.ingredient1qty > 0;\n      \n      // Only show confirmation if the plot has a cost (e.g., Corn Plot costs 1 Corn)\n      if (plotHasCost) {\n        // Show confirmation modal using standard modal system\n        setModalContent({\n        title: ' Warning',\n        message: `This will leave you with 0 ${resource}, so you will not be able to plant ${resource} again.`,\n        message2: 'Are you sure?',\n        size: 'small',\n        onClose: () => setIsModalOpen(false),\n        children: (\n          <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n            <button\n              className=\"btn-basic btn-neutral\"\n              onClick={() => setIsModalOpen(false)}\n            >\n              Cancel\n            </button>\n            <button \n              className=\"btn-basic btn-danger\"\n              onClick={async () => {\n                setIsModalOpen(false);\n                // Re-check slot limit in case it changed\n                const slotConfig = getSlotConfig(selectedSlotIndex);\n                const finalAmount = Math.min(amount, slotConfig.maxAmount);\n                await performAddToSlot(transactionId, transactionKey, resource, finalAmount);\n              }}\n            >\n              {strings[168]}\n            </button>\n          </div>\n        ),\n      });\n      setIsModalOpen(true);\n      return;\n      }\n    }\n\n    // Continue with normal add to slot\n    await performAddToSlot(transactionId, transactionKey, resource, amount);\n  };\n\n  const performAddToSlot = async (transactionId, transactionKey, resource, amount) => {\n    const resourceDetails = resourceData.find((item) => item.type === resource);\n    const price = resourceDetails?.maxprice || 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n\n    const updatedSlots = [...tradeSlots];\n    // Update the specific slot with the new item, preserving slotIndex\n    updatedSlots[selectedSlotIndex] = { \n      slotIndex: selectedSlotIndex,\n      resource, \n      amount, \n      price, \n      sellTime: Date.now() + slotConfig.sellWaitTime,\n      boughtBy: null,\n      boughtFor: null\n    };\n\n    try {\n      await axios.post(`${API_BASE}/api/update-player-trade-stall`, {\n        playerId: currentPlayer.playerId,\n        tradeStall: updatedSlots,\n      });\n\n      await axios.post(`${API_BASE}/api/update-inventory`, {\n        playerId: currentPlayer.playerId,\n        inventory: inventory.map((item) =>\n          item.type === resource\n            ? { ...item, quantity: item.quantity - amount }\n            : item\n        ).filter((item) => item.quantity > 0),\n      });\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      const refreshedInventory = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(refreshedInventory.data.inventory);\n\n      setTradeSlots(updatedSlots);\n      setSelectedSlotIndex(null);\n      calculateTotalSellValue(updatedSlots);\n    } catch (error) {\n      console.error('Error adding item to Trade Stall:', error);\n      throw error; // Re-throw to let TransactionButton handle the error state\n    }\n  };\n\n  \n  // Protected function to sell items to game using transaction system\n  const handleSellSingle = async (transactionId, transactionKey, slotIndex) => {\n    console.log(` [PROTECTED SELL] Starting protected sell for slot ${slotIndex}`);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/trade-stall/sell-to-game`, {\n        playerId: currentPlayer.playerId,\n        slotIndex,\n        transactionId,\n        transactionKey: `${transactionKey}-${slotIndex}`\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        if (response.data.tradeStall) {\n          setTradeSlots(response.data.tradeStall);\n          // Also update currentPlayer to trigger UI updates\n          setCurrentPlayer(prev => ({\n            ...prev,\n            tradeStall: response.data.tradeStall\n          }));\n        }\n        if (response.data.inventory) {\n          setInventory(response.data.inventory);\n          // Also update currentPlayer's inventory to trigger UI updates\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        // Track quest progress for selling this item\n        await trackQuestProgress(currentPlayer, 'Sell', response.data.resource, response.data.amount, setCurrentPlayer);\n        \n        updateStatus(`${strings[141]} ${response.data.amount}x ${getLocalizedString(response.data.resource, strings)} ( ${response.data.sold}).`);\n        \n        // Refresh trade stall data to ensure consistency\n        await fetchDataForViewedPlayer(true); // Skip inventory fetch to preserve server state\n      }\n    } catch (error) {\n      console.error('Error in protected sell:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to sell item');\n      }\n    }\n  };\n\n  const calculateTotalSellValue = (slots) => {\n    console.log('Inside calculateTotalSetllValue; Current Inventory:', inventory);\n    const total = slots.reduce((sum, slot) => {\n      if (slot?.amount && slot?.price) {\n        return sum + slot.amount * slot.price;\n      }\n      return sum;\n    }, 0);\n    setTotalSellValue(total);\n  };\n\n  \n  \n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n  \n  // Protected function to collect payment from a bought slot using transaction system\n  const handleCollectPayment = async (transactionId, transactionKey, slotIndex) => {\n    console.log(` [PROTECTED COLLECTION] Starting protected collection for slot ${slotIndex}`);\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/trade-stall/collect-payment`, {\n        playerId: currentPlayer.playerId,\n        slotIndex,\n        transactionId,\n        transactionKey: `${transactionKey}-${slotIndex}`\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        if (response.data.tradeStall) {\n          setTradeSlots(response.data.tradeStall);\n        }\n        if (response.data.inventory) {\n          setInventory(response.data.inventory);\n          // Force update currentPlayer to trigger UI refresh\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory,\n            tradeStall: response.data.tradeStall\n          }));\n        }\n\n        // Track quest progress for selling this item\n        await trackQuestProgress(currentPlayer, 'Sell', response.data.resource, response.data.amount, setCurrentPlayer);\n\n        updateStatus(` Collected ${response.data.collected}.`);\n\n        // Refresh trade stall data to ensure consistency\n        await fetchDataForViewedPlayer(true); // Skip inventory fetch to preserve server state\n      }\n    } catch (error) {\n      console.error('Error in protected collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect payment');\n      }\n    }\n  };\n\n  // Handle request slot click\n  const handleRequestSlotClick = (index) => {\n    const slot = requestSlots[index];\n    const isEmpty = !slot?.resource;\n    const slotUnlocked = isRequestSlotUnlocked(index);\n\n    if (isEmpty && slotUnlocked) {\n      setSelectedRequestSlotIndex(index);\n      setRequestAmounts({});\n    }\n  };\n\n  // Handle request amount change\n  const handleRequestAmountChange = (type, value) => {\n    const slotConfig = getRequestSlotConfig(selectedRequestSlotIndex);\n    const maxAmount = slotConfig.maxAmount;\n\n    setRequestAmounts((prev) => ({\n      ...prev,\n      [type]: Math.min(Math.max(0, value), maxAmount)\n    }));\n  };\n\n  // Handle creating a request (commits money)\n  const handleCreateRequest = async (transactionId, transactionKey, resource) => {\n    const amount = requestAmounts[resource] || 0;\n\n    if (selectedRequestSlotIndex === null || amount <= 0) {\n      console.warn('Invalid amount for request.');\n      return;\n    }\n\n    const resourceDetails = resourceData.find((item) => item.type === resource);\n    const price = resourceDetails?.maxprice || 0;\n    const totalCost = amount * price;\n\n    // Check if player has enough money\n    const currentMoney = inventory.find((item) => item.type === 'Money')?.quantity || 0;\n    if (totalCost > currentMoney) {\n      updateStatus(\"You don't have enough money\");\n      return;\n    }\n\n    // Commit the money using spendIngredients\n    const tempRecipe = { ingredient1: 'Money', ingredient1qty: totalCost };\n\n    const success = await spendIngredients({\n      playerId: currentPlayer.playerId,\n      recipe: tempRecipe,\n      inventory: currentPlayer.inventory || inventory,\n      backpack: currentPlayer.backpack || [],\n      setInventory,\n      setBackpack: () => {},\n      setCurrentPlayer,\n      updateStatus,\n    });\n\n    if (!success) {\n      console.warn('Not enough Money to create request.');\n      updateStatus(\"You don't have enough money\");\n      return;\n    }\n\n    // Update request slots\n    const updatedRequestSlots = [...requestSlots];\n    updatedRequestSlots[selectedRequestSlotIndex] = {\n      slotIndex: selectedRequestSlotIndex,\n      resource,\n      amount,\n      price,\n      moneyCommitted: totalCost\n    };\n\n    try {\n      await axios.post(`${API_BASE}/api/update-player-trade-stall-requests`, {\n        playerId: currentPlayer.playerId,\n        tradeStallRequests: updatedRequestSlots\n      });\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      const refreshedInventory = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(refreshedInventory.data.inventory);\n\n      setRequestSlots(updatedRequestSlots);\n      setSelectedRequestSlotIndex(null);\n      updateStatus(`Request posted for ${amount}x ${getLocalizedString(resource, strings)}`);\n    } catch (error) {\n      console.error('Error creating request:', error);\n      throw error;\n    }\n  };\n\n  // Handle canceling a request (refunds money)\n  const handleCancelRequest = async (transactionId, transactionKey, slotIndex) => {\n    const slot = requestSlots[slotIndex];\n\n    if (!slot?.resource || !slot?.moneyCommitted) {\n      console.warn('No request to cancel in this slot.');\n      return;\n    }\n\n    try {\n      // Refund the committed money\n      await gainIngredients({\n        playerId: currentPlayer.playerId,\n        currentPlayer,\n        resource: 'Money',\n        quantity: slot.moneyCommitted,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n        masterResources,\n        globalTuning,\n      });\n\n      // Clear the request slot\n      const updatedRequestSlots = [...requestSlots];\n      updatedRequestSlots[slotIndex] = {\n        slotIndex,\n        locked: slot.locked,\n        resource: null,\n        amount: 0,\n        price: 0,\n        moneyCommitted: 0\n      };\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall-requests`, {\n        playerId: currentPlayer.playerId,\n        tradeStallRequests: updatedRequestSlots\n      });\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n      const refreshedInventory = await axios.get(`${API_BASE}/api/inventory/${currentPlayer.playerId}`);\n      setInventory(refreshedInventory.data.inventory);\n\n      setRequestSlots(updatedRequestSlots);\n      updateStatus(`Request canceled. Refunded ${slot.moneyCommitted}`);\n    } catch (error) {\n      console.error('Error canceling request:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to cancel request');\n      }\n    }\n  };\n\n  // Handle unlocking a request slot\n  const handleUnlockRequestSlot = async (slotIndex) => {\n    const config = getRequestSlotConfig(slotIndex);\n    if (!config || config.requiresGoldPass) return;\n\n    try {\n      const tempRecipe = {\n        ingredient1: 'Wood',\n        ingredient1qty: config.unlockCost\n      };\n\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: tempRecipe,\n        inventory: currentPlayer.inventory || inventory,\n        backpack: currentPlayer.backpack || [],\n        setInventory,\n        setBackpack: () => {},\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!success) {\n        console.warn('Not enough Wood to unlock this request slot.');\n        updateStatus(`${strings[177]} ${config.unlockCost} ${getSymbol('Wood')} ${strings[176]} ${strings[178]}`);\n        return;\n      }\n\n      const updatedSlots = requestSlots.map((slot, index) => {\n        if (index === slotIndex) {\n          return {\n            ...slot,\n            locked: false\n          };\n        }\n        return slot;\n      });\n\n      await axios.post(`${API_BASE}/api/update-player-trade-stall-requests`, {\n        playerId: currentPlayer.playerId,\n        tradeStallRequests: updatedSlots\n      });\n\n      setRequestSlots(updatedSlots);\n      setCurrentPlayer({\n        ...currentPlayer,\n        tradeStallRequests: updatedSlots\n      });\n\n      await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n      await fetchDataForViewedPlayer(true);\n\n      updateStatus(`${strings[170]}`);\n    } catch (error) {\n      console.error('Error unlocking request slot:', error);\n      updateStatus('Failed to unlock slot');\n    }\n  };\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"TradeStall\">\n\n      {/* GLOBAL MARKET BUTTON */}\n\n        <div className=\"shared-buttons\" style={{ margin: '2px 0' }}>\n          <button\n            className=\"btn-basic btn-success\"\n            onClick={() => setIsGlobalMarketOpen(true)}\n          >\n             {strings[362] || \"Global Market\"}\n          </button>\n        </div>\n\n      {/* SEPARATOR AND HEADER */}\n      <div style={{ margin: '16px 0' }}>\n      </div>\n\n      {/* TAB NAVIGATION */}\n      <div className=\"tab-navigation\">\n        <button\n          className={`tab-button ${activeTab === 'sell' ? 'active' : ''}`}\n          onClick={() => setActiveTab('sell')}\n        >\n          Sell\n        </button>\n        <button\n          className={`tab-button ${activeTab === 'request' ? 'active' : ''}`}\n          onClick={() => setActiveTab('request')}\n        >\n          Request\n        </button>\n      </div>\n\n      {/* LOADING INDICATOR */}\n      {isLoadingInitial ? (\n        <div style={{ textAlign: 'center', padding: '40px', fontSize: '1.2rem' }}>\n          {strings[98]}\n        </div>\n      ) : (\n        <>\n          {/* SELL TAB - TRADE STALL SLOTS */}\n          {activeTab === 'sell' && (\n          <div className=\"trade-stall-slots shared-buttons\">\n        {tradeSlots.map((slot, index) => {\n          const isOwnStall = true; // Always viewing own stall now\n          const isEmpty = !slot?.resource;\n          const isPurchased = slot?.boughtBy;\n          const isReadyToSell = slot?.sellTime && slot.sellTime <= Date.now();\n          const hasTimer = slot?.sellTime && slot.sellTime > Date.now();\n          const slotUnlocked = isSlotUnlocked(index);\n          const config = getSlotConfig(index);\n          \n          return (\n            <React.Fragment key={index}>\n              <div className=\"trade-slot-container\">\n                {/* 1. SLOT DISPLAY */}\n                <div\n                  className={`trade-slot btn-basic ${isEmpty && slotUnlocked ? 'btn-neutral' : ''} ${!isEmpty && !isPurchased && !isReadyToSell ? 'filled' : ''} ${isPurchased ? 'btn-collect' : ''} ${!slotUnlocked && index >= 4 ? 'locked gold-slot btn-gold' : !slotUnlocked ? 'locked' : ''} ${isReadyToSell && !isPurchased ? 'btn-sell' : ''}`}\n                  onClick={() => {\n                    if (isOwnStall && isEmpty && slotUnlocked) {\n                      handleSlotClick(index);\n                    } else if (isOwnStall && isPurchased) {\n                      // Handle collect payment\n                      handleCollectPayment(`collect-${Date.now()}`, 'collect-payment', index);\n                    } else if (isOwnStall && isReadyToSell && !isPurchased) {\n                      // Handle sell to game\n                      handleSellSingle(`sell-${Date.now()}`, 'sell-to-game', index);\n                    }\n                  }}\n                >\n                  {(index >= 4 && currentPlayer.accountStatus !== 'Gold' && isOwnStall) ? (\n                    // Always show Gold Pass required for slots 5-6 for non-Gold users\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div className=\"trade-slot-lock-text\">{strings[171]}</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : (!slotUnlocked && isOwnStall) ? (\n                    // Show unlock UI for locked slots on own stall\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : isEmpty ? (\n                    <div className=\"trade-slot-empty-text\">\n                      <div> {strings[156]}</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                      <div style={{ fontSize: '0.8rem' }}>\n                        {formatDuration(config.sellWaitTime / 1000)} {strings[174]}\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"trade-slot-content\">\n                      <div className=\"trade-slot-item-name\">\n                        {`${slot.amount}x ${getSymbol(slot.resource)} ${getLocalizedString(slot.resource, strings)}`}\n                      </div>\n                      {isPurchased && (\n                        <>\n                          <div className=\"trade-slot-status\">\n                            {strings[157]} {slot.boughtBy}\n                          </div>\n                          <div className=\"trade-slot-status\">\n                            {strings[318]} {slot.boughtFor.toLocaleString()}\n                          </div>\n                        </>\n                      )}\n                      {hasTimer && !isPurchased && (\n                        <div className=\"trade-slot-status timer\">\n                          {formatCountdown(slot.sellTime, Date.now())}\n                        </div>\n                      )}\n                      {isReadyToSell && !isPurchased && (\n                        <div className=\"trade-slot-status ready\">\n                          {strings[167]} {(slot.amount * slot.price).toLocaleString()}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                {/* 2. BUTTON CONTAINER */}\n                {(index >= 4 && currentPlayer.accountStatus !== 'Gold' && isOwnStall) ? (\n                  // Show Gold Pass purchase button for slots 5-6\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button \n                        className=\"btn-basic btn-gold\"\n                        style={{ width: '100%' }}\n                        onClick={() => handlePurchase(1, currentPlayer, updateStatus)}\n                      >\n                        {strings[9061]}\n                      </button>\n                    </div>\n                  </div>\n                ) : (!slotUnlocked && isOwnStall) ? (\n                  // Show unlock button for locked non-Gold Pass slots\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button \n                        className=\"btn-basic btn-neutral\"\n                        style={{ width: '100%' }}\n                        onClick={() => handleUnlockSlot(index)}\n                      >\n                        {strings[175]} {config.unlockCost} {getSymbol('Wood')} {strings[176]}\n                      </button>\n                    </div>\n                  </div>\n                ) : null}\n              </div>\n            </React.Fragment>\n          );\n        })}\n      </div>\n          )}\n\n          {/* REQUEST TAB - REQUEST SLOTS */}\n          {activeTab === 'request' && (\n          <div className=\"trade-stall-slots shared-buttons\">\n        {requestSlots.map((slot, index) => {\n          const isEmpty = !slot?.resource;\n          const slotUnlocked = isRequestSlotUnlocked(index);\n          const config = getRequestSlotConfig(index);\n\n          return (\n            <React.Fragment key={index}>\n              <div className=\"trade-slot-container\">\n                {/* 1. SLOT DISPLAY */}\n                <div\n                  className={`trade-slot btn-basic ${isEmpty && slotUnlocked ? 'btn-neutral' : ''} ${!isEmpty ? 'filled' : ''} ${!slotUnlocked && config.requiresGoldPass ? 'locked gold-slot btn-gold' : !slotUnlocked ? 'locked' : ''}`}\n                  onClick={() => {\n                    if (isEmpty && slotUnlocked) {\n                      handleRequestSlotClick(index);\n                    }\n                  }}\n                >\n                  {(config.requiresGoldPass && currentPlayer.accountStatus !== 'Gold') ? (\n                    // Gold Pass required\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div className=\"trade-slot-lock-text\">{strings[171]}</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                    </div>\n                  ) : (!slotUnlocked) ? (\n                    // Show unlock UI for locked slots\n                    <div className=\"trade-slot-locked\">\n                      <div className=\"trade-slot-lock-icon\"></div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                    </div>\n                  ) : isEmpty ? (\n                    <div className=\"trade-slot-empty-text\">\n                      <div> Add Request</div>\n                      <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                        {strings[173]} {config.maxAmount}\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"trade-slot-content\">\n                      <div className=\"trade-slot-item-name\">\n                        {`${slot.amount}x ${getSymbol(slot.resource)} ${getLocalizedString(slot.resource, strings)}`}\n                      </div>\n                      <div className=\"trade-slot-status\">\n                        You Pay: {slot.moneyCommitted.toLocaleString()}\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                {/* 2. BUTTON CONTAINER */}\n                {(config.requiresGoldPass && currentPlayer.accountStatus !== 'Gold') ? (\n                  // Show Gold Pass purchase button\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button\n                        className=\"btn-basic btn-gold\"\n                        style={{ width: '100%' }}\n                        onClick={() => handlePurchase(1, currentPlayer, updateStatus)}\n                      >\n                        {strings[9061]}\n                      </button>\n                    </div>\n                  </div>\n                ) : (!slotUnlocked) ? (\n                  // Show unlock button for locked slots\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <button\n                        className=\"btn-basic btn-neutral\"\n                        style={{ width: '100%' }}\n                        onClick={() => handleUnlockRequestSlot(index)}\n                      >\n                        {strings[175]} {config.unlockCost} {getSymbol('Wood')} {strings[176]}\n                      </button>\n                    </div>\n                  </div>\n                ) : (!isEmpty) ? (\n                  // Show cancel button for active requests\n                  <div className=\"trade-button-container\">\n                    <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                      <TransactionButton\n                        className=\"btn-basic btn-danger\"\n                        style={{ width: '100%' }}\n                        transactionKey={`cancel-request-${index}`}\n                        onAction={(transactionId, transactionKey) => handleCancelRequest(transactionId, transactionKey, index)}\n                      >\n                        Cancel Request\n                      </TransactionButton>\n                    </div>\n                  </div>\n                ) : null}\n              </div>\n            </React.Fragment>\n          );\n        })}\n      </div>\n          )}\n        </>\n      )}\n\n{/* TRADING INVENTORY MODAL */}\n      <TradingInventoryModal\n        isOpen={selectedSlotIndex !== null}\n        onClose={() => setSelectedSlotIndex(null)}\n        inventory={inventory}\n        resourceData={resourceData}\n        amounts={amounts}\n        handleAmountChange={handleAmountChange}\n        handleAddToSlot={handleAddToSlot}\n        getSlotConfig={getSlotConfig}\n        selectedSlotIndex={selectedSlotIndex}\n        transactionKeyPrefix=\"add-to-trade-slot\"\n      />\n\n      {/* REQUEST INVENTORY MODAL */}\n      <TradingInventoryModal\n        isOpen={selectedRequestSlotIndex !== null}\n        onClose={() => setSelectedRequestSlotIndex(null)}\n        inventory={resourceData\n          .filter(res => res.category === 'doober')\n          .map(res => {\n            // Calculate actual quantity player has in inventory + backpack\n            const inventoryQty = currentPlayer.inventory?.find(item => item.type === res.type)?.quantity || 0;\n            const backpackQty = currentPlayer.backpack?.find(item => item.type === res.type)?.quantity || 0;\n            const totalQty = inventoryQty + backpackQty;\n\n            return {\n              type: res.type,\n              quantity: totalQty\n            };\n          })\n        }\n        resourceData={resourceData}\n        amounts={requestAmounts}\n        handleAmountChange={handleRequestAmountChange}\n        handleAddToSlot={handleCreateRequest}\n        getSlotConfig={getRequestSlotConfig}\n        selectedSlotIndex={selectedRequestSlotIndex}\n        transactionKeyPrefix=\"create-request\"\n        isRequestMode={true}\n        playerMoney={inventory.find(item => item.type === 'Money')?.quantity || 0}\n      />\n\n      {/* GLOBAL MARKET MODAL */}\n      <GlobalMarketModal\n        isOpen={isGlobalMarketOpen}\n        onClose={() => setIsGlobalMarketOpen(false)}\n        currentPlayer={currentPlayer}\n        onBuyItem={handleGlobalMarketBuy}\n        onFulfillRequest={handleGlobalMarketFulfillRequest}\n        masterResources={masterResources}\n        globalTuning={globalTuning}\n      />\n\n    </Panel>\n  );\n};\n\nexport default TradeStall;","import API_BASE from '../../config';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport TradingInventoryModal from '../../UI/Modals/TradingInventoryModal';\nimport axios from 'axios';\nimport './TradeStall.css';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport { formatCountdown, formatDuration } from '../../UI/Timers';\nimport { isACrop } from '../../Utils/ResourceHelpers';\nimport { handleProtectedSelling } from '../../Utils/ProtectedSelling';\n\nfunction Outpost({ onClose, backpack, setBackpack, currentPlayer, setCurrentPlayer, gridId, setModalContent, setIsModalOpen, isDeveloper, stationType, currentStationPosition, setResources, setInventory, TILE_SIZE, globalTuning }) {\n  const strings = useStrings();\n  const [tradeSlots, setTradeSlots] = useState([]);\n  const [selectedSlotIndex, setSelectedSlotIndex] = useState(null);\n  const [amounts, setAmounts] = useState({}); // Store amounts per resource\n  const [resourceData, setResourceData] = useState([]); // Store resource data\n  const { updateStatus } = useContext(StatusBarContext);\n  const [masterResources, setMasterResources] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [currentTime, setCurrentTime] = useState(Date.now());\n\n  // Use Trading Post configuration from globalTuning\n  const OUTPOST_SLOTS = 4;\n  \n  // Get slot-specific configuration\n  const getSlotConfig = (slotIndex) => {\n    const slotConfig = globalTuning?.tradeStallSlots?.find(slot => slot.slotIndex === slotIndex);\n    return slotConfig || {\n      maxAmount: 50,\n      sellWaitTime: 300000\n    };\n  };\n\n  // Initialize trade slots structure\n  useEffect(() => {\n    const initSlots = [];\n    for (let i = 0; i < OUTPOST_SLOTS; i++) {\n      initSlots.push({\n        slotIndex: i,\n        resource: null,\n        amount: 0,\n        price: 0,\n        sellTime: null,\n        boughtBy: null,\n        boughtFor: null,\n        sellerUsername: null,\n        sellerId: null\n      });\n    }\n    setTradeSlots(initSlots);\n  }, []);\n\n  // Fetch data on component mount\n  useEffect(() => {\n    const fetchData = async () => {\n      setIsLoading(true);\n      try {\n        // Fetch resource data for prices\n        const resourcesResponse = await axios.get(`${API_BASE}/api/resources`);\n        setResourceData(resourcesResponse.data);\n        setMasterResources(resourcesResponse.data);\n\n        // Fetch grid data to get outpost trade stall\n        const gridResponse = await axios.get(`${API_BASE}/api/load-grid/${gridId}`);\n        \n        if (gridResponse.data.outpostTradeStall && Array.isArray(gridResponse.data.outpostTradeStall)) {\n          setTradeSlots(gridResponse.data.outpostTradeStall);\n        }\n        // Otherwise keep the default slots initialized in the previous useEffect\n      } catch (error) {\n        console.error('Error fetching Outpost data:', error);\n        updateStatus('Failed to load Outpost data');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [gridId]);\n\n  // Update current time every second for live countdown\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(Date.now());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  const getSymbol = (resourceType) => {\n    const resource = resourceData.find((res) => res.type === resourceType);\n    return resource?.symbol || '';\n  };\n\n  const handleSlotClick = (index) => {\n    const slot = tradeSlots[index];\n    const isEmpty = !slot?.resource;\n    \n    // Only allow adding items to empty slots\n    if (isEmpty) {\n      setSelectedSlotIndex(index);\n      // Reset amounts when opening modal to prevent quantity persistence bug\n      setAmounts({});\n    }\n  };\n\n  const handleAmountChange = (type, value) => {\n    const resourceInBackpack = backpack.find((item) => item.type === type);\n    const backpackAmount = resourceInBackpack ? resourceInBackpack.quantity : 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    const maxAmount = Math.min(backpackAmount, slotConfig.maxAmount);\n\n    setAmounts((prev) => ({\n      ...prev,\n      [type]: Math.min(Math.max(0, value), maxAmount),\n    }));\n  };\n\n  const handleAddToSlot = async (transactionId, transactionKey, resource) => {\n    let amount = amounts[resource] || 0;\n    const resourceInBackpack = backpack.find((item) => item.type === resource);\n\n    if (selectedSlotIndex === null || amount <= 0 || !resourceInBackpack || amount > resourceInBackpack.quantity) {\n      console.warn('Invalid amount or resource exceeds available quantity.');\n      return;\n    }\n    \n    // Get slot configuration and enforce max amount limit\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n    if (amount > slotConfig.maxAmount) {\n      amount = slotConfig.maxAmount;\n      console.log(`Amount adjusted to slot limit: ${amount} (max: ${slotConfig.maxAmount})`);\n    }\n\n    // Check if selling all of a crop item\n    if (amount === resourceInBackpack.quantity && isACrop(resource, masterResources)) {\n      const plotResource = masterResources.find(res => res.output === resource && res.category === 'farmplot');\n      const plotHasCost = plotResource && plotResource.ingredient1qty > 0;\n      \n      if (plotHasCost) {\n        setModalContent({\n          title: ' Warning',\n          message: `This will leave you with 0 ${resource}, so you will not be able to plant ${resource} again.`,\n          message2: 'Are you sure?',\n          size: 'small',\n          onClose: () => setIsModalOpen(false),\n          children: (\n            <div className=\"shared-buttons\" style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n              <button\n                className=\"btn-basic btn-neutral\"\n                onClick={() => setIsModalOpen(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn-basic btn-success\"\n                onClick={() => {\n                  setIsModalOpen(false);\n                  performAddToSlot(transactionId, transactionKey, resource, amount);\n                }}\n              >\n                Proceed\n              </button>\n            </div>\n          ),\n        });\n        setIsModalOpen(true);\n        return;\n      }\n    }\n    \n    await performAddToSlot(transactionId, transactionKey, resource, amount);\n  };\n\n  const performAddToSlot = async (transactionId, transactionKey, resource, amount) => {\n    const resourceDetails = resourceData.find((item) => item.type === resource);\n    const price = resourceDetails?.minprice || 0;\n    const slotConfig = getSlotConfig(selectedSlotIndex);\n\n    try {\n      // Update grid's outpost trade stall\n      const response = await axios.post(`${API_BASE}/api/outpost/add-item`, {\n        gridId,\n        slotIndex: selectedSlotIndex,\n        resource,\n        amount,\n        price,\n        sellTime: Date.now() + slotConfig.sellWaitTime,\n        sellerUsername: currentPlayer.username,\n        sellerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update backpack\n        const updatedBackpack = backpack.map(item =>\n          item.type === resource\n            ? { ...item, quantity: item.quantity - amount }\n            : item\n        ).filter(item => item.quantity > 0);\n        \n        setBackpack(updatedBackpack);\n        setCurrentPlayer(prev => ({\n          ...prev,\n          backpack: updatedBackpack\n        }));\n        \n        setSelectedSlotIndex(null);\n        updateStatus(`Added ${amount}x ${resource} to Outpost`);\n      }\n    } catch (error) {\n      console.error('Error adding item to Outpost:', error);\n      updateStatus('Failed to add item to Outpost');\n      throw error;\n    }\n  };\n\n  const handleBuyItem = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || !slot.resource || slot.boughtBy) return;\n\n    const totalCost = slot.amount * slot.price;\n    const currentMoney = currentPlayer.inventory?.find(item => item.type === 'Money')?.quantity || 0;\n    \n    if (totalCost > currentMoney) {\n      updateStatus(152); // Not enough money\n      return;\n    }\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/buy-item`, {\n        gridId,\n        slotIndex,\n        buyerId: currentPlayer.playerId,\n        buyerUsername: currentPlayer.username,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money and purchased item)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(`Bought ${slot.amount}x ${slot.resource} for ${totalCost}`);\n      }\n    } catch (error) {\n      console.error('Error buying from Outpost:', error);\n      updateStatus('Failed to buy item');\n      throw error;\n    }\n  };\n\n  const handleCollectPayment = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || slot.sellerId !== currentPlayer.playerId || !slot.boughtBy) return;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/collect-payment`, {\n        gridId,\n        slotIndex,\n        playerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(` Collected ${slot.boughtFor}.`);\n      }\n    } catch (error) {\n      console.error('Error collecting payment:', error);\n      updateStatus('Failed to collect payment');\n      throw error;\n    }\n  };\n\n  const handleSellStation = async (transactionId, transactionKey) => {\n    await handleProtectedSelling({\n      currentPlayer,\n      setInventory,\n      setBackpack,\n      setCurrentPlayer,\n      setResources,\n      stationType,\n      currentStationPosition,\n      gridId,\n      TILE_SIZE,\n      updateStatus,\n      onClose,\n      devOnly: true,\n    });\n  };\n\n  const handleSellToGame = async (transactionId, transactionKey, slotIndex) => {\n    const slot = tradeSlots[slotIndex];\n    if (!slot || !slot.resource || slot.sellerId !== currentPlayer.playerId) return;\n\n    try {\n      const response = await axios.post(`${API_BASE}/api/outpost/sell-to-game`, {\n        gridId,\n        slotIndex,\n        playerId: currentPlayer.playerId,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state\n        setTradeSlots(response.data.outpostTradeStall);\n        \n        // Update player's inventory (money)\n        if (response.data.inventory) {\n          setCurrentPlayer(prev => ({\n            ...prev,\n            inventory: response.data.inventory\n          }));\n        }\n        \n        updateStatus(` Sold ${response.data.amount}x ${response.data.resource} for ${response.data.sold}.`);\n      }\n    } catch (error) {\n      console.error('Error selling to game:', error);\n      updateStatus('Failed to sell item');\n      throw error;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"OutpostPanel\">\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n          {strings[98]} {/* Loading... */}\n        </div>\n      </Panel>\n    );\n  }\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1008\" titleKey=\"1108\" panelName=\"OutpostPanel\">\n      \n      {/* Outpost header */}\n      <div className=\"outpost-header\">\n        {strings?.[179] || 'Outpost'}\n      </div>\n\n      {/* Trade slots */}\n      <div className=\"trade-stall-slots shared-buttons\">\n        {tradeSlots.slice(0, OUTPOST_SLOTS).map((slot, index) => {\n          const isEmpty = !slot?.resource;\n          const isPurchased = slot?.boughtBy;\n          const isOwnItem = slot?.sellerId === currentPlayer.playerId;\n          const isReadyToSell = slot?.sellTime && slot.sellTime <= currentTime && isOwnItem;\n          const hasTimer = slot?.sellTime && slot.sellTime > currentTime;\n\n          return (\n            <div key={index} className=\"trade-slot-container\">\n              <div\n                className={`trade-slot btn-basic ${isEmpty ? 'btn-neutral' : ''} ${!isEmpty && !isPurchased && !isReadyToSell ? 'filled' : ''} ${isPurchased && isOwnItem ? 'btn-collect' : ''} ${isReadyToSell && isOwnItem ? 'btn-sell' : ''}`}\n                onClick={() => {\n                  if (isEmpty) {\n                    handleSlotClick(index);\n                  } else if (isPurchased && isOwnItem) {\n                    // Handle collect payment\n                    handleCollectPayment(`collect-${Date.now()}`, 'collect-payment', index);\n                  } else if (isReadyToSell && isOwnItem) {\n                    // Handle sell to game\n                    handleSellToGame(`sell-${Date.now()}`, 'sell-to-game', index);\n                  }\n                }}\n              >\n                {isEmpty ? (\n                  <div className=\"trade-slot-empty-text\">\n                    <div> {strings[156]}</div>\n                    <div style={{ fontSize: '0.8rem', marginTop: '4px' }}>\n                      {strings[173]} {getSlotConfig(index).maxAmount}\n                    </div>\n                    <div style={{ fontSize: '0.8rem' }}>\n                      {formatDuration(getSlotConfig(index).sellWaitTime / 1000)} {strings[174]}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"trade-slot-content\">\n                    <div className=\"trade-slot-item-name\">\n                      {`${slot.amount}x ${getSymbol(slot.resource)} ${getLocalizedString(slot.resource, strings)}`}\n                    </div>\n                    {slot.sellerUsername && (\n                      <div style={{ fontSize: '0.75rem', color: '#666' }}>\n                        {slot.sellerUsername}\n                      </div>\n                    )}\n                    {isPurchased && (\n                      <>\n                        <div className=\"trade-slot-status\">\n                          {strings[157]} {slot.boughtBy}\n                        </div>\n                        {isOwnItem && (\n                          <div className=\"trade-slot-status\">\n                            {strings[318]} {slot.boughtFor}\n                          </div>\n                        )}\n                      </>\n                    )}\n                    {hasTimer && !isPurchased && (\n                      <div className=\"trade-slot-status timer\">\n                        {formatCountdown(slot.sellTime, currentTime)}\n                      </div>\n                    )}\n                    {isReadyToSell && !isPurchased && (\n                      <div className=\"trade-slot-status ready\">\n                        {strings[167]} {slot.amount * slot.price}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n\n              {/* Action buttons - only show for buy actions and non-own items */}\n              {!isEmpty && !isOwnItem && !isPurchased && (\n                <div className=\"trade-button-container\">\n                  <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n                    <TransactionButton\n                      className=\"btn-basic btn-success\"\n                      style={{ width: '100%' }}\n                      onAction={(transactionId, transactionKey) => handleBuyItem(transactionId, transactionKey, index)}\n                      transactionKey={`outpost-buy-${index}`}\n                    >\n                      Buy {slot.amount * slot.price}\n                    </TransactionButton>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* TRADING INVENTORY MODAL */}\n      <TradingInventoryModal\n        isOpen={selectedSlotIndex !== null}\n        onClose={() => setSelectedSlotIndex(null)}\n        inventory={backpack || []}\n        resourceData={resourceData}\n        amounts={amounts}\n        handleAmountChange={handleAmountChange}\n        handleAddToSlot={handleAddToSlot}\n        getSlotConfig={getSlotConfig}\n        selectedSlotIndex={selectedSlotIndex}\n        transactionKeyPrefix=\"outpost-add\"\n      />\n      \n      {/* Sell for Refund button - only visible for developers */}\n      {isDeveloper && (\n        <>\n          <br />\n          <div className=\"shared-buttons\">\n            <TransactionButton \n              className=\"btn-basic btn-success\" \n              onAction={handleSellStation}\n              transactionKey={`sell-refund-${stationType}-${currentStationPosition?.x}-${currentStationPosition?.y}-${gridId}`}\n            >\n              {strings[425] || 'Sell for Refund'}\n            </TransactionButton>\n          </div>\n        </>\n      )}\n    </Panel>\n  );\n}\n\nexport default React.memo(Outpost);","import API_BASE from '../../config';\nimport axios from 'axios';\nimport React, { useState, useEffect, useContext } from 'react';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport Modal from '../../UI/Modals/Modal';\nimport TransactionButton from '../../UI/Buttons/TransactionButton';\nimport '../../UI/Buttons/SharedButtons.css';\nimport './Mailbox.css';\nimport { trackQuestProgress } from '../Quests/QuestGoalTracker';\nimport { refreshPlayerAfterInventoryUpdate } from '../../Utils/InventoryManagement';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { loadMasterResources } from '../../Utils/TuningManager';\nimport { updateBadge } from '../../Utils/appUtils';\nimport { useStrings } from '../../UI/StringsContext';\n\nfunction Mailbox({ \n  onClose, \n  inventory,\n  setInventory, \n  backpack, \n  setBackpack,\n  currentPlayer, \n  setCurrentPlayer, \n  resources,\n  updateStatus,\n  masterResources,\n}) {\n  const strings = useStrings();\n  const [templates, setTemplates] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [markedReadIds, setMarkedReadIds] = useState([]);\n  const gridId = currentPlayer?.location?.g;\n  const [visibleMessages, setVisibleMessages] = useState(currentPlayer?.messages || []);\n\n  useEffect(() => {\n    if (Array.isArray(currentPlayer?.messages)) {\n      setVisibleMessages(currentPlayer.messages);\n    }\n  }, [currentPlayer?.messages]);\n \n  useEffect(() => {\n  const fetchTemplatesAndMessages = async () => {\n    try {\n      const response = await fetch(`${API_BASE}/api/messages`);\n      const templates = await response.json();\n      setTemplates(templates);\n      updateBadge(currentPlayer, () => {}, 'mailbox', false); //  Clear badge\n      setLoading(false);\n      const res = await axios.get(`${API_BASE}/api/player/${currentPlayer.playerId}`);\n      const freshMessages = res.data.messages || [];\n      const unreadMessages = freshMessages.filter(msg => !msg.read);\n\n      if (unreadMessages.length > 0) {\n        const updatedMessages = freshMessages.map(msg =>\n          !msg.read ? { ...msg, read: true } : msg\n        );\n        // Save only to the DB  don't update local state yet\n        await axios.post(`${API_BASE}/api/update-player-messages`, {\n          playerId: currentPlayer.playerId,\n          messages: updatedMessages,\n        });\n        // Track which ones we updated\n        setMarkedReadIds(unreadMessages.map(msg => msg.messageId));\n      }\n      // Still show original messages (not visually marked as read yet)\n      setCurrentPlayer(prev => ({ ...prev, messages: freshMessages }));\n      setVisibleMessages(freshMessages);\n\n    } catch (err) {\n      console.error(\" Error fetching or updating mailbox data:\", err);\n    }\n  };\n  fetchTemplatesAndMessages();\n}, []);\n\n\n  // Protected function to collect mailbox rewards using transaction system\n  const handleCollect = async (transactionId, transactionKey, messageIndex) => {\n    console.log(` [PROTECTED MAILBOX] Starting protected collection for message ${messageIndex}`);\n    \n    try {\n      const response = await axios.post(`${API_BASE}/api/mailbox/collect-rewards`, {\n        playerId: currentPlayer.playerId,\n        messageIndex,\n        transactionId,\n        transactionKey\n      });\n\n      if (response.data.success) {\n        // Update local state with server response\n        const { messages, inventory, backpack, skills, powers, relocations, xp, collectedItems } = response.data;\n\n        // Update all player data from server response\n        setCurrentPlayer(prev => ({\n          ...prev,\n          messages: messages || prev.messages,\n          inventory: inventory || prev.inventory,\n          backpack: backpack || prev.backpack,\n          skills: skills || prev.skills,\n          powers: powers || prev.powers,\n          relocations: relocations !== undefined ? relocations : prev.relocations,\n          xp: xp !== undefined ? xp : prev.xp\n        }));\n\n        // Update local state\n        if (inventory) setInventory(inventory);\n        if (backpack) setBackpack(backpack);\n        setVisibleMessages(messages || []);\n\n        // Handle quest progress tracking for skills\n        if (skills && collectedItems) {\n          for (const item of collectedItems) {\n            const match = item.match(/(\\d+)\\s+(.+)/);\n            if (match) {\n              const [, qty, skillType] = match;\n              if (skills.some(s => s.type === skillType)) {\n                await trackQuestProgress(currentPlayer, 'Acquire', skillType, parseInt(qty), setCurrentPlayer);\n              }\n            }\n          }\n        }\n\n        // Refresh player data to ensure consistency\n        await refreshPlayerAfterInventoryUpdate(currentPlayer.playerId, setCurrentPlayer);\n\n        const template = templates.find(t => t.id === currentPlayer.messages[messageIndex]?.messageId);\n        updateStatus(`Collected rewards: ${collectedItems.join(', ')}`);\n      }\n    } catch (error) {\n      console.error('Error in protected mailbox collection:', error);\n      if (error.response?.status === 429) {\n        updateStatus(471);\n      } else {\n        updateStatus(' Failed to collect rewards');\n      }\n    }\n  };\n\n  const getSymbol = (type) => {\n    return resources.find(r => r.type === type)?.symbol || \"\";\n  };\n\n\nconst renderRewards = (rewards) => {\n  if (!rewards || rewards.length === 0) return null;\n  return (\n    <div className=\"reward-summary\">\n      {rewards.map((r, idx) => (\n        <span key={idx} className=\"reward-item\">\n          {getSymbol(r.item)} {r.qty} {r.item}\n        </span>\n      ))}\n    </div>\n  );\n};\n\n  // Prevent error if player or messages are not loaded\n  if (!currentPlayer || !Array.isArray(currentPlayer.messages)) {\n    return (\n      <Modal onClose={onClose} title={strings[1606]} message=\"No messages available.\" />\n    );\n  }\n\n  const deleteMessage = async (playerId, messageIndex) => {\n    try {\n      const updatedMessages = [...currentPlayer.messages];\n      updatedMessages.splice(messageIndex, 1); // Remove the one at this index only\n    \n      await axios.post(`${API_BASE}/api/update-player-messages`, {\n        playerId,\n        messages: updatedMessages,\n      });\n  \n      setCurrentPlayer((prev) => ({\n        ...prev,\n        messages: updatedMessages,\n      }));\n  \n      updateStatus(1607);\n    } catch (error) {\n      console.error(\" Error deleting message:\", error);\n      updateStatus(\" Failed to delete message.\");\n    }\n  };\n\n  const handleClose = () => {\n    console.log(\" Closing mailbox\");\n    setMarkedReadIds([]); // clear visual state\n    onClose();            // call parent-provided close\n  };\n\n\n  return (\n    <Modal onClose={handleClose} title={strings[1606]} className=\"mailbox-modal\">\n      {loading && visibleMessages.length === 0 ? (\n        <p>{strings[1601]}</p>\n      ) : visibleMessages.length === 0 ? (\n        <p>{strings[1602]}</p>\n      ) : (\n        [...visibleMessages].reverse().map((msg, index) => {\n          const template = templates.find((t) => t.id === msg.messageId);\n\n          if (!template) {\n            console.warn(` No template found for messageId: ${msg.messageId}`);\n            return null;\n          }\n\n          const rewards = (msg.rewards && msg.rewards.length > 0)\n            ? msg.rewards\n            : template.rewards;\n\n          return (\n            <div key={index} className=\"mailbox-message\">\n              {/* Left side: message content */}\n              <div className=\"message-left\">\n                <h3>\n                  {template.title}\n                  {(!msg.read || markedReadIds.includes(msg.messageId)) && (\n                    <span className=\"unread-tag\"></span>\n                  )}\n                </h3>\n                <p className=\"message-body\">{template.body}</p>\n                <p className=\"mailbox-timestamp\">\n                  {strings[1603]}: {new Date(msg.timestamp).toLocaleString()}\n                </p>\n              </div>\n\n              {/* Right side: reward line + buttons */}\n              <div className=\"message-actions\">\n                {rewards?.length > 0 && renderRewards(rewards)}\n\n                <div className=\"shared-buttons\" style={{ display: 'flex', gap: '8px' }}>\n                  {rewards?.length > 0 && (\n                    <TransactionButton\n                      className=\"btn-basic btn-success btn-modal-small\"\n                      transactionKey={`mailbox-collect-${msg.messageId}-${visibleMessages.length - 1 - index}`}\n                      onAction={(transactionId, transactionKey) => handleCollect(transactionId, transactionKey, visibleMessages.length - 1 - index)}\n                    >\n                      {strings[1604]} \n                    </TransactionButton>\n                  )}\n                  <button\n                    className=\"btn-basic btn-neutral btn-modal-small\"\n                    style={{ width: '40px', backgroundColor: 'var(--color-btn-active)' }}\n                    title=\"Delete\"\n                    onClick={() => {\n                      if (window.confirm(\"Are you sure you want to delete this message?\")) {\n                        deleteMessage(currentPlayer.playerId, index);\n                      }\n                    }}\n                  >\n                    \n                  </button>\n                </div>\n              </div>\n            </div>\n          );\n        })\n      )}                      \n      <p>{strings[1605]}</p>\n    </Modal>\n  );\n}\n\nexport default Mailbox;","// src/GameFeatures/Seasons/OffSeasonModal.js\nimport React, { useState, useEffect } from 'react';\nimport Modal from '../../UI/Modals/Modal';\nimport { useStrings } from '../../UI/StringsContext';\nimport { formatCountdown } from '../../UI/Timers';\nimport axios from 'axios';\nimport API_BASE from '../../config';\n\nfunction OffSeasonModal({ onClose, currentPlayer }) {\n  const strings = useStrings();\n  const [countdown, setCountdown] = useState(\"...\");\n  const [seasons, setSeasons] = useState([]);\n  const [seasonData, setSeasonData] = useState({ type: \"Unknown\", phase: \"Unknown\", endTime: null });\n  const [richestCitizens, setRichestCitizens] = useState([]);\n  const [secondsLeft, setSecondsLeft] = useState(null);\n\n  // Load timers from localStorage\n  useEffect(() => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    const data = storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n    setSeasonData(data);\n  }, []);\n\n  // Fetch tuning data (seasons.json)\n  useEffect(() => {\n    const fetchSeasons = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/tuning/seasons`);\n        setSeasons(response.data);\n      } catch (err) {\n        console.error(\" Failed to load season tuning:\", err);\n      }\n    };\n\n    fetchSeasons();\n  }, []);\n\n  // Update live countdown\n  useEffect(() => {\n    const update = () => {\n      const now = new Date();\n      const end = new Date(seasonData.endTime);\n      setCountdown(formatCountdown(end, now));\n    };\n\n    update();\n    const interval = setInterval(update, 1000);\n    return () => clearInterval(interval);\n  }, [seasonData]);\n\n    // Calculate raw seconds remaining (for refresh trigger)\n    useEffect(() => {\n      const interval = setInterval(() => {\n        const now = Date.now();\n        const end = new Date(seasonData.endTime).getTime();\n        const diff = Math.floor((end - now) / 1000);\n        setSecondsLeft(diff);\n      }, 1000);\n      return () => clearInterval(interval);\n    }, [seasonData]);\n\n  //  Force refresh when 20 seconds remain\n  useEffect(() => {\n    if (secondsLeft === 20) {\n      console.warn(\" Forcing refresh  countdown reached 10s\");\n      window.location.reload();\n    }\n  }, [secondsLeft]);\n\n\n  useEffect(() => {\n    const fetchSeasonWinners = async () => {\n      try {\n        if (!currentPlayer?.frontierId) return;\n\n        const response = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n        const seasonLog = response.data?.seasonlog || [];\n        const currentSeasonNumber = response.data?.seasons?.seasonNumber;\n\n        const lastSeason = seasonLog.find(entry => entry.seasonnumber === currentSeasonNumber);\n        const winners = lastSeason?.seasonwinners || [];\n\n        setRichestCitizens(winners.map((w, i) => ({\n          username: w.username,\n          netWorth: w.networth\n        })));\n      } catch (error) {\n        console.error(\" Error fetching season winners:\", error);\n      }\n    };\n\n    fetchSeasonWinners();\n  }, [currentPlayer]);\n\n\n\n\n  const currentIndex = seasons.findIndex(s => s.seasonType === seasonData.type);\n  const previousIndex = (currentIndex - 1 + seasons.length) % seasons.length;\n  \n  const previousSeason = currentIndex >= 0\n    ? seasons[previousIndex]\n    : { seasonType: \"Unknown\" };\n    \n  const title = ` ${previousSeason.seasonType}  ${seasonData.type}`;\n  const message = strings[\"5035\"];   // \"We are between seasons!\"\n  const message2 = strings[\"5036\"]; // \"Temporarily unavailable while we reset the season.\"\n\n  return (\n    <Modal\n      isOpen={true}\n      onClose={onClose}\n      title={title}\n      message={message}\n      message2={message2}\n      size=\"standard\"\n    >\n      <h2 className=\"countdown-timer\"><strong>{seasonData.type} begins in:</strong> {countdown}</h2>\n\n        <h3> Results from {previousSeason.seasonType}</h3>\n        {richestCitizens.length > 0 ? (\n        richestCitizens.map((c, i) => (\n            <p key={i}>{i + 1}. <strong>{c.username}</strong>  Net Worth: {c.netWorth}</p>\n        ))\n        ) : (\n        <p>No data available.</p>\n        )}\n        <br />\n\n\n      <ul style={{ paddingLeft: \"1.5rem\", marginBottom: \"1rem\" }}>\n        <p> Sending players home</p>\n        <p> Resetting towns and valleys</p>\n        <p> Nerfing money accounts</p>\n        <p> Sending out rewards</p>\n      </ul>\n\n\n      <br />\n    </Modal>\n  );\n}\n\nexport default OffSeasonModal;","import API_BASE from '../../config';\nimport React, { useEffect, useState, useContext } from 'react';\nimport axios from 'axios';\nimport Modal from './Modal';\nimport './TownNews.css';\nimport { StatusBarContext } from '../StatusBar/StatusBar';\nimport { useStrings } from '../StringsContext';\nimport { formatCountdown } from '../Timers';\nimport { getMayorUsername } from '../../GameFeatures/Government/GovUtils';\n\nfunction TownNews({ onClose, currentPlayer, setCurrentPlayer }) {\n    const strings = useStrings();\n    // Settlement data\n    const [settlementName, setSettlementName] = useState(\"\");\n    const [mayor, setMayor] = useState(\"\");\n    const [taxRate, setTaxRate] = useState(0);\n\n    // Timer states\n    const [electionPhase, setElectionPhase] = useState(\"\");\n    const [trainPhase, setTrainPhase] = useState(\"\");\n    const [bankPhase, setBankPhase] = useState(\"\");\n    \n    // Offer states\n    const [currentTrainOffers, setCurrentTrainOffers] = useState([]);\n    const [nextTrainOffers, setNextTrainOffers] = useState([]);\n    const [bankOffers, setBankOffers] = useState([]);\n    \n    // Countdown timers\n    const [trainTimer, setTrainTimer] = useState(\"\");\n    const [electionTimer, setElectionTimer] = useState(\"\");\n    const [bankTimer, setBankTimer] = useState(\"\");\n\n    // Simplify to just show unique items\n    const formatOffers = (offers) => {\n        if (!offers?.length) return \"no items\";\n        const uniqueItems = [...new Set(offers.map(offer => offer.itemBought))];\n        return uniqueItems.join(\", \");\n    };\n\n    const fetchTownData = async () => {\n        try { \n            // Fetch settlement data\n            const settlementResponse = await axios.get(\n                `${API_BASE}/api/get-settlement/${currentPlayer.settlementId}`);\n            const settlement = settlementResponse.data;\n            \n            console.log(\"Settlement data fetched:\", settlement);\n            setSettlementName(settlement.displayName);\n            setTaxRate(settlement.taxrate);\n\n            const mayorName = await getMayorUsername(currentPlayer.settlementId);\n            console.log(\" Mayor:\", mayorName);\n            setMayor(mayorName);\n\n            // Get current train offers\n            setCurrentTrainOffers(settlement.currentoffers);\n            setNextTrainOffers(settlement.nextoffers);\n\n            // Get Bank offers from frontier\n            const frontierResponse = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n            setBankOffers(frontierResponse.data.bank?.offers || []);\n\n            // Get phases and timers from localStorage\n            const storedTimers = JSON.parse(localStorage.getItem(\"timers\")) || {};\n            setBankPhase(storedTimers.bank?.phase || \"\");\n            setTrainPhase(storedTimers.train?.phase || \"\");\n            setElectionPhase(storedTimers.elections?.phase || \"\");\n\n            // Update timers\n            const now = Date.now();\n            setTrainTimer(formatCountdown(storedTimers.train?.endTime, now));\n            setElectionTimer(formatCountdown(storedTimers.elections?.endTime, now));\n            setBankTimer(formatCountdown(storedTimers.bank?.endTime, now));\n\n        } catch (error) {\n            console.error('Error fetching town data:', error);\n        }\n    };\n \n    // Initial fetch and timer updates\n    useEffect(() => {\n        fetchTownData();\n        const interval = setInterval(fetchTownData, 1000);\n        return () => clearInterval(interval);\n    }, [currentPlayer]);\n\n    return (\n        <Modal \n            onClose={onClose} \n            className=\"modal-TownNews\"\n            size=\"standard\"\n        >\n            <h3>{strings[\"1501\"]} \"{settlementName || \"...\"}\"</h3>\n            \n            {mayor ? (\n                /* The current mayor is */\n                <p>{strings[\"1502\"]} {mayor}{strings[\"1503\"]} {taxRate}%.</p>  \n            ) : (\n                /* No mayor */\n                <> <p>{strings[\"1512\"]} {strings[\"1515\"]} {taxRate}%.</p>  </>\n            )}\n            \n            <h4>{strings[\"1504\"]}</h4>\n\n            {/* Election Updates */}\n            {electionPhase === \"Campaigning\" && (\n                <p>{strings[\"1505\"]}</p>\n            )}\n            {electionPhase === \"Voting\" && (\n                <p>{strings[\"1506\"]} {strings[\"10121\"]} {electionTimer}</p>\n\n            )}\n            {electionPhase === \"Counting\" && (\n                <p>{strings[\"1518\"]} {electionTimer}.</p>\n            )}\n\n            {/* Modified Train Updates */}\n            {trainPhase === \"arriving\" && (\n                <p>{strings[\"1507\"]} {formatOffers(currentTrainOffers)}.</p>\n            )}\n            {trainPhase === \"departing\" && (\n                <p>{strings[\"1513\"]} {trainTimer}. {strings[\"1514\"]} {formatOffers(nextTrainOffers)}.</p>\n            )}\n            {trainPhase === \"loading\" && (\n                <>\n                    <p>{strings[\"1509\"]} {formatOffers(currentTrainOffers)}. {strings[\"1517\"]} {trainTimer}.</p>\n                </>\n            )}\n\n            {/* Bank Updates */}\n            {bankPhase === \"active\" && (\n                <p>{strings[\"1516\"]} {formatOffers(bankOffers)}. {strings[10124]}{bankTimer}</p>\n            )}\n            {bankPhase === \"refreshing\" && (\n                <p>{strings[\"1511\"]}</p>\n            )}\n        </Modal>\n    );\n}\n\nexport default TownNews;","import API_BASE from '../../config';\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Panel from '../../UI/Panels/Panel';\nimport { formatCountdown } from '../../UI/Timers';\nimport '../../UI/Modals/Modal.css';\nimport '../../UI/Buttons/SharedButtons.css';\nimport { calculateSettlementPopulation } from '../../Utils/PopulationUtils';\nimport { useStrings } from '../../UI/StringsContext';\nimport { usePanelContext } from '../../UI/Panels/PanelContext';\n\nfunction SeasonPanel({ onClose, currentPlayer, setModalContent, setIsModalOpen }) {\n  const strings = useStrings();\n  const { openPanel } = usePanelContext();\n  const [countdown, setCountdown] = useState(\"\");\n  const [topCitizens, setTopCitizens] = useState([]);\n  const [topSettlementName, setTopSettlementName] = useState(\"\");\n  const [seasonCycle, setSeasonCycle] = useState([]);\n  const [highestWealth, setHighestWealth] = useState(0);\n  const [settlementMap, setSettlementMap] = useState({});\n\n\n  //  Fetch season data from local storage\n  const getSeasonData = () => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    return storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n  };\n\n  const getNextSeason = (currentSeason) => {\n    if (!seasonCycle.length || !currentSeason) return \"Unknown\";\n    const currentIndex = seasonCycle.findIndex(s => s.seasonType === currentSeason);\n    const nextIndex = (currentIndex + 1) % seasonCycle.length;\n    return seasonCycle[nextIndex]?.seasonType || \"Unknown\";\n  };\n  \n  useEffect(() => {\n    const fetchSeasonCycle = async () => {\n      try {\n        const response = await axios.get(`${API_BASE}/api/tuning/seasons`);\n        setSeasonCycle(response.data);\n      } catch (error) {\n        console.error(\" Failed to fetch season cycle\", error);\n      }\n    };\n  \n    fetchSeasonCycle();\n  }, []);\n\n  //  Compute real-time countdown from local timer state\n  useEffect(() => {\n    const updateCountdown = () => {\n      const seasonData = getSeasonData();\n      const now = new Date();\n      const end = new Date(seasonData?.endTime);\n      setCountdown(formatCountdown(end, now));\n    };\n  \n    updateCountdown();\n    const interval = setInterval(updateCountdown, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n\n  //  Fetch top 3 wealthiest citizens across the frontier and leading settlement\n  useEffect(() => {\n    const fetchTopCitizensAndSettlement = async () => {\n      if (!currentPlayer || !currentPlayer.frontierId) {\n        console.warn(\" currentPlayer or frontierId is not available yet.\");\n        return;\n      }\n      try {\n        console.log(\" Fetching top citizens and leading settlement for frontier:\", currentPlayer.frontierId);\n        \n        // Fetch all players in this frontier with developer status\n        const response = await axios.get(`${API_BASE}/api/players-by-frontier-with-dev-status/${currentPlayer.frontierId}`);\n        const players = response.data;\n\n        const settlementRes = await axios.get(`${API_BASE}/api/settlements`);\n        const settlements = settlementRes.data;\n        const settlementMap = settlements.reduce((acc, s) => {\n          acc[s._id] = s.displayName || s.name || \"Unknown Settlement\";\n          return acc;\n        }, {});\n        setSettlementMap(settlementMap);\n\n        // Group players by settlementId and sum their net worths, excluding developers\n        const settlementWealthMap = {};\n        players.forEach(player => {\n          if (player.isDeveloper) return; // Skip developers\n          const settlementId = player.settlementId || \"unknown\";\n          const netWorth = player.netWorth || 0;\n          if (!settlementWealthMap[settlementId]) {\n            settlementWealthMap[settlementId] = { totalNetWorth: 0, settlementName: settlementMap[settlementId] || \"Unknown Settlement\" };\n          }\n          settlementWealthMap[settlementId].totalNetWorth += netWorth;\n        });\n\n        // Find the settlement with highest total net worth\n        let leadingSettlementId = null;\n        let highestWealth = -1;\n        for (const [settlementId, data] of Object.entries(settlementWealthMap)) {\n          if (data.totalNetWorth > highestWealth) {\n            highestWealth = data.totalNetWorth;\n            leadingSettlementId = settlementId;\n          }\n        }\n        const leadingSettlementName = leadingSettlementId && settlementWealthMap[leadingSettlementId] ? settlementWealthMap[leadingSettlementId].settlementName : \"No data available\";\n        // Add logic to retrieve population using derived calculation:\n        let leadingSettlementPopulation = \"Unknown\";\n        if (leadingSettlementId && settlements) {\n          const matching = settlements.find(s => s._id === leadingSettlementId);\n          if (matching) {\n            leadingSettlementPopulation = calculateSettlementPopulation(matching);\n          }\n        }\n        // store population into settlementMap with a compound key to retrieve later\n        if (leadingSettlementName) {\n          settlementMap[leadingSettlementName + \"_pop\"] = leadingSettlementPopulation;\n        }\n        setHighestWealth(highestWealth);\n\n        // Sort all players by net worth and take top 3, excluding developers\n        const topPlayers = players\n          .filter(player => !player.isDeveloper)\n          .map(player => ({\n            username: player.username,\n            netWorth: player.netWorth || 0\n          }))\n          .sort((a, b) => b.netWorth - a.netWorth)\n          .slice(0, 3);\n\n        setTopCitizens(topPlayers);\n        setTopSettlementName(leadingSettlementName);\n      } catch (error) {\n        console.error(\" Error fetching top citizens and settlement:\", error);\n      }\n    };\n\n    fetchTopCitizensAndSettlement(); \n  }, [currentPlayer]); // Runs when `currentPlayer` updates\n\n\n    //  Get current season data from local storage\n  const seasonData = getSeasonData();\n  const nextSeasonType = getNextSeason(seasonData?.type);\n\n\n  // Function to show season rules in modal\n  const handleShowSeasonRules = () => {\n    const rulesContent = (\n      <div style={{ textAlign: 'left', paddingLeft: '20px', paddingRight: '20px' }}>\n        {/* Header 1 - string 15002 */}\n        <p>{strings[15001]}</p>\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15002]}</h3>\n        <ol style={{ paddingLeft: '40px' }}>\n          <li>{strings[15003]}</li>\n          <li>{strings[15004]}</li>\n          <li>{strings[15005]}</li>\n          <li>{strings[15006]}</li>\n        </ol>\n        \n        {/* Header 2 - string 15007 */}\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15007]}</h3>\n        <ol start=\"7\" style={{ paddingLeft: '40px' }}>\n          <li>{strings[15008]}</li>\n          <li>{strings[15009]}</li>\n          <li>{strings[15010]}</li>\n          <li>{strings[15011]}</li>\n          <li>{strings[15012]}</li>\n          <li>{strings[15013]}</li>\n          <li>{strings[15014]}</li>\n          <li>{strings[15015]}</li>\n          <li>{strings[15016]}</li>\n          <li>{strings[15017]}</li>\n        </ol>\n        \n        {/* Header 3 - string 15018 */}\n        <h3 style={{ marginTop: '20px', marginBottom: '10px' }}>{strings[15018]}</h3>\n        <ol start=\"17\" style={{ paddingLeft: '40px' }}>\n          <li>{strings[15019]}</li>\n          <li>{strings[15020]}</li>\n          <li>{strings[15021]}</li>\n          <li>{strings[15022]}</li>\n        </ol>\n      </div>\n    );\n\n    setModalContent({\n      title: \"Season Rules\",\n      size: \"large\",\n      custom: rulesContent,\n    });\n    setIsModalOpen(true);\n  };\n\n  // New: Function to fetch and open season log\n  const handleShowSeasonLog = async () => {\n    if (!currentPlayer?.frontierId) { \n      console.warn(\" Cannot show season log: frontierId missing.\");\n      return;\n    }\n\n    console.log(\" Fetching season log for frontier:\", currentPlayer.frontierId);\n\n    try {\n      const response = await axios.get(`${API_BASE}/api/frontier/${currentPlayer.frontierId}/seasonlog`);\n      const seasonlog = response.data.seasonlog || [];\n\n      const seasonLogTable = (\n        <table className=\"season-log-table\" style={{ width: \"100%\", textAlign: \"left\", borderCollapse: \"collapse\" }}>\n          <thead>\n            <tr>\n              <th style={{ padding: \"6px 12px\" }}>Season</th>\n              <th style={{ padding: \"6px 12px\" }}>Date</th>\n              <th style={{ padding: \"6px 12px\" }}>Top Settlement</th>\n              <th style={{ padding: \"6px 12px\" }}>Top Players by Net Worth</th>\n              <th style={{ padding: \"6px 12px\" }}>Grids Reset</th>\n              <th style={{ padding: \"6px 12px\" }}>Players Relocated</th>\n            </tr>\n          </thead>\n          <tbody>\n            {[...seasonlog].reverse().map((entry, i) => (\n              <tr key={i}>\n                <td style={{ padding: \"6px 12px\" }}>#{entry.seasonnumber} {entry.seasontype}</td>\n                <td style={{ padding: \"6px 12px\" }}>{new Date(entry.date).toLocaleDateString()}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.winningsettlement}</td>\n                <td style={{ padding: \"6px 12px\", whiteSpace: \"pre-line\" }}>\n                  {entry.seasonwinners.map(w => `${w.username}: ${w.networth.toLocaleString()}`).join('\\n')}\n                </td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.gridsreset}</td>\n                <td style={{ padding: \"6px 12px\" }}>{entry.playersrelocated}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      );\n\n      setModalContent({\n        title: \"Season Log\",\n        size: \"large\",\n        message: seasonlog.length === 0 ? \"No season history found.\" : undefined,\n        custom: seasonLogTable,\n      });\n      setIsModalOpen(true);\n    } catch (error) {\n      console.error(\" Failed to fetch season log:\", error);\n      setModalContent({\n        title: \"Error\",\n        message: \"Failed to load season log.\",\n        size: \"small\",\n      });\n      setIsModalOpen(true);\n    }\n  };\n\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1015\" titleKey=\"1115\" panelName=\"SeasonPanel\">\n      {seasonData?.phase === \"onSeason\" ? (\n        <>\n          <h2>{strings[3053]} {seasonData?.type || strings[3054]}</h2>\n          <p>{strings[3055]}</p> \n          <h2 className=\"countdown-timer\">{countdown}</h2>\n        </>\n      ) : (\n        <>\n          <h2>{strings[3056]}</h2>\n        </>\n      )}\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\"\n          onClick={handleShowSeasonRules}\n        >\n          {strings[15000]}\n        </button>\n      </div>\n\n\n      <p>{strings[3057]}</p>\n      <h3>{strings[3058]}</h3>\n      <p>{strings[3051]}</p>\n      {topCitizens.length > 0 ? (\n        <div>\n          {topCitizens.map((citizen, index) => (\n            <p key={index}>\n              {index + 1}. <strong>{citizen.username}</strong> : {citizen.netWorth.toLocaleString()}\n            </p>\n          ))}\n        </div>\n      ) : (\n        <p>{strings[3052]}</p>\n      )}\n\n      <h3>{strings[3059]}</h3>\n      {topSettlementName ? (\n        <>\n          <p><strong>{topSettlementName}</strong></p>\n          <p>{strings[3060]} {highestWealth.toLocaleString()}</p>\n          <p>{strings[3061]} {settlementMap[topSettlementName + \"_pop\"]?.toLocaleString() || strings[3062]}</p>\n        </>\n      ) : (\n        <p>{strings[3063]}</p>\n      )}\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\"\n          onClick={() => openPanel && openPanel('LeaderboardPanel')}\n        >\n          {strings[1140]}\n        </button>\n      </div>\n\n<br></br>\n<br></br>\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic btn-success\"\n          onClick={handleShowSeasonLog}\n        >\n          {strings[3064]}\n        </button>\n      </div>\n    </Panel>\n  );\n}\n\nexport default SeasonPanel;","import React, { useState, useMemo } from 'react';\nimport { getLocalizedString } from '../../Utils/stringLookup';\nimport { useStrings } from '../../UI/StringsContext';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport './Eating.css';\n\nconst EatingModal = ({\n  isOpen,\n  onClose,\n  currentPlayer,\n  setCurrentPlayer,\n  masterResources,\n  updateStatus\n}) => {\n  const strings = useStrings();\n  const [eatAmounts, setEatAmounts] = useState({});\n  \n  // Filter edible resources (those with hp property defined)\n  const edibleResources = useMemo(() => {\n    const edible = masterResources.filter(resource => resource.hp && resource.hp > 0);\n    return edible;\n  }, [masterResources]);\n\n  // Get backpack items that are edible\n  const backpackFoods = useMemo(() => {\n    const backpack = currentPlayer.backpack || [];\n    \n    const foods = backpack\n      .filter(item => edibleResources.some(r => r.type === item.type))\n      .map(item => {\n        const resourceData = edibleResources.find(r => r.type === item.type);\n        return {\n          ...item,\n          hp: resourceData.hp,\n          symbol: resourceData.symbol\n        };\n      });\n    \n    return foods;\n  }, [currentPlayer.backpack, edibleResources]);\n\n  // Get warehouse items (inventory) that are edible (only if in homestead)\n  const warehouseFoods = useMemo(() => {\n    const isInSafeLocation = currentPlayer.location?.gtype === 'homestead';\n    \n    if (!isInSafeLocation) return [];\n\n    const inventory = currentPlayer.inventory || [];\n    \n    const foods = inventory\n      .filter(item => {\n        const hasMatch = edibleResources.some(r => r.type === item.type);\n        return hasMatch;\n      })\n      .map(item => {\n        const resourceData = edibleResources.find(r => r.type === item.type);\n        return {\n          ...item,\n          hp: resourceData.hp,\n          symbol: resourceData.symbol\n        };\n      });\n    \n    return foods;\n  }, [currentPlayer.inventory, currentPlayer.location?.gtype, edibleResources]);\n\n  // Handle amount change for eating\n  const handleAmountChange = (itemType, newAmount, maxQuantity) => {\n    // Get current and max HP from PlayersInGrid\n    const gridId = currentPlayer.location?.g;\n    const playerId = String(currentPlayer._id || currentPlayer.playerId);\n    const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n    const currentHp = playersInGrid?.[playerId]?.hp || 0;\n    const maxHp = playersInGrid?.[playerId]?.maxhp || 100;\n    \n    // Calculate how much HP we can still gain\n    const hpNeeded = maxHp - currentHp;\n    \n    if (hpNeeded <= 0) {\n      // Already at max HP, can't eat anything\n      setEatAmounts(prev => ({\n        ...prev,\n        [itemType]: 0\n      }));\n      return;\n    }\n    \n    // Find the resource data to get HP per item\n    const resourceData = edibleResources.find(r => r.type === itemType);\n    const hpPerItem = resourceData?.hp || 1;\n    \n    // Calculate max items we can eat based on HP needed\n    const maxItemsForHp = Math.floor(hpNeeded / hpPerItem);\n    \n    // The actual max is the minimum of: available quantity, HP-limited quantity, and requested amount\n    const effectiveMax = Math.min(maxQuantity, maxItemsForHp);\n    const clampedAmount = Math.max(0, Math.min(newAmount, effectiveMax));\n    \n    setEatAmounts(prev => ({\n      ...prev,\n      [itemType]: clampedAmount\n    }));\n  };\n\n  // Calculate HP to add based on quantity * resource.hp\n  const getHpToAdd = (itemType, hp) => {\n    const amount = eatAmounts[itemType] || 0;\n    return amount * hp;\n  };\n\n  // Handle eating an item\n  const handleEat = async (item, isFromWarehouse = false) => {\n    const amountToEat = eatAmounts[item.type] || 0;\n    if (amountToEat <= 0 || amountToEat > item.quantity) {\n      updateStatus(\"Invalid amount to eat.\");\n      return;\n    }\n\n    const hpToAdd = amountToEat * item.hp;\n    \n    try {\n      // Update player HP in PlayersInGrid\n      const gridId = currentPlayer.location?.g;\n      if (gridId) {\n        const playerId = currentPlayer._id || currentPlayer.playerId;\n        const currentHp = playersInGridManager.getPlayersInGrid(gridId)?.[playerId]?.hp || 0;\n        const maxHp = playersInGridManager.getPlayersInGrid(gridId)?.[playerId]?.maxhp || 100;\n        const newHp = Math.min(currentHp + hpToAdd, maxHp);\n        \n        playersInGridManager.updatePC(gridId, playerId, { hp: newHp });\n        \n        // Update current player state\n        setCurrentPlayer(prev => ({\n          ...prev,\n          hp: newHp\n        }));\n      }\n\n      // Remove eaten items from inventory\n      const inventoryType = isFromWarehouse ? 'inventory' : 'backpack';\n      setCurrentPlayer(prev => ({\n        ...prev,\n        [inventoryType]: prev[inventoryType].map(invItem => \n          invItem.type === item.type \n            ? { ...invItem, quantity: invItem.quantity - amountToEat }\n            : invItem\n        ).filter(invItem => invItem.quantity > 0)\n      }));\n\n      // Reset all eat amounts to clear the modal\n      setEatAmounts({});\n\n      updateStatus(` Ate ${amountToEat} ${item.type}(s) ${strings[1404]} +${hpToAdd}  ${strings[10157]}`);\n      \n    } catch (error) {\n      console.error(\"Error eating item:\", error);\n      updateStatus(\"Failed to eat item.\");\n    }\n  };\n\n  // Render a food section (backpack or warehouse)\n  const renderFoodSection = (foods, title, isWarehouse = false) => {\n    if (foods.length === 0) {\n      return (\n        <div className=\"eating-section\">\n          <h3>{title}</h3>\n          <p>No edible items available.</p>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"eating-section\">\n        <h3>{title}</h3>\n        <div className=\"eating-container\">\n          <div className=\"eating-header\">\n            <table>\n              <thead>\n                <tr>\n                  <th>{strings[191]}</th>\n                  <th>{strings[10156]}</th>\n                  <th>{strings[10157]}</th>\n                  <th>{strings[10158]}</th>\n                  <th>{strings[10159]}</th>\n                  <th>{strings[192]}</th>\n                </tr>\n              </thead>\n            </table>\n          </div>\n          \n          <div className=\"eating-scroll\">\n            <table>\n              <tbody>\n                {foods.map((item, index) => (\n                  <tr key={`${item.type}-${index}`}>\n                    <td>\n                      {item.symbol} {getLocalizedString(item.type, strings)}\n                    </td>\n                    <td>{item.quantity.toLocaleString()}</td>\n                    <td>{item.hp}</td>\n                    <td>\n                      <div className=\"amount-input\">\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, (eatAmounts[item.type] || 0) - 1, item.quantity)\n                          }\n                          disabled={(eatAmounts[item.type] || 0) <= 0}\n                        >\n                          -\n                        </button>\n                        <input\n                          type=\"number\"\n                          value={eatAmounts[item.type] || 0}\n                          onChange={(e) =>\n                            handleAmountChange(item.type, parseInt(e.target.value, 10) || 0, item.quantity)\n                          }\n                          min=\"0\"\n                          max={item.quantity}\n                        />\n                        <button\n                          onClick={() =>\n                            handleAmountChange(item.type, (eatAmounts[item.type] || 0) + 1, item.quantity)\n                          }\n                          disabled={(() => {\n                            // Check both quantity limit and HP limit\n                            const currentAmount = eatAmounts[item.type] || 0;\n                            if (currentAmount >= item.quantity) return true;\n                            \n                            const gridId = currentPlayer.location?.g;\n                            const playerId = String(currentPlayer._id || currentPlayer.playerId);\n                            const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n                            const currentHp = playersInGrid?.[playerId]?.hp || 0;\n                            const maxHp = playersInGrid?.[playerId]?.maxhp || 100;\n                            const hpNeeded = maxHp - currentHp;\n                            const maxItemsForHp = Math.floor(hpNeeded / item.hp);\n                            \n                            return currentAmount >= maxItemsForHp;\n                          })()}\n                        >\n                          +\n                        </button>\n                        <button\n                          onClick={() => {\n                            // Calculate HP-limited max for this item\n                            const gridId = currentPlayer.location?.g;\n                            const playerId = String(currentPlayer._id || currentPlayer.playerId);\n                            const playersInGrid = playersInGridManager.getPlayersInGrid(gridId);\n                            const currentHp = playersInGrid?.[playerId]?.hp || 0;\n                            const maxHp = playersInGrid?.[playerId]?.maxhp || 100;\n                            const hpNeeded = maxHp - currentHp;\n                            const maxItemsForHp = Math.floor(hpNeeded / item.hp);\n                            const effectiveMax = Math.min(item.quantity, maxItemsForHp);\n                            handleAmountChange(item.type, effectiveMax, item.quantity);\n                          }}\n                          style={{ marginLeft: '4px' }}\n                          title=\"Max\"\n                        >\n                          {strings[10160]}\n                        </button>\n                      </div>\n                    </td>\n                    <td>\n                      <strong>{getHpToAdd(item.type, item.hp)}</strong>\n                    </td>\n                    <td>\n                      <button\n                        className=\"eat-button\"\n                        onClick={() => handleEat(item, isWarehouse)}\n                        disabled={!(eatAmounts[item.type] > 0 && eatAmounts[item.type] <= item.quantity)}\n                      >\n                        {strings[78]}\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-container eating-modal-container\">\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        \n        <div className=\"modal-title\">{strings[10161]} ({currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.hp ?? \"?\" : \"?\"}/{currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.maxhp ?? \"?\" : \"?\"})</div>\n        \n        <div className=\"modal-content\">\n          {/* Backpack Food Section */}\n          {renderFoodSection(backpackFoods, `${strings[182]}`, false)}\n          \n          {/* Warehouse Food Section (only if in homestead) */}\n          {currentPlayer.location?.gtype === 'homestead' && (\n            renderFoodSection(warehouseFoods, `${strings[181]}`, true)\n          )}\n          \n          {backpackFoods.length === 0 && warehouseFoods.length === 0 && (\n            <div className=\"no-food-message\">\n              <p>{strings[10162]} {\n                currentPlayer.location?.gtype === 'homestead' \n                  ? 'backpack or warehouse' \n                  : 'backpack'\n              }.</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EatingModal;","import React, { useState } from 'react';\nimport ChangeIconModal from '../../UI/Modals/ChangeIconModal';\nimport EatingModal from '../Eating/Eating';\nimport { spendIngredients } from '../../Utils/InventoryManagement';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport { earnTrophy } from '../Trophies/TrophyUtils';\nimport API_BASE from '../../config.js';\nimport axios from 'axios';\nimport { useStrings } from '../../UI/StringsContext';\nimport { getDerivedLevel, getXpForNextLevel } from '../../Utils/playerManagement';\nimport HopeQuest from './HopeQuest';\n\nconst PlayerPanel = ({\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  updateStatus,\n  masterTrophies,\n  masterResources,\n  masterXPLevels,\n  masterTraders,\n  tentCount,\n  setTentCount,\n  boatCount,\n  isCamping,\n  setIsCamping,\n  isInBoat,\n  setIsInBoat,\n  displayedPCData,\n  setDisplayedPCData,\n  openPanel\n}) => {\n  const [showChangeIconModal, setShowChangeIconModal] = useState(false);\n  const [showEatingModal, setShowEatingModal] = useState(false);\n  const strings = useStrings();\n\n  // Handle Pitching a Tent\n  const handlePitchTent = async () => {\n    console.log(\" handlePitchTent called; tentCount = \", tentCount);\n    if (tentCount <= 0) return;\n\n    // Optimistically update UI immediately\n    setIsCamping(true);\n    setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n    setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n    \n    // Optimistically reduce tent count\n    setTentCount(prev => prev - 1);\n\n    try {\n      // First update the camping status\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { iscamping: true },\n      });\n\n      if (!response.data.success) {\n        // Revert all optimistic updates if server update failed\n        setIsCamping(false);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n        setTentCount(prev => prev + 1);\n        return;\n      }\n\n      // Then spend the tent\n      const fakeRecipe = { ingredient1: \"Tent\", ingredient1qty: 1 };\n      const success = await spendIngredients({\n        playerId: currentPlayer.playerId,\n        recipe: fakeRecipe,\n        inventory,\n        backpack,\n        setInventory,\n        setBackpack,\n        setCurrentPlayer,\n        updateStatus,\n      });\n\n      if (!success) {\n        // Revert camping status if we couldn't spend the tent\n        await axios.post(`${API_BASE}/api/update-profile`, {\n          playerId: currentPlayer.playerId,\n          updates: { iscamping: false },\n        });\n        setIsCamping(false);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n        setTentCount(prev => prev + 1);\n        return;\n      }\n\n      console.log(' iscamping: updated profile successfully');\n      updateStatus(28);\n      \n      // Award Adventurer trophy for first time camping\n      if (currentPlayer?.playerId) {\n        earnTrophy(currentPlayer.playerId, 'Adventurer', 1, currentPlayer, masterTrophies, setCurrentPlayer);\n      }\n      \n      // Update PlayersInGrid directly\n      const gridId = currentPlayer?.location?.g;\n      if (gridId) {\n        playersInGridManager.updatePC(gridId, currentPlayer.playerId, { iscamping: true });\n      }\n    } catch (error) {\n      console.error(\" Error pitching tent:\", error);\n      updateStatus(29);\n      // Revert all optimistic updates on error\n      setIsCamping(false);\n      setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n      setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n      setTentCount(prev => prev + 1);\n    }\n  };\n\n  // Handle Putting Away a Tent\n  const handlePutAwayTent = async () => {\n    // Optimistically update UI immediately\n    setIsCamping(false);\n    setDisplayedPCData(prev => ({ ...prev, iscamping: false }));\n    setCurrentPlayer(prev => ({ ...prev, iscamping: false }));\n    \n    // Optimistically increase tent count (getting tent back)\n    setTentCount(prev => prev + 1);\n\n    try {\n      // Update camping status in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { iscamping: false },\n      });\n\n      if (response.data.success) {\n        updateStatus(30);\n\n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { iscamping: false });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsCamping(true);\n        setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n        setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n        setTentCount(prev => prev - 1);\n      }\n    } catch (error) {\n      console.error(\" Error putting away tent:\", error);\n      updateStatus(29);\n      // Revert optimistic update on error\n      setIsCamping(true);\n      setDisplayedPCData(prev => ({ ...prev, iscamping: true }));\n      setCurrentPlayer(prev => ({ ...prev, iscamping: true }));\n      setTentCount(prev => prev - 1);\n    }\n  };\n\n  // Handle Getting in Boat\n  const handleGetInBoat = async () => {\n    if (boatCount <= 0) return;\n\n    // Optimistically update UI immediately\n    setIsInBoat(true);\n    setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n    setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n\n    try {\n      // Note: Unlike tent, we don't consume the boat item\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { isinboat: true },\n      });\n\n      if (response.data.success) {\n        updateStatus(\"You got in your boat.\"); // TODO: Add proper string ID\n        \n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { isinboat: true });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsInBoat(false);\n        setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n        setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n      }\n    } catch (error) {\n      console.error(\" Error getting in boat:\", error);\n      updateStatus(\"Failed to get in boat.\"); // TODO: Add proper string ID\n      // Revert optimistic update on error\n      setIsInBoat(false);\n      setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n      setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n    }\n  };\n\n  // Handle Getting out of Boat\n  const handleGetOutOfBoat = async () => {\n    // Optimistically update UI immediately\n    setIsInBoat(false);\n    setDisplayedPCData(prev => ({ ...prev, isinboat: false }));\n    setCurrentPlayer(prev => ({ ...prev, isinboat: false }));\n\n    try {\n      // Update boat status in the database\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { isinboat: false },\n      });\n\n      if (response.data.success) {\n        updateStatus(\"You got out of your boat.\"); // TODO: Add proper string ID\n        \n        // Update PlayersInGrid directly\n        const gridId = currentPlayer?.location?.g;\n        if (gridId) {\n          playersInGridManager.updatePC(gridId, currentPlayer.playerId, { isinboat: false });\n        }\n      } else {\n        // Revert optimistic update if server update failed\n        setIsInBoat(true);\n        setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n        setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n      }\n    } catch (error) {\n      console.error(\" Error getting out of boat:\", error);\n      updateStatus(\"Failed to get out of boat.\"); // TODO: Add proper string ID\n      // Revert optimistic update on error\n      setIsInBoat(true);\n      setDisplayedPCData(prev => ({ ...prev, isinboat: true }));\n      setCurrentPlayer(prev => ({ ...prev, isinboat: true }));\n    }\n  };\n\n\n\n  return (\n    <>\n     <h2>{strings[4051]} {currentPlayer.username} </h2>\n\n      {/* Change Avatar Button */}\n      <div className=\"shared-buttons\">\n        <button \n          className=\"btn-basic btn-success\" \n          onClick={() => setShowChangeIconModal(true)}\n        >\n          {currentPlayer.icon || ''} {strings[4065]}\n        </button>\n      </div>\n\n      {/* Tent functionality */}\n      {isCamping ? (\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handlePutAwayTent}>{strings[10155]}</button>\n        </div>\n      ) : (\n        <div className=\"shared-buttons\">\n          <button \n            className=\"btn-basic btn-success\" \n            disabled={isInBoat}\n            onClick={() => {\n              if (tentCount <= 0) {\n                console.warn(\" No tents found. Button press ignored.\");\n                updateStatus(27); // \"You don't have a tent.\"\n              } else {\n                handlePitchTent();\n              }\n            }}\n          >\n            {strings[10154]} ({tentCount})\n          </button>\n        </div>\n      )}\n\n      {/* Boat functionality */}\n      {isInBoat ? (\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-success\" onClick={handleGetOutOfBoat}>{strings[10153]}</button>\n        </div>\n      ) : (\n        <div className=\"shared-buttons\">\n          <button \n            className=\"btn-basic btn-success\" \n            disabled={isCamping}\n            onClick={() => {\n              if (boatCount <= 0) {\n                console.warn(\" No boats found. Button press ignored.\");\n                updateStatus(37); // TODO: Add proper string ID\n              } else {\n                handleGetInBoat();\n              }\n            }}\n          >\n            {strings[10152]}\n          </button>\n        </div>\n      )}\n\n      <br />\n\n      {/* Level Display */}\n      <h3>{strings[10150]} {getDerivedLevel(currentPlayer, masterXPLevels)}</h3>\n\n      {/* XP Display */}\n      <h3>{strings[10151]} {currentPlayer.xp || 0} / {getXpForNextLevel(currentPlayer, masterXPLevels)}</h3>\n      \n      {/* XP Progress Bar */}\n      <div style={{\n        width: '100%',\n        height: '8px',\n        backgroundColor: 'var(--color-button-hover)',\n        borderRadius: '2px',\n        overflow: 'hidden',\n        marginTop: '4px',\n        marginBottom: '8px'\n      }}>\n        <div style={{\n          height: '100%',\n          backgroundColor: 'var(--color-btn-primary)',\n          width: `${(() => {\n            const playerXP = currentPlayer?.xp || 0;\n            const currentLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n            const nextLevelXP = getXpForNextLevel(currentPlayer, masterXPLevels);\n            \n            // Get XP required for current level (previous level threshold)\n            const currentLevelIndex = currentLevel - 2; // Current level index (Level 1 = index -1, Level 2 = index 0)\n            const currentLevelXP = currentLevelIndex >= 0 && masterXPLevels?.[currentLevelIndex] || 0;\n            \n            // Calculate progress percentage within current level range\n            const xpIntoLevel = playerXP - currentLevelXP;\n            const xpRangeForLevel = nextLevelXP - currentLevelXP;\n            \n            if (xpRangeForLevel <= 0) return 100; // At max level or edge case\n            \n            return Math.min(100, Math.max(0, (xpIntoLevel / xpRangeForLevel) * 100));\n          })()}%`,\n          transition: 'width 0.3s ease'\n        }}>\n        </div>\n      </div>\n\n      {/* Hope Quest */}\n      <HopeQuest\n        inventory={inventory}\n        backpack={backpack}\n        masterResources={masterResources}\n        masterTraders={masterTraders}\n        showTitle={true}\n        size=\"normal\"\n      />\n\n\n<br />\n\n      {/* HP Display */}\n      <h3>{strings[10112]} {currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.hp ?? \"?\" : \"?\"} / {currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.maxhp ?? \"?\" : \"?\"}</h3>\n      \n      {/* HP Progress Bar */}\n      <div style={{\n        width: '100%',\n        height: '8px',\n        backgroundColor: 'var(--color-button-hover)',\n        borderRadius: '2px',\n        overflow: 'hidden',\n        marginTop: '4px',\n        marginBottom: '8px'\n      }}>\n        <div style={{\n          height: '100%',\n          backgroundColor: (() => {\n            const currentHp = currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.hp ?? 0 : 0;\n            const maxHp = currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.maxhp ?? 1 : 1;\n            const hpPercentage = (currentHp / maxHp) * 100;\n            \n            return hpPercentage <= 10 ? '#ff4444' : '#74ee66';\n          })(),\n          width: `${(() => {\n            const currentHp = currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.hp ?? 0 : 0;\n            const maxHp = currentPlayer?._id ? playersInGridManager.getPlayersInGrid(currentPlayer?.location?.g)?.[String(currentPlayer._id)]?.maxhp ?? 1 : 1;\n            \n            return Math.min(100, Math.max(0, (currentHp / maxHp) * 100));\n          })()}%`,\n          transition: 'width 0.3s ease, background-color 0.3s ease'\n        }}>\n        </div>\n      </div>\n\n      {/* Eat button */}\n      <div className=\"shared-buttons\">\n        <button \n          className=\"btn-basic btn-success\"\n          onClick={() => setShowEatingModal(true)}\n        >\n          {strings[78]}\n        </button>\n      </div>\n\n<br />\n\n      {/* Skills - Clickable H3 */}\n      <h3\n        onClick={() => openPanel('SkillsPanel')}\n        style={{ cursor: 'pointer', textDecoration: 'underline' }}\n      >\n        {strings[1105]} ({currentPlayer.skills?.length || 0})\n      </h3>\n\n      {/* Combat Stats - Clickable H3 */}\n      <h3\n        onClick={() => openPanel('CombatPanel')}\n        style={{ cursor: 'pointer', textDecoration: 'underline' }}\n      >\n        {strings[1124]}\n      </h3>\n<br />\n\n      {/* Settings - Clickable H3 */}\n      <h3\n        onClick={() => openPanel('ProfilePanel')}\n        style={{ cursor: 'pointer', textDecoration: 'underline' }}\n      >\n        {strings[1190]}\n      </h3>\n\n      {/* Change Icon Modal */}\n      {showChangeIconModal && (\n        <ChangeIconModal\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          currentIcon={currentPlayer.icon}\n          playerId={currentPlayer.playerId}\n          onClose={() => setShowChangeIconModal(false)}\n          onSave={(newIcon) => {\n            setDisplayedPCData(prev => ({ ...prev, icon: newIcon }));\n            setShowChangeIconModal(false);\n          }}\n        />\n      )}\n\n      {/* Eating Modal */}\n      <EatingModal\n        isOpen={showEatingModal}\n        onClose={() => setShowEatingModal(false)}\n        currentPlayer={currentPlayer}\n        setCurrentPlayer={setCurrentPlayer}\n        masterResources={masterResources}\n        updateStatus={updateStatus}\n      />\n    </>\n  );\n};\n\nexport default PlayerPanel;","import API_BASE from '../../config.js';\nimport React, { useState, useEffect } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport '../Relationships/Relationships.css';\nimport socket from '../../socketManager';\nimport PlayerPanel from './PlayerPanel';\nimport HopeQuest from './HopeQuest';\nimport { getDerivedLevel, getXpForNextLevel } from '../../Utils/playerManagement';\nimport { checkDeveloperStatus } from '../../Utils/appUtils';\nimport { useStrings } from '../../UI/StringsContext';\nimport '../Leaderboard/Leaderboard.css';\n\nconst SocialPanel = ({\n  onClose,\n  pcData,\n  currentPlayer,\n  setCurrentPlayer,\n  inventory,\n  setInventory,\n  backpack,\n  setBackpack,\n  updateStatus,\n  masterInteractions,\n  masterTrophies,\n  masterResources,\n  masterXPLevels,\n  masterTraders,\n  isDeveloper,\n  controllerUsername,\n  setControllerUsername,\n  openPanel,\n}) => {\n  const [tentCount, setTentCount] = useState(0);\n  const [boatCount, setBoatCount] = useState(0);\n  const [isCamping, setIsCamping] = useState(false);\n  const [isInBoat, setIsInBoat] = useState(false);\n  const [displayedPCData, setDisplayedPCData] = useState(pcData);\n  const [fullPlayerData, setFullPlayerData] = useState(null);\n  const [isLoadingPlayerData, setIsLoadingPlayerData] = useState(false);\n  const strings = useStrings();\n\n  console.log('made it to SocialPanel; pc = ', pcData);\n\n  // Fetch full player data for other players\n  useEffect(() => {\n    if (!pcData) return;\n\n    //  Update displayed data when viewing other players\n    // Use playerId for comparison (more reliable than username which can be reused)\n    if (pcData.playerId !== currentPlayer.playerId) {\n      const gridId = currentPlayer?.location?.g;\n      if (!gridId) return;\n\n      const NPCsInGrid = playersInGridManager.getPlayersInGrid(gridId);\n      const latestData = NPCsInGrid[pcData.playerId];\n      if (latestData) {\n          setIsCamping(latestData.iscamping || false);\n          setIsInBoat(latestData.isinboat || false);\n          setDisplayedPCData(prev => ({\n            ...prev,\n            iscamping: latestData.iscamping,\n            isinboat: latestData.isinboat,\n            hp: latestData.hp,\n            username: latestData.username,\n          }));\n      }\n\n      // Fetch full player data (xp, inventory, backpack) for display\n      const fetchFullPlayerData = async () => {\n        if (!pcData.playerId) return;\n\n        setIsLoadingPlayerData(true);\n        try {\n          console.log(` Fetching full data for ${pcData.username}`);\n          const response = await axios.get(`${API_BASE}/api/player/${pcData.playerId}`);\n          setFullPlayerData({\n            xp: response.data.xp || 0,\n            inventory: response.data.inventory || [],\n            backpack: response.data.backpack || []\n          });\n        } catch (error) {\n          console.error(` Error fetching full data for ${pcData.username}:`, error);\n          setFullPlayerData({\n            xp: 0,\n            inventory: [],\n            backpack: []\n          });\n        } finally {\n          setIsLoadingPlayerData(false);\n        }\n      };\n\n      fetchFullPlayerData();\n    } else {\n      // Reset when viewing yourself\n      setFullPlayerData(null);\n    }\n}, [pcData, currentPlayer]);\n\n\n  useEffect(() => {\n    if (!pcData) {\n      console.warn(\"SocialPanel was opened with missing pcData.\");\n      setDisplayedPCData({ username: \"Unknown\", hp: 0, iscamping: false });\n      return;\n    }\n\n    //  Check if the selected PC is the current player (use playerId, not username)\n    if (pcData.playerId === currentPlayer.playerId) {\n      // Update displayed data with current player's latest state\n      setDisplayedPCData({\n        ...pcData,\n        iscamping: currentPlayer.iscamping || false,\n        isinboat: currentPlayer.isinboat || false,\n        hp: currentPlayer.hp || pcData.hp\n      });\n      \n      setIsCamping(currentPlayer.iscamping || false);\n      setIsInBoat(currentPlayer.isinboat || false);\n\n      //  Get tent count from Backpack\n      const tentsInBackpack = currentPlayer.backpack?.find(item => item.type === \"Tent\")?.quantity || 0;\n      setTentCount(tentsInBackpack);\n\n      //  Get boat count from Backpack\n      const boatsInBackpack = currentPlayer.backpack?.find(item => item.type === \"Boat\")?.quantity || 0;\n      setBoatCount(boatsInBackpack);\n    } else {\n      setDisplayedPCData(pcData);\n    }\n  }, [pcData, currentPlayer, currentPlayer.iscamping, currentPlayer.isinboat]);\n\n\n  //  Handle Remove from GridState (Debug)\n  const handleRemoveFromGridState = async () => {\n    // Verify developer status before executing\n    const isStillDeveloper = await checkDeveloperStatus(currentPlayer?.username);\n    if (!isStillDeveloper) {\n      updateStatus(' Developer access required.');\n      return;\n    }\n\n    if (!pcData || !pcData.playerId) {\n      console.error(\" Cannot remove: No player data\");\n      updateStatus(\"Failed to remove player from grid state\");\n      return;\n    }\n\n    const gridId = currentPlayer?.location?.g;\n    if (!gridId) {\n      console.error(\" Cannot remove: No grid ID found\");\n      updateStatus(\"Failed to remove player from grid state\");\n      return;\n    }\n\n    const playerId = pcData.playerId;\n    \n    console.log(` Removing player ${pcData.username} (${playerId}) from grid ${gridId}`);\n    \n    try {\n      // Step 1: Remove from database first\n      console.log(' Calling /remove-single-pc to remove player from database...');\n      const response = await axios.post(`${API_BASE}/api/remove-single-pc`, {\n        gridId: gridId,\n        playerId: playerId,\n      });\n      \n      if (!response.data.success) {\n        throw new Error('Failed to remove player from database');\n      }\n      \n      console.log(` Successfully removed player ${pcData.username} from database`);\n      \n      // Step 2: Remove from local state\n      playersInGridManager.removePC(gridId, playerId);\n      console.log(` Successfully removed player ${pcData.username} from local grid state`);\n      \n      // Step 3: Force NPCController transfer if the removed player was the controller\n      // Check if the removed player was the controller\n      if (controllerUsername === pcData.username) {\n        console.log(` Removed player ${pcData.username} was the NPCController, clearing controller`);\n        // Clear the controller username locally first\n        if (setControllerUsername) {\n          setControllerUsername(null);\n        }\n      }\n      \n      if (socket) {\n        console.log(` Forcing NPCController reassignment after removing ${pcData.username}`);\n        // Tell the server to remove this player and reassign controller\n        // Using existing socket events that the server already handles\n        socket.emit('leave-grid', { \n          gridId: gridId,\n          playerId: playerId,\n          username: pcData.username\n        });\n        \n        // Request fresh player list from server to ensure state consistency\n        setTimeout(() => {\n          console.log(' Requesting current players from server after removal');\n          socket.emit('request-current-grid-players', { gridId });\n        }, 50);\n        \n        // If they were the controller, request to become the new controller\n        if (controllerUsername === pcData.username) {\n          setTimeout(() => {\n            socket.emit('request-npc-controller', { gridId: gridId });\n          }, 100);\n        }\n      }\n      \n      updateStatus(`Removed ${pcData.username} from grid${controllerUsername === pcData.username ? ' and cleared NPC control' : ''}`);\n      \n      // Close the panel since the player is no longer in the grid\n      if (pcData.playerId !== currentPlayer.playerId) {\n        onClose();\n      }\n    } catch (error) {\n      console.error(\" Error removing player from grid state:\", error);\n      updateStatus(\"Failed to remove player from grid state\");\n    }\n  };\n\n  //  Handle Send Home (Debug) - Relocates player to their homestead\n  const handleSendHome = async () => {\n    // Verify developer status before executing\n    const isStillDeveloper = await checkDeveloperStatus(currentPlayer?.username);\n    if (!isStillDeveloper) {\n      updateStatus(' Developer access required.');\n      return;\n    }\n\n    if (!pcData || !pcData.playerId) {\n      console.error(\" Cannot send home: No player data\");\n      updateStatus(\"Failed to send player home\");\n      return;\n    }\n\n    const playerId = pcData.playerId;\n    const gridId = currentPlayer?.location?.g;\n\n    console.log(` Sending player ${pcData.username} (${playerId}) home`);\n\n    try {\n      // Pass fromGridId so server can broadcast player-left-sync to the right room\n      const response = await axios.post(`${API_BASE}/api/send-player-home`, {\n        playerId: playerId,\n        fromGridId: gridId,\n      });\n\n      if (!response.data.success) {\n        throw new Error('Failed to send player home');\n      }\n\n      console.log(` Successfully sent player ${pcData.username} home`);\n\n      // Remove from local grid state since they're no longer in this grid\n      // (Server broadcasts player-left-sync which will also trigger removal on other clients)\n      if (gridId) {\n        playersInGridManager.removePC(gridId, playerId);\n        console.log(` Removed ${pcData.username} from local grid state`);\n      }\n\n      // Handle NPCController transfer if needed\n      if (controllerUsername === pcData.username) {\n        console.log(` Sent player ${pcData.username} was the NPCController, clearing controller`);\n        if (setControllerUsername) {\n          setControllerUsername(null);\n        }\n        // Request controller reassignment\n        if (socket) {\n          setTimeout(() => {\n            socket.emit('request-npc-controller', { gridId: gridId });\n          }, 100);\n        }\n      }\n\n      updateStatus(`Sent ${pcData.username} home`);\n\n      // Close the panel since the player is no longer in this grid\n      if (pcData.playerId !== currentPlayer.playerId) {\n        onClose();\n      }\n    } catch (error) {\n      console.error(\" Error sending player home:\", error);\n      updateStatus(\"Failed to send player home\");\n    }\n  };\n\n\nreturn (\n    <Panel onClose={onClose} descriptionKey=\"1014\" titleKey=\"1114\" panelName=\"SocialPanel\">\n\n        {/* Show loading state for other players */}\n        {displayedPCData.playerId !== currentPlayer.playerId && isLoadingPlayerData && (\n          <p>Loading player data...</p>\n        )}\n\n        {/* Show stats for other players */}\n        {displayedPCData.playerId !== currentPlayer.playerId && fullPlayerData && !isLoadingPlayerData && (\n          <div className=\"player-card\" style={{ marginBottom: '20px' }}>\n            {/* Player Name Header */}\n            <div className=\"player-header\">\n              <div className=\"player-info\">\n                {displayedPCData.iscamping ? ' ' :\n                 displayedPCData.isinboat ? ' ' :\n                 (displayedPCData.icon || '') + ' '\n                }\n                <strong>{displayedPCData.username}</strong>\n              </div>\n            </div>\n\n            {/* Level Display */}\n            <div className=\"player-stats\">\n              {strings[10150]} {getDerivedLevel(fullPlayerData, masterXPLevels)}\n            </div>\n\n            {/* XP Display */}\n            <div className=\"player-stats\">\n              {strings[10151]} {fullPlayerData.xp} / {getXpForNextLevel(fullPlayerData, masterXPLevels)}\n            </div>\n\n            {/* XP Progress Bar */}\n            {(() => {\n              const playerLevel = getDerivedLevel(fullPlayerData, masterXPLevels);\n              const xpForNextLevel = getXpForNextLevel(fullPlayerData, masterXPLevels);\n              // masterXPLevels is an array of XP thresholds: [40, 100, 180, ...]\n              const currentLevelIndex = playerLevel - 2; // Level 1 = no threshold, Level 2 = index 0\n              const currentLevelXP = currentLevelIndex >= 0 ? (masterXPLevels?.[currentLevelIndex] || 0) : 0;\n              const xpIntoLevel = fullPlayerData.xp - currentLevelXP;\n              const xpRangeForLevel = xpForNextLevel - currentLevelXP;\n              const xpProgress = xpRangeForLevel <= 0 ? 100 : Math.min(100, Math.max(0, (xpIntoLevel / xpRangeForLevel) * 100));\n\n              return (\n                <div className=\"xp-bar-container\">\n                  <div className=\"xp-bar-fill\" style={{\n                    width: `${xpProgress}%`\n                  }}>\n                  </div>\n                </div>\n              );\n            })()}\n\n            {/* Hope Quest Progress */}\n            <HopeQuest\n              inventory={fullPlayerData.inventory}\n              backpack={fullPlayerData.backpack}\n              masterResources={masterResources}\n              masterTraders={masterTraders}\n              showTitle={false}\n              size=\"medium\"\n            />\n          </div>\n        )}\n\n        {/* Debug buttons for developers */}\n        {isDeveloper && displayedPCData.playerId !== currentPlayer.playerId && (\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic btn-danger\"\n              onClick={handleRemoveFromGridState}\n            >\n               Remove from GridState (dev only)\n            </button>\n            <br />\n            <br />\n            <button\n              className=\"btn-basic btn-danger\"\n              onClick={handleSendHome}\n            >\n               Send Home (dev only)\n            </button>\n          </div>\n        )}\n\n        {/* Show PlayerPanel for current player */}\n        {displayedPCData.playerId === currentPlayer.playerId && (\n          <PlayerPanel\n            currentPlayer={currentPlayer}\n            setCurrentPlayer={setCurrentPlayer}\n            inventory={inventory}\n            setInventory={setInventory}\n            backpack={backpack}\n            setBackpack={setBackpack}\n            updateStatus={updateStatus}\n            masterTrophies={masterTrophies}\n            masterResources={masterResources}\n            masterXPLevels={masterXPLevels}\n            masterTraders={masterTraders}\n            tentCount={tentCount}\n            setTentCount={setTentCount}\n            boatCount={boatCount}\n            isCamping={isCamping}\n            setIsCamping={setIsCamping}\n            isInBoat={isInBoat}\n            setIsInBoat={setIsInBoat}\n            displayedPCData={displayedPCData}\n            setDisplayedPCData={setDisplayedPCData}\n            openPanel={openPanel}\n          />\n        )}\n\n    </Panel>\n  );\n};\n\nexport default React.memo(SocialPanel);","import './CombatPanel.css';\nimport API_BASE from '../../config';\nimport React, { useState, useEffect, useContext } from 'react';\nimport Panel from '../../UI/Panels/Panel';\nimport axios from 'axios';\nimport { StatusBarContext } from '../../UI/StatusBar/StatusBar';\nimport playersInGridManager from '../../GridState/PlayersInGrid';\nimport '../../UI/Buttons/ResourceButton.css'; //  Ensure the correct path\nimport '../../UI/Buttons/SharedButtons.css';\nimport { useStrings } from '../../UI/StringsContext';\n\nconst CombatPanel = ({ onClose, currentPlayer, setCurrentPlayer, masterResources, masterSkills, TILE_SIZE }) => {\n  const strings = useStrings();\n  const [allResources, setAllResources] = useState([]);\n  const [isContentLoading, setIsContentLoading] = useState(false);\n  const { updateStatus } = useContext(StatusBarContext);\n  const [fetchTrigger, setFetchTrigger] = useState(0);\n  const [playerStats, setPlayerStats] = useState({});\n  \n  // Equipment state\n  const getEquippedWeapon = () => currentPlayer.settings?.equippedWeapon || null;\n  const getEquippedArmor = () => currentPlayer.settings?.equippedArmor || null;\n  \n  // Helper functions to categorize powers\n  const isWeapon = (resource) => resource.passable === true && typeof resource.damage === 'number' && resource.damage > 0;\n  const isArmor = (resource) => resource.passable === true && typeof resource.armorclass === 'number' && resource.armorclass > 0;\n  const isMagicEnhancement = (resource) => !isWeapon(resource) && !isArmor(resource);\n  \n  // Check if player is in a valid location for equipment changes\n  const canChangeEquipment = () => {\n//    const gridType = currentPlayer.location.gtype;\n//    return gridType === 'homestead' || gridType === 'town';\n    return true; // CHANGED: Allow equipment changes anywhere\n  };\n\n  // Equipment change handlers\n  const handleEquipWeapon = async (weaponType) => {\n    if (!canChangeEquipment()) {\n      updateStatus(strings[520] || 'Cannot change equipment in this location');\n      return;\n    }\n\n    try {\n      const updatedSettings = {\n        ...currentPlayer.settings,\n        equippedWeapon: weaponType\n      };\n      \n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { settings: updatedSettings }\n      });\n      \n      // Update player state first\n      const updatedPlayer = {\n        ...currentPlayer,\n        settings: updatedSettings\n      };\n      setCurrentPlayer(updatedPlayer);\n      \n      // Wait a moment for state to settle, then refresh with updated player data\n      setTimeout(() => {\n        refreshCombatStatsWithPlayer(updatedPlayer);\n        // Also force immediate update of displayed stats\n        const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n        if (stats) {\n          setPlayerStats(stats);\n        }\n      }, 100);\n      \n      updateStatus(weaponType ? `Equipped ${weaponType}` : 'Unequipped weapon');\n    } catch (error) {\n      console.error('Error equipping weapon:', error);\n      updateStatus('Failed to equip weapon');\n    }\n  };\n  \n  const handleEquipArmor = async (armorType) => {\n    if (!canChangeEquipment()) {\n      updateStatus(strings[520] || 'Cannot change equipment in this location');\n      return;\n    }\n\n    try {\n      const updatedSettings = {\n        ...currentPlayer.settings,\n        equippedArmor: armorType\n      };\n      \n      await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer.playerId,\n        updates: { settings: updatedSettings }\n      });\n      \n      // Update player state first\n      const updatedPlayer = {\n        ...currentPlayer,\n        settings: updatedSettings\n      };\n      setCurrentPlayer(updatedPlayer);\n      \n      // Wait a moment for state to settle, then refresh with updated player data\n      setTimeout(() => {\n        refreshCombatStatsWithPlayer(updatedPlayer);\n        // Also force immediate update of displayed stats\n        const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n        if (stats) {\n          setPlayerStats(stats);\n        }\n      }, 100);\n      \n      updateStatus(armorType ? `Equipped ${armorType}` : 'Unequipped armor');\n    } catch (error) {\n      console.error('Error equipping armor:', error);\n      updateStatus('Failed to equip armor');\n    }\n  };\n\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const stats = playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id];\n      if (stats) {\n        setPlayerStats(stats);\n      }\n    }, 500); // Poll every 500ms\n\n    return () => clearInterval(interval);\n  }, [currentPlayer._id, currentPlayer.location.g]);\n\n  // --- Stat helpers ---\n\n  const getPlayerStats = () => {\n    return playersInGridManager.getAllPCs(currentPlayer.location.g)?.[currentPlayer._id] || {};\n  };\n  const getStatBreakdown = (stat) => {\n    const total = playerStats?.[stat] || 0;\n    // Handle special case for maxhp -> baseMaxhp (capital M)\n    let basePropertyName;\n    if (stat === 'maxhp') {\n      basePropertyName = 'baseMaxhp';\n    } else if (stat === 'hp') {\n      basePropertyName = 'baseHp';\n    } else {\n      // For other stats: damage -> baseDamage, attackrange -> baseAttackrange, etc.\n      basePropertyName = `base${stat.charAt(0).toUpperCase() + stat.slice(1)}`;\n    }\n    const base = currentPlayer[basePropertyName] || 0;\n    const modifier = total - base;\n    return { base, modifier, total };\n  };\n\n  const hp = getStatBreakdown('hp');\n  const maxhp = getStatBreakdown('maxhp');\n  const damage = getStatBreakdown('damage');\n  const armorclass = getStatBreakdown('armorclass');\n  const attackbonus = getStatBreakdown('attackbonus');\n  const attackrange = getStatBreakdown('attackrange');\n  const speed = getStatBreakdown('speed');\n\n\n\n  // Refresh function that uses current player data (for button)\n  const handleRefreshCombatStats = () => {\n    refreshCombatStatsWithPlayer(currentPlayer);\n  };\n\n  // Core refresh function that accepts player data parameter (to avoid race conditions)\n  const refreshCombatStatsWithPlayer = (playerData) => {\n    const gridId = playerData.location.g;\n    const playerId = playerData._id;\n\n    const baseStats = {\n      hp: playerData.baseHp || 0,  // Add hp calculation\n      maxhp: playerData.baseMaxhp || 0,\n      damage: playerData.baseDamage || 0,\n      armorclass: playerData.baseArmorclass || 0,\n      attackbonus: playerData.baseAttackbonus || 0,\n      attackrange: playerData.baseAttackrange || 0,\n      speed: playerData.baseSpeed || 0,\n    };\n\n    const powers = playerData.powers || [];\n    const powerBonuses = {\n      hp: 0, maxhp: 0, damage: 0, armorclass: 0, attackbonus: 0, attackrange: 0, speed: 0,\n    };\n\n    const equippedWeapon = playerData.settings?.equippedWeapon || null;\n    const equippedArmor = playerData.settings?.equippedArmor || null;\n\n    powers.forEach(power => {\n      const res = masterResources.find(r => r.type === power.type);\n      if (res && res.category === 'power') {\n        const powerQty = power.quantity || 0;\n        \n        // Only count equipped weapons and armor, or all magic enhancements\n        const shouldCount = isMagicEnhancement(res) || \n                           (isWeapon(res) && power.type === equippedWeapon) ||\n                           (isArmor(res) && power.type === equippedArmor);\n        \n        if (shouldCount) {\n          // Check for multiple combat attributes on the power\n          Object.keys(powerBonuses).forEach(stat => {\n            if (typeof res[stat] === 'number') {\n              powerBonuses[stat] += powerQty * res[stat];\n            }\n          });\n        }\n      }\n    });\n\n    const finalStats = {};\n    Object.keys(baseStats).forEach(stat => {\n      finalStats[stat] = baseStats[stat] + (powerBonuses[stat] || 0);\n    });\n\n    // Special handling for HP - use current HP if available, otherwise use max HP\n    const currentPCStats = getPlayerStats();\n    if (currentPCStats?.hp !== undefined) {\n      finalStats.hp = currentPCStats.hp; // Keep current HP value\n    } else if (!finalStats.hp || finalStats.hp === 0) {\n      finalStats.hp = finalStats.maxhp; // Set HP to max if not already set\n    }\n\n    finalStats.playerId = playerId;\n    finalStats.username = playerData.username;\n    finalStats.position = playerData.position || {};\n    finalStats.icon = playerData.icon || \"\";\n    finalStats.iscamping = playerData.iscamping || false;\n    finalStats.isinboat = playerData.isinboat || false;\n    finalStats.lastUpdated = new Date().toISOString();\n\n    const pc = getPlayerStats();\n    const pcPosition = pc?.position;\n    finalStats.position = (pcPosition && typeof pcPosition.x === 'number' && typeof pcPosition.y === 'number')\n      ? pcPosition : { x: 0, y: 0 }; // Fallback\n      \n    playersInGridManager.updatePC(gridId, playerId, finalStats);\n  };\n\n  return (\n    <Panel onClose={onClose} titleKey=\"1124\" panelName=\"CombatPanel\">\n      <div className=\"standard-panel\">\n      {isContentLoading ? (\n          <p>Loading...</p>\n        ) : (\n          <>\n            <div className=\"combat-stats\">\n              <h3>{strings[10112]} <span className=\"stat-total\">{hp.total}</span></h3><br/>\n              <table className=\"stats-table\">\n                <tbody>\n                  <tr>\n                    <td>{strings[550]}: <span className=\"stat-total blue-text\">{maxhp.modifier !== 0 ? maxhp.total : maxhp.base}</span></td>\n                    <td className=\"stat-breakdown\">({maxhp.base} <span className=\"stat-total blue-text\">+ {maxhp.modifier}</span>)</td>\n                  </tr>\n                  <tr>\n                    <td>{strings[551]}: <span className=\"stat-total blue-text\">{armorclass.modifier !== 0 ? armorclass.total : armorclass.base}</span></td>\n                    <td className=\"stat-breakdown\">({armorclass.base} <span className=\"stat-total blue-text\">+ {armorclass.modifier}</span>)</td>\n                  </tr>\n                  <tr>\n                    <td>{strings[552]}: <span className=\"stat-total blue-text\">{attackbonus.modifier !== 0 ? attackbonus.total : attackbonus.base}</span></td>\n                    <td className=\"stat-breakdown\">({attackbonus.base} <span className=\"stat-total blue-text\">+ {attackbonus.modifier}</span>)</td>\n                  </tr>\n                  <tr>\n                    <td>{strings[553]}: <span className=\"stat-total blue-text\">{damage.modifier !== 0 ? damage.total : damage.base}</span></td>\n                    <td className=\"stat-breakdown\">({damage.base} <span className=\"stat-total blue-text\">+ {damage.modifier}</span>)</td>\n                  </tr>\n                  <tr>\n                    <td>{strings[555]}: <span className=\"stat-total blue-text\">{attackrange.modifier !== 0 ? attackrange.total : attackrange.base}</span></td>\n                    <td className=\"stat-breakdown\">({attackrange.base} <span className=\"stat-total blue-text\">+ {attackrange.modifier}</span>)</td>\n                  </tr>\n                  <tr>\n                    <td>{strings[554]}: <span className=\"stat-total blue-text\">{speed.modifier !== 0 ? speed.total : speed.base}</span></td>\n                    <td className=\"stat-breakdown\">({speed.base} <span className=\"stat-total blue-text\">+ {speed.modifier}</span>)</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div className=\"shared-buttons\">\n              <button className=\"btn-basic btn-success\" onClick={handleRefreshCombatStats}> Fix Combat Stats</button>\n            </div>\n            <br></br>\n\n            <div className=\"combat-equip\">\n              <h3>{strings[522]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isArmor(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isArmor(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    const isEquipped = power.type === getEquippedArmor();\n                    const stats = [];\n                    \n                    const combatAttributes = ['maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = (power.quantity || 0) * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    return (\n                      <div key={`armor-${index}`} className=\"equipment-item\">\n                        <input\n                          type=\"checkbox\"\n                          checked={isEquipped}\n                          onChange={() => handleEquipArmor(isEquipped ? null : power.type)}\n                          onMouseDown={(e) => {\n                            // Prevent focus from being taken away from game board\n                            setTimeout(() => e.target.blur(), 0);\n                          }}\n                          className=\"equipment-checkbox\"\n                          disabled={!canChangeEquipment()}\n                        />\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br/>\n                          {stats.map((stat, statIndex) => (\n                            <div key={statIndex} className=\"equipment-stat\">\n                              {stat}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[523]}</p>\n              )}\n              \n              <br></br>\n              <h3>{strings[524]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isWeapon(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isWeapon(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    const isEquipped = power.type === getEquippedWeapon();\n                    const stats = [];\n                    \n                    const combatAttributes = ['maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = (power.quantity || 0) * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    return (\n                      <div key={`weapon-${index}`} className=\"equipment-item\">\n                        <input\n                          type=\"checkbox\"\n                          checked={isEquipped}\n                          onChange={() => handleEquipWeapon(isEquipped ? null : power.type)}\n                          onMouseDown={(e) => {\n                            // Prevent focus from being taken away from game board\n                            setTimeout(() => e.target.blur(), 0);\n                          }}\n                          className=\"equipment-checkbox\"\n                          disabled={!canChangeEquipment()}\n                        />\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br/>\n                          {stats.map((stat, statIndex) => (\n                            <div key={statIndex} className=\"equipment-stat\">\n                              {stat}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[525]}</p>\n              )}\n            </div>\n\n            <div className=\"combat-powers\">\n              <h3>{strings[526]}</h3>\n              <br></br>\n              {currentPlayer.powers?.filter(power => {\n                const resource = masterResources.find(r => r.type === power.type);\n                return resource && isMagicEnhancement(resource);\n              }).length > 0 ? (\n                currentPlayer.powers\n                  .filter(power => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    return resource && isMagicEnhancement(resource);\n                  })\n                  .map((power, index) => {\n                    const resource = masterResources.find(r => r.type === power.type);\n                    if (!resource) return null;\n\n                    const powerQty = power.quantity || 0;\n                    const combatAttributes = ['maxhp', 'damage', 'armorclass', 'attackbonus', 'attackrange', 'speed'];\n                    \n                    // Collect all combat stats this power provides\n                    const stats = [];\n                    combatAttributes.forEach(attr => {\n                      if (typeof resource[attr] === 'number') {\n                        const value = powerQty * resource[attr];\n                        const label = strings[attr] || attr;\n                        stats.push(`${value > 0 ? '+' : ''}${value} ${label}`);\n                      }\n                    });\n                    \n                    \n                    return (\n                      <div key={`magic-${index}`} className=\"magic-enhancement-item\">\n                        <div className=\"equipment-content\">\n                          <strong>{resource.type}</strong><br />\n                          {stats.length > 0 ? (\n                            stats.map((stat, statIndex) => (\n                              <div key={statIndex} className=\"equipment-stat\">\n                                {stat}\n                              </div>\n                            ))\n                          ) : (\n                            <div className=\"no-combat-effects\">\n                              (No combat effects)\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    );\n                  })\n              ) : (\n                <p>{strings[527]}</p>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n      <br />\n    </Panel>\n  );\n};\n\nexport default React.memo(CombatPanel);","import React, { memo } from 'react';\nimport Panel from './Panel'; \nimport { handlePurchase } from '../../Store/Store';\nimport '../Buttons/SharedButtons.css';\nimport { useStrings } from '../StringsContext';\n\n\nconst GoldBenefitsPanel = memo(({ currentPlayer, updateStatus, onClose }) => {\n  \n  const strings = useStrings();\n  const isGold = currentPlayer.accountStatus === 'Gold';\n\n  return (\n    <Panel onClose={onClose} descriptionKey=\"1027\" titleKey=\"1127\" panelName=\"GoldBenefitsPanel\">\n      <div className=\"panel-content\">\n\n        <div className=\"shared-buttons\" style={{ display: 'flex', justifyContent: 'center', width: '100%' }}>\n          {isGold ? (\n            <p>{strings[9060]}</p>\n          ) : (\n            <button className=\"btn-basic btn-gold\" style={{ width: '100%' }} onClick={() => handlePurchase(1, currentPlayer, updateStatus)}>{strings[9061]}</button>\n          )} \n        </div>\n<br />\n        <h2>{strings[9050]}</h2>\n        <p>{strings[9051]}</p>\n        <p>{strings[9052]}</p>\n        <p>{strings[9053]}</p>\n        <p>{strings[9054]}</p>\n        <p>{strings[9055]}</p>\n        <p>{strings[9056]}</p>\n        <p>{strings[9057]}</p>\n        <p>{strings[9058]}</p>\n\n      </div>\n    </Panel>\n  );\n});\n\nexport default GoldBenefitsPanel;\n","export function shareToNetwork(network, url) {\n  let shareUrl = '';\n\n  switch (network) {\n    case 'facebook':\n      shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;\n      break;\n    case 'twitter':\n      shareUrl = `https://twitter.com/intent/tweet?text=Come+play+Valley+View!&url=${encodeURIComponent(url)}`;\n      break;\n    case 'reddit':\n      shareUrl = `https://www.reddit.com/submit?url=${encodeURIComponent(url)}&title=Check+out+Valley+View!`;\n      break;\n    default:\n      console.warn('Unsupported network:', network);\n      return;\n  }\n\n  window.open(shareUrl, '_blank', 'noopener,noreferrer');\n}\n\nexport function copyToClipboard(text) {\n  navigator.clipboard.writeText(text)\n    .then(() => alert(' Link copied to clipboard!'))\n    .catch(() => alert(' Failed to copy link.'));\n}","import React from 'react';\nimport { shareToNetwork, copyToClipboard } from '../../Utils/share';\nimport { useStrings } from '../StringsContext';\nimport './Modal.css';\nimport './ShareModal.css';\nimport '../Buttons/SharedButtons.css';\n\nfunction ShareModal({ onClose }) {\n\n  const strings = useStrings();\n  const url = window.location.href;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-container modal-medium\">\n        <button className=\"modal-close-btn\" onClick={onClose}></button>\n        <div className=\"modal-title\"> Share \"Secrets of Elsinore\"</div>\n        <p>{strings[95]}</p>\n        \n\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic facebook-btn btn-modal\" onClick={() => shareToNetwork('facebook', url)}>Facebook</button>\n          <button className=\"btn-basic twitter-btn btn-modal\" onClick={() => shareToNetwork('twitter', url)}>Twitter / X</button>\n          <button className=\"btn-basic reddit-btn btn-modal\" onClick={() => shareToNetwork('reddit', url)}>Reddit</button>\n        </div>\n\n        <div className=\"copy-link\">\n          <input type=\"text\" readOnly value={url} />\n          <div className=\"shared-buttons\">\n            <button className=\"btn-basic btn-modal-small\" onClick={() => copyToClipboard(url)}> Copy</button>\n          </div>\n        </div>\n\n        <div className=\"discord-section\">\n          <p>and</p>\n          <div className=\"shared-buttons\">\n            <button\n              className=\"btn-basic discord-btn btn-modal\"\n              onClick={() => window.open('https://discord.gg/mQgRP2K9', '_blank')}\n            >\n              Join our Discord\n            </button>\n          </div>\n        </div>\n\n<br />\n        <div className=\"shared-buttons\">\n          <button className=\"btn-basic btn-modal btn-success\" onClick={onClose}>{strings[796]}</button>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\nexport default ShareModal;","import React, { useState, useEffect } from 'react';\n\n// Individual animated emoji component\nconst AnimatedEmoji = ({ emoji, initialX, initialY }) => {\n  const [position, setPosition] = useState({ x: initialX, y: initialY });\n  const [targetPosition, setTargetPosition] = useState({ x: initialX, y: initialY });\n  const [duration, setDuration] = useState(0);\n  const speed = 100; // pixels per second\n\n  useEffect(() => {\n    const moveToNewPosition = () => {\n      // Pick a random direction (0: up, 1: right, 2: down, 3: left)\n      const direction = Math.floor(Math.random() * 4);\n\n      // Calculate distance to travel (random between 100-300 pixels)\n      const distance = 100 + Math.random() * 200;\n\n      // Calculate new position based on direction\n      let newX = position.x;\n      let newY = position.y;\n\n      // Boundaries: account for base panel (220px) on left\n      const minX = 240;\n      const maxX = 950;\n      const minY = 50;\n      const maxY = 550;\n\n      switch (direction) {\n        case 0: // up\n          newY = Math.max(minY, position.y - distance);\n          break;\n        case 1: // right\n          newX = Math.min(maxX, position.x + distance);\n          break;\n        case 2: // down\n          newY = Math.min(maxY, position.y + distance);\n          break;\n        case 3: // left\n          newX = Math.max(minX, position.x - distance);\n          break;\n        default:\n          break;\n      }\n\n      // Calculate animation duration based on actual distance and speed\n      const actualDistance = Math.sqrt(\n        Math.pow(newX - position.x, 2) + Math.pow(newY - position.y, 2)\n      );\n      const animationDuration = actualDistance / speed; // in seconds\n\n      setDuration(animationDuration);\n      setTargetPosition({ x: newX, y: newY });\n      setPosition({ x: newX, y: newY });\n    };\n\n    // Start movement every 1 second + animation duration\n    const timer = setTimeout(moveToNewPosition, 1000 + (duration * 1000));\n\n    return () => clearTimeout(timer);\n  }, [position, duration]);\n\n  return (\n    <div\n      className=\"start-screen-emoji\"\n      style={{\n        position: 'absolute',\n        left: `${targetPosition.x}px`,\n        top: `${targetPosition.y}px`,\n        fontSize: '30px',\n        transition: duration > 0 ? `all ${duration}s linear` : 'none',\n        zIndex: 10,\n        userSelect: 'none'\n      }}\n    >\n      {emoji}\n    </div>\n  );\n};\n\n// Configuration for animated emojis on the start screen\n// Bounds: minX=240 (after base panel), maxX=950, minY=50, maxY=550\nconst START_SCREEN_EMOJIS = [\n  { emoji: '', initialX: 300, initialY: 100 },\n  { emoji: '', initialX: 800, initialY: 400 },\n  { emoji: '', initialX: 550, initialY: 300 },\n];\n\nconst StartScreenAnimation = () => {\n  return (\n    <>\n      {START_SCREEN_EMOJIS.map((config, index) => (\n        <AnimatedEmoji\n          key={index}\n          emoji={config.emoji}\n          initialX={config.initialX}\n          initialY={config.initialY}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default StartScreenAnimation;\n","import React, { useState, useEffect } from 'react';\n\n// Shared transition overlay utility for location changes\nconst TransitionOverlay = ({ isTransitioning, onTransitionComplete }) => {\n  const [opacity, setOpacity] = useState(0);\n  const [isVisible, setIsVisible] = useState(false);\n  const [homesteadElement, setHomesteadElement] = useState(null);\n\n  // Find the homestead container on mount\n  useEffect(() => {\n    const element = document.querySelector('.homestead');\n    setHomesteadElement(element);\n  }, []);\n\n  useEffect(() => {\n    if (isTransitioning) {\n      // Start transition - fade to black\n      setIsVisible(true);\n      // Small delay to ensure DOM update, then start fade\n      requestAnimationFrame(() => {\n        setOpacity(1);\n      });\n    } else {\n      // End transition - fade back to transparent\n      setOpacity(0);\n      // Wait for fade animation to complete before hiding\n      const timer = setTimeout(() => {\n        setIsVisible(false);\n        if (onTransitionComplete) {\n          onTransitionComplete();\n        }\n      }, 400); // Match CSS transition duration\n      \n      return () => clearTimeout(timer);\n    }\n  }, [isTransitioning, onTransitionComplete]);\n\n  if (!isVisible || !homesteadElement) return null;\n\n  // Get the homestead container's position and dimensions\n  const rect = homesteadElement.getBoundingClientRect();\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: rect.top + window.scrollY,\n        left: rect.left + window.scrollX,\n        width: rect.width,\n        height: rect.height,\n        backgroundColor: '#000000',\n        opacity: opacity,\n        transition: 'opacity 0.4s ease-in-out',\n        zIndex: 1000, // High z-index to cover homestead content\n        pointerEvents: isTransitioning ? 'all' : 'none', // Block interaction during transition\n      }}\n    />\n  );\n};\n\nexport default TransitionOverlay;","import { useState, useCallback } from 'react';\n\n// Custom hook for managing location transition fade effects\nexport const useTransitionFade = () => {\n  const [isTransitioning, setIsTransitioning] = useState(false);\n\n  // Start the fade to black transition\n  const startTransition = useCallback(() => {\n    console.log(' [TRANSITION FADE] Starting fade to black...');\n    setIsTransitioning(true);\n  }, []);\n\n  // End the transition and fade back to normal\n  const endTransition = useCallback(() => {\n    console.log(' [TRANSITION FADE] Ending transition, fading back...');\n    setIsTransitioning(false);\n  }, []);\n\n  // Get current transition state\n  const getTransitionState = useCallback(() => {\n    return isTransitioning;\n  }, [isTransitioning]);\n\n  return {\n    isTransitioning,\n    startTransition,\n    endTransition,\n    getTransitionState\n  };\n};\n\nexport default useTransitionFade;","/**\n * Temporary redirect component to migrate users from old domain to new domain.\n * Delete this file once migration is complete.\n */\n\nconst NEW_DOMAIN = 'https://www.SECRETSofELSINORE.com';\n\nfunction Redirect() {\n  const handleGo = () => {\n    window.location.href = NEW_DOMAIN;\n  };\n\n  return (\n    <div style={{\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'rgba(0, 0, 0, 0.9)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 999999\n    }}>\n      <div style={{\n        backgroundColor: '#fff',\n        padding: '40px',\n        borderRadius: '12px',\n        textAlign: 'center',\n        maxWidth: '400px',\n        boxShadow: '0 4px 20px rgba(0, 0, 0, 0.3)'\n      }}>\n        <h2 style={{ marginTop: 0, color: '#333' }}>\n          This game has moved!\n        </h2>\n        <p style={{ fontSize: '16px', color: '#555', lineHeight: 1.5 }}>\n          Please visit the new site and log in there with your username and password:\n        </p>\n        <p style={{\n          fontFamily: \"'Lora', serif\",\n          fontSize: '18px',\n          fontWeight: 'bold',\n          color: '#2563eb',\n          margin: '20px 0'\n        }}>\n          {NEW_DOMAIN.replace('https://', '')}\n        </p>\n        <button\n          onClick={handleGo}\n          style={{\n            backgroundColor: '#4caf50',\n            color: '#fff',\n            border: 'none',\n            padding: '12px 40px',\n            fontSize: '18px',\n            fontWeight: 'bold',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            marginTop: '10px'\n          }}\n        >\n          Go\n        </button>\n      </div>\n    </div>\n  );\n}\n\n// Check if we should show the redirect (user is on old domain)\nexport function shouldRedirect() {\n  const hostname = window.location.hostname;\n  return hostname.includes('valleyviewgame.com');\n}\n\nexport default Redirect;\n","import './UI/Styles/theme.css';  /* Import theme variables first */\nimport './App.css';\nimport './GameFeatures/Chat/Chat.css';\nimport './VFX/VFX.css';\nimport './UI/Buttons/SharedButtons.css';\nimport './Render/Tooltip.css';\nimport axios from 'axios';\nimport API_BASE from './config.js';\nimport Chat from './GameFeatures/Chat/Chat';\nimport React, { useContext, useState, useEffect, useLayoutEffect, memo, useMemo, useCallback, useRef, act } from 'react';\nimport { registerNotificationClickHandler } from './UI/Notifications/Notifications';\nimport { initializeGrid } from './AppInit';\nimport { loadMasterSkills, loadMasterResources, loadMasterInteractions, loadGlobalTuning, loadMasterTraders, loadMasterTrophies, loadMasterWarehouse, loadMasterXPLevels } from './Utils/TuningManager';\nimport { RenderTilesCanvas } from './Render/RenderTilesCanvas';\nimport { RenderTilesCanvasV2 } from './Render/RenderTilesCanvasV2';\nimport { RenderResources } from './Render/RenderResources';\nimport { RenderNPCs } from './Render/RenderNPCs';\nimport { RenderPCs } from './Render/RenderPCs';\nimport { RenderDynamicElements, checkQuestNPCStatus, checkTradeNPCStatus, checkKentNPCStatus, generateResourceTooltip, generateNPCTooltip, generatePCTooltip } from './Render/RenderDynamicElements';\nimport CursorTileHighlight from './Render/CursorTileHighlight';\nimport { handleResourceClick } from './ResourceClicking';\nimport { isMobile } from './Utils/appUtils';\nimport { useUILock } from './UI/UILockContext';\nimport questCache from './Utils/QuestCache';\n\nimport socket from './socketManager';\nimport {\n  socketListenForPCJoinAndLeave,\n  socketListenForPCstateChanges,\n  socketListenForNPCStateChanges,\n  socketListenForResourceChanges,\n  socketListenForTileChanges,\n  socketListenForNPCControllerStatus,\n  socketListenForSeasonReset,\n  socketListenForPlayerConnectedAndDisconnected,\n  socketListenForConnectAndDisconnect,\n  socketListenForChatMessages,\n  socketListenForBadgeUpdates,\n  socketListenForStoreBadgeUpdates,\n} from './socketManager';\n\nimport farmState from './FarmState';\nimport GlobalGridStateTilesAndResources from './GridState/GlobalGridStateTilesAndResources';\nimport FTUE from './GameFeatures/FTUE/FTUE';\nimport FTUEDoinker from './GameFeatures/FTUE/FTUEDoinker';\nimport FTUEstepsData from './GameFeatures/FTUE/FTUEsteps.json';\n\nimport playersInGridManager from './GridState/PlayersInGrid';\nimport { usePlayersInGrid, useGridStatePCUpdate } from './GridState/GridStatePCContext';\nimport NPCsInGridManager from './GridState/GridStateNPCs.js';\nimport { useGridState, useGridStateUpdate } from './GridState/GridStateContext';\nimport npcController from './GridState/NPCController';\n\nimport SettlementView from './ZoomedOut/SettlementView';\nimport FrontierView from './ZoomedOut/FrontierView';\nimport FrontierMiniMap from './ZoomedOut/FrontierMiniMap';\n\nimport Modal from './UI/Modals/Modal';\nimport RevivalModal from './UI/Modals/RevivalModal';\nimport LevelUpModal from './UI/Modals/LevelUpModal';\nimport LanguagePickerModal from './UI/Modals/LanguagePickerModal';\nimport { useStrings } from './UI/StringsContext';\nimport LANGUAGE_OPTIONS from './UI/Languages.json';\nimport { getMayorUsername } from './GameFeatures/Government/GovUtils';\nimport { getDerivedLevel } from './Utils/playerManagement';\n\nimport ProfilePanel from './Authentication/ProfilePanel';\nimport LoginPanel from './Authentication/LoginPanel';\nimport DebugPanel from './Utils/debug';\nimport InventoryPanel from './GameFeatures/Inventory/InventoryPanel';\nimport WarehousePanel from './GameFeatures/Inventory/WarehousePanel';\nimport TrophyPanel from './GameFeatures/Trophies/TrophyPanel.js';\nimport HowToPanel from './UI/Panels/HowToPanel';\nimport HowToMoneyPanel from './UI/Panels/HowToMoneyPanel';\nimport HowToGemsPanel from './UI/Panels/HowToGemsPanel';\nimport QuestPanel from './GameFeatures/Quests/QuestPanel';\nimport NPCPanel from './GameFeatures/NPCs/NPCsPanel.js';\nimport BuildPanel from './GameFeatures/Build/BuildPanel';\nimport BuyPanel from './GameFeatures/Buy/BuyPanel';\nimport PetsPanel from './GameFeatures/Pets/PetsPanel';\nimport BuyDecoPanel from './GameFeatures/Deco/BuyDecoPanel';\nimport FarmingPanel from './GameFeatures/Farming/FarmingPanel';\nimport ToolsPanel from './GameFeatures/Farming/ToolsPanel';\nimport SkillsPanel from './GameFeatures/Skills/SkillsPanel';\nimport GovPanel from './GameFeatures/Government/GovPanel';\nimport LeaderboardPanel from './GameFeatures/Leaderboard/Leaderboard';\nimport BankPanel from './GameFeatures/Trading/Bank';\nimport KentPanel from './GameFeatures/Trading/Kent';\nimport NewTrainPanel from './GameFeatures/Trading/NewTrain';\nimport CarnivalPanel from './GameFeatures/Carnival/Carnival';\nimport CourthousePanel from './GameFeatures/Government/Courthouse';\n\nimport CraftingStation from './GameFeatures/Crafting/CraftingStation';\nimport FarmHouse from './GameFeatures/Crafting/FarmHouse';\nimport FarmHandPanel from './GameFeatures/FarmHands/FarmHand.js';\nimport ShopStation from './GameFeatures/Crafting/ShopStation';\nimport ScrollStation from './GameFeatures/Crafting/ScrollStation';\nimport PetPanel from './GameFeatures/Pets/PetPanel';\nimport AnimalStall from './GameFeatures/FarmAnimals/AnimalStall';\nimport AnimalPanel from './GameFeatures/FarmAnimals/FarmAnimals.js';\nimport CropPanel from './GameFeatures/Farming/CropPanel.js';\nimport DecoPanel from './GameFeatures/Deco/DecoPanel';\nimport TradeStall from './GameFeatures/Trading/TradeStall';\nimport Outpost from './GameFeatures/Trading/Outpost';\nimport Mailbox from './GameFeatures/Mailbox/Mailbox';\nimport Store from './Store/Store';\nimport OffSeasonModal from './GameFeatures/Seasons/OffSeasonModal.js';\nimport TownNews from './UI/Modals/TownNews.js';\nimport SeasonPanel from './GameFeatures/Seasons/SeasonPanel';\nimport SocialPanel from './GameFeatures/Social/SocialPanel';\nimport CombatPanel from './GameFeatures/Combat/CombatPanel';\nimport GoldBenefitsPanel from './UI/Panels/GoldBenefitsPanel';\nimport ShareModal from './UI/Modals/ShareModal';\n\nimport { usePanelContext } from './UI/Panels/PanelContext';\nimport { useModalContext } from './UI/ModalContext';\nimport { checkDeveloperStatus, updateBadge, getBadgeState } from './Utils/appUtils';\nimport { useBulkOperation } from './UI/BulkOperationContext';\nimport FloatingTextManager from './UI/FloatingText';\nimport StatusBar from './UI/StatusBar/StatusBar';\nimport { StatusBarContext } from './UI/StatusBar/StatusBar';\nimport { formatCountdown } from './UI/Timers';\nimport StartScreenAnimation from './UI/StartScreenAnimation';\nimport TransitionOverlay from './UI/TransitionOverlay';\nimport { useTransitionFade } from './UI/useTransitionFade';\n\nimport { fetchGridData, updateGridStatus, isWallBlocking, getLineOfSightTiles } from './Utils/GridManagement';\nimport { handleKeyMovement, handleKeyDown as handleMovementKeyDown, handleKeyUp as handleMovementKeyUp, centerCameraOnPlayer, centerCameraOnPlayerFast } from './PlayerMovement';\nimport { mergeResources, mergeTiles, enrichResourceFromMaster } from './Utils/ResourceHelpers.js';\nimport { fetchHomesteadOwner, calculateDistance } from './Utils/worldHelpers.js';\nimport { getDerivedRange } from './Utils/worldHelpers';\nimport { handlePlayerDeath } from './Utils/playerManagement';\nimport Redirect, { shouldRedirect } from './Redirect';\n\n// FTUE Cave dungeon grid ID - this dungeon doesn't use the normal timer system\nconst FTUE_CAVE_GRID_ID = '695bd5b76545a9be8a36ee22';\n\nfunction App() {\n  // Check if we should redirect (must be before hooks for consistent evaluation)\n  const showRedirect = shouldRedirect();\n\n  const appInstanceId = Math.floor(Math.random() * 10000);\n//console.log(` App mounted. Instance ID: ${appInstanceId}`);\n\nuseEffect(() => {\n  const id = Math.floor(Math.random() * 10000);\n  console.log(` App mounted. Instance ID: ${id}`);\n  console.trace();\n}, []);\n\nuseEffect(() => {\n  const appEl = document.getElementById('root');\n  console.log(\" App mounted. Parent contents:\", appEl?.innerHTML?.slice(0, 200));\n  return () => {\n    console.log(\" App unmounted.\");\n  };\n}, []);\n\n\n  const strings = useStrings();\n  const { uiLocked } = useUILock();\n  const [isDeveloper, setIsDeveloper] = useState(false);\n  const [isMayor, setIsMayor] = useState(false);\n  // Canvas rendering mode variables removed - now forced to Canvas mode\n  const { activeModal, setActiveModal, openModal, closeModal } = useModalContext();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [modalContent, setModalContent] = useState({ title: '', message: '', message2: '' });\n  const [isRevivalModalOpen, setIsRevivalModalOpen] = useState(false);\n  const [revivalPending, setRevivalPending] = useState(false);\n  const { updateStatus } = useContext(StatusBarContext);\n  \n  // Level-up detection state\n  const [currentLevel, setCurrentLevel] = useState(null);\n  const [isLevelUpModalOpen, setIsLevelUpModalOpen] = useState(false);\n  const [levelUpData, setLevelUpData] = useState({ currentLevel: 0, previousLevel: 0 });\n  const bulkOperationContext = useBulkOperation();\n  \n  // Initialize transition fade functionality\n  const { isTransitioning, startTransition, endTransition } = useTransitionFade();\n  const transitionFadeControl = {\n    startTransition,\n    endTransition,\n    isTransitioning: () => isTransitioning\n  };\n\n  // Mobile device detection: Show modal if on mobile\n  useEffect(() => {\n    if (isMobile()) {\n      setModalContent({\n        title: 'Unsupported Device',\n        size: 'small',\n        children: (\n          <div style={{ fontSize: '1rem', textAlign: 'center', padding: '1rem' }}>\n             This game is intended for desktop browsers only.<br /><br />\n            Please revisit on a laptop or desktop computer.\n          </div>\n        ),\n        onClose: () => {},\n      });\n      setIsModalOpen(true);\n    }\n  }, []);\n  const openMailbox = () => openModal && openModal('Mailbox');\n\n  // Store purchase fulfillment effect\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const purchaseSuccess = params.get(\"purchase\");\n    const playerId = params.get(\"playerId\");\n    const offerId = params.get(\"offerId\");\n\n    if (purchaseSuccess === \"success\" && playerId && offerId) {\n      console.log(\" Processing store purchase via App.js effect:\", { playerId, offerId });\n\n      axios.post(`${API_BASE}/api/purchase-store-offer`, {\n        playerId, offerId\n      }).then(() => {\n        console.log(\" Purchase reward sent successfully.\");\n\n        /// If Gold Pass was purchased, show modal and panel\n        if (String(offerId) === \"1\") {\n          updateStatus && updateStatus(\" Congratulations on purchasing a Gold Pass!\");\n          // Re-fetch player to get updated accountStatus\n          axios.get(`${API_BASE}/api/player/${playerId}`).then((playerResponse) => {            \n          openPanel('GoldBenefitsPanel');\n          setModalContent({\n              title: strings[\"5060\"],\n              message: strings[\"5061\"],\n              message2: strings[\"5062\"],\n              size: \"small\",\n            });\n          setIsModalOpen(true);\n          }).catch((err) => {\n            console.error(\" Failed to refresh player data after Gold purchase:\", err);\n          });\n        /// If anything else was purchased, open Mailbox\n        } else {\n          updateStatus && updateStatus(\" Purchase successful! Check your Inbox.\");\n          openMailbox && openMailbox();\n        }\n      }).catch((err) => {\n        console.error(\" Failed to fulfill purchase:\", err);\n        updateStatus && updateStatus(\" Purchase may not have been fulfilled. Contact support if missing.\");\n      });\n\n      // Clean up the URL to remove query params\n      const url = new URL(window.location.href);\n      url.search = \"\";\n      window.history.replaceState({}, document.title, url.toString());\n    }\n  }, []);\n\n  // Server connectivity check: periodically ping server and show modal if down\n  useEffect(() => {\n    let interval;\n    let serverPreviouslyDown = false;\n    const checkServer = async () => {\n      try {\n        // await axios.get(`${API_BASE}/api/ping`);\n        // Always close modal if server is reachable\n        if (modalContent?.title === strings[10000]) {\n          setIsModalOpen(false);\n        }\n        // If it was previously down, reload the page\n        if (serverPreviouslyDown) { window.location.reload(); }\n      } catch (err) {\n        console.warn(\" Server unreachable:\", err.message);\n        if (!serverPreviouslyDown) {\n          setModalContent({\n            title: strings[10000],\n            message: strings[10001],\n            message2: strings[10002],\n          });\n          setIsModalOpen(true);\n          serverPreviouslyDown = true;\n        }\n      }\n    };\n    interval = setInterval(checkServer, 2000);\n    return () => clearInterval(interval);\n  }, []);\n\n\n  useEffect(() => {\n    const checkInitialSeasonPhase = async () => {\n      console.log(\"Checking for on or off Season on app start\");\n      const raw = localStorage.getItem(\"timers\");\n      if (!raw) { console.warn(\"No timers in localStorage yet.\"); return; }\n      let storedTimers = null;\n      try {\n        storedTimers = JSON.parse(raw);\n      } catch (err) {\n        console.warn(\"Malformed timers in localStorage:\", err);\n        return;\n      }\n      if (storedTimers?.seasons?.phase === \"offSeason\") {\n        console.log(\" Initial local phase is offSeason, confirming with server...\");\n        try {\n          const res = await axios.get(`${API_BASE}/api/get-global-season-phase`);\n          const serverPhase = res.data?.phase;\n          setIsOffSeason(serverPhase === \"offSeason\");\n          console.log(serverPhase === \"offSeason\" ? \" Server confirms offSeason\" : \" Server says it's not offSeason\");\n        } catch (error) {\n          console.error(\" Error confirming season with server:\", error);\n        }\n      }\n    };\n    checkInitialSeasonPhase();\n  }, []);\n\n    //  Fetch season data from local storage\n  const getSeasonData = () => {\n    const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n    return storedTimers?.seasons || { type: \"Unknown\", phase: \"Unknown\", endTime: null };\n  };\n  const seasonData = getSeasonData();\n  const [currentPlayer, setCurrentPlayer] = useState(null); // Ensure this is defined\n\n  // Canvas settings migration removed - now forced to Canvas mode always\n\n  // Initialize gridId with localStorage (do not depend on currentPlayer here)\n  const [gridId, setGridId] = useState(() => {\n    const storedGridId = localStorage.getItem('gridId');\n    return storedGridId || null;\n  });\n  const [resources, setResources] = useState([]);\n  const [tileTypes, setTileTypes] = useState([]);\n  const [grid, setGrid] = useState([]);\n  const [masterResources, setMasterResources] = useState([]);\n  const [isMasterResourcesReady, setIsMasterResourcesReady] = useState([]);\n  const [masterSkills, setMasterSkills] = useState([]);\n  const [masterWarehouse, setMasterWarehouse] = useState([]);\n  const [globalTuning, setGlobalTuning] = useState(null);\n  const [masterInteractions, setMasterInteractions] = useState([]);\n  const [masterTraders, setMasterTraders] = useState([]);\n  const [masterTrophies, setMasterTrophies] = useState([]);\n  const [masterXPLevels, setMasterXPLevels] = useState([]);\n\n  // Check if player is mayor for authoritative mayor display\n  useEffect(() => {\n    const checkMayorStatus = async () => {\n      let isPlayerMayor = false;\n      if (currentPlayer?.location?.gtype === 'town' && currentPlayer?.location?.s) {\n        try {\n          const mayorUsername = await getMayorUsername(currentPlayer.location.s);\n          isPlayerMayor = mayorUsername === currentPlayer.username;\n        } catch (error) {\n          console.error('Error checking mayor status in App.js:', error);\n        }\n      }\n      setIsMayor(isPlayerMayor);\n    };\n\n    if (currentPlayer) {\n      checkMayorStatus();\n    }\n  }, [currentPlayer?.location?.s, currentPlayer?.username]);\n\n// Synchronize tiles with GlobalGridStateTilesAndResources -- i did this so NPCs have knowledge of tiles and resources as they change\nuseEffect(() => {\n  // Always update, even if tileTypes is empty array\n  if (tileTypes !== undefined && tileTypes !== null) {\n    GlobalGridStateTilesAndResources.setTiles(tileTypes);\n    console.log('GlobalGridStateTilesAndResources tiles updated:', tileTypes);\n  }\n}, [tileTypes]);\n// Synchronize resources with GlobalGridStateTilesAndResources -- i did this so NPCs have knowledge of tiles and resources as they change\nuseEffect(() => {\n  // Always update, even if resources is empty array (important for grid transitions!)\n  if (resources !== undefined && resources !== null) {\n    // Defensive cleanup: Check for crops with invalid growEnd fields\n    let cleanedResources = resources;\n    const invalidCrops = resources.filter(res => {\n      // Check if this is a crop (output of a farmplot) with growEnd\n      if (res.growEnd && masterResources) {\n        const isCrop = masterResources.some(mr => \n          mr.category === 'farmplot' && mr.output === res.type\n        );\n        return isCrop;\n      }\n      return false;\n    });\n    \n    if (invalidCrops.length > 0) {\n      console.warn(` Found ${invalidCrops.length} crops with invalid growEnd fields, cleaning up...`);\n      invalidCrops.forEach(crop => {\n        console.log(`  - ${crop.type} at (${crop.x}, ${crop.y}) has growEnd=${crop.growEnd}`);\n      });\n      cleanedResources = resources.map(res => {\n        // If this is one of the invalid crops, remove growEnd\n        const needsCleanup = invalidCrops.some(ic => ic.x === res.x && ic.y === res.y);\n        if (needsCleanup) {\n          const { growEnd, ...cleanedRes } = res;\n          console.log(` Cleaned crop ${res.type} at (${res.x}, ${res.y})`);\n          return cleanedRes;\n        }\n        return res;\n      });\n      setResources(cleanedResources);\n    }\n    \n    GlobalGridStateTilesAndResources.setResources(cleanedResources);\n    //console.log('GlobalGridStateTilesAndResources resources updated:', cleanedResources);\n  }\n}, [resources, masterResources]);\n\nconst [zoomLevel, setZoomLevel] = useState('close'); // Default zoom level\n\n// V2 Tile Renderer toggle - always defaults to V2 (true)\n// Only respect stored 'false' if user explicitly toggled it off after this update\nconst [useV2Tiles, setUseV2Tiles] = useState(() => {\n  const hasExplicitChoice = localStorage.getItem('useV2TilesExplicit') === 'true';\n  if (hasExplicitChoice) {\n    return localStorage.getItem('useV2Tiles') === 'true';\n  }\n  return true; // Default to V2 for all users\n});\n\n// Listen for V2 tile renderer toggle changes from DebugPanel\nuseEffect(() => {\n  const handleTileRendererChange = (e) => setUseV2Tiles(e.detail);\n  window.addEventListener('tileRendererChange', handleTileRendererChange);\n  return () => window.removeEventListener('tileRendererChange', handleTileRendererChange);\n}, []);\nconst TILE_SIZES = globalTuning?.closerZoom ? {\n  closer: globalTuning.closerZoom,\n  close: globalTuning.closeZoom,\n  far: globalTuning.farZoom\n} : { closer: 50, close: 30, far: 16 }; // Use globalTuning or fallback to defaults\nconst activeTileSize = TILE_SIZES[zoomLevel]; // Get the active TILE_SIZE\nconst [isRelocating, setIsRelocating] = useState(null);\n\nconst [visibleSettlementId, setVisibleSettlementId] = useState(null);\nuseEffect(() => {\n  // currentPlayer may be null on first render, so initialize only when available\n  if (currentPlayer?.location?.s) {\n    setVisibleSettlementId(currentPlayer.location.s);\n  }\n}, [currentPlayer]);\n\n// Maintain camera position during zoom transitions\nuseLayoutEffect(() => {\n  if (zoomLevel && zoomLevel !== 'settlement' && zoomLevel !== 'frontier' && currentPlayer?.location?.g && currentPlayer?._id) {\n    const gridId = currentPlayer.location.g;\n    const playerIdStr = String(currentPlayer._id);\n    const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n    \n    if (playerPos && activeTileSize) {\n      // Use fast centering without animation to prevent jump\n      centerCameraOnPlayerFast(playerPos, activeTileSize);\n    }\n  }\n}, [zoomLevel, activeTileSize]);\n\n// Track the last shown FTUE step to detect changes\nconst [lastShownFTUEStep, setLastShownFTUEStep] = useState(null);\n\nconst [inventory, setInventory]  = useState({});\nconst [backpack, setBackpack] = useState({});\nconst [playerPosition, setPlayerPosition] = useState(null);\n\nconst NPCsInGrid = useGridState();\nconst setGridState = useGridStateUpdate();\nuseEffect(() => {\n  NPCsInGridManager.registerSetGridState(setGridState);\n}, [setGridState]);\n\nconst playersInGrid = usePlayersInGrid();\nconst setPlayersInGrid = useGridStatePCUpdate();\nuseEffect(() => {\n  playersInGridManager.registerSetPlayersInGrid(setPlayersInGrid);\n}, [setPlayersInGrid]);\nuseEffect(() => {\n  playersInGridManager.registerTileSize(activeTileSize);\n}, [activeTileSize]);\n\nconst [isLoginPanelOpen, setisLoginPanelOpen] = useState(false);\nconst [isOffSeason, setIsOffSeason] = useState(false); // Track if it's off-season\nconst { activePanel, openPanel, closePanel } = usePanelContext();\nconst { closeAllPanels } = usePanelContext(); \nconst [activeQuestGiver, setActiveQuestGiver] = useState(null);\nconst [activeSocialPC, setActiveSocialPC] = useState(null);\nconst [activeStation, setActiveStation] = useState(null);\nconst [showShareModal, setShowShareModal] = useState(false);\nconst [showFTUE, setShowFTUE] = useState(false);\nconst [doinkerTarget, setDoinkerTarget] = useState(null); // Resource type string to point doinker at\nconst [cursorMode, setCursorMode] = useState(null); // { type: 'plant', item: {...}, emoji: '' }\nconst [hoveredTile, setHoveredTile] = useState(null); // { row, col } - tile under cursor for placement highlight\n\n// Clear cursor mode when panel changes (except when staying on panels that support cursor placement)\nuseEffect(() => {\n  const cursorModePanels = ['FarmingPanel', 'ToolsPanel', 'BuildPanel', 'BuyPanel', 'BuyDecoPanel', 'PetsPanel'];\n  if (!cursorModePanels.includes(activePanel)) {\n    setCursorMode(null);\n  }\n}, [activePanel]);\n\n// Apply emoji cursor when in cursor mode\nuseEffect(() => {\n  if (cursorMode?.emoji) {\n    // Scale cursor based on resource range (multi-tile resources get larger cursors)\n    const range = cursorMode.range || 1;\n    const baseSize = 32;\n    const canvasSize = baseSize * range;\n    const fontSize = 24 * range;\n    const center = canvasSize / 2;\n\n    // Create a canvas to render the emoji as a cursor image\n    const canvas = document.createElement('canvas');\n    canvas.width = canvasSize;\n    canvas.height = canvasSize;\n    const ctx = canvas.getContext('2d');\n    ctx.font = `${fontSize}px serif`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(cursorMode.emoji, center, center);\n    const cursorUrl = canvas.toDataURL();\n\n    // Create a style element to force cursor on all elements (including canvas)\n    const styleEl = document.createElement('style');\n    styleEl.id = 'cursor-mode-style';\n    styleEl.textContent = `\n      body.cursor-mode-active,\n      body.cursor-mode-active * {\n        cursor: url(${cursorUrl}) ${center} ${center}, crosshair !important;\n      }\n    `;\n    document.head.appendChild(styleEl);\n    document.body.classList.add('cursor-mode-active');\n\n    return () => {\n      document.body.classList.remove('cursor-mode-active');\n      const existingStyle = document.getElementById('cursor-mode-style');\n      if (existingStyle) existingStyle.remove();\n    };\n  } else {\n    document.body.classList.remove('cursor-mode-active');\n    const existingStyle = document.getElementById('cursor-mode-style');\n    if (existingStyle) existingStyle.remove();\n  }\n}, [cursorMode]);\n\n// Register notification click handlers\nuseEffect(() => {\n  registerNotificationClickHandler('Trophy', (data) => {\n    openPanel('TrophyPanel');\n  });\n  \n  registerNotificationClickHandler('To Do', (data) => {\n    openPanel('QuestPanel');\n  });\n}, [openPanel]);\n\nuseEffect(() => {\n  const storedPlayer = localStorage.getItem('player');\n  if (!storedPlayer) {\n    console.log('[Watcher] No stored player found  showing login panel.');\n    setisLoginPanelOpen(true);\n    openPanel(\"LoginPanel\");\n    setShowKeyArt(true);\n  }\n}, [activePanel]);\n\nconst handleNPCPanel = (npc) => {\n  console.log('App.js: Handling an NPC Panel:', npc, npc.action);\n  switch (npc.action) {\n    case 'quest':\n    case 'trade':\n    case 'heal': {\n      setActiveQuestGiver(npc);  // Set the active quest giver globally\n      if (npc.type==='Kent') {\n        openPanel('KentPanel');  \n      } else {\n        openPanel('NPCPanel');  \n      }\n      break;\n    }\n    case 'worker': {\n      setActiveQuestGiver(npc);  // Set the active quest giver globally\n      // Set activeStation data for NPC-based access to ensure gridId is available\n      setActiveStation({\n        type: npc.type, // Use the actual NPC type (Farmer, Farm Hand, Rancher, Lumberjack)\n        position: npc.position,\n        gridId: currentPlayer.location?.g\n      });\n      openPanel('FarmHandPanel');  \n      break;\n    }\n    default: { break; }\n  }\n};\n\nconst handlePCClick = (pc) => {\n  console.log('App.js: Opening SocialPanel for PC:', pc);\n  setActiveSocialPC(pc);  // Set the active clicked PC globally\n  openPanel('SocialPanel');  // Open the panel\n};\n\nconst [hoverTooltip, setHoverTooltip] = useState(null);\n\n\nconst [controllerUsername, setControllerUsername] = useState(null); // Add state for controller username\nconst [isSocketConnected, setIsSocketConnected] = useState(false);\nconst [connectedPlayers, setConnectedPlayers] = useState(() => new Set());\nconst [chatMessages, setChatMessages] = useState({});\nconst [badgeState, setBadgeState] = useState({ chat: false, store: false, mailbox: false });\n\n//Forgot why we did this:\nconst memoizedGrid = useMemo(() => grid, [grid]);\nconst memoizedTileTypes = useMemo(() => tileTypes, [tileTypes]);\n\nconst memoizedResources = useMemo(() => resources, [resources]);\n\nconst [showKeyArt, setShowKeyArt] = useState(false);\n\n\n/////////// APP INITIALIZATION /////////////////////////\n\n// Flags to track initialization\nlet isInitializing = false; // Declare inside useEffect to avoid global persistence\nconst [isAppInitialized, setIsAppInitialized] = useState(false);\n\n// Central INITIALIZATION for player and grid data //////////////////////////////////////////////////////\n\n// --- SOCKET \"connect\" LISTENER: Register before other listeners\n// This effect runs once at mount to set up socket.on('connect') as early as possible\nuseEffect(() => {\n  if (!socket) return;\n  // Remove any previous connect listeners to avoid duplicate logs\n  socket.off('connect', socket.__vvgame_connect_listener);\n  const connectListener = () => {\n    console.log(' Socket connected!');\n    if (currentPlayer?.playerId) {\n      console.log(' Rejoining playerId room:', currentPlayer.playerId);\n      socket.emit('join-player-room', currentPlayer.playerId);\n    }\n  };\n  socket.on('connect', connectListener);\n  // Save a reference for cleanup\n  socket.__vvgame_connect_listener = connectListener;\n  return () => {\n    socket.off('connect', connectListener);\n    delete socket.__vvgame_connect_listener;\n  };\n  // Depend on currentPlayer so we can re-emit join-player-room if playerId changes\n}, [socket, currentPlayer]);\n\nuseEffect(() => {\n  let cleanupBadges = null;\n\n  const initializeAppWrapper = async () => {\n    console.log(' App initialization begun.');\n    if (isInitializing) {\n      console.log('Initialization is already in progress. Skipping.');\n      return;\n    }\n    isInitializing = true;\n\n    try {\n      // Step 1. Load tuning data\n      console.log(' 1 InitAppWrapper; Merging player data and initializing inventory...');\n      const [skills, resources, globalTuningData, interactions, traders, trophies, warehouse, xpLevels] = await Promise.all([loadMasterSkills(), loadMasterResources(), loadGlobalTuning(), loadMasterInteractions(), loadMasterTraders(), loadMasterTrophies(), loadMasterWarehouse(), loadMasterXPLevels()]);\n      setMasterResources(resources);\n      setMasterSkills(skills);\n      setGlobalTuning(globalTuningData);\n      setMasterInteractions(interactions);\n      setMasterTraders(traders);\n      setMasterTrophies(trophies);\n      setMasterWarehouse(warehouse);\n      setMasterXPLevels(xpLevels);\n      setIsMasterResourcesReady(true); //  Mark ready\n      // Step 2. Fetch stored player from localStorage\n      console.log(' 2 InitAppWrapper; getting local player...');\n      const storedPlayer = localStorage.getItem('player');\n\n      if (!storedPlayer) {\n        console.log('No stored player found, showing login screen.');\n        setisLoginPanelOpen(true);    \n        openPanel(\"LoginPanel\");  \n        setShowKeyArt(true);  //  NEW STATE FLAG TO TRIGGER IMAGE\n        return;\n      }\n      const parsedPlayer = JSON.parse(storedPlayer);\n\n      // 2.1 Fetch the full player data from the server\n      console.log(' 2.1 InitAppWrapper; fetching player from server...');\n      const response = await axios.get(`${API_BASE}/api/player/${parsedPlayer.playerId}`);\n      const DBPlayerData = response.data;\n      if (!DBPlayerData || !DBPlayerData.playerId) {\n        console.error('Invalid full player data from server:', DBPlayerData);\n        setisLoginPanelOpen(true);\n        return;\n      }\n      \n      // 2.2 Update lastActive timestamp for app initialization\n      console.log(' 2.2 InitAppWrapper; updating lastActive timestamp...');\n      try {\n        await axios.post(`${API_BASE}/api/update-last-active`, {\n          playerId: parsedPlayer.playerId\n        });\n      } catch (error) {\n        console.warn('Failed to update lastActive:', error);\n        // Don't block app initialization if this fails\n      }\n\n      // Step 2.5: Check for stale gridId (e.g. after offSeason relocation)\n      console.log(' 2.5 InitAppWrapper; checking for stale gridId after relocation...');\n      const storedGridId = localStorage.getItem(\"gridId\");\n      const resolvedGridId = DBPlayerData.location?.g;\n      if (storedGridId && resolvedGridId && storedGridId !== resolvedGridId) {\n        console.warn(\" Detected stale gridId from localStorage. Updating to new home grid.\");\n        localStorage.setItem(\"gridId\", resolvedGridId);\n        setGridId(resolvedGridId); //  Use setter to update React state\n      }\n\n      // Step 3. Combine local and server data, prioritizing newer info from the server\n      console.log(' 3 InitAppWrapper; Merging player data and initializing inventory...');\n      let updatedPlayerData = { ...parsedPlayer, ...DBPlayerData };\n      setCurrentPlayer(updatedPlayerData);\n      if (updatedPlayerData?.username) {\n        console.log(` [APP] About to check developer status for: \"${updatedPlayerData.username}\"`);\n        const isDev = await checkDeveloperStatus(updatedPlayerData.username);\n        console.log(` [APP] isDev result: ${isDev}, calling setIsDeveloper(${isDev})`);\n        setIsDeveloper(isDev);\n      } else {\n        console.log(` [APP] No username found in updatedPlayerData:`, updatedPlayerData);\n      }\n      setInventory(DBPlayerData.inventory || []);  // Initialize inventory properly\n      setBackpack(DBPlayerData.backpack || []);\n\n      // Step 4. Determine initial gridId from player or storage\n      // Use fresh server data (resolvedGridId) first, then fall back to cached data\n      console.log(' 4. Determining local gridId...');\n      const initialGridId = resolvedGridId || parsedPlayer?.location?.g || localStorage.getItem('gridId');\n      if (!initialGridId) {\n        console.error('No gridId found. Unable to initialize grid.');\n        return;\n      }\n      setGridId(initialGridId);\n      localStorage.setItem('gridId', initialGridId); // Save to local storage\n\n      // 4.5. Open the socket and wait for connection before emitting\n      socket.connect();\n\n      // Wait for socket to be connected before emitting join events\n      const waitForConnection = () => new Promise((resolve) => {\n        if (socket.connected) {\n          resolve();\n        } else {\n          socket.once('connect', resolve);\n        }\n      });\n\n      await waitForConnection();\n      console.log(\" Socket connected, now joining rooms...\");\n\n      // Join the grid for grid-based updates\n      socket.emit('join-grid', { gridId: initialGridId, playerId: DBPlayerData.playerId });\n      console.log(\" Emitted join-grid for grid:\", initialGridId);\n\n      // Format playerData correctly for socket sync (matching PlayersInGrid schema)\n      // DBPlayerData uses different field names (baseHp, location.x) than PC schema (hp, position.x)\n      const formattedPlayerData = {\n        playerId: DBPlayerData.playerId || DBPlayerData._id?.toString(),\n        username: DBPlayerData.username,\n        type: 'pc',\n        icon: DBPlayerData.icon || '',\n        position: {\n          x: DBPlayerData.location?.x ?? 0,\n          y: DBPlayerData.location?.y ?? 0\n        },\n        hp: DBPlayerData.baseHp ?? 25,\n        maxhp: DBPlayerData.baseMaxhp ?? 25,\n        armorclass: DBPlayerData.baseArmorclass ?? 10,\n        attackbonus: DBPlayerData.baseAttackbonus ?? 0,\n        damage: DBPlayerData.baseDamage ?? 1,\n        attackrange: DBPlayerData.baseAttackrange ?? 1,\n        speed: DBPlayerData.baseSpeed ?? 1,\n        iscamping: DBPlayerData.iscamping ?? false,\n        isinboat: DBPlayerData.isinboat ?? false,\n        lastUpdated: Date.now(),\n      };\n\n      socket.emit('player-joined-grid', {\n        gridId: initialGridId,\n        playerId: DBPlayerData.playerId,\n        username: DBPlayerData.username,\n        playerData: formattedPlayerData,\n      });\n      // Join the player room for personal updates\n      socket.emit('join-player-room', { playerId: DBPlayerData.playerId });\n      console.log(` Joined socket room for playerId: ${DBPlayerData.playerId}`);\n      socket.emit('set-username', { username: DBPlayerData.username });\n\n      // Request current NPCController status to clear any stale controller data\n      console.log(` Requesting current NPCController for grid: ${initialGridId}`);\n      socket.emit('request-npc-controller', { gridId: initialGridId });\n\n      // Step 5. Initialize grid tiles, resources\n      console.log(' 5 InitAppWrapper; Initializing grid tiles and resources...');\n      await initializeGrid(\n        activeTileSize,\n        initialGridId,\n        setGrid,\n        setResources,\n        setTileTypes,\n        updateStatus,\n        DBPlayerData,\n        masterResources\n      );\n\n      // Step 6. Initialize NPCs\n      console.log(' 6 InitAppWrapper; Initializing NPC NPCsInGrid...');\n      await NPCsInGridManager.initializeGridState(initialGridId);\n      const freshNPCState = NPCsInGridManager.getNPCsInGrid(initialGridId);\n      console.log('initializedState (NPCs): ',freshNPCState);\n\n      // Step 7. Initialize PCs\n      console.log(' 7 InitAppWrapper; Initializing playersInGrid...');\n      await playersInGridManager.initializePlayersInGrid(initialGridId);\n      const freshPCState = playersInGridManager.getPlayersInGrid(initialGridId);\n      const playerId = String(parsedPlayer.playerId);\n      const playerPosition = freshPCState?.[playerId]?.position;\n      console.log('Player position from playersInGrid:', playerPosition);\n      if (playerPosition) {\n        centerCameraOnPlayer(playerPosition, activeTileSize);\n      }\n\n      // Step 8. Resolve player location \n      console.log(' 8 InitAppWrapper; Resolving player location...');\n      const playerIdStr = DBPlayerData._id.toString();\n      let gridPlayer = freshPCState?.[playerIdStr];\n\n      // Step A: Detect location mismatch or missing from NPCsInGrid\n      const isLocationMismatch = DBPlayerData.location?.g !== initialGridId;\n      const isMissingFromGrid = !gridPlayer;\n\n      console.log('isLocationMismatch = ', isLocationMismatch);\n      console.log('isMissingFromGrid = ', isMissingFromGrid);\n\n      if (isMissingFromGrid && gridId === DBPlayerData.location.g) {\n        console.warn(\" Player not in correct NPCsInGrid or missing entirely. Repositioning...\");\n        const targetPosition = { x: 0, y: 0 };\n        console.warn('InitAppWrapper: adding PC to NPCsInGrid');\n        await playersInGridManager.addPlayer(gridId, DBPlayerData.playerId, DBPlayerData);\n        // Refresh the NPCsInGrid and React state\n        console.warn('InitAppWrapper: refreshing NPCsInGrid');\n        setPlayersInGrid((prev) => ({\n          ...prev,\n          [gridId]: playersInGridManager.getPlayersInGrid(gridId),\n        }));\n        const gridPlayer = playersInGridManager.getPlayersInGrid(gridId)?.[playerIdStr];\n        console.log('Refreshed gridPlayer:', gridPlayer);\n        // Update gridId and storage to match actual grid\n        console.warn('InitAppWrapper: adding PC to NPCsInGrid');\n        setGridId(gridId);\n        localStorage.setItem(\"gridId\", gridId);\n        // Update player's in-memory and stored location\n        DBPlayerData.location = {\n          ...DBPlayerData.location,\n          x: targetPosition.x,\n          y: targetPosition.y,\n          g: gridId,\n        };\n\n        console.log(\" Player repositioned into NPCsInGrid:\", gridPlayer);\n      } else {\n        console.log(' Player found in local NPCsInGrid.');\n      }\n\n      // Step 11: Update local storage with final player state\n      console.log(' 11 InitAppWrapper: updating localStorage with player data');\n      updatedPlayerData = {\n        ...DBPlayerData,\n        location: {\n          ...DBPlayerData.location,\n          x: gridPlayer?.position?.x || 3,\n          y: gridPlayer?.position?.y || 3,\n          g: DBPlayerData.location.g,\n        },\n      };\n\n      // Step 11a: Lookup homestead gridCoord if not already stored\n      if (updatedPlayerData.gridId && !updatedPlayerData.homesteadGridCoord) {\n        try {\n          console.log(' Looking up homestead gridCoord for gridId:', updatedPlayerData.gridId);\n          const homesteadResponse = await axios.get(`${API_BASE}/api/homestead-gridcoord/${updatedPlayerData.gridId}`);\n          if (homesteadResponse.data.gridCoord) {\n            updatedPlayerData.homesteadGridCoord = homesteadResponse.data.gridCoord;\n            console.log(' Homestead gridCoord found and stored:', homesteadResponse.data.gridCoord);\n          }\n        } catch (error) {\n          console.warn(' Could not find homestead gridCoord:', error.response?.data?.error || error.message);\n        }\n      }\n\n      setCurrentPlayer(updatedPlayerData);\n      localStorage.setItem('player', JSON.stringify(updatedPlayerData));\n      console.log(` LocalStorage updated with combat stats:`, updatedPlayerData);\n\n      // Step 11b: Mark current grid as visited (initial load)\n      const currentGridCoord = updatedPlayerData.location?.gridCoord;\n      if (typeof currentGridCoord === 'number' && currentGridCoord >= 0) {\n        try {\n          const { isGridVisited } = await import('./Utils/gridsVisitedUtils');\n          if (!isGridVisited(updatedPlayerData.gridsVisited, currentGridCoord)) {\n            console.log(` [GRIDS_VISITED] Marking initial grid ${currentGridCoord} as visited`);\n            const visitResponse = await axios.post(`${API_BASE}/api/mark-grid-visited`, {\n              playerId: updatedPlayerData.playerId,\n              gridCoord: currentGridCoord\n            });\n            if (visitResponse.data.success && visitResponse.data.gridsVisited) {\n              updatedPlayerData.gridsVisited = visitResponse.data.gridsVisited;\n              setCurrentPlayer({ ...updatedPlayerData });\n              localStorage.setItem('player', JSON.stringify(updatedPlayerData));\n              console.log(` [GRIDS_VISITED]  Initial grid marked as visited`);\n            }\n          }\n        } catch (err) {\n          console.warn(' [GRIDS_VISITED] Could not mark initial grid as visited:', err);\n        }\n      }\n\n      // Step 12: Check for death flag and show modal if needed\n      if (updatedPlayerData.settings?.hasDied) {\n        console.log(\" Player died last session. Showing death modal.\");\n        setModalContent({\n          title: strings[\"5001\"],\n          message: strings[\"5002\"],\n          message2: strings[\"5003\"],\n          size: \"small\",\n        });\n        setIsModalOpen(true);\n\n        // Clear the flag in DB\n        await axios.post(`${API_BASE}/api/update-profile`, {\n          playerId: updatedPlayerData.playerId,\n          updates: { \"settings.hasDied\": false },\n        });\n\n        // Clear the flag in localStorage\n        updatedPlayerData.settings.hasDied = false;\n        localStorage.setItem('player', JSON.stringify(updatedPlayerData));\n      }\n\n      // Step 13: Check for buttons that need to be badged\n      const storedBadges = getBadgeState(updatedPlayerData);\n      setBadgeState(storedBadges); //  apply localStorage state to UI immediately\n\n      //  Badge the mailbox if any messages are unread\n      const hasUnreadMail = (updatedPlayerData.messages || []).some(msg => !msg.read);\n      if (hasUnreadMail) {\n        updateBadge(updatedPlayerData, setBadgeState, 'mailbox', true); //  Use your helper\n      }\n\n      cleanupBadges = socketListenForBadgeUpdates(updatedPlayerData, setBadgeState, updateBadge);\n\n      console.log(' App initialization complete.');\n\n      //setShowTimers(true);    // default \"Happening In Town\" details open (true) or closed (flase)\n\n      const zoom = localStorage.getItem(\"initialZoomLevel\");\n      if (zoom) {\n        setZoomLevel(zoom);\n        localStorage.removeItem(\"initialZoomLevel\");\n      }\n\n      setIsAppInitialized(true);\n      \n      // Store FTUE info but don't show yet - wait for grid to load\n      if (updatedPlayerData.firsttimeuser === true && updatedPlayerData.ftuestep !== undefined && updatedPlayerData.ftuestep >= 0) {\n        console.log(' FTUE step detected for first-time user:', updatedPlayerData.ftuestep, ', will show after grid loads');\n        // Don't show FTUE yet - let the grid load first\n      }\n\n    } catch (error) {\n      console.error('Error during app initialization:', error);\n      \n      // If player not found (404), clear local storage and show login panel\n      if (error.response?.status === 404) {\n        console.log('Player not found (possibly deleted). Clearing local storage and showing login panel.');\n        localStorage.removeItem(\"player\");\n        localStorage.removeItem(\"playerId\");\n        setCurrentPlayer(null);\n        setisLoginPanelOpen(true);\n      } else {\n        updateStatus(error.code === 'ERR_NETWORK' ? 1 : 0);  // Handle other errors\n      }\n    }\n  };\n\n\n  initializeAppWrapper();\n\n  return () => {\n    cleanupBadges?.();\n  };\n}, []);  // Only run once when the component mounts\n\n// Revival state handlers\nconst handleAcceptDeath = async () => {\n  console.log(\" Player accepted death\");\n  setIsRevivalModalOpen(false);\n  setRevivalPending(false);\n  localStorage.removeItem('revivalState');\n  \n  // Execute normal death flow\n  await handlePlayerDeath(\n    currentPlayer,\n    setCurrentPlayer,\n    setGridId,\n    setGrid,\n    setResources,\n    setTileTypes,\n    activeTileSize,\n    updateStatus,\n    setModalContent,\n    setIsModalOpen,\n    closeAllPanels,\n    false // offerRevival = false\n  );\n  \n  // Show normal death modal\n  setModalContent({\n    title: strings[\"5001\"],\n    message: strings[\"5002\"],\n    message2: strings[\"5003\"],\n    size: \"small\",\n  });\n  setIsModalOpen(true);\n};\n\nconst handleRevive = async () => {\n  console.log(\" Player attempting to revive\");\n  const reviveCost = globalTuning?.costToRevive || 50;\n  \n  // Get player's gem count from inventory\n  const playerGems = inventory.find(item => item.type === 'Gem')?.quantity || 0;\n  console.log(`Player has ${playerGems} gems, needs ${reviveCost}`);\n  \n  // Check if player has enough gems\n  if (playerGems >= reviveCost) {\n    console.log(\" Player has enough gems, reviving...\");\n    \n    // Calculate HP to restore\n    const percentageToRevive = globalTuning?.percentageToRevive || 0.25;\n    // Calculate proper maxHP from base stats and equipment (don't let it get corrupted)\n    const properMaxHp = (currentPlayer.baseMaxhp || 25) + (currentPlayer.maxhpModifier || 0);\n    const restoredHp = Math.floor(properMaxHp * percentageToRevive);\n    \n    try {\n      // Update inventory to deduct gems\n      const updatedInventory = inventory.map(item => {\n        if (item.type === 'Gem') {\n          return { ...item, quantity: item.quantity - reviveCost };\n        }\n        return item;\n      });\n      \n      // Update player stats in database (only inventory, not HP which belongs in grid state)\n      const response = await axios.post(`${API_BASE}/api/update-profile`, {\n        playerId: currentPlayer._id,\n        updates: {\n          inventory: updatedInventory\n        }\n      });\n      \n      // Update local player state (HP doesn't belong here, it's in grid state)\n      const updatedPlayer = {\n        ...currentPlayer,\n        inventory: updatedInventory\n      };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n      setInventory(updatedInventory);\n      \n      // Update grid state - this is the critical part for HP to show correctly\n      const playerId = String(currentPlayer._id);\n      console.log(` Updating player ${playerId} HP to ${restoredHp} in grid ${gridId}`);\n      playersInGridManager.updatePC(gridId, playerId, { hp: restoredHp });\n      \n      // Force update the players in grid state to trigger re-render\n      const updatedPCs = playersInGridManager.getPlayersInGrid(gridId);\n      console.log(` Player HP in grid state:`, updatedPCs[playerId]?.hp);\n      \n      // Clear revival state\n      setIsRevivalModalOpen(false);\n      setRevivalPending(false);\n      localStorage.removeItem('revivalState');\n      \n      console.log(` Player revived with ${restoredHp} HP`);\n      updateStatus(`Revived with ${restoredHp} HP!  -${reviveCost} Gems`);\n      \n    } catch (error) {\n      console.error(\" Error during revival:\", error);\n      updateStatus(\"Revival failed - please try again\");\n    }\n  }\n  // Note: Insufficient gems case is now handled directly in RevivalModal with embedded purchase buttons\n};\n\n// Auto-exit from dungeon when phase changes to resetting\nconst handleDungeonAutoExit = async () => {\n  // Prevent multiple simultaneous exit attempts\n  if (isDungeonExitInProgress.current) {\n    console.log(\" Dungeon exit already in progress, skipping duplicate attempt\");\n    return;\n  }\n  \n  isDungeonExitInProgress.current = true;\n  \n  try {\n    console.log(\" Auto-exiting dungeon due to reset phase\");\n    \n    // Show warning message\n    updateStatus(\"Dungeon is resetting! Teleporting you to safety...\");\n    \n    // First attempt: Try normal dungeon exit\n    try {\n      const { handleDungeonExit } = await import('./GameFeatures/Dungeon/Dungeon');\n      await handleDungeonExit(\n        currentPlayerRef.current,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        setResources,\n        updateStatus,\n        activeTileSize,\n        closeAllPanels,\n        bulkOperationContext,\n        masterResources,\n        strings,\n        masterTrophies,\n        transitionFadeControl\n      );\n      updateStatus(\"You have been safely returned to the surface as the dungeon resets.\");\n      isDungeonExitInProgress.current = false; // Reset flag on success\n      return; // Success, exit early\n    } catch (exitError) {\n      console.warn(\" Normal dungeon exit failed, attempting fallback...\", exitError);\n    }\n    \n    // Fallback: If no source grid found, teleport to homestead\n    console.log(\" Fallback: Teleporting to player's homestead\");\n    const { handleTransitSignpost } = await import('./GameFeatures/Transit/Transit');\n    await handleTransitSignpost(\n      currentPlayerRef.current,\n      \"Signpost Home\",\n      setCurrentPlayer,\n      setGridId,\n      setGrid,\n      setTileTypes,\n      setResources,\n      updateStatus,\n      activeTileSize,\n      currentPlayerRef.current.skills,\n      closeAllPanels,\n      bulkOperationContext,\n      masterResources,\n      strings,\n      masterTrophies,\n      transitionFadeControl\n    );\n    \n    updateStatus(\"Dungeon reset - you've been returned to your homestead.\");\n  } catch (error) {\n    console.error(\" Error auto-exiting dungeon:\", error);\n    updateStatus(\"Error returning to surface. The dungeon will reset when you manually exit.\");\n  } finally {\n    // Reset the flag after completion\n    isDungeonExitInProgress.current = false;\n  }\n};\n\n// Check for saved revival state on mount\nuseEffect(() => {\n  const savedRevivalState = localStorage.getItem('revivalState');\n  if (savedRevivalState && currentPlayer) {\n    try {\n      const revivalData = JSON.parse(savedRevivalState);\n      // Check if it's for the current player\n      if (revivalData.playerId === currentPlayer._id && revivalData.isRevivalPending) {\n        console.log(\" Restoring revival state after refresh\");\n        setRevivalPending(true);\n        setIsRevivalModalOpen(true);\n      } else {\n        localStorage.removeItem('revivalState');\n      }\n    } catch (error) {\n      console.error(\"Error parsing revival state:\", error);\n      localStorage.removeItem('revivalState');\n    }\n  }\n}, [currentPlayer]);\n\n// Establish UI BADGING (Chat, Mailbox, Store) //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!currentPlayer?.username) return;\n  // Load badge state from localStorage\n  const stored = localStorage.getItem(`badges_${currentPlayer.username}`);\n  if (stored) {\n    setBadgeState(JSON.parse(stored));\n  }\n  // Set up badge socket listener\n  const cleanupBadges = socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge);\n  // Clean up on unmount or player change\n  return () => {\n    cleanupBadges?.();\n  };\n}, [currentPlayer, socket]);\n\n// Watch for ftuestep changes to show FTUE modal\nuseEffect(() => {\n  // Only process FTUE if player is explicitly a first-time user\n  if (currentPlayer?.firsttimeuser === true && currentPlayer?.ftuestep !== undefined && currentPlayer.ftuestep >= 0) {\n    // Only show modal if this is a different step than last shown AND it's a forward progression\n    if (currentPlayer.ftuestep !== lastShownFTUEStep && \n        (lastShownFTUEStep === null || currentPlayer.ftuestep > lastShownFTUEStep)) {\n      \n      // Check if app is initialized and grid has loaded\n      const gridLoaded = isAppInitialized && tileTypes.length > 0 && resources.length > 0;\n      \n      if (gridLoaded) {\n        console.log(' FTUE step changed to:', currentPlayer.ftuestep, ', showing FTUE (grid loaded)');\n        // Only close panels if the FTUE step will actually show a modal\n        const stepData = FTUEstepsData.find(step => step.step === currentPlayer.ftuestep);\n        if (stepData?.showModal !== false) {\n          // Close any open panels before showing FTUE modal to ensure clean state\n          closePanel();\n          setActiveStation(null); // Clear active station to prevent panels from re-opening\n        }\n        setShowFTUE(true);\n        setLastShownFTUEStep(currentPlayer.ftuestep);\n      } else {\n        console.log(' FTUE step changed to:', currentPlayer.ftuestep, ', but waiting for grid to load');\n      }\n    }\n  }\n}, [currentPlayer?.ftuestep, lastShownFTUEStep, isAppInitialized, tileTypes.length, resources.length, closePanel]);\n\n// Also check when grid loads to show pending FTUE\nuseEffect(() => {\n  if (currentPlayer?.firsttimeuser === true && \n      currentPlayer?.ftuestep !== undefined && \n      currentPlayer.ftuestep >= 0 &&\n      !showFTUE &&\n      isAppInitialized && \n      tileTypes.length > 0 && \n      resources.length > 0) {\n    \n    // If we have a pending FTUE step that hasn't been shown yet\n    if (currentPlayer.ftuestep !== lastShownFTUEStep) {\n      console.log(' Grid loaded, showing pending FTUE step:', currentPlayer.ftuestep);\n      // Only close panels if the FTUE step will actually show a modal\n      const stepData = FTUEstepsData.find(step => step.step === currentPlayer.ftuestep);\n      if (stepData?.showModal !== false) {\n        // Close any open panels before showing FTUE modal to ensure clean state\n        closePanel();\n        setActiveStation(null); // Clear active station to prevent panels from re-opening\n      }\n      setShowFTUE(true);\n      setLastShownFTUEStep(currentPlayer.ftuestep);\n    }\n  }\n}, [isAppInitialized, tileTypes.length, resources.length, currentPlayer, lastShownFTUEStep, showFTUE, closePanel]);\n\n// FTUE Doinker - Update doinker target based on current FTUE step\nuseEffect(() => {\n  if (!currentPlayer?.firsttimeuser || currentPlayer?.ftuestep === undefined) {\n    setDoinkerTarget(null);\n    return;\n  }\n\n  const stepData = FTUEstepsData.find(step => step.step === currentPlayer.ftuestep);\n\n  if (stepData?.doinker && stepData?.doinkerTarget) {\n    console.log(` Doinker: Showing arrow pointing to \"${stepData.doinkerTarget}\" for FTUE step ${currentPlayer.ftuestep}`);\n    setDoinkerTarget(stepData.doinkerTarget);\n  } else {\n    setDoinkerTarget(null);\n  }\n}, [currentPlayer?.ftuestep, currentPlayer?.firsttimeuser]);\n\n// Level-up detection: Watch for XP changes and show level-up modal\nuseEffect(() => {\n  if (currentPlayer?.xp !== undefined && masterXPLevels && masterXPLevels.length > 0) {\n    const newLevel = getDerivedLevel(currentPlayer, masterXPLevels);\n    \n    // If we have a previous level and the new level is higher, show level-up modal\n    if (currentLevel !== null && newLevel > currentLevel) {\n      setLevelUpData({\n        currentLevel: newLevel,\n        previousLevel: currentLevel\n      });\n      setIsLevelUpModalOpen(true);\n    }\n    \n    // Update the tracked level\n    setCurrentLevel(newLevel);\n  }\n}, [currentPlayer?.xp, masterXPLevels, currentLevel]);\n\n// FARM STATE - Farming Seed Timer Management //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (gridId && masterResources) {\n    farmState.initializeFarmState(resources); //  Works for seeds\n    farmState.startSeedTimer({gridId,setResources,masterResources});\n  }\n  return () => { farmState.stopSeedTimer(); };\n}, [gridId, resources, masterResources]);  \n\n\n\n//  NPC Management Loop\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping NPC management.'); return; }\n  //console.log(' NPC Management Loop started for gridId:', gridId);\n\n  const interval = setInterval(() => {\n    const currentGridNPCs = NPCsInGrid?.[gridId]?.npcs;\n    if (!currentGridNPCs) {\n      console.warn('No NPCs in NPCsInGrid for gridId:', gridId);\n      return;\n    }\n    const isController = controllerUsername === currentPlayer?.username;\n\n    if (isController) {\n      Object.values(currentGridNPCs).forEach((npc) => {\n        if (typeof npc.update !== 'function') {\n          console.warn(` Skipping NPC without update() method:`, npc);\n          return;\n        }\n        \n        // Verify NPC belongs to current grid before updating\n        if (npc.gridId && npc.gridId !== gridId) {\n          console.warn(` NPC ${npc.id} (${npc.type}) has gridId ${npc.gridId} but is being updated in grid ${gridId}. Skipping.`);\n          return;\n        }\n        \n        //console.log(`[ NPC LOOP] Controller running update() for NPC ${npc.id}, state=${npc.state}`);\n        npc.update(Date.now(), NPCsInGrid[gridId], gridId, activeTileSize);\n      });\n      \n      // Trigger React state update after all NPCs have been updated\n      // This ensures Canvas mode re-renders with new positions\n      const updatedGridState = NPCsInGridManager.getNPCsInGrid(gridId);\n      if (updatedGridState?.npcs) {\n        NPCsInGridManager.setAllNPCs(gridId, updatedGridState.npcs);\n        console.log(' NPC update loop: Triggered state update, sample NPC:', \n          Object.values(updatedGridState.npcs)[0] ? {\n            id: Object.values(updatedGridState.npcs)[0].id,\n            pos: `${Object.values(updatedGridState.npcs)[0].position?.x},${Object.values(updatedGridState.npcs)[0].position?.y}`\n          } : 'none'\n        );\n      }\n    } else {\n      //console.log(' Not the NPC controller. Skipping NPC updates.');\n    }\n  }, 1000);\n\n  return () => clearInterval(interval);\n}, [isAppInitialized, gridId, NPCsInGrid, currentPlayer, activeTileSize, controllerUsername]);\n\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//  PC Management Loop: Check for player death & lava //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC management.'); return; }\n\n  const interval = setInterval(async () => {\n    if (playersInGrid && gridId && currentPlayer?._id) {\n      const playerId = String(currentPlayer._id);\n      const playerPC = playersInGrid?.[gridId]?.pcs?.[playerId];\n      const col = playerPC?.position?.x;\n      const row = playerPC?.position?.y;\n      const onTileType = tileTypes?.[row]?.[col];\n\n      if (playerPC?.hp <= 0 && currentPlayer && !revivalPending) {\n        console.log(\" Player is dead. Showing revival option...\");\n        \n        // Set revival pending state and show revival modal\n        setRevivalPending(true);\n        setIsRevivalModalOpen(true);\n        \n        // Store revival state in localStorage for refresh handling\n        const revivalState = {\n          isRevivalPending: true,\n          deathTimestamp: Date.now(),\n          playerId: currentPlayer._id\n        };\n        localStorage.setItem('revivalState', JSON.stringify(revivalState));\n\n      } else {\n        //  Check for lava tile\n        if (onTileType === \"l\") {\n          const lavaDamage = 2;\n          playersInGrid[gridId].pcs[playerId].hp -= lavaDamage;\n          FloatingTextManager.addFloatingText(`- ${lavaDamage}  HP`, col, row, activeTileSize);\n          console.log(\" Player is standing on lava. Applying 2 damage.\");\n        }\n\n      }\n    }\n  }, 1000);\n  return () => clearInterval(interval);\n// Add dependencies for resources, setResources, setInventory, setBackpack, inventory, backpack, masterResources, masterSkills\n}, [\n  isAppInitialized,\n  gridId,\n  playersInGrid,\n  currentPlayer,\n  activeTileSize,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  masterResources,\n  masterSkills,\n]);\n\n//  PC Management Loop: Check for low health //////////////////////////////////////////////////////\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC Health Check.'); return; }\n\n  const interval = setInterval(async () => {\n      if (playersInGrid && gridId && currentPlayer?._id) {\n        const playerId = String(currentPlayer._id);\n        const playerPC = playersInGrid?.[gridId]?.pcs?.[playerId];\n        const col = playerPC?.position?.x;\n        const row = playerPC?.position?.y;\n\n      if (playerPC?.hp <= (currentPlayer.baseMaxhp/2) && currentPlayer.location.gtype === 'homestead') {\n          const healing = 2;\n          playersInGrid[gridId].pcs[playerId].hp += healing;\n          FloatingTextManager.addFloatingText(`+ ${healing}  HP`, col, row, activeTileSize);\n        }\n    }\n  }, 10000);\n  return () => clearInterval(interval);\n}, [\n  isAppInitialized,\n  gridId,\n  playersInGrid,\n  currentPlayer,\n  activeTileSize,\n  resources,\n  setResources,\n  setInventory,\n  setBackpack,\n  inventory,\n  backpack,\n  masterResources,\n  masterSkills,\n]);\n\n/////// TIMERS & SEASONS //////////////////////////////////////////////////////\n\n// TIMERS Step 1: Global State for Timers\nconst [timers, setTimers] = useState(() => {\n  // Load from local storage (if available)\n  const storedTimers = JSON.parse(localStorage.getItem(\"timers\"));\n  return storedTimers || {\n    seasons: { phase: \"\", endTime: null, type: \"\" },\n    elections: { phase: \"\", endTime: null },\n    train: { phase: \"\", endTime: null },\n    carnival: { phase: \"\", endTime: null },\n    taxes: { phase: \"\", endTime: null },  \n    bank: { phase: \"\", endTime: null },  \n    dungeon: { phase: \"\", endTime: null },  \n  }; \n});\nconst [countdowns, setCountdowns] = useState({ seasons: \"\", elections: \"\", train: \"\", carnival: \"\", taxes: \"\", bank: \"\", dungeon: \"\" });\n\n// TIMERS Step 2: Initialize Timers on app start/refresh; run once\nuseEffect(() => {\n  //console.log(\" currentPlayer = \",currentPlayer);\n\n  if (!currentPlayer?.settlementId) return;\n  const initializeTimers = async () => {\n      await fetchTimersData();\n      console.log(\" Timers initialized:\", timers);\n  };\n  initializeTimers();\n  const interval = setInterval(fetchTimersData, 60 * 1000); //  Refresh every 60s; DO WE NEED THIS??\n  return () => clearInterval(interval);\n}, [currentPlayer]); //  Runs when currentPlayer is updated\n\n// TIMERS Step 3: Fetch initial timers from the server\nconst fetchTimersData = async () => {\n  //console.log(\" Fetching initial timers from the server...\");\n  \n  if (!currentPlayer) { console.warn(\" No player loaded  skipping fetchTimersData.\"); return; }\n  if (!currentPlayer?.settlementId || !currentPlayer?.frontierId) return;\n\n  try {\n    const res = await axios.get(`${API_BASE}/api/get-frontier/${currentPlayer.frontierId}`);\n    const frontierData = res.data;\n    \n    // Check for season override from player settings\n    let seasonType = frontierData.seasons?.seasonType || \"Unknown\";\n    if (currentPlayer?.settings?.seasonOverride && currentPlayer.settings.seasonOverride !== \"None\") {\n      console.log(` Applying season override: ${currentPlayer.settings.seasonOverride} (original: ${seasonType})`);\n      seasonType = currentPlayer.settings.seasonOverride;\n    }\n    \n    const updatedTimers = {\n      seasons: {\n        type: seasonType,\n        phase: frontierData.seasons?.phase || \"Unknown\",\n        endTime: frontierData.seasons?.endTime ? new Date(frontierData.seasons.endTime).getTime() : null,\n      },\n      elections: {\n        phase: frontierData.elections?.phase || \"Unknown\",\n        endTime: frontierData.elections?.endTime ? new Date(frontierData.elections.endTime).getTime() : null,\n      },\n      train: {\n        phase: frontierData.train?.phase || \"Unknown\",\n        endTime: frontierData.train?.endTime ? new Date(frontierData.train.endTime).getTime() : null,\n      },\n      carnival: {\n        phase: frontierData.carnival?.phase || \"Unknown\",\n        endTime: frontierData.carnival?.endTime ? new Date(frontierData.carnival.endTime).getTime() : null,\n      },\n      taxes: {\n        phase: frontierData.taxes?.phase || \"Unknown\",\n        endTime: frontierData.taxes?.endTime ? new Date(frontierData.taxes.endTime).getTime() : null,\n      },\n      bank: {\n        phase: frontierData.bank?.phase || \"Unknown\",\n        endTime: frontierData.bank?.endTime ? new Date(frontierData.bank.endTime).getTime() : null,\n      },\n      dungeon: {\n        phase: frontierData.dungeon?.phase || \"Unknown\",\n        endTime: frontierData.dungeon?.endTime ? new Date(frontierData.dungeon.endTime).getTime() : null,\n      }\n    };\n\n    setTimers(updatedTimers);\n    localStorage.setItem(\"timers\", JSON.stringify(updatedTimers)); // Save to local storage\n    console.log(\" Current Time:\", Date.now());\n    \n  } catch (error) {\n    console.error(\" Error fetching timers data:\", error);\n  }\n};\n\n// TIMERS Step 4: Update countdown timers\nuseEffect(() => {\n  const updateCountdowns = () => {\n    // Guard against uninitialized timers\n    if (!timers || !timers.carnival) {\n      console.log(\"Timers not yet initialized, skipping countdown update\");\n      return;\n    }\n    \n    const now = Date.now(); // Get current timestamp\n\n    setCountdowns({\n      seasons: timers.seasons?.endTime ? formatCountdown(timers.seasons.endTime, now) : \"--:--:--\",\n      elections: timers.elections?.endTime ? formatCountdown(timers.elections.endTime, now) : \"--:--:--\",\n      train: timers.train?.endTime ? formatCountdown(timers.train.endTime, now) : \"--:--:--\",\n      carnival: timers.carnival?.endTime ? formatCountdown(timers.carnival.endTime, now) : \"--:--:--\",\n      taxes: timers.taxes?.endTime ? formatCountdown(timers.taxes.endTime, now) : \"--:--:--\",\n      bank: timers.bank?.endTime ? formatCountdown(timers.bank.endTime, now) : \"--:--:--\",\n      dungeon: timers.dungeon?.endTime ? formatCountdown(timers.dungeon.endTime, now) : \"--:--:--\",\n    });\n  };\n\n  updateCountdowns(); // Run immediately\n  const interval = setInterval(updateCountdowns, 1000); // Update UI every second\n\n  return () => clearInterval(interval); // Cleanup on unmount\n}, [timers]); // Runs when timers update\n\n\n// TIMERS Step 5: Check Phase Transitions (LOCAL)\nuseEffect(() => {\n  const checkPhaseTransitions = async () => {\n    //console.log(\"checkPhaseTransitions;  season = \",timers.seasons.phase);\n    const now = Date.now();\n    let shouldFetchNewTimers = false;\n    // console.log(\" Checking season timer... now =\", new Date(now).toLocaleTimeString(), \n    //   \"| endTime =\", new Date(timers.seasons.endTime).toLocaleTimeString()\n    // );\n    if (timers.seasons.endTime && now >= timers.seasons.endTime) {\n      console.log(\" Season phase ended.\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.elections.endTime && now >= timers.elections.endTime) {\n      console.log(\" Election phase ended. Fetching new election data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.train.endTime && now >= timers.train.endTime) {\n      console.log(\" Train cycle ended. Fetching new train data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.carnival.endTime && now >= timers.carnival.endTime) {\n      console.log(\" Carnival cycle ended. Fetching new carnival data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.taxes.endTime && now >= timers.taxes.endTime) {\n      console.log(\" Tax cycle ended. Fetching new tax data...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.bank.endTime && now >= timers.bank.endTime) {\n      console.log(\" Bank cycle ended. Fetching new bank timer...\");\n      shouldFetchNewTimers = true;\n    }\n    if (timers.dungeon.endTime && now >= timers.dungeon.endTime) {\n      console.log(\" Dungeon phase ended. Transitioning phase...\");\n      \n      // Toggle dungeon phase locally for immediate UI update\n      const newDungeonPhase = timers.dungeon.phase === \"open\" ? \"resetting\" : \"open\";\n      setTimers(prev => ({\n        ...prev,\n        dungeon: {\n          ...prev.dungeon,\n          phase: newDungeonPhase,\n          endTime: null // Will be updated by fetchTimersData\n        }\n      }));\n      \n      // Check if player is in a dungeon and needs to be teleported out\n      // Skip FTUE Cave dungeon - it doesn't use the normal timer system\n      const isInFTUECave = currentPlayerRef.current?.location?.g?.toString() === FTUE_CAVE_GRID_ID;\n      if (newDungeonPhase === \"resetting\" && currentPlayerRef.current?.location?.gtype === \"dungeon\" && !isInFTUECave) {\n        console.log(\" Player is in dungeon during reset phase - teleporting out!\", {\n          timestamp: Date.now(),\n          playerId: currentPlayerRef.current._id,\n          sourceGrid: currentPlayerRef.current.sourceGridBeforeDungeon\n        });\n        handleDungeonAutoExit();\n      }\n      \n      shouldFetchNewTimers = true;\n    }\n    if (shouldFetchNewTimers) {\n      console.log(\" A phase has ended! Fetching updated timers...\");\n      await fetchTimersData();\n      const updatedPhase = JSON.parse(localStorage.getItem(\"timers\"))?.seasons?.phase;\n      if (updatedPhase === \"offSeason\") {\n        setIsOffSeason(true);\n        console.log(\" OffSeason detected immediately after fetch.\");\n      }\n    }\n  };\n\n  if (timers.seasons.phase === \"offSeason\") { \n    setIsOffSeason(true);\n  } else {\n    setIsOffSeason(false); \n  }\n\n  const interval = setInterval(checkPhaseTransitions, 1000); //  Check every 1s\n  return () => clearInterval(interval);\n}, [timers]); // Runs when timers update\n\n\nconst previousPhaseRef = useRef(timers.seasons?.phase);\n\n//  Refresh client when offSeason ends\nuseEffect(() => {\n  const currentPhase = timers.seasons?.phase;\n  if (\n    previousPhaseRef.current === \"offSeason\" &&\n    currentPhase === \"onSeason\"\n  ) {\n    console.warn(\" offSeason ended  forcing full app reload.\");\n    window.location.reload();\n  }\n  previousPhaseRef.current = currentPhase;\n}, [timers.seasons?.phase]);\n\n\n\n/////////// SOCKET LISTENERS /////////////////////////\n\n//  SOCKET LISTENER: Real-time updates for PC join and leave\nuseEffect(() => {\n  socketListenForPCJoinAndLeave(gridId, currentPlayer, isMasterResourcesReady, setPlayersInGrid, controllerUsername, setControllerUsername);\n}, [socket, gridId, isMasterResourcesReady, currentPlayer, controllerUsername]);\n\n//  SOCKET LISTENER: PCs: Real-time updates for GridState (PC sync)\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping PC socket changes.'); return; }\n  socketListenForPCstateChanges(activeTileSize, gridId, currentPlayer, setPlayersInGrid, localPlayerMoveTimestampRef, setConnectedPlayers);\n}, [socket, gridId, currentPlayer]);\n\n//  SOCKET LISTENER: NPCs:  Real-time updates for GridStateNPC snc\nuseEffect(() => {\n  if (!isAppInitialized) { console.log('App not initialized. Skipping NPC socket changes.'); return; }  \n  socketListenForNPCStateChanges(activeTileSize, gridId, setGridState, npcController);\n}, [socket, gridId, isAppInitialized]);\n\n//  SOCKET LISTENER: Real-time updates for resources\nuseEffect(() => {\n  socketListenForResourceChanges(activeTileSize, gridId, isMasterResourcesReady, setResources, masterResources, enrichResourceFromMaster);\n}, [socket, gridId, isMasterResourcesReady]); //  Add isMasterResourcesReady as a dependency\n\n//  SOCKET LISTENER: Real-time updates for tiles\nuseEffect(() => {\n  socketListenForTileChanges(gridId, setTileTypes, mergeTiles);\n}, [socket, gridId]);\n\n// Add socket event listeners for NPC controller status\nuseEffect(() => {\n  socketListenForNPCControllerStatus(gridId, currentPlayer, setControllerUsername);\n}, [socket, gridId, currentPlayer]);\n\n//  SOCKET LISTENER: Force refresh on season reset\nuseEffect(() => {\n  socketListenForSeasonReset();\n}, [socket]);\n\nuseEffect(() => {\n  if (!socket || !currentPlayer || !gridId) return;\n  socketListenForConnectAndDisconnect(gridId, currentPlayer, setIsSocketConnected);\n}, [socket, currentPlayer, gridId]);\n\nuseEffect(() => {\n  if (!socket || !gridId) return;\n  const cleanup = socketListenForPlayerConnectedAndDisconnected(gridId, setConnectedPlayers);\n  return cleanup;\n}, [socket, gridId]);\n\n//  SOCKET LISTENER: Real-time updates for mailbox badge\nuseEffect(() => {\n  if (!socket || !currentPlayer?.playerId) return;\n  const cleanup = socketListenForBadgeUpdates(currentPlayer, setBadgeState, updateBadge);\n  return cleanup;\n}, [socket, currentPlayer]);\n\n//  SOCKET LISTENER: Real-time chat messages\nuseEffect(() => {\n  if (!socket || !currentPlayer) return;\n  const cleanup = socketListenForChatMessages(setChatMessages); //  Must pass correct setter\n  return cleanup;\n}, [socket, currentPlayer]);\n\n\n/////////// HANDLE ZOOMING & RESIZING /////////////////////////\n\nconst zoomIn = async () => {\n  const gridId = currentPlayer?.location?.g;\n  if (!gridId || !currentPlayer?._id) { console.warn(\"No valid gridId or playerId found for currentPlayer.\"); return; }\n  const playerIdStr = String(currentPlayer._id);\n  const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n  if (currentPlayer.iscamping) { updateStatus(32); return; }\n  \n  if (zoomLevel === 'frontier') {\n    setZoomLevel('settlement'); // Zoom into the settlement view\n    updateStatus(12); // \"Settlement view.\"\n  } else if (zoomLevel === 'settlement') {\n    centerCameraOnPlayerFast(playerPos, TILE_SIZES.far); \n    setZoomLevel('far'); // Zoom into the grid view\n    const { username, gridType } = await fetchHomesteadOwner(gridId);\n\n    if (gridType === 'town') {\n      updateStatus(14);\n    } else if ([\"valley0\", 'valley1', 'valley2', 'valley3'].includes(gridType)) {\n      updateStatus(16);\n    } else if (gridType === 'homestead') {\n      if (username) {\n        await updateGridStatus(gridType, username, updateStatus, currentPlayer, currentPlayer.location.g);\n      } else {\n        updateStatus('This homestead is unoccupied.');\n      }\n    } else {\n      console.warn(`Unexpected gridType: ${gridType}`);\n      updateStatus('Unknown location.');\n    }\n\n  } else if (zoomLevel === 'far') {\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.close);\n    }, 50); // Allow brief render before scrolling\n    setZoomLevel('close'); // Zoom into a detailed view\n  } else if (zoomLevel === 'close') {\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.closer);\n    }, 50); // Allow brief render before scrolling\n    setZoomLevel('closer');\n  }\n};\n\nconst zoomOut = () => {\n  const gridId = currentPlayer?.location?.g;\n  if (!gridId || !currentPlayer?._id) { console.warn(\"No valid gridId or playerId found for currentPlayer.\"); return; }\n  const playerIdStr = String(currentPlayer._id);\n  const playerPos = playersInGrid?.[gridId]?.pcs?.[playerIdStr]?.position;\n\n  if (currentPlayer.iscamping) { updateStatus(32); return; }\n  if (zoomLevel === 'closer') {\n    setZoomLevel('close');\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.close);\n    }, 50); // Allow brief render before scrolling\n  } else if (zoomLevel === 'close') {\n    setZoomLevel('far'); // Zoom out to grid view\n    setTimeout(() => {\n      centerCameraOnPlayerFast(playerPos, TILE_SIZES.far);\n    }, 50); // Allow brief render before scrolling\n  } else if (zoomLevel === 'far') {\n    setZoomLevel('settlement'); // Zoom out to settlement view\n    updateStatus(12); // \"Settlement view.\"\n  } else if (zoomLevel === 'settlement') {\n    setZoomLevel('frontier'); // Zoom out to frontier view\n    updateStatus(13); // \"Frontier view.\"\n  }\n};\n\n/////////// HANDLE KEY MOVEMENT /////////////////////////\n\nconst localPlayerMoveTimestampRef = useRef(0);\nconst currentPlayerRef = useRef(currentPlayer);\nconst isDungeonExitInProgress = useRef(false);\n\n// Keep currentPlayerRef updated\nuseEffect(() => {\n  currentPlayerRef.current = currentPlayer;\n  if (currentPlayer?.sourceGridBeforeDungeon) {\n    console.log(\" Player sourceGridBeforeDungeon updated:\", currentPlayer.sourceGridBeforeDungeon);\n  }\n}, [currentPlayer]);\n\nuseEffect(() => {\n  const handleKeyDown = (event) => {\n    if (activeModal) { return; } // Keyboard input disabled while modal is open\n    if (isOffSeason) { return; } // Keyboard input disabled while offseason\n\n    // Handle zoom shortcuts (work at any zoom level)\n    if (event.key === '-' || event.key === '_') {\n      zoomOut();\n      event.preventDefault();\n      return;\n    }\n    if (event.key === '=' || event.key === '+') {\n      zoomIn();\n      event.preventDefault();\n      return;\n    }\n\n    // Handle Escape key to clear cursor mode (plant/terraform with cursor)\n    if (event.key === 'Escape') {\n      setCursorMode(null);\n      event.preventDefault();\n      return;\n    }\n\n    if (zoomLevel === 'frontier' || zoomLevel === 'settlement') { return; }  // Prevent input if zoomed out\n    const activeElement = document.activeElement;\n    if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) { return; } // Prevent movement if a text input is focused\n    \n    // Handle inventory shortcut\n    if (event.key === 'i' || event.key === 'I') {\n      if (currentPlayer) {\n        openPanel('InventoryPanel');\n        event.preventDefault();\n      }\n      return;\n    }\n    \n    if ([\"ArrowUp\", \"ArrowDown\", \"ArrowLeft\", \"ArrowRight\"].includes(event.key)) { event.preventDefault(); }  // Prevent the browser from scrolling when using arrow keys\n\n    handleMovementKeyDown(event, currentPlayer, activeTileSize, masterResources,\n        setCurrentPlayer, \n        setGridId, \n        setGrid, \n        setTileTypes, \n        setResources, \n        updateStatus, \n        closeAllPanels,\n        localPlayerMoveTimestampRef,\n        bulkOperationContext,\n        strings,\n        transitionFadeControl\n    );\n  };\n  \n  const handleKeyUp = (event) => {\n    // Handle key release for diagonal movement\n    handleMovementKeyUp(event);\n  };\n  \n  window.addEventListener('keydown', handleKeyDown); \n  window.addEventListener('keyup', handleKeyUp);\n  return () => {\n    window.removeEventListener('keydown', handleKeyDown); \n    window.removeEventListener('keyup', handleKeyUp);\n  };\n}, [currentPlayer, masterResources, activeTileSize, activeModal, zoomLevel]);\n\n\n\n//////////// HANDLE CLICKING /////////////////////////\n\nlet isProcessing = false; // Guard against duplicate clicks\n\nconst handleTileClick = useCallback(async (rowIndex, colIndex) => {\n  if (isProcessing) return; // Skip if still processing\n  isProcessing = true;\n\n  // Check if player is on their own homestead (no range restrictions there)\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n\n  // Get player position for range checks\n  const playerPos = playersInGridManager.getPlayerPosition(gridId, String(currentPlayer?._id));\n  const targetPos = { x: colIndex, y: rowIndex };\n\n  // Helper to check if target is in range (used by cursor mode handlers)\n  const isInRange = () => {\n    if (isOnOwnHomestead) return true; // No range restriction on own homestead\n    if (!playerPos) return false;\n    const distance = calculateDistance(playerPos, targetPos);\n    const playerRange = getDerivedRange(currentPlayer, masterResources);\n    return distance <= playerRange;\n  };\n\n  // Handle cursor mode (e.g., planting with cursor)\n  if (cursorMode?.type === 'plant' && cursorMode.item) {\n    // Range check for cursor placement (skipped on own homestead)\n    if (!isInRange()) {\n      FloatingTextManager.addFloatingText(24, targetPos.x, targetPos.y, activeTileSize);\n      isProcessing = false;\n      return;\n    }\n    const { handleFarmPlotPlacement } = await import('./GameFeatures/Farming/Farming');\n    await handleFarmPlotPlacement({\n      selectedItem: cursorMode.item,\n      TILE_SIZE: activeTileSize,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      gridId,\n      masterResources,\n      masterSkills,\n      updateStatus,\n      overridePosition: { x: colIndex, y: rowIndex }, // Plant at clicked tile, not player position\n    });\n    isProcessing = false;\n    return;\n  }\n\n  // Handle terraform cursor mode (supports both tileType and legacy actionType)\n  if (cursorMode?.type === 'terraform' && (cursorMode.tileType || cursorMode.actionType)) {\n    // Range check for cursor placement (skipped on own homestead)\n    if (!isInRange()) {\n      FloatingTextManager.addFloatingText(24, targetPos.x, targetPos.y, activeTileSize);\n      isProcessing = false;\n      return;\n    }\n    const { handleTerraform } = await import('./GameFeatures/Farming/Farming');\n    await handleTerraform({\n      TILE_SIZE: activeTileSize,\n      tileType: cursorMode.tileType, // New: direct tile type\n      actionType: cursorMode.actionType, // Legacy: action type mapping\n      gridId,\n      currentPlayer,\n      tileTypes,\n      setTileTypes,\n      overridePosition: { x: colIndex, y: rowIndex }, // Terraform at clicked tile\n      isDeveloper,\n    });\n    isProcessing = false;\n    return;\n  }\n\n  // Handle build cursor mode (Build, Buy, BuyDeco, and Pets panels)\n  if (cursorMode?.type === 'build' && cursorMode.item && cursorMode.buildOptions) {\n    // Range check for cursor placement (skipped on own homestead)\n    if (!isInRange()) {\n      FloatingTextManager.addFloatingText(24, targetPos.x, targetPos.y, activeTileSize);\n      isProcessing = false;\n      return;\n    }\n    const { handleConstruction } = await import('./GameFeatures/BuildAndBuy');\n    await handleConstruction({\n      TILE_SIZE: activeTileSize,\n      selectedItem: cursorMode.item,\n      buildOptions: cursorMode.buildOptions,\n      inventory,\n      setInventory,\n      backpack,\n      setBackpack,\n      resources,\n      setResources,\n      currentPlayer,\n      setCurrentPlayer,\n      gridId,\n      updateStatus,\n      overridePosition: { x: colIndex, y: rowIndex }, // Build at clicked tile\n    });\n    isProcessing = false;\n    return;\n  }\n\n  // Find resource including multi-tile resources\n  const resource = resources.find((res) => {\n    const range = res.range || 1;\n    // Check if the clicked tile falls within the resource's range\n    // Resource is anchored at lower-left (res.x, res.y)\n    return colIndex >= res.x && colIndex < res.x + range &&\n           rowIndex <= res.y && rowIndex > res.y - range;\n  });\n  console.log(' handleTileClick invoked with:', { rowIndex, colIndex, resource });\n\n  //  Prevent interaction on another player's homestead\n  if (resource && currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {\n    const isFriend = false; //  Future: replace with actual friend-checking logic\n    const alwaysBlocked = ['Mailbox', 'Trade Stall', 'Warehouse'];\n    const isForbiddenStation = resource?.category === 'station' && alwaysBlocked.includes(resource?.type);\n    const isSafe = resource?.category === 'npc' || resource?.category === 'travel'; // Expand as needed\n    if (isForbiddenStation || (!isSafe && !isFriend)) {\n      console.warn(\" Blocked interaction on another player's homestead.\");\n      updateStatus(90);\n      isProcessing = false;\n      return;\n    }\n  }\n\n  // Validate `gridId` and `username`\n  if (!gridId || typeof gridId !== 'string') { console.error('Invalid gridId:', gridId); return; }\n  if (!currentPlayer?.username || typeof currentPlayer.username !== 'string') { console.error('Invalid username:', currentPlayer?.username); return; }\n  if (!currentPlayer?._id) { console.error('No player ID found'); return; }\n  if (!playerPos || typeof playerPos.x === 'undefined' || typeof playerPos.y === 'undefined') {\n      console.error(\" Player position is invalid in NPCsInGrid; playerPos: \", playerPos);\n      isProcessing = false;\n      return;\n  }\n  // If clicking a resource, check range before interacting (except NPCs, and skip on own homestead)\n  if (resource && resource.category !== 'npc' && !isOnOwnHomestead) {\n    const distance = calculateDistance(playerPos, targetPos);\n    const playerRange = getDerivedRange(currentPlayer, masterResources);\n    if (distance > playerRange) {\n      FloatingTextManager.addFloatingText(24, targetPos.x, targetPos.y, activeTileSize);\n      isProcessing = false;\n      return;\n    }\n    \n    // Check for walls blocking line of sight\n    if (isWallBlocking(playerPos, targetPos)) {\n      FloatingTextManager.addFloatingText(40, targetPos.x, targetPos.y, activeTileSize); // string[40] for wall blocking\n      console.log('Wall blocking interaction from player to resource');\n      isProcessing = false;\n      return;\n    }\n  }\n  if (resource) {\n    console.log('App.js: Resource clicked:', resource);\n    if (resource.category === 'npc') { } // handled in RenderDynamic\n    else if (resource.category === 'travel') {\n      // Check if any bulk operation is active\n      if (bulkOperationContext?.isAnyBulkOperationActive?.()) {\n        const activeOps = bulkOperationContext.getActiveBulkOperations();\n        updateStatus(470);\n        return;\n      }\n      \n      // Handle dungeon-related signposts specially\n      if (resource.type === 'Dungeon Entrance') {\n        console.log(' Dungeon entrance clicked in App.js');\n        \n        // Check if we have dungeon phase data\n        if (!timers?.dungeon) {\n          console.warn('No dungeon phase data available');\n          updateStatus(\"Unable to access dungeon information\");\n          return;\n        }\n        \n        // Determine actual phase based on whether timer has expired\n        let actualPhase = timers.dungeon.phase;\n        if (timers.dungeon.endTime) {\n          const now = Date.now();\n          const endTime = timers.dungeon.endTime;\n          \n          // If current time is past the end time, phase has switched\n          if (now >= endTime) {\n            // Timer expired - phase should switch\n            actualPhase = timers.dungeon.phase === 'open' ? 'resetting' : 'open';\n            console.log(` Timer expired - actual phase is ${actualPhase} (server still shows ${timers.dungeon.phase})`);\n          }\n        }\n        \n        const { handleDungeonEntrance } = await import('./GameFeatures/Dungeon/Dungeon');\n        await handleDungeonEntrance(\n          currentPlayer,\n          actualPhase,\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          updateStatus,\n          activeTileSize,\n          closeAllPanels,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies,\n          transitionFadeControl,\n          { x: resource.x * activeTileSize, y: resource.y * activeTileSize }\n        );\n      } else if (resource.type === 'Dungeon Exit') {\n        console.log(' Dungeon exit clicked in App.js');\n        \n        const { handleDungeonExit } = await import('./GameFeatures/Dungeon/Dungeon');\n        await handleDungeonExit(\n          currentPlayer,\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          updateStatus,\n          activeTileSize,\n          closeAllPanels,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies,\n          transitionFadeControl\n        );\n      } else {\n        // Handle regular signposts\n        const { handleTransitSignpost } = await import('./GameFeatures/Transit/Transit');\n        await handleTransitSignpost(\n          currentPlayer,\n          resource.type,\n          setCurrentPlayer,\n          setGridId,\n          setGrid,\n          setTileTypes,\n          setResources,\n          updateStatus,\n          activeTileSize,\n          currentPlayer.skills,\n          closeAllPanels,\n          bulkOperationContext,\n          masterResources,\n          strings,\n          masterTrophies,\n          transitionFadeControl\n        );\n      }\n    }\n    else if (resource.category === 'training' || resource.category === 'trainingAndShop') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, category: resource.category });\n      openPanel('SkillsPanel');\n    }\n    else if (resource.category === 'crafting') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      switch (resource.type) {\n        case 'Ancient Temple':\n          openPanel('ScrollStation'); \n          break;\n        default:\n          openPanel('CraftingStation');\n          break;\n      }\n    } \n    else if (resource.category === 'farmhouse') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('FarmHouse');\n    } \n    else if (resource.category === 'shop') {\n      setActiveStation({type: resource.type,position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('ShopStation');\n    } \n    else if (resource.category === 'stall') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('AnimalStall');\n    } \n    else if (resource.category === 'farmplot') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, resource: resource });\n      openPanel('CropPanel');\n    } \n    else if (resource.category === 'deco') {\n      // If it's a door, also show access feedback\n      if (resource.action === 'door') {\n        const { handleDoorClick } = await import('./GameFeatures/Doors/Doors');\n        handleDoorClick(resource, currentPlayer, activeTileSize, updateStatus, strings);\n      }\n      \n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('DecoPanel');\n    } \n    else if (resource.category === 'pet') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      openPanel('PetPanel');\n    } \n    else if (resource.category === 'station') {\n      setActiveStation({type: resource.type, position: { x: resource.x, y: resource.y }, gridId: gridId, });\n      switch (resource.type) {\n        case 'Courthouse':\n          openPanel('Courthouse'); break;\n        case 'Trade Stall':\n        case 'Trade':\n        case 'Trading Post':\n          openPanel('TradeStall'); \n          break;\n        case 'Outpost':\n          openPanel('OutpostPanel'); \n          break;\n        case 'Mailbox':\n          openModal('Mailbox'); break;\n        case 'Warehouse':\n          openPanel('WarehousePanel'); break;\n        case 'Train':\n//          openPanel('TrainPanel'); break;\n          openPanel('NewTrainPanel'); break;\n        case 'Carnival':\n          openPanel('CarnivalPanel'); break;\n        case 'Bank':\n          openPanel('BankPanel'); break;\n        case 'Worker Slot':\n          // Find the Farm House on the grid\n          const farmHouse = resources.find(res => res.type === 'Farm House' && res.category === 'farmhouse');\n          if (farmHouse) {\n            // Set the Farm House as the active station\n            setActiveStation({\n              type: 'Farm House', \n              position: { x: farmHouse.x, y: farmHouse.y }, \n              gridId: gridId\n            });\n            openPanel('FarmHouse');\n          } else {\n            console.warn('Farm House not found on grid');\n            updateStatus('Farm House not found');\n          }\n          break;\n        default:\n          console.warn(`Unhandled station type: ${resource.type}`);\n      }\n    } else {\n      // Pass to handleResourceClick for all other resources\n      // Use resource's anchor position for multi-tile resources\n      handleResourceClick(\n        resource,\n        resource.y,  // Use resource's actual y position\n        resource.x,  // Use resource's actual x position\n        resources,\n        setResources,\n        setInventory,\n        setBackpack,\n        inventory,\n        backpack,\n        FloatingTextManager.addFloatingText,\n        gridId,\n        activeTileSize,\n        tileTypes,\n        currentPlayer,\n        setCurrentPlayer,\n        setGridId,\n        setGrid,\n        setTileTypes,\n        updateStatus,\n        masterResources,\n        masterSkills,\n        setModalContent,\n        setIsModalOpen,\n        closeAllPanels,\n        strings,\n        bulkOperationContext,\n        openPanel,\n        masterTrophies,\n        globalTuning,\n        transitionFadeControl,\n        timers\n      ).finally(() => {\n        isProcessing = false; // Reset flag after processing\n      });\n    }\n  } else {\n    console.log('isTeleportEnabled:', currentPlayer?.settings?.isTeleportEnabled);\n  \n    if (currentPlayer?.settings?.isTeleportEnabled) {\n      const targetPosition = { x: colIndex, y: rowIndex };\n      console.log(' Player teleporting to grid position:', targetPosition);\n  \n      // Update currentPlayer state\n      const updatedPlayer = {\n        ...currentPlayer,\n        position: targetPosition\n      };\n      setCurrentPlayer(updatedPlayer);\n      localStorage.setItem('player', JSON.stringify(updatedPlayer));\n  \n      // Multiplayer sync  update PC in grid\n      if (currentPlayer?._id) {\n        playersInGridManager.updatePC(gridId, currentPlayer._id, {\n          position: targetPosition\n        });\n      }\n    }\n  }\n  isProcessing = false; // Reset flag here\n\n}, [resources, gridId, inventory, currentPlayer, playerPosition, activeTileSize, cursorMode]);\n  \n\n  \n//////////// HANDLE LOGIN and LOGOUT /////////////////////////\n\nconst handleLogout = () => {\n  console.log('Logging out user...');\n  NPCsInGridManager.stopGridStateUpdates();  // Clear all states\n  setCurrentPlayer(null);\n  setInventory({});\n  setPlayerPosition({ x: 0, y: 0 });\n  setGrid([]); // Clear the grid\n  setResources([]); // Clear resources\n  setTileTypes([]); // Clear tile types\n  setGridId(null); // Clear gridId\n  localStorage.removeItem('gridId'); // Remove gridId from local storage\n  localStorage.removeItem('player');  // Remove player data from local storage\n  window.location.reload();  // Force a state reset by triggering the login modal\n  console.log('Player has logged out, and state has been reset.');\n};\n\nconst handleLoginSuccess = async (player) => {\n  console.log('Handling login success for player:', player);  // Store player data in localStorage\n  localStorage.setItem('player', JSON.stringify(player));  // Reload the app (triggers full initialization)\n  window.location.reload();\n};\n\n\n  /////////////// HANDLE INACTIVITY for controller relinquishment and refresh //////////////\n\n  useEffect(() => {\n    let lastActivity = Date.now();\n    const INACTIVITY_LIMIT = 15 * 60 * 1000; // 15 minutes\n    const REFRESH_TIMEOUT = 20 * 60 * 1000; // 20 minutes\n    const updateActivity = () => { lastActivity = Date.now(); };\n\n    const checkStaleness = () => {\n      const now = Date.now();\n      const inactiveTime = now - lastActivity;\n      if (inactiveTime >= REFRESH_TIMEOUT) {\n        console.warn(' Inactive too long. Showing refresh modal.');\n        setModalContent({\n          title: strings[\"70\"],\n          message: strings[\"71\"],\n          message2: strings[\"72\"],\n          size: \"small\",\n          onClose: () => setIsModalOpen(false),\n          children: (\n            <div style={{ display: 'flex', gap: '10px', justifyContent: 'center', marginTop: '10px' }}>\n              <div className=\"shared-buttons\">\n                <button\n                  className=\"btn-basic btn-success\"\n                  onClick={() => {\n                    setIsModalOpen(false);\n                    window.location.reload();\n                  }}\n                >\n                  {strings[\"73\"]}\n                </button>\n              </div>\n            </div>\n          ),\n        });\n        setIsModalOpen(true);\n\n        // Set a backup auto-refresh after 30 seconds\n        setTimeout(() => {\n          console.warn(\" Auto-refreshing due to inactivity...\");\n          window.location.reload();\n        }, 30000);\n\n      } else if (inactiveTime >= INACTIVITY_LIMIT) {\n        console.warn(' Inactive for a while. Releasing controller role.');\n        if (controllerUsername === currentPlayer?.username) {\n          socket.emit('relinquish-npc-controller', { gridId });\n        }\n      }\n    };\n\n    window.addEventListener('mousemove', updateActivity);\n    window.addEventListener('keydown', updateActivity);\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'visible') {\n        // When tab becomes visible, check if we've been inactive too long BEFORE updating activity\n        const now = Date.now();\n        const inactiveTime = now - lastActivity;\n        console.log(` Tab became visible. Inactive for ${Math.floor(inactiveTime / 60000)} minutes`);\n        \n        // Check staleness FIRST before updating activity\n        if (inactiveTime >= REFRESH_TIMEOUT) {\n          console.warn(' Was inactive too long while tab was hidden. Showing refresh modal.');\n          checkStaleness();\n          // Don't update activity - let the modal show\n          return;\n        }\n        \n        // Only update activity if we haven't exceeded timeout\n        updateActivity();\n      }\n    });\n\n    const interval = setInterval(checkStaleness, 60000); // check every minute\n\n    return () => {\n      window.removeEventListener('mousemove', updateActivity);\n      window.removeEventListener('keydown', updateActivity);\n      clearInterval(interval);\n    };\n  }, [currentPlayer, controllerUsername, gridId]);\n\n\n  ///////////////// FOR THE PANELS:\n\n  const [showTimers, setShowTimers] = useState(false);\n  const [showStats, setShowStats] = useState(false); // Toggle for combat stats UI\n  const isOnOwnHomestead = currentPlayer?.gridId === currentPlayer?.location?.g;\n\n  // Chat panel slideout state\n  const [isChatOpen, setIsChatOpen] = useState(false);\n  const [isChatClosing, setIsChatClosing] = useState(false);\n  \n  const handleCloseChat = () => {\n    setIsChatClosing(true);\n    setTimeout(() => {\n      setIsChatOpen(false);\n      setIsChatClosing(false);\n    }, 300); // Match the animation duration\n  };\n\n\n  ///////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////\n  /////////////// RENDERING THE APP /////////////////////////\n  ///////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////\n\n  // Extract NPCs and PCs for the current grid (only when rendering game board)\n  const npcs = React.useMemo(() => {\n    if (zoomLevel === 'far' || zoomLevel === 'closer' || zoomLevel === 'close') {\n      const npcArray = Object.values(NPCsInGrid?.[gridId]?.npcs || {});\n      return npcArray;\n    }\n    return [];\n  }, [NPCsInGrid, gridId, zoomLevel]);\n  \n  const pcs = Object.values(playersInGrid?.[gridId]?.pcs || {});\n\n\nreturn (\n    <>\n    {showRedirect && <Redirect />}\n    <FloatingTextManager />\n\n{/* //////////////////////  Header  //////////////////////// */}\n\n    <header className=\"app-header\">\n\n        <div className=\"header-title\">\n          <h1>{strings[0]}</h1>\n        </div>\n\n        <div className=\"header-controls-left header-grid\">\n          {/* Grid layout: 3 columns x 2 rows */}\n          {/* Row 1 */}\n          <button className=\"header-link\" onClick={() => {\n            if (currentPlayer) {\n              const currentPC = {\n                playerId: currentPlayer._id,\n                username: currentPlayer.username,\n                icon: currentPlayer.icon,\n                hp: currentPlayer.hp || 100,\n                position: { x: 0, y: 0 },\n                iscamping: currentPlayer.iscamping,\n                isinboat: currentPlayer.isinboat\n              };\n              handlePCClick(currentPC);\n            }\n          }}>\n            {currentPlayer?.icon || ''} {currentPlayer?.username || 'Loading...'}\n          </button>\n\n\n          <span className=\"header-link\" style={{ textDecoration: 'none', cursor: 'default' }}>\n            {strings[10150]} {getDerivedLevel(currentPlayer, masterXPLevels)}\n          </span>\n          <button className=\"header-link\" disabled={!currentPlayer} onClick={() => openPanel('InventoryPanel')}>\n            {strings[10103]}\n          </button>\n          {/* Row 2 */}\n          <span></span>\n          <span className=\"header-link\" style={{ textDecoration: 'none', cursor: 'default' }}>\n            {strings[10112]} {currentPlayer?._id ? playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)]?.hp ?? \"?\" : \"?\"}/{currentPlayer?._id ? playersInGrid?.[gridId]?.pcs?.[String(currentPlayer._id)]?.maxhp ?? \"?\" : \"?\"}\n          </span>\n          <div className=\"header-currency-group\">\n            <button className=\"header-link\" onClick={() => openPanel('HowToGemsPanel')}>\n               {Array.isArray(currentPlayer?.inventory)\n                ? (currentPlayer.inventory.find((item) => item.type === \"Gem\")?.quantity || 0).toLocaleString()\n                : \"...\"}\n            </button>\n            <button className=\"header-link\" onClick={() => openPanel('HowToMoneyPanel')}>\n               {Array.isArray(currentPlayer?.inventory)\n                ? (currentPlayer.inventory.find((item) => item.type === \"Money\")?.quantity || 0).toLocaleString()\n                : \"...\"}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"header-controls-center\">\n          {/* Row 1: Store */}\n          <div className=\"header-row\">\n            <div className=\"header-link-wrapper\">\n              <button className=\"header-link\" disabled={!currentPlayer} onClick={() => setActiveModal(\"Store\")}>\n                {strings[10104]}\n              </button>\n              {badgeState.store && <div className=\"badge-dot\" />}\n            </div>\n          </div>\n          {/* Row 2: Inbox */}\n          <div className=\"header-row\">\n            <div className=\"header-link-wrapper\">\n              {badgeState.mailbox && <div className=\"badge-dot badge-dot-left\" />}\n              <button className=\"header-link\" disabled={!currentPlayer} onClick={() => openModal('Mailbox')}>\n                {strings[10105]}\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"header-controls-right header-grid-right\">\n          {/* Grid layout: 3 columns x 2 rows */}\n          {/* Row 1: Settings, Chat, (empty) */}\n          <button className=\"header-link\" onClick={() => openPanel('ProfilePanel')}>\n            {strings[1190]}\n          </button>\n          <div className=\"header-link-wrapper\">\n            <button className=\"header-link\" disabled={!currentPlayer} onClick={() => setIsChatOpen(prev => !prev)}>\n              {strings[10107]}\n            </button>\n            {badgeState.chat && <div className=\"badge-dot\" />}\n          </div>\n          <span></span>\n          {/* Row 2: Leaders, Language, Share */}\n          <button className=\"header-link\" disabled={!currentPlayer} onClick={() => openPanel('LeaderboardPanel')}>\n            {strings[1140]}\n          </button>\n          <button className=\"header-link\" disabled={!currentPlayer} onClick={() => setActiveModal('LanguagePicker')}>\n             {LANGUAGE_OPTIONS.find(l => l.code === currentPlayer?.language)?.label || 'Language'}\n          </button>\n          <button className=\"header-link\" onClick={() => setShowShareModal(true)}>\n            {strings[10106]}\n          </button>\n        </div>\n    </header>\n    \n    <div className=\"status-bar-wrapper\"> <StatusBar /> </div>\n\n    {/* Chat Slideout Panel */}\n    {isChatOpen && currentPlayer && (\n      <div className={`chat-panel-slideout ${isChatClosing ? 'closing' : ''}`}>\n        <Chat\n          currentGridId={currentPlayer.location?.g}\n          currentSettlementId={currentPlayer.location?.s}\n          currentFrontierId={currentPlayer.frontierId}\n          currentPlayer={currentPlayer}\n          onClose={handleCloseChat}\n        />\n      </div>\n    )}\n\n\n{/* //////////////// Left Side Navigation Column ///////////////// */}\n\n    <div className=\"nav-column\">\n\n        <div className=\"zoom-controls\">\n          <div className=\"zoom-button-container\">\n            <button className=\"zoom-button zoom-in\" disabled={!currentPlayer} onClick={zoomIn}><span>+</span></button>\n            <button className=\"zoom-button zoom-out\" disabled={!currentPlayer} onClick={zoomOut}><span></span></button>\n          </div>\n        </div>\n\n      <button className={`nav-button ${!activePanel ? 'selected' : ''}`} title={strings[12009]} onClick={() => closePanel()}></button>\n      <button \n        className={`nav-button ${activePanel === 'SocialPanel' ? 'selected' : ''}`} \n        title=\"My Profile\" \n        disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer) {\n            // Create PC data structure for current player to pass to SocialPanel\n            const currentPC = {\n              playerId: currentPlayer._id,\n              username: currentPlayer.username,\n              icon: currentPlayer.icon,\n              hp: currentPlayer.hp || 100,\n              position: { x: 0, y: 0 }, // Position not needed for own profile\n              iscamping: currentPlayer.iscamping,\n              isinboat: currentPlayer.isinboat\n            };\n            handlePCClick(currentPC);\n          }\n        }}\n      >{currentPlayer?.icon || ''}</button>\n      <button className={`nav-button ${activePanel === 'QuestPanel' ? 'selected' : ''}`} title={strings[12004]} disabled={!currentPlayer} onClick={() => openPanel('QuestPanel')}></button>\n\n      <button \n        className={`nav-button ${activePanel === 'FarmingPanel' ? 'selected' : ''}`} title={strings[12001]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('FarmingPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'ToolsPanel' ? 'selected' : ''}`} title={strings[12012]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead) {updateStatus(90);return;}\n          openPanel('ToolsPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'BuyPanel' ? 'selected' : ''}`} title={strings[12003]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('BuyPanel');\n        }}\n      ></button>\n      <button \n        className={`nav-button ${activePanel === 'BuildPanel' ? 'selected' : ''}`} title={strings[12002]} disabled={!currentPlayer} \n        onClick={() => {\n          if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n          if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n          openPanel('BuildPanel');\n        }}\n      ></button>\n      <button className={`nav-button ${activePanel === 'SkillsPanel' ? 'selected' : ''}`} title={strings[12005]} disabled={!currentPlayer} onClick={() => {\n          setActiveStation(null); //  Reset activeStation\n          openPanel(\"SkillsPanel\"); //  Open the panel normally\n        }}></button>\n\n      {!currentPlayer?.firsttimeuser && isOnOwnHomestead && (\n        <button \n          className={`nav-button ${activePanel === 'PetsPanel' ? 'selected' : ''}`} title={strings[12014]} disabled={!currentPlayer} \n          onClick={() => {\n            if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n            if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n            openPanel('PetsPanel');\n          }}\n        ></button>\n      )}\n\n      {!currentPlayer?.firsttimeuser && (\n        <button \n          className={`nav-button ${activePanel === 'BuyDecoPanel' ? 'selected' : ''}`} title={strings[12011]} disabled={!currentPlayer} \n          onClick={() => {\n            if (currentPlayer.iscamping || currentPlayer.isinboat) {updateStatus(340);return;}\n            // Check if on another player's homestead\n            if (currentPlayer?.location?.gtype === 'homestead' && !isOnOwnHomestead && !isDeveloper) {updateStatus(90);return;}\n            openPanel('BuyDecoPanel');\n          }}\n        ></button>\n      )}\n\n      <button className={`nav-button ${activePanel === 'CombatPanel' ? 'selected' : ''}`} title={strings[12006]} disabled={!currentPlayer} onClick={() => openPanel('CombatPanel')}></button>\n\n      {!currentPlayer?.firsttimeuser && (\n        <button className={`nav-button ${activePanel === 'GovPanel' ? 'selected' : ''}`} title={strings[12007]} onClick={() => openPanel('GovPanel')}></button>\n      )}\n\n      <button className={`nav-button ${activePanel === 'TrophyPanel' ? 'selected' : ''}`} title={strings[12013]} onClick={() => openPanel('TrophyPanel')}></button>\n\n      {isDeveloper && (\n        <button className={`nav-button ${activePanel === 'DebugPanel' ? 'selected' : ''}`} title=\"Debug\" onClick={() => openPanel('DebugPanel')}>\n          \n        </button>\n      )}\n    </div>\n\n    <div className=\"app-container\">\n\n\n{/* ///////////////////  Base Panel  ///////////////////// */}\n\n    <div className=\"base-panel\">\n      <div className=\"base-panel-content\">\n\n      {/* Frontier Mini Map */}\n      <FrontierMiniMap \n        currentPlayer={currentPlayer} \n        strings={strings}\n        setCurrentPlayer={setCurrentPlayer}\n        setGridId={setGridId}\n        setGrid={setGrid}\n        setTileTypes={setTileTypes}\n        setResources={setResources}\n        updateStatus={updateStatus}\n        TILE_SIZE={activeTileSize}\n        closeAllPanels={closeAllPanels}\n        bulkOperationContext={bulkOperationContext}\n        masterResources={masterResources}\n        masterTrophies={masterTrophies}\n        transitionFadeControl={transitionFadeControl}\n        timers={timers}\n        countdowns={countdowns}\n      />\n \n      <h2 style={{ textAlign: 'center' }}>{strings[10109]}</h2>\n      <h3 style={{ textAlign: 'center' }}>{strings[10135]}</h3>\n      <h3 style={{ textAlign: 'center' }}>{strings[10136]}</h3>\n      <h3 style={{ textAlign: 'center' }}>{strings[10137]}</h3>\n      <h3 style={{ textAlign: 'center' }}>{isOnOwnHomestead ? strings[10140] : strings[10141]}</h3>\n\n      <br />\n\n      {/* Season */}\n      <h2 style={{ textAlign: 'center', fontFamily: 'Berkshire Swash', color: 'var(--color-primary-green-dark)', margin: '0 0 4px 0' }}>\n        {strings[10113]} {seasonData?.type || \"[Season unknown]\"}\n      </h2>\n      <h2 style={{ margin: '0 0 8px 0', textAlign: 'center' }}>\n        <span\n          onClick={() => openPanel('SeasonPanel')}\n          style={{ textDecoration: 'underline', cursor: 'pointer' }}\n        >\n          {timers.seasons.phase === \"onSeason\" ? strings[10114] : strings[10115]}\n        </span>\n      </h2>\n      <h2 className=\"countdown-timer\" style={{ textAlign: 'center' }}>{countdowns.seasons}</h2>\n\n      <br />\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openModal('TownNews')}>{strings[10125]}</button>\n      </div>\n\n      <div className=\"shared-buttons\">\n        <button className=\"btn-basic\" onClick={() => openPanel('HowToPanel')}>{strings[10110]}</button>\n      </div>\n      \n      <br />\n      <h2 style={{ textAlign: 'center' }}>{strings[96]}</h2>\n\n      <div className=\"shared-buttons\">\n        <button\n          className=\"btn-basic\"\n          onClick={() => window.open('https://discord.gg/SZMw4vpUJV', '_blank')}\n        >\n          Join Discord Server\n        </button>\n      </div>\n      \n      <div className=\"shared-buttons\">\n        <button\n          className=\"btn-basic\"\n          onClick={() => window.location.href = 'mailto:valleyviewgamedev@gmail.com'}\n        >\n          {strings[97]}\n        </button>\n      </div>\n\n      <br />\n      <h3>{strings[10126]}</h3>\n      <div>\n      {playersInGrid?.[gridId]?.pcs && typeof playersInGrid[gridId].pcs === 'object' ? (\n          Object.entries(playersInGrid[gridId].pcs).length === 0 ? (\n            <h4>{strings[10127]}</h4>\n          ) : (\n            Object.entries(playersInGrid[gridId].pcs).map(([playerId, pc]) => (\n              <p key={playerId}>\n                {connectedPlayers.has(playerId) && ' '}\n                <strong>{pc.username}</strong>\n              </p>\n            ))\n          )\n        ) : (\n          <h4>{strings[10127]}</h4>\n        )}\n        <h4>\n          {controllerUsername\n            ? ` ${controllerUsername}`\n            : \"There is no NPCController\"}\n        </h4>\n      </div>\n      <br />\n      </div>\n      <div className=\"base-panel-buffer\"></div>\n    </div>\n\n\n{/* //////////////////// Game Board //////////////////// */}\n\n    <div className=\"homestead\">\n\n      {showKeyArt && (\n        <div className=\"keyart-wrapper\">\n          <img\n            src=\"/assets/images/ValleyViewLoadScreen.png\"\n            alt=\"Valley View Key Art\"\n            className=\"keyart-image\"\n          />\n          <StartScreenAnimation />\n        </div>\n      )}\n\n      {zoomLevel === 'far' || zoomLevel === 'closer' || zoomLevel === 'close' ? (\n      <>\n        {/* Layer 1: Tiles - conditionally use V1 or V2 renderer */}\n        {useV2Tiles ? (\n          <RenderTilesCanvasV2\n            grid={memoizedGrid}\n            tileTypes={memoizedTileTypes}\n            TILE_SIZE={activeTileSize}\n            zoomLevel={zoomLevel}\n            handleTileClick={handleTileClick}\n          />\n        ) : (\n          <RenderTilesCanvas\n            grid={memoizedGrid}\n            tileTypes={memoizedTileTypes}\n            TILE_SIZE={activeTileSize}\n            zoomLevel={zoomLevel}\n            handleTileClick={handleTileClick}\n          />\n        )}\n\n        {/* Layer 1.5: Cursor Tile Highlight (only when in cursor placement mode) */}\n        {cursorMode && (\n          <CursorTileHighlight\n            hoveredTile={hoveredTile}\n            cursorMode={cursorMode}\n            TILE_SIZE={activeTileSize}\n            gridWidth={memoizedGrid?.[0]?.length || 0}\n            gridHeight={memoizedGrid?.length || 0}\n          />\n        )}\n\n        {/* Layer 2: Resources */}\n        <RenderResources\n          resources={memoizedResources}\n          masterResources={masterResources}\n          globalTuning={globalTuning}\n          TILE_SIZE={activeTileSize}\n          handleTileClick={handleTileClick}\n          currentPlayer={currentPlayer}\n          badgeState={badgeState}\n          electionPhase={timers.elections.phase}\n        />\n        \n        {/* Layer 3: NPCs */}\n        <RenderNPCs\n          npcs={npcs}\n          TILE_SIZE={activeTileSize}\n          currentPlayer={currentPlayer}\n          globalTuning={globalTuning}\n          gridId={currentPlayer?.location?.g}\n          onNPCClick={handleNPCPanel}\n          checkQuestNPCStatus={(npc) => checkQuestNPCStatus(npc, currentPlayer)}\n          checkTradeNPCStatus={(npc) => checkTradeNPCStatus(npc, masterResources)}\n          checkKentNPCStatus={(npc) => checkKentNPCStatus(npc, currentPlayer)}\n          strings={strings}\n          masterResources={masterResources}\n          playersInGrid={playersInGrid}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          setResources={setResources}\n          setCurrentPlayer={setCurrentPlayer}\n          masterSkills={masterSkills}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          masterTrophies={masterTrophies}\n          setHoverTooltip={setHoverTooltip}\n        />\n        \n        {/* Layer 4: PCs */}\n        <RenderPCs\n          pcs={pcs}\n          TILE_SIZE={activeTileSize}\n          currentPlayer={currentPlayer}\n          onPCClick={handlePCClick}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          masterResources={masterResources}\n          strings={strings}\n          connectedPlayers={connectedPlayers}\n        />\n        \n        {/* Layer 5: Dynamic Elements (tooltips, overlays, VFX) */}\n        <RenderDynamicElements\n          TILE_SIZE={activeTileSize}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          onNPCClick={handleNPCPanel}  // Pass the callback\n          onPCClick={handlePCClick}  // Pass the callback\n          handleTileClick={handleTileClick}  // Pass tile click handler\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          masterTrophies={masterTrophies}\n          hoverTooltip={hoverTooltip}\n          setHoverTooltip={setHoverTooltip}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          updateStatus={updateStatus}\n          strings={strings}\n          gridId={gridId}\n          globalTuning={globalTuning}\n          timers={timers}\n          resources={memoizedResources}\n          npcs={npcs}\n          pcs={pcs}\n          grid={memoizedGrid}\n          tileTypes={memoizedTileTypes}\n          onTileHover={setHoveredTile}\n          cursorModeActive={!!cursorMode}\n        />\n        \n        {/* Hover Tooltip - render at top level */}\n        {hoverTooltip && (\n          <div\n            className=\"HoverTooltip\"\n            style={{\n              bottom: `calc(100vh - ${hoverTooltip.y}px + 10px)`,\n              left: hoverTooltip.x,\n              transform: 'translateX(-50%)',\n            }}\n            dangerouslySetInnerHTML={{ __html: hoverTooltip.content }}\n          />\n        )}\n        \n        {/* <RenderVFX\n          toggleVFX={currentPlayer?.settings?.toggleVFX}\n          // Placeholder for VFX\n          TILE_SIZE={activeTileSize}\n        /> */}\n\n        {/* FTUE Doinker - Bouncing arrow pointing at target resource */}\n        <FTUEDoinker\n          doinkerTarget={doinkerTarget}\n          TILE_SIZE={activeTileSize}\n          visible={!!doinkerTarget}\n        />\n\n        </>\n      ) : null}\n\n{/* //////////////////  ZOOM OUTS  ///////////////////*/}\n\n    {/* Settlement zoom view */}\n    {zoomLevel === 'settlement' && (\n      <SettlementView\n        currentPlayer={currentPlayer}\n        isDeveloper={isDeveloper}\n        setZoomLevel={setZoomLevel}\n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        setCurrentPlayer={setCurrentPlayer}\n        setGridId={setGridId}\n        setGrid={setGrid}\n        setResources={setResources}\n        setTileTypes={setTileTypes}\n        TILE_SIZE={activeTileSize}\n        masterResources={masterResources}\n        closeAllPanels={closeAllPanels}\n        visibleSettlementId={visibleSettlementId}\n        setVisibleSettlementId={setVisibleSettlementId}\n        onClose={() => setZoomLevel('far')}\n      />\n    )}\n    {zoomLevel === 'frontier' && (\n      <FrontierView\n        currentPlayer={currentPlayer}\n        isDeveloper={isDeveloper}\n        setZoomLevel={setZoomLevel} \n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        setCurrentPlayer={setCurrentPlayer}\n        setGridId={setGridId}              \n        setGrid={setGrid}            \n        setResources={setResources}  \n        setTileTypes={setTileTypes}\n        masterResources={masterResources}\n        masterTrophies={masterTrophies}\n        TILE_SIZE={activeTileSize}\n        closeAllPanels={closeAllPanels}\n        visibleSettlementId={visibleSettlementId}\n        setVisibleSettlementId={setVisibleSettlementId}\n        onClose={() => setZoomLevel('settlement')}\n      />\n    )}\n    </div>\n\n{/* ///////////////////// MODALS ////////////////////// */}\n\n      {showShareModal && (\n        <ShareModal onClose={() => setShowShareModal(false)} />\n      )}\n      \n      {showFTUE && (\n        <FTUE \n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          onClose={() => setShowFTUE(false)}\n          openPanel={openPanel}\n          setActiveQuestGiver={setActiveQuestGiver}\n          gridId={gridId}\n          setActiveStation={setActiveStation}\n          masterResources={masterResources}\n          setResources={setResources}\n          TILE_SIZE={activeTileSize}\n        />\n      )}\n\n      <Modal \n        isOpen={isModalOpen} \n        onClose={() => {\n          if (modalContent?.onClose) {\n            modalContent.onClose();\n          } else {\n            setIsModalOpen(false);\n          }\n        }} \n        title={modalContent.title} \n        message={modalContent.message} \n        message2={modalContent.message2} \n        size={modalContent.size || \"standard\"}\n      >\n        {modalContent.children}\n        {modalContent.custom}\n      </Modal>\n \n      <RevivalModal\n        isOpen={isRevivalModalOpen}\n        onAcceptDeath={handleAcceptDeath}\n        onRevive={handleRevive}\n        reviveCost={globalTuning?.costToRevive || 50}\n        strings={strings}\n        currentPlayer={currentPlayer}\n        inventory={inventory}\n        updateStatus={updateStatus}\n      />\n \n      {activeModal === 'Mailbox' && (\n        <Mailbox\n          onClose={closeModal}  //  This sets activeModal = null\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activeModal === 'TownNews' && (\n        <TownNews\n          onClose={closeModal}  //  This sets activeModal = null\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n        />\n      )}\n      {activeModal === 'LanguagePicker' && (\n        <LanguagePickerModal\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          onClose={() => setActiveModal(null)}\n          onSave={() => setActiveModal(null)}\n        />\n      )}\n      {activeModal === \"Store\" && (\n        <Store\n          onClose={({ openMailbox } = {}) => {\n            setActiveModal(null);\n            if (openMailbox) {\n              setTimeout(() => setActiveModal(\"Mailbox\"), 100);\n            }\n          }}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={masterResources}\n          setModalContent={setModalContent}\n \t        setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {isOffSeason && (\n        <OffSeasonModal\n          currentPlayer={currentPlayer}\n          timers={timers}\n        />\n      )}\n\n{/* ///////////////////// PANELS ////////////////////// */}\n\n      {activePanel === 'ProfilePanel' && (\n        <ProfilePanel\n        onClose={closePanel}\n        currentPlayer={currentPlayer}\n        setCurrentPlayer={setCurrentPlayer}\n        handleLogout={handleLogout}\n        isRelocating={isRelocating}\n        setIsRelocating={setIsRelocating}\n        zoomLevel={zoomLevel}\n        setZoomLevel={setZoomLevel}\n        handlePCClick={handlePCClick}\n        isDeveloper={isDeveloper}\n       />\n      )}\n      {activePanel === 'LoginPanel' && (\n        <LoginPanel\n          onClose={closePanel}\n          setCurrentPlayer={(player) => {\n            setCurrentPlayer(player);\n            closePanel(); \n          }}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel} \n          onLoginSuccess={async (username, password) => {\n            await handleLoginSuccess(username, password);\n          }}\n        />\n      )}\n      {activePanel === 'DebugPanel' && (\n        <DebugPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setResources={setResources}\n          currentGridId={currentPlayer?.location?.g}\n          updateStatus={updateStatus}\n          TILE_SIZE={activeTileSize}\n          setGrid={setGrid}\n          setGridId={setGridId}\n          setTileTypes={setTileTypes}\n          closeAllPanels={closeAllPanels}\n        />\n      )}\n      {activePanel === 'InventoryPanel' && (\n        <InventoryPanel\n          onClose={closePanel} \n          masterResources={masterResources}\n          globalTuning={globalTuning}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          setBackpack={setBackpack}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'WarehousePanel' && (\n        <WarehousePanel\n          onClose={() => openPanel('InventoryPanel')} \n          masterResources={masterResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setInventory={setInventory}\n          stationType={activeStation?.type} \n          globalTuning={globalTuning}\n          masterWarehouse={masterWarehouse}\n          updateStatus={updateStatus}\n        />\n      )}\n      {activePanel === 'TrophyPanel' && (\n        <TrophyPanel\n          onClose={closePanel} \n          masterResources={masterResources}\n          masterTrophies={masterTrophies}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          openPanel={openPanel}\n          setActiveStation={setActiveStation}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n        />\n      )}\n      {activePanel === 'BankPanel' && (\n        <BankPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterXPLevels={masterXPLevels}\n          globalTuning={globalTuning}\n          setResources={setResources}\n          currentStationPosition={activeStation?.position}\n          gridId={gridId}\n          TILE_SIZE={activeTileSize}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'KentPanel' && (\n        <KentPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          globalTuning={globalTuning}\n          currentSeason={timers.seasons?.type || \"Unknown\"}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n     {activePanel === 'NewTrainPanel' && (\n        <NewTrainPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          globalTuning={globalTuning}\n          currentSeason={timers.seasons?.type || \"Unknown\"}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n      {activePanel === 'CarnivalPanel' && (\n        <CarnivalPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterXPLevels={masterXPLevels}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'HowToPanel' && (\n        <HowToPanel \n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'HowToMoneyPanel' && (\n        <HowToMoneyPanel \n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'HowToGemsPanel' && (\n        <HowToGemsPanel \n          currentPlayer={currentPlayer}\n          updateStatus={updateStatus}\n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'GoldBenefitsPanel' && (\n        <GoldBenefitsPanel \n          currentPlayer={currentPlayer}\n          updateStatus={updateStatus}\n          onOpen={openPanel}\n          onClose={closePanel}\n        />\n      )}\n      {activePanel === 'GovPanel' && (\n        <GovPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'LeaderboardPanel' && (\n        <LeaderboardPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          masterResources={masterResources}\n          masterTraders={masterTraders}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n      {activePanel === 'Courthouse' && (\n        <CourthousePanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          setResources={setResources}\n          currentStationPosition={activeStation?.position}\n          gridId={gridId}\n          TILE_SIZE={activeTileSize}\n          isDeveloper={isDeveloper}\n          masterResources={masterResources}\n          masterXPLevels={masterXPLevels}\n          masterSkills={masterSkills}\n        />\n      )}\n      {activePanel === 'QuestPanel' && (\n        <QuestPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n        />\n      )}\n      {activePanel === 'SkillsPanel' && (\n        <SkillsPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          stationType={activeStation?.type}\n          stationCategory={activeStation?.category}\n          currentStationPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          isDeveloper={isDeveloper}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterSkills={masterSkills}\n          setResources={setResources}\n          masterResources={masterResources}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n      {activePanel === 'CombatPanel' && (\n        <CombatPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n        />\n      )}\n      {activePanel === 'CraftingStation' && (\n        <CraftingStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={resources}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          globalTuning={globalTuning}\n        />\n      )}\n      {activePanel === 'FarmHouse' && (\n        <FarmHouse\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          masterResources={masterResources} \n          masterSkills={masterSkills} \n          masterTrophies={masterTrophies}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'ShopStation' && (\n        <ShopStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type}\n          currentStationPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterTraders={masterTraders}\n          masterTrophies={masterTrophies}\n          isDeveloper={isDeveloper}\n          globalTuning={globalTuning}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n      {activePanel === 'ScrollStation' && (\n        <ScrollStation\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterTrophies={masterTrophies}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'FarmingPanel' && (\n        <FarmingPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          tiles={grid}\n          tileTypes={tileTypes}\n          setTileTypes={setTileTypes}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          updateStatus={updateStatus}\n          currentSeason={seasonData?.type}\n          isDeveloper={isDeveloper}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'ToolsPanel' && (\n        <ToolsPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          tiles={grid}\n          tileTypes={tileTypes}\n          setTileTypes={setTileTypes}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          masterXPLevels={masterXPLevels}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'BuildPanel' && (\n        <BuildPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          globalTuning={globalTuning}\n          masterXPLevels={masterXPLevels}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'BuyPanel' && (\n        <BuyPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          NPCsInGrid={NPCsInGrid}\n          globalTuning={globalTuning}\n          masterXPLevels={masterXPLevels}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'PetsPanel' && (\n        <PetsPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'BuyDecoPanel' && (\n        <BuyDecoPanel\n          onClose={closePanel}\n          TILE_SIZE={activeTileSize}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          resources={resources}\n          setResources={setResources}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          updateStatus={updateStatus}\n          isDeveloper={isDeveloper}\n          currentSeason={seasonData?.type}\n          cursorMode={cursorMode}\n          setCursorMode={setCursorMode}\n        />\n      )}\n      {activePanel === 'NPCPanel' && (\n        <NPCPanel\n          onClose={closePanel}\n          npcData={activeQuestGiver}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterInteractions={masterInteractions}\n          masterTraders={masterTraders}\n          masterTrophies={masterTrophies}\n          masterXPLevels={masterXPLevels}\n          zoomLevel={zoomLevel}\n          setZoomLevel={setZoomLevel}\n          centerCameraOnPlayer={centerCameraOnPlayer}\n          globalTuning={globalTuning}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'FarmHandPanel' && (\n        <FarmHandPanel\n          onClose={closePanel}\n          npc={activeQuestGiver}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          resources={resources}\n          setResources={setResources}\n          stationType={activeStation?.type}\n          currentStationPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          currentSeason={seasonData?.type}\n          isDeveloper={isDeveloper}\n          globalTuning={globalTuning}\n          masterXPLevels={masterXPLevels}\n        />\n      )}\n      {activePanel === 'SocialPanel' && (\n        <SocialPanel\n          onClose={closePanel}\n          pcData={activeSocialPC}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          updateStatus={updateStatus}\n          masterInteractions={masterInteractions}\n          masterTrophies={masterTrophies}\n          masterResources={masterResources}\n          masterXPLevels={masterXPLevels}\n          masterTraders={masterTraders}\n          isDeveloper={isDeveloper}\n          controllerUsername={controllerUsername}\n          setControllerUsername={setControllerUsername}\n          openPanel={openPanel}\n        />\n      )}\n      {activePanel === 'AnimalStall' && (\n        <AnimalStall\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'AnimalPanel' && (\n        <AnimalPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          npcId={activeStation?.npcId}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activePanel === 'CropPanel' && (\n        <CropPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          currentResource={activeStation?.resource}\n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n        />\n      )}\n      {activePanel === 'DecoPanel' && (\n        <DecoPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          stationType={activeStation?.type} \n          currentStationPosition={activeStation?.position} \n          gridId={activeStation?.gridId} \n          TILE_SIZE={activeTileSize}\n          updateStatus={updateStatus}\n          masterResources={masterResources}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'PetPanel' && (\n        <PetPanel\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setResources={setResources}\n          petResource={resources.find(r => r.x === activeStation?.position?.x && r.y === activeStation?.position?.y)}\n          currentPetPosition={activeStation?.position}\n          gridId={activeStation?.gridId}\n          masterResources={masterResources}\n          masterSkills={masterSkills}\n          masterTrophies={masterTrophies}\n          TILE_SIZE={activeTileSize}\n          isDeveloper={isDeveloper}\n        />\n      )}\n      {activePanel === 'TradeStall' && (\n        <TradeStall\n          onClose={closePanel}\n          inventory={inventory}\n          setInventory={setInventory}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          updateStatus={updateStatus}\n          globalTuning={globalTuning}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n      {activePanel === 'OutpostPanel' && (\n        <Outpost\n          onClose={closePanel}\n          backpack={backpack}\n          setBackpack={setBackpack}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          gridId={activeStation?.gridId}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n          isDeveloper={isDeveloper}\n          stationType={activeStation?.type}\n          currentStationPosition={activeStation?.position}\n          setResources={setResources}\n          setInventory={setInventory}\n          TILE_SIZE={activeTileSize}\n          globalTuning={globalTuning}\n        />\n      )}\n      {activePanel === 'SeasonPanel' && (\n        <SeasonPanel\n          onClose={closePanel}\n          currentPlayer={currentPlayer}\n          setCurrentPlayer={setCurrentPlayer}\n          setModalContent={setModalContent}\n          setIsModalOpen={setIsModalOpen}\n        />\n      )}\n\n      {/* Tooltip rendering is handled by RenderDynamicElements */}\n      </div>\n\n      {uiLocked && (\n        <div\n          style={{\n            position: 'fixed',\n            inset: 0,\n            zIndex: 9999,\n            backgroundColor: 'rgba(0,0,0,0.0)', // transparent blocker\n            cursor: 'wait',\n          }}\n        />\n      )}\n\n      {/* Location transition overlay */}\n      <TransitionOverlay \n        isTransitioning={isTransitioning}\n        // onTransitionComplete={() => {\n        //   //console.log(' [TRANSITION] Fade transition completed');\n        // }}\n      />\n\n      {/* Level Up Modal */}\n      <LevelUpModal\n        isOpen={isLevelUpModalOpen}\n        onClose={() => setIsLevelUpModalOpen(false)}\n        currentLevel={levelUpData.currentLevel}\n        previousLevel={levelUpData.previousLevel}\n        updateStatus={updateStatus}\n        masterResources={masterResources}\n      />\n\n    </>\n  );\n}\n\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport { StringsProvider } from './UI/StringsContext';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { StatusBarProvider } from './UI/StatusBar/StatusBar';\nimport { PanelProvider } from './UI/Panels/PanelContext'; \nimport { GridStateProvider } from './GridState/GridStateContext';\nimport { GridStatePCProvider } from './GridState/GridStatePCContext';\nimport { ModalProvider } from './UI/ModalContext';\nimport { UILockProvider } from './UI/UILockContext';\nimport { NPCOverlayProvider } from './UI/NPCOverlayContext';\nimport { BulkOperationProvider } from './UI/BulkOperationContext';\n\nconsole.warn(\" index.js evaluated again  app may remount\");\n\n// Prevent HMR from creating multiple instances\nif (window.__app_initialized__) {\n  console.log(\" App already initialized, preventing HMR remount\");\n  // Don't execute the rest of the file\n} else {\n  window.__app_initialized__ = true;\n\n// Cache the language to prevent provider recreation when player data changes\nlet cachedLanguage = 'en';\ntry {\n  const savedPlayer = localStorage.getItem('player');\n  if (savedPlayer) {\n    const parsedPlayer = JSON.parse(savedPlayer);\n    if (parsedPlayer?.language) {\n      cachedLanguage = parsedPlayer.language;\n    }\n  }\n} catch (e) {\n  console.warn('Failed to parse player data for language:', e);\n}\nconst savedLanguage = cachedLanguage;\nconst rootEl = document.getElementById('root');\nconsole.log(\" root element:\", rootEl);\n\nif (!window.__root_created__) {\n  console.warn(\" Creating React root\");\n  window.__root_created__ = true;\n  window.__root = ReactDOM.createRoot(rootEl);\n} else {\n  console.error(\" React root was already created!\");\n}\n\nif (!window.__app_rendered__) {\n  console.warn(\" Rendering App...\");\n  window.__app_rendered__ = true;\n  window.__root.render(\n    <UILockProvider>\n      <NPCOverlayProvider>\n        <BulkOperationProvider>\n          <StringsProvider language={savedLanguage}>\n            <GridStateProvider>\n              <GridStatePCProvider>\n                <StatusBarProvider>\n                  <PanelProvider>\n                    <ModalProvider>\n                      <App />\n                    </ModalProvider>\n                  </PanelProvider>\n                </StatusBarProvider>\n              </GridStatePCProvider>\n            </GridStateProvider>\n          </StringsProvider>\n        </BulkOperationProvider>\n      </NPCOverlayProvider>\n    </UILockProvider>\n  );\n} else {\n  console.error(\" App already rendered  something is wrong\");\n}\n\n} // Close the main HMR prevention block\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"names":["async","handleFarmAnimalBehavior","gridId","updateThisNPC","NPCsInGridManager","this","id","state","grazeEnd","position","tiles","GlobalGridStateTilesAndResources","getTiles","resources","getResources","npcs","Object","values","handleIdleState","Date","now","currentTime","console","log","targetGrassTile","targetTileType","type","grassTiles","findTileInRange","Array","isArray","length","tileTypeName","warn","unoccupiedGrassTiles","filter","tile","some","res","x","y","npc","_npc$position","_npc$position2","action","Math","floor","sort","a","b","calculateDistance","dx","dy","direction","_npc$position3","_npc$position4","isMoving","moved","moveOneTile","_npc$position5","_npc$position6","growTime","fullGridState","stallRetries","failedStalls","targetStall","findNearestResource","find","push","triedStall","atStall","nearStall","abs","otherNPCsAtStall","otherNpc","_otherNpc$position","_otherNpc$position2","_NPCsInGridManager$ge","Promise","resolve","setTimeout","updatedNPC","error","timeSinceGrazeEnd","handleRoamState","lastProcessingLog","handleQuestGiverBehavior","playersInGridManager","getPlayersInGrid","pc","range","hp","isWallBlocking","isWithinWallFootprint","wall","canSeeTarget","npcPosition","targetPosition","lineOfSightTiles","start","end","x0","y0","x1","y1","sx","sy","err","prevX","prevY","e2","getLineOfSightTiles","handleEnemyBehavior","TILE_SIZE","pcs","call","visiblePCsInRange","getDistance","targetPC","random","username","pursueTimerStart","_this$targetPC3","_this$targetPC","playerId","_this$targetPC2","currentDistance","attackrange","timeSincePursueStart","distance","closestVisiblePC","closestPC","minDistance","Infinity","forEach","findClosestVisiblePC","canSeeTargetNow","_this$targetPC5","_this$targetPC4","handlePursueWithLineOfSight","distanceToPlayer","stuckCounter","_this$targetPC6","_this$targetPC7","iscamping","attackbonus","armorclass","damage","amountToMod","newHP","max","FloatingTextManager","addFloatingText","updatePC","lastUpdated","speed","pos1","pos2","sqrt","handleHealBehavior","handleSpawnBehavior","npcsObject","playersInGrid","oldPosition","nextspawn","requires","qtycollected","spawnNPC","handleWorkerBehavior","handleTraderBehavior","NPC","constructor","properties","_properties$nextspawn","Error","updateInterval","symbol","output","maxhp","growtime","processingStartTime","undefined","_type","_id","safeProperties","assign","update","NPCsInGrid","processState","idleDuration","onTransition","arguments","idleTimer","validDirections","dir","getAdjacentTile","isValidTile","randomDirection","roamSteps","currentDirection","directions","N","S","E","W","NE","SE","SW","NW","handlePursueState","playerPosition","onAttackTransition","newDistanceToPlayer","delta","targetX","targetY","socket","connected","emit","npcId","newPosition","emitterId","resourceInTile","passable","npcInTile","tileType","startX","startY","potentialTiles","_tiles$y","targetResource","excludePositions","availableResources","category","pos","aPos","bPos","findAllResources","prototype","attachGrazingBehavior","attachQuestBehavior","attachEnemyBehavior","attachHealBehavior","attachSpawnBehavior","attachFarmerBehavior","attachTraderBehavior","STRINGS_MAP","en","stringsEN","fr","stringsFR","es","stringsES","de","stringsDE","it","stringsIT","pt","stringsPT","ru","stringsRU","no","stringsNO","sv","stringsSV","fi","stringsFI","StringsContext","createContext","StringsProvider","_ref","language","children","selectedStrings","toLowerCase","rawLanguage","normalized","resolvedFile","_jsx","Provider","value","useStrings","useContext","module","exports","renderPositions","pressedKeys","Set","MODIFIER_KEYS","handleKeyDown","event","currentPlayer","masterResources","setCurrentPlayer","setGridId","setGrid","setTileTypes","setResources","updateStatus","closeAllPanels","localPlayerMoveTimestampRef","bulkOperationContext","strings","transitionFadeControl","includes","key","add","ArrowUp","w","ArrowDown","s","ArrowLeft","A","ArrowRight","d","D","totalDx","totalDy","movement","min","location","toString","g","currentPosition","round","startTransition","skills","handleTransitSignpost","canMove","_currentPlayer$locati","isinboat","tileResource","resource","canPassThroughDoor","npcsInGrid","isTileValidForPlayer","isValidMove","finalPosition","current","centerCameraOnPlayer","processMovement","catch","handleKeyUp","delete","clear","retryCount","gameContainer","document","querySelector","requestAnimationFrame","centerX","window","innerWidth","centerY","innerHeight","maxScrollLeft","scrollWidth","clientWidth","maxScrollTop","scrollHeight","clientHeight","clampedX","clampedY","scrollTo","left","top","behavior","centerCameraOnPlayerFast","addEventListener","hidden","debugMovementKeys","from","resetMovementKeys","masterSkills","globalTuning","masterInteractions","masterTraders","masterTrophies","masterWarehouse","masterXPLevels","loadMasterSkills","response","axios","get","API_BASE","data","loadMasterResources","loadGlobalTuning","loadMasterInteractions","loadMasterTraders","loadMasterTrophies","loadMasterWarehouse","loadMasterXPLevels","f","require","k","Symbol","for","l","m","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","ref","__self","__source","q","c","e","h","defaultProps","$$typeof","props","_owner","Fragment","jsx","jsxs","r","t","u","v","z","iterator","B","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","C","context","refs","updater","F","G","isReactComponent","setState","forceUpdate","H","isPureReactComponent","I","J","K","L","M","O","P","Q","replace","escape","R","next","done","String","keys","join","T","_status","_result","then","default","U","V","transition","ReactCurrentDispatcher","ReactCurrentBatchConfig","X","Children","map","apply","count","toArray","only","Component","Profiler","PureComponent","StrictMode","Suspense","act","cloneElement","_currentValue","_currentValue2","_threadCount","Consumer","_defaultValue","_globalName","_context","createElement","createFactory","bind","createRef","forwardRef","render","isValidElement","lazy","_payload","_init","memo","compare","unstable_act","useCallback","useDebugValue","useDeferredValue","useEffect","useId","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useSyncExternalStore","useTransition","version","fn","thisArg","getPrototypeOf","kindOf","cache","create","thing","str","slice","kindOfTest","typeOfTest","isUndefined","isArrayBuffer","isString","isFunction","isNumber","isObject","isPlainObject","val","toStringTag","isDate","isFile","isBlob","isFileList","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","obj","i","allOwnKeys","getOwnPropertyNames","len","findKey","_key","_global","globalThis","self","global","isContextDefined","isTypedArray","TypedArray","Uint8Array","isHTMLForm","prop","isRegExp","reduceDescriptors","reducer","descriptors","getOwnPropertyDescriptors","reducedDescriptors","descriptor","name","ret","defineProperties","isAsyncFn","_setImmediate","setImmediateSupported","postMessageSupported","setImmediate","token","callbacks","_ref2","source","shift","cb","postMessage","asap","queueMicrotask","process","nextTick","isBuffer","isFormData","kind","FormData","append","isArrayBufferView","result","ArrayBuffer","isView","buffer","isBoolean","isStream","pipe","merge","caseless","assignValue","targetKey","extend","trim","stripBOM","content","charCodeAt","inherits","superConstructor","defineProperty","toFlatObject","sourceObj","destObj","propFilter","merged","endsWith","searchString","lastIndex","indexOf","arr","forEachEntry","pair","matchAll","regExp","matches","exec","hasOwnProp","freezeMethods","enumerable","writable","set","toObjectSet","arrayOrString","delimiter","define","split","toCamelCase","p1","p2","toUpperCase","noop","toFiniteNumber","defaultValue","Number","isFinite","isSpecCompliantForm","toJSONObject","stack","visit","target","reducedValue","isThenable","AxiosError","message","code","config","request","captureStackTrace","status","utils","toJSON","description","number","fileName","lineNumber","columnNumber","customProps","axiosError","cause","isVisitable","removeBrackets","renderKey","path","dots","concat","predicates","test","formData","options","TypeError","metaTokens","indexes","option","visitor","defaultVisitor","useBlob","Blob","convertValue","toISOString","Buffer","JSON","stringify","isFlatArray","el","index","exposedHelpers","build","pop","encode","charMap","encodeURIComponent","match","AxiosURLSearchParams","params","_pairs","toFormData","encoder","_encode","buildURL","url","serialize","serializeFn","serializedParams","hashmarkIndex","handlers","use","fulfilled","rejected","synchronous","runWhen","eject","silentJSONParsing","forcedJSONParsing","clarifyTimeoutError","isBrowser","classes","URLSearchParams","protocols","hasBrowserEnv","_navigator","navigator","hasStandardBrowserEnv","product","hasStandardBrowserWebWorkerEnv","WorkerGlobalScope","importScripts","origin","href","platform","buildPath","isNumericKey","isLast","arrayToObject","entries","parsePropPath","defaults","transitional","transitionalDefaults","adapter","transformRequest","headers","contentType","getContentType","hasJSONContentType","isObjectPayload","formDataToJSON","setContentType","helpers","isNode","toURLEncodedForm","formSerializer","_FormData","env","rawValue","parser","parse","stringifySafely","transformResponse","JSONRequested","responseType","strictJSONParsing","ERR_BAD_RESPONSE","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","maxBodyLength","validateStatus","common","method","ignoreDuplicateOf","$internals","normalizeHeader","header","normalizeValue","matchHeaderValue","isHeaderNameFilter","AxiosHeaders","valueOrRewrite","rewrite","setHeader","_value","_header","_rewrite","lHeader","setHeaders","rawHeaders","parsed","line","substring","parseHeaders","tokens","tokensRE","parseTokens","has","matcher","deleted","deleteHeader","normalize","format","char","formatHeader","_len","targets","asStrings","first","computed","_len2","_key2","accessor","accessors","defineAccessor","accessorName","methodName","arg1","arg2","arg3","configurable","buildAccessors","mapped","headerValue","transformData","fns","isCancel","__CANCEL__","CanceledError","ERR_CANCELED","settle","reject","ERR_BAD_REQUEST","samplesCount","bytes","timestamps","firstSampleTS","head","tail","chunkLength","startedAt","bytesCount","passed","freq","lastArgs","timer","timestamp","threshold","invoke","args","clearTimeout","flush","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","speedometer","throttle","loaded","total","lengthComputable","progressBytes","rate","progress","estimated","progressEventDecorator","throttled","asyncDecorator","isMSIE","URL","protocol","host","port","userAgent","write","expires","domain","secure","cookie","toGMTString","read","RegExp","decodeURIComponent","remove","buildFullPath","baseURL","requestedURL","allowAbsoluteUrls","isRelativeUrl","relativeURL","combineURLs","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","paramsSerializer","timeoutMessage","withCredentials","withXSRFToken","onUploadProgress","onDownloadProgress","decompress","beforeRedirect","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding","configValue","newConfig","auth","btoa","password","unescape","Boolean","isURLSameOrigin","xsrfValue","cookies","XMLHttpRequest","_config","resolveConfig","requestData","requestHeaders","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","unsubscribe","signal","removeEventListener","onloadend","responseHeaders","getAllResponseHeaders","responseText","statusText","open","onreadystatechange","readyState","responseURL","onabort","ECONNABORTED","onerror","ERR_NETWORK","ontimeout","timeoutErrorMessage","ETIMEDOUT","setRequestHeader","upload","cancel","abort","subscribe","aborted","parseProtocol","send","composeSignals","signals","controller","AbortController","reason","streamChunk","chunk","chunkSize","byteLength","readStream","stream","asyncIterator","reader","getReader","trackStream","onProgress","onFinish","iterable","readBytes","_onFinish","ReadableStream","pull","close","loadedBytes","enqueue","return","highWaterMark","isFetchSupported","fetch","Request","Response","isReadableStreamSupported","encodeText","TextEncoder","arrayBuffer","supportsRequestStream","duplexAccessed","hasContentType","body","duplex","supportsResponseStream","resolvers","_","ERR_NOT_SUPPORT","resolveBodyLength","getContentLength","size","_request","getBodyLength","knownAdapters","http","xhr","xhrAdapter","fetchOptions","composedSignal","toAbortSignal","requestContentLength","contentTypeHeader","isCredentialsSupported","credentials","isStreamResponse","responseContentLength","responseData","renderReason","isResolvedHandle","adapters","nameOrAdapter","rejectedReasons","reasons","throwIfCancellationRequested","throwIfRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","formatMessage","opt","desc","opts","ERR_DEPRECATED","spelling","correctSpelling","assertOptions","schema","allowUnknown","ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","Axios","instanceConfig","interceptors","InterceptorManager","configOrUrl","dummy","boolean","function","baseUrl","withXsrfToken","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","unshift","responseInterceptorChain","promise","chain","onFulfilled","onRejected","getUri","generateHTTPMethod","isForm","CancelToken","executor","resolvePromise","_listeners","onfulfilled","_resolve","splice","HttpStatusCode","Continue","SwitchingProtocols","Processing","EarlyHints","Ok","Created","Accepted","NonAuthoritativeInformation","NoContent","ResetContent","PartialContent","MultiStatus","AlreadyReported","ImUsed","MultipleChoices","MovedPermanently","Found","SeeOther","NotModified","UseProxy","Unused","TemporaryRedirect","PermanentRedirect","BadRequest","Unauthorized","PaymentRequired","Forbidden","NotFound","MethodNotAllowed","NotAcceptable","ProxyAuthenticationRequired","RequestTimeout","Conflict","Gone","LengthRequired","PreconditionFailed","PayloadTooLarge","UriTooLong","UnsupportedMediaType","RangeNotSatisfiable","ExpectationFailed","ImATeapot","MisdirectedRequest","UnprocessableEntity","Locked","FailedDependency","TooEarly","UpgradeRequired","PreconditionRequired","TooManyRequests","RequestHeaderFieldsTooLarge","UnavailableForLegalReasons","InternalServerError","NotImplemented","BadGateway","ServiceUnavailable","GatewayTimeout","HttpVersionNotSupported","VariantAlsoNegotiates","InsufficientStorage","LoopDetected","NotExtended","NetworkAuthenticationRequired","createInstance","defaultConfig","instance","Cancel","all","promises","spread","callback","isAxiosError","payload","formToJSON","getAdapter","sortIndex","performance","unstable_now","startTime","expirationTime","priorityLevel","scheduling","isInputPending","MessageChannel","port2","port1","onmessage","unstable_IdlePriority","unstable_ImmediatePriority","unstable_LowPriority","unstable_NormalPriority","unstable_Profiling","unstable_UserBlockingPriority","unstable_cancelCallback","unstable_continueExecution","unstable_forceFrameRate","unstable_getCurrentPriorityLevel","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_requestPaint","unstable_runWithPriority","unstable_scheduleCallback","delay","unstable_shouldYield","unstable_wrapCallback","VFX_TIMING","recentEffects","Map","calculateTileCenter","createCollectEffect","effectKey","lastEffectTime","querySelectorAll","tileElement","tileTop","parseInt","style","tileLeft","rect","getBoundingClientRect","containerRect","width","height","calcX","calcY","particle","createParticleElement","innerText","pointerEvents","zIndex","fontSize","appendChild","transform","opacity","removeChild","createSourceConversionEffect","requiredSkill","emoji","handleConstructionWithGems","modifiedRecipe","modifiedBuildOptions","buildOptions","item","handleConstruction","selectedItem","inventory","setInventory","backpack","setBackpack","overridePosition","player","coords","getCurrentTileCoordinates","tileX","tileY","selectedResource","resourceRange","tilesToCheck","occupiedTile","spendIngredients","recipe","costDetails","ingredientType","ingredientQty","costString","spawnPosition","trackQuestProgress","debugBefore","rawResource","enriched","enrichResourceFromMaster","anchorKey","finalResources","shadowResource","parentAnchorKey","updateGridResource","quantity","_player$activeQuests","activeQuests","questUpdated","updatedQuests","quest","completed","rewardCollected","goalsCompleted","totalGoals","goalAction","goalItem","goalQty","post","prev","earnTrophy","trophyName","progressIncrement","trophyDef","_currentPlayer$trophi","trophies","success","trophy","isNewMilestone","prevPlayer","updatedTrophies","existingTrophyIndex","findIndex","qty","collected","shouldShowNotification","visible","showNotification","nextMilestone","tryAdvanceFTUEByTrigger","triggerKey","firsttimeuser","ftuestep","triggerStep","FTUEstepsData","step","trigger","currentStep","expectedStep","incrementFTUEStep","nextStep","updates","addAcceptedQuest","questIndex","questTemplate","newQuest","questId","title","goal1","goal2","goal3","goal1action","goal1item","goal1qty","goal2action","goal2item","goal2qty","goal3action","goal3item","goal3qty","currentActiveQuests","updatedActiveQuests","updatedPlayer","completeTutorial","onClose","wizardQuestExists","finalActiveQuests","updated","handleFeedbackSubmit","isPositive","positiveReasons","negativeReasons","browserType","getBrowserType","ftueFeedback","positive","negative","browser","svgCache","textureCache","loadingPromises","ZOOM_TIERS","getBestZoomTier","targetSize","devicePixelRatio","adjustedSize","tier","loadSVG","svgFileName","isOverlay","cacheKey","loadPromise","ok","text","svgText","createSVGTexture","canvas","ctx","getContext","imageSmoothingEnabled","imageSmoothingQuality","img","Image","onload","drawImage","revokeObjectURL","src","svgBlob","createObjectURL","getSVGTexture","texture","getOverlayTexture","overlayFileName","updateZoomTiers","baseZooms","farZoom","closeZoom","closerZoom","highResVariants","zoom","flat","clearCache","getCacheStats","svgFiles","textures","loading","createRoot","hydrateRoot","pendingUpdates","batchInterval","BATCH_SAVE_INTERVAL","registerSetPlayersInGrid","setter","setPlayersInGridReact","registerTileSize","tileSize","startBatchSaving","setInterval","processPendingUpdates","stopBatchSaving","clearInterval","updatesByGrid","gridUpdates","errors","forceSavePendingUpdates","flushGridPositionUpdates","_ref3","_ref4","initializePlayersInGrid","playersInGridLastUpdated","getTime","pcData","unloadListenerAdded","getAllPCs","_this$playersInGrid","_this$playersInGrid$g","getPlayerPosition","_this$playersInGrid2","_this$playersInGrid2$","_this$playersInGrid2$2","_this$playersInGrid2$3","setAllPCs","pcsObject","addPlayer","_pcData$settings","_pcData$settings2","modifiers","equippedWeapon","settings","equippedArmor","isWeapon","isArmor","powers","power","powerQty","isMagicEnhancement","attr","getStat","baseKey","modKey","baseHp","baseMaxhp","newPC","icon","addPC","_pcData$hp","_pcData$maxhp","_pcData$armorclass","_pcData$attackbonus","_pcData$damage","_pcData$attackrange","_pcData$speed","_prev$gridId","hasValidPosition","hasValidIcon","hasValidType","hasValidUsername","hasValidCombatStats","_error$response","_error$response2","_error$response3","_prev$gridId2","updatedGrid","updatePCLocal","_pcData$hp2","_pcData$maxhp2","_pcData$armorclass2","_pcData$attackbonus2","_pcData$damage2","_pcData$attackrange2","_pcData$speed2","_prev$gridId3","newProperties","_this$playersInGrid$g2","_gridPCs$playerId","gridPCs","currentData","every","updatedPC","animateRemotePC","_prev$gridId4","updateKey","removePC","_this$playersInGrid$g3","_this$playersInGrid$g4","pendingKey","_prev$gridId5","PanelContext","PanelProvider","activePanel","setActivePanel","closePanel","openPanel","panelName","usePanelContext","reverseLookupMap","getStringIdByValue","createReverseLookupMap","reverseMap","getLocalizedString","stringId","REACT_APP_SERVER_URL","to","stepCount","currentX","currentY","animate","interpolatedX","interpolatedY","handleFarmPlotPlacement","_tiles$tileY","errorStringId","farmplotItem","tileTypeToString","validTileTypes","tileCode","getPlantingErrorString","growEndTime","enrichedNewResource","growEnd","existing","gridUpdateResponse","farmState","addSeed","cropName","handleTerraform","_tileTypes$tileY","actionType","tileTypes","isDeveloper","newType","convertTileType","locationChangeManager","isLocationChangeInProgress","pendingLocationChange","lastCompletedChange","isInProgress","requestLocationChange","changeRequest","completeLocationChange","completedChange","completedAt","pending","retryCallback","failLocationChange","getStatus","inProgress","hasPending","lastCompleted","pendingChange","clearPending","reset","debugLocationChanges","resetLocationChangeManager","broadcast","craftEnd","craftedItem","patch","updatedResources","prevTiles","mergeTiles","updatedTiles","changePlayerLocation","fromLocation","toLocation","_bulkOperationContext","_currentPlayer$_id","_playersInGridManager","isAnyBulkOperationActive","_playersInGridManager2","_fromGridResponse$dat","_fromGridResponse$dat2","_gridDataResponse$dat","_gridDataResponse$dat2","_gridDataResponse$dat3","_toGridResponse$data","_toGridResponse$data$","_fromPlayerState$hp","_fromPlayerState$maxh","_fromPlayerState$armo","_fromPlayerState$atta","_ref5","_fromPlayerState$dama","_ref6","_fromPlayerState$spee","_ref7","_fromPlayerState$atta2","_ref8","_fromPlayerState$isca","_ref9","_fromPlayerState$isin","inMemoryFromPlayerState","fromPCs","fromPlayerState","stopGridTimer","timerError","toGridResponse","gridDataResponse","newTilesData","newResourcesData","toRegion","region","fromRegion","finalHp","finalMaxHp","playerData","validationChecks","gridState","valid","check","once","locationResponse","setTiles","homesteadGridCoord","localStorage","setItem","initializeGrid","gtype","startsWith","trophyResult","freshGridState","freshPCState","updatedPCState","setGridStateReact","NPCsInGridLastUpdated","finalX","finalY","findSignpost","signpost","signpostType","offset","updatedPlayerData","centerCameraWithRetry","attempts","cleanupError","playerDataKeys","playerDataHP","playerDataMaxHP","playerDataArmorClass","playerDataAttackBonus","fullPlayerData","updateGridStatus","endTransition","gridCoord","alreadyVisited","isGridVisited","gridsVisited","visitResponse","playerWithVisited","visitError","fetchGridData","DBPlayerData","gridData","gridType","fetchedGridId","ownerId","combinedGridState","ownerUsername","fetchHomesteadOwner","fetchHomesteadSignpostPosition","signpostTown","fetchTownSignpostPosition","signpostHome","gridResponse","playerResponse","pow","getDerivedRange","_currentPlayer$skills","baseRange","bonusRangeFromSkills","reduce","sum","skill","master","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","encodePacket","supportsBinary","encodeBlobAsBase64","fileReader","FileReader","readAsDataURL","byteOffset","TEXT_ENCODER","chars","lookup","decodePacket","encodedPacket","binaryType","mapBinary","charAt","decodeBase64Packet","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","arraybuffer","decode","SEPARATOR","fromCharCode","createPacketEncoderStream","TransformStream","packet","encoded","encodePacketToBinary","payloadLength","DataView","setUint8","view","setUint16","setBigUint64","BigInt","TEXT_DECODER","totalLength","chunks","acc","concatChunks","j","Emitter","mixin","on","_callbacks","off","removeListener","removeAllListeners","emitReserved","listeners","hasListeners","setTimeoutFn","globalThisShim","Function","pick","NATIVE_SET_TIMEOUT","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","useNativeTimers","clearTimeoutFn","randomString","TransportError","super","Transport","query","forceBase64","onError","doOpen","doClose","packets","onOpen","onData","onPacket","details","pause","onPause","createUri","_hostname","_port","_query","hostname","encodedQuery","Polling","_polling","_poll","doPoll","decodePayload","encodedPayload","encodedPackets","decodedPacket","encodePayload","doWrite","uri","timestampRequests","timestampParam","sid","b64","hasCORS","empty","BaseXHR","isSSL","xd","req","xhrStatus","pollXhr","createRequest","_opts","_method","_uri","_data","_create","_a","xdomain","_xhr","extraHeaders","setDisableHeaderCheck","cookieJar","addCookies","requestTimeout","parseCookies","getResponseHeader","_onLoad","_onError","_index","requestsCount","requests","_cleanup","fromError","attachEvent","unloadHandler","hasXHR2","newRequest","isReactNative","BaseWS","ws","createSocket","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","ev","lastPacket","WebSocketCtor","WebSocket","MozWebSocket","transports","websocket","_packet","webtransport","_transport","WebTransport","transportOptions","closed","ready","createBidirectionalStream","decoderStream","maxPayload","TextDecoder","expectedLength","isBinary","headerArray","getUint16","getUint32","createPacketDecoderStream","MAX_SAFE_INTEGER","readable","pipeThrough","encoderStream","pipeTo","_writer","getWriter","polling","re","parts","authority","ipv6uri","pathNames","regx","names","queryKey","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","SocketWithoutUpgrade","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","parsedUri","_transportsByName","transportName","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","closeOnBeforeunload","qs","qry","pairs","_beforeunloadEventListener","_offlineEventListener","_onClose","_cookieJar","createCookieJar","_open","createTransport","EIO","priorWebsocketSuccess","setTransport","_onDrain","_onPacket","onHandshake","_sendPacket","_resetPingTimeout","pingInterval","pingTimeout","_pingTimeoutTimer","upgrading","_getWritablePackets","payloadSize","utf8Length","ceil","_hasPingExpired","hasExpired","msg","compress","cleanupAndClose","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","cleanup","freezeTransport","onTransportClose","onupgrade","_filterUpgrades","upgrades","filteredUpgrades","Socket","o","DEFAULT_TRANSPORTS","withNativeFile","File","hasBinary","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","placeholder","_placeholder","num","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","EVENT","ACK","encodeAsString","encodeAsBinary","BINARY_EVENT","BINARY_ACK","nsp","deconstruction","Decoder","reviver","reconstructor","decodeString","isBinaryEvent","BinaryReconstructor","takeBinaryData","buf","tryParse","substr","isPayloadValid","CONNECT","DISCONNECT","CONNECT_ERROR","destroy","finishedReconstruction","reconPack","binData","freeze","connect","connect_error","disconnect","disconnecting","newListener","io","recovered","receiveBuffer","sendBuffer","_queue","_queueSeq","ids","acks","flags","_autoConnect","disconnected","subEvents","subs","onpacket","active","_readyState","_b","_c","retries","fromQueue","volatile","_addToQueue","ack","_registerAckCallback","isTransportWritable","engine","isConnected","notifyOutgoingListeners","_this","ackTimeout","_len3","_key3","withError","emitWithAck","_len4","_key4","_this2","tryCount","_len5","responseArgs","_key5","_drainQueue","force","_sendConnectPacket","_pid","pid","_lastOffset","_clearAcks","onconnect","onevent","onack","ondisconnect","emitEvent","_anyListeners","sent","_len6","_key6","emitBuffered","subDestroy","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","Backoff","ms","factor","jitter","duration","rand","deviation","setMin","setMax","setJitter","Manager","nsps","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_parser","decoder","autoConnect","_reconnection","skipReconnect","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","Engine","openSubDestroy","errorSub","onping","ondata","ondecoded","_destroy","_close","onreconnect","attempt","loc","sameNamespace","forceNew","multiplex","socketListenForPCJoinAndLeave","isMasterResourcesReady","setPlayersInGrid","controllerUsername","setControllerUsername","handlePlayerJoinedGrid","joinedGridId","prevState","_prevState$joinedGrid","_prevState$joinedGrid2","incomingTime","localTime","_prevState$joinedGrid3","handlePlayerLeftGrid","leftGridId","currentGrid","_prevState$leftGridId","_prevState$leftGridId2","handleCurrentGridPlayers","receivedGridId","targetGridId","socketListenForPCstateChanges","setConnectedPlayers","handlePCSync","gridEntries","incomingPC","currentPlayerId","_prevState$gridId","_prevState$gridId$pcs","_prevState$gridId2","_prevState$gridId2$pc","_prevState$gridId3","localPC","changedFields","damageTaken","updatedState","prevPosition","socketListenForNPCStateChanges","setGridState","npcController","handleNPCSync","isController","isControllingGrid","_NPCsInGridManager$NP","updatedNPCs","liveGrid","incomingNPC","localNPC","rehydrated","handleNPCMoveSync","handleNPCRemoval","_NPCsInGridManager$NP2","socketListenForResourceChanges","handleResourceSync","_ref10","prevResources","newRes","indexToRemove","filtered","socketListenForTileChanges","handleTileSync","_ref11","socketListenForNPCControllerStatus","_ref12","_ref13","controlledGridId","_ref14","revokedGridId","socketListenForSeasonReset","_ref15","reload","socketListenForConnectAndDisconnect","setIsSocketConnected","handleConnect","handleDisconnect","socketListenForPlayerConnectedAndDisconnected","handlePlayerConnected","_ref16","handlePlayerDisconnected","_ref17","newSet","handleCurrentConnectedPlayers","_ref18","connectedPlayerIds","socketListenForChatMessages","setMessagesByScope","handleIncomingChatMessage","scope","scopeId","prevMessages","hasUpdate","emitChatMessage","_ref19","socketListenForBadgeUpdates","setBadgeState","updateBadge","handleBadge","_ref20","isMatch","gridTimer","externalSetGridState","pendingPositionUpdates","batchSaveInterval","BATCH_SAVE_DELAY","startBatchSaveTimer","flushPendingPositionUpdates","stopBatchSaveTimer","queuePositionUpdate","npcUpdates","updateNPCPosition","_NPCsInGrid$npcs","registerSetGridState","setterFunction","initializeGridState","hydratedState","lightweightNPC","npcTemplate","hydrated","getNPCsInGrid","npcType","_npcType","addNPC","updatedGridState","setAllNPCs","updateNPC","_NPCsInGrid$npcs2","_NPCsInGrid$npcs3","npcData","removeNPC","saveGridStateNPCs","dehydratedNPCs","startGridTimer","stopGridStateUpdates","existingState","isCurrency","resourceType","calculateSkillMultiplier","playerSkills","applicableSkills","multiplier","_masterSkills$skill$t","buffValue","hasSkills","applySkillMultiplier","baseQuantity","deriveWarehouseAndBackpackCapacity","baseWarehouse","warehouseCapacity","baseBackpack","backpackCapacity","isGold","accountStatus","warehouseBonus","warehouseCapacityGold","backpackBonus","backpackCapacityGold","skillDetails","bonus","warehouse","canAfford","amount","inv","bp","backpackItem","inventoryItem","hasRoomFor","isCurrencyItem","isHomestead","maxBackpack","capacity","fetchInventoryAndBackpack","_response$data","_response$data2","_response$data3","_response$data4","fetchInventory","_response$data5","refreshPlayerAfterInventoryUpdate","preserveInventory","_merged$location","gridPlayer","_updatedPlayerData$lo","gainIngredients","_currentPlayer$locati2","storingInBackpack","_currentPlayer$skills2","isCapacityError","isMissingBackpack","isNetworkError","deltaPayload","_err$response","_err$response2","_err$response3","_err$response4","_err$response4$data","_err$response4$data$e","_err$response5","_err$response5$data","_err$response5$data$e","_err$response6","updatedInventory","updatedBackpack","deltaChanges","remaining","used","TRANSIT_POSITIONS","_playerData$position$","_playerData$position","_playerData$position$2","_playerData$position2","currentGridId","settlementId","frontierId","hasHorse","_currentPlayer$backpa","_currentPlayer$invent","hasHomeDeedInBackpack","hasHomeDeedInInventory","signpostPosition","newPlayerPosition","isPlayerOwnedTown","targetSettlementId","settlement","grids","townGrid","grid","offsets","_g$gridId","_g$gridId2","stringMatch","frontierTier","frontierIndex","setRow","setCol","gRow","gCol","coord","padStart","decodeCoord","rowOffset","colOffset","newGRow","newGCol","newSetRow","newSetCol","targetSettlement","targetGrid","entryPosition","fromX","fromY","oppositeSignpostType","oppositeSignpostFound","gridResourcesResponse","oppositeSignpost","getEntryPosition","aa","ca","da","ea","fa","ha","ia","ja","ka","la","ma","acceptsBooleans","attributeName","attributeNamespace","mustUseProperty","propertyName","sanitizeURL","removeEmptyString","ra","sa","ta","pa","isNaN","qa","oa","removeAttribute","setAttribute","setAttributeNS","xlinkHref","ua","va","wa","ya","za","Aa","Ba","Ca","Da","Ea","Fa","Ga","Ha","Ia","Ja","Ka","La","Ma","Na","Oa","prepareStackTrace","Reflect","construct","displayName","Pa","tag","Qa","Ra","Sa","Ta","nodeName","Va","_valueTracker","getOwnPropertyDescriptor","getValue","setValue","stopTracking","Ua","Wa","checked","Xa","activeElement","Ya","defaultChecked","_wrapperState","initialChecked","Za","initialValue","controlled","ab","bb","db","ownerDocument","eb","fb","selected","defaultSelected","disabled","gb","dangerouslySetInnerHTML","hb","ib","jb","textContent","kb","lb","mb","nb","namespaceURI","innerHTML","valueOf","firstChild","MSApp","execUnsafeLocalFunction","ob","lastChild","nodeType","nodeValue","pb","animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","order","orphans","tabSize","widows","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","qb","rb","sb","setProperty","tb","menuitem","area","base","br","col","embed","hr","input","keygen","link","meta","param","track","wbr","ub","vb","is","wb","xb","srcElement","correspondingUseElement","parentNode","yb","zb","Ab","Bb","Cb","stateNode","Db","Eb","Fb","Gb","Hb","Ib","Jb","Kb","Lb","Mb","Nb","Ob","Pb","Qb","Rb","Sb","Tb","Vb","alternate","Wb","memoizedState","dehydrated","Xb","Zb","child","sibling","Yb","$b","ac","bc","cc","dc","ec","fc","gc","hc","ic","jc","kc","lc","oc","clz32","qc","LN2","rc","sc","tc","uc","pendingLanes","suspendedLanes","pingedLanes","entangledLanes","entanglements","vc","xc","yc","zc","Ac","eventTimes","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Jc","Kc","Lc","Mc","Nc","Oc","Pc","Qc","Rc","Sc","pointerId","Tc","nativeEvent","blockedOn","domEventName","eventSystemFlags","targetContainers","Vc","Wc","priority","isDehydrated","containerInfo","Xc","Yc","dispatchEvent","Zc","$c","ad","bd","cd","dd","ed","fd","gd","hd","Uc","stopPropagation","jd","kd","ld","md","nd","od","keyCode","charCode","pd","qd","rd","_reactName","_targetInst","currentTarget","isDefaultPrevented","defaultPrevented","returnValue","isPropagationStopped","preventDefault","cancelBubble","persist","isPersistent","wd","yd","sd","eventPhase","bubbles","cancelable","timeStamp","isTrusted","td","ud","detail","vd","Ad","screenX","screenY","clientX","clientY","pageX","pageY","ctrlKey","shiftKey","altKey","metaKey","getModifierState","zd","button","buttons","relatedTarget","fromElement","toElement","movementX","movementY","Bd","Dd","dataTransfer","Fd","Hd","animationName","elapsedTime","pseudoElement","Id","clipboardData","Jd","Ld","Md","Esc","Spacebar","Left","Up","Right","Down","Del","Win","Menu","Apps","Scroll","MozPrintableKey","Nd","Od","Alt","Control","Meta","Shift","Pd","Qd","repeat","locale","which","Rd","Td","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","Vd","touches","targetTouches","changedTouches","Xd","Yd","deltaX","wheelDeltaX","deltaY","wheelDeltaY","wheelDelta","deltaZ","deltaMode","Zd","$d","ae","be","documentMode","ce","ee","fe","ge","he","ie","le","color","date","datetime","email","month","search","tel","time","week","me","ne","oe","pe","qe","se","te","ue","ve","we","xe","ye","ze","oninput","Ae","detachEvent","Be","Ce","De","Ee","Fe","He","Ie","Je","Ke","node","nextSibling","Le","contains","compareDocumentPosition","Me","HTMLIFrameElement","contentWindow","Ne","contentEditable","Oe","focusedElem","selectionRange","documentElement","selectionStart","selectionEnd","defaultView","getSelection","rangeCount","anchorNode","anchorOffset","focusNode","focusOffset","createRange","setStart","removeAllRanges","addRange","setEnd","element","scrollLeft","scrollTop","focus","Pe","Qe","Re","Se","Te","Ue","Ve","We","animationend","animationiteration","animationstart","transitionend","Xe","Ye","Ze","animation","$e","af","bf","cf","df","ef","ff","gf","hf","lf","mf","nf","Ub","of","pf","qf","rf","sf","capture","passive","tf","uf","parentWindow","vf","wf","na","xa","$a","ba","je","ke","xf","yf","zf","Af","Bf","Cf","Df","Ef","__html","Ff","Gf","Hf","Jf","If","Kf","Lf","Mf","previousSibling","Nf","Of","Pf","Qf","Rf","Sf","Tf","Uf","Vf","Wf","Xf","Yf","contextTypes","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","Zf","childContextTypes","$f","ag","bg","getChildContext","cg","__reactInternalMemoizedMergedChildContext","dg","eg","fg","gg","hg","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","wg","xg","yg","zg","Ag","Bg","elementType","deletions","Cg","pendingProps","overflow","treeContext","retryLane","Dg","mode","Eg","Fg","Gg","memoizedProps","Hg","Ig","Jg","Kg","Lg","_stringRef","Mg","Ng","Og","Pg","Qg","Rg","implementation","Sg","Tg","Ug","Vg","Wg","Xg","Yg","Zg","$g","ah","bh","childLanes","ch","dependencies","firstContext","lanes","dh","eh","memoizedValue","fh","gh","hh","interleaved","ih","jh","kh","updateQueue","baseState","firstBaseUpdate","lastBaseUpdate","shared","effects","lh","mh","eventTime","lane","nh","oh","ph","qh","rh","sh","th","uh","vh","wh","xh","yh","tagName","zh","Ah","Bh","Ch","revealOrder","Dh","Eh","_workInProgressVersionPrimary","Fh","Gh","Hh","Ih","Jh","Kh","Lh","Mh","Nh","Oh","Ph","Qh","Rh","Sh","Th","baseQueue","queue","Uh","Vh","Wh","lastRenderedReducer","hasEagerState","eagerState","lastRenderedState","dispatch","Xh","Yh","Zh","$h","ai","getSnapshot","bi","ci","di","lastEffect","stores","ei","gi","hi","ii","deps","ji","ki","li","mi","ni","oi","pi","qi","ri","si","ti","ui","vi","wi","xi","yi","zi","Ai","Bi","readContext","useMutableSource","unstable_isNewReconciler","identifierPrefix","Ci","Di","Ei","_reactInternals","Fi","shouldComponentUpdate","Gi","contextType","Hi","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","Ii","getDerivedStateFromProps","getSnapshotBeforeUpdate","UNSAFE_componentWillMount","componentWillMount","componentDidMount","Ji","digest","Ki","Li","Mi","WeakMap","Ni","Oi","Pi","Qi","getDerivedStateFromError","componentDidCatch","Ri","componentStack","Si","pingCache","Ti","Ui","Vi","Wi","Xi","Yi","Zi","$i","aj","bj","cj","dj","baseLanes","cachePool","transitions","ej","fj","gj","hj","ij","UNSAFE_componentWillUpdate","componentWillUpdate","componentDidUpdate","jj","kj","pendingContext","lj","zj","Aj","Bj","Cj","mj","nj","oj","fallback","pj","qj","sj","dataset","dgst","tj","uj","_reactRetry","rj","subtreeFlags","vj","wj","isBackwards","rendering","renderingStartTime","last","tailMode","xj","Dj","Ej","Fj","wasMultiple","multiple","suppressHydrationWarning","onClick","onclick","createElementNS","autoFocus","createTextNode","Gj","Hj","Ij","Jj","Kj","WeakSet","Lj","Mj","Nj","Pj","Qj","Rj","Sj","Tj","Uj","Vj","insertBefore","_reactRootContainer","Wj","Xj","Yj","Zj","onCommitFiberUnmount","componentWillUnmount","ak","bk","ck","dk","ek","isHidden","fk","gk","display","hk","ik","jk","kk","__reactInternalSnapshotBeforeUpdate","Vk","lk","mk","nk","Y","Z","pk","qk","rk","sk","tk","uk","vk","wk","xk","yk","zk","Ak","Bk","Ck","Dk","callbackNode","expirationTimes","expiredLanes","wc","callbackPriority","ig","Ek","Fk","Gk","Hk","Ik","Jk","Kk","Lk","Mk","Nk","finishedWork","finishedLanes","Pk","timeoutHandle","Qk","Rk","Sk","Tk","Uk","mutableReadLanes","Bc","Oj","onCommitFiberRoot","mc","onRecoverableError","Wk","onPostCommitFiberRoot","Xk","Yk","$k","pendingChildren","al","mutableSourceEagerHydrationData","bl","pendingSuspenseBoundaries","dl","fl","gl","hl","il","yj","Zk","kl","reportError","ll","_internalRoot","ml","nl","ol","pl","rl","ql","unmount","unstable_scheduleHydration","form","sl","usingClientEntryPoint","Events","tl","findFiberByHostInstance","bundleType","rendererPackageName","ul","rendererConfig","overrideHookState","overrideHookStateDeletePath","overrideHookStateRenamePath","overrideProps","overridePropsDeletePath","overridePropsRenamePath","setErrorHandler","setSuspenseHandler","scheduleUpdate","currentDispatcherRef","findHostInstanceByFiber","findHostInstancesForRefresh","scheduleRefresh","scheduleRoot","setRefreshHandler","getCurrentFiber","reconcilerVersion","__REACT_DEVTOOLS_GLOBAL_HOOK__","vl","isDisabled","supportsFiber","inject","createPortal","cl","unstable_strictMode","findDOMNode","flushSync","hydrate","hydratedSources","_getVersion","_source","unmountComponentAtNode","unstable_batchedUpdates","unstable_renderSubtreeIntoContainer","gridCoordToBitIndex","relevantPart","settlementRow","settlementCol","gridCol","bitIndexToGridCoordPart","bitIndex","settlementIndex","gridIndex","toByteArray","binaryString","atob","byteIndex","bitPosition","getVisitedGridCoords","visited","byte","bitPos","gridCoordPart","getIngredientDetails","allResources","ingredients","ingredientResource","existingTiles","newTiles","row","changed","oldTile","raw","template","isACrop","itemType","hasRequiredSkill","owned","isVisibleToPlayer","newResources","farmTimer","initializeFarmState","seed","startSeedTimer","completedSeeds","successfulCount","newCrop","forceProcessPendingSeeds","updatePromises","successfulUpdates","seedPositions","processedSeeds","stopSeedTimer","notificationRoot","notificationTimer","globalClickHandlers","PERSISTENT_NOTIFICATION_TYPES","Notification","onDismiss","React","className","_jsxs","cursor","renderContent","_Fragment","registerNotificationClickHandler","handler","container","getElementById","ReactDOM","clickHandler","notificationKey","handleDismiss","globalFloatingTexts","globalForceUpdate","tick","setTick","displayText","newId","EDGE_THRESHOLD","gridSize","onAnimationEnd","checkDCE","gridDataKeys","tilesLength","resourcesLength","tilesType","resourcesType","firstTile","firstResource","processedResources","loadedResources","shadowX","processedResourcesLength","aboutToSetGrid","aboutToSetResources","aboutToSetTileTypes","globalTilesLength","globalResourcesLength","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","chunkId","miniCssF","dataWebpackPrefix","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","doneFns","installedChunks","installedChunkData","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","checkDeveloperStatus","getItem","currentSettlementId","currentFrontierId","messages","setMessages","inputText","setInputText","endRef","_false","json","fetchMessages","_endRef$current","scrollIntoView","handleSend","trimmed","onChange","onKeyDown","tileColors","BITS_TO_TILE_TYPE","tilePriorityOrder","fromEntries","bits","getTileColor","TILE_ROUNDING_CONFIG","drawGrassTuft","tuftSeed","save","translate","rotate","fillStyle","beginPath","px","py","drawX","drawY","moveTo","lineTo","closePath","fill","restore","calculateCornerColor","corner","rowIndex","colIndex","_tileTypes","_tileTypes$rowIndex","_tileTypes2","_tileTypes3","_tileTypes$rowIndex2","_tileTypes4","_tileTypes5","_tileTypes$rowIndex3","_tileTypes6","_tileTypes7","_tileTypes$rowIndex4","_tileTypes8","adjacentTiles","priorityType","createTileTexture","variation","zoomLevel","roundedCorners","topLeft","topRight","bottomRight","bottomLeft","adjacentChecks","neighbors","allNeighborsDifferent","neighbor","_tileTypes$neighbor$r","calculateRoundedCorners","fillRect","cornerSize","radius","quadraticCurveTo","baseX","baseY","lightSeed","lightX","lightY","lightSize","numPatches","patchSeed","PI","arc","grassColor","cornerRadius","globalAlpha","drawRoundedRect","clip","grassWidth","bevelSize","inset","uniqueSeed","numGrassTufts","grassSeed","isHorizontal","side","extensionIntoStone","stretchLength","stretchWidth","baseRotation","ellipse","numCracks","crackSeed","strokeStyle","lineWidth","lineCap","lineJoin","drawWigglyLine","toX","toY","wiggleAmount","segments","linearX","linearY","perpAngle","atan2","wiggleSeed","wiggleOffset","sin","randomWiggle","wiggleX","cos","wiggleY","mainLength","mainAngle","stemEndX","stemEndY","stroke","forkProgress","forkX","forkY","forkLength","forkAngleSpread","leftForkAngle","leftEndX","leftEndY","rightForkAngle","rightEndX","rightEndY","RenderTilesCanvas","handleTileClick","canvasRef","lastRenderData","getTileTexture","renderTiles","_grid$","rows","cols","clearRect","_tileTypes$rowIndex5","handleCanvasClick","_grid$2","imageRendering","CORNER_PRIORITY","TILE_EDGE_STYLE","isOrganicTile","getNeighbor","defaultType","_tileTypes$row$col","_tileTypes$row","drawSingleBeveledStone","mainColor","highlightColor","shadowColor","addTileTexture","varSeed","positions","yellowPos","offsetSeed","offsetX","offsetY","darkPositions","dotSeed","lightPositions","pebbleSeed","psize","shellSeed","ssize","crackColor","crackHighlight","drawCrackSegment","endX","endY","segSeed","midX","midY","bulge","ctrlX","ctrlY","cSeed","startEdge","mainWidth","forkAngle","segAngle","segLength","nextX","nextY","forkSpread","branchLength","leftAngle","rightAngle","subLength","subAngle","speckCount","speckSeed","shadowPositions","sparklePositions","driftSeed","dsize","clumpSeed","clumpSize","points","angle","radiusVariation","yellowSeed","accentPositions","accentSeed","shadowSeed","createTileTextureV2","baseColor","halfSize","ox","oy","stoneSeed","colorVariation","crackStartX","crackStartY","crackEndX","crackEndY","grassDark","tuftCount","edge","tSeed","edgePos","bladeCount","bladeSpacing","drawBeveledStoneTile","myPriority","bottom","right","drawOuterCorner","fillColor","neighborPriority","drawCornerRounding","RenderTilesCanvasV2","lastTileTypes","_tileTypes$","keysToDelete","_tileTypes$row2","_lastTileTypes$curren","dr","nr","_tileTypes$nr","getResourceOverlayStatus","craftingStatus","tradingStatus","badgeState","electionPhase","_craftingStatus$ready","_craftingStatus$inPro","_tradingStatus$ready","resourceKey","isCraftReady","isCraftInProgress","isTradingReady","mailbox","OVERLAY_SVG_MAPPING","RenderResourcesCanvas","renderingRef","SVGAssetManager","renderResources","renderTimeout","displayWidth","displayHeight","actualWidth","actualHeight","scale","renderSingleResource","overlayResources","renderResourceOverlay","visualY","filename","getResourceFilename","masterResource","renderResourceEmoji","textAlign","textBaseline","font","fillText","overlayInfo","overlayType","overlaySize","overlayX","overlayY","overlayTexture","craftingReady","craftingInProgress","tradingReady","mailboxBadge","RenderResources","checkRange","playerPos","targetPos","extractXY","playerRange","isAHit","attackRoll","hitRoll","calculateDamage","randomDamageModifier","descriptionKey","titleKey","xmlns","viewBox","strokeLinecap","strokeLinejoin","x2","y2","onAction","transactionKey","isProcessing","setIsProcessing","transactionId","AnimalPanel","stationType","currentStationPosition","stallDetails","setStallDetails","currentNPC","setCurrentNPC","setCurrentTime","stallResource","updateNPCData","interval","storedInventory","serverInventory","syncInventory","Panel","remainingTime","getNPCStatusText","TransactionButton","totalRefund","formatCollectionResults","operation","results","skillsInfo","replantInfo","label","itemParts","skillInfo","localizedName","skillsStr","replantParts","formatSingleCollection","handleProtectedFarmAnimalCollection","currentNPCState","collectedQuantity","collectedItem","skillsApplied","gained","animalsAtSamePosition","otherAnimal","_error$response3$data","_error$response4","errorMessage","errorDetails","currentUsage","serverStateMatch","serverState","otherProcessingAnimal","_otherNpc$position3","_otherNpc$position4","handleNPCClick","setModalContent","setIsModalOpen","setActiveStation","allAnimalsAtPosition","_otherNpc$position5","_otherNpc$position6","processingAnimalAtSamePosition","freshNPC","npcResource","xp","xpResponse","xpAmount","newXP","resourceDetails","enrichedResource","_currentPlayer$active","handleAttackOnNPC","globalAttackCooldown","generateNPCTooltipContent","localizedNPCType","tooltipContent","countdownText","handleNPCClickShared","_currentPlayer$locati5","getNPCOverlay","onNPCClick","setHoverTooltip","overlayData","clickable","isOnOwnHomestead","_pcState$speed","pcState","cooldownSeconds","cooldownDuration","_currentPlayer$locati3","_currentPlayer$locati4","npcPos","getAttackCooldownStatus","cooldownEnd","isOnCooldown","getNPCCursorClass","setCanvasCursor","cursorClass","calculateTooltipPosition","mouseX","mouseY","gameContainerSelector","margin","adjustedX","adjustedY","tooltipRightEdge","tooltipWidth","activeConversations","relationshipOutcomes","addSpeech","speakerId","topic","matchState","notifyListeners","removeSpeech","getSpeech","showOutcome","defaultEmoji","finalEmoji","getOutcome","RenderNPCsCanvas","onMouseEnter","onMouseLeave","checkQuestNPCStatus","checkTradeNPCStatus","checkKentNPCStatus","getOverlayContent","currentHoveredNPC","tooltipUpdateInterval","cursorUpdateInterval","canvasAnimations","animationFrameId","renderNPCsRef","startAnimationLoop","hasActiveAnimations","elapsed","currentPos","startPos","hasPositionChanges","currentAnimation","cancelAnimationFrame","getNPCRenderPosition","stopTooltipTimer","stopCursorUpdateInterval","updateCurrentTooltip","tooltipData","startTooltipTimer","renderNPCs","renderNPCAttackRange","renderSingleNPC","renderNPCOverlay","renderPos","renderNPCEmoji","_currentPlayer$settin","rangeOn","setLineDash","interpolatedPos","elementBelow","elementFromPoint","clickEvent","MouseEvent","startCursorUpdateInterval","handleCanvasMouseMove","tooltipPosition","handleCanvasMouseLeave","onMouseMove","RenderNPCs","PCComponent","isCurrentPlayer","onPCClick","connectedPlayers","isHovered","setIsHovered","conversationIcon","setConversationIcon","speechBubble","setSpeechBubble","relationshipOutcome","setRelationshipOutcome","elementRef","hoverTimeoutRef","prevTileSizeRef","updatePosition","updateConversation","speech","ConversationManager","outcome","isCamping","isInBoat","showRangeIndicators","derivedRange","attackRange","backgroundColor","borderRadius","border","alignItems","justifyContent","handleMouseEnter","_elementRef$current","handleMouseLeave","RenderPCsDOM","RenderPCs","RenderDynamicElementsCanvas","hoverTooltip","timers","generateResourceTooltip","generateNPCTooltip","generatePCTooltip","onTileHover","cursorModeActive","conversationVersion","setConversationVersion","currentTooltipData","renderOverlays","stopTooltipUpdateInterval","startTooltipUpdateInterval","entity","entityType","overlayDiv","_tooltipDebugLogged","anyResource","tooltipResource","background","renderSpeechBubbles","marginBottom","padding","borderWidth","cacheTime","cacheExpiry","pendingRequest","getQuests","invalidate","getQuestsForNPC","giver","lines","localizedResourceType","dungeon","dungeonEndTime","endTime","actualPhase","phase","hours","minutes","seconds","timeString","days","npcQuests","questCache","_currentPlayer$comple","activeQuest","repeatable","completedQuests","hasCompletedQuests","_currentPlayer$active2","tradeResource","_currentPlayer$kentOf","kentOffers","offers","offer","_currentPlayer$invent2","_currentPlayer$backpa2","RenderDynamicElements","isSearching","searching","hungry","tradeStall","trade","sellTime","boughtBy","hoveredTile","cursorMode","gridWidth","gridHeight","tileCol","tileRow","strokeRect","lockedResources","unlockResource","getPersonalizedWarehouseRarity","_rarityRotation$itemT","rarityGroup","hash","getPlayerRarityGroup","STANDARD_RARITY_TABLE","getRarityChance","rarity","level","baseRarity","rarityScale","selectWeightedRandomItem","items","totalWeight","scrollchance","roll","cumulative","handleResourceClick","resourcePos","fetchedInventory","fetchedBackpack","handleDooberClick","handleSourceConversion","baseQtyCollected","dooberId","_processingDoobers","qtyCollected","_masterSkills$item$ty","isSkill","appliesToResource","buffItem","buff","_masterSkills$buff","gainResult","collectedItemType","dropped","dropRate","harvestDropRate","toFixed","warehouseIngredients","selectedIngredient","ingredient","added","checkAndDropWarehouseIngredient","collectedResource","farmplotResource","rolledBackResources","handleReplant","requirement","messageKey","originalResource","filteredResources","UILockContext","UILockProvider","uiLocked","setUILocked","isOpen","npcName","relationshipType","dialogKey","directDialogKey","currentPage","setCurrentPage","pages","setPages","visibleWordCount","setVisibleWordCount","isAnimating","setIsAnimating","animationRef","isInitialMount","relationshipDialogKeys","met","friend","married","love","rival","RelationshipMatrix","displaySymbol","rawDialogText","npcDialogStringId","dialogText","sentences","newPages","currentPageText","sentence","trimmedSentence","totalWords","isLastPage","words","visibleText","isTextComplete","handleOk","handleNext","setActiveQuestGiver","currentStepData","setCurrentStepData","showFeedbackModal","setShowFeedbackModal","setPositiveReasons","setNegativeReasons","stepData","step1Data","notificationIcon","addQuests","questTemplates","playerState","addQuestsForStep","showModal","handleOK","onFeedbackSubmit","continueStepLogic","actualCurrentStep","hasNextStep","continue","_currentPlayer$ftueFe","_currentPlayer$ftueFe2","hasFeedback","showFeedbackModalAfter","toggleReason","reasonIndex","StoryModal","bodyKey","doinkerTarget","setTargetPosition","findTargetResource","centerOffset","pixelX","pixelY","arrowHeight","arrowWidth","GridStatePCContext","GridStatePCUpdateContext","GridStatePCProvider","GridStateContext","GridStateUpdateContext","GridStateProvider","controlledGrids","setupSocketListeners","retryTimeout","setAsController","removeController","joinGrid","leaveGrid","controllerData","StatusBarContext","StatusBarProvider","messageIdRef","newMessage","predefinedMessage","messageObject","StatusBar","displayMessages","setDisplayMessages","slideOffset","setSlideOffset","scrollPosition","setScrollPosition","canScrollRight","setCanScrollRight","prevFirstId","newMessageRef","messagesContainerRef","viewportRef","_messages$","currentFirstId","_newMessageRef$curren","offsetWidth","_newMessageRef$curren2","containerWidth","viewportWidth","handleScrollLeft","_viewportRef$current","visibility","whiteSpace","handleScrollRight","maxScroll","BulkOperationContext","BulkOperationProvider","activeBulkOperations","setActiveBulkOperations","startBulkOperation","operationType","operationId","endBulkOperation","newState","getActiveBulkOperations","useBulkOperation","getGridBackgroundColor","TILE_COLORS","unknown","GRID_SIZE","RenderVisitedGrid","encodedTiles","packedBytes","flatTiles","bitBuffer","bitsInBuffer","decodeTiles","pixelSize","offscreen","offCtx","setZoomLevel","isRelocating","setIsRelocating","visibleSettlementId","setVisibleSettlementId","settlementGrid","setSettlementGrid","players","setPlayers","setError","NPCsInGrids","setGridStates","playersInGridMap","visitedGridTiles","setVisitedGridTiles","setTooltipData","gridStates","playersArray","playersById","gridIds","gridStateResponse","mergedPlayersInGrid","_gridStateResponse$da","_gridStateResponse$da2","fetchData","visitedSSGG","coordsToFetch","gridCoords","tilesMap","fetchVisitedGridTiles","playerGridId","playerRow","playerCol","_settlementGrid$row$c","playerTile","block","inline","updatedRect","tileCenterX","tileCenterY","windowCenterX","windowCenterY","scrollX","scrollY","centerCameraOnPlayerGrid","available","fromGridId","targetGridCoord","relocationResponse","processRelocation","_pcs","arrivalX","arrivalY","handleTileMouseMove","getTooltip","handleTileMouseLeave","renderMiniGrid","tileData","settlementTileData","isPlayerHere","owner","ownerIdStr","miniX","miniY","isValleyGrid","usePixelRendering","playerPCs","playerPC","_playerPCs","_playerPC","hasVisitedTiles","isMarkedVisited","cell","stall","_owner2","role","_owner3","_owner3$netWorth","netWorth","toLocaleString","contentClasses","frontierGrid","setFrontierGrid","settlementGrids","setSettlementGrids","checkAndShowFrontierTip","_settlementGrids$tile","_tile$settlementType","frontierTileData","settlementType","flatSettlementGrid","isPureValleySettlement","isHomesteadSettlement","cellStyle","isValleyType","calculatedSSGG","hasBeenVisited","ownedHomestead","_currentPlayer$locati6","_currentPlayer$locati7","_currentPlayer$locati8","_currentPlayer$locati13","_currentPlayer$locati14","_currentPlayer$locati15","_currentPlayer$locati16","_currentPlayer$locati17","countdowns","playerGridPosition","gridCoordStr","finalRow","finalCol","homesteadGridPosition","isInDungeon","isInHomeTown","isPlayerPosition","isHomesteadPosition","isPlayer","currentRegion","displayTitle","_currentPlayer$locati9","_currentPlayer$locati10","_currentPlayer$locati11","_currentPlayer$locati12","fontFamily","cellClass","cellTitle","_countdown$match","_countdown$match2","_countdown$match3","countdown","isLessThanOneMinute","custom","message2","stripePromise","RELEASE_TRAIN","ORIGIN","STRIPE_JS_URL","V3_URL_REGEX","STRIPE_JS_URL_REGEX","EXISTING_SCRIPT_MESSAGE","injectScript","queryString","advancedFraudSignals","headOrBody","stripePromise$1","onErrorListener","onLoadListener","loadScript","Stripe","findScript","_script$parentNode","onLoad","loadCalled","getStripePromise","loadStripe","maybeStripe","isTestKey","runtimeVersionToUrlVersion","expectedVersion","stripe","_registerWrapper","registerWrapper","initStripe","handlePurchase","offerId","redirectToCheckout","sessionId","openMailbox","setOffers","purchaseSuccess","history","replaceState","fetchOffers","Modal","activeOffers","shelflifeDays","created","isOfferExpired","processedIds","offer3","offer4","rewards","_resources$find","price","_resources$find2","offer6","offer7","offer8","_resources$find3","_resources$find4","_resources$find5","_resources$find6","_inventory$find","onAcceptDeath","onRevive","reviveCost","playerGems","hasEnoughGems","offerData","offerMap","marginRight","marginTop","borderTop","paddingTop","flexDirection","gap","ALLOWED_CATEGORIES","currentLevel","previousLevel","questGivers","setQuestGivers","questsAtLevel","giverMap","fetchQuestGivers","unlockedResources","shouldShowResource","handleClose","enabledLanguages","LanguagePickerModal","onSave","selectedLanguage","setSelectedLanguage","LANGUAGE_OPTIONS","flag","isEnabled","handleLanguageClick","langCode","getMayorUsername","_settlement$roles","mayorRole","roles","roleName","getDerivedLevel","playerXP","getXpForNextLevel","nextLevelIndex","ChangeIconModal","currentIcon","setModalIsOpen","selectedIcon","setSelectedIcon","freeIcons","ICON_OPTIONS","paidIcons","locked","isEmoji","updatedCurrentPlayer","updatePlayerIcon","alert","updatePlayerSettings","newSettings","playerIdForServer","ModalContext","useModalContext","ModalProvider","activeModal","setActiveModal","openModal","modalName","closeModal","_LANGUAGE_OPTIONS$fin","handleLogout","handlePCClick","showChangeIconModal","setShowChangeIconModal","showGoldBenefitsModal","setShowGoldBenefitsModal","setFormData","isSaving","setIsSaving","setErrorMessage","localSettings","setLocalSettings","isStateMachineEnabled","isTeleportEnabled","toggleVFX","seasonOverride","_settings$isStateMach","_settings$isTeleportE","_settings$toggleVFX","_settings$rangeOn","_settings$seasonOverr","handleInputChange","handleToggleChange","updatedSettings","currentPC","_error$response$data","confirm","removeItem","relocations","handleLanguage","newIcon","GoldPassBenefitsModal","trackAccountCreation","userId","trackGoogleAccountCreation","gtag","currency","user_id","custom_parameters","rdt","trackFacebookAccountCreation","fbq","content_name","ttq","content_id","trackTikTokAccountCreation","getOSType","windowsMatch","ntVersion","macMatch","iosMatch","androidMatch","setIsLoggedIn","setUsername","setPassword","setLanguage","isSubmitting","setIsSubmitting","onSubmit","frontierName","frontierResponse","frontier","assignedSettlementId","townGridId","settlements","settlementResponse","flatGrids","availableHomestead","townGridData","diagnostics","_navigator$connection","_navigator$connection2","_window$screen","_window$screen2","latency","pingStart","webglSupported","connectionType","connection","effectiveType","downlink","screenWidth","screen","screenHeight","viewportHeight","deviceMemory","hardwareConcurrency","isMobile","isTouchDevice","maxTouchPoints","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","getDiagnostics","registerPayload","startInTown","os","startingGridId","baseAttackbonus","baseArmorclass","baseDamage","baseAttackrange","baseSpeed","messageId","mailError","_err$response$data","onLoginSuccess","showCreateAccount","setShowCreateAccount","CreateAccount","required","formatJSON","currentNPCs","currentPCs","_currentPlayer$wareho","setTimers","setNPCs","setPCs","setUpdatedNPCs","refreshDebug","setRefreshDebug","singleGridCoord","setSingleGridCoord","toGridCoord","setToGridCoord","usernameToDelete","setUsernameToDelete","messageIdentifier","setMessageIdentifier","orphanedGridId","setOrphanedGridId","useV2Tiles","setUseV2Tiles","performanceMetrics","setPerformanceMetrics","fps","domElementCount","memoryUsage","renderMode","resourcesWithTimers","fetchTimers","timerInterval","prevTimers","growTimeRemaining","craftTimeRemaining","fetchGridStateEntities","frameCount","lastTime","measurePerformance","hasCanvasTiles","hasDOMTiles","memory","usedJSHeapSize","newValue","CustomEvent","gridTemplateColumns","parsedCoord","coordStr","matchingGridObj","handleTeleport","warehouseLevel","tilesConverted","resetResponse","townGrids","gridError","generateTownGrids","filteredInventory","clearedSkills","clearedPowers","combatStats","protectedNPCs","filteredRelationships","relationships","rel","command","clearGridState","clearedTrophies","resourcesToAdd","skillResources","skillsResponse","updatedSkills","existingSkill","foundGrid","foundSettlementId","foundFrontierId","createSingleValleyGrid","_username","deleteResponse","handleDeleteAccount","handleDeleteOrphanedGrid","sendMessageToAll","GridStateDebugPanel","showActions","warehouseAmounts","setWarehouseAmounts","handleAmountChange","handleDiscardWarehouseItem","amounts","setAmounts","handleActionItem","actionButtonText","actionButtonClass","isActionDisabled","handleSecondAction","secondActionButtonText","secondActionButtonClass","passedStrings","contextStrings","sortField","setSortField","sortDirection","setSortDirection","sortedInventory","aValue","bValue","aResource","bResource","handleSort","field","getSortIcon","resourceData","isFood","marginLeft","_inventory$find2","_inventory$find3","_inventory$find4","_inventory$find5","_inventory$find6","showBackpackModal","setShowBackpackModal","showWarehouseModal","setShowWarehouseModal","inventorySortField","setInventorySortField","inventorySortDirection","setInventorySortDirection","backpackSortField","setBackpackSortField","backpackSortDirection","setBackpackSortDirection","backpackAmounts","setBackpackAmounts","hasBackpackSkill","finalCapacities","warehouseGoldBonus","backpackGoldBonus","calculateTotalQuantity","handleInventorySort","getInventorySortIcon","handleBackpackSort","getBackpackSortIcon","maxValue","clampedValue","handleMoveAll","isAtHome","itemsToMove","totalToMove","currentWarehouseUsage","updatedWarehouseInventory","existingIndex","invItem","itemsToKeep","flexWrap","resourceDef","_inventory$find7","maxHeight","_masterResources$find","_masterResources$find2","nonSpecialItems","isAddAllDisabled","ManageContentsModal","spaceAvailable","updatedWarehouse","newQuantity","handleMoveItem","currentBackpackUsage","transfers","handleDiscardAllWarehouse","calculateGemPurchase","_safeInventory$find","_safeBackpack$find","overrideGemCost","safeInventory","safeBackpack","safeMasterResources","ownedSkills","spendingItems","_safeInventory$find2","_safeBackpack$find2","playerQty","willSpend","gemCost","missingIngredientCost","_safeInventory$find3","_safeBackpack$find3","missingQty","gemcost","getModifiedRecipe","_safeInventory$find4","_safeBackpack$find4","gemSlot","formatDetailsForDisplay","formatNumber","info","hideInfo","onTransactionAction","isTransactionMode","onGemPurchase","hideGem","meetsLevelRequirement","devOnly","showInfo","setShowInfo","setTooltipPosition","showGemTooltip","setShowGemTooltip","gemTooltipPosition","setGemTooltipPosition","buttonRef","shouldCalculateGem","gemCalculation","updateTooltipPosition","updateGemTooltipPosition","setCurrentLevel","nextLevel","setNextLevel","needsLevelMigration","setNeedsLevelMigration","showBenefitsModal","setShowBenefitsModal","migrateLevelToPlayer","handleUpgrade","customRecipe","recipeToUse","newCapacity","newLevel","Level","ResourceButton","textDecoration","setTrophies","setLoading","collecting","setCollecting","fetchTrophies","playerTrophyA","playerTrophyB","isEarnedA","isEarnedB","hasUncollectedRewardA","hasUncollectedRewardB","playerTrophy","isEarned","progressInfo","getProgressInfo","currentProgress","progressArray","lastAchievedMilestone","lastMilestone","milestoneDifference","percentage","hasAchievedAll","hasUncollectedReward","isCollecting","tooltip","gemReward","prevTrophies","handleCollectReward","QuestButton","goals","reward","rewardqty","goal","QuestGiverButton","xpReward","buttonText","handleClick","playerQuests","setPlayerQuests","setQuestTemplates","quests","questsUpdated","updatedQuest","_currentPlayer$powers","playerHasSkill","playerHasPower","reevaluateQuestProgress","fetchQuestTemplates","_quest$progress","_quest$progress2","_quest$progress3","textbody","updateRelationship","targetName","_currentPlayer$relati","relationship","initialScore","updateRelationshipStatus","allCharacters","metCharacters","charName","trophyResponse","trophyError","getRelationshipStatus","relscore","getRelationshipMultiplier","_currentPlayer$relati4","npcEntry","entry","buff4friend","buff4love","buff4marriage","bonusMessage","conversationResults","matchingInterests","matchingRandom","matchingTopics","rivalTopics","totalRounds","checkNPCRelationship","currentNpcType","targetNpcType","findNPCTypeFromSymbol","compareTopics","playerTopic","npcTopic","interaction","roundNum","chanceModifier","playerNpcType","playConversation","playerEmoji","npcEmoji","onComplete","numExchanges","rounds","topicContext","playerIcon","npcIcon","playerSpeakerId","playerTopicKey","getTopicSymbol","showSpeech","hideSpeech","npcSpeakerId","npcTopicKey","topicKey","isPlayerTurn","topItems","npcInterests","interest","Topics","interest1","interest2","randomTopics","marriedRels","chosen","maxScore","topRels","kentEntry","playerShownNpcType","interest3","npcCharacters","weatherTopics","speakerType","INTERACTION_EMOJIS","failure","getInteractionEmoji","interactionName","isSuccess","normalizedName","emojis","RelationshipCard","targetType","targetEmoji","onRelationshipChange","compact","checkDistance","onInteractionClick","setRelationship","isInitializing","setIsInitializing","loadOrCreateRelationship","existingRel","newRel","handleInteraction","relationshipCheck","checkOtherRelationships","targetNPC","relbitadd","allowed","_currentPlayer$relati2","existingMarriage","targetRivals","_currentPlayer$relati3","playerRelWithRival","targetNPCEntry","targetLoves","conversationTargetEmoji","targetId","baseChance","chance","modifiedChance","calculateModifiedChance","buffField","relbuff","randomRoll","_conversationResults","_conversationResults2","matchBonus","rivalPenalty","relBuffBonus","scoreChange","relscoreresult","scoreStr","relBuffStr","debugStr","handleInteractionOutcome","updatedRel","statusResult","npcReactions","getNPCReactions","newStatus","reactions","npcRelationshipWithTarget","setScore","clearAllStatuses","setStatus","reaction","_statusResult$player$","_statusResult$player$2","scoreResult","statuses","isaninteraction","metResult","finalResult","_scoreResult$player$r","updatedRelWithReactor","statusMessage","negativeReactions","positiveReactions","generateRelationshipStatusMessage","relbitremove","removeResult","statusesToRemove","relscoremin","statusKey","statusItem","scoreColor","score","visibleStatuses","isvisible","availableInteractions","_interaction$relscore","_interaction$relscore2","minScore","relscoremax","relbitrequired","blockField","crush","isHealing","healAmount","onHealingComplete","animationTimeoutRef","conversationTimeoutRef","_playerInGridState$po","_playerInGridState$po2","playerInGridState","NPCPanel","_strings$","_npcData","_strings$2","_npcData2","_npcData4","questList","setQuestList","healRecipes","setHealRecipes","tradeRecipes","setTradeRecipes","setStatusMessage","canQuest","setCanQuest","hasHiddenQuests","setHasHiddenQuests","questThreshold","setQuestThreshold","canTrade","setCanTrade","tradeThreshold","setTradeThreshold","hasHiddenTrades","setHasHiddenTrades","setIsHealing","coolingDownItems","setCoolingDownItems","COOLDOWN_DURATION","storyModalOpen","setStoryModalOpen","storyRelationshipType","setStoryRelationshipType","preInteractionRelationshipRef","playerLevel","resourceLevel","questInteraction","currentScore","tradeInteraction","timeoutId","fetchQuests","filteredRecipes","traderOffers","trader","tradesHiddenByRelationship","gives","tradeqty","givesqty","ingredientCount","requiresField","requiresQtyField","isInCompleted","questsHiddenByRelationship","handleGemPurchase","handleHeal","handleTrade","itemKey","currentHp","maxHp","healerInGrid","_NPCsInGridManager$ge2","statToMod","updatedValue","modifyPlayerStatsInGridState","newHealerHP","quantityToGive","hasRoom","isMoney","isGem","_currentPlayer$skills3","spendResult","npcResourceForXP","xpToAward","ingredientList","requiresArray","ingredientString","playerRelationship","npcMatrix","interests","uniqueInterests","interestSymbols","relationshipTypes","targetSymbol","grouped","stringMap","rels","_currentPlayer$_id2","_NPCsInGridManager$ge3","npcInGrid","_currentPlayer$_id3","_playersInGridManager3","_NPCsInGridManager$ge4","_currentPlayer$relati5","_currentPlayer$_id4","_playersInGridManager4","preRel","fontStyle","questMeetsLevel","rewardQuantity","updatedCompletedQuests","prevList","handleGetReward","questTitle","acceptedQuest","initialProgress","isQuestCompleted","handleAcceptQuest","HealerInteraction","_currentPlayer$_id5","_playersInGridManager5","_NPCsInGridManager$ge5","affordable","isCoolingDown","healerOutOfHP","totalHeals","_currentPlayer$relati6","_currentPlayer$relati7","_currentPlayer$_id6","_playersInGridManager6","_NPCsInGridManager$ge6","_currentPlayer$_id7","_playersInGridManager7","_NPCsInGridManager$ge7","_currentPlayer$relati8","_currentPlayer$_id8","_playersInGridManager8","hasInInventory","hasInBackpack","meetsSkillRequirement","meetsLevel","requirementsMet","formattedCosts","_backpack$find","ingredientsList","_backpack$find2","levelColor","_currentPlayer$relati9","dialogStringId","dialogOnMet","storyText","_npcData3","BuildPanel","_currentPlayer$settin2","currentSeason","setCursorMode","setBuildOptions","setAllResources","isContentLoading","setIsContentLoading","isMayor","setIsMayor","placeWithCursor","setPlaceWithCursor","plantWithCursor","homeSettlementId","currentLocation","isPlayerMayor","mayorUsername","playerUsername","inventoryResponse","allResourcesData","buildTownResources","validBuildOptions","currentSettlementStr","homeSettlementStr","settlementsMatch","currentSettlement","homeSettlement","season","existingPetOfType","layoutkey","buildTownInFinal","totalOptions","buildTownIncluded","shouldHaveBuildTown","maxTownBuildings","currentTownBuildings","mr","checkRequiredSkill","townBuildingLimitReached","buttonClassName","_allResources$find","bpItem","skillColor","handleCursorModeSelect","BuyPanel","buyOptions","setBuyOptions","purchasableItems","maxFarmAnimals","currentFarmAnimals","countFarmAnimals","_NPCsInGrid$gridId","_allResources$find2","farmAnimalLimitReached","PetsPanel","inventoryQty","backpackQty","BuyDecoPanel","formatCountdown","timeDiff","formatDuration","secs","FarmingPanel","farmPlots","setFarmPlots","setPlantWithCursor","farmPlotsWithSeasonInfo","isOffSeason","_cursorMode$item","outputCrop","outputSymbol","cooldownTimer","handleFarmPlacementWithCooldown","DEFAULT_TILE_SYMBOLS","TILE_INFO_KEYS","ToolsPanel","useWithCursor","setUseWithCursor","farmPlotItems","getButtonClassName","handleButtonClick","handleTerraformWithCooldown","requiredLevel","meetsSkill","actionName","infoKey","infoText","handleProtectedSelling","resourcesAtPosition","stationX","stationY","refundIngredients","totalMoneyRefund","removedStation","soldResource","_error$response5","_error$response5$data","_error$response4$data","SkillsPanel","stationCategory","entryPoint","setEntryPoint","skillsToAcquire","setSkillsToAcquire","setOwnedSkills","stationEmoji","setStationEmoji","resourcesResponse","serverBackpack","serverSkills","stationResource","validCategories","availableSkills","fetchResourcesAndInventory","isItem","showSellButton","isTrainingBuilding","isOwned","attributeModifier","buffText","buffedItems","unlocks","calculateSettlementPopulation","settlementData","_settlementData$grids","setSettlementData","taxRate","setTaxRate","population","setPopulation","taxLog","setTaxLog","mayor","setMayor","buildingCounts","School","Hospital","Library","taxlog","taxrate","mayorName","fetchGovernmentData","taxLogTable","borderCollapse","reverse","toLocaleDateString","totalcollected","currentmayor","mayortake","showTitle","oracleRecipe","oracleItems","requiresKey","qtyKey","playerHasItem","hasEnoughItems","itemName","requiredQty","getSymbol","isLoading","setIsLoading","leaderboardData","setLeaderboardData","topPlayers","fullPlayerDataPromises","fullPlayer","sortedPlayers","fetchLeaderboardData","xpForNextLevel","currentLevelIndex","currentLevelXP","xpIntoLevel","xpRangeForLevel","xpProgress","HopeQuest","featureName","bankResource","bankRequiredLevel","bankOffers","setBankOffers","bankTimer","setBankTimer","bankPhase","setBankPhase","coolingDownButtons","setCoolingDownButtons","fetchBankOffers","_response$data$bank","_response$data$bank2","bank","updateCountdown","bankTimerData","handleTradeWithCooldown","buttonIndex","ingredient1","itemBought","ingredient1qty","qtyBought","itemGiven","qtyGiven","LevelLock","isInHomeSettlement","generateNewKentOffers","_currentPlayer$kentOf2","playerSkillTypes","isFirstTimeUser","eligibleResources","ingredient2","ingredient3","ingredient4","sourceResource","foundSourceResource","sourceType","sourceRequires","shouldFilter","attackResource","newOffers","maxOffers","maxKentOffers","currentOfferCount","offersToGenerate","requireCropBalance","cropOffersNeeded","cropOffersGenerated","_currentPlayer$kentOf3","allExistingOffers","resourceCounts","remainingOffers","cropOffersStillNeeded","cropResources","randomResource","maxprice","bonusRoll","valleyResources","selectedValleyResource","bonusQuantity","newOffer","setKentOffers","kentTimer","setKentTimer","kentPhase","setKentPhase","isTrading","setIsTrading","fetchKentOffers","kentData","fallbackKentOffers","wheatResource","generateFallbackKentOffer","updateKentTimer","refreshOffersAndSetTimer","kentRefreshSeconds","kentRefreshTimerSeconds","newEndTime","updatedKentOffers","completedOffer","kentOffersWithoutCompleted","removedIndex","updatedOffers","removeCompletedOffer","updateKentOffersAfterTrade","isKentOnCooldown","calculateKentXP","_offer$rewards$","_offer$rewards$2","convertedOffer","isLocked","allRewardsSuccess","originalOffer","kentOffer","rewardText","rewardIndex","handleDismissAll","generateTrainRewards","trainOffers","_globalTuning$trainRe","seasonKey","seasonalRewards","trainRewards","xpQuantity","intervals","scaledBase","randomFactor","finalXP","calculateScaledXPReward","rewardsForRandomSelection","numSeasonalRewards","usedRewards","availableRewards","randomReward","generateCompleteTrainData","trainNumber","maxTrainOffers","usedResources","generateNewTrainOffers","_currentPlayer$train3","trainResource","trainRequiredLevel","trainPhase","setTrainPhase","trainTimer","setTrainTimer","playerTrainNumber","setPlayerTrainNumber","settlementTrainNumber","setSettlementTrainNumber","settlementTrainPhase","setSettlementTrainPhase","currentTrainOffers","setCurrentTrainOffers","currentTrainRewards","setCurrentTrainRewards","nextTrainOffers","setNextTrainOffers","nextTrainRewards","setNextTrainRewards","rewardsDeliveredMessage","setRewardsDeliveredMessage","initializeTrainData","trainTimerData","train","_currentPlayer$train","_currentPlayer$train2","playerTrainNum","currentTrainNumber","lastRewardDelivery","lastRewardDeliveryTrainNumber","checkAndDeliverCurrentTrainRewards","checkForRewardDelivery","_settlementResponse$d","_currentPlayer$train4","currentTrainLog","trainlog","currentSettlementTrainNumber","trainnumber","currentPlayerTrainNumber","determineTrainDataToShow","settlementTrainNum","settlementPhase","_currentPlayer$train5","_currentPlayer$train6","isPlayerBehind","showCurrentTrainData","advancePlayerToCurrentTrain","_currentPlayer$train7","_currentPlayer$train8","_currentPlayer$train9","_currentPlayer$train10","existingCurrentOffers","existingCurrentRewards","existingNextOffers","existingNextRewards","generateAndSaveTrainData","_currentPlayer$train11","_currentPlayer$train12","neverPurge","updatedMessages","updatedTrainData","rewardSummary","completedCount","_currentPlayer$train15","_currentPlayer$train16","newTrainNumber","_currentPlayer$train13","_currentPlayer$train14","checkAndDeliverPreviousTrainRewards","newCurrentOffers","newCurrentRewards","trainData","nextTrainData","currentTrainData","isLoadingPhaseExpired","isCompleted","totalQty","loadingExpired","moneyReward","costDisplay","rewardDisplay","updatedCurrentOffers","handleFulfillOffer","carnivalResource","carnivalRequiredLevel","carnivalOffers","setCarnivalOffers","carnivalPhase","setCarnivalPhase","carnivalTimer","setCarnivalTimer","nextOffers","setNextOffers","carnivalRewards","setCarnivalRewards","latestInventory","setLatestInventory","playerUsernames","setPlayerUsernames","currentCarnivalNumber","setCurrentCarnivalNumber","fetchCarnivalOffers","carnivalTimerData","carnival","_response$data$carniv","_response$data2$carni","_response$data3$carni","currentoffers","nextoffers","currentCarnival","carnivallog","carnivalnumber","fetchUsernames","playerIds","claimedBy","usernamePromises","usernameMap","showLogicModal","setShowLogicModal","logicModalData","setLogicModalData","logic","carnivalNumber","handleShowCarnivalLog","carnivalLogTable","alloffersfilled","totalwinners","combinedRewards","handleShowLogic","logicText","renderOfferSection","_latestInventory$find","isYours","filled","updateOffer","handleFulfill","offerIndex","updatedOffer","handleClaim","claimedByYou","claimedByOthers","allOrdersFilled","renderRewardSection","renderNextShipment","seen","uniqueOffers","updateStatusProp","courthouseResource","courthouseRequiredLevel","setSettlement","setElectionPhase","setCountdown","contextUpdateStatus","campaignPromises","setCampaignPromises","newPromise","setNewPromise","selectedCandidate","setSelectedCandidate","hasVoted","setHasVoted","votedFor","setVotedFor","candidateList","setCandidateList","tempTaxRate","setTempTaxRate","hoveredCandidate","setHoveredCandidate","tempSettlementName","setTempSettlementName","isModalOpen","modalContent","courthouseSkills","setCourthouseSkills","isLoadingSkills","setIsLoadingSkills","fetchElectionData","updateTimerAndPhase","electionData","elections","newPhase","fetchSkills","populationCount","votes","playerVote","voterId","_settlementData$campa","votedCandidate","candidateId","_settlementData$campa2","uniqueCandidates","requiredType","getCandidatePromise","_campaignPromises$fin","meetsRequirement","handlePurchaseSkill","maxWidth","candidate","electionlog","electionLogTable","_entry$candidates","candidates","electedmayor","calculateGemSpeedupCost","remainingTimeMs","remainingMinutes","CraftingStation","recipes","setRecipes","stationDetails","setStationDetails","activeTimer","setActiveTimer","setCraftedItem","craftingCountdown","setCraftingCountdown","isCrafting","setIsCrafting","isReadyToCollect","setIsReadyToCollect","npcRefreshKey","setNpcRefreshKey","stationRefreshKey","setStationRefreshKey","_GlobalGridStateTiles","station","existingNPCTypes","checkMayorStatus","handleCraft","updatedGlobalResources","handleGemSpeedup","updateResponse","skillMessage","getSkillBonusMessage","skillName","stations","hasSkill","unownedSkills","combinedMultiplier","skillsList","skillResource","skillSource","currentHealers","countHealers","maxHealersAllowed","doctorsPerHospital","healerLimitReached","gemSpeedupCost","craftTimeText","crafttime","minprice","isNPC","updatedStation","finalQtyCollected","craftedResource","handleCollect","isTownMayorSelling","FarmHouse","toLocaleTimeString","placementData","workerPlacementData","workerType","recipeType","hasInventory","isGemPurchase","frame","setFrame","hourglassFrames","NPCOverlayContext","NPCOverlayProvider","npcOverlays","setNpcOverlays","setNPCOverlay","overlay","clearNPCOverlay","setBusyOverlay","setQuestOverlay","setAttackOverlay","BulkHarvestModal","crops","getFreshCrops","onExecute","showBulkReplant","selectedCropTypes","setSelectedCropTypes","selectedReplantTypes","setSelectedReplantTypes","defaultSelection","crop","defaultReplantSelection","replantRequires","isInSeason","farmplot","allSelected","repeatableReplants","allReplantSelected","allHarvestSelected","keepRepeatable","paddingLeft","overflowY","canReplant","isRepeatable","replantChecked","replantDisabled","borderBottom","cropType","replantPrev","handleToggleCrop","cropPrev","handleToggleReplant","freshCrops","validCropTypes","validReplantTypes","finalReplantTypes","executeBulkHarvest","selectedTypes","currentResources","pendingFarmplots","maxAttempts","resourceAtPosition","freshResources","capacityCheck","totalCapacityNeeded","harvestDetails","capacities","totalCapacity","currentTotalUsage","availableSpace","baseCrop","baseYield","yieldPerCrop","totalYield","skillMultiplier","replantDetails","seedsNeeded","totalNeeded","farmplotType","hasEnoughSeeds","canReplantAll","seedType","needed","totalHas","enough","canHarvest","calculateBulkHarvestCapacity","spaceNeeded","missingSeeds","operations","shouldReplant","freeReplant","cropResource","replant","expectedYield","buildBulkHarvestOperations","harvestedPositions","harvested","replanted","growTimeMs","stage","harvestSkillsInfo","harvestResults","numPlotsHarvestedExcludingWheat","warehouseDropsArray","numPlotsHarvested","warehouseDrops","personalizedIngredients","calculateBulkWarehouseDrops","aggregatedWarehouseDrops","aggregated","drop","aggregateWarehouseDrops","_response$data$invent","_response$data$invent2","questProgressCategory","seedsUsed","prepareBulkHarvestData","cropCounts","hasHarvestResults","hasReplantInfo","hasWarehouseDrops","hasSkillBonus","cropSymbol","seedsUsedForCrop","BulkAnimalModal","animals","selectedAnimalTypes","setSelectedAnimalTypes","animal","handleExecute","BulkCraftingModal","stationGroups","hasBulkRestartCraft","selectedGroups","setSelectedGroups","selectedRestartStations","setSelectedRestartStations","defaultRestartSelection","group","canRestart","isGroupSelected","isRestartDisabled","selectAll","selectNone","selectAllRestarts","allRestartSelection","groupsToSelect","selectNoneRestarts","needs","stationCount","totalAvailable","calculateGroupNeeds","restartPrev","handleToggleGroup","stationSymbol","craftedSymbol","restartLabel","getRestartLabel","groupsPrev","handleToggleRestart","idx","executeBulkCrafting","batchStations","flatMap","shouldRestart","restartRecipe","stationGroup","successfulCollects","successfulRestarts","appliedSkillsInfo","stationUpdates","itemCollected","restarted","newCraftEnd","newCraftedItem","playerBuffs","appliesToStation","restartedItem","currentInventory","currentBackpack","hasCollections","hasRestarts","totalProcessed","restartInfo","formatRestartResults","FarmHandPanel","workerSkills","setFarmhandSkills","workerUpgrades","setFarmhandUpgrades","isHarvestModalOpen","setIsHarvestModalOpen","availableCrops","setAvailableCrops","bulkHarvestResults","setBulkHarvestResults","isResultsModalOpen","setIsResultsModalOpen","isAnimalModalOpen","setIsAnimalModalOpen","availableAnimals","setAvailableAnimals","isCraftingModalOpen","setIsCraftingModalOpen","selectedCraftingStations","setSelectedCraftingStations","availableCraftingStations","setAvailableCraftingStations","hasBulkReplant","bulkProgressModal","setBulkProgressModal","executeBulkOperation","operationName","workerNPC","asyncOperation","pendingStatusMessage","showBulkHarvest","showBulkAnimalCollect","showLogging","showCropPurchase","showBulkCrafting","ownedTypes","validSources","executeSelectiveAnimalCollect","animalsToCollect","wait","animalSkillsInfo","executeBulkAnimalCollect","getFreshCropData","getSkillTooltip","skillType","processingAnimals","animalCounts","animalsWithDetails","animalType","maxTrees","lumberjackNPC","farmerNPC","centerPos","centerType","treeResources","tree","treesToChop","choppedTreePositions","wood","workerNPCCleanup","readyStations","stationDef","groupsArray","stationCompare","localeCompare","prepareBulkCraftingData","stationsWithDetails","playerInventory","hasAllIngredients","cost","ProgressModal","BulkHarvestResultsModal","ShopStation","fetchTrigger","setFetchTrigger","finalRecipes","_currentPlayer$powers2","updatedPowers","powerIndex","statUpdates","oldValue","hasRequirement","outputSummary","effectsHtml","infoContent","ScrollStation","scrollCount","setScrollCount","revealedItemQty","setRevealedItemQty","setIsCollecting","checkStation","isRevealed","scrolls","handleCollectReveal","collectedQty","revealedResource","categoryEmoji","updatedRange","gainSkillOrPower","rarityText","scrollableItems","scrollqty","fallbackItem","getRandomScrollReveal","revealScrollResource","reveal","getRevealDisplayString","craftTime","getRandomPetReward","petRewardRarity","petRewards","personalizedRewards","getPersonalizedPetRewards","selectedReward","quantityRanges","getDropQuantity","PetPanel","petResource","currentPetPosition","rewardItem","setRewardItem","feedingCountdown","setFeedingCountdown","isFeeding","setIsFeeding","revealedRewardQty","setRevealedRewardQty","revealedRewardRarity","setRevealedRewardRarity","canAffordFeeding","setCanAffordFeeding","petName","petSymbol","feedIngredient","feedQuantity","feedingTime","checkAffordability","checkPetState","pet","rewardResource","petResourceForXP","ingredientDetails","isValid","feedMessage","AnimalStall","outputDetails","setOutputDetails","CropPanel","currentResource","isActionCoolingDown","setIsActionCoolingDown","cropDetails","setCropDetails","getCropStatusText","DecoPanel","setResourceDetails","availableResource","handleAddToSlot","getSlotConfig","selectedSlotIndex","transactionKeyPrefix","isRequestMode","playerMoney","slotConfig","maxAmount","currentAmount","totalCost","maxAffordable","maxAllowed","onBuyItem","onFulfillRequest","settlementPlayers","setSettlementPlayers","playerTradeStalls","setPlayerTradeStalls","playerTradeRequests","setPlayerTradeRequests","setResourceData","activeTab","setActiveTab","tradeStallPromises","tradeStallResults","tradeStallsData","tradeRequestPromises","tradeStallRequests","tradeRequestResults","tradeRequestsData","fetchGlobalMarketData","playersWithItems","slot","playersWithRequests","getPlayersWithRequests","hasActive","isActive","moneyCommitted","availableSlots","slotIndex","actualSlotIndex","handleBuyItem","activeRequests","playerInventoryItem","canFulfill","requestsResponse","handleFulfillRequest","tradeSlots","setTradeSlots","requestSlots","setRequestSlots","setSelectedSlotIndex","selectedRequestSlotIndex","setSelectedRequestSlotIndex","requestAmounts","setRequestAmounts","totalSellValue","setTotalSellValue","isLoadingInitial","setIsLoadingInitial","isGlobalMarketOpen","setIsGlobalMarketOpen","tradeStallSlotConfig","tradeStallSlots","tradeStallRequestConfig","sellWaitTime","unlocked","unlockCost","requiresGoldPass","getRequestSlotConfig","isRequestSlotUnlocked","isSlotUnlocked","fetchDataForViewedPlayer","skipInventoryFetch","currentInventoryResponse","serverSlots","allSlots","existingSlot","boughtFor","serverRequestSlots","allRequestSlots","performAddToSlot","updatedSlots","refreshedInventory","calculateTotalSellValue","slots","isEmpty","isPurchased","isReadyToSell","hasTimer","slotUnlocked","handleSlotClick","handleCollectPayment","sold","handleSellSingle","tempRecipe","handleUnlockSlot","handleRequestSlotClick","updatedRequestSlots","handleCancelRequest","handleUnlockRequestSlot","TradingInventoryModal","resourceInInventory","inventoryAmount","plotResource","finalAmount","handleRequestAmountChange","GlobalMarketModal","latestSlots","currentSlot","_gainResult$error","buyerPlayerId","sellerPlayerId","sellerInventory","earned","Outpost","setMasterResources","_globalTuning$tradeSt","initSlots","sellerUsername","sellerId","outpostTradeStall","isOwnItem","handleSellToGame","buyerId","buyerUsername","resourceInBackpack","backpackAmount","templates","setTemplates","markedReadIds","setMarkedReadIds","visibleMessages","setVisibleMessages","freshMessages","unreadMessages","fetchTemplatesAndMessages","renderRewards","messageIndex","collectedItems","_currentPlayer$messag","deleteMessage","seasons","setSeasons","seasonData","setSeasonData","richestCitizens","setRichestCitizens","secondsLeft","setSecondsLeft","storedTimers","fetchSeasons","diff","_response$data2$seaso","seasonLog","seasonlog","currentSeasonNumber","seasonNumber","lastSeason","seasonnumber","winners","seasonwinners","networth","fetchSeasonWinners","currentIndex","seasonType","previousIndex","previousSeason","settlementName","setSettlementName","electionTimer","setElectionTimer","formatOffers","fetchTownData","_frontierResponse$dat","_storedTimers$bank","_storedTimers$train","_storedTimers$electio","_storedTimers$train2","_storedTimers$electio2","_storedTimers$bank2","_settlementMap","topCitizens","setTopCitizens","topSettlementName","setTopSettlementName","seasonCycle","setSeasonCycle","highestWealth","setHighestWealth","settlementMap","setSettlementMap","getSeasonData","fetchSeasonCycle","settlementWealthMap","totalNetWorth","leadingSettlementId","leadingSettlementName","leadingSettlementPopulation","matching","fetchTopCitizensAndSettlement","_seasonCycle$nextInde","nextIndex","getNextSeason","handleShowSeasonRules","rulesContent","paddingRight","citizen","seasonLogTable","seasontype","winningsettlement","gridsreset","playersrelocated","_playersInGridManager9","_playersInGridManager10","eatAmounts","setEatAmounts","edibleResources","backpackFoods","warehouseFoods","newAmount","maxQuantity","_playersInGrid$player","_playersInGrid$player2","hpNeeded","hpPerItem","maxItemsForHp","effectiveMax","clampedAmount","renderFoodSection","foods","isWarehouse","_playersInGrid$player3","_playersInGrid$player4","_playersInGrid$player5","_playersInGrid$player6","isFromWarehouse","amountToEat","hpToAdd","newHp","inventoryType","handleEat","getHpToAdd","tentCount","setTentCount","boatCount","setIsCamping","setIsInBoat","displayedPCData","setDisplayedPCData","showEatingModal","setShowEatingModal","fakeRecipe","handlePitchTent","handleGetInBoat","nextLevelXP","_playersInGridManager11","_playersInGridManager12","_playersInGridManager13","_playersInGridManager14","_playersInGridManager15","_playersInGridManager16","_playersInGridManager17","_playersInGridManager18","EatingModal","SocialPanel","setBoatCount","setFullPlayerData","isLoadingPlayerData","setIsLoadingPlayerData","latestData","fetchFullPlayerData","_currentPlayer$backpa3","_currentPlayer$backpa4","tentsInBackpack","boatsInBackpack","PlayerPanel","CombatPanel","_currentPlayer$powers3","playerStats","setPlayerStats","stats","getPlayerStats","getStatBreakdown","stat","basePropertyName","modifier","refreshCombatStatsWithPlayer","_playerData$settings","_playerData$settings2","baseStats","powerBonuses","finalStats","currentPCStats","pcPosition","handleRefreshCombatStats","isEquipped","getEquippedArmor","armorType","handleEquipArmor","onMouseDown","blur","statIndex","getEquippedWeapon","weaponType","handleEquipWeapon","shareToNetwork","network","shareUrl","readOnly","copyToClipboard","clipboard","writeText","AnimatedEmoji","initialX","initialY","setPosition","setDuration","moveToNewPosition","newX","newY","actualDistance","userSelect","START_SCREEN_EMOJIS","StartScreenAnimation","isTransitioning","onTransitionComplete","setOpacity","isVisible","setIsVisible","homesteadElement","setHomesteadElement","useTransitionFade","setIsTransitioning","getTransitionState","NEW_DOMAIN","boxShadow","handleGo","_timers$seasons2","_timers$seasons4","_playersInGrid$gridId14","_playersInGrid$gridId15","_playersInGrid$gridId16","_playersInGrid$gridId17","_playersInGrid$gridId18","_playersInGrid$gridId19","_playersInGrid$gridId20","_playersInGrid$gridId21","_playersInGrid$gridId22","_playersInGrid$gridId23","_memoizedGrid$","_currentPlayer$locati20","_currentPlayer$locati21","_timers$seasons5","_timers$seasons6","showRedirect","trace","_appEl$innerHTML","appEl","setIsDeveloper","isRevivalModalOpen","setIsRevivalModalOpen","revivalPending","setRevivalPending","isLevelUpModalOpen","setIsLevelUpModalOpen","levelUpData","setLevelUpData","serverPreviouslyDown","_storedTimers","_storedTimers$seasons","_res$data","serverPhase","setIsOffSeason","checkInitialSeasonPhase","setIsMasterResourcesReady","setMasterSkills","setMasterWarehouse","setGlobalTuning","setMasterInteractions","setMasterTraders","setMasterTrophies","setMasterXPLevels","cleanedResources","invalidCrops","cleanedRes","handleTileRendererChange","TILE_SIZES","closer","far","activeTileSize","_playersInGrid$gridId","_playersInGrid$gridId2","_playersInGrid$gridId3","playerIdStr","lastShownFTUEStep","setLastShownFTUEStep","setPlayerPosition","isLoginPanelOpen","setisLoginPanelOpen","activeQuestGiver","activeSocialPC","setActiveSocialPC","activeStation","showShareModal","setShowShareModal","showFTUE","setShowFTUE","setDoinkerTarget","setHoveredTile","canvasSize","center","cursorUrl","toDataURL","styleEl","classList","existingStyle","setShowKeyArt","handleNPCPanel","isSocketConnected","chatMessages","setChatMessages","chat","store","memoizedGrid","memoizedTileTypes","memoizedResources","showKeyArt","isAppInitialized","setIsAppInitialized","__vvgame_connect_listener","connectListener","cleanupBadges","_DBPlayerData$locatio","_updatedPlayerData","_parsedPlayer$locatio","_DBPlayerData$_id","_DBPlayerData$locatio2","_DBPlayerData$locatio3","_DBPlayerData$locatio4","_DBPlayerData$locatio5","_DBPlayerData$baseHp","_DBPlayerData$baseMax","_DBPlayerData$baseArm","_DBPlayerData$baseAtt","_DBPlayerData$baseDam","_DBPlayerData$baseAtt2","_DBPlayerData$baseSpe","_DBPlayerData$iscampi","_DBPlayerData$isinboa","_freshPCState$playerI","_DBPlayerData$locatio6","_gridPlayer$position","_gridPlayer$position2","_updatedPlayerData$se","globalTuningData","interactions","traders","xpLevels","storedPlayer","parsedPlayer","storedGridId","resolvedGridId","isDev","initialGridId","waitForConnection","formattedPlayerData","freshNPCState","isLocationMismatch","isMissingFromGrid","homesteadResponse","currentGridCoord","hasDied","storedBadges","stored","getBadgeState","initializeAppWrapper","_cleanupBadges","savedRevivalState","revivalData","isRevivalPending","doinker","currentGridNPCs","_Object$values$0$posi","_Object$values$0$posi2","_playersInGrid$gridId4","_playersInGrid$gridId5","_playerPC$position","_playerPC$position2","onTileType","revivalState","deathTimestamp","lavaDamage","_playersInGrid$gridId6","_playersInGrid$gridId7","_playerPC$position3","_playerPC$position4","healing","taxes","setCountdowns","fetchTimersData","initializeTimers","_frontierData$seasons","_frontierData$seasons2","_frontierData$seasons3","_frontierData$electio","_frontierData$electio2","_frontierData$train","_frontierData$train2","_frontierData$carniva","_frontierData$carniva2","_frontierData$taxes","_frontierData$taxes2","_frontierData$bank","_frontierData$bank2","_frontierData$dungeon","_frontierData$dungeon2","frontierData","updatedTimers","updateCountdowns","_timers$seasons","_timers$elections","_timers$train","_timers$carnival","_timers$taxes","_timers$bank","_timers$dungeon","shouldFetchNewTimers","_currentPlayerRef$cur","_currentPlayerRef$cur2","_currentPlayerRef$cur3","_currentPlayerRef$cur4","_currentPlayerRef$cur5","newDungeonPhase","isInFTUECave","currentPlayerRef","sourceGrid","sourceGridBeforeDungeon","isDungeonExitInProgress","handleDungeonExit","exitError","handleDungeonAutoExit","_JSON$parse","_JSON$parse$seasons","previousPhaseRef","_timers$seasons3","currentPhase","zoomIn","_playersInGrid$gridId8","_playersInGrid$gridId9","_playersInGrid$gridId10","zoomOut","_playersInGrid$gridId11","_playersInGrid$gridId12","_playersInGrid$gridId13","handleMovementKeyDown","handleMovementKeyUp","isInRange","isFriend","alwaysBlocked","isForbiddenStation","isSafe","_currentPlayer$settin3","handleDungeonEntrance","handleDoorClick","farmHouse","finally","lastActivity","REFRESH_TIMEOUT","updateActivity","checkStaleness","inactiveTime","visibilityState","showTimers","setShowTimers","showStats","setShowStats","isChatOpen","setIsChatOpen","isChatClosing","setIsChatClosing","_NPCsInGrid$gridId2","Redirect","Chat","handleCloseChat","_currentPlayer$locati18","_currentPlayer$locati19","FrontierMiniMap","alt","CursorTileHighlight","FTUEDoinker","SettlementView","FrontierView","ShareModal","FTUE","RevivalModal","targetLocation","updatedLocation","restoredHp","properMaxHp","maxhpModifier","filteredBackpack","originalLocation","handlePlayerDeath","costToRevive","percentageToRevive","_updatedPCs$playerId","updatedPCs","Mailbox","TownNews","Store","OffSeasonModal","ProfilePanel","LoginPanel","handleLoginSuccess","DebugPanel","InventoryPanel","WarehousePanel","TrophyPanel","BankPanel","KentPanel","NewTrainPanel","CarnivalPanel","HowToPanel","HowToMoneyPanel","HowToGemsPanel","GoldBenefitsPanel","GovPanel","LeaderboardPanel","CourthousePanel","QuestPanel","_activeStation$positi","_activeStation$positi2","TradeStall","SeasonPanel","TransitionOverlay","LevelUpModal","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","__app_initialized__","cachedLanguage","savedPlayer","savedLanguage","rootEl","__root_created__","__root","__app_rendered__","App","reportWebVitals"],"sourceRoot":""}