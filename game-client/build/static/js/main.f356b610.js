/*! For license information please see main.f356b610.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,n)=>{var r=n(43),o=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,s={};function i(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)l.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function y(e,t,n,r,o,a,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new y(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new y(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new y(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new y(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new y(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new y(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new y(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new y(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new y(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(h,e)||!d.call(f,e)&&(p.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,v);g[t]=new y(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,v);g[t]=new y(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,v);g[t]=new y(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new y(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new y(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),N=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var O,A=Object.assign;function L(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var q=!1;function D(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),a=r.stack.split("\n"),l=o.length-1,s=a.length-1;1<=l&&0<=s&&o[l]!==a[s];)s--;for(;1<=l&&0<=s;l--,s--)if(o[l]!==a[s]){if(1!==l||1!==s)do{if(l--,0>--s||o[l]!==a[s]){var i="\n"+o[l].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}}while(1<=l&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function z(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=D(e.type,!1);case 11:return e=D(e.type.render,!1);case 1:return e=D(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case S:return"Portal";case E:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case $:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function U(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return A({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=U(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=U(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,U(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+U(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return A({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:U(n)}}function ae(e,t){var n=U(t.value),r=U(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ie(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ye(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=ye(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,ke=null,Ce=null;function Ee(e){if(e=wo(e)){if("function"!==typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=So(t),Se(e.stateNode,e.type,t))}}function Ie(e){ke?Ce?Ce.push(e):Ce=[e]:ke=e}function Ne(){if(ke){var e=ke,t=Ce;if(Ce=ke=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function je(e,t){return e(t)}function Pe(){}var Te=!1;function $e(e,t,n){if(Te)return e(t,n);Te=!0;try{return je(e,t,n)}finally{Te=!1,(null!==ke||null!==Ce)&&(Pe(),Ne())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=So(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Me=!1;if(u)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(ue){Me=!1}function _e(e,t,n,r,o,a,l,s,i){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Ae=null,Le=!1,qe=null,De={onError:function(e){Oe=!0,Ae=e}};function ze(e,t,n,r,o,a,l,s,i){Oe=!1,Ae=null,_e.apply(De,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ue(e){if(Be(e)!==e)throw Error(a(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var l=o.alternate;if(null===l){if(null!==(r=o.return)){n=r;continue}break}if(o.child===l.child){for(l=o.child;l;){if(l===n)return Ue(o),e;if(l===r)return Ue(o),t;l=l.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=l;else{for(var s=!1,i=o.child;i;){if(i===n){s=!0,n=o,r=l;break}if(i===r){s=!0,r=o,n=l;break}i=i.sibling}if(!s){for(i=l.child;i;){if(i===n){s=!0,n=l,r=o;break}if(i===r){s=!0,r=l,n=o;break}i=i.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ve=o.unstable_scheduleCallback,Qe=o.unstable_cancelCallback,Ke=o.unstable_shouldYield,Je=o.unstable_requestPaint,Ye=o.unstable_now,Xe=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,at=null;var lt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/it|0)|0},st=Math.log,it=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,l=268435455&n;if(0!==l){var s=l&~o;0!==s?r=dt(s):0!==(a&=l)&&(r=dt(a))}else 0!==(l=n&~o)?r=dt(l):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(a=t&-t)||16===o&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-lt(t)),r|=e[n],t&=~o;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function yt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-lt(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-lt(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,St,kt,Ct,Et,It=!1,Nt=[],jt=null,Pt=null,Tt=null,$t=new Map,Rt=new Map,Mt=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _t(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":$t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Ot(e,t,n,r,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=wo(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function At(e){var t=bo(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Et(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wo(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function qt(e,t,n){Lt(e)&&n.delete(t)}function Dt(){It=!1,null!==jt&&Lt(jt)&&(jt=null),null!==Pt&&Lt(Pt)&&(Pt=null),null!==Tt&&Lt(Tt)&&(Tt=null),$t.forEach(qt),Rt.forEach(qt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Dt)))}function Bt(e){function t(t){return zt(t,e)}if(0<Nt.length){zt(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==jt&&zt(jt,e),null!==Pt&&zt(Pt,e),null!==Tt&&zt(Tt,e),$t.forEach(t),Rt.forEach(t),n=0;n<Mt.length;n++)(r=Mt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)At(n),null===n.blockedOn&&Mt.shift()}var Gt=w.ReactCurrentBatchConfig,Ut=!0;function Wt(e,t,n,r){var o=bt,a=Gt.transition;Gt.transition=null;try{bt=1,Vt(e,t,n,r)}finally{bt=o,Gt.transition=a}}function Ht(e,t,n,r){var o=bt,a=Gt.transition;Gt.transition=null;try{bt=4,Vt(e,t,n,r)}finally{bt=o,Gt.transition=a}}function Vt(e,t,n,r){if(Ut){var o=Kt(e,t,n,r);if(null===o)Ur(e,t,r,Qt,n),_t(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return jt=Ot(jt,e,t,n,r,o),!0;case"dragenter":return Pt=Ot(Pt,e,t,n,r,o),!0;case"mouseover":return Tt=Ot(Tt,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return $t.set(a,Ot($t.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Rt.set(a,Ot(Rt.get(a)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(_t(e,r),4&t&&-1<Ft.indexOf(e)){for(;null!==o;){var a=wo(o);if(null!==a&&xt(a),null===(a=Kt(e,t,n,r))&&Ur(e,t,r,Qt,n),a===o)break;o=a}null!==o&&r.stopPropagation()}else Ur(e,t,r,null,n)}}var Qt=null;function Kt(e,t,n,r){if(Qt=null,null!==(e=bo(e=xe(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,o="value"in Yt?Yt.value:Yt.textContent,a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var l=r-e;for(t=1;t<=l&&n[r-t]===o[a-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,a){for(var l in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(o):o[l]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return A(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,ln,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),dn=A({},cn,{view:0,detail:0}),pn=on(dn),fn=A({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(an=e.screenX-sn.screenX,ln=e.screenY-sn.screenY):ln=an=0,sn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),hn=on(fn),yn=on(A({},fn,{dataTransfer:0})),gn=on(A({},dn,{relatedTarget:0})),mn=on(A({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=A({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(vn),wn=on(A({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function En(){return Cn}var In=A({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=on(In),jn=on(A({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=on(A({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Tn=on(A({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),$n=A({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=on($n),Mn=[9,13,27,32],Fn=u&&"CompositionEvent"in window,_n=null;u&&"documentMode"in document&&(_n=document.documentMode);var On=u&&"TextEvent"in window&&!_n,An=u&&(!Fn||_n&&8<_n&&11>=_n),Ln=String.fromCharCode(32),qn=!1;function Dn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ie(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Vn=null;function Qn(e){Lr(e,0)}function Kn(e){if(V(xo(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Vn=Hn=null)}function nr(e){if("value"===e.propertyName&&Kn(Vn)){var t=[];Wn(t,Vn,e,xe(e)),$e(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Vn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Vn)}function ar(e,t){if("click"===e)return Kn(t)}function lr(e,t){if("input"===e||"change"===e)return Kn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ir(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=void 0===r.end?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=ur(n,a);var l=ur(n,r);o&&l&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,vr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&ir(vr,r)||(vr=r,0<(r=Hr(mr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},kr={},Cr={};function Er(e){if(kr[e])return kr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return kr[e]=n[t];return e}u&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Ir=Er("animationend"),Nr=Er("animationiteration"),jr=Er("animationstart"),Pr=Er("transitionend"),Tr=new Map,$r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Tr.set(e,t),i(t,[e])}for(var Mr=0;Mr<$r.length;Mr++){var Fr=$r[Mr];Rr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}Rr(Ir,"onAnimationEnd"),Rr(Nr,"onAnimationIteration"),Rr(jr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Pr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _r="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(_r));function Ar(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,l,s,i,c){if(ze.apply(this,arguments),Oe){if(!Oe)throw Error(a(198));var u=Ae;Oe=!1,Ae=null,Le||(Le=!0,qe=u)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var l=r.length-1;0<=l;l--){var s=r[l],i=s.instance,c=s.currentTarget;if(s=s.listener,i!==a&&o.isPropagationStopped())break e;Ar(o,s,c),a=i}else for(l=0;l<r.length;l++){if(i=(s=r[l]).instance,c=s.currentTarget,s=s.listener,i!==a&&o.isPropagationStopped())break e;Ar(o,s,c),a=i}}}if(Le)throw e=qe,Le=!1,qe=null,e}function qr(e,t){var n=t[go];void 0===n&&(n=t[go]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function Dr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,l.forEach((function(t){"selectionchange"!==t&&(Or.has(t)||Dr(t,!1,e),Dr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Dr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Jt(t)){case 1:var o=Wt;break;case 4:o=Ht;break;default:o=Vt}n=o.bind(null,t,n,e),o=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ur(e,t,n,r,o){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var l=r.tag;if(3===l||4===l){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===l)for(l=r.return;null!==l;){var i=l.tag;if((3===i||4===i)&&((i=l.stateNode.containerInfo)===o||8===i.nodeType&&i.parentNode===o))return;l=l.return}for(;null!==s;){if(null===(l=bo(s)))return;if(5===(i=l.tag)||6===i){r=a=l;continue e}s=s.parentNode}}r=r.return}$e((function(){var r=a,o=xe(n),l=[];e:{var s=Tr.get(e);if(void 0!==s){var i=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":i=Nn;break;case"focusin":c="focus",i=gn;break;case"focusout":c="blur",i=gn;break;case"beforeblur":case"afterblur":i=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":i=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":i=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":i=Pn;break;case Ir:case Nr:case jr:i=mn;break;case Pr:i=Tn;break;case"scroll":i=pn;break;case"wheel":i=Rn;break;case"copy":case"cut":case"paste":i=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":i=jn}var u=0!==(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var f,h=r;null!==h;){var y=(f=h).stateNode;if(5===f.tag&&null!==y&&(f=y,null!==p&&(null!=(y=Re(h,p))&&u.push(Wr(h,y,f)))),d)break;h=h.return}0<u.length&&(s=new i(s,c,null,n,o),l.push({event:s,listeners:u}))}}if(0===(7&t)){if(i="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!bo(c)&&!c[yo])&&(i||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,i?(i=r,null!==(c=(c=n.relatedTarget||n.toElement)?bo(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(i=null,c=r),i!==c)){if(u=hn,y="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,y="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==i?s:xo(i),f=null==c?s:xo(c),(s=new u(y,h+"leave",i,n,o)).target=d,s.relatedTarget=f,y=null,bo(o)===r&&((u=new u(p,h+"enter",c,n,o)).target=f,u.relatedTarget=d,y=u),d=y,i&&c)e:{for(p=c,h=0,f=u=i;f;f=Vr(f))h++;for(f=0,y=p;y;y=Vr(y))f++;for(;0<h-f;)u=Vr(u),h--;for(;0<f-h;)p=Vr(p),f--;for(;h--;){if(u===p||null!==p&&u===p.alternate)break e;u=Vr(u),p=Vr(p)}u=null}else u=null;null!==i&&Qr(l,s,i,u,!1),null!==c&&null!==d&&Qr(l,d,c,u,!0)}if("select"===(i=(s=r?xo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===i&&"file"===s.type)var g=Jn;else if(Un(s))if(Yn)g=lr;else{g=or;var m=rr}else(i=s.nodeName)&&"input"===i.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(e,r))?Wn(l,g,n,o):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?xo(r):window,e){case"focusin":(Un(m)||"true"===m.contentEditable)&&(gr=m,mr=r,vr=null);break;case"focusout":vr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(l,n,o);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":wr(l,n,o)}var v;if(Fn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Dn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(An&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=en()):(Xt="value"in(Yt=o)?Yt.value:Yt.textContent,Bn=!0)),0<(m=Hr(r,b)).length&&(b=new wn(b,e,null,n,o),l.push({event:b,listeners:m}),v?b.data=v:null!==(v=zn(n))&&(b.data=v))),(v=On?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(qn=!0,Ln);case"textInput":return(e=t.data)===Ln&&qn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Fn&&Dn(e,t)?(e=en(),Zt=Xt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return An&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(o=new wn("onBeforeInput","beforeinput",null,n,o),l.push({event:o,listeners:r}),o.data=v))}Lr(l,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=Re(e,n))&&r.unshift(Wr(e,a,o)),null!=(a=Re(e,t))&&r.push(Wr(e,a,o))),e=e.return}return r}function Vr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,o){for(var a=t._reactName,l=[];null!==n&&n!==r;){var s=n,i=s.alternate,c=s.stateNode;if(null!==i&&i===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(i=Re(n,a))&&l.unshift(Wr(n,i,s)):o||null!=(i=Re(n,a))&&l.push(Wr(n,i,s))),n=n.return}0!==l.length&&e.push({event:t,listeners:l})}var Kr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Kr,"\n").replace(Jr,"")}function Xr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(a(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,ao="function"===typeof Promise?Promise:void 0,lo="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ao?function(e){return ao.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout((function(){throw e}))}function io(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Bt(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),fo="__reactFiber$"+po,ho="__reactProps$"+po,yo="__reactContainer$"+po,go="__reactEvents$"+po,mo="__reactListeners$"+po,vo="__reactHandles$"+po;function bo(e){var t=e[fo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[yo]||n[fo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[fo])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function wo(e){return!(e=e[fo]||e[yo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function So(e){return e[ho]||null}var ko=[],Co=-1;function Eo(e){return{current:e}}function Io(e){0>Co||(e.current=ko[Co],ko[Co]=null,Co--)}function No(e,t){Co++,ko[Co]=e.current,e.current=t}var jo={},Po=Eo(jo),To=Eo(!1),$o=jo;function Ro(e,t){var n=e.type.contextTypes;if(!n)return jo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Mo(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Fo(){Io(To),Io(Po)}function _o(e,t,n){if(Po.current!==jo)throw Error(a(168));No(Po,t),No(To,n)}function Oo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,G(e)||"Unknown",o));return A({},n,r)}function Ao(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jo,$o=Po.current,No(Po,e),No(To,To.current),!0}function Lo(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Oo(e,t,$o),r.__reactInternalMemoizedMergedChildContext=e,Io(To),Io(Po),No(Po,e)):Io(To),No(To,n)}var qo=null,Do=!1,zo=!1;function Bo(e){null===qo?qo=[e]:qo.push(e)}function Go(){if(!zo&&null!==qo){zo=!0;var e=0,t=bt;try{var n=qo;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}qo=null,Do=!1}catch(o){throw null!==qo&&(qo=qo.slice(e+1)),Ve(Ze,Go),o}finally{bt=t,zo=!1}}return null}var Uo=[],Wo=0,Ho=null,Vo=0,Qo=[],Ko=0,Jo=null,Yo=1,Xo="";function Zo(e,t){Uo[Wo++]=Vo,Uo[Wo++]=Ho,Ho=e,Vo=t}function ea(e,t,n){Qo[Ko++]=Yo,Qo[Ko++]=Xo,Qo[Ko++]=Jo,Jo=e;var r=Yo;e=Xo;var o=32-lt(r)-1;r&=~(1<<o),n+=1;var a=32-lt(t)+o;if(30<a){var l=o-o%5;a=(r&(1<<l)-1).toString(32),r>>=l,o-=l,Yo=1<<32-lt(t)+o|n<<o|r,Xo=a+e}else Yo=1<<a|n<<o|r,Xo=e}function ta(e){null!==e.return&&(Zo(e,1),ea(e,1,0))}function na(e){for(;e===Ho;)Ho=Uo[--Wo],Uo[Wo]=null,Vo=Uo[--Wo],Uo[Wo]=null;for(;e===Jo;)Jo=Qo[--Ko],Qo[Ko]=null,Xo=Qo[--Ko],Qo[Ko]=null,Yo=Qo[--Ko],Qo[Ko]=null}var ra=null,oa=null,aa=!1,la=null;function sa(e,t){var n=$c(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ia(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,oa=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Jo?{id:Yo,overflow:Xo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=$c(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ra=e,oa=null,!0);default:return!1}}function ca(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ua(e){if(aa){var t=oa;if(t){var n=t;if(!ia(e,t)){if(ca(e))throw Error(a(418));t=co(n.nextSibling);var r=ra;t&&ia(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,aa=!1,ra=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,ra=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function pa(e){if(e!==ra)return!1;if(!aa)return da(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oa)){if(ca(e))throw fa(),Error(a(418));for(;t;)sa(e,t),t=co(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oa=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oa=null}}else oa=ra?co(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=oa;e;)e=co(e.nextSibling)}function ha(){oa=ra=null,aa=!1}function ya(e){null===la?la=[e]:la.push(e)}var ga=w.ReactCurrentBatchConfig;function ma(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,l=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===l?t.ref:(t=function(e){var t=o.refs;null===e?delete t[l]:t[l]=e},t._stringRef=l,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function va(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function wa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function l(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function i(e,t,n,r){return null===t||6!==t.tag?((t=Ac(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===R&&ba(a)===t.type)?((r=o(t,n.props)).ref=ma(e,t,n),r.return=e,r):((r=Fc(n.type,n.key,n.props,null,e.mode,r)).ref=ma(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=_c(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ac(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Fc(t.type,t.key,t.props,null,e.mode,n)).ref=ma(e,null,t),n.return=e,n;case S:return(t=Lc(t,e.mode,n)).return=e,t;case R:return p(e,(0,t._init)(t._payload),n)}if(te(t)||_(t))return(t=_c(t,e.mode,n,null)).return=e,t;va(e,t)}return null}function f(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:i(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===o?c(e,t,n,r):null;case S:return n.key===o?u(e,t,n,r):null;case R:return f(e,t,(o=n._init)(n._payload),r)}if(te(n)||_(n))return null!==o?null:d(e,t,n,r,null);va(e,n)}return null}function h(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return i(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case R:return h(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||_(r))return d(t,e=e.get(n)||null,r,o,null);va(t,r)}return null}function y(o,a,s,i){for(var c=null,u=null,d=a,y=a=0,g=null;null!==d&&y<s.length;y++){d.index>y?(g=d,d=null):g=d.sibling;var m=f(o,d,s[y],i);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(o,d),a=l(m,a,y),null===u?c=m:u.sibling=m,u=m,d=g}if(y===s.length)return n(o,d),aa&&Zo(o,y),c;if(null===d){for(;y<s.length;y++)null!==(d=p(o,s[y],i))&&(a=l(d,a,y),null===u?c=d:u.sibling=d,u=d);return aa&&Zo(o,y),c}for(d=r(o,d);y<s.length;y++)null!==(g=h(d,o,y,s[y],i))&&(e&&null!==g.alternate&&d.delete(null===g.key?y:g.key),a=l(g,a,y),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(o,e)})),aa&&Zo(o,y),c}function g(o,s,i,c){var u=_(i);if("function"!==typeof u)throw Error(a(150));if(null==(i=u.call(i)))throw Error(a(151));for(var d=u=null,y=s,g=s=0,m=null,v=i.next();null!==y&&!v.done;g++,v=i.next()){y.index>g?(m=y,y=null):m=y.sibling;var b=f(o,y,v.value,c);if(null===b){null===y&&(y=m);break}e&&y&&null===b.alternate&&t(o,y),s=l(b,s,g),null===d?u=b:d.sibling=b,d=b,y=m}if(v.done)return n(o,y),aa&&Zo(o,g),u;if(null===y){for(;!v.done;g++,v=i.next())null!==(v=p(o,v.value,c))&&(s=l(v,s,g),null===d?u=v:d.sibling=v,d=v);return aa&&Zo(o,g),u}for(y=r(o,y);!v.done;g++,v=i.next())null!==(v=h(y,o,g,v.value,c))&&(e&&null!==v.alternate&&y.delete(null===v.key?g:v.key),s=l(v,s,g),null===d?u=v:d.sibling=v,d=v);return e&&y.forEach((function(e){return t(o,e)})),aa&&Zo(o,g),u}return function e(r,a,l,i){if("object"===typeof l&&null!==l&&l.type===k&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case x:e:{for(var c=l.key,u=a;null!==u;){if(u.key===c){if((c=l.type)===k){if(7===u.tag){n(r,u.sibling),(a=o(u,l.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&ba(c)===u.type){n(r,u.sibling),(a=o(u,l.props)).ref=ma(r,u,l),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}l.type===k?((a=_c(l.props.children,r.mode,i,l.key)).return=r,r=a):((i=Fc(l.type,l.key,l.props,null,r.mode,i)).ref=ma(r,a,l),i.return=r,r=i)}return s(r);case S:e:{for(u=l.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===l.containerInfo&&a.stateNode.implementation===l.implementation){n(r,a.sibling),(a=o(a,l.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Lc(l,r.mode,i)).return=r,r=a}return s(r);case R:return e(r,a,(u=l._init)(l._payload),i)}if(te(l))return y(r,a,l,i);if(_(l))return g(r,a,l,i);va(r,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==a&&6===a.tag?(n(r,a.sibling),(a=o(a,l)).return=r,r=a):(n(r,a),(a=Ac(l,r.mode,i)).return=r,r=a),s(r)):n(r,a)}}var xa=wa(!0),Sa=wa(!1),ka=Eo(null),Ca=null,Ea=null,Ia=null;function Na(){Ia=Ea=Ca=null}function ja(e){var t=ka.current;Io(ka),e._currentValue=t}function Pa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){Ca=e,Ia=Ea=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function $a(e){var t=e._currentValue;if(Ia!==e)if(e={context:e,memoizedValue:t,next:null},null===Ea){if(null===Ca)throw Error(a(308));Ea=e,Ca.dependencies={lanes:0,firstContext:e}}else Ea=Ea.next=e;return t}var Ra=null;function Ma(e){null===Ra?Ra=[e]:Ra.push(e)}function Fa(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Ma(t)):(n.next=o.next,o.next=n),t.interleaved=n,_a(e,r)}function _a(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oa=!1;function Aa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Da(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ji)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,_a(e,n)}return null===(o=r.interleaved)?(t.next=t,Ma(r)):(t.next=o.next,o.next=t),r.interleaved=t,_a(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ba(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=l:a=a.next=l,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ga(e,t,n,r){var o=e.updateQueue;Oa=!1;var a=o.firstBaseUpdate,l=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var i=s,c=i.next;i.next=null,null===l?a=c:l.next=c,l=i;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==l&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=i))}if(null!==a){var d=o.baseState;for(l=0,u=c=i=null,s=a;;){var p=s.lane,f=s.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,y=s;switch(p=t,f=n,y.tag){case 1:if("function"===typeof(h=y.payload)){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=y.payload)?h.call(f,d,p):h)||void 0===p)break e;d=A({},d,p);break e;case 2:Oa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,i=d):u=u.next=f,l|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(i=d),o.baseState=i,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{l|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Oi|=l,e.lanes=l,e.memoizedState=d}}function Ua(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(a(191,o));o.call(r)}}}var Wa={},Ha=Eo(Wa),Va=Eo(Wa),Qa=Eo(Wa);function Ka(e){if(e===Wa)throw Error(a(174));return e}function Ja(e,t){switch(No(Qa,t),No(Va,e),No(Ha,Wa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ie(null,"");break;default:t=ie(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Io(Ha),No(Ha,t)}function Ya(){Io(Ha),Io(Va),Io(Qa)}function Xa(e){Ka(Qa.current);var t=Ka(Ha.current),n=ie(t,e.type);t!==n&&(No(Va,e),No(Ha,n))}function Za(e){Va.current===e&&(Io(Ha),Io(Va))}var el=Eo(0);function tl(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nl=[];function rl(){for(var e=0;e<nl.length;e++)nl[e]._workInProgressVersionPrimary=null;nl.length=0}var ol=w.ReactCurrentDispatcher,al=w.ReactCurrentBatchConfig,ll=0,sl=null,il=null,cl=null,ul=!1,dl=!1,pl=0,fl=0;function hl(){throw Error(a(321))}function yl(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function gl(e,t,n,r,o,l){if(ll=l,sl=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ol.current=null===e||null===e.memoizedState?Zl:es,e=n(r,o),dl){l=0;do{if(dl=!1,pl=0,25<=l)throw Error(a(301));l+=1,cl=il=null,t.updateQueue=null,ol.current=ts,e=n(r,o)}while(dl)}if(ol.current=Xl,t=null!==il&&null!==il.next,ll=0,cl=il=sl=null,ul=!1,t)throw Error(a(300));return e}function ml(){var e=0!==pl;return pl=0,e}function vl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cl?sl.memoizedState=cl=e:cl=cl.next=e,cl}function bl(){if(null===il){var e=sl.alternate;e=null!==e?e.memoizedState:null}else e=il.next;var t=null===cl?sl.memoizedState:cl.next;if(null!==t)cl=t,il=e;else{if(null===e)throw Error(a(310));e={memoizedState:(il=e).memoizedState,baseState:il.baseState,baseQueue:il.baseQueue,queue:il.queue,next:null},null===cl?sl.memoizedState=cl=e:cl=cl.next=e}return cl}function wl(e,t){return"function"===typeof t?t(e):t}function xl(e){var t=bl(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=il,o=r.baseQueue,l=n.pending;if(null!==l){if(null!==o){var s=o.next;o.next=l.next,l.next=s}r.baseQueue=o=l,n.pending=null}if(null!==o){l=o.next,r=r.baseState;var i=s=null,c=null,u=l;do{var d=u.lane;if((ll&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(i=c=p,s=r):c=c.next=p,sl.lanes|=d,Oi|=d}u=u.next}while(null!==u&&u!==l);null===c?s=r:c.next=i,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{l=o.lane,sl.lanes|=l,Oi|=l,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Sl(e){var t=bl(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,l=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{l=e(l,s.action),s=s.next}while(s!==o);sr(l,t.memoizedState)||(bs=!0),t.memoizedState=l,null===t.baseQueue&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function kl(){}function Cl(e,t){var n=sl,r=bl(),o=t(),l=!sr(r.memoizedState,o);if(l&&(r.memoizedState=o,bs=!0),r=r.queue,Ol(Nl.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||null!==cl&&1&cl.memoizedState.tag){if(n.flags|=2048,$l(9,Il.bind(null,n,r,o,t),void 0,null),null===Pi)throw Error(a(349));0!==(30&ll)||El(n,t,o)}return o}function El(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sl.updateQueue)?(t={lastEffect:null,stores:null},sl.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Il(e,t,n,r){t.value=n,t.getSnapshot=r,jl(t)&&Pl(e)}function Nl(e,t,n){return n((function(){jl(t)&&Pl(e)}))}function jl(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Pl(e){var t=_a(e,1);null!==t&&nc(t,e,1,-1)}function Tl(e){var t=vl();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ql.bind(null,sl,e),[t.memoizedState,e]}function $l(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sl.updateQueue)?(t={lastEffect:null,stores:null},sl.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rl(){return bl().memoizedState}function Ml(e,t,n,r){var o=vl();sl.flags|=e,o.memoizedState=$l(1|t,n,void 0,void 0===r?null:r)}function Fl(e,t,n,r){var o=bl();r=void 0===r?null:r;var a=void 0;if(null!==il){var l=il.memoizedState;if(a=l.destroy,null!==r&&yl(r,l.deps))return void(o.memoizedState=$l(t,n,a,r))}sl.flags|=e,o.memoizedState=$l(1|t,n,a,r)}function _l(e,t){return Ml(8390656,8,e,t)}function Ol(e,t){return Fl(2048,8,e,t)}function Al(e,t){return Fl(4,2,e,t)}function Ll(e,t){return Fl(4,4,e,t)}function ql(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Dl(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fl(4,4,ql.bind(null,t,e),n)}function zl(){}function Bl(e,t){var n=bl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yl(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Gl(e,t){var n=bl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yl(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ul(e,t,n){return 0===(21&ll)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=yt(),sl.lanes|=n,Oi|=n,e.baseState=!0),t)}function Wl(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=al.transition;al.transition={};try{e(!1),t()}finally{bt=n,al.transition=r}}function Hl(){return bl().memoizedState}function Vl(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Kl(e))Jl(t,n);else if(null!==(n=Fa(e,t,n,r))){nc(n,e,r,ec()),Yl(n,t,r)}}function Ql(e,t,n){var r=tc(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Kl(e))Jl(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var l=t.lastRenderedState,s=a(l,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,l)){var i=t.interleaved;return null===i?(o.next=o,Ma(t)):(o.next=i.next,i.next=o),void(t.interleaved=o)}}catch(c){}null!==(n=Fa(e,t,o,r))&&(nc(n,e,r,o=ec()),Yl(n,t,r))}}function Kl(e){var t=e.alternate;return e===sl||null!==t&&t===sl}function Jl(e,t){dl=ul=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yl(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xl={readContext:$a,useCallback:hl,useContext:hl,useEffect:hl,useImperativeHandle:hl,useInsertionEffect:hl,useLayoutEffect:hl,useMemo:hl,useReducer:hl,useRef:hl,useState:hl,useDebugValue:hl,useDeferredValue:hl,useTransition:hl,useMutableSource:hl,useSyncExternalStore:hl,useId:hl,unstable_isNewReconciler:!1},Zl={readContext:$a,useCallback:function(e,t){return vl().memoizedState=[e,void 0===t?null:t],e},useContext:$a,useEffect:_l,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ml(4194308,4,ql.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ml(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ml(4,2,e,t)},useMemo:function(e,t){var n=vl();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vl();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Vl.bind(null,sl,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vl().memoizedState=e},useState:Tl,useDebugValue:zl,useDeferredValue:function(e){return vl().memoizedState=e},useTransition:function(){var e=Tl(!1),t=e[0];return e=Wl.bind(null,e[1]),vl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sl,o=vl();if(aa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Pi)throw Error(a(349));0!==(30&ll)||El(r,t,n)}o.memoizedState=n;var l={value:n,getSnapshot:t};return o.queue=l,_l(Nl.bind(null,r,l,e),[e]),r.flags|=2048,$l(9,Il.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=vl(),t=Pi.identifierPrefix;if(aa){var n=Xo;t=":"+t+"R"+(n=(Yo&~(1<<32-lt(Yo)-1)).toString(32)+n),0<(n=pl++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fl++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:$a,useCallback:Bl,useContext:$a,useEffect:Ol,useImperativeHandle:Dl,useInsertionEffect:Al,useLayoutEffect:Ll,useMemo:Gl,useReducer:xl,useRef:Rl,useState:function(){return xl(wl)},useDebugValue:zl,useDeferredValue:function(e){return Ul(bl(),il.memoizedState,e)},useTransition:function(){return[xl(wl)[0],bl().memoizedState]},useMutableSource:kl,useSyncExternalStore:Cl,useId:Hl,unstable_isNewReconciler:!1},ts={readContext:$a,useCallback:Bl,useContext:$a,useEffect:Ol,useImperativeHandle:Dl,useInsertionEffect:Al,useLayoutEffect:Ll,useMemo:Gl,useReducer:Sl,useRef:Rl,useState:function(){return Sl(wl)},useDebugValue:zl,useDeferredValue:function(e){var t=bl();return null===il?t.memoizedState=e:Ul(t,il.memoizedState,e)},useTransition:function(){return[Sl(wl)[0],bl().memoizedState]},useMutableSource:kl,useSyncExternalStore:Cl,useId:Hl,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=A({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:A({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var os={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),o=tc(e),a=qa(r,o);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Da(e,a,o))&&(nc(t,e,o,r),za(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),o=tc(e),a=qa(r,o);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Da(e,a,o))&&(nc(t,e,o,r),za(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),o=qa(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Da(e,o,r))&&(nc(t,e,r,n),za(t,e,r))}};function as(e,t,n,r,o,a,l){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,l):!t.prototype||!t.prototype.isPureReactComponent||(!ir(n,r)||!ir(o,a))}function ls(e,t,n){var r=!1,o=jo,a=t.contextType;return"object"===typeof a&&null!==a?a=$a(a):(o=Mo(t)?$o:Po.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ro(e,o):jo),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=os,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&os.enqueueReplaceState(t,t.state,null)}function is(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Aa(e);var a=t.contextType;"object"===typeof a&&null!==a?o.context=$a(a):(a=Mo(t)?$o:Po.current,o.context=Ro(e,a)),o.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(rs(e,t,a,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&os.enqueueReplaceState(o,o.state,null),Ga(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var o=n}catch(a){o="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:o,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=qa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ui||(Ui=!0,Wi=r),ds(0,t)},n}function hs(e,t,n){(n=qa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ds(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===Hi?Hi=new Set([this]):Hi.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ys(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ms(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=qa(-1,1)).tag=2,Da(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var vs=w.ReactCurrentOwner,bs=!1;function ws(e,t,n,r){t.child=null===e?Sa(t,null,n,r):xa(t,e.child,n,r)}function xs(e,t,n,r,o){n=n.render;var a=t.ref;return Ta(t,o),r=gl(e,t,n,r,a,o),n=ml(),null===e||bs?(aa&&n&&ta(t),t.flags|=1,ws(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Us(e,t,o))}function Ss(e,t,n,r,o){if(null===e){var a=n.type;return"function"!==typeof a||Rc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ks(e,t,a,r,o))}if(a=e.child,0===(e.lanes&o)){var l=a.memoizedProps;if((n=null!==(n=n.compare)?n:ir)(l,r)&&e.ref===t.ref)return Us(e,t,o)}return t.flags|=1,(e=Mc(a,r)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,n,r,o){if(null!==e){var a=e.memoizedProps;if(ir(a,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=a,0===(e.lanes&o))return t.lanes=e.lanes,Us(e,t,o);0!==(131072&e.flags)&&(bs=!0)}}return Is(e,t,n,r,o)}function Cs(e,t,n){var r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},No(Mi,Ri),Ri|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,No(Mi,Ri),Ri|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,No(Mi,Ri),Ri|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,No(Mi,Ri),Ri|=r;return ws(e,t,o,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,n,r,o){var a=Mo(n)?$o:Po.current;return a=Ro(t,a),Ta(t,o),n=gl(e,t,n,r,a,o),r=ml(),null===e||bs?(aa&&r&&ta(t),t.flags|=1,ws(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Us(e,t,o))}function Ns(e,t,n,r,o){if(Mo(n)){var a=!0;Ao(t)}else a=!1;if(Ta(t,o),null===t.stateNode)Gs(e,t),ls(t,n,r),is(t,n,r,o),r=!0;else if(null===e){var l=t.stateNode,s=t.memoizedProps;l.props=s;var i=l.context,c=n.contextType;"object"===typeof c&&null!==c?c=$a(c):c=Ro(t,c=Mo(n)?$o:Po.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof l.getSnapshotBeforeUpdate;d||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(s!==r||i!==c)&&ss(t,l,r,c),Oa=!1;var p=t.memoizedState;l.state=p,Ga(t,r,l,o),i=t.memoizedState,s!==r||p!==i||To.current||Oa?("function"===typeof u&&(rs(t,n,u,r),i=t.memoizedState),(s=Oa||as(t,n,s,r,p,i,c))?(d||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(t.flags|=4194308)):("function"===typeof l.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=i),l.props=r,l.state=i,l.context=c,r=s):("function"===typeof l.componentDidMount&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,La(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),l.props=c,d=t.pendingProps,p=l.context,"object"===typeof(i=n.contextType)&&null!==i?i=$a(i):i=Ro(t,i=Mo(n)?$o:Po.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(s!==d||p!==i)&&ss(t,l,r,i),Oa=!1,p=t.memoizedState,l.state=p,Ga(t,r,l,o);var h=t.memoizedState;s!==d||p!==h||To.current||Oa?("function"===typeof f&&(rs(t,n,f,r),h=t.memoizedState),(c=Oa||as(t,n,c,r,p,h,i)||!1)?(u||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(r,h,i),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(r,h,i)),"function"===typeof l.componentDidUpdate&&(t.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof l.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),l.props=r,l.state=h,l.context=i,r=c):("function"!==typeof l.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return js(e,t,n,r,a,o)}function js(e,t,n,r,o,a){Es(e,t);var l=0!==(128&t.flags);if(!r&&!l)return o&&Lo(t,n,!1),Us(e,t,a);r=t.stateNode,vs.current=t;var s=l&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&l?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,s,a)):ws(e,t,s,a),t.memoizedState=r.state,o&&Lo(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?_o(0,t.pendingContext,t.pendingContext!==t.context):t.context&&_o(0,t.context,!1),Ja(e,t.containerInfo)}function Ts(e,t,n,r,o){return ha(),ya(o),t.flags|=256,ws(e,t,n,r),t.child}var $s,Rs,Ms,Fs,_s={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function As(e,t,n){var r,o=t.pendingProps,l=el.current,s=!1,i=0!==(128&t.flags);if((r=i)||(r=(null===e||null!==e.memoizedState)&&0!==(2&l)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(l|=1),No(el,1&l),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(i=o.children,e=o.fallback,s?(o=t.mode,s=t.child,i={mode:"hidden",children:i},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=i):s=Oc(i,o,0,null),e=_c(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=_s,e):Ls(t,i));if(null!==(l=e.memoizedState)&&null!==(r=l.dehydrated))return function(e,t,n,r,o,l,s){if(n)return 256&t.flags?(t.flags&=-257,qs(e,t,s,r=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(l=r.fallback,o=t.mode,r=Oc({mode:"visible",children:r.children},o,0,null),(l=_c(l,o,s,null)).flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,0!==(1&t.mode)&&xa(t,e.child,null,s),t.child.memoizedState=Os(s),t.memoizedState=_s,l);if(0===(1&t.mode))return qs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var i=r.dgst;return r=i,qs(e,t,s,r=us(l=Error(a(419)),r,void 0))}if(i=0!==(s&e.childLanes),bs||i){if(null!==(r=Pi)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==l.retryLane&&(l.retryLane=o,_a(e,o),nc(r,e,o,-1))}return yc(),qs(e,t,s,r=us(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Nc.bind(null,e),o._reactRetry=t,null):(e=l.treeContext,oa=co(o.nextSibling),ra=t,aa=!0,la=null,null!==e&&(Qo[Ko++]=Yo,Qo[Ko++]=Xo,Qo[Ko++]=Jo,Yo=e.id,Xo=e.overflow,Jo=t),t=Ls(t,r.children),t.flags|=4096,t)}(e,t,i,o,r,l,n);if(s){s=o.fallback,i=t.mode,r=(l=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&i)&&t.child!==l?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Mc(l,c)).subtreeFlags=14680064&l.subtreeFlags,null!==r?s=Mc(r,s):(s=_c(s,i,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,i=null===(i=e.child.memoizedState)?Os(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~n,t.memoizedState=_s,o}return e=(s=e.child).sibling,o=Mc(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Ls(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qs(e,t,n,r){return null!==r&&ya(r),xa(t,e.child,null,n),(e=Ls(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ds(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Pa(e.return,t,n)}function zs(e,t,n,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function Bs(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=el.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ds(e,n,t);else if(19===e.tag)Ds(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(No(el,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===tl(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),zs(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===tl(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}zs(t,!0,n,null,a);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Us(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Oi|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ws(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Vs(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Mo(t.type)&&Fo(),Hs(t),null;case 3:return r=t.stateNode,Ya(),Io(To),Io(Po),rl(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(pa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==la&&(lc(la),la=null))),Rs(e,t),Hs(t),null;case 5:Za(t);var o=Ka(Qa.current);if(n=t.type,null!==e&&null!=t.stateNode)Ms(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Hs(t),null}if(e=Ka(Ha.current),pa(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[fo]=t,r[ho]=l,e=0!==(1&t.mode),n){case"dialog":qr("cancel",r),qr("close",r);break;case"iframe":case"object":case"embed":qr("load",r);break;case"video":case"audio":for(o=0;o<_r.length;o++)qr(_r[o],r);break;case"source":qr("error",r);break;case"img":case"image":case"link":qr("error",r),qr("load",r);break;case"details":qr("toggle",r);break;case"input":J(r,l),qr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},qr("invalid",r);break;case"textarea":oe(r,l),qr("invalid",r)}for(var i in ve(n,l),o=null,l)if(l.hasOwnProperty(i)){var c=l[i];"children"===i?"string"===typeof c?r.textContent!==c&&(!0!==l.suppressHydrationWarning&&Xr(r.textContent,c,e),o=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==l.suppressHydrationWarning&&Xr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(i)&&null!=c&&"onScroll"===i&&qr("scroll",r)}switch(n){case"input":H(r),Z(r,l,!0);break;case"textarea":H(r),le(r);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{i=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),"select"===n&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[fo]=t,e[ho]=r,$s(e,t,!1,!1),t.stateNode=e;e:{switch(i=be(n,r),n){case"dialog":qr("cancel",e),qr("close",e),o=r;break;case"iframe":case"object":case"embed":qr("load",e),o=r;break;case"video":case"audio":for(o=0;o<_r.length;o++)qr(_r[o],e);o=r;break;case"source":qr("error",e),o=r;break;case"img":case"image":case"link":qr("error",e),qr("load",e),o=r;break;case"details":qr("toggle",e),o=r;break;case"input":J(e,r),o=K(e,r),qr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=A({},r,{value:void 0}),qr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),qr("invalid",e)}for(l in ve(n,o),c=o)if(c.hasOwnProperty(l)){var u=c[l];"style"===l?ge(e,u):"dangerouslySetInnerHTML"===l?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===l?"string"===typeof u?("textarea"!==n||""!==u)&&pe(e,u):"number"===typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?null!=u&&"onScroll"===l&&qr("scroll",e):null!=u&&b(e,l,u,i))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+U(r.value));break;case"select":e.multiple=!!r.multiple,null!=(l=r.value)?ne(e,!!r.multiple,l,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Fs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ka(Qa.current),Ka(Ha.current),pa(t)){if(r=t.stateNode,n=t.memoizedProps,r[fo]=t,(l=r.nodeValue!==n)&&null!==(e=ra))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}l&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fo]=t,t.stateNode=r}return Hs(t),null;case 13:if(Io(el),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&0!==(1&t.mode)&&0===(128&t.flags))fa(),ha(),t.flags|=98560,l=!1;else if(l=pa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!l)throw Error(a(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(a(317));l[fo]=t}else ha(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),l=!1}else null!==la&&(lc(la),la=null),l=!0;if(!l)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&el.current)?0===Fi&&(Fi=3):yc())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return Ya(),Rs(e,t),null===e&&Br(t.stateNode.containerInfo),Hs(t),null;case 10:return ja(t.type._context),Hs(t),null;case 19:if(Io(el),null===(l=t.memoizedState))return Hs(t),null;if(r=0!==(128&t.flags),null===(i=l.rendering))if(r)Ws(l,!1);else{if(0!==Fi||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=tl(e))){for(t.flags|=128,Ws(l,!1),null!==(r=i.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(l=n).flags&=14680066,null===(i=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,e=i.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return No(el,1&el.current|2),t.child}e=e.sibling}null!==l.tail&&Ye()>Bi&&(t.flags|=128,r=!0,Ws(l,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=tl(i))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ws(l,!0),null===l.tail&&"hidden"===l.tailMode&&!i.alternate&&!aa)return Hs(t),null}else 2*Ye()-l.renderingStartTime>Bi&&1073741824!==n&&(t.flags|=128,r=!0,Ws(l,!1),t.lanes=4194304);l.isBackwards?(i.sibling=t.child,t.child=i):(null!==(n=l.last)?n.sibling=i:t.child=i,l.last=i)}return null!==l.tail?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Ye(),t.sibling=null,n=el.current,No(el,r?1&n|2:1&n),t):(Hs(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ri)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qs(e,t){switch(na(t),t.tag){case 1:return Mo(t.type)&&Fo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),Io(To),Io(Po),rl(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Za(t),null;case 13:if(Io(el),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ha()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Io(el),null;case 4:return Ya(),null;case 10:return ja(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}$s=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Rs=function(){},Ms=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Ka(Ha.current);var a,l=null;switch(n){case"input":o=K(e,o),r=K(e,r),l=[];break;case"select":o=A({},o,{value:void 0}),r=A({},r,{value:void 0}),l=[];break;case"textarea":o=re(e,o),r=re(e,r),l=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var i=o[u];for(a in i)i.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var c=r[u];if(i=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&c!==i&&(null!=c||null!=i))if("style"===u)if(i){for(a in i)!i.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&i[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(l||(l=[]),l.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,i=i?i.__html:void 0,null!=c&&i!==c&&(l=l||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(l=l||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&qr("scroll",e),l||i===c||(l=[])):(l=l||[]).push(u,c))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}},Fs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ks=!1,Js=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Xs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function ei(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var ti=!1;function ni(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&ei(t,n,a)}o=o.next}while(o!==r)}}function ri(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oi(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ai(e){var t=e.alternate;null!==t&&(e.alternate=null,ai(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[ho],delete t[go],delete t[mo],delete t[vo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function li(e){return 5===e.tag||3===e.tag||4===e.tag}function si(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||li(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ii(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ii(e,t,n),e=e.sibling;null!==e;)ii(e,t,n),e=e.sibling}function ci(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ci(e,t,n),e=e.sibling;null!==e;)ci(e,t,n),e=e.sibling}var ui=null,di=!1;function pi(e,t,n){for(n=n.child;null!==n;)fi(e,t,n),n=n.sibling}function fi(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,n)}catch(s){}switch(n.tag){case 5:Js||Zs(n,t);case 6:var r=ui,o=di;ui=null,pi(e,t,n),di=o,null!==(ui=r)&&(di?(e=ui,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ui.removeChild(n.stateNode));break;case 18:null!==ui&&(di?(e=ui,n=n.stateNode,8===e.nodeType?io(e.parentNode,n):1===e.nodeType&&io(e,n),Bt(e)):io(ui,n.stateNode));break;case 4:r=ui,o=di,ui=n.stateNode.containerInfo,di=!0,pi(e,t,n),ui=r,di=o;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var a=o,l=a.destroy;a=a.tag,void 0!==l&&(0!==(2&a)||0!==(4&a))&&ei(n,t,l),o=o.next}while(o!==r)}pi(e,t,n);break;case 1:if(!Js&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Cc(n,t,s)}pi(e,t,n);break;case 21:pi(e,t,n);break;case 22:1&n.mode?(Js=(r=Js)||null!==n.memoizedState,pi(e,t,n),Js=r):pi(e,t,n);break;default:pi(e,t,n)}}function hi(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var r=jc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yi(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var l=e,s=t,i=s;e:for(;null!==i;){switch(i.tag){case 5:ui=i.stateNode,di=!1;break e;case 3:case 4:ui=i.stateNode.containerInfo,di=!0;break e}i=i.return}if(null===ui)throw Error(a(160));fi(l,s,o),ui=null,di=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(u){Cc(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gi(t,e),t=t.sibling}function gi(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yi(t,e),mi(e),4&r){try{ni(3,e,e.return),ri(3,e)}catch(g){Cc(e,e.return,g)}try{ni(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:yi(t,e),mi(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(yi(t,e),mi(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{pe(o,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(o=e.stateNode)){var l=e.memoizedProps,s=null!==n?n.memoizedProps:l,i=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===i&&"radio"===l.type&&null!=l.name&&Y(o,l),be(i,s);var u=be(i,l);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?ge(o,p):"dangerouslySetInnerHTML"===d?de(o,p):"children"===d?pe(o,p):b(o,d,p,u)}switch(i){case"input":X(o,l);break;case"textarea":ae(o,l);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!l.multiple;var h=l.value;null!=h?ne(o,!!l.multiple,h,!1):f!==!!l.multiple&&(null!=l.defaultValue?ne(o,!!l.multiple,l.defaultValue,!0):ne(o,!!l.multiple,l.multiple?[]:"",!1))}o[ho]=l}catch(g){Cc(e,e.return,g)}}break;case 6:if(yi(t,e),mi(e),4&r){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,l=e.memoizedProps;try{o.nodeValue=l}catch(g){Cc(e,e.return,g)}}break;case 3:if(yi(t,e),mi(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:yi(t,e),mi(e);break;case 13:yi(t,e),mi(e),8192&(o=e.child).flags&&(l=null!==o.memoizedState,o.stateNode.isHidden=l,!l||null!==o.alternate&&null!==o.alternate.memoizedState||(zi=Ye())),4&r&&hi(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Js=(u=Js)||d,yi(t,e),Js=u):yi(t,e),mi(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xs=e,d=e.child;null!==d;){for(p=Xs=d;null!==Xs;){switch(h=(f=Xs).child,f.tag){case 0:case 11:case 14:case 15:ni(4,f,f.return);break;case 1:Zs(f,f.return);var y=f.stateNode;if("function"===typeof y.componentWillUnmount){r=f,n=f.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){xi(p);continue}}null!==h?(h.return=f,Xs=h):xi(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"===typeof(l=o.style).setProperty?l.setProperty("display","none","important"):l.display="none":(i=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,i.style.display=ye("display",s))}catch(g){Cc(e,e.return,g)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:yi(t,e),mi(e),4&r&&hi(e);case 21:}}function mi(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(li(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(pe(o,""),r.flags&=-33),ci(e,si(e),o);break;case 3:case 4:var l=r.stateNode.containerInfo;ii(e,si(e),l);break;default:throw Error(a(161))}}catch(s){Cc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vi(e,t,n){Xs=e,bi(e,t,n)}function bi(e,t,n){for(var r=0!==(1&e.mode);null!==Xs;){var o=Xs,a=o.child;if(22===o.tag&&r){var l=null!==o.memoizedState||Ks;if(!l){var s=o.alternate,i=null!==s&&null!==s.memoizedState||Js;s=Ks;var c=Js;if(Ks=l,(Js=i)&&!c)for(Xs=o;null!==Xs;)i=(l=Xs).child,22===l.tag&&null!==l.memoizedState?Si(o):null!==i?(i.return=l,Xs=i):Si(o);for(;null!==a;)Xs=a,bi(a,t,n),a=a.sibling;Xs=o,Ks=s,Js=c}wi(e)}else 0!==(8772&o.subtreeFlags)&&null!==a?(a.return=o,Xs=a):wi(e)}}function wi(e){for(;null!==Xs;){var t=Xs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||ri(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Js)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;null!==l&&Ua(t,l,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ua(t,s,n)}break;case 5:var i=t.stateNode;if(null===n&&4&t.flags){n=i;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Bt(p)}}}break;default:throw Error(a(163))}Js||512&t.flags&&oi(t)}catch(f){Cc(t,t.return,f)}}if(t===e){Xs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xs=n;break}Xs=t.return}}function xi(e){for(;null!==Xs;){var t=Xs;if(t===e){Xs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xs=n;break}Xs=t.return}}function Si(e){for(;null!==Xs;){var t=Xs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ri(4,t)}catch(i){Cc(t,n,i)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(i){Cc(t,o,i)}}var a=t.return;try{oi(t)}catch(i){Cc(t,a,i)}break;case 5:var l=t.return;try{oi(t)}catch(i){Cc(t,l,i)}}}catch(i){Cc(t,t.return,i)}if(t===e){Xs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xs=s;break}Xs=t.return}}var ki,Ci=Math.ceil,Ei=w.ReactCurrentDispatcher,Ii=w.ReactCurrentOwner,Ni=w.ReactCurrentBatchConfig,ji=0,Pi=null,Ti=null,$i=0,Ri=0,Mi=Eo(0),Fi=0,_i=null,Oi=0,Ai=0,Li=0,qi=null,Di=null,zi=0,Bi=1/0,Gi=null,Ui=!1,Wi=null,Hi=null,Vi=!1,Qi=null,Ki=0,Ji=0,Yi=null,Xi=-1,Zi=0;function ec(){return 0!==(6&ji)?Ye():-1!==Xi?Xi:Xi=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&ji)&&0!==$i?$i&-$i:null!==ga.transition?(0===Zi&&(Zi=yt()),Zi):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Ji)throw Ji=0,Yi=null,Error(a(185));mt(e,n,r),0!==(2&ji)&&e===Pi||(e===Pi&&(0===(2&ji)&&(Ai|=n),4===Fi&&sc(e,$i)),rc(e,r),1===n&&0===ji&&0===(1&t.mode)&&(Bi=Ye()+500,Do&&Go()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-lt(a),s=1<<l,i=o[l];-1===i?0!==(s&n)&&0===(s&r)||(o[l]=ft(s,t)):i<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=pt(e,e===Pi?$i:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Do=!0,Bo(e)}(ic.bind(null,e)):Bo(ic.bind(null,e)),lo((function(){0===(6&ji)&&Go()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Xi=-1,Zi=0,0!==(6&ji))throw Error(a(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=pt(e,e===Pi?$i:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var o=ji;ji|=2;var l=hc();for(Pi===e&&$i===t||(Gi=null,Bi=Ye()+500,pc(e,t));;)try{vc();break}catch(i){fc(e,i)}Na(),Ei.current=l,ji=o,null!==Ti?t=0:(Pi=null,$i=0,t=Fi)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(r=o,t=ac(e,o))),1===t)throw n=_i,pc(e,0),sc(e,r),rc(e,Ye()),n;if(6===t)sc(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!sr(a(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=gc(e,r))&&(0!==(l=ht(e))&&(r=l,t=ac(e,l))),1===t))throw n=_i,pc(e,0),sc(e,r),rc(e,Ye()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:xc(e,Di,Gi);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=zi+500-Ye())){if(0!==pt(e,0))break;if(((o=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(xc.bind(null,e,Di,Gi),t);break}xc(e,Di,Gi);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-lt(r);l=1<<s,(s=t[s])>o&&(o=s),r&=~l}if(r=o,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ci(r/1960))-r)){e.timeoutHandle=ro(xc.bind(null,e,Di,Gi),r);break}xc(e,Di,Gi);break;default:throw Error(a(329))}}}return rc(e,Ye()),e.callbackNode===n?oc.bind(null,e):null}function ac(e,t){var n=qi;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Di,Di=n,null!==t&&lc(t)),e}function lc(e){null===Di?Di=e:Di.push.apply(Di,e)}function sc(e,t){for(t&=~Li,t&=~Ai,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-lt(t),r=1<<n;e[n]=-1,t&=~r}}function ic(e){if(0!==(6&ji))throw Error(a(327));Sc();var t=pt(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=_i,pc(e,0),sc(e,t),rc(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Di,Gi),rc(e,Ye()),null}function cc(e,t){var n=ji;ji|=1;try{return e(t)}finally{0===(ji=n)&&(Bi=Ye()+500,Do&&Go())}}function uc(e){null!==Qi&&0===Qi.tag&&0===(6&ji)&&Sc();var t=ji;ji|=1;var n=Ni.transition,r=bt;try{if(Ni.transition=null,bt=1,e)return e()}finally{bt=r,Ni.transition=n,0===(6&(ji=t))&&Go()}}function dc(){Ri=Mi.current,Io(Mi)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Ti)for(n=Ti.return;null!==n;){var r=n;switch(na(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Fo();break;case 3:Ya(),Io(To),Io(Po),rl();break;case 5:Za(r);break;case 4:Ya();break;case 13:case 19:Io(el);break;case 10:ja(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Pi=e,Ti=e=Mc(e.current,null),$i=Ri=t,Fi=0,_i=null,Li=Ai=Oi=0,Di=qi=null,null!==Ra){for(t=0;t<Ra.length;t++)if(null!==(r=(n=Ra[t]).interleaved)){n.interleaved=null;var o=r.next,a=n.pending;if(null!==a){var l=a.next;a.next=o,r.next=l}n.pending=r}Ra=null}return e}function fc(e,t){for(;;){var n=Ti;try{if(Na(),ol.current=Xl,ul){for(var r=sl.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ul=!1}if(ll=0,cl=il=sl=null,dl=!1,pl=0,Ii.current=null,null===n||null===n.return){Fi=1,_i=t,Ti=null;break}e:{var l=e,s=n.return,i=n,c=t;if(t=$i,i.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=i,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=gs(s);if(null!==h){h.flags&=-257,ms(h,s,i,0,t),1&h.mode&&ys(l,u,t),c=u;var y=(t=h).updateQueue;if(null===y){var g=new Set;g.add(c),t.updateQueue=g}else y.add(c);break e}if(0===(1&t)){ys(l,u,t),yc();break e}c=Error(a(426))}else if(aa&&1&i.mode){var m=gs(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ms(m,s,i,0,t),ya(cs(c,i));break e}}l=c=cs(c,i),4!==Fi&&(Fi=2),null===qi?qi=[l]:qi.push(l),l=s;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,Ba(l,fs(0,c,t));break e;case 1:i=c;var v=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hi||!Hi.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,Ba(l,hs(l,i,t));break e}}l=l.return}while(null!==l)}wc(n)}catch(w){t=w,Ti===n&&null!==n&&(Ti=n=n.return);continue}break}}function hc(){var e=Ei.current;return Ei.current=Xl,null===e?Xl:e}function yc(){0!==Fi&&3!==Fi&&2!==Fi||(Fi=4),null===Pi||0===(268435455&Oi)&&0===(268435455&Ai)||sc(Pi,$i)}function gc(e,t){var n=ji;ji|=2;var r=hc();for(Pi===e&&$i===t||(Gi=null,pc(e,t));;)try{mc();break}catch(o){fc(e,o)}if(Na(),ji=n,Ei.current=r,null!==Ti)throw Error(a(261));return Pi=null,$i=0,Fi}function mc(){for(;null!==Ti;)bc(Ti)}function vc(){for(;null!==Ti&&!Ke();)bc(Ti)}function bc(e){var t=ki(e.alternate,e,Ri);e.memoizedProps=e.pendingProps,null===t?wc(e):Ti=t,Ii.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Vs(n,t,Ri)))return void(Ti=n)}else{if(null!==(n=Qs(n,t)))return n.flags&=32767,void(Ti=n);if(null===e)return Fi=6,void(Ti=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ti=t);Ti=t=e}while(null!==t);0===Fi&&(Fi=5)}function xc(e,t,n){var r=bt,o=Ni.transition;try{Ni.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Qi);if(0!==(6&ji))throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-lt(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}(e,l),e===Pi&&(Ti=Pi=null,$i=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Vi||(Vi=!0,Pc(tt,(function(){return Sc(),null}))),l=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||l){l=Ni.transition,Ni.transition=null;var s=bt;bt=1;var i=ji;ji|=4,Ii.current=null,function(e,t){if(eo=Ut,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch(x){n=null;break e}var s=0,i=-1,c=-1,u=0,d=0,p=e,f=null;t:for(;;){for(var h;p!==n||0!==o&&3!==p.nodeType||(i=s+o),p!==l||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(h=p.firstChild);)f=p,p=h;for(;;){if(p===e)break t;if(f===n&&++u===o&&(i=s),f===l&&++d===r&&(c=s),null!==(h=p.nextSibling))break;f=(p=f).parentNode}p=h}n=-1===i||-1===c?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Ut=!1,Xs=t;null!==Xs;)if(e=(t=Xs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xs=e;else for(;null!==Xs;){t=Xs;try{var y=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==y){var g=y.memoizedProps,m=y.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),m);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(a(163))}}catch(x){Cc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Xs=e;break}Xs=t.return}y=ti,ti=!1}(e,n),gi(n,e),hr(to),Ut=!!eo,to=eo=null,e.current=n,vi(n,e,o),Je(),ji=i,bt=s,Ni.transition=l}else e.current=n;if(Vi&&(Vi=!1,Qi=e,Ki=o),l=e.pendingLanes,0===l&&(Hi=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Ui)throw Ui=!1,e=Wi,Wi=null,e;0!==(1&Ki)&&0!==e.tag&&Sc(),l=e.pendingLanes,0!==(1&l)?e===Yi?Ji++:(Ji=0,Yi=e):Ji=0,Go()}(e,t,n,r)}finally{Ni.transition=o,bt=r}return null}function Sc(){if(null!==Qi){var e=wt(Ki),t=Ni.transition,n=bt;try{if(Ni.transition=null,bt=16>e?16:e,null===Qi)var r=!1;else{if(e=Qi,Qi=null,Ki=0,0!==(6&ji))throw Error(a(331));var o=ji;for(ji|=4,Xs=e.current;null!==Xs;){var l=Xs,s=l.child;if(0!==(16&Xs.flags)){var i=l.deletions;if(null!==i){for(var c=0;c<i.length;c++){var u=i[c];for(Xs=u;null!==Xs;){var d=Xs;switch(d.tag){case 0:case 11:case 15:ni(8,d,l)}var p=d.child;if(null!==p)p.return=d,Xs=p;else for(;null!==Xs;){var f=(d=Xs).sibling,h=d.return;if(ai(d),d===u){Xs=null;break}if(null!==f){f.return=h,Xs=f;break}Xs=h}}}var y=l.alternate;if(null!==y){var g=y.child;if(null!==g){y.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Xs=l}}if(0!==(2064&l.subtreeFlags)&&null!==s)s.return=l,Xs=s;else e:for(;null!==Xs;){if(0!==(2048&(l=Xs).flags))switch(l.tag){case 0:case 11:case 15:ni(9,l,l.return)}var v=l.sibling;if(null!==v){v.return=l.return,Xs=v;break e}Xs=l.return}}var b=e.current;for(Xs=b;null!==Xs;){var w=(s=Xs).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Xs=w;else e:for(s=b;null!==Xs;){if(0!==(2048&(i=Xs).flags))try{switch(i.tag){case 0:case 11:case 15:ri(9,i)}}catch(S){Cc(i,i.return,S)}if(i===s){Xs=null;break e}var x=i.sibling;if(null!==x){x.return=i.return,Xs=x;break e}Xs=i.return}}if(ji=o,Go(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(S){}r=!0}return r}finally{bt=n,Ni.transition=t}}return!1}function kc(e,t,n){e=Da(e,t=fs(0,t=cs(n,t),1),1),t=ec(),null!==e&&(mt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hi||!Hi.has(r))){t=Da(t,e=hs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(mt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pi===e&&($i&n)===n&&(4===Fi||3===Fi&&(130023424&$i)===$i&&500>Ye()-zi?pc(e,0):Li|=n),rc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=_a(e,t))&&(mt(e,t,n),rc(e,n))}function Nc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function jc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ic(e,n)}function Pc(e,t){return Ve(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $c(e,t,n,r){return new Tc(e,t,n,r)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=$c(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fc(e,t,n,r,o,l){var s=2;if(r=e,"function"===typeof e)Rc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return _c(n.children,o,l,t);case C:s=8,o|=8;break;case E:return(e=$c(12,n,t,2|o)).elementType=E,e.lanes=l,e;case P:return(e=$c(13,n,t,o)).elementType=P,e.lanes=l,e;case T:return(e=$c(19,n,t,o)).elementType=T,e.lanes=l,e;case M:return Oc(n,o,l,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case N:s=9;break e;case j:s=11;break e;case $:s=14;break e;case R:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=$c(s,n,t,o)).elementType=e,t.type=r,t.lanes=l,t}function _c(e,t,n,r){return(e=$c(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=$c(22,e,r,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Ac(e,t,n){return(e=$c(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=$c(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Dc(e,t,n,r,o,a,l,s,i){return e=new qc(e,t,n,s,i),1===t?(t=1,!0===a&&(t|=8)):t=0,a=$c(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Aa(a),e}function zc(e){if(!e)return jo;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Mo(n))return Oo(e,n,t)}return t}function Bc(e,t,n,r,o,a,l,s,i){return(e=Dc(n,r,!0,e,0,a,0,s,i)).context=zc(null),n=e.current,(a=qa(r=ec(),o=tc(n))).callback=void 0!==t&&null!==t?t:null,Da(n,a,o),e.current.lanes=o,mt(e,o,r),rc(e,r),e}function Gc(e,t,n,r){var o=t.current,a=ec(),l=tc(o);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=qa(a,l)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Da(o,t,l))&&(nc(e,o,l,a),za(e,o,l)),l}function Uc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}ki=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||To.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),ha();break;case 5:Xa(t);break;case 1:Mo(t.type)&&Ao(t);break;case 4:Ja(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;No(ka,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(No(el,1&el.current),t.flags|=128,null):0!==(n&t.child.childLanes)?As(e,t,n):(No(el,1&el.current),null!==(e=Us(e,t,n))?e.sibling:null);No(el,1&el.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),No(el,el.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Us(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,aa&&0!==(1048576&t.flags)&&ea(t,Vo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var o=Ro(t,Po.current);Ta(t,n),o=gl(null,t,r,e,o,n);var l=ml();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mo(r)?(l=!0,Ao(t)):l=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Aa(t),o.updater=os,t.stateNode=o,o._reactInternals=t,is(t,r,e,n),t=js(null,t,r,!0,l,n)):(t.tag=0,aa&&l&&ta(t),ws(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===j)return 11;if(e===$)return 14}return 2}(r),e=ns(r,e),o){case 0:t=Is(null,t,r,e,n);break e;case 1:t=Ns(null,t,r,e,n);break e;case 11:t=xs(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,ns(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Is(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 1:return r=t.type,o=t.pendingProps,Ns(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 3:e:{if(Ps(t),null===e)throw Error(a(387));r=t.pendingProps,o=(l=t.memoizedState).element,La(e,t),Ga(t,r,null,n);var s=t.memoizedState;if(r=s.element,l.isDehydrated){if(l={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=l,t.memoizedState=l,256&t.flags){t=Ts(e,t,r,n,o=cs(Error(a(423)),t));break e}if(r!==o){t=Ts(e,t,r,n,o=cs(Error(a(424)),t));break e}for(oa=co(t.stateNode.containerInfo.firstChild),ra=t,aa=!0,la=null,n=Sa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ha(),r===o){t=Us(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return Xa(t),null===e&&ua(t),r=t.type,o=t.pendingProps,l=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==l&&no(r,l)&&(t.flags|=32),Es(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return As(e,t,n);case 4:return Ja(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xa(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,xs(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,l=t.memoizedProps,s=o.value,No(ka,r._currentValue),r._currentValue=s,null!==l)if(sr(l.value,s)){if(l.children===o.children&&!To.current){t=Us(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var i=l.dependencies;if(null!==i){s=l.child;for(var c=i.firstContext;null!==c;){if(c.context===r){if(1===l.tag){(c=qa(-1,n&-n)).tag=2;var u=l.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),Pa(l.return,n,t),i.lanes|=n;break}c=c.next}}else if(10===l.tag)s=l.type===t.type?null:l.child;else if(18===l.tag){if(null===(s=l.return))throw Error(a(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),Pa(s,n,t),s=l.sibling}else s=l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===t){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}ws(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Ta(t,n),r=r(o=$a(o)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return o=ns(r=t.type,t.pendingProps),Ss(e,t,r,o=ns(r.type,o),n);case 15:return ks(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ns(r,o),Gs(e,t),t.tag=1,Mo(r)?(e=!0,Ao(t)):e=!1,Ta(t,n),ls(t,r,o),is(t,r,o,n),js(null,t,r,!0,e,n);case 19:return Bs(e,t,n);case 22:return Cs(e,t,n)}throw Error(a(156,t.tag))};var Vc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,o){var a=n._reactRootContainer;if(a){var l=a;if("function"===typeof o){var s=o;o=function(){var e=Uc(l);s.call(e)}}Gc(t,l,e,o)}else l=function(e,t,n,r,o){if(o){if("function"===typeof r){var a=r;r=function(){var e=Uc(l);a.call(e)}}var l=Bc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=l,e[yo]=l.current,Br(8===e.nodeType?e.parentNode:e),uc(),l}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=Uc(i);s.call(e)}}var i=Dc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=i,e[yo]=i.current,Br(8===e.nodeType?e.parentNode:e),uc((function(){Gc(t,i,n,r)})),i}(n,t,e,o,r);return Uc(l)}Kc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Gc(e,t,null,null)},Kc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Gc(null,e,null,null)})),t[yo]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&At(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Ye()),0===(6&ji)&&(Bi=Ye()+500,Go()))}break;case 13:uc((function(){var t=_a(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},St=function(e){if(13===e.tag){var t=_a(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),n=_a(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},Ct=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=So(r);if(!o)throw Error(a(90));V(r),X(r,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},je=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[wo,xo,So,Ie,Ne,cc]},tu={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{ot=ru.inject(nu),at=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(a(299));var n=!1,r="",o=Vc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Dc(e,1,!1,null,0,n,0,r,o),e[yo]=t.current,Br(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,o=!1,l="",s=Vc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(l=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,o,0,l,s),e[yo]=t.current,Br(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Kc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[yo]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{var r=n(43),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)l.call(t,r)&&!i.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),i=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=m.prototype;var w=b.prototype=new v;w.constructor=b,y(w,m.prototype),w.isPureReactComponent=!0;var x=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var o,a={},l=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(l=""+t.key),t)S.call(t,o)&&!C.hasOwnProperty(o)&&(a[o]=t[o]);var i=arguments.length-2;if(1===i)a.children=r;else if(1<i){for(var c=Array(i),u=0;u<i;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(o in i=e.defaultProps)void 0===a[o]&&(a[o]=i[o]);return{$$typeof:n,type:e,key:l,ref:s,props:a,_owner:k.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function j(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,o,a,l){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var i=!1;if(null===e)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case n:case r:i=!0}}if(i)return l=l(i=e),e=""===a?"."+j(i,0):a,x(l)?(o="",null!=e&&(o=e.replace(N,"$&/")+"/"),P(l,t,o,"",(function(e){return e}))):null!=l&&(I(l)&&(l=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(l,o+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(N,"$&/")+"/")+e)),t.push(l)),1;if(i=0,a=""===a?".":a+":",x(e))for(var c=0;c<e.length;c++){var u=a+j(s=e[c],c);i+=P(s,t,o,u,l)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)i+=P(s=s.value,t,o,u=a+j(s,c++),l);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function T(e,t,n){if(null==e)return e;var r=[],o=0;return P(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function $(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},F={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:k};function _(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=o,t.Profiler=l,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=_,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=y({},e.props),a=e.key,l=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(l=t.ref,s=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(c in t)S.call(t,c)&&!C.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==i?i[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){i=Array(c);for(var u=0;u<c;u++)i[u]=arguments[u+2];o.children=i}return{$$typeof:n,type:e.type,key:a,ref:l,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:i,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:$}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=_,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,l=o>>>1;r<l;){var s=2*(r+1)-1,i=e[s],c=s+1,u=e[c];if(0>a(i,n))c<o&&0>a(u,i)?(e[r]=u,e[c]=n,r=c):(e[r]=i,e[s]=n,r=s);else{if(!(c<o&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var s=Date,i=s.now();t.unstable_now=function(){return s.now()-i}}var c=[],u=[],d=1,p=null,f=3,h=!1,y=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!y)if(null!==r(c))y=!0,M(S);else{var t=r(u);null!==t&&F(x,t.startTime-e)}}function S(e,n){y=!1,g&&(g=!1,v(I),I=-1),h=!0;var a=f;try{for(w(n),p=r(c);null!==p&&(!(p.expirationTime>n)||e&&!P());){var l=p.callback;if("function"===typeof l){p.callback=null,f=p.priorityLevel;var s=l(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(c)&&o(c),w(n)}else o(c);p=r(c)}if(null!==p)var i=!0;else{var d=r(u);null!==d&&F(x,d.startTime-n),i=!1}return i}finally{p=null,f=a,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,E=null,I=-1,N=5,j=-1;function P(){return!(t.unstable_now()-j<N)}function T(){if(null!==E){var e=t.unstable_now();j=e;var n=!0;try{n=E(!0,e)}finally{n?k():(C=!1,E=null)}}else C=!1}if("function"===typeof b)k=function(){b(T)};else if("undefined"!==typeof MessageChannel){var $=new MessageChannel,R=$.port2;$.port1.onmessage=T,k=function(){R.postMessage(null)}}else k=function(){m(T,0)};function M(e){E=e,C||(C=!0,k())}function F(e,n){I=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){y||h||(y=!0,M(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,o,a){var l=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?l+a:l:a=l,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>l?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(v(I),I=-1):g=!0,F(x,a-l))):(e.sortIndex=s,n(c,e),y||h||(y=!0,M(S))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".e009a26f.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="game-client:";n.l=(r,o,a,l)=>{if(e[r])e[r].push(o);else{var s,i;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(i=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[o];var p=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(n))),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),i&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var a=new Promise(((n,r)=>o=e[t]=[n,r]));r.push(o[2]=a);var l=n.p+n.u(t),s=new Error;n.l(l,(r=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var a=r&&("load"===r.type?"missing":r.type),l=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+l+")",s.name="ChunkLoadError",s.type=a,s.request=l,o[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var o,a,l=r[0],s=r[1],i=r[2],c=0;if(l.some((t=>0!==e[t]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(i)i(n)}for(t&&t(r);c<l.length;c++)a=l[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkgame_client=self.webpackChunkgame_client||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r={};n.r(r),n.d(r,{hasBrowserEnv:()=>de,hasStandardBrowserEnv:()=>fe,hasStandardBrowserWebWorkerEnv:()=>he,navigator:()=>pe,origin:()=>ye});var o=n(43),a=n(391);function l(e,t){return function(){return e.apply(t,arguments)}}const{toString:s}=Object.prototype,{getPrototypeOf:i}=Object,c=(u=Object.create(null),e=>{const t=s.call(e);return u[t]||(u[t]=t.slice(8,-1).toLowerCase())});var u;const d=e=>(e=e.toLowerCase(),t=>c(t)===e),p=e=>t=>typeof t===e,{isArray:f}=Array,h=p("undefined");const y=d("ArrayBuffer");const g=p("string"),m=p("function"),v=p("number"),b=e=>null!==e&&"object"===typeof e,w=e=>{if("object"!==c(e))return!1;const t=i(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},x=d("Date"),S=d("File"),k=d("Blob"),C=d("FileList"),E=d("URLSearchParams"),[I,N,j,P]=["ReadableStream","Request","Response","Headers"].map(d);function T(e,t){let n,r,{allOwnKeys:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),f(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=o?Object.getOwnPropertyNames(e):Object.keys(e),a=r.length;let l;for(n=0;n<a;n++)l=r[n],t.call(null,e[l],l,e)}}function $(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,o=n.length;for(;o-- >0;)if(r=n[o],t===r.toLowerCase())return r;return null}const R="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,M=e=>!h(e)&&e!==R;const F=(_="undefined"!==typeof Uint8Array&&i(Uint8Array),e=>_&&e instanceof _);var _;const O=d("HTMLFormElement"),A=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),L=d("RegExp"),q=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};T(n,((n,o)=>{let a;!1!==(a=t(n,o,e))&&(r[o]=a||n)})),Object.defineProperties(e,r)},D="abcdefghijklmnopqrstuvwxyz",z="0123456789",B={DIGIT:z,ALPHA:D,ALPHA_DIGIT:D+D.toUpperCase()+z};const G=d("AsyncFunction"),U=((e,t)=>{return e?setImmediate:t?(n=`axios@${Math.random()}`,r=[],R.addEventListener("message",(e=>{let{source:t,data:o}=e;t===R&&o===n&&r.length&&r.shift()()}),!1),e=>{r.push(e),R.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,m(R.postMessage)),W="undefined"!==typeof queueMicrotask?queueMicrotask.bind(R):"undefined"!==typeof process&&process.nextTick||U,H={isArray:f,isArrayBuffer:y,isBuffer:function(e){return null!==e&&!h(e)&&null!==e.constructor&&!h(e.constructor)&&m(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||m(e.append)&&("formdata"===(t=c(e))||"object"===t&&m(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&y(e.buffer),t},isString:g,isNumber:v,isBoolean:e=>!0===e||!1===e,isObject:b,isPlainObject:w,isReadableStream:I,isRequest:N,isResponse:j,isHeaders:P,isUndefined:h,isDate:x,isFile:S,isBlob:k,isRegExp:L,isFunction:m,isStream:e=>b(e)&&m(e.pipe),isURLSearchParams:E,isTypedArray:F,isFileList:C,forEach:T,merge:function e(){const{caseless:t}=M(this)&&this||{},n={},r=(r,o)=>{const a=t&&$(n,o)||o;w(n[a])&&w(r)?n[a]=e(n[a],r):w(r)?n[a]=e({},r):f(r)?n[a]=r.slice():n[a]=r};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&T(arguments[o],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return T(t,((t,r)=>{n&&m(t)?e[r]=l(t,n):e[r]=t}),{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let o,a,l;const s={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)l=o[a],r&&!r(l,e,t)||s[l]||(t[l]=e[l],s[l]=!0);e=!1!==n&&i(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:c,kindOfTest:d,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(f(e))return e;let t=e.length;if(!v(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:O,hasOwnProperty:A,hasOwnProp:A,reduceDescriptors:q,freezeMethods:e=>{q(e,((t,n)=>{if(m(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];m(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return f(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:$,global:R,isContextDefined:M,ALPHABET:B,generateString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.ALPHA_DIGIT,n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&m(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(b(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const o=f(e)?[]:{};return T(e,((e,t)=>{const a=n(e,r+1);!h(a)&&(o[t]=a)})),t[r]=void 0,o}}return e};return n(e,0)},isAsyncFn:G,isThenable:e=>e&&(b(e)||m(e))&&m(e.then)&&m(e.catch),setImmediate:U,asap:W};function V(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}H.inherits(V,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const Q=V.prototype,K={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{K[e]={value:e}})),Object.defineProperties(V,K),Object.defineProperty(Q,"isAxiosError",{value:!0}),V.from=(e,t,n,r,o,a)=>{const l=Object.create(Q);return H.toFlatObject(e,l,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),V.call(l,e.message,t,n,r,o),l.cause=e,l.name=e.name,a&&Object.assign(l,a),l};const J=V;function Y(e){return H.isPlainObject(e)||H.isArray(e)}function X(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function Z(e,t,n){return e?e.concat(t).map((function(e,t){return e=X(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const ee=H.toFlatObject(H,{},null,(function(e){return/^is[A-Z]/.test(e)}));const te=function(e,t,n){if(!H.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=H.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!H.isUndefined(t[e])}))).metaTokens,o=n.visitor||c,a=n.dots,l=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(o))throw new TypeError("visitor must be a function");function i(e){if(null===e)return"";if(H.isDate(e))return e.toISOString();if(!s&&H.isBlob(e))throw new J("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(e)||H.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,o){let s=e;if(e&&!o&&"object"===typeof e)if(H.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(H.isArray(e)&&function(e){return H.isArray(e)&&!e.some(Y)}(e)||(H.isFileList(e)||H.endsWith(n,"[]"))&&(s=H.toArray(e)))return n=X(n),s.forEach((function(e,r){!H.isUndefined(e)&&null!==e&&t.append(!0===l?Z([n],r,a):null===l?n:n+"[]",i(e))})),!1;return!!Y(e)||(t.append(Z(o,n,a),i(e)),!1)}const u=[],d=Object.assign(ee,{defaultVisitor:c,convertValue:i,isVisitable:Y});if(!H.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!H.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),H.forEach(n,(function(n,a){!0===(!(H.isUndefined(n)||null===n)&&o.call(t,n,H.isString(a)?a.trim():a,r,d))&&e(n,r?r.concat(a):[a])})),u.pop()}}(e),t};function ne(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function re(e,t){this._pairs=[],e&&te(e,this,t)}const oe=re.prototype;oe.append=function(e,t){this._pairs.push([e,t])},oe.toString=function(e){const t=e?function(t){return e.call(this,t,ne)}:ne;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const ae=re;function le(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function se(e,t,n){if(!t)return e;const r=n&&n.encode||le,o=n&&n.serialize;let a;if(a=o?o(t,n):H.isURLSearchParams(t)?t.toString():new ae(t,n).toString(r),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}const ie=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},ce={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ue={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:ae,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},de="undefined"!==typeof window&&"undefined"!==typeof document,pe="object"===typeof navigator&&navigator||void 0,fe=de&&(!pe||["ReactNative","NativeScript","NS"].indexOf(pe.product)<0),he="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,ye=de&&window.location.href||"http://localhost",ge={...r,...ue};const me=function(e){function t(e,n,r,o){let a=e[o++];if("__proto__"===a)return!0;const l=Number.isFinite(+a),s=o>=e.length;if(a=!a&&H.isArray(r)?r.length:a,s)return H.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!l;r[a]&&H.isObject(r[a])||(r[a]=[]);return t(e,n,r[a],o)&&H.isArray(r[a])&&(r[a]=function(e){const t={},n=Object.keys(e);let r;const o=n.length;let a;for(r=0;r<o;r++)a=n[r],t[a]=e[a];return t}(r[a])),!l}if(H.isFormData(e)&&H.isFunction(e.entries)){const n={};return H.forEachEntry(e,((e,r)=>{t(function(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const ve={transitional:ce,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=H.isObject(e);o&&H.isHTMLForm(e)&&(e=new FormData(e));if(H.isFormData(e))return r?JSON.stringify(me(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return te(e,new ge.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return ge.isNode&&H.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((a=H.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return te(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),function(e,t,n){if(H.isString(e))try{return(t||JSON.parse)(e),H.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ve.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(o){if(n){if("SyntaxError"===o.name)throw J.from(o,J.ERR_BAD_RESPONSE,this,null,this.response);throw o}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ge.classes.FormData,Blob:ge.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],(e=>{ve.headers[e]={}}));const be=ve,we=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xe=Symbol("internals");function Se(e){return e&&String(e).trim().toLowerCase()}function ke(e){return!1===e||null==e?e:H.isArray(e)?e.map(ke):String(e)}function Ce(e,t,n,r,o){return H.isFunction(r)?r.call(this,t,n):(o&&(t=n),H.isString(t)?H.isString(r)?-1!==t.indexOf(r):H.isRegExp(r)?r.test(t):void 0:void 0)}class Ee{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(e,t,n){const o=Se(t);if(!o)throw new Error("header name must be a non-empty string");const a=H.findKey(r,o);(!a||void 0===r[a]||!0===n||void 0===n&&!1!==r[a])&&(r[a||t]=ke(e))}const a=(e,t)=>H.forEach(e,((e,n)=>o(e,n,t)));if(H.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(H.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let n,r,o;return e&&e.split("\n").forEach((function(e){o=e.indexOf(":"),n=e.substring(0,o).trim().toLowerCase(),r=e.substring(o+1).trim(),!n||t[n]&&we[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(H.isHeaders(e))for(const[l,s]of e.entries())o(s,l,n);else null!=e&&o(t,e,n);return this}get(e,t){if(e=Se(e)){const n=H.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(H.isFunction(t))return t.call(this,e,n);if(H.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Se(e)){const n=H.findKey(this,e);return!(!n||void 0===this[n]||t&&!Ce(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function o(e){if(e=Se(e)){const o=H.findKey(n,e);!o||t&&!Ce(0,n[o],o,t)||(delete n[o],r=!0)}}return H.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];e&&!Ce(0,this[o],o,e,!0)||(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return H.forEach(this,((r,o)=>{const a=H.findKey(n,o);if(a)return t[a]=ke(r),void delete t[o];const l=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(o):String(o).trim();l!==o&&delete t[o],t[l]=ke(r),n[l]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return H.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&H.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[xe]=this[xe]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Se(e);t[r]||(!function(e,t){const n=H.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})}))}(n,e),t[r]=!0)}return H.isArray(e)?e.forEach(r):r(e),this}}Ee.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),H.reduceDescriptors(Ee.prototype,((e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}})),H.freezeMethods(Ee);const Ie=Ee;function Ne(e,t){const n=this||be,r=t||n,o=Ie.from(r.headers);let a=r.data;return H.forEach(e,(function(e){a=e.call(n,a,o.normalize(),t?t.status:void 0)})),o.normalize(),a}function je(e){return!(!e||!e.__CANCEL__)}function Pe(e,t,n){J.call(this,null==e?"canceled":e,J.ERR_CANCELED,t,n),this.name="CanceledError"}H.inherits(Pe,J,{__CANCEL__:!0});const Te=Pe;function $e(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new J("Request failed with status code "+n.status,[J.ERR_BAD_REQUEST,J.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Re=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o,a=0,l=0;return t=void 0!==t?t:1e3,function(s){const i=Date.now(),c=r[l];o||(o=i),n[a]=s,r[a]=i;let u=l,d=0;for(;u!==a;)d+=n[u++],u%=e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),i-o<t)return;const p=c&&i-c;return p?Math.round(1e3*d/p):void 0}};const Me=function(e,t){let n,r,o=0,a=1e3/t;const l=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();o=a,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-o;for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];t>=a?l(i,e):(n=i,r||(r=setTimeout((()=>{r=null,l(n)}),a-t)))},()=>n&&l(n)]},Fe=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const o=Re(50,250);return Me((n=>{const a=n.loaded,l=n.lengthComputable?n.total:void 0,s=a-r,i=o(s);r=a;e({loaded:a,total:l,progress:l?a/l:void 0,bytes:s,rate:i||void 0,estimated:i&&l&&a<=l?(l-a)/i:void 0,event:n,lengthComputable:null!=l,[t?"download":"upload"]:!0})}),n)},_e=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Oe=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return H.asap((()=>e(...n)))},Ae=ge.hasStandardBrowserEnv?function(){const e=ge.navigator&&/(msie|trident)/i.test(ge.navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=H.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0},Le=ge.hasStandardBrowserEnv?{write(e,t,n,r,o,a){const l=[e+"="+encodeURIComponent(t)];H.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),H.isString(r)&&l.push("path="+r),H.isString(o)&&l.push("domain="+o),!0===a&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function qe(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const De=e=>e instanceof Ie?{...e}:e;function ze(e,t){t=t||{};const n={};function r(e,t,n){return H.isPlainObject(e)&&H.isPlainObject(t)?H.merge.call({caseless:n},e,t):H.isPlainObject(t)?H.merge({},t):H.isArray(t)?t.slice():t}function o(e,t,n){return H.isUndefined(t)?H.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function a(e,t){if(!H.isUndefined(t))return r(void 0,t)}function l(e,t){return H.isUndefined(t)?H.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,o,a){return a in t?r(n,o):a in e?r(void 0,n):void 0}const i={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:s,headers:(e,t)=>o(De(e),De(t),!0)};return H.forEach(Object.keys(Object.assign({},e,t)),(function(r){const a=i[r]||o,l=a(e[r],t[r],r);H.isUndefined(l)&&a!==s||(n[r]=l)})),n}const Be=e=>{const t=ze({},e);let n,{data:r,withXSRFToken:o,xsrfHeaderName:a,xsrfCookieName:l,headers:s,auth:i}=t;if(t.headers=s=Ie.from(s),t.url=se(qe(t.baseURL,t.url),e.params,e.paramsSerializer),i&&s.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):""))),H.isFormData(r))if(ge.hasStandardBrowserEnv||ge.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(ge.hasStandardBrowserEnv&&(o&&H.isFunction(o)&&(o=o(t)),o||!1!==o&&Ae(t.url))){const e=a&&l&&Le.read(l);e&&s.set(a,e)}return t},Ge="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const r=Be(e);let o=r.data;const a=Ie.from(r.headers).normalize();let l,s,i,c,u,{responseType:d,onUploadProgress:p,onDownloadProgress:f}=r;function h(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(l),r.signal&&r.signal.removeEventListener("abort",l)}let y=new XMLHttpRequest;function g(){if(!y)return;const r=Ie.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders());$e((function(e){t(e),h()}),(function(e){n(e),h()}),{data:d&&"text"!==d&&"json"!==d?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:r,config:e,request:y}),y=null}y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout,"onloadend"in y?y.onloadend=g:y.onreadystatechange=function(){y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))&&setTimeout(g)},y.onabort=function(){y&&(n(new J("Request aborted",J.ECONNABORTED,e,y)),y=null)},y.onerror=function(){n(new J("Network Error",J.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const o=r.transitional||ce;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new J(t,o.clarifyTimeoutError?J.ETIMEDOUT:J.ECONNABORTED,e,y)),y=null},void 0===o&&a.setContentType(null),"setRequestHeader"in y&&H.forEach(a.toJSON(),(function(e,t){y.setRequestHeader(t,e)})),H.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),d&&"json"!==d&&(y.responseType=r.responseType),f&&([i,u]=Fe(f,!0),y.addEventListener("progress",i)),p&&y.upload&&([s,c]=Fe(p),y.upload.addEventListener("progress",s),y.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(l=t=>{y&&(n(!t||t.type?new Te(null,e,y):t),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(l),r.signal&&(r.signal.aborted?l():r.signal.addEventListener("abort",l)));const m=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);m&&-1===ge.protocols.indexOf(m)?n(new J("Unsupported protocol "+m+":",J.ERR_BAD_REQUEST,e)):y.send(o||null)}))},Ue=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const o=function(e){if(!n){n=!0,l();const t=e instanceof Error?e:this.reason;r.abort(t instanceof J?t:new Te(t instanceof Error?t.message:t))}};let a=t&&setTimeout((()=>{a=null,o(new J(`timeout ${t} of ms exceeded`,J.ETIMEDOUT))}),t);const l=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(o):e.removeEventListener("abort",o)})),e=null)};e.forEach((e=>e.addEventListener("abort",o)));const{signal:s}=r;return s.unsubscribe=()=>H.asap(l),s}},We=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,o=0;for(;o<n;)r=o+t,yield e.slice(o,r),o=r},He=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Ve=(e,t,n,r)=>{const o=async function*(e,t){for await(const n of He(e))yield*We(n,t)}(e,t);let a,l=0,s=e=>{a||(a=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await o.next();if(t)return s(),void e.close();let a=r.byteLength;if(n){let e=l+=a;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw s(t),t}},cancel:e=>(s(e),o.return())},{highWaterMark:2})},Qe="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Ke=Qe&&"function"===typeof ReadableStream,Je=Qe&&("function"===typeof TextEncoder?(Ye=new TextEncoder,e=>Ye.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ye;const Xe=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(o){return!1}},Ze=Ke&&Xe((()=>{let e=!1;const t=new Request(ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),et=Ke&&Xe((()=>H.isReadableStream(new Response("").body))),tt={stream:et&&(e=>e.body)};var nt;Qe&&(nt=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!tt[e]&&(tt[e]=H.isFunction(nt[e])?t=>t[e]():(t,n)=>{throw new J(`Response type '${e}' is not supported`,J.ERR_NOT_SUPPORT,n)})})));const rt=async(e,t)=>{const n=H.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(H.isBlob(e))return e.size;if(H.isSpecCompliantForm(e)){const t=new Request(ge.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return H.isArrayBufferView(e)||H.isArrayBuffer(e)?e.byteLength:(H.isURLSearchParams(e)&&(e+=""),H.isString(e)?(await Je(e)).byteLength:void 0)})(t):n},ot={http:null,xhr:Ge,fetch:Qe&&(async e=>{let{url:t,method:n,data:r,signal:o,cancelToken:a,timeout:l,onDownloadProgress:s,onUploadProgress:i,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:p}=Be(e);c=c?(c+"").toLowerCase():"text";let f,h=Ue([o,a&&a.toAbortSignal()],l);const y=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let g;try{if(i&&Ze&&"get"!==n&&"head"!==n&&0!==(g=await rt(u,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(H.isFormData(r)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=_e(g,Fe(Oe(i)));r=Ve(n.body,65536,e,t)}}H.isString(d)||(d=d?"include":"omit");const o="credentials"in Request.prototype;f=new Request(t,{...p,signal:h,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:o?d:void 0});let a=await fetch(f);const l=et&&("stream"===c||"response"===c);if(et&&(s||l&&y)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=a[t]}));const t=H.toFiniteNumber(a.headers.get("content-length")),[n,r]=s&&_e(t,Fe(Oe(s),!0))||[];a=new Response(Ve(a.body,65536,n,(()=>{r&&r(),y&&y()})),e)}c=c||"text";let m=await tt[H.findKey(tt,c)||"text"](a,e);return!l&&y&&y(),await new Promise(((t,n)=>{$e(t,n,{data:m,headers:Ie.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:f})}))}catch(m){if(y&&y(),m&&"TypeError"===m.name&&/fetch/i.test(m.message))throw Object.assign(new J("Network Error",J.ERR_NETWORK,e,f),{cause:m.cause||m});throw J.from(m,m&&m.code,e,f)}})};H.forEach(ot,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}}));const at=e=>`- ${e}`,lt=e=>H.isFunction(e)||null===e||!1===e,st=e=>{e=H.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let a=0;a<t;a++){let t;if(n=e[a],r=n,!lt(n)&&(r=ot[(t=String(n)).toLowerCase()],void 0===r))throw new J(`Unknown adapter '${t}'`);if(r)break;o[t||"#"+a]=r}if(!r){const e=Object.entries(o).map((e=>{let[t,n]=e;return`adapter ${t} `+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=t?e.length>1?"since :\n"+e.map(at).join("\n"):" "+at(e[0]):"as no adapter specified";throw new J("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function it(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Te(null,e)}function ct(e){it(e),e.headers=Ie.from(e.headers),e.data=Ne.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return st(e.adapter||be.adapter)(e).then((function(t){return it(e),t.data=Ne.call(e,e.transformResponse,t),t.headers=Ie.from(t.headers),t}),(function(t){return je(t)||(it(e),t&&t.response&&(t.response.data=Ne.call(e,e.transformResponse,t.response),t.response.headers=Ie.from(t.response.headers))),Promise.reject(t)}))}const ut="1.7.7",dt={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{dt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const pt={};dt.transitional=function(e,t,n){function r(e,t){return"[Axios v1.7.7] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,a)=>{if(!1===e)throw new J(r(o," has been removed"+(t?" in "+t:"")),J.ERR_DEPRECATED);return t&&!pt[o]&&(pt[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,a)}};const ft={assertOptions:function(e,t,n){if("object"!==typeof e)throw new J("options must be an object",J.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const a=r[o],l=t[a];if(l){const t=e[a],n=void 0===t||l(t,a,e);if(!0!==n)throw new J("option "+a+" must be "+n,J.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new J("Unknown option "+a,J.ERR_BAD_OPTION)}},validators:dt},ht=ft.validators;class yt{constructor(e){this.defaults=e,this.interceptors={request:new ie,response:new ie}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e;Error.captureStackTrace?Error.captureStackTrace(e={}):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(r){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=ze(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;void 0!==n&&ft.assertOptions(n,{silentJSONParsing:ht.transitional(ht.boolean),forcedJSONParsing:ht.transitional(ht.boolean),clarifyTimeoutError:ht.transitional(ht.boolean)},!1),null!=r&&(H.isFunction(r)?t.paramsSerializer={serialize:r}:ft.assertOptions(r,{encode:ht.function,serialize:ht.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=o&&H.merge(o.common,o[t.method]);o&&H.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=Ie.concat(a,o);const l=[];let s=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,l.unshift(e.fulfilled,e.rejected))}));const i=[];let c;this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)}));let u,d=0;if(!s){const e=[ct.bind(this),void 0];for(e.unshift.apply(e,l),e.push.apply(e,i),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=l.length;let p=t;for(d=0;d<u;){const e=l[d++],t=l[d++];try{p=e(p)}catch(f){t.call(this,f);break}}try{c=ct.call(this,p)}catch(f){return Promise.reject(f)}for(d=0,u=i.length;d<u;)c=c.then(i[d++],i[d++]);return c}getUri(e){return se(qe((e=ze(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}H.forEach(["delete","get","head","options"],(function(e){yt.prototype[e]=function(t,n){return this.request(ze(n||{},{method:e,url:t,data:(n||{}).data}))}})),H.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request(ze(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}yt.prototype[e]=t(),yt.prototype[e+"Form"]=t(!0)}));const gt=yt;class mt{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,o){n.reason||(n.reason=new Te(e,r,o),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new mt((function(t){e=t})),cancel:e}}}const vt=mt;const bt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bt).forEach((e=>{let[t,n]=e;bt[n]=t}));const wt=bt;const xt=function e(t){const n=new gt(t),r=l(gt.prototype.request,n);return H.extend(r,gt.prototype,n,{allOwnKeys:!0}),H.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(ze(t,n))},r}(be);xt.Axios=gt,xt.CanceledError=Te,xt.CancelToken=vt,xt.isCancel=je,xt.VERSION=ut,xt.toFormData=te,xt.AxiosError=J,xt.Cancel=xt.CanceledError,xt.all=function(e){return Promise.all(e)},xt.spread=function(e){return function(t){return e.apply(null,t)}},xt.isAxiosError=function(e){return H.isObject(e)&&!0===e.isAxiosError},xt.mergeConfig=ze,xt.AxiosHeaders=Ie,xt.formToJSON=e=>me(H.isHTMLForm(e)?new FormData(e):e),xt.getAdapter=st,xt.HttpStatusCode=wt,xt.default=xt;const St=xt;async function kt(e){if(!e)return console.error("No playerId provided for fetching inventory and backpack"),{inventory:[],backpack:[]};try{var t,n,r,o;const a=await St.get(`http://localhost:3001/api/inventory/${e}`);return{inventory:(null===(t=a.data)||void 0===t?void 0:t.inventory)||[],backpack:(null===(n=a.data)||void 0===n?void 0:n.backpack)||[],warehouseCapacity:(null===(r=a.data)||void 0===r?void 0:r.warehouseCapacity)||0,backpackCapacity:(null===(o=a.data)||void 0===o?void 0:o.backpackCapacity)||0}}catch(a){return console.error("Error fetching inventory and backpack:",a),{inventory:[],backpack:[]}}}async function Ct(e){if(!e)return console.error("No playerId provided for fetching inventory"),[];try{var t;return(null===(t=(await St.get(`http://localhost:3001/api/inventory/${e}`)).data)||void 0===t?void 0:t.inventory)||[]}catch(n){return console.error("Error fetching inventory:",n),[]}}async function Et(e,t,n,r){if(null===e||void 0===e||!e.playerId)return console.error("No player ID provided for updating inventory"),[];try{const o=[...e.inventory],a=o.findIndex((e=>e.type===t));-1!==a?(o[a].quantity+=n,o[a].quantity<=0&&o.splice(a,1)):n>0&&o.push({type:t,quantity:n}),await St.post("http://localhost:3001/api/update-inventory",{playerId:e.playerId,inventory:o,backpack:e.backpack}),console.log("Inventory updated successfully on the server.");const l={...e,inventory:o};return r(l),localStorage.setItem("player",JSON.stringify(l)),o}catch(o){throw console.error("Error updating inventory:",o),o}}async function It(e,t){try{var n,r;const o=await St.get(`http://localhost:3001/api/player/${e}`),a=o.data,l=null===(n=En.getGridState(null===(r=a.location)||void 0===r?void 0:r.g))||void 0===n?void 0:n.pcs[e];l&&(a.location={...a.location,x:l.position.x,y:l.position.y}),t(a),console.log("Player refreshed successfully:",o.data)}catch(o){console.error("Error refreshing player:",o)}}function Nt(e,t){let n=!0;for(let r=1;r<=3;r++){const o=e[`ingredient${r}`],a=e[`ingredient${r}qty`];if(o&&a){const e=t.find((e=>e.type===o));if(!e||e.quantity<a){n=!1;break}}}if(n)for(let r=1;r<=3;r++){const n=e[`ingredient${r}`],o=e[`ingredient${r}qty`];if(n&&o){const e=t.findIndex((e=>e.type===n));e>=0&&(t[e].quantity-=o,t[e].quantity<=0&&t.splice(e,1))}}return n}function jt(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const l=(null===(t=e.location)||void 0===t?void 0:t.gtype)||"homestead",s=!["homestead"].includes(l),i=s?r:n,c=s?e.backpackCapacity:e.warehouseCapacity,u=i.filter((e=>"Money"!==e.type)).reduce(((e,t)=>e+(t.quantity||0)),0)+a<=c;return u||console.warn(`Cannot add ${a} ${o}: Exceeds capacity in ${s?"backpack":"warehouse"}.`),u}var Pt=n(950);const Tt=JSON.parse('{"0":"Welcome to Valley View","1":"Server is not running.","3":"\ud83d\ude9c Land successfully tilled.","4":"\u26a0\ufe0f You don\'t have enough resources.","5":"\u2692\ufe0f Construction completed successfully.","6":"\ud83d\udcb0 Items sold.","7":"\ud83c\udfe0 This homsetead is unoccupied.","8":"\ud83d\udeab This area is off limits.","9":"The Valley is full of wonders, and must be explored on foot.","10":"\ud83c\udfe0 [username]\'s homestead.","11":"\ud83c\udfe0 Unknown owner\'s homestead.","12":"Settlement view.","13":"Frontier view.","14":"\ud83c\udfe0 Welcome to town.","15":"\ud83d\udc34 You need the Horseriding skill to travel here.","16":"You\'re in the valley.","17":"You do not own a hometead here.","18":"\ud83d\udeab You can\'t go that way.","19":"\ud83c\udf92 You need a backpack to collect resources away from your homestead.","20":"\ud83d\udeab Warehouse is full.","21":"\ud83c\udf92 Backpack is full.","22":"Items purchased.","23":"\u26a0\ufe0f You can\'t build that here.","24":"\ud83c\udfaf Out of range","25":"\ud83c\udf92 Nothing in the backpack.","26":"\ud83c\udf92 You must be at your homestead to empty your backpack.","27":"\u26fa\ufe0f You don\'t have a tent.","28":"\u26fa\ufe0f You are now camping.","29":"\u26a0\ufe0f \u26fa\ufe0f Failed to camp / decamp.","30":"\u26fa\ufe0f No longer camping.","31":"\u26fa\ufe0f Cannot attack while camping.","32":"\u26fa\ufe0f You need to decamp first.","33":"\ud83c\udfe0 Moved items to the Warehouse.","34":"\ud83c\udf92 Emptied backpack.","50":"\ud83d\udeab That username is already taken.","100":"TRAVELING STRINGS:","101":"\ud83d\udc34 Traveling home ... please wait.","102":"\ud83d\udc34 Traveling to town ... please wait.","103":"\ud83d\udc34 Traveling to the next location ... please wait.","104":"\ud83d\udeab No town in this settlement yet.","105":"\u26a0\ufe0f There was a problem trying to travel.","106":"\ud83d\udeab You cannot travel beyond the frontier.","200":"QUESTS","201":"\u2705 Quest completed. You have your reward.","202":"\u2705 Quest accepted.","299":"FARMING STRINGS:","300":"\u2705 Added","301":"\ud83d\ude9c Tilled","302":"\ud83d\ude9c Planted","303":"\ud83d\ude9c Must plant on dirt","304":"\ud83d\ude9c Can\'t plant here","305":"\u26a0\ufe0f Not enough resources","306":"\u26a0\ufe0f Can\'t build here","400":"BUYING, CRAFTING, SKILLS, HEALING, ETC.","401":"\u2764\ufe0f\u200d\ud83e\ude79 Already at maximum hit points.","402":"\u26a0\ufe0f You don\'t have enough resources.","403":"\u26a0\ufe0f Youre inventory is full.","404":"Working...","500":"COMBAT STRINGS","501":"\ud83c\udfaf Out of range.","502":"\ud83c\udfaf Hit!","503":"\u274c Miss","504":"\ud83d\udc80 Killed","505":"\u26a0\ufe0f Error","510":"\u2764\ufe0f\u200d\ud83e\ude79 You\'re taking damage ...","899":"DEBUG STRINGS:","900":"Debug: Inventory & Skills cleared.","901":"Debug: Quest history cleared.","902":"Debug: Resources added.","903":"Debug: Grid successfully reset.","904":"Debug: Skills added.","999":"PANEL UI STRINGS:","1000":"[Description needed]","1001":"Inventory: Resources collected at the Homestead will go into the warehouse. Resources collected in town or in the valley will go into the backpack. To buy a backpack, go to Skills. Crafting stations will only pull items from the warehouse. You can empty your backpack into the warehouse anytime you are on your Homestead.","1002":"Build: Build crafting stations on your Homestead using resources from your warehouse.","1003":"Purchased animals will appear at your player icon, and immediately begin life on the homestead.","1004":"Till land to dirt in order to plant crops. Plant grass to give farm animals something to graze on.","1005":"Acquire Skills and Upgrades to improve various attributes. Make sure to explore the Town to find additional places and ways to gain Skills and Upgrades.","1006":"Manage all of your ongoing quests here. Look for quest-giving characters on your homestead as well as Town, or even the Valley.","1007":"Governments in Valley View are formed at the settlement level. The mayor and their cabinet manage shared resources, settle disputes, and implement policies to help the community thrive.","1008":"Trade Stall: Sell your resources to other players or buy items from their trade stalls. Use the arrows to navigate between trade stalls within your Settlement. If no other players buy your items, you can always sell them to the game for 50% of their value.","1009":" ","1010":"[Mailbox description]","1011":"This Animal Stall is empty. Make sure animals have grass to eat, and they will eventually come to the stall for harvesting.","1012":"Elections take place in the Courthouse. Mayors have the power to set the tax rate here.","1013":" ","1014":" ","1015":"The game takes place over the course of continually changing seasons. At the end of a season, a portion of your wealth and rare items will carry over. Upgrade to a Gold account for more carry-over benefits.","1016":" ","1017":"Visit the Bank to exchange items for Money, including rare items like Gold and Silver. Return to the bank regulalry for different offers.","1018":"","1019":"[Profile description]","1021":"[Login description]","1022":"[Train description]","1023":"[Farm hands description]","1101":"Inventory","1102":"\u2692\ufe0f Build","1103":"\ud83d\uded2 Buy","1104":"\ud83d\ude9c Farming","1105":"\u2699\ufe0f Skills & Upgrades","1106":"\u2753 Quests","1107":"\ud83c\udfdb\ufe0f Government","1108":"\ud83c\udfe0 Trade Stall","1109":" ","1110":"\ud83d\udcea Mailbox","1111":"\ud83d\udc3e Animals","1112":"\ud83c\udfdb\ufe0f Courthouse","1113":"Helper Character","1114":"\ud83d\ude00 Player Character","1115":"\u23f3 Season","1116":"Trader","1117":"\ud83c\udfe6 Bank","1118":"\ud83d\udd79\ufe0f How to Play","1119":"\ud83d\ude00 Profile","1120":"\ud83d\udc1e Debug","1121":"Welcome to Valley View","1122":"\ud83d\ude82 Train","1123":"\ud83e\uddd1\ud83c\udffc\u200d\ud83c\udf3e Farm Hands","2000":"TRAIN, BANK, COURTHOUSE, etc. STRINGS:","2002":"\u2705 Completed","2003":"\ud83d\udce6 Next Shipment Preview:","2004":"\ud83c\udf81 Rewards for filling all orders:","2005":"Click to fulfill","2006":"Your Order","2007":"Claimed","2008":"Claim Order","2009":"Claimed by you:","2010":"Available to claim:","2011":"Claimed by others:","2012":"Completed:","2013":"Claimed by you:","2020":"Train is","2030":"Offers Update in","2040":"Welcome, Mayor.","2041":"\ud83d\udcb0 Tax Rate: ","2042":"Proposed Tax Rate: ","2043":"Update Tax Rate","2044":"\u26a0\ufe0f Only the Mayor can set the tax rate.","2045":"\ud83d\uddf3\ufe0f Elections","2046":"Current Phase:","2047":"Next Phase Begins In:","2048":"\ud83d\udce2 Campaign Promises","2049":"No one has made a campaign promise yet.","2050":"Submit Campaign Promise","2051":"Cast Your Vote","2052":"No candidates available for voting.","2053":"","2100":"GOV PANEL STRINGS:","2101":"Your Settlement: ","2102":"The tax rate is set by the Mayor, for this Settlement, and a percentage of all taxes collected are added to the Mayor\'s account.","2103":"Mayors are elected at the Courthouse in Town.","2104":"\ud83c\udfdb\ufe0f Government Officials","2105":"No government officials elected yet.","2106":"\ud83c\udfdb\ufe0f Roles & Responsibilities:","2107":"Only the Mayor can build Schools, Hospitals and Animal Yards in the Town.","2108":"\ud83c\udfeb Schools give citizens access to certain Skills that cannot be gained elsewhere.","2109":"\ud83c\udfe5 Hospitals supply Doctors, who can heal adventurers returning from the Valley.","2110":"\ud83d\udc3e Animal Yards supply unique livestock, which can be transported back to Homesteads by any player.","2111":"\ud83d\ude82 The Mayor can influence demand for goods at the Train.","5000":"MODAL STRINGS:","5001":"\ud83d\udc80 You have died.","5002":"You have been returned home.","5003":"Any backpack \ud83c\udf92 items you had were lost.","5005":"Welcome to Valley View","5006":"Please login, or create a free account.","5007":"(c) Four Knights Software","5010":"Inbox","5011":"You have no messages","5015":"Store","5016":"We are unable to offer returns. All purchases are final.","5017":"Be aware that many inventory items are wiped between seasons, so please check the season clock before purchasing, and see the seasons panel for more information.","5020":"You are currently logged out.","5021":"Click the Login or Create Account button to begin.","5025":"Thank you for your support!","5026":"Your purchase has been delivered to your Inbox.","5027":"Enjoy Valley View!","5030":"","5031":"","5035":"","5036":"","5040":"","5041":"","7000":"GOLD ACCOUNT STRINGS:","7001":"Upgrade to Gold Status","7002":"Become a monthly contributor, with the following benefits. Cancel anytime.","7005":"\u2705 Unlimited Warehouse inventory","7006":"\u2705 Extra large backpack inventory","7007":"\u2705 All your stats and skills carry over season to season","7008":"\u2705 You have 4 extra Trade Stall slots","7009":"\u2705 Lower Tax rate (half of the set tax rate)","7010":"\u2705 Half your MaxHP restored on death","7011":"\u2705 You can run for office","7012":"\u2705 Customize your player icon: \ud83d\ude21 \ud83d\ude0e \ud83d\ude31 \ud83e\udd21 \ud83d\ude07 \ud83d\ude3b \ud83d\udca9","7013":"\u2705 Daily rewards sent to your Inbox","hp":"Hit Points","maxhp":"Max Hit Points","attackrange":"Attack Range","attackbonus":"Attack Bonus","damage":"Attack Damage","speed":"Attack Speed","iscamping":"Is Camping","armorclass":"Armor Class","backpackCapacity":"Backpack Capacity","warehouseCapacity":"Warehouse Capacity"}');var $t=n(579);const Rt=()=>{const[e,t]=(0,o.useState)([]);return Rt.addFloatingText=(e,n,r)=>{const o=`${Date.now()}-${Math.floor(1e4*Math.random())}`,a=(e=>{if("number"===typeof e||!isNaN(e)&&/^\d+$/.test(e)){const t=parseInt(e,10);if(Tt[t])return Tt[t]}return e})(e),l=document.querySelector(".homestead"),s=l?l.scrollLeft:0,i=l?l.scrollTop:0;console.log(`\ud83d\udce2 FloatingText at (${n}, ${r}) \u2192 Adjusted for scroll (${s}, ${i})`),t((e=>[...e,{id:o,text:a,x:n+190-s,y:r+60-i}])),setTimeout((()=>{t((e=>e.filter((e=>e.id!==o))))}),1e3)},(0,Pt.createPortal)((0,$t.jsx)($t.Fragment,{children:e.map((e=>{let{id:t,text:n,x:r,y:o}=e;return(0,$t.jsx)("div",{className:"floating-text",style:{position:"absolute",left:r,top:o},children:n},t)}))}),document.body)},Mt=Rt,Ft=(0,o.createContext)(),_t=e=>{let{children:t}=e;const[n,r]=(0,o.useState)(null);return(0,$t.jsx)(Ft.Provider,{value:{activePanel:n,openPanel:e=>{r(e)},closePanel:()=>{r(null)}},children:t})},Ot=()=>(0,o.useContext)(Ft),At=e=>{let{onClose:t,children:n,descriptionKey:r,panelName:a,titleKey:l}=e;const{activePanel:s,openPanel:i,closePanel:c}=Ot();return(0,o.useEffect)((()=>{s===a&&i(a)}),[s,a,i]),s!==a?null:(0,$t.jsxs)("div",{className:"panel-container",children:[(0,$t.jsxs)("div",{className:"panel-header",children:[(0,$t.jsx)("h2",{className:"panel-title",children:Tt[l]||"Panel"}),(0,$t.jsx)("button",{className:"panel-close-btn",onClick:()=>{c(),t()},children:(0,$t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"24",height:"24",children:[(0,$t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,$t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,$t.jsx)("div",{className:"panel-content",children:n}),r&&(0,$t.jsx)("div",{className:"panel-description",children:(0,$t.jsx)("p",{children:Tt[r]})})]})},Lt=e=>{let{symbol:t,name:n,details:r,info:a,disabled:l,className:s,onClick:i,hideInfo:c=!1,children:u}=e;const[d,p]=(0,o.useState)(!1),[f,h]=(0,o.useState)({top:0,left:0}),y=(0,o.useRef)(null),g=e=>{h({top:e.clientY+window.scrollY+10,left:e.clientX+window.scrollX+15})};return(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("div",{className:"resource-button-wrapper",onMouseLeave:()=>p(!1),children:(0,$t.jsxs)("button",{ref:y,className:`resource-button ${l?"disabled":""} ${s||""}`,onClick:i,disabled:l,children:[(0,$t.jsxs)("span",{className:"resource-title",children:[t," ",n]}),(0,$t.jsx)("span",{className:"resource-details",dangerouslySetInnerHTML:{__html:r}}),u,!c&&a&&(0,$t.jsx)("span",{className:"info-button",onMouseEnter:e=>{p(!0),g(e)},onMouseMove:g,children:"\u2139\ufe0f"})]})}),d&&a&&Pt.createPortal((0,$t.jsx)("div",{className:"info-toaster",style:{top:f.top,left:f.left,position:"absolute"},children:"string"===typeof a?(0,$t.jsx)("p",{dangerouslySetInnerHTML:{__html:a}}):(0,$t.jsx)($t.Fragment,{children:a})}),document.body)]})},qt=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e||!Array.isArray(t))return!1;for(let r=1;r<=3;r++){const o=e[`ingredient${r}`],a=e[`ingredient${r}qty`]*n;if(o&&a>=0){const e=t.find((e=>e.type===o));if(!e||e.quantity<=a)return!1}}return!0},Dt=(e,t)=>{const n=[];for(let r=1;r<=4;r++){const o=e[`ingredient${r}`],a=e[`ingredient${r}qty`];if(o&&a){const e=t.find((e=>e.type===o)),r=(null===e||void 0===e?void 0:e.symbol)||"";n.push(`${r} ${o} x${a}`)}}return n},zt=(0,o.createContext)(),Bt=e=>{let{children:t}=e;const[n,r]=(0,o.useState)("...");return(0,$t.jsx)(zt.Provider,{value:{message:n,updateStatus:e=>{if("number"===typeof e){const t=Tt[e];t?r(t):console.warn(`No string found for index ${e}. Falling back to default.`)}else"string"===typeof e?r(e):console.warn("Invalid status message input. Falling back to default.")}},children:t})},Gt=()=>{const{message:e}=o.useContext(zt);return(0,$t.jsx)("div",{className:"status-bar",children:(0,$t.jsx)("p",{children:e},e)})},Ut=e=>{let{quest:t,state:n,onClick:r}=e;const{symbol:o,title:a,completed:l,goals:s=[]}=t;return(0,$t.jsxs)("div",{className:`resource-button ${n}`,onClick:r,children:[(0,$t.jsxs)("h3",{children:[o," ",a]}),(0,$t.jsx)("h4",{children:l?"Return to collect your reward.":"In Progress"}),s.map(((e,t)=>e.action&&e.item&&e.qty?(0,$t.jsxs)("p",{children:[e.action," ",e.item," x",e.qty,": ",e.progress," of ",e.qty]},t):null))]})},Wt=e=>{let{quest:t,state:n,onClick:r}=e;const{symbol:o,title:a,textbody:l,reward:s,rewardqty:i,goals:c=[]}=t,u="reward"===n?"Get Reward":"Accept Quest";return(0,$t.jsxs)("div",{className:`resource-button ${n}`,onClick:r,children:[(0,$t.jsxs)("h3",{children:[o," ",a]}),(0,$t.jsx)("p",{children:l}),(0,$t.jsx)("div",{className:"quest-goals",children:c.map(((e,t)=>e.action&&e.item&&e.qty?(0,$t.jsxs)("p",{children:[e.action," ",e.item," x",e.qty]},t):null))}),(0,$t.jsxs)("p",{children:["Reward: ",i," ",s]}),(0,$t.jsx)("button",{className:"quest-giver-button",children:u})]})};let Ht=null,Vt=null;async function Qt(){if(!Ht)try{const e=await St.get("http://localhost:3001/api/skills-tuning");Ht=e.data}catch(e){console.error("Error fetching master skills:",e),Ht={}}return Ht}async function Kt(){if(!Vt)try{const e=await St.get("http://localhost:3001/api/resources");Vt=e.data,console.log("Master resources loaded:",Vt)}catch(e){console.error("Error fetching master resources:",e),Vt=[]}return console.log("Master resources available and being returned"),Vt}const Jt=async(e,t,n,r)=>{try{var o;if(console.log("made it to modifyPlayerStatsInGridState"),console.log("statToMod = ",e,"; amountToMod = ",t),!e||!t)return void console.error("Invalid stat or amount to modify.");const a=En.getGridState(r),l=null===a||void 0===a||null===(o=a.pcs)||void 0===o?void 0:o[String(n)];if(!l)return void console.error(`Player ${n} not found in gridState.`);e in l&&(l[e]+=t,console.log(`Modified ${e} in gridState: new value = ${l[e]}`)),En.updatePC(r,n,{[e]:l[e]}),console.log(`Updated ${e} for player ${n} in gridState.`)}catch(a){console.error("Error in modifyPlayerStats:",a)}},Yt=e=>{let{onClose:t,npcData:n,inventory:r,setInventory:a,setBackpack:l,currentPlayer:s,setCurrentPlayer:i,setResources:c}=e;const{updateStatus:u}=(0,o.useContext)(zt),{closePanel:d}=Ot(),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]),[v,b]=(0,o.useState)(""),[w,x]=(0,o.useState)("");console.log("made it to QuestGiverPanel/Healer; npcData = ",n),n||(console.warn("QuestGiverPanel was opened with missing npcData."),n={type:"Unknown NPC",symbol:"\u2753"}),(0,o.useEffect)((()=>{n&&n.type&&("quest"===n.action?S():"heal"===n.action&&k())}),[n]);const S=async()=>{try{const e=await St.get("http://localhost:3001/api/quests"),t=s.activeQuests.filter((e=>!e.completed||e.rewardCollected)).map((e=>e.questId)),r=s.completedQuests.map((e=>e.questId)),o=e.data.filter((e=>e.giver===n.type)).filter((e=>!t.includes(e.title))).filter((e=>e.repeatable||!r.includes(e.title)));f(o)}catch(e){console.error("Error fetching quests:",e)}},k=async()=>{try{const e=await Kt(),t=e.filter((e=>e.type===n.type));console.log("filteredRecipes:",t),y(t),m(e)}catch(e){console.error("Error fetching heal recipes:",e)}};return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1013",titleKey:"1113",panelName:"QuestGiverPanel",children:["quest"===n.action&&(0,$t.jsxs)("div",{className:"quest-options",children:[(0,$t.jsxs)("h2",{children:[n.symbol," ",n.type]}),p.length>0?(0,$t.jsx)("h3",{children:"is offering these Quests:"}):(0,$t.jsx)("h3",{children:"has no quests for you at this time."}),p.map((e=>{const t=s.activeQuests.some((t=>t.questId===e.title&&t.completed&&!t.rewardCollected))?"reward":"accept",n="reward"===t?()=>(async e=>{try{var t;const n="Money"===e.reward,r=["town","valley1","valley2","valley3"].includes(s.location.gtype);let o=n?s.inventory:r?s.backpack:s.inventory,c=n?1/0:r?s.backpackCapacity:s.warehouseCapacity;if(!n&&o.filter((e=>"Money"!==e.type)).reduce(((e,t)=>e+t.quantity),0)+e.rewardqty>c){const e=r?21:20;return console.warn(`Cannot collect quest reward: Exceeds capacity in ${r?"backpack":"warehouse"}.`),void u(e)}if(null!==(t=(await St.post("http://localhost:3001/api/complete-quest",{playerId:s.playerId,questId:e.title,reward:{type:e.reward,quantity:e.rewardqty}})).data)&&void 0!==t&&t.success){const t={...s,completedQuests:[...s.completedQuests,{questId:e.title,timestamp:Date.now()}]},c=[...o],p=c.findIndex((t=>t.type===e.reward));p>=0?c[p].quantity+=e.rewardqty:c.push({type:e.reward,quantity:e.rewardqty}),await St.post("http://localhost:3001/api/update-profile",{playerId:s.playerId,updates:{completedQuests:t.completedQuests}}),i(t),n?a(c):r?l(c):a(c),await It(s.playerId,i),u(201),d(),Mt.addFloatingText(`+${e.rewardqty} ${e.reward}`,window.innerWidth/12,window.innerHeight/4)}}catch(n){console.error("Error collecting quest reward:",n),alert("Failed to collect quest reward.")}})(e):()=>(async e=>{if(!e)return;const t=p.find((t=>t.title===e));if(!t)return void console.error(`Quest "${e}" not found in available quests.`);let n={goal1:0,goal2:0,goal3:0},r=0,o=0;for(let i=1;i<=3;i++){const e=t[`goal${i}action`],l=t[`goal${i}item`],c=t[`goal${i}qty`];if(e&&l&&c)if(o++,"Gain skill with"===e){var a;(null===(a=s.skills)||void 0===a?void 0:a.some((e=>e.type===l)))?(n[`goal${i}`]=1,r++):n[`goal${i}`]=0}else n[`goal${i}`]=0}const l=o>0&&r===o;console.log("initialProgress = ",n);try{const t=await St.post("http://localhost:3001/api/add-player-quest",{playerId:s.playerId,questId:e,startTime:Date.now(),progress:n,completed:l});t.data.success?(i(t.data.player),u(202),d(),console.log(`\u2705 Quest "${e}" added with initial progress:`,n)):b(`Failed to accept quest: ${t.data.error}`)}catch(c){console.error("Error accepting quest:",c),b("Error accepting quest. Check console.")}})(e.title);return(0,$t.jsx)(Wt,{quest:{symbol:e.symbol,title:e.title,textbody:e.textbody,goals:[{action:e.goal1action,item:e.goal1item,qty:e.goal1qty},{action:e.goal2action,item:e.goal2item,qty:e.goal2qty},{action:e.goal3action,item:e.goal3item,qty:e.goal3qty}],reward:e.reward,rewardqty:e.rewardqty},state:t,onClick:n},e.title)}))]}),"heal"===n.action&&h.length>0&&(0,$t.jsxs)("div",{className:"heal-options",children:[(0,$t.jsx)("h2",{children:"\u2764\ufe0f\u200d\ud83e\ude79 Healing"}),((e,t)=>{const n=En.getGridState(null===s||void 0===s||null===(e=s.location)||void 0===e?void 0:e.g),r=null===n||void 0===n||null===(t=n.pcs)||void 0===t?void 0:t[s._id];return r?(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsxs)("h4",{children:["Current HP: ",r.hp]}),(0,$t.jsxs)("h4",{children:["Max HP: ",r.maxhp]})]}):(0,$t.jsx)("h4",{children:"HP Data Unavailable"})})(),(0,$t.jsx)("h3",{children:"This NPC can heal you:"}),h.map((e=>{const t=Dt(e,g),o=qt(e,r,1),l=e.qtycollected;return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:`Costs: ${t.join(", ")||"None"}<br>Heals: \u2764\ufe0f\u200d\ud83e\ude79 +${l}`,disabled:!o,onClick:()=>(async e=>{var t,o;if(x(""),console.log("made it to handleHeal"),!e)return void x("Invalid healing recipe selected.");if(!qt(e,r,1))return void x("Not enough resources to heal.");const l=En.getGridState(null===s||void 0===s||null===(t=s.location)||void 0===t?void 0:t.g),c=null===l||void 0===l||null===(o=l.pcs)||void 0===o?void 0:o[s._id];if(!c)return void console.error(`Player ${s.username} not found in gridState.`);const d=c.hp,p=c.maxhp;if("hp"===n.output&&d>=p)return void u(401);const f=[...r];if(!Nt(e,f))return;const h=n.qtycollected,y="hp",g=Math.min(h,p-d);console.log("About to mofidy stats;  amountToMod = ",g,"; statToMod = ",y);try{console.log("calling modifyPlayerStats with: statToMod: ",y,"; amountToMod: ",g,"; currentPlayer._id= ",s._id,"; currentPlayer.gridId: ",s.gridId),await Jt(y,g,s._id,s.location.g),i((e=>({...e,hp:Math.min(e.maxhp,e.hp+g)}))),Mt.addFloatingText(`+${g} HP`,-100,115)}catch(m){console.error("Error applying healing:",m)}a(f),localStorage.setItem("inventory",JSON.stringify(f));try{await St.post("http://localhost:3001/api/update-inventory",{playerId:s.playerId,inventory:f}),await It(s.playerId,i)}catch(m){console.error("Error updating server after healing:",m)}})(e)},e.type)})),w&&(0,$t.jsx)("p",{className:"error-message",children:w})]})]})},Xt=o.memo(Yt),Zt={tiles:[],resources:[],setTiles(e){this.tiles=e,console.log("Global tiles updated:",this.tiles)},setResources(e){this.resources=e,console.log("Global resources updated:",this.resources)},getTiles(){return this.tiles},getResources(){return this.resources}};async function en(e,t,n,r,o){var a;if(null===e||void 0===e||null===(a=e.activeQuests)||void 0===a||!a.length)return;let l=!1;const s=e.activeQuests.map((e=>{if(e.completed||e.rewardCollected)return e;const o={...e.progress};let a=0,s=0;for(let l=1;l<=3;l++){const i=e[`goal${l}action`],c=e[`goal${l}item`],u=e[`goal${l}qty`];i&&c&&u&&(s++,i===t&&c===n&&(o[`goal${l}`]=Math.min((o[`goal${l}`]||0)+r,u)),o[`goal${l}`]>=u&&a++)}return a===s&&s>0&&(e.completed=!0),e.progress=o,l=!0,e}));if(l)try{o((await St.post("http://localhost:3001/api/update-player-quests",{playerId:e.playerId,activeQuests:s})).data.player)}catch(i){console.error("Error updating quest progress:",i)}}function tn(e,t,n){const r=e.position,o=function(e){if(!e||void 0===e.x||void 0===e.y)return console.error("Invalid location object",e),null;return{x:e.x,y:e.y}}(t.position);if(console.log("Fetched positions: playerPos =",r,"; targetPos =",o),!o)return console.error("Invalid target position",{targetPos:o}),Mt.addFloatingText(505,0,0),!1;const a=on(r,o),l=e.attackrange||1;return console.log("playerRange = ",l),console.log("playerPos = ",r),!(a>l)||(Mt.addFloatingText(501,o.x*n,o.y*n),console.log("target out of range: targetPos.x = ",o.x," targetPos.y= ",o.y),!1)}function nn(e,t,n){const r=Math.floor(20*Math.random())+1,o=r+(e.attackbonus||0);return console.log(`Attack roll: ${r}, Attack bonus: ${e.attackbonus}`),console.log(`Total hit roll: ${o}, Target armor class: ${t.armorclass}`),o>=t.armorclass?(Mt.addFloatingText(502,t.position.x*n,t.position.y*n),!0):(Mt.addFloatingText(503,t.position.x*n,t.position.y*n),!1)}function rn(e){const t=Math.floor(6*Math.random())+1,n=(e.damage||0)+t;return console.log(`Damage roll: ${t}, player damage: ${e.damage}, Damage dealt: ${n}`),n}function on(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}async function an(e,t,n,r,o,a,l,s){if(e)switch(console.log("handleNPCClick: npc =",e),e.action){case"quest":case"heal":break;case"graze":{if(console.log(`Handling grazing logic for NPC ${e.id}.`),"town"===a.location.gtype){var i;console.log(`\ud83c\udfe0 Moving NPC ${e.id} from town to home grid ${a.gridId} at (1,7).`);const t=En.getGridState(a.location.g);null!==t&&void 0!==t&&null!==(i=t.npcs)&&void 0!==i&&i[e.id]&&(delete t.npcs[e.id],En.saveGridState(a.location.g),console.log(`\u2705 NPC ${e.id} removed from town grid.`));return En.getGridState(a.gridId).npcs[e.id]={...e,position:{x:1,y:7},state:"idle"},En.saveGridState(a.gridId),console.log(`\u2705 NPC ${e.id} successfully placed in home grid.`),{type:"success",message:"NPC moved to your homestead."}}if("processing"!==e.state)return console.log(`NPC clicked but not in processing state: ${e.state}`),{type:"info",message:"NPC is not ready for collection."};const o=e.qtycollected||1;console.log("Base quantity to collect:",o);const s=o*1;if(!jt(a,a.inventory,a.backpack,e.output,s))return console.warn("Not enough inventory space to collect resource."),Mt.addFloatingText(20,n*l,t*l),{type:"error",message:"Not enough inventory space."};const u=[...a.inventory],d=u.findIndex((t=>t.type===e.output));d>=0?u[d].quantity+=s:u.push({type:e.output,quantity:s}),r(u),localStorage.setItem("inventory",JSON.stringify(u)),Mt.addFloatingText(`+${s} ${e.output}`,n*l,t*l);try{return await St.post("http://localhost:3001/api/update-inventory",{playerId:a.playerId,inventory:u}),e.state="emptystall",e.hp=0,console.log(`NPC ${e.id} collected and transitioned to roam.`),{type:"success",message:`Collected ${s} ${e.output}.`}}catch(c){return console.error("Error updating inventory or grid state on server:",c),{type:"error",message:"Failed to update inventory or stall."}}break}case"attack":case"spawn":!async function(e,t,n,r,o){console.log(`Handling attack on NPC ${e.id}.`);const a=t.location.g,l=t._id.toString();console.log("playerId = ",l);const s=En.getGridState(a);if(console.log("gridState = ",s),!s)return void console.error(`GridState is not available for gridId: ${a}`);const i=null===s||void 0===s?void 0:s.pcs[l];if(console.log("player = ",i),!i)return console.error(`Player not found in gridState for playerId: ${l}.`),void console.log("Current gridState.pcs keys:",Object.keys(s.pcs));if(i.iscamping)return void Mt.addFloatingText(31,e.position.x*n,e.position.y*n+25);if(!tn(i,e,n))return;if(!nn(i,e,n))return;const u=rn(i);if(Mt.addFloatingText(`- ${u} \u2764\ufe0f\u200d\ud83e\ude79 HP`,e.position.x*n,e.position.y*n+25),e.hp-=u,await En.saveGridState(a),e.hp<=0){console.log(`NPC ${e.id} killed.`),Mt.addFloatingText(504,e.position.x*n,e.position.y*n+50);try{if(En.removeNPC(a,e.id),await En.saveGridState(a),console.log(`NPC ${e.id} successfully removed from grid.`),e.output){console.log(`Spawning resource: ${e.output} at NPC's death position.`);const t=o.find((t=>t.type===e.output)),n={...t,type:e.output,x:Math.floor(e.position.x),y:Math.floor(e.position.y),category:t.category||"doober",symbol:t.symbol||"\u2753",qtycollected:t.qtycollected||1},l=[...Zt.getResources(),n];Zt.setResources(l),r((e=>[...e,n])),await In(a,{newResource:e.output,x:Math.floor(e.position.x),y:Math.floor(e.position.y)})}else console.warn(`NPC ${e.id} has no output resource defined.`)}catch(c){console.error("Error removing NPC or spawning resource:",c)}await en(t,"Kill",e.type,1,t)}}(e,a,l,o,s);break;default:console.log(`Unhandled NPC action: ${e.action}`)}else console.warn("handleNPCClick was called with an undefined NPC.")}async function ln(e){var t;const n=Zt.getTiles(),r=Zt.getResources(),o=Object.values((null===(t=En.getGridState(e))||void 0===t?void 0:t.npcs)||{});if(e=e||this.gridId,n&&r)switch(this.state){case"idle":await this.handleIdleState(n,r,o,5,(()=>{this.hp>=this.maxhp?(this.state="stall",En.saveGridState(e)):(this.state="hungry",En.saveGridState(e))}));break;case"hungry":if(!this.targetGrassTile){const e=await this.findTileInRange("g",n,r);if(!Array.isArray(e)||0===e.length){console.warn(`No grass tiles found for NPC ${this.id}. Transitioning to idle.`),this.state="idle";break}const t=e.filter((e=>!r.some((t=>t.x===e.x&&t.y===e.y))));if(0===t.length){console.warn(`No unoccupied grass tiles found for NPC ${this.id}. Transitioning to idle.`),this.state="idle";break}t.sort(((e,t)=>on(this.position,e)-on(this.position,t))),this.targetGrassTile=t[0]}if(this.targetGrassTile){const t=this.targetGrassTile.x-Math.floor(this.position.x),a=this.targetGrassTile.y-Math.floor(this.position.y);let l=null;if(0===t&&0===a){this.state="grazing",this.targetGrassTile=null,await En.saveGridState(e);break}if(t>0&&a>0?l="SE":t>0&&a<0?l="NE":t<0&&a>0?l="SW":t<0&&a<0?l="NW":t>0?l="E":t<0?l="W":a>0?l="S":a<0&&(l="N"),console.log(`NPC ${this.id} determined direction: ${l}`),!l){console.warn(`NPC ${this.id} could not determine direction to grass tile.`),this.state="idle",this.targetGrassTile=null;break}this.isMoving||(this.isMoving=!0,await this.moveOneTile(l,n,r,o),this.position.x=Math.floor(this.position.x),this.position.y=Math.floor(this.position.y),this.isMoving=!1),Math.floor(this.position.x)===this.targetGrassTile.x&&Math.floor(this.position.y)===this.targetGrassTile.y&&(this.state="grazing",this.targetGrassTile=null)}break;case"grazing":{const t=Date.now();if(console.log("in state = grazing; checking grazeEnd: ",this.grazeEnd),this.grazeEnd||(this.grazeEnd=t+1e3*this.growTime,console.log("in state = grazing; setting grazeEnd: ",this.grazeEnd),await En.saveGridState(e)),t>=this.grazeEnd){var a;console.log(`\ud83d\udc04 NPC ${this.id} finished grazing. Moving to stall.`),this.state="stall",delete this.grazeEnd;const t=En.getGridState(e);null!==t&&void 0!==t&&null!==(a=t.npcs)&&void 0!==a&&a[this.id]&&delete t.npcs[this.id].grazeEnd,await En.saveGridState(e)}break}case"stall":{if(!this.targetStall&&(this.targetStall=this.findNearestResource("stall",n,r),!this.targetStall)){console.log("No availalbe stall, returning to idle."),this.state="idle";break}const t=r.find((e=>e.x===this.targetStall.x&&e.y===this.targetStall.y));if(!t){console.warn(`Target stall at (${this.targetStall.x}, ${this.targetStall.y}) is no longer valid. Transitioning to idle.`),this.state="idle",this.targetStall=null;break}const a=this.targetStall.x-Math.floor(this.position.x),l=this.targetStall.y-Math.floor(this.position.y);let s=null;if(Math.abs(a)>Math.abs(l)?s=a>0?"E":"W":0!==l&&(s=l>0?"S":"N"),Math.abs(a)===Math.abs(l)&&(a>0&&l>0?s="SE":a>0&&l<0?s="NE":a<0&&l>0?s="SW":a<0&&l<0&&(s="NW")),!s&&Math.floor(this.position.x)!=this.targetStall.x&&Math.floor(this.position.y)!=this.targetStall.y){console.warn(`NPC ${this.id} could not determine direction to stall.`),this.state="idle",this.targetStall=null;break}if(!this.isMoving){this.isMoving=!0;const e=await this.moveOneTile(s,n,r,o);if(this.position.x=Math.floor(this.position.x),this.position.y=Math.floor(this.position.y),this.isMoving=!1,!e){console.warn(`NPC ${this.id} is stuck and cannot move toward the stall. Switching to idle.`),this.targetStall=null,this.state="idle";break}}Math.floor(this.position.x)===this.targetStall.x&&Math.floor(this.position.y)===this.targetStall.y&&(this.state="processing",await En.saveGridState(e));break}case"processing":break;case"emptystall":this.targetStall=null,this.state="roam",await En.saveGridState(e);break;case"roam":await this.handleRoamState(n,r,o,(()=>{console.log(`NPC ${this.id} transitioning back to hungry.`),this.hp<this.maxhp?this.state="hungry":this.state="idle"}));break;default:console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`)}else console.error(`Tiles or resources are missing for NPC ${this.id}.`)}async function sn(e){var t;const n=Zt.getTiles(),r=Zt.getResources(),o=Object.values((null===(t=En.getGridState(e))||void 0===t?void 0:t.npcs)||{});if(e=e||this.gridId,n&&r)switch(this.state){case"idle":var a;if(Object.values((null===(a=En.getGridState(e))||void 0===a?void 0:a.pcs)||{}).some((e=>on(e.position,this.position)<=this.range&&e.hp>0)))break;await this.handleIdleState(n,r,o,5,(()=>{this.state="roam",En.saveGridState(e)}));break;case"roam":var l;if(Object.values((null===(l=En.getGridState(e))||void 0===l?void 0:l.pcs)||{}).some((e=>on(e.position,this.position)<=this.range))){this.state="idle";break}await this.handleRoamState(n,r,o,(()=>{this.state="idle"}));break;default:console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`)}else console.error(`Tiles or resources are missing for NPC ${this.id}.`)}async function cn(e,t){var n,r;const o=Zt.getTiles(),a=Zt.getResources(),l=(Object.values((null===(n=En.getGridState(e))||void 0===n?void 0:n.npcs)||{}),Object.values((null===(r=En.getGridState(e))||void 0===r?void 0:r.pcs)||{}));switch(this.state||(this.state="idle"),this.state){case"idle":await this.handleIdleState(o,a,l,5,(()=>{const t=function(e,t){let n=null,r=1/0;return t.forEach((t=>{if(t.hp<=0)return;const o=un(e,t.position);o<r&&(r=o,n=t)})),n}(this.position,l);t&&un(this.position,t.position)<=this.range?(this.targetPC=t,this.state="pursue",En.saveGridState(e)):(this.state="roam",En.saveGridState(e))}));break;case"pursue":if(!this.targetPC){this.state="idle",En.saveGridState(e);break}await this.handlePursueState(this.targetPC.position,o,a,l,(()=>{this.state="attack"}));break;case"attack":if(!this.targetPC){this.state="idle",En.saveGridState(e);break}if(this.targetPC.hp<=0||this.targetPC.iscamping){this.state="idle";break}if(un(this.position,this.targetPC.position)>this.attackrange){this.state="pursue",En.saveGridState(e);break}if(Math.floor(20*Math.random())+1+this.attackbonus>=this.targetPC.armorclass){const n=Math.floor(6*Math.random())+1+this.damage,r="hp",o=-n;try{var s;await Jt(r,o,this.targetPC.playerId,e),Mt.addFloatingText(`- ${n} \u2764\ufe0f\u200d\ud83e\ude79 HP`,this.targetPC.position.x*t,this.targetPC.position.y*t),En.saveGridState(e);const a=Object.values((null===(s=En.getGridState(e))||void 0===s?void 0:s.pcs)||{});this.targetPC=a.find((e=>e.playerId===this.targetPC.playerId))}catch(i){console.error(`Error applying damage to player ${this.targetPC.username}:`,i)}}else Mt.addFloatingText("503",this.targetPC.position.x*t,this.targetPC.position.y*t),setTimeout((()=>{this.state="attack"}),this.speed);break;case"roam":await this.handleRoamState(o,a,l,(()=>{this.state="idle",En.saveGridState(e)}));break;default:console.warn(`Unhandled state: ${this.state}`)}}function un(e,t){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}async function dn(e){var t;const n=Zt.getTiles(),r=Zt.getResources(),o=Object.values((null===(t=En.getGridState(e))||void 0===t?void 0:t.npcs)||{});if(e=e||this.gridId,n&&r)switch(this.state){case"idle":var a;if(Object.values((null===(a=En.getGridState(e))||void 0===a?void 0:a.pcs)||{}).some((e=>on(e.position,this.position)<=this.range)))break;await this.handleIdleState(n,r,o,5,(()=>{this.state="roam",En.saveGridState(e)}));break;case"roam":var l;if(Object.values((null===(l=En.getGridState(e))||void 0===l?void 0:l.pcs)||{}).some((e=>on(e.position,this.position)<=this.range))){this.state="idle";break}await this.handleRoamState(n,r,o,(()=>{this.state="idle"}));break;default:console.warn(`NPC ${this.id} is in an unhandled state: ${this.state}`)}else console.error(`Tiles or resources are missing for NPC ${this.id}.`)}async function pn(e){const t=En.getGridState(e);if(!t)return void console.warn(`GridState unavailable for gridId ${e}.`);const n=Object.values(t.npcs),r=Object.values(t.pcs),o=this.position.x,a=this.position.y;switch(this.state){case"idle":r.some((e=>on(e.position,this.position)<this.range))&&(console.log(`[Spawner] ${this.type} detected PCs nearby. Transitioning to spawn state.`),this.state="spawn",await En.saveGridState(e));break;case"spawn":if(n.filter((e=>e.type===this.output)).length>=this.qtycollected)return console.log(`[Spawner] Max ${this.output} reached (${this.qtycollected}). Returning to idle.`),this.state="idle",void await En.saveGridState(e);if(!this.nextspawn||Date.now()>=this.nextspawn){console.log(`[Spawner] Spawning new ${this.output} at (${this.position.x}, ${this.position.y}).`);const t={x:this.position.x,y:this.position.y};await En.spawnNPC(e,{type:this.output},t),this.nextspawn=Date.now()+1e3*this.speed,await En.saveGridState(e)}else console.log("[Spawner] Waiting for next spawn cycle.");r.some((e=>on(e.position,this.position)<this.range))||(console.log("[Spawner] No PCs nearby. Returning to idle."),this.state="idle",await En.saveGridState(e));break;default:console.warn(`Unhandled state for NPC ${this.id}: ${this.state}`)}this.position.x===o&&this.position.y===a||console.error(`[Spawner] ERROR: Spawner ${this.id} moved from (${o}, ${a}) to (${this.position.x}, ${this.position.y})!`)}class fn{constructor(e,t,n,r,o){var a;if(console.log("NPC constructor: properties:",r),!r||"object"!==typeof r)throw console.error(`Invalid properties passed to NPC constructor for type ${t}:`,r),new Error("NPC constructor requires valid properties.");this.gridId=o,this.updateInterval=r.updateInterval||1e3,this.id=e,this.type=t,this.position={x:Math.floor(n.x),y:Math.floor(n.y)},this.symbol=r.symbol,this.hp=r.hp||0,this.output=r.output,this.maxhp=r.hp||0,this.range=r.range,this.action=r.action,this.state="idle",this.speed=r.speed,this.growTime=r.growtime||0,this.lastMoveTime=0,this.processingStartTime=void 0,this.nextspawn=null!==(a=r.nextspawn)&&void 0!==a?a:"spawn"===this.action?Date.now()+5e3:null,Object.assign(this,r)}update(e,t,n,r){e-this.lastUpdateTime<this.updateInterval||(this.processState(t,n,r),this.lastUpdateTime=e)}async processState(e,t,n){var r;Object.values((null===(r=En.getGridState(t))||void 0===r?void 0:r.npcs)||{});try{switch(this.action){case"graze":await this.handleFarmAnimalBehavior(t);break;case"pester":break;case"quest":await this.handleQuestGiverBehavior(t);break;case"attack":await this.handleEnemyBehavior(t,n);break;case"heal":await this.handleHealBehavior(t);break;case"spawn":await this.handleSpawnBehavior(t);break;case"steal":console.log("Steal behavior not implemented yet.");break;case"work":console.log("Work behavior not implemented yet.");break;default:console.warn(`Unhandled NPC action: ${this.action}`)}}catch(o){console.error(`Error in NPC ${this.id} processState:`,o)}}async handleIdleState(e,t,n,r,o){if(this.idleTimer||(this.idleTimer=0),this.idleTimer++,this.idleTimer>=r){this.idleTimer=0;const r=["N","S","E","W","NE","SE","SW","NW"].filter((r=>{const{x:o,y:a}=this.getAdjacentTile(r);return this.isValidTile(o,a,e,t,n)}));if(r.length>0){const o=r[Math.floor(Math.random()*r.length)];await this.moveOneTile(o,e,t,n)||console.warn(`NPC ${this.id} failed to move. Transitioning anyway.`)}else console.warn(`NPC ${this.id} has no valid tiles to move. Staying in current position.`);o()}}async handleRoamState(e,t,n,r){this.roamSteps=this.roamSteps||0;const o=this.range||4;if(!this.currentDirection){const e=["N","S","E","W","NE","SE","SW","NW"];this.currentDirection=e[Math.floor(Math.random()*e.length)]}const a=({N:["N","NE","NW"],S:["S","SE","SW"],E:["E","NE","SE"],W:["W","NW","SW"],NE:["NE","N","E"],SE:["SE","S","E"],SW:["SW","S","W"],NW:["NW","N","W"]}[this.currentDirection]||[this.currentDirection]).filter((r=>{const{x:o,y:a}=this.getAdjacentTile(r);return this.isValidTile(o,a,e,t,n)}));if(0===a.length)return console.warn(`NPC ${this.id} cannot find a valid tile to move in the current direction.`),void(this.currentDirection=null);const l=a[Math.floor(Math.random()*a.length)];await this.moveOneTile(l,e,t,n),this.roamSteps++,this.roamSteps>=o&&(this.roamSteps=0,this.currentDirection=null,r())}async handlePursueState(e,t,n,r,o){const a=e.x-this.position.x,l=e.y-this.position.y;let s=null;if(Math.abs(a)>Math.abs(l)?s=a>0?"E":"W":0!==l&&(s=l>0?"S":"N"),Math.abs(a)===Math.abs(l)&&(a>0&&l>0?s="SE":a>0&&l<0?s="NE":a<0&&l>0?s="SW":a<0&&l<0&&(s="NW")),!s)return void console.warn(`NPC ${this.id} could not determine a valid direction to pursue.`);await this.moveOneTile(s,t,n,r);on(this.position,e)<=this.attackrange&&(this.state="attack",o())}async moveOneTile(e,t,n,r){if("spawn"===this.action)return console.warn(`Spawner ${this.id} cannot move!`),!1;const o={N:{x:0,y:-1},S:{x:0,y:1},E:{x:1,y:0},W:{x:-1,y:0},NE:{x:1,y:-1},SE:{x:1,y:1},SW:{x:-1,y:1},NW:{x:-1,y:-1}}[e];if(!o)return console.error(`Invalid direction: ${e}`),!1;const a=Math.floor(this.position.x+o.x),l=Math.floor(this.position.y+o.y);if(!this.isValidTile(a,l,t,n,r))return console.warn(`NPC ${this.id} cannot move to invalid tile (${a}, ${l}).`),!1;const s=this.speed,i=performance.now(),c=this.position.x,u=this.position.y;return new Promise((e=>{const t=()=>{const n=performance.now()-i;if(n>=s)return this.position.x=a,this.position.y=l,void e(!0);const r=n/s;this.position.x=c+r*(a-c),this.position.y=u+r*(l-u),requestAnimationFrame(t)};requestAnimationFrame(t)}))}getAdjacentTile(e){const t={N:{x:0,y:-1},S:{x:0,y:1},E:{x:1,y:0},W:{x:-1,y:0},NE:{x:1,y:-1},SE:{x:1,y:1},SW:{x:-1,y:1},NW:{x:-1,y:-1}}[e];return t?{x:this.position.x+t.x,y:this.position.y+t.y}:(console.error(`Invalid direction: ${e}`),{x:this.position.x,y:this.position.y})}isValidTile(e,t,n,r,o){if(e=Math.floor(e),t=Math.floor(t),!n||!Array.isArray(n))return console.error("isValidTile; Tiles data is invalid."),!1;if(!r||!Array.isArray(r))return console.error("isValidTile; Resources data is invalid or missing."),!1;if(e<0||t<0||t>=n.length||e>=n[0].length)return!1;const a=n[t][e];if(!("g"===a&&this.validong||"p"===a&&this.validonp||"w"===a&&this.validonw||"d"===a&&this.validond||"l"===a&&this.validonl||"s"===a&&this.validons))return!1;const l=r.find((n=>n.x===e&&n.y===t));if(l&&!l.passable)return!1;if(!Array.isArray(o))return console.warn("NPC list is invalid or undefined. Skipping NPC collision check."),!0;return!o.some((n=>Math.floor(n.position.x)===e&&Math.floor(n.position.y)===t))||(console.warn(`Tile (${e}, ${t}) is already occupied by another NPC.`),!1)}async findTileInRange(e,t,n){const r=Math.floor(this.range||3),o=Math.floor(this.position.x),a=Math.floor(this.position.y);if(!t||0===t.length||!Array.isArray(t))return console.error("Tiles array is invalid or empty."),[];const l=[];for(let i=-r;i<=r;i++)for(let n=-r;n<=r;n++){var s;const r=o+i,c=a+n;r<0||c<0||c>=t.length||r>=(null===(s=t[c])||void 0===s?void 0:s.length)||t[c][r]===e&&l.push({x:r,y:c})}return console.log(`Found ${l.length} potential tiles for type "${e}".`),l}findNearestResource(e,t,n){if(!n||!Array.isArray(n)||0===n.length)return console.error(`Resources are invalid or empty for NPC ${this.id}.`),null;const r={x:Math.floor(this.position.x),y:Math.floor(this.position.y)},o=n.filter((t=>t.category===e&&"number"===typeof t.x&&"number"===typeof t.y));if(0===o.length)return console.warn(`No available ${e} found for NPC ${this.id}.`),null;o.sort(((e,t)=>{const n={x:Math.floor(e.x),y:Math.floor(e.y)},o={x:Math.floor(t.x),y:Math.floor(t.y)};return on(r,n)-on(r,o)}));return o[0]}}!function(e){e.prototype.handleFarmAnimalBehavior=ln}(fn),function(e){e.prototype.handleQuestGiverBehavior=sn}(fn),function(e){e.prototype.handleEnemyBehavior=cn}(fn),function(e){e.prototype.handleHealBehavior=dn}(fn),function(e){e.prototype.handleSpawnBehavior=pn}(fn);const hn=fn;let yn=null;const gn=new class{constructor(){this.gridStates={},console.log("GridStateManager instance created.")}async initializeGridState(e){if(console.log("Fetching gridState for gridId:",e),e)try{const t=await St.get(`http://localhost:3001/api/load-grid-state/${e}`),{gridState:n={}}=t.data;console.log("Fetched gridState:",n);const r=await Kt();n.npcs&&Object.keys(n.npcs).forEach((e=>{const t=n.npcs[e];console.log("lightweightNPC:",t),console.log("masterResources:",r);const o=r.find((e=>e.type===t.type));o?(n.npcs[e]=new hn(e,t.type,t.position,{...o,...t}),console.log(`Rehydrated NPC with ID: ${e}`,n.npcs[e])):console.warn(`No template found for NPC type: ${t.type}`)})),n.pcs=n.pcs||{},console.log("Existing PCs from DB:",n.pcs),Object.keys(n.pcs).forEach((e=>{const t=n.pcs[e];n.pcs[e]={...t,position:t.position||{x:0,y:0}},console.log(`Rehydrated PC with ID: ${e}`,n.pcs[e])}));const o=JSON.parse(localStorage.getItem("player"));o&&!n.pcs[o._id]?(console.log(`Adding currentPlayer ${o.username} to gridState for gridId ${e}`),n.pcs[o._id]={playerId:o._id,type:"pc",username:o.username,position:{x:o.location.x||2,y:o.location.y||2},icon:o.icon||"\ud83d\ude00",hp:o.hp||1,maxhp:o.maxhp||1,attackbonus:o.attackbonus||1,armorclass:o.armorclass||1,damage:o.damage||1,attackrange:o.attackrange||1,speed:o.speed||1,iscamping:o.iscamping||!1},await this.saveGridState(e)):console.log(`Player ${null===o||void 0===o?void 0:o.username} already exists in gridState.`),this.gridStates[e]=n,console.log(`Initialized and enriched gridState for gridId ${e}:`,n)}catch(t){console.error("Error fetching gridState:",t)}else console.error("initializeGridState: gridId is undefined.")}getGridState(e){return e?(this.gridStates[e]||(this.gridStates[e]={npcs:{},pcs:{}}),this.gridStates[e]):null}async spawnNPC(e,t,n){var r;if(console.log("spawnNPC called with:",{gridId:e,npcType:t,position:n}),"object"===typeof t&&null!==(r=t)&&void 0!==r&&r.type&&(t=t.type),"string"!==typeof t)return void console.error("Invalid npcType. Expected a string but got:",t);const o=(await St.get("http://localhost:3001/api/resources")).data.find((e=>e.type===t&&"npc"===e.category));if(!o)return void console.error(`NPC template not found for type: ${t}`);const a=`${Date.now()}`;let l;l="graze"===o.action?{id:a,type:t,action:o.action,state:"idle",position:n,hp:0,maxhp:o.maxhp,lastMoveTime:0}:"spawn"===o.action?{id:a,type:t,action:o.action,state:"idle",position:n,hp:o.maxhp,maxhp:o.maxhp,lastMoveTime:0,nextspawn:Date.now()+1e3*o.speed}:{id:a,type:t,action:o.action,state:"idle",position:n,hp:o.maxhp,maxhp:o.maxhp,lastMoveTime:0},console.log("Creating lightweightNPC:",l);const s=new hn(a,t,n,{...o,...l},e);this.addNPC(e,s),console.log(`Successfully added NPC to gridState. NPC ID: ${a}`)}async addNPC(e,t){console.log(`Adding NPC to gridState for gridId: ${e}. NPC:`,t);const n=this.getGridState(e);if(!n)return void console.error(`Cannot add NPC. No gridState found for gridId: ${e}`);n.npcs||(n.npcs={});const r=await Kt();if(!Array.isArray(r))return void console.error("masterResources is not an array:",r);const o=r.find((e=>e.type===t.type&&"npc"===e.category));o?n.npcs[t.id]=new hn(t.id,t.type,t.position,{...t,...o},e):(console.warn(`No template found for NPC type: ${t.type}. Adding as plain object.`),n.npcs[t.id]=t),console.log(`NPC added to gridState for gridId ${e}. Current NPCs:`,n.npcs),this.saveGridState(e)}updateNPC(e,t,n){var r;const o=this.getGridState(e);o&&null!==(r=o.npcs)&&void 0!==r&&r[t]?(Object.assign(o.npcs[t],n),console.log(`NPC ${t} updated in gridState for gridId ${e}:`,o.npcs[t]),this.saveGridState(e)):console.error(`Cannot update NPC ${t}. No gridState or NPC found for gridId: ${e}`)}removeNPC(e,t){const n=this.getGridState(e);n&&n.npcs?(delete n.npcs[t],console.log(`NPC ${t} removed from gridState for gridId ${e}.`),this.saveGridState(e)):console.error(`Cannot remove NPC. No gridState or NPCs found for gridId: ${e}`)}addPC(e,t){const n=this.getGridState(e);console.log("Top of AddPC; gridState = ",n),n?(n.pcs||(n.pcs={}),n.npcs||(n.npcs={}),n.pcs[t.playerId]=t,console.log(`PC added to gridState for gridId ${e}. Current PCs:`,n.pcs),console.log("Ensuring NPCs are preserved:",n.npcs),this.saveGridState(e)):console.error(`Cannot add PC. No gridState found for gridId: ${e}`)}updatePC(e,t,n){var r;const o=this.getGridState(e);o&&null!==(r=o.pcs)&&void 0!==r&&r[t]?(Object.assign(o.pcs[t],n),console.log(`PC ${t} updated in gridState for gridId ${e}:`,o.pcs[t]),this.saveGridState(e)):console.error(`Cannot update PC ${t}. No gridState or PC found for gridId: ${e}`)}async saveGridState(e){const t=this.getGridState(e);if(t)try{await St.post("http://localhost:3001/api/save-grid-state",{gridId:e,gridState:{npcs:Object.keys(t.npcs||{}).reduce(((e,n)=>{const r=t.npcs[n];return e[n]={id:r.id,type:r.type,position:r.position,state:r.state,hp:r.hp,maxhp:r.maxhp,grazeEnd:r.grazeEnd,nextspawn:r.nextspawn},e}),{}),pcs:t.pcs&&Object.keys(t.pcs).length>0?Object.keys(t.pcs).reduce(((e,n)=>{const r=t.pcs[n];return e[n]={...r,type:r.type||"pc"},e}),{}):t.pcs}})}catch(n){console.error("Error saving gridState:",n)}else console.error(`Cannot save gridState. No gridState found for gridId: ${e}`)}startGridTimer(e){yn&&clearInterval(yn),yn=setInterval((()=>{const t=this.getGridState(e);if(!t)return;const{npcs:n}=t,r=Date.now();Object.values(n||{}).forEach((e=>{e instanceof hn&&"function"===typeof e.update?e.update(r,t):console.error(`NPC ID: ${e.id} is not a valid NPC instance or missing update method. NPC:`,e)})),console.log(`Processed NPC updates for gridId ${e}.`)}),1e3)}stopGridTimer(){yn&&clearInterval(yn),yn=null}stopGridStateUpdates(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.gridStates={}}},{initializeGridState:mn,getGridState:vn,addNPC:bn,updateNPC:wn,addPC:xn,updatePC:Sn,removeNPC:kn,saveGridState:Cn}=gn,En=gn;async function In(e,t,n){try{var r;console.log("payload in updateGridRes:",t);const o=Date.now(),a=await St.patch(`http://localhost:3001/api/update-grid/${e}`,t);if(console.log("\u2705 update-grid API response:",a.data),console.log(`update-grid completed in ${Date.now()-o}ms`),null!==a&&void 0!==a&&null!==(r=a.data)&&void 0!==r&&r.success&&n){const{newResource:e,x:r,y:o,growEnd:a,craftEnd:l,craftedItem:s}=t;n((t=>t.map((t=>t.x===r&&t.y===o?{...t,type:e||t.type,growEnd:null!==a&&void 0!==a?a:t.growEnd,craftEnd:void 0!==l?l:t.craftEnd,craftedItem:void 0!==s?s:t.craftedItem}:t))))}return a.data}catch(s){var o,a,l;return console.error("Error updating grid resource:",s),500===(null===(o=s.response)||void 0===o?void 0:o.status)&&null!==(a=s.response.data)&&void 0!==a&&null!==(l=a.message)&&void 0!==l&&l.includes("VersionError")?(console.warn("Retrying update due to version conflict..."),await In(e,t,n)):null}}const Nn=async(e,t,n,r,o,a,l,s,i,c,u)=>{try{var d,p;if(!e)throw new Error("Player data is missing or invalid.");if(!t||!n)throw new Error("Both 'from' and 'to' locations are required.");console.log("\ud83d\udea8 ENTERING changePlayerLocation()"),console.log(`\ud83d\udd0d BEFORE FETCH: Player ${e.username} moving from ${t.g} to ${n.g}`),console.log("\ud83d\udd0d Checking player local state before fetch:",JSON.stringify(e,null,2)),console.log("\ud83d\udd0d Local gridState BEFORE fetch:",JSON.stringify(En.getGridState(t.g),null,2)),console.log("\ud83d\udd0d Fetching grid states from DB...");const o=await St.get(`http://localhost:3001/api/load-grid-state/${t.g}`),c=await St.get(`http://localhost:3001/api/load-grid-state/${n.g}`);console.log("\ud83d\udea8 AFTER FETCH: Raw fromGridStateResponse:",JSON.stringify(o.data,null,2)),console.log("\ud83d\udea8 AFTER FETCH: Raw toGridStateResponse:",JSON.stringify(c.data,null,2));let f=(null===(d=o.data)||void 0===d?void 0:d.gridState)||{pcs:{}},h=(null===(p=c.data)||void 0===p?void 0:p.gridState)||{pcs:{}};Object.keys(f.pcs).length||console.error(`\ud83d\udea8 ERROR: fromGridState for grid ${t.g} is already empty after fetch!`),console.log("Fetched fromGridState:",f),console.log("Fetched targetGridState:",h);const y=String(e.playerId),g=f.pcs[y];if(console.log("playerInGridState (fromGridState) = ",g),g){console.log(`\u2705 Extracting combat stats for player ${e.username} before transit.`);const t={hp:g.hp,maxhp:g.maxhp,attackbonus:g.attackbonus,armorclass:g.armorclass,damage:g.damage,attackrange:g.attackrange,speed:g.speed,iscamping:g.iscamping};await St.post("http://localhost:3001/api/update-profile",{playerId:e.playerId,updates:t}),console.log("\u2705 Combat stats saved to player document:",t),r((e=>({...e,...t})))}else console.warn(`\u26a0\ufe0f Player ${e.username} not found in gridState before transit.`);if(console.log("\ud83d\udd04 [Before Finalizing] gridState BEFORE saving locally:",JSON.stringify(En.getGridState(n.g),null,2)),g?(g.position={x:n.x||1,y:n.y||1},h.pcs={...h.pcs,[y]:g},console.log(`\u2705 Added player ${e.username} to target gridState with correct stats and position.`),await St.post("http://localhost:3001/api/save-grid-state",{gridId:n.g,gridState:h}),console.log("\u2705 Target gridState updated and saved to DB.")):console.error("\ud83d\udea8 playerInGridState is undefined when adding to target gridState!"),f.pcs[e.playerId]){console.log(`Removing player ${e.username} from "from" gridState.`);const n={...f.pcs};delete n[e.playerId];const r={...f,pcs:n};await St.post("http://localhost:3001/api/save-grid-state",{gridId:t.g,gridState:r}),console.log("\u2705 Player removed and 'from' gridState saved to DB.")}const m={playerId:e.playerId,location:n};console.log("Sending payload to /update-player-location:",m);const v=await St.post("http://localhost:3001/api/update-player-location",m);if(!v.data.success)throw new Error(v.data.error);console.log("Player location updated successfully on the server:",v.data);const b={...e,location:n,...g};r(b),localStorage.setItem("player",JSON.stringify(b)),console.log("\u2705 Updated player location locally with combat stats:",b),console.log("Initializing new grid after player transit..."),a(n.g),await Tn(u,n.g,l,s,i),console.log("\u2705 Player transit completed successfully."),window.location.reload()}catch(f){throw console.error("Error changing player location:",f.message||f),f}};async function jn(e,t){try{console.log(`Fetching grid data for gridId: ${e}`);const n=(await St.get(`http://localhost:3001/api/load-grid/${e}`)).data||{},{gridType:r,_id:o,ownerId:a}=n;console.log("Fetched grid data:",n);let l=null;return"homestead"===r&&a&&(l=a.username||"Unknown"),Pn(r,l,t),n}catch(n){return console.error("Error fetching grid data:",n),t&&t("Failed to load grid data"),{}}}function Pn(e,t,n){if(n)switch(e){case"homestead":n(`Welcome to ${t||"Unknown"}'s homestead.`);break;case"town":n(14);break;case"valley1":case"valley2":case"valley3":n(16);break;case"settlement":n(12);break;case"frontier":n(13)}}const Tn=async(e,t,n,r,o,a)=>{try{if(!t)return void console.error("GridId is missing. Cannot initialize grid.");console.log("Initializing grid for gridId:",t);const e=await jn(t,a),{tiles:l,resources:s}=e;n(l||[]),r(s||[]),o(l||[]),console.log("Grid, tiles, and resources initialized for gridId:",t)}catch(l){console.error("Error initializing grid:",l)}},$n=1e3;let Rn=null;function Mn(e){const t={width:1920,height:1920},n=parseFloat(e.dataset.x||0),r=parseFloat(e.dataset.y||0),{x:o,y:a,distance:l}=function(e,t,n){const r=Math.random()*Math.PI*2,o=100+300*Math.random();return{x:Math.max(0,Math.min(e+Math.cos(r)*o,n.width)),y:Math.max(0,Math.min(t+Math.sin(r)*o,n.height)),distance:o}}(n,r,t),s=l/70*1e3,i=Math.atan2(a-r,o-n)*(180/Math.PI)+90;e.dataset.x=o,e.dataset.y=a,e.style.transform=`translate(${n}px, ${r}px) rotate(${i}deg)`;e.offsetHeight;e.style.transition=`opacity 1000ms, transform ${s}ms linear`,e.style.opacity="1",e.style.transform=`translate(${o}px, ${a}px) rotate(${i}deg)`,setTimeout((()=>{e.style.opacity="0",setTimeout((()=>{e.remove()}),$n)}),s+100)}function Fn(){const e={width:1920,height:1920},t=document.createElement("div");t.className="butterfly",t.textContent="\ud83e\udd8b";const n=Math.random()*e.width,r=Math.random()*e.height;t.dataset.x=n,t.dataset.y=r,t.style.position="absolute",t.style.transform=`translate(${n}px, ${r}px)`,t.style.opacity="0",t.style.transition="opacity 1000ms",document.querySelector(".homestead").appendChild(t),Mn(t)}function _n(){for(let e=0;e<20;e++)setTimeout(Fn,500*e)}function On(){if(!Rn)return;console.log("Ambient VFX stopping..."),clearInterval(Rn),Rn=null;document.querySelectorAll(".butterfly").forEach((e=>e.remove())),console.log("Ambient VFX stopped")}const An=(0,o.memo)((e=>{let{grid:t,tileTypes:n,resources:r,handleTileClick:o,handleTileHover:a,handleTileLeave:l,TILE_SIZE:s}=e;if(!t||!Array.isArray(t)||!n)return console.error("Invalid grid or tileTypes:",t,n),null;if(!s||isNaN(s))return console.error("TILE_SIZE is invalid:",s),null;const i=Date.now(),c=r.reduce(((e,t)=>{if("crafting"===t.category&&t.craftEnd){const n=`${t.x}-${t.y}`;t.craftEnd<i?e.ready.push(n):e.inProgress.push(n)}return e}),{ready:[],inProgress:[]});return t.map(((e,t)=>e.map(((e,i)=>{var u;const d=r.find((e=>e.x===i&&e.y===t)),p=`tile-${(null===(u=n[t])||void 0===u?void 0:u[i])||"unknown"}`,f=`${i}-${t}`,h=c.ready.includes(f),y=c.inProgress.includes(f);return(0,$t.jsxs)("div",{onClick:()=>o(t,i),onMouseEnter:e=>a(t,i,e),onMouseLeave:l,className:p,style:{position:"absolute",top:t*s,left:i*s,width:s,height:s,display:"flex",alignItems:"center",justifyContent:"center",zIndex:1,cursor:d?"pointer":"default"},children:[d&&(0,$t.jsx)("div",{className:"resource-overlay",style:{fontSize:.7*s+"px",zIndex:2,pointerEvents:"none"},children:d.symbol||""}),h&&(0,$t.jsx)("div",{className:"craft-notification",style:{position:"absolute",top:"10%",right:"10%",fontSize:.5*s+"px",color:"green",fontWeight:"bold",zIndex:3,pointerEvents:"none"},children:"\u2705"}),y&&(0,$t.jsx)("div",{className:"craft-notification",style:{position:"absolute",top:"10%",right:"10%",fontSize:.5*s+"px",color:"orange",fontWeight:"bold",zIndex:3,pointerEvents:"none"},children:"\u231b\ufe0f"})]},`${t}-${i}-${(null===d||void 0===d?void 0:d.symbol)||""}`)}))))})),Ln=e=>{let{toggleVFX:t}=e;return(0,o.useEffect)((()=>(t?Rn||(console.log("Ambient VFX starting..."),_n(),Rn=setInterval(_n,5e3),console.log("Ambient VFX started")):On(),()=>{On()})),[t]),null},qn=(0,o.memo)((e=>{let{resource:t,npc:n,pc:r,tooltipPosition:a,isTooltipVisible:l}=e;const[s,i]=(0,o.useState)(null),[c,u]=(0,o.useState)(null);if((0,o.useEffect)((()=>{if(!t)return i(null),void u(null);const e=()=>{if(t.craftEnd){const e=Math.max(0,t.craftEnd-Date.now());i(e)}if(t.growEnd){const e=Math.max(0,t.growEnd-Date.now());u(e)}};e();const n=setInterval(e,1e3);return()=>clearInterval(n)}),[t]),!l||!t&&!n&&!r)return null;const d=[],p=n||r||t;switch(p.category){case"source":case"doober":break;case"farmplot":if(d.push(`${p.type}`),null!==c&&c>0){const e=Math.floor(c%36e5/6e4),t=Math.floor(c%6e4/1e3);d.push(`\ud83c\udf31 ${e}m ${t}s remaining`)}break;case"crafting":if(d.push(`${p.type}`),null!==s&&s>0){const e=Math.floor(s%36e5/6e4),t=Math.floor(s%6e4/1e3);d.push(`\u23f3 ${e}m ${t}s remaining`)}break;default:d.push(`${p.type}`)}return 0===d.length?null:(0,$t.jsx)("div",{className:"tooltip-container",style:{position:"absolute",top:a.y,left:a.x,zIndex:20},children:d.map(((e,t)=>(0,$t.jsx)("p",{children:e},t)))})})),Dn=(0,o.createContext)(),zn=(0,o.createContext)(),Bn=()=>(0,o.useContext)(Dn);function Gn(e){let{children:t}=e;const[n,r]=(0,o.useState)(null);return(0,$t.jsx)(Dn.Provider,{value:n,children:(0,$t.jsx)(zn.Provider,{value:r,children:t})})}function Un(e,t,n,r){e?String(e.playerId)!==String(t._id)&&e.hp>0&&!e.iscamping&&async function(e,t,n,r){const o=t._id.toString(),a=En.getGridState(n),l=null===a||void 0===a?void 0:a.pcs[o];if(!l)return void console.error("Player not found in gridState.");if(!tn(l,e,r))return;if(!nn(l,e,r))return;const s=rn(l);Mt.addFloatingText(`- ${s} HP`,e.position.x*r,e.position.y*r+25),e.hp-=s,e.hp<=0&&(console.log(`PC ${e.playerId} defeated.`),Mt.addFloatingText(504,e.position.x*r,e.position.y*r+50))}(e,t,n,r):console.warn("handlePCClick was called with an undefined PC.")}function Wn(e,t,n,r){let o=`<p>${t.username}</p><p>\u2764\ufe0f\u200d\ud83e\ude79 HP: ${t.hp}</p>`;t.iscamping&&(o+="<p>\ud83c\udfd5\ufe0f Camping</p>"),n.innerHTML=o,n.style.top=e.target.offsetTop-60+"px",n.style.left=e.target.offsetLeft+r/2-n.offsetWidth/2+"px",n.style.display="block"}function Hn(e){e.style.display="none"}function Vn(e,t,n,r){let o=`<p>${t.type}</p>`;switch(console.log("NPC tooltip in RenderDynamic"),t.action){case"graze":switch(t.state){case"processing":o=`<p>${t.type}</p><p>is ready.</p>`;break;case"hungry":o=`<p>${t.type}</p><p>is hungry and</p><p>looking for grass.</p>`;break;case"grazing":{let e="";if(t.grazeEnd){const n=Math.max(0,t.grazeEnd-Date.now());e=`<p>${Math.floor(n%36e5/6e4)}m ${Math.floor(n%6e4/1e3)}s</p>`}o=`<p>${t.type}</p><p>is grazing.</p>${e}`;break}case"idle":o="<p>Zzzz...</p>";break;case"roam":o=`<p>${t.type}</p><p>is roaming.</p>`;break;case"stall":o=`<p>${t.type}</p><p>is looking for an Animal Stall.</p>`;break;default:o=`<p>${t.type}</p>`}break;case"quest":o=`<p>${t.type}</p><p>Quest, anyone?</p>`;break;case"attack":case"spawn":o=`<p>${t.type}</p><p>HP: ${t.hp}/${t.maxhp}</p>`;break;default:o=`<p>${t.type}</p>`}n.innerHTML=o,n.style.top=e.target.offsetTop-60+"px",n.style.left=e.target.offsetLeft+r/2-n.offsetWidth/2+"px",n.style.display="block"}function Qn(e){e.style.display="none"}const Kn=e=>{let{TILE_SIZE:t,setInventory:n,setResources:r,currentPlayer:a,setCurrentPlayer:l,onNPCClick:s,onPCClick:i,masterResources:c}=e;const u=Bn(),d=(0,o.useRef)(c);(0,o.useEffect)((()=>{d.current=c}),[c]);const p=(0,o.useRef)(null),f=(0,o.useRef)(null),h=(0,o.useRef)(null),y=(0,o.useRef)(0),g=(0,o.useRef)(null),m=(0,o.useRef)(new Map),v=(0,o.useRef)(new Map);return(0,o.useEffect)((()=>{console.log("\ud83d\udd04 Re-rendering PCs! Latest gridState:",u);const e=p.current;if(!e)return;const o=document.createElement("div");o.className="tooltip-container",o.style.position="absolute",o.style.zIndex="20",o.style.pointerEvents="none",o.style.display="none",e.appendChild(o),f.current=o;return(()=>{const l=()=>{(()=>{const l=Object.values((null===u||void 0===u?void 0:u.npcs)||{}),i=Date.now();l.forEach((l=>{let c=m.current.get(l.id);c||(c=document.createElement("div"),c.className="npc",c.style.position="absolute",c.style.width=`${t}px`,c.style.height=`${t}px`,c.style.fontSize=.7*t+"px",c.style.display="flex",c.style.alignItems="center",c.style.justifyContent="center",c.style.zIndex=15,e.appendChild(c),m.current.set(l.id,c)),"attack"===l.action||"spawn"===l.action?c.style.cursor=i<y.current?"wait":"crosshair":"quest"===l.action||"heal"===l.action?c.style.cursor="help":c.style.cursor="pointer",c.textContent=l.symbol,c.style.top=l.position.y*t+"px",c.style.left=l.position.x*t+"px",c.hasClickListener||(c.addEventListener("click",(()=>{o.style.display="none";const e=Date.now();if("attack"===l.action||"spawn"===l.action){if(e<y.current)return console.log("Attack on cooldown!"),void(c.style.cursor="wait");y.current=e+1e3*a.speed}"quest"===l.action||"heal"===l.action?s(l):an(l,Math.round(l.position.y),Math.round(l.position.x),n,r,a,t,d.current)})),c.addEventListener("mouseenter",(e=>Vn(e,l,f.current,t))),c.addEventListener("mouseleave",(()=>Qn(f.current))),c.hasClickListener=!0)})),m.current.forEach(((t,n)=>{if(!l.find((e=>e.id===n))){const t=m.current.get(n);e.removeChild(t),m.current.delete(n)}}))})(),(()=>{const n=Object.values((null===u||void 0===u?void 0:u.pcs)||{});n.forEach((n=>{let r=v.current.get(n.playerId);if(r||(r=document.createElement("div"),r.className="pc",Object.assign(r.style,{position:"absolute",width:`${t}px`,height:`${t}px`,fontSize:.7*t+"px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:16,cursor:"pointer"}),e.appendChild(r),v.current.set(n.playerId,r),r.addEventListener("click",(()=>{o.style.display="none",i(n),Un(n,a,a.location.g,t)})),r.addEventListener("mouseenter",(e=>Wn(e,n,o,t))),r.addEventListener("mouseleave",(()=>Hn(o))),e.appendChild(r),v.current.set(n.playerId,r)),n.iscamping?r.textContent="\u26fa\ufe0f":n.hp<=0?r.textContent="\ud83d\udc80":n.hp<20?r.textContent="\ud83e\udd22":r.textContent="\ud83d\ude0a",r.style.top=n.position.y*t+"px",r.style.left=n.position.x*t+"px",String(n.playerId)===String(a._id)&&a.range){if(!g.current){const t=document.createElement("div");t.className="range-indicator",t.style.position="absolute",t.style.borderRadius="50%",t.style.backgroundColor="rgba(0, 100, 255, 0.08)",t.style.zIndex=10,e.appendChild(t),g.current=t}const r=n.position.x*t+t/2,o=n.position.y*t+t/2,l=a.range*t*1.8;g.current.style.width=`${l}px`,g.current.style.height=`${l}px`,g.current.style.left=r-l/2+"px",g.current.style.top=o-l/2+"px",g.current.style.display="block"}})),v.current.forEach(((t,r)=>{if(!n.find((e=>e.playerId===r))){const t=v.current.get(r);e.removeChild(t),v.current.delete(r)}}))})(),h.current=requestAnimationFrame(l)};l()})(),()=>{h.current&&cancelAnimationFrame(h.current),m.current.forEach((t=>{t.removeEventListener("click",an),t.removeEventListener("mouseenter",Vn),t.removeEventListener("mouseleave",Qn),e.removeChild(t)})),m.current.clear(),v.current.forEach((t=>{t.removeEventListener("click",Un),t.removeEventListener("mouseenter",Wn),t.removeEventListener("mouseleave",Hn),e.removeChild(t)})),v.current.clear(),e.removeChild(o)}}),[u,t,an]),(0,$t.jsx)($t.Fragment,{children:(0,$t.jsx)("div",{ref:p,style:{position:"relative",width:"100%",height:"100%"}})})},Jn=new Map;function Yn(e,t){Jn.delete(`${e}-${t}`)}async function Xn(e,t,n,r,o,a,l,s,i,c,u,d){try{console.log("Handling transit for resource:",t),console.log("\ud83d\udd0d currentPlayer before checking skills:",e),console.log("\ud83d\udcdc currentPlayer.skills:",e.skills),d=e.skills.length?e.skills:await St.get(`http://localhost:3001/api/inventory/${e.playerId}`).then((e=>e.data.skills||[])),console.log("skillResponse.data: ",d),console.log("currentPlayer = ",e.username);const r=d.some((e=>"Horse"===e.type&&e.quantity>0));if(console.log("hasHorse: ",r),!r)return void c(15);const{g:i,s:p,f:f}=e.location;if("Signpost Home"===t){console.log("Signpost Home clicked. Traveling to player's homestead.");const t={x:1,y:1,g:e.gridId,s:e.settlementId,f:e.location.f,gtype:"homestead",gridCoord:e.gridCoord};return c(101),void await Nn(e,e.location,t,n,0,o,a,l,s,0,u)}if("Signpost Town"===t){console.log("Signpost Town clicked. Finding the first town grid in the settlement.");const t=(await St.get(`http://localhost:3001/api/get-settlement/${p}`)).data;if(!t||!t.grids)return void c(104);const r=t.grids.flat().find((e=>"town"===e.gridType&&e.gridId));if(!r)return void c(104);console.log("Found town grid:",r);const i={x:1,y:1,g:r.gridId,s:p,f:f,gtype:"town",gridCoord:r.gridCoord};return c(102),void await Nn(e,e.location,i,n,0,o,a,l,s,0,u)}console.log("Regular Signpost clicked. Calculating transit options dynamically.");const h=t.replace("Signpost ",""),y={N:[-1,0],S:[1,0],E:[0,1],W:[0,-1],NE:[-1,1],SE:[1,1],SW:[1,-1],NW:[-1,-1]},g=(await St.get(`http://localhost:3001/api/get-settlement/${p}`)).data;if(!g||!g.grids)return console.error("Settlement data is invalid or missing grids."),void c(105);const m=g.grids.flat().find((e=>e.gridId===i));if(!m)return console.error("Current grid not found in settlement."),void c(105);if(!m.gridCoord)return console.error("No gridCoord found on current grid."),void c(105);c(103);const{frontierTier:v,frontierIndex:b,setRow:w,setCol:x,gRow:S,gCol:k}=function(e){const t=e.toString().padStart(8,"0");return{frontierTier:parseInt(t.slice(0,2),10),frontierIndex:parseInt(t.slice(2,4),10),setRow:parseInt(t.slice(4,5),10),setCol:parseInt(t.slice(5,6),10),gRow:parseInt(t.slice(6,7),10),gCol:parseInt(t.slice(7,8),10)}}(m.gridCoord),[C,E]=y[h]||[0,0];let I=S+C,N=k+E,j=w,P=x;if(I<0?(I=7,j-=1):I>7&&(I=0,j+=1),N<0?(N=7,P-=1):N>7&&(N=0,P+=1),j<0||j>7||P<0||P>7)return void c(106);const T=(await St.get(`http://localhost:3001/api/get-settlement-by-coords/${j}/${P}`)).data;if(!T||!T.grids)return console.warn("Target settlement not found or invalid."),void c(105);const $=T.grids[I][N];if(null===$||void 0===$||!$.gridId)return void c(18);const R={x:1,y:1,g:$.gridId,s:T._id,f:f,gtype:$.gridType,gridCoord:$.gridCoord};await Nn(e,e.location,R,n,0,o,a,l,s,0,u),console.log(`Player moved to grid ID: ${$.gridId}`)}catch(p){console.error("Error handling transit:",p.message||p),c("Error during travel.")}}async function Zn(e,t,n,r,o,a,l,s,i,c,u,d,p,f,h,y,g,m,v,b,w,x,S,k,C,E,I,N,j){var P;if(console.log(`Resource Clicked:  (${t}, ${n}):`,{resource:e,tileType:null===(P=v[t])||void 0===P?void 0:P[n]}),console.log("Inventory when handleResourceClick is called:",s),e&&e.category){var T,$;T=n,$=t,Jn.set(`${T}-${$}`,Date.now());try{N&&0!==N.length||(N=await Kt()),j&&0!==j.length||(j=await Qt());const c=b.skills;if(!Array.isArray(s)||!Array.isArray(i)){console.warn("Inventory or backpack is not initialized; fetching from server.");const{inventory:e,backpack:t}=await kt(b.playerId);a(e),l(t),console.log("Fetched inventory:",e),console.log("Fetched backpack:",t)}switch(e.category){case"doober":await async function(e,t,n,r,o,a,l){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],i=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],u=arguments.length>10?arguments[10]:void 0,d=arguments.length>11?arguments[11]:void 0,p=arguments.length>12?arguments[12]:void 0,f=arguments.length>13?arguments[13]:void 0,h=arguments.length>14?arguments[14]:void 0,y=arguments.length>15?arguments[15]:void 0,g=arguments.length>16?arguments[16]:void 0,m=arguments.length>17?arguments[17]:void 0;console.log("handleDooberClick: Current Player:",f);const v=f.location.gtype,b=e.qtycollected||1;Array.isArray(c)||(console.warn("Skills is not an array; defaulting to empty array."),c=[]);const w=c.filter((e=>{const t=g.find((t=>t.type===e.type));return"skill"===(null===t||void 0===t?void 0:t.category)||"upgrade"===(null===t||void 0===t?void 0:t.category)})).map((e=>e.type));console.log("Player Buffs (Skills and Upgrades):",w);const x=w.reduce(((t,n)=>{var r;const o=(null===m||void 0===m||null===(r=m[n])||void 0===r?void 0:r[e.type])||1;return console.log(`Buff "${n}" applies to "${e.type}" with multiplier x${o}`),t*o}),1),S=b*x;console.log("Final Quantity Collected:",S);const k="Money"===e.type,C=!k&&["town","valley1","valley2","valley3"].includes(v);if(C){if(!c.some((e=>"Backpack"===e.type&&e.quantity>0)))return console.warn("Cannot collect resources: Missing Backpack skill."),d("Backpack Required!",n*p,t*p),void y(19)}let E=k?s:C?i:s;const I=k?a:C?l:a;if(!Array.isArray(E)||0===E.length){console.warn((C?"Backpack":"Inventory")+" is empty; fetching from server.");const{inventory:e,backpack:t}=await kt(f.playerId);E=C?t:e,a(e),l(t)}k||(C?f.backpackCapacity:f.warehouseCapacity),E.filter((e=>"Money"!==e.type)).reduce(((e,t)=>e+t.quantity),0);if(!k){if(!jt(f,s,i,e.type,S)){const e=C?21:20;return console.warn(`Cannot collect doober: Exceeds capacity in ${C?"backpack":"warehouse"}.`),d("No more capacity",n*p,t*p),void y(e)}}Mt.addFloatingText(`+${S} ${e.type}`,n*p,t*p),o((e=>e.filter((e=>!(e.x===n&&e.y===t)))));const N=[...E],j=N.findIndex((t=>t.type===e.type));j>=0?N[j].quantity+=S:N.push({type:e.type,quantity:S});I(N),console.log("TargetInventory set to updatedInventory.");try{const r=await In(u,{newResource:null,x:n,y:t},o);if(null===r||void 0===r||!r.success)throw new Error("Failed to update grid resource.");console.log("Doober collected successfully."),await St.post("http://localhost:3001/api/update-inventory",{playerId:f.playerId,[C?"backpack":"inventory"]:N}),console.log(`Server ${C?"backpack":"inventory"} updated successfully.`),await en(f,"Collect",e.type,S,h),await It(f.playerId,h)}catch(P){console.error("Error during doober collection:",P),o((t=>[...t,e])),I((t=>{const n=[...t],r=n.findIndex((t=>t.type===e.type));return r>=0&&(n[r].quantity-=S,n[r].quantity<=0&&n.splice(r,1)),n}))}finally{Yn(n,t)}}(e,t,n,r,o,a,l,s,i,c,g,y,m,b,w,I,N,j);break;case"source":await async function(e,t,n,r,o,a,l,s,i,c,u,d){var p,f;if("convertTo"!==e.action)return;const h=null===(p=d.find((t=>t.output===e.type)))||void 0===p?void 0:p.type;if(h&&!c.skills.some((e=>e.type===h)))return void s(`${h} Required`,n*i,t*i);console.log("resource = ",e),console.log("resource.output = ",e.output);const y=!["town","homestead"].includes(null===c||void 0===c||null===(f=c.location)||void 0===f?void 0:f.gtype);console.log("isValley = ",y);const g=d.find((t=>t.type===e.output));console.log("targetResource: ",g);const m={...g,x:n,y:t,symbol:g.symbol,qtycollected:g.qtycollected||1,category:g.category||"doober",growEnd:g.growEnd||null};console.log("Enriched newResource for local state: ",m),y?(o((e=>e.filter((e=>!(e.x===n&&e.y===t))))),console.log(`\ud83c\udf3f Resource removed at (${n}, ${t}) due to valley rules.`)):(o((e=>e.map((e=>e.x===n&&e.y===t?m:e)))),console.log("resources: ",r),s(`Converted to ${g.type}`,n*i,t*i));try{const e=await In(l,{newResource:y?null:g.type,x:n,y:t});if(null===e||void 0===e||!e.success)throw new Error("Server failed to confirm the source conversion.");console.log("Source conversion completed successfully on the server.")}catch(v){console.error("Error during source conversion:",v),console.warn("Server update failed. The client may become out of sync. Consider adding a recovery mechanism.")}finally{await It(c.playerId,u),Yn(n,t)}}(e,t,n,r,o,0,g,y,m,b,w,N);break;case"seed":console.log("Seed clicked; do nothing");break;case"travel":console.log("Travel sign clicked");try{await Xn(b,e.type,w,0,S,k,o,C,0,I,m,c)}catch(R){console.error("Error handling travel signpost:",R.message||R)}break;default:console.warn(`Unhandled resource category: ${e.category}`)}}catch(R){console.error("Error handling resource click:",R),Yn(n,t)}finally{Yn(n,t)}}else console.error(`Invalid resource at (${n}, ${t}):`,e)}const er=async(e,t)=>{try{const n=await Kt();if(console.log("masterResources:",n),console.log("current resources:",e),console.log("newResource:",t),!Array.isArray(n))return console.error("Failed to load masterResources or incorrect format:",n),e;const r=t.newResource||t.type;if(!r)return console.error("Invalid resource payload:",t),e;const o={...n.find((e=>e.type===r)),type:r,x:t.x,y:t.y,growEnd:t.growEnd};return console.log("Enriched resource:",o),[...e.filter((e=>!(e.x===t.x&&e.y===t.y))),o]}catch(n){return console.error("Error enriching resource:",n),e}};let tr=null;const nr=new class{constructor(){this.farmState=[],console.log("FarmState instance created. Initial state:",this.farmState)}initializeFarmState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.farmState=e.filter((e=>"farmplot"===e.category&&e.growEnd)),console.log("initializeFarmState called. Updated farmState:",this.farmState)}addSeed(e){this.farmState.push(e),console.log("addSeed called. Updated farmState:",this.farmState)}startSeedTimer(e){let{gridId:t,setResources:n,TILE_SIZE:r,currentPlayer:o,setCurrentPlayer:a}=e;tr&&clearInterval(tr),tr=setInterval((async()=>{const e=Date.now(),r=this.farmState.filter((t=>t.growEnd<=e));if(r.length>0){const e=await Kt();console.log("Loaded masterResources:",e);for(const a of r){console.log("Processing seed:",a);const r=e.find((e=>e.type===a.output));if(console.log("Target resource found for seed:",r),r){try{console.log(`Updating grid resource for seed at (${a.x}, ${a.y}).`);const e=await In(t,{newResource:r.type,x:a.x,y:a.y});console.log("updateGridResource response:",e),null!==e&&void 0!==e&&e.success?(console.log(`Seed at (${a.x}, ${a.y}) converted to doober.`),n((e=>{const t=e.map((e=>e.x===a.x&&e.y===a.y?{type:r.type,symbol:r.symbol,category:"doober",x:a.x,y:a.y}:e));return console.log("Updated resources:",t),t}))):console.warn(`Failed to update grid resource for seed at (${a.x}, ${a.y}).`)}catch(o){console.error(`Error updating grid resource for seed at (${a.x}, ${a.y}):`,o)}this.farmState=this.farmState.filter((e=>e!==a)),console.log("Updated farmState after removing processed seed:",this.farmState)}else console.warn(`No target resource found for seed output: ${a.output}`)}}}),1e3)}stopSeedTimer(){tr&&clearInterval(tr),tr=null}},rr=nr,or=e=>{let{currentPlayer:t,setZoomLevel:n,setCurrentPlayer:r,fetchGrid:a,setGridId:l,setGrid:s,setResources:i,setTileTypes:c,setGridState:u,TILE_SIZE:d}=e;const[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)(null),{updateStatus:g}=(0,o.useContext)(zt);console.log("Entering SettlementView for:",t.location.s),(0,o.useEffect)((()=>{(async()=>{try{const e=(await St.get(`http://localhost:3001/api/get-settlement-grid/${t.location.s}`)).data.grid||[];console.log("Fetched Settlement Grid:",e),f(e)}catch(e){console.error("Error fetching Settlement Grid:",e),y("Failed to fetch Settlement Grid")}})()}),[t.location]);const m=e=>{switch(e){case"homestead":return"#3dc43d";case"reserved":return"#8b0000";case"town":return"#deb887";case"valley1":case"valley2":case"valley3":return"#00851f";default:return"#d3d3d3"}},v=e=>{if(e.gridId===t.location.g)return t.icon;if("homestead"===e.gridType)return e.available?"\ud83d\udcb0":"\ud83d\udcea";switch(e.gridType){case"reserved":return"\ud83d\udeab";case"town":return"\ud83c\udfe0";case"valley1":return"\ud83c\udf32";case"valley2":return"\ud83c\udf32\ud83c\udf32";case"valley3":return"\ud83c\udf32\ud83c\udf32\ud83c\udf32";default:return"?"}};return h?(0,$t.jsxs)("div",{children:["Error: ",h]}):p.length?(0,$t.jsx)("div",{className:"settlement-grid",children:p.map(((e,o)=>e.map(((e,a)=>(0,$t.jsx)("div",{className:"settlement-tile",style:{backgroundColor:m(e.gridType),width:"120px",height:"120px"},onClick:()=>(async e=>{if(console.log("Clicked tile:",e),["valley1","valley2","valley3"].includes(e.gridType)&&e.gridId===t.location.g)return console.log("Clicked on the current valley tile. Zooming into grid view."),n("far"),void g(16);if(["valley1","valley2","valley3"].includes(e.gridType))g(9);else try{const o={x:1,y:1,g:e.gridId,s:t.location.s,f:t.location.f,gtype:e.gridType||"unknown"};console.log("Built toLocation object:",o),console.log("About to call changePlayerLocation from SettlementView;  current player = ",t,"toLocatoin = ",o),await Nn(t,t.location,o,r,0,l,s,i,c,0,d),n("far")}catch(h){console.error("Error changing player location:",h),g(10)}})(e),children:v(e)},`${o}-${a}`)))))}):(0,$t.jsx)("div",{children:"Loading Settlement Grid..."})},ar=e=>{let{currentPlayer:t,setZoomLevel:n,setCurrentPlayer:r,fetchGrid:a,setGridId:l,setGrid:s,setResources:i,setTileTypes:c,setGridState:u,TILE_SIZE:d}=e;const[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)({}),[g,m]=(0,o.useState)(null),{updateStatus:v}=(0,o.useContext)(zt);(0,o.useEffect)((()=>{(async()=>{try{const e=(await St.get(`http://localhost:3001/api/get-frontier-grid/${t.location.f}`)).data.frontierGrid||[];console.log("Fetched Frontier Grid:",e),f(e),await b(e)}catch(e){console.error("Error fetching Frontier Grid:",e),m("Failed to fetch Frontier Grid")}})()}),[t.location]);const b=async e=>{const t={};for(const n of e)for(const e of n)"homesteadSet"===e.settlementType&&(t[e.settlementId]=await w(e.settlementId));y(t)},w=async e=>{try{const t=(await St.get(`http://localhost:3001/api/get-settlement-grid/${e}`)).data.grid||[];return t.some((e=>e.some((e=>"homestead"===e.gridType&&!1===e.available))))?"\ud83c\udfe1":"\ud83c\udf33"}catch(t){console.error(`Error fetching grids for settlement ${e}:`,t)}return"\ud83c\udf33"},x=e=>{switch(e){case"homesteadSet":return"#3dc43d";case"valley1Set":case"valley2Set":case"valley3Set":return"#00851f";default:return"#d3d3d3"}},S=e=>{if(e.settlementId===t.location.s)return t.icon;switch(e.settlementType){case"homesteadSet":return h[e.settlementId]||"\ud83c\udfe1";case"valley1Set":return"\ud83c\udf32";case"valley2Set":return"\ud83c\udf32\ud83c\udf32";case"valley3Set":return"\ud83c\udf32\ud83c\udf32\ud83c\udf32";default:return"?"}};return g?(0,$t.jsxs)("div",{children:["Error: ",g]}):p.length?(0,$t.jsx)("div",{className:"frontier-grid",children:p.map(((e,o)=>e.map(((e,a)=>(0,$t.jsx)("div",{className:"frontier-tile",style:{backgroundColor:x(e.settlementType),width:"100px",height:"100px"},onClick:()=>(async e=>{if(console.log("Clicked tile:",e),e.settlementId===t.location.s)return console.log("Player clicked their current settlement. Zooming to SettlementView."),n("settlement"),void v(12);if("homesteadSet"===e.settlementType){try{const o=(await St.get(`http://localhost:3001/api/get-settlement-grid/${e.settlementId}`)).data.grid||[];console.log("currentPlayer.gridId:",t.gridId),console.log("grids:",o);const a=o.flat().find((e=>"homestead"===e.gridType&&e.gridId===t.gridId));if(console.log("ownedHomestead:",a),a)return console.log("Traveling to owned homestead:",a),await Nn(t,t.location,{x:1,y:1,g:a.gridId,s:e.settlementId,f:t.location.f},r,0,l,s,i,c,0,d),void n("far")}catch(g){return console.error("Error checking for owned homestead:",g),void v(8)}return console.log("Player does not own a homestead in this settlement."),void v(17)}if(["valley1Set","valley2Set","valley3Set"].includes(e.settlementType))return console.log("Player clicked a valley tile."),void v(9);console.warn("Unexpected tile type clicked:",e.settlementType),v(8)})(e),children:S(e)},`${o}-${a}`)))))}):(0,$t.jsx)("div",{children:"Loading Frontier Grid..."})};const lr=function(e){let{isOpen:t=!0,onClose:n,title:r,children:o,message:a,message2:l,size:s="standard"}=e;return t?(0,$t.jsx)("div",{className:"modal-overlay",children:(0,$t.jsxs)("div",{className:"modal-container "+("small"===s?"modal-small":""),children:[r&&(0,$t.jsx)("h2",{className:"modal-title",children:r}),(0,$t.jsxs)("div",{className:"modal-content",children:[a&&(0,$t.jsx)("p",{className:"modal-message",children:a}),l&&(0,$t.jsx)("p",{className:"modal-message",children:l}),o]}),(0,$t.jsx)("button",{className:"modal-close-btn",onClick:n,children:"\xd7"})]})}):null};const sr=(0,o.memo)((e=>{var t;let{onClose:n,currentPlayer:r,setCurrentPlayer:a,handleLogout:l}=e;const[s,i]=(0,o.useState)({username:"",icon:"",password:"",accountStatus:"Free",role:"Peasant"}),{updateStatus:c}=(0,o.useContext)(zt),[u,d]=(0,o.useState)(!1),[p,f]=(0,o.useState)(""),[h,y]=(0,o.useState)({isStateMachineEnabled:!1,isTeleportEnabled:!1,toggleVFX:!0});(0,o.useEffect)((()=>{if(r){var e,t,n;const{settings:o}=r;y({isStateMachineEnabled:null!==(e=null===o||void 0===o?void 0:o.isStateMachineEnabled)&&void 0!==e&&e,isTeleportEnabled:null!==(t=null===o||void 0===o?void 0:o.isTeleportEnabled)&&void 0!==t&&t,toggleVFX:null===(n=null===o||void 0===o?void 0:o.toggleVFX)||void 0===n||n}),i({username:r.username||"",icon:r.icon||"",password:"",accountStatus:r.accountStatus||"Free",role:r.role||"Peasant"}),f(""),console.log("Profile: curentPlayer = ",r)}}),[r]);const g=e=>{const{name:t,value:n}=e.target;i((e=>({...e,[t]:n})))},m=e=>{y((t=>{const n={...t,[e]:!t[e]};return async function(e,t,n){try{const r={...t,settings:{...e}};localStorage.setItem("player",JSON.stringify(r)),n(r),console.log("Updating settings on server:",e);const o=await St.post("http://localhost:3001/api/update-settings",{playerId:t.playerId,settings:e});o.data.success?console.log("Settings updated successfully on server."):console.error("Server update failed:",o.data.error)}catch(r){console.error("Error updating player settings:",r)}}(n,r,a),n}))};return(0,$t.jsx)(At,{onClose:n,descriptionKey:"1019",titleKey:"1119",panelName:"ProfilePanel",children:(0,$t.jsxs)("div",{className:"panel-content",children:[(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("label",{children:"Username:"}),(0,$t.jsx)("input",{name:"username",type:"text",value:s.username,onChange:g,placeholder:"Enter your username"})]}),(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("label",{children:"Password:"}),(0,$t.jsx)("input",{name:"password",type:"password",value:s.password,onChange:g,placeholder:"Enter new password (optional)"})]}),(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("label",{children:"Account Status:"}),(0,$t.jsxs)("select",{name:"accountStatus",value:s.accountStatus,onChange:g,children:[(0,$t.jsx)("option",{value:"Free",children:"Free"}),(0,$t.jsx)("option",{value:"Bronze",children:"Bronze"}),(0,$t.jsx)("option",{value:"Silver",children:"Silver"}),(0,$t.jsx)("option",{value:"Gold",children:"Gold"})]})]}),(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("label",{children:"Role:"}),(0,$t.jsxs)("select",{name:"role",value:s.role,onChange:g,children:[(0,$t.jsx)("option",{value:"Peasant",children:"Peasant"}),(0,$t.jsx)("option",{value:"Citizen",children:"Citizen"}),(0,$t.jsx)("option",{value:"Sheriff",children:"Sheriff"}),(0,$t.jsx)("option",{value:"Mayor",children:"Mayor"}),(0,$t.jsx)("option",{value:"Governor",children:"Governor"}),(0,$t.jsx)("option",{value:"President",children:"President"})]})]}),(0,$t.jsxs)("div",{className:"panel-buttons",children:[(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{d(!0),f("");try{if(!s.username.trim())throw new Error("Username cannot be empty.");const t={username:s.username.trim(),icon:s.icon.trim(),...s.password&&{password:s.password},accountStatus:s.accountStatus,role:s.role,settings:{...h}};console.log("Saving updates:",t);const o=await St.post("http://localhost:3001/api/update-profile",{playerId:r.playerId,updates:t});if(o.data.success){var e;console.log("Profile and settings successfully updated:",o.data.player);const t={...r,settings:{...h},username:s.username.trim(),icon:s.icon.trim(),accountStatus:s.accountStatus,role:s.role};a(t),localStorage.setItem("player",JSON.stringify(t)),console.log("Updated localStorage after save:",t.settings),s.role&&(console.log(`\ud83c\udfdb\ufe0f Assigning player to role "${s.role}" in the settlement...`),await St.post("http://localhost:3001/api/update-settlement-role",{settlementId:r.location.s,playerId:r._id,roleName:s.role}));const l=null===r||void 0===r||null===(e=r.location)||void 0===e?void 0:e.g;if(l){const e=En.getGridState(l);null!==e&&void 0!==e&&e.pcs[r.playerId]&&(e.pcs[r.playerId].username=s.username.trim(),En.saveGridState(l),console.log(`\u2705 Updated username in gridState: ${r.playerId} \u2192 ${s.username.trim()}`))}else console.warn("\u26a0\ufe0f No valid gridId found, skipping gridState update.");n()}else{const e=o.data.error||"Failed to update profile.";console.error(e),f(e)}}catch(l){var t,o;console.error("Error during save operation:",l),"TAKEN"===(null===(t=l.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.error)&&(console.log("\u274c Username is already taken."),c(50)),f(l.message||"An unexpected error occurred while saving.")}finally{d(!1)}},disabled:u,children:u?"Saving...":"Save Changes"}),(0,$t.jsx)("button",{className:"btn-danger",onClick:l,children:"Logout"})]}),(0,$t.jsx)("h3",{children:"Stats"}),(0,$t.jsxs)("p",{children:["Range: ",null===r||void 0===r?void 0:r.range]}),(0,$t.jsxs)("p",{children:["HP: ",null===r||void 0===r?void 0:r.hp]}),(0,$t.jsxs)("p",{children:["MaxHP: ",null===r||void 0===r?void 0:r.maxhp]}),(0,$t.jsxs)("p",{children:["Armor Class: ",null===r||void 0===r?void 0:r.armorclass]}),(0,$t.jsxs)("p",{children:["Attack Range: ",null===r||void 0===r?void 0:r.attackrange]}),(0,$t.jsxs)("p",{children:["Attack Bonus: ",null===r||void 0===r?void 0:r.attackbonus]}),(0,$t.jsxs)("p",{children:["Attack Damage: ",null===r||void 0===r?void 0:r.damage]}),(0,$t.jsxs)("p",{children:["Attack Speed: ",null===r||void 0===r?void 0:r.speed]}),(0,$t.jsxs)("p",{children:["Is Camping: ",null!==r&&void 0!==r&&r.iscamping?"Yes":"No"]}),(0,$t.jsx)("h3",{children:"Settings"}),(0,$t.jsxs)("div",{className:"debug-toggles",children:[(0,$t.jsxs)("button",{className:"btn-toggle "+(h.isTeleportEnabled?"btn-enabled":"btn-disabled"),onClick:()=>m("isTeleportEnabled"),children:["Teleport: ",h.isTeleportEnabled?"is ON":"is OFF"]}),(0,$t.jsxs)("button",{className:"btn-toggle "+(h.isStateMachineEnabled?"btn-enabled":"btn-disabled"),onClick:()=>m("isStateMachineEnabled"),children:["State: ",h.isStateMachineEnabled?"is ON":"is OFF"]}),(0,$t.jsxs)("button",{className:"btn-toggle "+(h.toggleVFX?"btn-enabled":"btn-disabled"),onClick:()=>m("toggleVFX"),children:["VFX: ",h.toggleVFX?"is ON":"is OFF"]})]}),(0,$t.jsxs)("div",{className:"debug-info",children:[(0,$t.jsx)("label",{children:"Debug:"}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Player ID:"})," ",(null===r||void 0===r?void 0:r.playerId)||"N/A"]}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Frontier ID:"})," ",(null===r||void 0===r?void 0:r.frontierId)||"N/A"]}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Settlement ID:"})," ",(null===r||void 0===r?void 0:r.settlementId)||"N/A"]}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Homestead ID:"})," ",(null===r||void 0===r?void 0:r.gridId)||"N/A"]}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Current Grid ID:"})," ",(null===r||void 0===r||null===(t=r.location)||void 0===t?void 0:t.g)||"N/A"]})]}),p&&(0,$t.jsx)("p",{className:"error-message",children:p})]})})})),ir=e=>{let{setCurrentPlayer:t,setIsLoggedIn:n,closeModal:r}=e;const[a,l]=(0,o.useState)(""),[s,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[d,p]=(0,o.useState)("");return(0,$t.jsxs)("div",{id:"create-account-form",children:[(0,$t.jsx)("h2",{children:"Create Account"}),(0,$t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e="Free",n="Peasant",o="English",c=await St.get("http://localhost:3001/api/frontiers-by-name",{params:{name:"Valley View 1"}});if(!c.data||0===c.data.length)throw new Error("Frontier not found");const u=c.data[0];if(console.log("Frontier fetched:",u),!u.settlements||0===u.settlements.length)throw new Error("No settlements available in this Frontier.");let p=null,f=null,h=null,y=null;if(!Array.isArray(u.settlements))throw new Error(`Invalid settlements data: ${JSON.stringify(u.settlements,null,2)}`);console.log("\ud83d\udee0\ufe0f Frontier Data:",JSON.stringify(u,null,2)),console.log("\ud83c\udfd8\ufe0f Settlements:",JSON.stringify(u.settlements,null,2));for(const t of u.settlements){for(const e of t){if(!0!==e.available)continue;const t=await St.get(`http://localhost:3001/api/get-settlement/${e.settlementId}`),n=t.data.grids.flat().find((e=>!0===e.available));if(n){console.log("availableGrid:",n),console.log("Found available gridCoord:",n.gridCoord),p=e.settlementId,h=n.gridCoord,y=n.gridType;const t={gridCoord:h,gridType:y,settlementId:p,frontierId:u._id};console.log("gridPayload = ",t);const r=await St.post("http://localhost:3001/api/create-grid",t);if(!r.data.success)throw new Error("Failed to create grid");f=r.data.gridId,console.log("Grid document created successfully:",f);break}}if(f)break}if(!f)throw new Error("No available sub-grids in the Frontier.");const g={username:a,password:s,icon:"\ud83d\ude00",accountStatus:e,role:n,language:o,location:{x:2,y:2,g:f,s:p,f:u._id,gtype:y,gridCoord:h}};console.log("Registering player with payload:",g);const m=await St.post("http://localhost:3001/api/register",g);if(!m.data.success)throw new Error("Player registration failed");console.log("Player successfully registered:",m.data.player);const v=m.data.player;t(v),localStorage.removeItem("player"),localStorage.setItem("player",JSON.stringify(v));try{await St.post("http://localhost:3001/api/increment-settlement-population",{settlementId:p}),console.log("\u2705 Settlement population incremented successfully.")}catch(d){console.error("\u274c Error incrementing settlement population:",d)}if("homestead"===y)try{console.log(`Claiming homestead for gridId: ${f}, playerId: ${v._id}`),await St.post(`http://localhost:3001/api/claim-homestead/${f}`,{playerId:v._id}),console.log("Homestead claimed successfully!")}catch(l){console.error("Failed to claim homestead:",l)}let b=(await St.get(`http://localhost:3001/api/load-grid-state/${f}`)).data.gridState||{npcs:{},pcs:{}};console.log(`Adding new player ${v.username} to gridState for gridId ${f}`),b.pcs[v._id]={playerId:v._id,type:"pc",username:v.username,position:{x:2,y:2},icon:v.icon||"\ud83d\ude00",hp:v.hp,maxhp:v.maxhp,armorclass:v.armorclass,attackbonus:v.attackbonus,damage:v.damage,attackrange:v.attackrange,speed:v.speed,iscamping:v.iscamping},await St.post("http://localhost:3001/api/save-grid-state",{gridId:f,gridState:b});try{await St.post("http://localhost:3001/api/send-mailbox-message",{playerId:v._id,messageId:1}),console.log("\ud83d\udcec Welcome message added to mailbox.")}catch(i){console.error("\u274c Failed to send welcome message:",i)}r&&r(),window.location.reload()}catch(c){var n,o;console.error("Error during account creation:",c),p((null===(n=c.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.error)||"Account creation failed. Please try again.")}},children:[(0,$t.jsx)("input",{type:"text",placeholder:"Username",value:a,onChange:e=>l(e.target.value)}),(0,$t.jsx)("input",{type:"password",placeholder:"Password",value:s,onChange:e=>i(e.target.value)}),(0,$t.jsx)("input",{type:"language",placeholder:"language",value:c,onChange:e=>u(e.target.value)}),(0,$t.jsx)("div",{className:"panel-buttons",children:(0,$t.jsx)("button",{className:"btn-success",type:"submit",children:"Create Account"})})]}),(0,$t.jsxs)("div",{className:"panel-buttons",children:[(0,$t.jsx)("button",{className:"btn-neutral",type:"button",onClick:()=>n(!1),children:"Back to Login"}),d&&(0,$t.jsx)("p",{style:{color:"red"},children:d})]})]})},cr=e=>{let{onClose:t,setCurrentPlayer:n,onLoginSuccess:r}=e;const[a,l]=(0,o.useState)(""),[s,i]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[d,p]=(0,o.useState)(!1);return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1021",titleKey:"1121",panelName:"LoginPanel",children:d?(0,$t.jsx)(ir,{setCurrentPlayer:n,setIsLoggedIn:()=>{p(!1),t()}}):(0,$t.jsx)("div",{className:"panel-content",children:(0,$t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{console.log("Login attempt:",{username:a,password:s});const e=await St.post("http://localhost:3001/api/login",{username:a,password:s});if(e.data.success){const o=e.data.player;console.log("Login successful:",o),n(o),localStorage.setItem("player",JSON.stringify(o)),t(),r&&r(o)}else u(e.data.error||"Invalid username or password")}catch(o){console.error("Error during login:",o),u("Login failed. Please try again.")}},className:"panel-form",children:[(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("h3",{children:"Have an existing account?"}),(0,$t.jsx)("label",{htmlFor:"username",children:"Username"}),(0,$t.jsx)("input",{id:"username",type:"text",value:a,onChange:e=>l(e.target.value),required:!0})]}),(0,$t.jsxs)("div",{className:"form-group",children:[(0,$t.jsx)("label",{htmlFor:"password",children:"Password"}),(0,$t.jsx)("input",{id:"password",type:"password",value:s,onChange:e=>i(e.target.value),required:!0})]}),c&&(0,$t.jsx)("p",{className:"error-message",children:c}),(0,$t.jsxs)("div",{className:"panel-buttons",children:[(0,$t.jsx)("button",{type:"submit",className:"btn-success",children:"Login"}),(0,$t.jsx)("h3",{children:"Don't have an account yet? Create a free account to start playing:"}),(0,$t.jsx)("button",{type:"button",className:"btn-success",onClick:()=>p(!0),children:"Create Account"}),(0,$t.jsx)("h4",{children:"With a new account, you'll be granted your own homestead to cultivate in a Settlement with other players, in a Frontier full of Settlements. Adventure awits you in the Valley."})]})]})})})},ur=e=>{let{onClose:t,currentPlayer:n,setCurrentPlayer:r,setInventory:a,setResources:l,currentGridId:s,updateStatus:i}=e;const[c,u]=(0,o.useState)([]),[d,p]=(0,o.useState)([]),[f,h]=(0,o.useState)([]),[y,g]=(0,o.useState)(d),[m,v]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!s)return;(async()=>{try{console.log("Fetching timers for gridId:",s);const e=((await jn(s)).resources||[]).filter((e=>e.growEnd||e.craftEnd));console.log("\u23f3 Active Timers:",e),u(e)}catch(e){console.error("Error fetching timers:",e)}})()}),[s]),(0,o.useEffect)((()=>{const e=setInterval((()=>{u((e=>e.map((e=>{const t=e.growEnd?Math.max(0,Math.floor((e.growEnd-Date.now())/1e3)):null,n=e.craftEnd?Math.max(0,Math.floor((e.craftEnd-Date.now())/1e3)):null;return{...e,remainingTime:null!==t?t:n}}))))}),1e3);return()=>clearInterval(e)}),[]),(0,o.useEffect)((()=>{if(!s)return;(()=>{const e=En.getGridState(s);if(!e)return console.warn(`No gridState found for gridId: ${s}`),p([]),void h([]);console.log("Fetched gridState entities:",e),p(Object.values(e.npcs||{})),h(Object.values(e.pcs||{}))})()}),[s,m]),(0,o.useEffect)((()=>{g(d)}),[d]);const b=async e=>{try{var t;const o=null===n||void 0===n||null===(t=n.location)||void 0===t?void 0:t.f;if(!o)return console.error("No frontier ID found for the current player."),void alert("No frontier ID found for the current player.");console.log(`Fetching frontier data for ID: ${o}`);const a=(await St.get(`http://localhost:3001/api/get-frontier/${o}`)).data;if(!a||!a.settlements)return console.error("Frontier data is incomplete or missing settlements."),void alert("Frontier data is incomplete or missing settlements.");console.log(`Searching settlements for valley${e} grids.`);const l=[];for(const t of a.settlements)for(const n of t)if(null!==n&&void 0!==n&&n.settlementId)try{console.log("Fetching settlement data for settlement ID:",n.settlementId);const t=(await St.get(`http://localhost:3001/api/get-settlement/${n.settlementId}`)).data;if(null===t||void 0===t||!t.grids){console.warn(`Settlement ${n.settlementId} has no grids. Skipping.`);continue}t.grids.flat().forEach((t=>{t.gridType!==`valley${e}`||t.gridId||l.push({...t,settlementId:n.settlementId})}))}catch(r){console.error(`Failed to fetch data for settlement ${n.settlementId}:`,r)}else console.warn("Settlement is invalid or missing settlementId. Skipping.");if(0===l.length)return console.log(`No valley${e} grids found in this frontier.`),void alert(`No valley${e} grids found in this frontier.`);console.log(`Found ${l.length} valley${e} grids. Starting generation process.`);for(const t of l)try{console.log(`Creating valley${e} grid with gridCoord: ${t.gridCoord}, Settlement ID: ${t.settlementId}`),await St.post("http://localhost:3001/api/create-grid",{gridCoord:t.gridCoord,gridType:t.gridType,settlementId:t.settlementId,frontierId:o}),console.log(`Successfully created valley${e} grid for gridCoord: ${t.gridCoord}`)}catch(r){console.error(`Error creating valley${e} grid with gridCoord ${t.gridCoord}:`,r)}alert(`Valley${e} grids processed successfully!`)}catch(r){console.error(`Error processing valley${e} grids:`,r),alert(`Failed to process valley${e} grids. Check the console for details.`)}};return(0,$t.jsxs)(At,{onClose:t,titleKey:"1120",panelName:"DebugPanel",children:[(0,$t.jsxs)("div",{className:"debug-buttons",children:[(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{const e=null===n||void 0===n?void 0:n.playerId;if(e)try{await St.post("http://localhost:3001/api/send-mailbox-message",{playerId:e,messageId:1}),console.log("\ud83d\udcec Welcome message added to mailbox."),i("\u2705 Welcome message delivered."),await It(e,r)}catch(t){console.error("\u274c Failed to send welcome message:",t),i("\u274c Failed to deliver welcome message.")}else console.error("\u274c No player ID available.")},children:" Resend Welcome Message "}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{const e=null===n||void 0===n?void 0:n.playerId;if(e)try{await St.post("http://localhost:3001/api/send-mailbox-message",{playerId:e,messageId:101}),console.log("\ud83d\udcec Welcome message added to mailbox."),i("\u2705 Welcome message delivered."),await It(e,r)}catch(t){console.error("\u274c Failed to send welcome message:",t),i("\u274c Failed to deliver welcome message.")}else console.error("\u274c No player ID available.")},children:" Resend Reward Message "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:async()=>{try{const e=await St.post("http://localhost:3001/api/create-frontier");console.log("Create New Frontier response:",e.data),alert("New Frontier created successfully!")}catch(e){console.error("Error creating new Frontier:",e),alert("Failed to create new Frontier. Check console for details.")}},children:" Create New Frontier "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:async()=>{if(s){console.log("handleResetGrid: gridId:",s);try{var e;const t=null===n||void 0===n||null===(e=n.location)||void 0===e?void 0:e.s;if(!t)return console.error("Settlement ID not found for the current player."),void alert("Settlement ID not found for the current player.");const r=(await St.get(`http://localhost:3001/api/get-settlement/${t}`)).data;if(!r||!r.frontierId)return console.error("Settlement data is incomplete or missing frontierId."),void alert("Settlement data is incomplete or missing frontierId.");const o=r.frontierId;console.log("Settlement and frontierId resolved:",{settlementId:t,frontierId:o});const a=(await St.get(`http://localhost:3001/api/load-grid/${s}`)).data;if(!a||!a.gridType)return console.error("Grid data is incomplete or missing gridType."),void alert("Grid data is incomplete or missing gridType.");const l=a.gridType,c=a.gridCoord;console.log("Grid type resolved:",l);const u=await St.post("http://localhost:3001/api/reset-grid",{gridCoord:c,gridId:s,gridType:l,settlementId:t,frontierId:o});console.log(`Grid ${s} of type ${l} reset successfully:`,u.data),i(903),window.location.reload()}catch(t){console.error(`Error resetting grid "${s}":`,t),alert(`Failed to reset grid "${s}". Check the console for details.`)}}else console.error("currentGridId is not defined.")},children:" Reset This Grid "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:async()=>{try{const t=n.location.s;if(!t)return console.error("No settlement ID found for the current player."),void alert("No settlement ID found for the current player.");const r=(await St.get(`http://localhost:3001/api/get-settlement/${t}`)).data;if(!r||!r.grids||0===r.grids.length)return console.error("Settlement data is incomplete or missing grids."),void alert("Settlement data is incomplete or missing grids.");const o=[];if(r.grids.forEach((e=>{e.forEach((e=>{"town"!==e.gridType||e.gridId||o.push(e.gridCoord)}))})),0===o.length)return console.log("No uninitialized town grids found in this settlement."),void alert("No uninitialized town grids found in this settlement.");console.log(`Found ${o.length} uninitialized town grids. Processing grids...`);for(const n of o)try{console.log(`Creating Town grid with gridCoord: ${n}`);const e=await St.post("http://localhost:3001/api/create-grid",{gridCoord:n,gridType:"town",settlementId:t,frontierId:r.frontierId});console.log(`Processed town grid for gridCoord: ${n}`,e.data)}catch(e){console.error(`Failed to process grid for gridCoord: ${n}`,e)}alert("Town grids created successfully!")}catch(t){console.error("Error processing town grids:",t),alert("Failed to create town grids. Check the console for details.")}},children:" Generate Town "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:()=>b(1),children:" Generate Valley 1 "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:()=>b(2),children:" Generate Valley 2 "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:()=>b(3),children:" Generate Valley 3 "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:async()=>{try{const e=null===n||void 0===n?void 0:n.playerId;if(!e)return void console.error("No player ID found. Cannot clear inventory and skills.");const t=n.inventory.filter((e=>"Money"===e.type));console.log("Filtered inventory to retain only Money:",t);const o=[];console.log("Clearing all skills and upgrades."),await St.post("http://localhost:3001/api/update-inventory",{playerId:e,inventory:t,backpack:n.backpack||[]}),console.log("Inventory updated successfully on the server."),await St.post("http://localhost:3001/api/update-skills",{playerId:e,skills:o}),console.log("Skills cleared successfully on the server."),await It(e,r);const l=await Ct(e);console.log("Fetched inventory after clearing:",l),a(l),r((e=>({...e,inventory:l,skills:o}))),i(900),console.log("Inventory and skills cleared successfully except for Money.")}catch(e){console.error("Error clearing inventory and skills:",e)}},children:" Clear Inventory & Skills "}),(0,$t.jsx)("button",{className:"btn-danger",onClick:async()=>{try{const e=null===n||void 0===n?void 0:n.playerId;if(!e)return void console.error("No player logged in. Cannot clear quest history.");await St.post("http://localhost:3001/api/clear-quest-history",{playerId:e});const t={...n,activeQuests:[],completedQuests:[]};r(t),console.log("Quest history cleared successfully."),i(901)}catch(e){console.error("Error clearing quest history:",e)}},children:" Clear Quest History "}),(0,$t.jsx)("button",{className:"btn-neutral",onClick:async()=>{try{const e=null===n||void 0===n?void 0:n.username;if(!e)return void console.error("No user logged in. Cannot clear Trade Stall.");await St.post("http://localhost:3001/api/update-player-trade-stall",{username:e,tradeStall:[]}),console.log("Trade Stall cleared successfully.")}catch(e){console.error("Error clearing Trade Stall:",e)}},children:" Clear Trade Stall "}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{try{const e=null===n||void 0===n?void 0:n.playerId;if(!e)return void console.error("No user logged in. Cannot add money.");const t=await Ct(e);await Et(n,"Money",1e4,r);const o=t.map((e=>"Money"===e.type?{...e,quantity:e.quantity+1e4}:e));a(o),console.log("Added 1000 Money successfully.")}catch(e){console.error("Error adding money:",e)}},children:" Add Money "}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{try{if(!(null===n||void 0===n?void 0:n.playerId))return void console.error("No user logged in. Cannot perform Get Rich.");const e=[{type:"Money",quantity:1e5},{type:"Wood",quantity:1e4},{type:"Clay",quantity:1e4},{type:"Stone",quantity:1e4},{type:"Wheat",quantity:1e4},{type:"Corn",quantity:1e4},{type:"Carrot",quantity:1e4},{type:"Potion 1",quantity:50},{type:"Potion 2",quantity:50},{type:"Cloth",quantity:500},{type:"Lumber",quantity:500},{type:"Thread",quantity:500},{type:"Metal",quantity:500},{type:"Aged Wine",quantity:500},{type:"Sweater",quantity:5e3},{type:"Aged Wine",quantity:500},{type:"Cheese",quantity:5e3},{type:"Sugarcane",quantity:5e3},{type:"Strawberry",quantity:5e3},{type:"Diamond",quantity:500}];let t=[...n.inventory];for(const r of e){const e=t.findIndex((e=>e.type===r.type));-1!==e?t[e].quantity+=r.quantity:t.push({type:r.type,quantity:r.quantity}),await Et({...n,inventory:t},r.type,r.quantity,(()=>{}))}const o={...n,inventory:t};r(o),localStorage.setItem("player",JSON.stringify(o)),a(t),console.log("Get Rich: Inventory updated successfully.")}catch(e){console.error("Error performing Get Rich:",e)}},children:" Get Rich "}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{try{const e=null===n||void 0===n?void 0:n.playerId;if(!e)return void console.error("No user logged in. Cannot add skills.");const t=(await St.get("http://localhost:3001/api/resources")).data;if(!Array.isArray(t))return void console.error("Master resources are not an array:",t);const o=t.filter((e=>"skill"===e.category));if(0===o.length)return console.warn("No skill resources found."),void alert("No skill resources available to add.");const a=await St.get(`http://localhost:3001/api/skills/${e}`),l=[...a.data.skills||[]];o.forEach((e=>{const t=l.find((t=>t.type===e.type));t?t.quantity+=1:l.push({type:e.type,quantity:1})})),await St.post("http://localhost:3001/api/update-skills",{playerId:e,skills:l});const s={...n,skills:l};r(s),localStorage.setItem("player",JSON.stringify(s)),i(904),console.log("Get Skills: Added skills successfully.")}catch(e){console.error("Error adding skills:",e),alert("Failed to add skills. Check console for details.")}},children:" Get Skills "}),(0,$t.jsx)("button",{className:"btn-neutral",onClick:()=>v((e=>!e)),children:" Refresh Debug Panel "})]}),(0,$t.jsxs)("div",{className:"debug-entities",children:[(0,$t.jsx)("h3",{children:"Active NPCs:"}),d.length>0?(0,$t.jsx)("ul",{style:{listStyleType:"none",padding:0},children:d.map((e=>(0,$t.jsxs)("li",{children:[(0,$t.jsxs)("pre",{style:{background:"#f4f4f4",padding:"10px",borderRadius:"5px",overflowX:"auto"},children:[(0,$t.jsxs)("p",{children:[e.type," no. ",e.id]}),(0,$t.jsxs)("p",{children:["action: ",e.action]}),(0,$t.jsxs)("p",{children:["state: ",e.state]}),(0,$t.jsxs)("p",{children:["x: ",e.position.x]}),(0,$t.jsxs)("p",{children:["y: ",e.position.y]}),(0,$t.jsxs)("p",{children:["hp/hunger: ",e.hp]}),(0,$t.jsxs)("p",{children:["maxhp: ",e.maxhp]}),(0,$t.jsxs)("p",{children:["lastMoveTime: ",e.lastMoveTime]}),(0,$t.jsxs)("p",{children:["nextspawn: ",e.nextspawn]})]}),(0,$t.jsx)("div",{style:{margin:"10px 0"},children:["maxhp","growTime","speed","range","attackrange","armorclass","attackbonus","damage","iscamping"].map((t=>(0,$t.jsxs)("div",{style:{marginBottom:"5px"},children:[(0,$t.jsx)("label",{children:(0,$t.jsxs)("strong",{children:[t,":"]})}),(0,$t.jsx)("input",{type:"number",value:e[t]||0,onChange:n=>((e,t,n)=>{p((r=>{const o=r.map((r=>r.id===e?{...r,[t]:parseFloat(n)||0}:r)),a=En.getGridState(s);return a&&a.npcs[e]&&(a.npcs[e][t]=parseFloat(n)||0),o}))})(e.id,t,n.target.value),style:{width:"50px",textAlign:"center",marginRight:"5px"}})]},t)))})]},e.id)))}):(0,$t.jsx)("p",{children:"No active NPCs."})]}),(0,$t.jsxs)("div",{className:"debug-timers",children:[(0,$t.jsx)("h3",{children:"\ud83d\ude00 Active PCs:"}),f.length>0?(0,$t.jsx)("ul",{style:{listStyleType:"none",padding:0},children:f.map((e=>(0,$t.jsxs)("p",{children:[e.username," (",e.playerId,") Position: (",e.position.x,", ",e.position.y,") \u2764\ufe0f\u200d\ud83e\ude79 HP: ",e.hp]},e.playerId)))}):(0,$t.jsx)("p",{children:"No active PCs."})]}),(0,$t.jsxs)("div",{className:"debug-timers",children:[(0,$t.jsx)("h3",{children:"\u23f3 Active Timers:"}),c.length>0?(0,$t.jsx)("ul",{children:c.map(((e,t)=>(0,$t.jsxs)("li",{children:[e.type," at (",e.x,", ",e.y,") -",e.growEnd?` \ud83c\udf31 Farming Timer Ends in ${e.remainingTime}s`:"",e.craftedItem?` \ud83d\udee0\ufe0f ${e.craftedItem}: `:"",e.craftEnd?` Ends in ${e.remainingTime}s`:""]},t)))}):(0,$t.jsx)("p",{children:"No active timers."})]}),null!==n&&void 0!==n&&n.location?(0,$t.jsxs)("div",{className:"debug-player-location",children:[(0,$t.jsx)("h3",{children:"\ud83d\udccd Current Location:"}),(0,$t.jsxs)("p",{children:["FrontierID: ",n.location.f||"N/A"]}),(0,$t.jsxs)("p",{children:["SettlementID: ",n.location.s||"N/A"]}),(0,$t.jsxs)("p",{children:["GridID: ",n.location.g||"N/A"]}),(0,$t.jsxs)("p",{children:["GridType: ",n.location.gtype||"N/A"]})]}):(0,$t.jsx)("p",{children:"No player location data available."})]})};const dr=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r,updateStatus:a}=e;const[l,s]=(0,o.useState)([]),i=(null===n||void 0===n?void 0:n.inventory)||[],c=(null===n||void 0===n?void 0:n.backpack)||[],u=null===n||void 0===n?void 0:n.warehouseCapacity,d=null===n||void 0===n?void 0:n.backpackCapacity,[p,f]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(null!==n&&void 0!==n&&n.playerId){(async()=>{try{const e=await St.get(`http://localhost:3001/api/inventory/${n.playerId}`),t={...n,inventory:e.data.inventory||[],backpack:e.data.backpack||[]};r(t);const o=await St.get("http://localhost:3001/api/resources");s(o.data||[]),a("Inventory loaded successfully")}catch(e){console.error("Error fetching inventory or resources:",e),a("Error loading inventory")}})()}}),[t,null===n||void 0===n?void 0:n.playerId,r,a]);const h=e=>e.filter((e=>"Money"!==e.type)).reduce(((e,t)=>e+t.quantity),0),y=async()=>{if(n.location.g===n.gridId){const e=c.filter((e=>"Tent"!==e.type)),t=[...i];e.forEach((e=>{const n=t.findIndex((t=>t.type===e.type));-1!==n?t[n].quantity+=e.quantity:t.push(e)}));const o=c.filter((e=>"Tent"===e.type));await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:t,backpack:o}),r((e=>({...e,inventory:t,backpack:[]}))),a(33)}else await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,backpack:[]}),r((e=>({...e,backpack:[]}))),a(34)};return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1001",titleKey:"1101",panelName:"InventoryPanel",children:[(0,$t.jsx)("h3",{children:"\ud83c\udfda\ufe0f Warehouse"}),(0,$t.jsxs)("div",{className:"capacity-display",children:["Capacity: ",h(i),"/",u]}),(0,$t.jsx)("div",{className:"inventory-table",children:i.length>0?i.map(((e,t)=>(0,$t.jsxs)("div",{className:"inventory-row",children:[(0,$t.jsx)("div",{className:"inventory-cell name-cell",children:e.type}),(0,$t.jsx)("div",{className:"inventory-cell quantity-cell",children:e.quantity})]},t))):(0,$t.jsx)("p",{children:"Warehouse is empty."})}),(0,$t.jsx)("hr",{className:"inventory-divider"}),(0,$t.jsx)("h3",{children:"\ud83c\udf92 Backpack"}),(0,$t.jsxs)("div",{className:"capacity-display",children:["Capacity: ",h(c),"/",d]}),c.length>0&&(0,$t.jsx)("button",{className:"empty-backpack-button",onClick:()=>f(!0),children:"Manage Backpack"}),(0,$t.jsx)("br",{}),(0,$t.jsx)("br",{}),(0,$t.jsx)("div",{className:"inventory-table",children:c.length>0?c.map(((e,t)=>(0,$t.jsxs)("div",{className:"inventory-row",children:[(0,$t.jsx)("div",{className:"inventory-cell name-cell",children:e.type}),(0,$t.jsx)("div",{className:"inventory-cell quantity-cell",children:e.quantity})]},t))):(0,$t.jsx)("p",{children:"Backpack is empty."})}),p&&(()=>{const e=n.location.g===n.gridId,t=c.filter((e=>"Tent"!==e.type)),o=e&&(0===c.length||0===t.length);return(0,$t.jsxs)("div",{className:"inventory-modal",children:[(0,$t.jsx)("button",{className:"close-button",onClick:()=>f(!1),children:"\u2716"}),(0,$t.jsx)("h3",{children:e?"Add Items to Warehouse":"Discard Items"}),(0,$t.jsxs)("table",{children:[(0,$t.jsx)("thead",{children:(0,$t.jsxs)("tr",{children:[(0,$t.jsx)("th",{children:"Item"}),(0,$t.jsx)("th",{children:"Quantity"}),(0,$t.jsx)("th",{children:"Action"})]})}),(0,$t.jsx)("tbody",{children:c.map((t=>{const o=e&&"Tent"===t.type;return(0,$t.jsxs)("tr",{children:[(0,$t.jsx)("td",{children:t.type}),(0,$t.jsx)("td",{children:t.quantity}),(0,$t.jsx)("td",{children:(0,$t.jsx)("button",{className:"add-button",onClick:()=>(async e=>{if(n.location.g===n.gridId){const t=[...i],o=t.findIndex((t=>t.type===e.type));-1!==o?t[o].quantity+=e.quantity:t.push(e),await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:t,backpack:c.filter((t=>t.type!==e.type))}),r((n=>({...n,inventory:t,backpack:n.backpack.filter((t=>t.type!==e.type))}))),a(`\u2705 Moved ${e.quantity}x ${e.type} to warehouse`)}else await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,backpack:c.filter((t=>t.type!==e.type))}),r((t=>({...t,backpack:t.backpack.filter((t=>t.type!==e.type))}))),a(`\u274c Discarded ${e.quantity}x ${e.type}`)})(t),disabled:o,children:e?"Add to Warehouse":"Discard"})})]},t.type)}))})]}),(0,$t.jsx)("button",{className:"sell-button",onClick:y,disabled:o,children:e?"Add All to Warehouse":"Discard All"})]})})()]})},pr=async e=>{let{selectedItem:t,buildOptions:n,inventory:r,setInventory:o,tiles:a,resources:l,setResources:s,setErrorMessage:i,currentPlayer:c,gridId:u,setCurrentPlayer:d,updateStatus:p}=e;if(!c)return void console.warn("Current Player not provided; inventory changes will not be saved.");if(!t)return void i("Invalid building selection.");const f=c._id.toString(),h=En.getGridState(u),y=null===h||void 0===h?void 0:h.pcs[f];if(!y)return void i("Player not found in gridState.");const g=y.position;if(console.log("handleConstruction: Player position (grid-relative):",g),!g||null==g.x||null==g.y)return void i("Player position is invalid.");const m=n.find((e=>e.type===t)),v=l.some((e=>e.x===g.x&&e.y===g.y));if(v)return console.warn("Cannot build on an occupied tile."),void Mt.addFloatingText(306,g.x,g.y);const b=[...r];if(Nt(t,b)){try{await St.post("http://localhost:3001/api/update-inventory",{playerId:c.playerId,inventory:b}),console.log("Inventory successfully updated on server.")}catch(w){return console.error("Error updating inventory on server:",w),void i("Error updating inventory on server.")}if(o(b),console.log("selectedResource.action=",m.action),"npc"===m.category)En.spawnNPC(u,m,g),console.log("Spawned NPC:",u,m,g),await en(c,"Buy",m.type,1,d);else{const e={newResource:t,x:g.x,y:g.y};console.log("Placing resource on the grid:",e);try{const n=await In(u,e,s);if(Mt.addFloatingText(300,g.x,g.y),await en(c,"Build",t,1,d),await en(c,"Buy",t,1,d),null===n||void 0===n||!n.success)throw new Error("Failed to update grid resource.");s(await er(l,e)),console.log("Resource successfully added to grid and enriched.")}catch(w){return console.error("Error placing resource on grid:",w),void i("Failed to place resource on grid.")}}try{console.log("Player refreshed successfully after construction.")}catch(w){console.error("Error refreshing player after construction:",w)}}else Mt.addFloatingText(305,g.x,g.y)},fr=e=>{let{TILE_SIZE:t,resources:n,setResources:r,tiles:a,currentPlayer:l,setCurrentPlayer:s,gridId:i,setIsMoving:c,updateStatus:u}=e;const{closePanel:d}=Ot(),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{try{const e=await St.get(`http://localhost:3001/api/inventory/${l.playerId}`);m(e.data.inventory||[]);const t=(await St.get("http://localhost:3001/api/resources")).data;y(t);const n=t.filter((e=>"Build"===e.source||"BuildTown"===e.source&&"town"===l.location.gtype&&"Mayor"===l.role));f(n)}catch(e){console.error("Error fetching build panel data:",e)}})()}),[l]);return(0,$t.jsx)(At,{onClose:d,descriptionKey:"1002",titleKey:"1102",panelName:"BuildPanel",children:(0,$t.jsx)("div",{className:"standard-panel",children:p.map((e=>{const o=Dt(e,h),d=qt(e,g),f=(e=>{var t;return!e||(null===(t=l.skills)||void 0===t?void 0:t.some((t=>t.type===e)))})(e.requires),y=`\n            Costs: ${o.join(", ")||"None"}\n            ${e.requires?`<br>Requires: ${e.requires}`:""}\n          `,v=`\n            Makes: ${h.filter((t=>t.source===e.type)).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None"}\n          `;return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:y,info:v,disabled:!d||!f,onClick:()=>d&&f&&pr({selectedItem:e.type,buildOptions:p,inventory:g,setInventory:m,tiles:a,resources:n,setResources:r,setErrorMessage:console.error,currentPlayer:l,gridId:i,TILE_SIZE:t,updateStatus:u,setCurrentPlayer:s,source:"build",setIsMoving:c})},e.type)}))})})},hr=o.memo(fr),yr=e=>{let{TILE_SIZE:t,playerPosition:n,resources:r,setResources:a,tiles:l,currentPlayer:s,setCurrentPlayer:i,gridId:c,setIsMoving:u,updateStatus:d}=e;const{closePanel:p}=Ot(),[f,h]=(0,o.useState)([]),[y,g]=(0,o.useState)([]),[m,v]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{try{const e=await St.get(`http://localhost:3001/api/inventory/${s.playerId}`);v(e.data.inventory||[]);const t=(await St.get("http://localhost:3001/api/resources")).data;g(t);const n=t.filter((e=>"Buy"===e.source));h(n)}catch(e){console.error("Error fetching buy panel data:",e)}})()}),[s]);return(0,$t.jsx)(At,{onClose:p,descriptionKey:"1003",titleKey:"1103",panelName:"BuyPanel",children:(0,$t.jsx)("div",{className:"standard-panel",children:f.map((e=>{const o=Dt(e,y),p=qt(e,m),h=(e=>{var t;return!e||(null===(t=s.skills)||void 0===t?void 0:t.some((t=>t.type===e)))})(e.requires),g=`\n              Costs: ${o.join(", ")||"None"}\n              ${e.requires?`<br>Requires: ${e.requires}`:""}\n            `;return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:g,disabled:!p||!h,onClick:()=>p&&h&&pr({selectedItem:e.type,buildOptions:f,inventory:m,setInventory:v,playerPosition:n,tiles:l,resources:r,setResources:a,setErrorMessage:console.error,currentPlayer:s,gridId:c,TILE_SIZE:t,updateStatus:d,setCurrentPlayer:i,source:"buy",setIsMoving:u})},e.type)}))})})},gr=o.memo(yr),mr=e=>{let{onClose:t,currentPlayer:n,setCurrentPlayer:r,stationType:a}=e;const[l,s]=(0,o.useState)(a||"Skills Panel"),[i,c]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]),[v,b]=(0,o.useState)([]),[w,x]=(0,o.useState)(""),[S,k]=(0,o.useState)(!1),{updateStatus:C}=(0,o.useContext)(zt),[E,I]=(0,o.useState)("\ud83d\udcd8"),[N,j]=(0,o.useState)(0);(0,o.useEffect)((()=>{a?a!==l&&s(a):s("Basic Skills")}),[a]),(0,o.useEffect)((()=>{(async()=>{k(!0);try{console.log("Fetching skills and inventory for:",l);const[e,t,r]=await Promise.all([St.get(`http://localhost:3001/api/inventory/${n.playerId}`),St.get(`http://localhost:3001/api/skills/${n.playerId}`),St.get("http://localhost:3001/api/resources")]),o=e.data.inventory||[],s=t.data.skills||[],i=r.data;b(o),c(i);const u=i.find((e=>e.type===a));I((null===u||void 0===u?void 0:u.symbol)||"\u2699\ufe0f");const p=s.filter((e=>i.some((t=>t.type===e.type&&"skill"===t.category))));y(p);const h=s.filter((e=>i.some((t=>t.type===e.type&&"upgrade"===t.category))));m(h);const g=i.filter((e=>"skill"===e.category&&e.source===l&&!p.some((t=>t.type===e.type)))),v=i.filter((e=>"upgrade"===e.category&&e.source===l&&!h.some((t=>t.type===e.type))));d(g),f(v)}catch(e){console.error("Error fetching resources, inventory, or skills:",e)}finally{k(!1)}})()}),[l,N]);const P=e=>!e||h.some((t=>t.type===e))||g.some((t=>t.type===e)),T=async e=>{x("");const t=[...u,...p].find((t=>t.type===e));if(!qt(t,v,1))return void x("Not enough resources to purchase this item.");const o=[...v],a=[...h],l=[...g];for(let n=1;n<=3;n++){const e=t[`ingredient${n}`],r=t[`ingredient${n}qty`];if(e&&r){const t=o.findIndex((t=>t.type===e));o[t].quantity-=r,o[t].quantity<=0&&o.splice(t,1)}}"skill"===t.category?a.push({type:t.type,category:t.category,quantity:1}):"upgrade"===t.category&&l.push({type:t.type,category:t.category,quantity:1}),y(a),m(l),b(o),localStorage.setItem("inventory",JSON.stringify(o)),Mt.addFloatingText(`+1 ${t.type}`,window.innerWidth/12,window.innerHeight/4);try{if(await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:o}),await St.post("http://localhost:3001/api/update-skills",{playerId:n.playerId,skills:[...a,...l]}),t.output)if(console.log(`Upgrade ${t.type} will modify player stat ${t.output}.`),s=t.output,new Set(["damage","armorclass","hp","maxhp","attackbonus","attackrange","speed","iscamping"]).has(s))await Jt(t.output,t.qtycollected||1,n.playerId,n.location.g);else{const e=await(async(e,t,n)=>{try{if(console.log("\ud83d\udd04 Modifying player stats in the Player Profile (DB)"),console.log("statToMod = ",e,"; amountToMod = ",t),!e||!t)return console.error("\u274c Invalid stat or amount to modify."),null;const r=(await St.get(`http://localhost:3001/api/player/${n}`)).data;if(!r||!r.playerId)return console.error("\u274c Failed to fetch current player data from the server."),null;const o=r[e]||0,a=o+t;return console.log(`\u2705 Updating ${e}: ${o} + ${t} = ${a}`),await St.post("http://localhost:3001/api/update-profile",{playerId:n,updates:{[e]:a}}),console.log(`\u2705 Successfully updated ${e} in the database.`),r[e]=a,r}catch(r){return console.error("\u274c Error in modifyPlayerStatsInPlayer:",r),null}})(t.output,t.qtycollected||1,n.playerId);e&&(r(e),localStorage.setItem("player",JSON.stringify(e)))}await en(n,"Gain skill with",t.type,1,r),await It(n.playerId,r),j((e=>e+1))}catch(i){console.error("Error updating player on server:",i),x("Error updating player on server.")}var s};return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1005",titleKey:"1105",panelName:"SkillsAndUpgradesPanel",children:(0,$t.jsxs)("div",{className:"standard-panel",children:[(0,$t.jsxs)("h3",{children:[E," ",l]})," ",S?(0,$t.jsx)("p",{children:"Loading..."}):(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsxs)("div",{className:"skills-owned",children:[(0,$t.jsx)("h3",{children:"Skills you have:"}),h.length>0?h.map(((e,t)=>(0,$t.jsx)("div",{children:e.type},t))):(0,$t.jsx)("p",{children:"No skills acquired yet."})]}),(0,$t.jsxs)("div",{className:"upgrades-owned",children:[(0,$t.jsx)("h3",{children:"Upgrades you have:"}),g.length>0?g.map(((e,t)=>(0,$t.jsx)("div",{children:e.type},t))):(0,$t.jsx)("p",{children:"No upgrades acquired yet."})]}),(0,$t.jsxs)("div",{className:"skills-to-acquire",children:[(0,$t.jsx)("h3",{children:"Skills to Purchase:"}),(0,$t.jsx)("div",{className:"skills-options",children:u.map((e=>{const t=Dt(e,i),n=qt(e,v,1),r=P(e.requires),o=`\n                    Costs: ${t.join(", ")||"None"}\n                    ${e.requires?`<br>Requires: ${e.requires}`:""}\n                  `,a=e.output?`+${e.qtycollected||1} to ${Tt[e.output]||e.output}`:null,l=i.filter((t=>t.requires===e.type)).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None",s=(0,$t.jsxs)("div",{className:"info-content",children:[a&&(0,$t.jsx)("div",{children:a}),"None"!==l&&(0,$t.jsxs)("div",{style:{display:"block",marginBottom:"3px"},children:[(0,$t.jsx)("strong",{children:"Unlocks:"})," ",l]})]});return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:o,info:s,disabled:!n||!r,onClick:()=>T(e.type)},e.type)}))})]}),(0,$t.jsxs)("div",{className:"upgrades-to-acquire",children:[(0,$t.jsx)("h3",{children:"Upgrades to Purchase:"}),(0,$t.jsx)("div",{className:"skills-options",children:p.map((e=>{const t=Dt(e,i),n=qt(e,v,1),r=P(e.requires),o=`\n                    Costs: ${t.join(", ")||"None"}\n                    ${e.requires?`<br>Requires: ${e.requires}`:""}\n                  `,a=e.output?`+${e.qtycollected||1} to ${Tt[e.output]||e.output}`:null,l=i.filter((t=>t.requires===e.type)).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None",s=(0,$t.jsxs)("div",{className:"info-content",children:[a&&(0,$t.jsx)("div",{children:a}),"None"!==l&&(0,$t.jsxs)("div",{style:{display:"block",marginBottom:"3px"},children:[(0,$t.jsx)("strong",{children:"Unlocks:"})," ",l]})]});return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:o,info:s,disabled:!n||!r,onClick:()=>T(e.type)},e.type)}))})]})]}),w&&(0,$t.jsx)("p",{className:"error-message",children:w})]})})},vr=o.memo(mr),br=async e=>{let{selectedItem:t,TILE_SIZE:n,resources:r,setResources:o,tiles:a,tileTypes:l,setTileTypes:s,currentPlayer:i,setCurrentPlayer:c,inventory:u,setInventory:d,gridId:p}=e;const f=En.getGridState(p);console.log("Farming: selectedItem: ",t),console.log("Farming: gridState: ",f),console.log("Farming: currentPlayer: ",i);const h=null===f||void 0===f?void 0:f.pcs[i.playerId];if(!h)return void console.warn("Player not found in gridState.");const y={x:h.position.x*n,y:h.position.y*n};if(!y||null==y.x||null==y.y)return void console.warn("Player position is invalid.");const g=Math.floor(y.x/n),m=Math.floor(y.y/n);try{const e=await async function(e,t,n){try{console.log(`Validating tile type at (${t}, ${n}) in grid ${e}`);const r=await St.get(`http://localhost:3001/api/get-tile/${e}/${t}/${n}`);return console.log(`Tile type at (${t}, ${n}):`,r.data.tileType),r.data.tileType}catch(r){throw console.error(`Error fetching tile type at (${t}, ${n}) in grid ${e}:`,r),r}}(p,g,m);if("d"!==e)return void Mt.addFloatingText(303,y.x+25,y.y+10);const n=r.find((e=>e.x===g&&e.y===m));if(n)return void Mt.addFloatingText(304,y.x+25,y.y+10);const a=[...u];if(!Nt(t.type,a))return void Mt.addFloatingText(305,y.x+25,y.y+10);await St.post("http://localhost:3001/api/update-inventory",{playerId:i.playerId,inventory:a}),d(a);const l=Date.now()+1e3*t.growtime,s={newResource:t.type,x:g,y:m,growEnd:l};try{const e=await In(p,s,o);if(null===e||void 0===e||!e.success)throw new Error("Failed to update grid resource.");rr.addSeed({type:t.type,x:g,y:m,growEnd:l});o(await er(r,s)),Mt.addFloatingText(302,y.x+20,y.y+10)}catch(v){console.error("Error planting seed:",v)}}catch(v){console.error("Error planting seed:",v)}},wr=async e=>{let{actionType:t,TILE_SIZE:n,setTileTypes:r,getCurrentTileTypes:o,gridId:a,currentPlayer:l}=e;const s=En.getGridState(a),i=null===s||void 0===s?void 0:s.pcs[l.playerId];if(!i)return void console.warn("Player not found in gridState.");const c=i.position.x,u=i.position.y;try{const e="till"===t?"d":"plantGrass"===t?"g":null;if(!e)return void console.error("Invalid actionType provided to handleTerraform.");await async function(e,t,n,r,o,a){const l=a();o((e=>{const o=[...e];return o[n][t]=r,o}));try{console.log(`Converting tile at (${t}, ${n}) to ${r} on the server.`);const o=await St.patch(`http://localhost:3001/api/update-tile/${e}`,{x:t,y:n,tileType:r});return console.log("Tile converted successfully on the server:",o.data),o.data}catch(s){throw console.error("Error converting tile type on the server:",s),o((()=>l)),s}}(a,c,u,e,r,o),r((t=>{const n=[...t];return n[u][c]=e,n})),console.log(`Successfully changed tile at (${c}, ${u}) to ${e}`)}catch(d){console.error(`Error performing ${t} action:`,d)}},xr=e=>{let{TILE_SIZE:t,resources:n,setResources:r,tiles:a,tileTypes:l,setTileTypes:s,currentPlayer:i,setCurrentPlayer:c,gridId:u}=e;console.log("Farming Panel: currentPlayer: ",i);const{closePanel:d}=Ot(),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]),{updateStatus:v}=(0,o.useContext)(zt),b=()=>[...a.map((e=>[...e]))];(0,o.useEffect)((()=>{w()}),[]);const w=async()=>{try{const e=await St.get(`http://localhost:3001/api/inventory/${i.playerId}`);m(e.data.inventory||[]);const t=(await St.get("http://localhost:3001/api/resources")).data;y(t);const n=t.filter((e=>"farmplot"===e.category));f(n)}catch(e){console.error("Error fetching farming panel data:",e)}},x=e=>{var t;return!e||(null===(t=i.skills)||void 0===t?void 0:t.some((t=>t.type===e)))};return(0,$t.jsx)(At,{onClose:d,descriptionKey:"1004",titleKey:"1104",panelName:"FarmingPanel",children:(0,$t.jsxs)("div",{className:"standard-panel",children:[(0,$t.jsx)(Lt,{symbol:"\u26cf\ufe0f",name:"Till Land",details:"Costs: None<br>Requires: Pickaxe",disabled:!x("Pickaxe"),info:"Makes: Dirt",onClick:()=>wr({actionType:"till",TILE_SIZE:t,setTileTypes:s,getCurrentTileTypes:b,gridId:u,currentPlayer:i})}),(0,$t.jsx)(Lt,{symbol:"\ud83d\udfe9",name:"Plant Grass",details:"Costs: None<br>Requires: Grower",disabled:!x("Grower"),info:"Makes: Grass",onClick:()=>wr({actionType:"plantGrass",TILE_SIZE:t,setTileTypes:s,getCurrentTileTypes:b,gridId:u,currentPlayer:i})}),p.map((e=>{const o=Dt(e,h),d=qt(e,g,1),p=x(e.requires),f=`\n              Costs: ${o.join(", ")||"None"}\n              ${e.requires?`<br>Requires: ${e.requires}`:""}\n            `,y=`\n              Makes: ${h.filter((t=>t.source===e.type)).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None"}\n            `;return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,details:f,info:y,disabled:!d||!p,onClick:()=>d&&p&&br({selectedItem:e,TILE_SIZE:t,resources:n,setResources:r,tiles:a,tileTypes:l,setTileTypes:s,currentPlayer:i,setCurrentPlayer:c,inventory:g,setInventory:m,gridId:u})},e.type)}))]})})},Sr=o.memo(xr),kr=(0,o.memo)((e=>{let{onClose:t}=e;return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1018",titleKey:"1118",panelName:"HowToPanel",children:(0,$t.jsxs)("div",{className:"panel-content",children:[(0,$t.jsx)("p",{children:"Welcome to Valley View!"}),(0,$t.jsx)("h2",{children:"What\u2019s it about? "}),(0,$t.jsx)("p",{children:"Valley view is a game that explores how people might self organize and create micro societies in a world of asymmetric resources and interdependence, with both owned and shared spaces."}),(0,$t.jsxs)("p",{children:["While there are no explicit specialization paths, there are three main vectors of play which are interdependent. These are: the ",(0,$t.jsx)("strong",{children:"Farmer"}),", the ",(0,$t.jsx)("strong",{children:"Adventurer"}),", and the"," ",(0,$t.jsx)("strong",{children:"Politician"}),". You are encouraged to lean upon each other."]}),(0,$t.jsx)("h3",{children:"First, the basics:"}),(0,$t.jsxs)("p",{children:["Use A-W-S-D keys to ",(0,$t.jsx)("strong",{children:"Move"}),". Click to interact with things that are within your interaction radius."]}),(0,$t.jsxs)("p",{children:["Explore ",(0,$t.jsx)("strong",{children:"Farming"}),", ",(0,$t.jsx)("strong",{children:"Build"}),", and ",(0,$t.jsx)("strong",{children:"Buy"})," to improve your Homestead and generate resources."]}),(0,$t.jsxs)("p",{children:["Generate ",(0,$t.jsx)("strong",{children:"Money"})," at the ",(0,$t.jsx)("strong",{children:"Trade Stall"}),". Post resources for sale to other players, or sell them to the game for 50% of their value."]}),(0,$t.jsx)("h3",{children:"More:"}),(0,$t.jsxs)("p",{children:["As you create wealth, improve yourself with ",(0,$t.jsx)("strong",{children:"Skills"})," and ",(0,$t.jsx)("strong",{children:"Upgrades"}),". For example, purchase a ",(0,$t.jsx)("strong",{children:"Horse Skill"})," to travel to ",(0,$t.jsx)("strong",{children:"Town"}),"."]}),(0,$t.jsxs)("p",{children:["Zoom out ",(0,$t.jsx)("strong",{children:"(- and +)"})," to see how big the world is. Your Homestead is one of many in a"," ",(0,$t.jsx)("strong",{children:"Settlement"}),". Each Settlement has a shared Town. Your Settlement is one of many in the"," ",(0,$t.jsx)("strong",{children:"Frontier"}),"."]}),(0,$t.jsxs)("p",{children:["When you are ready, explore the ",(0,$t.jsx)("strong",{children:"Valley"}),", which is full of danger and wonder. A single"," ",(0,$t.jsx)("strong",{children:"Wizard"})," can be found in the Valley for the entire Frontier."]}),(0,$t.jsx)("h3",{children:"Your Goals:"}),(0,$t.jsxs)("p",{children:["Feel free to create your own goals. Also, at the end of each ",(0,$t.jsx)("strong",{children:"Season"}),", which runs three months, both individuals and settlements will be ranked, and top placement generates additional wealth. Some of your wealth will carry over into the next Season."]}),(0,$t.jsx)("p",{children:"Farm, craft, trade, explore, fight, and enjoy!"})]})})}));const Cr=function(e){let{onClose:t,currentPlayer:n}=e;const[r,a]=(0,o.useState)(null),[l,s]=(0,o.useState)(""),[i,c]=(0,o.useState)([]),[u,d]=(0,o.useState)({}),[p,f]=(0,o.useState)(0),[h,y]=(0,o.useState)(0);return(0,o.useEffect)((()=>{(async()=>{if(n&&n.settlementId)try{var e;console.log("\ud83c\udfdb\ufe0f Fetching full settlement data for ID:",n.settlementId);const t=(await St.get(`http://localhost:3001/api/get-settlement/${n.settlementId}`)).data;a(t),c(t.roles||[]),f(t.taxrate||0);const r=((null===(e=t.grids)||void 0===e?void 0:e.flat())||[]).filter((e=>"homestead"===e.gridType&&!1===e.available)).length||0;y(r);const o=t.roles.map((e=>({roleName:e.roleName,playerId:e.playerId})));console.log("\u2705 Extracted roleEntries:",o);const l=o.map((async e=>{let{roleName:t,playerId:n}=e;if(!n||"Vacant"===n)return{roleName:t,username:"Vacant"};try{return{roleName:t,username:(await St.get(`http://localhost:3001/api/player/${n}`)).data.username}}catch(r){return console.error(`\u274c Error fetching player for ${t}:`,r),{roleName:t,username:"Error"}}})),s=await Promise.all(l),i={};s.forEach((e=>{let{roleName:t,username:n}=e;i[t]=n})),d(i)}catch(t){console.error("\u274c Error fetching government data:",t)}else console.warn("\u26a0\ufe0f currentPlayer or settlementId is not available yet.")})()}),[n]),(0,$t.jsx)(At,{onClose:t,descriptionKey:"1007",titleKey:"1107",panelName:"GovPanel",children:(0,$t.jsxs)("div",{className:"panel-content",children:[l&&(0,$t.jsx)("p",{className:"error-message",children:l}),r&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("p",{children:(0,$t.jsx)("strong",{children:"Your Settlement: "})}),(0,$t.jsx)("h3",{children:r.name}),(0,$t.jsxs)("h3",{children:["\ud83d\ude0a Pop. ",(0,$t.jsx)("strong",{children:h})]})]}),(0,$t.jsxs)("h3",{children:["\ud83d\udcb0 Tax Rate: ",p,"%"]}),(0,$t.jsx)("p",{children:"The tax rate is set by the Mayor, for this Settlement, and a percentage of all taxes collected are added to the Mayor's account."}),(0,$t.jsx)("p",{children:"Mayors are elected at the Courthouse in Town."}),(0,$t.jsx)("h3",{children:"\ud83c\udfdb\ufe0f Government Officials"}),(0,$t.jsx)("div",{children:i.length>0?i.map(((e,t)=>(0,$t.jsxs)("p",{children:[(0,$t.jsxs)("strong",{children:[e.roleName,":"]})," ",u[e.roleName]||"Vacant"]},t))):(0,$t.jsx)("p",{children:"No government officials elected yet."})}),(0,$t.jsx)("h3",{children:"\ud83c\udfdb\ufe0f Roles & Responsibilities:"}),(0,$t.jsx)("p",{children:"Only the Mayor can build Schools, Hospitals and Animal Yards in the Town. "}),(0,$t.jsx)("p",{children:"\ud83c\udfeb Schools give citizens access to certain Skills that cannot be gained elsewhere. "}),(0,$t.jsx)("p",{children:"\ud83c\udfe5 Hospitals supply Doctors, who can heal adventurers returning from the Valley. "}),(0,$t.jsx)("p",{children:"\ud83d\udc3e Animal Yards supply unique livestock, which can be transported back to Homesteads by any player. "}),(0,$t.jsx)("p",{children:"\ud83d\ude82 The Mayor can influence demand for goods at the Train. "})]})})};const Er=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r,updateStatus:a}=e;const[l,s]=(0,o.useState)([]),[i,c]=(0,o.useState)(""),[u,d]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{if(null!==n&&void 0!==n&&n.frontierId)try{var e,t;const r=await St.get(`http://localhost:3001/api/get-frontier/${n.frontierId}`);s((null===(e=r.data.bank)||void 0===e?void 0:e.offers)||[]);const o=null!==(t=r.data.bank)&&void 0!==t&&t.endTime?new Date(r.data.bank.endTime).getTime():null,a=()=>{const e=Date.now();c(p(o,e))};a();const l=setInterval(a,1e3);return()=>clearInterval(l)}catch(r){console.error("\u274c Error fetching bank offers:",r)}})(),(async()=>{try{const e=await St.get("http://localhost:3001/api/resources");d(e.data||[])}catch(e){console.error("\u274c Error fetching master resources:",e)}})()}),[n]);const p=(e,t)=>{if(!e||t>=e)return"Updating...";const n=Math.floor((e-t)/1e3),r=Math.floor(n/60)%60,o=Math.floor(n/3600)%24;return`${Math.floor(n/86400)}d ${o}h ${r}m ${n%60}s`},f=e=>{const t=u.find((t=>t.type===e));return(null===t||void 0===t?void 0:t.symbol)||"\u2753"};return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1017",titleKey:"1117",panelName:"BankPanel",children:[(0,$t.jsx)("h3",{children:"Offers Update in"}),(0,$t.jsx)("h2",{children:i}),l.length>0?l.map(((e,t)=>(0,$t.jsx)(Lt,{className:"resource-button",onClick:()=>(async e=>{if(!e||!n)return;if(!Nt({type:e.itemBought,quantity:e.qtyBought},n.inventory))return void a(`\u274c Not enough ${e.itemBought}`);const t=[...n.inventory].map((t=>t.type===e.itemBought?{...t,quantity:t.quantity-e.qtyBought}:t)).filter((e=>e.quantity>0)),o=t.findIndex((t=>t.type===e.itemGiven));o>=0?t[o].quantity+=e.qtyGiven:t.push({type:e.itemGiven,quantity:e.qtyGiven}),await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:t}),r((e=>({...e,inventory:t}))),a(`\u2705 Exchanged ${e.qtyBought} ${e.itemBought} for ${e.qtyGiven} ${e.itemGiven}`)})(e),disabled:!n.inventory.some((t=>t.type===e.itemBought&&t.quantity>=e.qtyBought)),hideInfo:!0,children:(0,$t.jsxs)("div",{className:"resource-details",children:[(0,$t.jsxs)("span",{children:[(0,$t.jsx)("strong",{children:"Will buy"})," "]}),f(e.itemBought)," ",e.itemBought," x",e.qtyBought,(0,$t.jsx)("br",{}),"for ",f(e.itemGiven)," ",e.qtyGiven]})},t))):(0,$t.jsx)("p",{children:"Waiting..."})]})};const Ir=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r,updateStatus:a}=e;const[l,s]=(0,o.useState)([]),[i,c]=(0,o.useState)("loading"),[u,d]=(0,o.useState)("\u23f3"),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]);(0,o.useEffect)((()=>{null!==n&&void 0!==n&&n.settlementId&&(v(),b())}),[n]),(0,o.useEffect)((()=>{null!==n&&void 0!==n&&n.settlementId&&v()}),[i]),(0,o.useEffect)((()=>{const e=()=>{const e=Date.now(),t=(JSON.parse(localStorage.getItem("timers"))||{}).train||{},n=t.endTime,r=t.phase;if(!n||isNaN(n))return d("N/A"),void c("unknown");const o=Math.max(0,Math.floor((n-e)/1e3)),a=Math.floor(o/3600),l=Math.floor(o%3600/60),s=o%60;c(r||"unknown"),d(`${a}h ${l}m ${s}s`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[]);const v=async()=>{try{var e,t,r;const o=await St.get(`http://localhost:3001/api/get-settlement/${n.settlementId}`);s((null===(e=o.data)||void 0===e?void 0:e.currentoffers)||[]),y((null===(t=o.data)||void 0===t?void 0:t.nextoffers)||[]),m((null===(r=o.data)||void 0===r?void 0:r.trainrewards)||[])}catch(o){console.error("\u274c Error fetching train offers:",o)}},b=async()=>{try{const e=await St.get("http://localhost:3001/api/resources");f(e.data||[])}catch(e){console.error("\u274c Error fetching resources:",e)}},w=e=>{var t;return(null===(t=p.find((t=>t.type===e)))||void 0===t?void 0:t.symbol)||"\u2753"},x=(e,t)=>t.length?(0,$t.jsxs)("div",{className:"offer-section",children:[(0,$t.jsx)("h4",{children:e}),t.map(((e,t)=>{const o=e.claimedBy===n.playerId,l=e.filled,i=n.inventory.some((t=>t.type===e.itemBought&&t.quantity>=e.qtyBought));return(0,$t.jsx)(Lt,{className:"train-offer-card",onClick:()=>l?null:o?(async e=>{if(!e||e.claimedBy!==n.playerId)return;if(!Nt({type:e.itemBought,quantity:e.qtyBought},n.inventory))return void a(`\u274c Not enough ${e.itemBought}`);const t=[...n.inventory].map((t=>t.type===e.itemBought?{...t,quantity:t.quantity-e.qtyBought}:t)).filter((e=>e.quantity>0)),o=t.findIndex((e=>"Money"===e.type));o>=0?t[o].quantity+=e.qtyGiven:t.push({type:"Money",quantity:e.qtyGiven});try{await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:t}),await St.post(`http://localhost:3001/api/update-train-offer/${n.settlementId}`,{updateOffer:{...e,filled:!0}}),r((e=>({...e,inventory:t}))),a(`\u2705 Delivered ${e.qtyBought} ${e.itemBought}, received ${e.qtyGiven} Money`),Mt.addFloatingText(`+${e.qtyGiven} \ud83d\udcb0`,window.innerWidth/10,window.innerHeight/4),s((t=>t.map((t=>t===e?{...t,filled:!0}:t))))}catch(l){console.error("\u274c Error fulfilling offer:",l)}})(e):e.claimedBy?null:(async e=>{if(e&&!e.claimedBy)try{await St.post(`http://localhost:3001/api/update-train-offer/${n.settlementId}`,{updateOffer:{...e,claimedBy:n.playerId}}),s((t=>t.map((t=>t===e?{...t,claimedBy:n.playerId}:t))))}catch(t){console.error("\u274c Error claiming train offer:",t)}})(e),disabled:l||!o&&e.claimedBy||o&&!i,children:(0,$t.jsxs)("div",{className:"offer-details",children:[(0,$t.jsxs)("span",{children:[w(e.itemBought)," ",e.itemBought," x",e.qtyBought]}),(0,$t.jsx)("br",{}),(0,$t.jsxs)("span",{children:[w(e.itemGiven)," ",e.qtyGiven]}),(0,$t.jsx)("br",{}),l?(0,$t.jsx)("span",{className:"checkmark",children:"\u2705 Completed"}):o&&i?(0,$t.jsx)("span",{className:"fulfilled-label",children:"Click to fulfill"}):o?(0,$t.jsx)("span",{className:"fulfilled-label",children:"Your Order"}):e.claimedBy?(0,$t.jsx)("span",{className:"claimed-label",children:"Claimed"}):(0,$t.jsx)("span",{className:"claim-label",children:"Claim Order"})]})},t)}))]}):null,S=l.filter((e=>e.claimedBy===n.playerId&&!e.filled)),k=l.filter((e=>!e.claimedBy)),C=l.filter((e=>e.claimedBy&&e.claimedBy!==n.playerId&&!e.filled)),E=l.filter((e=>e.filled)),I=("departing"===i||"arriving"===i)&&(l.length>0&&l.every((e=>e.filled)));return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1022",titleKey:"1122",panelName:"TrainPanel",children:[(0,$t.jsxs)("h3",{children:["Train is ",i]}),(0,$t.jsxs)("h2",{children:["\u23f3 ",u]}),"loading"===i&&(0,$t.jsxs)($t.Fragment,{children:[(()=>{if(!g.length||"loading"!==i)return null;const e=new Set,t=g.filter((t=>!e.has(t.item)&&(e.add(t.item),!0)));return(0,$t.jsxs)("div",{className:"reward-section",children:[(0,$t.jsx)("h4",{children:"\ud83c\udf81 Rewards for filling all orders:"}),(0,$t.jsx)("ul",{className:"reward-list",children:t.map(((e,t)=>(0,$t.jsxs)("li",{children:[w(e.item)," ",e.item]},t)))})]})})(),x("Claimed by you:",S),x("Available to claim:",k),x("Claimed by others:",C),x("Completed:",E)]}),I&&(0,$t.jsx)("div",{className:"train-rewards-banner",children:"\u2705 All orders were completed! Rewards have been mailed out."}),("loading"===i||"departing"===i)&&(()=>{if(!["loading","departing"].includes(i))return null;if(!h.length)return null;const e=new Set,t=h.filter((t=>!e.has(t.itemBought)&&(e.add(t.itemBought),!0)));return(0,$t.jsxs)("div",{className:"next-shipment-preview",children:[(0,$t.jsx)("h4",{children:"\ud83d\udce6 Next Shipment Preview:"}),(0,$t.jsx)("ul",{children:t.map(((e,t)=>(0,$t.jsxs)("li",{children:[w(e.itemBought)," ",e.itemBought]},t)))})]})})()]})},Nr=e=>{let{onClose:t,currentPlayer:n}=e;const[r,a]=(0,o.useState)(null),[l,s]=(0,o.useState)(0),[i,c]=(0,o.useState)(!1),[u,d]=(0,o.useState)(""),[p,f]=(0,o.useState)(""),{updateStatus:h}=(0,o.useContext)(zt),[y,g]=(0,o.useState)([]),[m,v]=(0,o.useState)(""),[b,w]=(0,o.useState)(null),[x,S]=(0,o.useState)(!1),[k,C]=(0,o.useState)([]),[E,I]=(0,o.useState)(0),N=async()=>{try{var e;console.log(`\ud83c\udfdb\ufe0f Fetching election & settlement data for Frontier: ${n.frontierId}, Settlement: ${n.settlementId}`);const r=(await St.get(`http://localhost:3001/api/get-settlement/${n.settlementId}`)).data;a(r),s(r.taxrate||0),I(r.taxrate||0),g(r.campaignPromises||[]);const o=(null===(e=(JSON.parse(localStorage.getItem("timers"))||{}).elections)||void 0===e?void 0:e.phase)||"Administration";d(o),console.log("\u2705 Election Phase (From Local Storage):",o),"Counting"===o?(console.log("\ud83d\uddf3\ufe0f Election ended. Clearing campaign promises and votes..."),await St.post("http://localhost:3001/api/reset-election-votes",{settlementId:n.settlementId}),g([]),C([])):g(r.campaignPromises||[]);const l=r.roles.find((e=>"Mayor"===e.roleName));if(c(l&&l.playerId.toString()===n._id.toString()),"Voting"===o){var t;const e=(null===(t=r.campaignPromises)||void 0===t?void 0:t.reduce(((e,t)=>(e.find((e=>e.playerId===t.playerId))||e.push({playerId:t.playerId,username:t.username}),e)),[]))||[];console.log("\u2705 Voting Candidates:",e),C(e)}}catch(r){console.error("\u274c Error fetching election or settlement data:",r)}};(0,o.useEffect)((()=>{N();const e=setInterval(N,1e3);return()=>clearInterval(e)}),[n.frontierId,n.settlementId]),(0,o.useEffect)((()=>{const e=()=>{var e;const t=Date.now(),n=null===(e=(JSON.parse(localStorage.getItem("timers"))||{}).elections)||void 0===e?void 0:e.endTime;if(!n||isNaN(n))return void f("N/A");const r=Math.max(0,Math.floor((n-t)/1e3)),o=Math.floor(r/3600),a=Math.floor(r%3600/60);f(`${o}h ${a}m ${r%60}s`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[]);return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1012",titleKey:"1112",panelName:"Courthouse",children:(0,$t.jsx)("div",{className:"panel-content courthouse-panel",children:(0,$t.jsxs)("div",{className:"debug-buttons",children:[(0,$t.jsxs)("h1",{children:[" ",i&&(0,$t.jsx)("p",{children:"Welcome, Mayor."})," "]}),(0,$t.jsxs)("h2",{children:["\ud83d\udcb0 Tax Rate: ",l,"%"]}),i?(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("input",{type:"range",min:"0",max:"20",value:E,onChange:e=>I(Number(e.target.value))}),(0,$t.jsxs)("p",{children:["Proposed Tax Rate: ",E,"%"]}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{if(i)try{console.log(`\ud83d\udcbe Saving new tax rate: ${E}%`);const e=await St.post("http://localhost:3001/api/update-settlement",{settlementId:n.settlementId,updates:{taxrate:E}});e.data.success?(console.log("\u2705 Tax rate updated successfully."),h(`\u2705 Tax rate set to ${E}%`),s(E)):(console.error("\u274c Failed to update tax rate:",e.data.error),h("\u274c Error updating tax rate."))}catch(e){console.error("\u274c Error saving tax rate:",e),h("\u274c Failed to save tax rate.")}},children:"Update Tax Rate"})]}):(0,$t.jsx)("p",{children:"\u26a0\ufe0f Only the Mayor can set the tax rate."}),(0,$t.jsx)("br",{}),(0,$t.jsx)("h2",{children:"\ud83d\uddf3\ufe0f Elections"}),(0,$t.jsxs)("p",{children:[(0,$t.jsx)("strong",{children:"Current Phase:"})," ",u]}),(0,$t.jsx)("p",{children:(0,$t.jsx)("strong",{children:"Next Phase Begins In:"})}),(0,$t.jsx)("p",{children:p}),"Campaigning"===u&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("h3",{children:"\ud83d\udce2 Campaign Promises"}),(0,$t.jsx)("div",{className:"campaign-promises",children:y.length>0?y.map(((e,t)=>(0,$t.jsxs)("div",{className:"campaign-entry",children:[(0,$t.jsxs)("strong",{children:[e.username,":"]})," ",e.text]},t))):(0,$t.jsx)("p",{children:"No one has made a campaign promise yet."})}),!y.some((e=>e.playerId===n._id))&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("textarea",{value:m,onChange:e=>v(e.target.value),placeholder:"Enter your campaign promise (max 200 characters)..."}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{if(m.trim())if(m.length>200)h("Campaign promises cannot exceed 200 characters.");else try{const e=await St.post("http://localhost:3001/api/save-campaign-promise",{settlementId:n.settlementId,playerId:n._id,username:n.username,text:m});e.data.message&&(console.log(`\ud83d\udce2 ${e.data.message}`),h("\u2705 Campaign promise submitted."),g(e.data.campaignPromises),v(""))}catch(e){console.error("\u274c Error submitting campaign promise:",e),h("\u274c Failed to submit campaign promise.")}},children:"Submit Campaign Promise"})]})]}),"Voting"===u&&!x&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("h3",{children:"Cast Your Vote"}),k.length>0?k.map(((e,t)=>(0,$t.jsxs)("div",{children:[(0,$t.jsx)("input",{type:"radio",name:"vote",value:e.playerId,onChange:()=>{console.log(`\ud83d\udd0d Selected Candidate: ${e.username} (${e.playerId})`),w(e.playerId)}}),e.username]},e.playerId||t))):(0,$t.jsx)("p",{children:"No candidates available for voting."}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{if(b)try{const e=await St.post("http://localhost:3001/api/cast-vote",{settlementId:n.settlementId,voterId:n._id,candidateId:b});e.data.message&&(console.log(`\ud83d\uddf3\ufe0f ${e.data.message}`),h("\u2705 Vote successfully cast."),S(!0),N())}catch(e){console.error("\u274c Error casting vote:",e),"Already voted."===e.response.data.error?h("\u274c You already voted."):h("\u274c Failed to cast vote.")}},disabled:!b,children:"Cast Your Vote"})]})]})})})};const jr=function(e){let{onClose:t,currentPlayer:n}=e;const[r,a]=(0,o.useState)([]);return(0,o.useEffect)((()=>{null!==n&&void 0!==n&&n.activeQuests&&a(n.activeQuests)}),[n]),(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1006",titleKey:"1106",panelName:"QuestPanel",children:[(!r||0===r.length)&&(0,$t.jsx)("p",{children:"No active quests at the moment."}),(0,$t.jsx)("div",{className:"standard-panel",children:r.map(((e,t)=>{var n,r,o;return(0,$t.jsx)(Ut,{className:"resource-button "+(e.completed?"reward":"in-progress"),quest:{symbol:e.symbol,title:e.questId,completed:e.completed,goals:[{action:e.goal1action,item:e.goal1item,qty:e.goal1qty,progress:(null===(n=e.progress)||void 0===n?void 0:n.goal1)||0},{action:e.goal2action,item:e.goal2item,qty:e.goal2qty,progress:(null===(r=e.progress)||void 0===r?void 0:r.goal2)||0},{action:e.goal3action,item:e.goal3item,qty:e.goal3qty,progress:(null===(o=e.progress)||void 0===o?void 0:o.goal3)||0}]},state:e.completed?"reward":"in-progress",onClick:null},t)}))})]})},Pr=e=>{let{onClose:t,inventory:n,setInventory:r,backpack:a,setBackpack:l,currentPlayer:s,setCurrentPlayer:i,setResources:c,stationType:u,currentStationPosition:d,gridId:p}=e;const[f,h]=(0,o.useState)([]),[y,g]=(0,o.useState)([]),[m,v]=(0,o.useState)(""),[b,w]=(0,o.useState)("\ud83d\uded6"),{updateStatus:x}=(0,o.useContext)(zt),[S,k]=(0,o.useState)(null),[C,E]=(0,o.useState)(!1),[I,N]=(0,o.useState)(null),[j,P]=(0,o.useState)(null),[T,$]=(0,o.useState)(!1),[R,M]=(0,o.useState)(!1);(0,o.useEffect)((()=>{var e;if(!u||!d)return;console.log("\ud83d\udd04 Checking GlobalGridStateTilesAndResources for active crafting timers...");const t=null===(e=Zt.getResources())||void 0===e?void 0:e.find((e=>e.x===d.x&&e.y===d.y));if(console.log("\ud83d\udce1 Fetched station from GlobalGridStateTilesAndResources:",t),t&&t.craftEnd){console.log(`\u23f3 Active crafting found: ${t.craftedItem} until ${new Date(t.craftEnd).toLocaleTimeString()}`),N(t.craftedItem),$(!0),E(!0);const e=()=>{const e=Math.max(0,Math.floor((t.craftEnd-Date.now())/1e3));P(e),console.log(`\u23f3 Crafting countdown: ${e}s remaining`),0===e&&(console.log("\u2705 Crafting complete! Ready to collect."),$(!1),M(!0))};e();const n=setInterval(e,1e3);return()=>clearInterval(n)}console.log("\u274c No active crafting timer found."),N(null),$(!1),M(!1),P(null),E(!1)}),[u,d,Zt.getResources(),j]),(0,o.useEffect)((()=>{(async()=>{try{const e=JSON.parse(localStorage.getItem("inventory"))||[];r(e);const t=(await St.get(`http://localhost:3001/api/inventory/${s.playerId}`)).data.inventory||[];JSON.stringify(e)!==JSON.stringify(t)&&(r(t),localStorage.setItem("inventory",JSON.stringify(t)))}catch(e){console.error("Error syncing inventory:",e)}})()}),[s]),(0,o.useEffect)((()=>{(async()=>{try{const e=await Kt(),t=e.filter((e=>e.source===u));h(t);const n=e.find((e=>e.type===u));w((null===n||void 0===n?void 0:n.symbol)||"\ud83d\uded6"),k(n),g(e||[])}catch(e){console.error("Error loading resources:",e)}})()}),[u]);return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1009",titleKey:"1109",panelName:"CraftingStation",children:(0,$t.jsxs)("div",{className:"standard-panel",children:[(0,$t.jsxs)("h2",{children:[" ",b," ",u," "]}),"Store"===u&&(0,$t.jsx)("p",{style:{fontWeight:"bold",color:"#4CAF50"},children:"\ud83c\udfd5\ufe0f To use a purchased tent, click on your own player icon."}),(null===f||void 0===f?void 0:f.length)>0?f.map((e=>{const t=Dt(e,y||[]),o=qt(e,n,1),f=(e=>{var t;return!e||(null===(t=s.skills)||void 0===t?void 0:t.some((t=>t.type===e)))})(e.requires),h=I===e.type&&j>0,g=I===e.type&&0===j,m=e=>{const t=Math.floor(e/86400),n=Math.floor(e/3600),r=Math.floor(e%3600/60),o=e%60;return t>0?`${t}d ${n}h ${r}m`:n>0?`${n}h ${r}m ${o}s`:r>0?`${r}m ${o}s`:`${o}s`},b=h?`\u23f3 In progress: ${m(j)}`:g?"\u2705 Ready!":e.crafttime?`Time: ${m(e.crafttime)}`:"Instant",w=(0,$t.jsxs)("div",{className:"info-content",children:[(0,$t.jsxs)("div",{children:[(0,$t.jsx)("strong",{children:"Used In:"})," ",y.filter((t=>[t.ingredient1,t.ingredient2,t.ingredient3,t.ingredient4].includes(e.type))).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None"]}),(0,$t.jsxs)("div",{children:[(0,$t.jsx)("strong",{children:"Base Value:"})," \ud83d\udcb0 ",e.minprice||"n/a"]})]});return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,className:"resource-button "+(h?"in-progress":g?"ready":""),details:`Costs: ${t.join(", ")||"None"}\n                  ${e.requires?`<br>Requires: ${e.requires}`:""}\n                  ${b}`,info:w,disabled:!g&&(null!==I||!o||!f),onClick:()=>g?(async e=>{if(I&&e&&I===e.type){console.log(`\u2705\u2705\u2705 Collecting crafted ${e.type}...`);try{const t=s.location.gtype,o=["town","valley1","valley2","valley3"].includes(t);let f=o?a:n;const h=o?l:r,g=o?"backpack":"inventory",m=y.find((e=>e.type===I));if("npc"===(null===m||void 0===m?void 0:m.category))console.log(`\ud83e\udd16 Spawning NPC: ${I} at (${d.x}, ${d.y})`),En.spawnNPC(p,m,{x:d.x,y:d.y}),await en(s,"Craft",I,1,i);else{const t=await Qt(),r=await Kt(),o=n.filter((e=>{const t=r.find((t=>t.type===e.type));return"skill"===(null===t||void 0===t?void 0:t.category)||"upgrade"===(null===t||void 0===t?void 0:t.category)})).map((e=>e.type)),a=o.reduce(((n,r)=>{const o=t[r],a=o?o[e.type]:1;return a?(console.log(`Buff "${r}" applies to "${e.type}": Multiplier x${a}`),n*a):n}),1);console.log("Final Skill Multiplier:",a);const l=1*a,i=[...f],c=i.findIndex((t=>t.type===e.type));c>=0?i[c].quantity+=l:i.push({type:e.type,quantity:l}),await St.post("http://localhost:3001/api/update-inventory",{playerId:s.playerId,[g]:i}),console.log(`\ud83d\udce1 ${g} updated successfully!`),h(i)}console.log("\ud83d\udee0\ufe0f About to call updateGridResource:",u,d.x,d.y);const v=await In(p,{x:d.x,y:d.y,newResource:u,craftEnd:null,craftedItem:null});null!==v&&void 0!==v&&v.success||console.warn("\u26a0\ufe0f Warning: Grid resource update failed or returned unexpected response."),console.log("\ud83d\udee0\ufe0f Grid resource updated:",v),c((e=>e.map((e=>e.x===d.x&&e.y===d.y?{...e,craftEnd:null,craftedItem:null}:e)))),console.log("\ud83d\udee0\ufe0f Local state updated!");const b=Zt.getResources().map((e=>e.x===d.x&&e.y===d.y?{...e,craftEnd:null,craftedItem:null}:e));Zt.setResources(b),console.log("\ud83c\udf0e GlobalGridStateTilesAndResources updated successfully!"),E(!1),N(null),P(null),x(`Added ${e.type}.`),console.log(`\u2705 ${e.type} collected successfully.`)}catch(t){console.error(`\u274c Error collecting ${e.type}:`,t)}}else console.error("\u274c No valid crafted item to collect.")})(e):(async e=>{if(v(""),!e)return void v("Invalid recipe selected.");if(!qt(e,n,1))return void x(4);const t=[...n];if(!Nt(e,t))return;const r=e.crafttime||60,o=Date.now()+1e3*r;try{const t={newResource:u,x:d.x,y:d.y,craftEnd:o,craftedItem:e.type};console.log("handleCraft: updatedStation:  ",t),await In(p,t),console.log("\ud83d\udce1 Fetched station from GlobalGridStateTilesAndResources:",Zt.getResources),N(e.type),P(Math.max(0,Math.floor((o-Date.now())/1e3))),E(!0),$(!0),M(!1),console.log(`\ud83d\udee0\ufe0f Started crafting ${e.type}. Will be ready at ${o}`);const n=Zt.getResources().map((t=>t.x===d.x&&t.y===d.y?{...t,craftEnd:o,craftedItem:e.type}:t));Zt.setResources(n),console.log("\ud83c\udf0e GlobalGridStateTilesAndResources updated after crafting start!"),c(n),Mt.addFloatingText(404,32*d.x+16,32*d.y+16),console.log(`\u2705 ${e.type} will be ready at ${new Date(o).toLocaleTimeString()}`)}catch(a){console.error(`\u274c Error starting craft for ${e.type}:`,a)}await en(s,"Craft",e.type,1,i),await It(s.playerId,i)})(e)},e.type)})):(0,$t.jsx)("p",{children:"No recipes available."}),m&&(0,$t.jsx)("p",{className:"error-message",children:m}),"homestead"===s.location.gtype&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("hr",{}),(0,$t.jsx)("button",{className:"panel-shared-button",onClick:async()=>{if(!Array.isArray(n))return console.error("Inventory is invalid or not an array:",n),void v("Invalid inventory data.");const e=[...n],o=[];for(let t=1;t<=3;t++){const e=S[`ingredient${t}`],n=S[`ingredient${t}qty`];e&&n&&o.push({type:e,quantity:n})}if(o.length)try{o.forEach((t=>{let{type:n,quantity:r}=t;const o=e.findIndex((e=>e.type===n));o>=0?e[o].quantity+=r:e.push({type:n,quantity:r})})),await St.post("http://localhost:3001/api/update-inventory",{playerId:s.playerId,inventory:e}),await In(p,{newResource:null,x:d.x,y:d.y},c),r(e),localStorage.setItem("inventory",JSON.stringify(e)),await It(s.playerId,i),console.log(`Sold ${u} successfully.`),x(6),t()}catch(a){console.error("Error selling the stall:",a),v("An error occurred while selling the stall.")}else console.error("No ingredients found for refund.")},children:"Sell for Refund"})]})]})})},Tr=o.memo(Pr);const $r=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r}=e;return(0,o.useEffect)((()=>{(async()=>{n&&n.settlementId||console.warn("\u26a0\ufe0f currentPlayer or settlementId is not available yet.")})()}),[n]),(0,$t.jsx)(At,{onClose:t,descriptionKey:"1023",titleKey:"1123",panelName:"FarmHandsPanel",children:(0,$t.jsx)("div",{className:"panel-content"})})},Rr=e=>{let{onClose:t,inventory:n,setInventory:r,backpack:a,setBackpack:l,currentPlayer:s,setCurrentPlayer:i,setResources:c,stationType:u,currentStationPosition:d,gridId:p}=e;const[f,h]=(0,o.useState)([]),[y,g]=(0,o.useState)([]),[m,v]=(0,o.useState)(""),[b,w]=(0,o.useState)("\ud83d\uded6"),{updateStatus:x}=(0,o.useContext)(zt),[S,k]=(0,o.useState)(null);(0,o.useEffect)((()=>{(async()=>{try{const e=JSON.parse(localStorage.getItem("inventory"))||[];r(e);const t=(await St.get(`http://localhost:3001/api/inventory/${s.playerId}`)).data.inventory||[];JSON.stringify(e)!==JSON.stringify(t)&&(r(t),localStorage.setItem("inventory",JSON.stringify(t)))}catch(e){console.error("Error syncing inventory:",e)}})()}),[s]),(0,o.useEffect)((()=>{(async()=>{try{const e=await Kt(),t=e.filter((e=>e.source===u));h(t);const n=e.find((e=>e.type===u));w((null===n||void 0===n?void 0:n.symbol)||"\ud83d\uded6"),k(n),g(e||[])}catch(e){console.error("Error loading resources:",e)}})()}),[u]);return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1016",titleKey:"1116",panelName:"TradingStation",children:(0,$t.jsxs)("div",{className:"standard-panel",children:[(0,$t.jsxs)("h2",{children:[" ",b," ",u," "]}),(0,$t.jsx)("h3",{children:"is offering theses items:"}),"Store"===u&&(0,$t.jsx)("p",{style:{fontWeight:"bold",color:"#4CAF50"},children:"\ud83c\udfd5\ufe0f To use a purchased tent, click on your own player icon."}),(null===f||void 0===f?void 0:f.length)>0?f.map((e=>{const t=Dt(e,y||[]),o=qt(e,n,1),c=(0,$t.jsxs)("div",{className:"info-content",children:[(0,$t.jsxs)("div",{children:[(0,$t.jsx)("strong",{children:"Used In:"})," ",y.filter((t=>[t.ingredient1,t.ingredient2,t.ingredient3,t.ingredient4].includes(e.type))).map((e=>`${e.symbol||""} ${e.type}`)).join(", ")||"None"]}),(0,$t.jsxs)("div",{children:[(0,$t.jsx)("strong",{children:"Base Value:"})," \ud83d\udcb0 ",e.minprice||"n/a"]})]});return(0,$t.jsx)(Lt,{symbol:e.symbol,name:e.type,className:"resource-button",details:`in exchange for ${t.join(", ")||"None"}${e.requires?`<br>Requires: ${e.requires}`:""}`,info:c,disabled:!o,onClick:()=>(async e=>{if(v(""),!e)return void v("Invalid recipe selected.");if(!qt(e,n,1))return void x(4);const t=[...n];if(!Nt(e,t))return;const o=s.location.gtype,c=["town","valley1","valley2","valley3"].includes(o),u=c?l:r,d=c?"backpack":"inventory",p=[...c?a:n],f=p.findIndex((t=>t.type===e.type));f>=0?p[f].quantity+=1:p.push({type:e.type,quantity:1}),await St.post("http://localhost:3001/api/update-inventory",{playerId:s.playerId,[d]:p}),console.log(`\ud83d\udce1 ${d} updated successfully!`),u(p),Mt.addFloatingText(`+1 ${e.type}`,32*s.location.x+16,32*s.location.y+16),await en(s,"Trade",e.type,1,i),await It(s.playerId,i),x(`\u2705 Traded for ${e.type}.`)})(e)},e.type)})):(0,$t.jsx)("p",{children:"No trades available."}),m&&(0,$t.jsx)("p",{className:"error-message",children:m})]})})},Mr=o.memo(Rr),Fr=e=>{let{onClose:t,inventory:n,setInventory:r,currentPlayer:a,setCurrentPlayer:l,setResources:s,stationType:i,currentStationPosition:c,gridId:u}=e;const[d,p]=(0,o.useState)(""),[f,h]=(0,o.useState)(null),[y,g]=(0,o.useState)(null),{updateStatus:m}=(0,o.useContext)(zt);console.log("Inside Animal Stall:",{stationType:i,currentStationPosition:c}),(0,o.useEffect)((()=>{(async()=>{try{const e=(await Kt()).find((e=>e.type===i));if(console.log("Stall Resource:",e),h(e),!e.output)return void g(null)}catch(e){console.error("Error loading stall resources:",e),p("Failed to load stall resources.")}})()}),[i]),(0,o.useEffect)((()=>{(async()=>{try{const e=JSON.parse(localStorage.getItem("inventory"))||[];r(e);const t=(await St.get(`http://localhost:3001/api/inventory/${a.playerId}`)).data.inventory||[];JSON.stringify(e)!==JSON.stringify(t)&&(r(t),localStorage.setItem("inventory",JSON.stringify(t)))}catch(e){console.error("Error syncing inventory:",e)}})()}),[a]);return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1011",titleKey:"1111",panelName:"AnimalStall",children:(0,$t.jsxs)("div",{className:"standard-panel",children:[(0,$t.jsxs)("h2",{children:[(null===f||void 0===f?void 0:f.symbol)||"\ud83d\uded6"," ",i]}),"homestead"===a.location.gtype&&(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)("hr",{}),(0,$t.jsx)("button",{className:"panel-shared-button",onClick:async()=>{if(!Array.isArray(n))return console.error("Inventory is invalid or not an array:",n),void p("Invalid inventory data.");const e=[...n],o=[];for(let t=1;t<=3;t++){const e=f[`ingredient${t}`],n=f[`ingredient${t}qty`];e&&n&&o.push({type:e,quantity:n})}if(o.length)try{o.forEach((t=>{let{type:n,quantity:r}=t;const o=e.findIndex((e=>e.type===n));o>=0?e[o].quantity+=r:e.push({type:n,quantity:r})})),await St.post("http://localhost:3001/api/update-inventory",{playerId:a.playerId,inventory:e}),await In(u,{newResource:null,x:c.x,y:c.y},s),r(e),localStorage.setItem("inventory",JSON.stringify(e)),await It(a.playerId,l),console.log(`Sold ${i} successfully.`),m(6),t()}catch(d){console.error("Error selling the stall:",d),p("An error occurred while selling the stall.")}else console.error("No ingredients found for refund.")},children:"Sell for Refund"})]})]})})},_r=o.memo(Fr);const Or=function(e){let{onClose:t,inventory:n,setInventory:r,currentPlayer:a,setCurrentPlayer:l}=e;const[s,i]=(0,o.useState)([]),[c,u]=(0,o.useState)(null),[d,p]=(0,o.useState)({}),[f,h]=(0,o.useState)(0),[y,g]=(0,o.useState)([]),[m,v]=(0,o.useState)([]),[b,w]=(0,o.useState)(a),[x,S]=(0,o.useState)(0),{updateStatus:k}=(0,o.useContext)(zt);(0,o.useEffect)((()=>{(async()=>{try{const e=await St.get("http://localhost:3001/api/resources");g(e.data);const t=await St.get(`http://localhost:3001/api/inventory/${a.playerId}`);r(t.data.inventory||[]);const n=await St.get("http://localhost:3001/api/player-trade-stall",{params:{playerId:b.playerId}}),o=6+({Free:0,Bronze:2,Silver:4,Gold:8}[a.accountStatus]||0),l=n.data.tradeStall||[],s=Array(o).fill(null);if(l.forEach(((e,t)=>{t<o&&(s[t]=e)})),i(s),b.playerId===a.playerId){const e=l.reduce(((e,t)=>null!==t&&void 0!==t&&t.amount&&null!==t&&void 0!==t&&t.price?e+t.amount*t.price:e),0);h(e)}else h(0)}catch(e){console.error("Error fetching TradeStall data:",e)}})(),(async()=>{try{const e=await St.get("http://localhost:3001/api/players-in-settlement",{params:{settlementId:a.location.s}});v(e.data.players||[])}catch(e){console.error("Error fetching settlement players:",e)}})()}),[b,a]);const C=async e=>{var t;const o=s[e];if(!o||o.amount<=0)return;const l=o.amount*o.price;console.log("Current inventory:",n);const c=(null===(t=n.find((e=>"Money"===e.type)))||void 0===t?void 0:t.quantity)||0;if(l>c)return console.warn("Not enough money to complete the purchase."),void k("You do not have enough money to buy this item.");try{const t=n.map((e=>"Money"===e.type?{...e,quantity:e.quantity-l}:e)),c=t.findIndex((e=>e.type===o.resource));c>=0?t[c].quantity+=o.amount:t.push({type:o.resource,quantity:o.amount});const u=[...s];u[e]=null,await St.post("http://localhost:3001/api/update-inventory",{playerId:a.playerId,inventory:t}),await St.post("http://localhost:3001/api/update-player-trade-stall",{playerId:b.playerId,tradeStall:u}),r(t),i(u),k(22),console.log(`Purchased ${o.amount}x ${o.resource} for ${l}`)}catch(u){console.error("Error processing purchase:",u)}},E=(e,t)=>{const r=n.find((t=>t.type===e)),o=r?r.quantity:0;p((n=>({...n,[e]:Math.min(Math.max(0,t),o)})))},I=e=>{console.log("Inside calculateTotalSetllValue; Current Inventory:",n);const t=e.reduce(((e,t)=>null!==t&&void 0!==t&&t.amount&&null!==t&&void 0!==t&&t.price?e+t.amount*t.price:e),0);h(t)};return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1008",titleKey:"1108",panelName:"TradeStall",children:[(0,$t.jsxs)("div",{className:"username-container",children:[(0,$t.jsx)("button",{className:"arrow-button",onClick:()=>{if(m.length>0){const e=(x-1+m.length)%m.length;S(e),w(m[e])}},children:"\u2190"}),(0,$t.jsx)("span",{className:"username",children:(null===b||void 0===b?void 0:b.username)||"N/A"}),(0,$t.jsx)("button",{className:"arrow-button",onClick:()=>{if(m.length>0){const e=(x+1)%m.length;S(e),w(m[e])}},children:"\u2192"})]}),(0,$t.jsx)("h3",{children:"is selling:"}),(0,$t.jsx)("div",{className:"trade-stall-slots",children:s.map(((e,t)=>{var n;return(0,$t.jsx)("div",{className:"trade-slot "+(e?"filled":""),onClick:()=>(e=>{const t=s[e];t&&t.amount>0?C(e):u(e)})(t),children:e?`${e.amount}x ${e.resource} (${null!==(n=e.price)&&void 0!==n?n:0} ea.)`:"Empty"},t)}))}),null!==c&&(0,$t.jsxs)("div",{className:"inventory-modal",children:[(0,$t.jsx)("button",{className:"close-button",onClick:()=>u(null),children:"\u2716"}),(0,$t.jsx)("h3",{children:"Items to Sell"}),(0,$t.jsx)("div",{className:"inventory-modal-scroll",children:(0,$t.jsxs)("table",{children:[(0,$t.jsx)("thead",{children:(0,$t.jsxs)("tr",{children:[(0,$t.jsx)("th",{children:"Resource"}),(0,$t.jsx)("th",{children:"Available"}),(0,$t.jsx)("th",{children:"Price"}),(0,$t.jsx)("th",{children:"Amount"}),(0,$t.jsx)("th",{})]})}),(0,$t.jsx)("tbody",{children:n.filter((e=>{y.find((t=>t.type===e.type));return"Money"!==e.type})).map((e=>{const t=y.find((t=>t.type===e.type)),o=(null===t||void 0===t?void 0:t.minprice)||"N/A";return(0,$t.jsxs)("tr",{children:[(0,$t.jsx)("td",{children:e.type}),(0,$t.jsx)("td",{children:e.quantity}),(0,$t.jsx)("td",{children:o}),(0,$t.jsx)("td",{children:(0,$t.jsxs)("div",{className:"amount-input",children:[(0,$t.jsx)("button",{onClick:()=>E(e.type,(d[e.type]||0)-1),disabled:(d[e.type]||0)<=0,children:"-"}),(0,$t.jsx)("input",{type:"number",value:d[e.type]||0,onChange:t=>E(e.type,parseInt(t.target.value,10)||0)}),(0,$t.jsx)("button",{onClick:()=>E(e.type,(d[e.type]||0)+1),disabled:e.quantity<=(d[e.type]||0),children:"+"})]})}),(0,$t.jsx)("td",{children:(0,$t.jsx)("button",{className:"add-button",onClick:()=>(async e=>{const t=d[e]||0,o=n.find((t=>t.type===e));if(null===c||t<=0||!o||t>o.quantity)return void console.warn("Invalid amount or resource exceeds available quantity.");const p=y.find((t=>t.type===e)),f=(null===p||void 0===p?void 0:p.minprice)||0,h=[...s];h[c]={resource:e,amount:t,price:f};try{await St.post("http://localhost:3001/api/update-player-trade-stall",{playerId:a.playerId,tradeStall:h}),await St.post("http://localhost:3001/api/update-inventory",{playerId:a.playerId,inventory:n.map((n=>n.type===e?{...n,quantity:n.quantity-t}:n)).filter((e=>e.quantity>0))}),await It(a.playerId,l);const o=await St.get(`http://localhost:3001/api/inventory/${a.playerId}`);r(o.data.inventory),i(h),u(null),I(h)}catch(g){console.error("Error adding item to Trade Stall:",g)}})(e.type),disabled:!(d[e.type]>0&&d[e.type]<=e.quantity),children:"Add"})})]},e.type)}))})]})})]}),(0,$t.jsx)("div",{className:"sell-button-container",children:(0,$t.jsxs)("button",{className:"sell-button",onClick:async()=>{try{var e;const t=Math.floor(.5*f),o=n.map((e=>"Money"===e.type?{...e,quantity:(e.quantity||0)+t}:e));await St.post("http://localhost:3001/api/update-inventory",{playerId:a.playerId,inventory:o});const c=s.map((()=>null));await St.post("http://localhost:3001/api/update-player-trade-stall",{playerId:a.playerId,tradeStall:c});const u=(await St.get(`http://localhost:3001/api/inventory/${a.playerId}`)).data.inventory||[];r(u),i(c),h(0);const d={...a,inventory:u,money:(null===(e=u.find((e=>"Money"===e.type)))||void 0===e?void 0:e.quantity)||0};l(d),localStorage.setItem("player",JSON.stringify(d)),k(6),console.log(`Items sold successfully! Total earned: ${t}`)}catch(t){console.error("Error selling items:",t)}},disabled:0===f,children:["Sell for ",Math.floor(.5*f)]})})]})};const Ar=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r,resources:a}=e;const[l,s]=(0,o.useState)([]),[i,c]=(0,o.useState)(!0),{updateStatus:u}=(0,o.useContext)(zt),[d,p]=(0,o.useState)([]);console.log("currentPlayer = ",n),(0,o.useEffect)((()=>{(async()=>{try{const e=await fetch("http://localhost:3001/api/messages"),t=await e.json();s(t),c(!1);const o=(await St.get(`http://localhost:3001/api/player/${n.playerId}`)).data.messages||[],a=o.filter((e=>!e.read));if(a.length>0){const e=o.map((e=>e.read?e:{...e,read:!0}));await St.post("http://localhost:3001/api/update-player-messages",{playerId:n.playerId,messages:e}),p(a.map((e=>e.messageId)))}r((e=>({...e,messages:o})))}catch(e){console.error("\u274c Error fetching or updating mailbox data:",e)}})()}),[]);const f=e=>{var t;return(null===(t=a.find((t=>t.type===e)))||void 0===t?void 0:t.symbol)||""},h=e=>e&&0!==e.length?(0,$t.jsx)("div",{className:"reward-summary",children:e.map(((e,t)=>(0,$t.jsxs)("span",{className:"reward-item",children:[f(e.item)," ",e.qty," ",e.item]},t)))}):null;return n&&Array.isArray(n.messages)?(0,$t.jsx)(lr,{onClose:()=>{console.log("\ud83d\udced Closing mailbox"),p([]),t()},title:"\ud83d\udcec Mailbox",className:"mailbox-modal",children:i?(0,$t.jsx)("p",{children:"Loading messages..."}):0===n.messages.length?(0,$t.jsx)("p",{children:"Your mailbox is empty."}):n.messages.map(((e,t)=>{const o=l.find((t=>t.id===e.messageId));if(!o)return console.warn(`\ud83d\udced No template found for messageId: ${e.messageId}`),null;const a=e.rewards&&e.rewards.length>0?e.rewards:o.rewards;return(0,$t.jsxs)("div",{className:"mailbox-message",children:[(0,$t.jsxs)("div",{className:"message-left",children:[(0,$t.jsxs)("h3",{children:[o.title,(!e.read||d.includes(e.messageId))&&(0,$t.jsx)("span",{className:"unread-tag",children:"\ud83c\udd95"})]}),(0,$t.jsx)("p",{className:"message-body",children:o.body}),(0,$t.jsxs)("p",{className:"mailbox-timestamp",children:["Received: ",new Date(e.timestamp).toLocaleString()]})]}),(0,$t.jsxs)("div",{className:"message-actions",children:[(null===a||void 0===a?void 0:a.length)>0&&h(a),(0,$t.jsxs)("div",{className:"button-row",children:[(null===a||void 0===a?void 0:a.length)>0&&(0,$t.jsx)("button",{className:"collect-btn",onClick:()=>(async e=>{try{var t;const o=l.find((t=>t.id===e.messageId)),a=(null===(t=e.rewards)||void 0===t?void 0:t.length)>0?e.rewards:o.rewards,s=[...n.inventory];a.forEach((e=>{let{item:t,qty:n}=e;const r=s.findIndex((e=>e.type===t));-1!==r?s[r].quantity+=n:s.push({type:t,quantity:n})})),await St.post("http://localhost:3001/api/update-inventory",{playerId:n.playerId,inventory:s});const i=n.messages.filter((t=>t!==e));await St.post("http://localhost:3001/api/update-player-messages",{playerId:n.playerId,messages:i}),r((e=>({...e,inventory:s,messages:i}))),u(`\u2705 Collected rewards from "${o.title}"`)}catch(o){console.error("\u274c Error collecting rewards:",o),u("\u274c Failed to collect rewards.")}})(e),children:"Collect"}),(0,$t.jsx)("button",{className:"delete-btn",title:"Delete",onClick:()=>{window.confirm("Are you sure you want to delete this message?")&&(async(e,t)=>{try{const o=[...n.messages];o.splice(t,1),await St.post("http://localhost:3001/api/update-player-messages",{playerId:e,messages:o}),r((e=>({...e,messages:o}))),u("\ud83d\uddd1\ufe0f Message deleted.")}catch(o){console.error("\u274c Error deleting message:",o),u("\u274c Failed to delete message.")}})(n.playerId,t)},children:"\ud83d\uddd1\ufe0f"})]})]})]},t)}))}):(0,$t.jsx)(lr,{onClose:t,title:"\ud83d\udcec Mailbox",message:"No messages available."})};const Lr=function(e){let{onClose:t,currentPlayer:n,setCurrentPlayer:r,resources:a,openMailbox:l}=e;const[s,i]=(0,o.useState)([]),{updateStatus:c}=(0,o.useContext)(zt);(0,o.useEffect)((()=>{u()}),[]);const u=async()=>{try{const e=await St.get("http://localhost:3001/api/store-offers");i(e.data||[])}catch(e){console.error("\u274c Failed to load store offers:",e)}};return(0,$t.jsxs)(lr,{onClose:t,title:"\ud83d\uded2 Store",children:[(0,$t.jsx)("h4",{children:"Purchases will be delivered to the Inbox."}),(0,$t.jsx)("div",{className:"store-offers",children:s.filter((e=>!(e=>{if(!e.shelflifeDays||null===n||void 0===n||!n.created)return!1;const t=new Date(n.created),r=new Date;return Math.floor((r-t)/864e5)>e.shelflifeDays})(e))).map((e=>(0,$t.jsxs)("div",{className:"store-offer-card",children:[(0,$t.jsxs)("div",{className:"store-offer-left",children:[(0,$t.jsx)("h3",{children:e.title}),(0,$t.jsx)("p",{children:e.body}),(0,$t.jsxs)("p",{className:"store-reward-line",children:["\ud83c\udf81 ",e.rewards.map((e=>{var t;const n=(null===(t=a.find((t=>t.type===e.item)))||void 0===t?void 0:t.symbol)||"";return`${n} ${e.qty} ${e.item}`})).join(", ")]})]}),(0,$t.jsxs)("div",{className:"store-offer-right",children:[(0,$t.jsxs)("div",{className:"store-price",children:["USD $",e.price.toFixed(2)]}),(0,$t.jsx)("button",{onClick:()=>(async e=>{try{var r;null!==(r=(await St.post("http://localhost:3001/api/purchase-store-offer",{playerId:n.playerId,offerId:e})).data)&&void 0!==r&&r.success?(t(),setTimeout((()=>{null===l||void 0===l||l()}),100)):c("\u274c Purchase failed.")}catch(o){console.error("\u274c Error purchasing store offer:",o),c("\u274c Error processing your purchase.")}})(e.id),children:"Buy"})]})]},e.id)))})]})};const qr=function(e){let{onClose:t,currentPlayer:n}=e;const[r,a]=(0,o.useState)(""),[l,s]=(0,o.useState)(""),[i,c]=(0,o.useState)([]),u=()=>{const e=JSON.parse(localStorage.getItem("timers"));return(null===e||void 0===e?void 0:e.season)||{type:"Unknown",phase:"Unknown",endTime:null}};(0,o.useEffect)((()=>{const e=()=>{const e=u();if(null===e||void 0===e||!e.endTime)return void a("N/A");const t=new Date,n=new Date(e.endTime)-t;if(n<=0)return console.warn("\u26a0\ufe0f Season ended! Waiting for phase change..."),void a("0d 0h 0m 0s");const r=Math.floor(n/864e5),o=Math.floor(n%864e5/36e5),l=Math.floor(n%36e5/6e4),s=Math.floor(n%6e4/1e3);a(`${r}d ${o}h ${l}m ${s}s`)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[]),(0,o.useEffect)((()=>{(async()=>{if(n&&n.settlementId)try{console.log("\ud83d\udcb0 Fetching wealthiest citizens for settlement:",n.settlementId);const e=await St.get(`http://localhost:3001/api/get-players-by-settlement/${n.settlementId}`),t=e.data.map((e=>({username:e.username,netWorth:e.netWorth||0}))).sort(((e,t)=>t.netWorth-e.netWorth)).slice(0,10);c(t)}catch(e){console.error("\u274c Error fetching richest citizens:",e)}else console.warn("\u26a0\ufe0f currentPlayer or settlementId is not available yet.")})()}),[n]);const d=u();return(0,$t.jsxs)(At,{onClose:t,descriptionKey:"1015",titleKey:"1115",panelName:"SeasonPanel",children:[(0,$t.jsx)("h2",{children:(null===d||void 0===d?void 0:d.type)||"Loading..."}),(0,$t.jsxs)("p",{children:["Season Phase: ",(null===d||void 0===d?void 0:d.phase)||"Loading..."]}),(0,$t.jsxs)("p",{children:["Season ends in: ",r]}),(0,$t.jsx)("button",{className:"season-button",onClick:async()=>{try{var e;console.log("\ud83d\udd04 Resetting season...");const t=await St.post("http://localhost:3001/api/reset-season");null!==(e=t.data)&&void 0!==e&&e.message&&(console.log(`\u2705 ${t.data.message}`),s(t.data.message))}catch(t){console.error("\u274c Error resetting season:",t),s("\u274c Failed to reset season.")}},children:"Reset Season"}),l&&(0,$t.jsx)("p",{className:"season-status",children:l}),(0,$t.jsx)("br",{}),(0,$t.jsx)("br",{}),(0,$t.jsx)("h3",{children:"\ud83d\udcb0 This Settlement's Wealthiest Citizens"}),(0,$t.jsx)("p",{children:"Calculated net worth is a sum of inventory, buildings, skills, and money."}),i.length>0?(0,$t.jsx)("div",{children:i.map(((e,t)=>(0,$t.jsxs)("p",{children:[t+1,". ",(0,$t.jsx)("strong",{children:e.username})," : ",e.netWorth]},t)))}):(0,$t.jsx)("p",{children:"No data available for wealthiest citizens."})]})},Dr=e=>{let{onClose:t,pcData:n,currentPlayer:r,setCurrentPlayer:a,setInventory:l,setBackpack:s}=e;const{updateStatus:i}=(0,o.useContext)(zt),{closePanel:c}=Ot(),[u,d]=(0,o.useState)(""),[p,f]=(0,o.useState)(""),[h,y]=(0,o.useState)(0),[g,m]=(0,o.useState)(!1);console.log("made it to SocialPanel; pc = ",n),(0,o.useEffect)((()=>{if(!n)return;const e=setInterval((()=>{var e,t;const o=null===r||void 0===r||null===(e=r.location)||void 0===e?void 0:e.g;if(!o)return;const a=En.getGridState(o);var l;(null===a||void 0===a||null===(t=a.pcs[n.playerId])||void 0===t?void 0:t.iscamping)!==g&&m((null===(l=a.pcs[n.playerId])||void 0===l?void 0:l.iscamping)||!1)}),2e3);return()=>clearInterval(e)}),[n,r]),(0,o.useEffect)((()=>{if(n||(console.warn("SocialPanel was opened with missing pcData."),n={username:"Unknown",hp:0,iscamping:!1}),n.username===r.username){var e,t;m(n.iscamping||!1);const o=(null===(e=r.backpack)||void 0===e||null===(t=e.find((e=>"Tent"===e.type)))||void 0===t?void 0:t.quantity)||0;y(o)}}),[n,r]);const v=async(e,t)=>{try{var n;const o=null===r||void 0===r||null===(n=r.location)||void 0===n?void 0:n.g;if(!o)return void console.error("\u274c Cannot update gridState: No gridId found.");let a=En.getGridState(o);if(!a)return void console.warn(`\u26a0\ufe0f No gridState found for gridId ${o}`);a.pcs[e]?(a.pcs[e].iscamping=t,await En.saveGridState(o),console.log(`\u2705 Updated camping state in gridState: ${e} iscamping=${t}`)):console.warn(`\u26a0\ufe0f Player ${e} not found in gridState.pcs.`)}catch(o){console.error("\u274c Error updating camping state in gridState:",o)}};return(0,$t.jsx)(At,{onClose:t,descriptionKey:"1014",titleKey:"1114",panelName:"SocialPanel",children:(0,$t.jsx)("div",{className:"panel-content",children:(0,$t.jsxs)("div",{className:"debug-buttons",children:[(0,$t.jsxs)("h2",{children:[n.username,n.username===r.username&&" (You)"]}),(0,$t.jsxs)("p",{children:["\u2764\ufe0f\u200d\ud83e\ude79 HP: ",n.hp]}),n.iscamping&&(0,$t.jsx)("h3",{style:{fontWeight:"bold",color:"#4CAF50"},children:"\ud83c\udfd5\ufe0f Camping."}),n.username===r.username&&(0,$t.jsx)($t.Fragment,{children:g?(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{try{(await St.post("http://localhost:3001/api/update-profile",{playerId:r.playerId,updates:{iscamping:!1}})).data.success&&(m(!1),a((e=>({...e,iscamping:!1}))),i(30),v(r.playerId,!1))}catch(e){console.error("\u274c Error putting away tent:",e),i(29)}},children:"\u26fa Put Away Tent"}):(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsxs)("p",{children:["You have ",(0,$t.jsx)("strong",{children:h})," tents."]}),(0,$t.jsx)("button",{className:"btn-success",onClick:async()=>{if(!(h<=0))try{let e=[...r.backpack];const t=e.findIndex((e=>"Tent"===e.type));if(!(t>=0&&e[t].quantity>0))return void i(27);e[t].quantity-=1,e[t].quantity<=0&&e.splice(t,1),console.log("\u26fa\ufe0f Tent deducted. Updated Backpack:",e),s(e),await St.post("http://localhost:3001/api/update-inventory",{playerId:r.playerId,backpack:e}),console.log("\u26fa\ufe0f iscamping: updated inventory; updatedBackpack = ",e);const n=await St.post("http://localhost:3001/api/update-profile",{playerId:r.playerId,updates:{iscamping:!0}});n.data.success&&(console.log("\u26fa\ufe0f iscamping: updated profile successfully; response = ",n),m(!0),a((e=>({...e,iscamping:!0}))),i(28),v(r.playerId,!0))}catch(e){console.error("\u274c Error pitching tent:",e),i(29)}},disabled:h<=0,children:"\ud83c\udfd5\ufe0f Pitch Tent"})]})})]})})})},zr=o.memo(Dr),Br=(0,o.createContext)(),Gr=e=>{let{children:t}=e;const[n,r]=(0,o.useState)(null);return(0,$t.jsx)(Br.Provider,{value:{activeModal:n,setActiveModal:r,openModal:e=>{console.log(`Opening modal: ${e}`),r(e)},closeModal:()=>{r(null)}},children:t})};let Ur=!1,Wr=null;function Hr(e,t,n){const r=Zt.getTiles(),o=Zt.getResources();if(e<0||t<0||e>63||t>63)return console.warn(`\u26d4 Movement blocked: (${e}, ${t}) is out of bounds.`),!1;const a=function(e,t,n,r,o){if(e=Math.floor(e),t=Math.floor(t),e<0||t<0||t>=n.length||e>=n[0].length)return console.warn(`\u26d4 Tile (${e}, ${t}) is out of bounds.`),!1;const a=n[t][e];if(!a)return console.warn(`\u26d4 Invalid tile at (${e}, ${t}) - No tileType found.`),!1;const l=o.find((e=>e.type===a));if(!l||!l.passable)return console.warn(`\u26d4 Tile (${e}, ${t}) is not passable according to masterResources.`),!1;const s=r.find((n=>n.x===e&&n.y===t));if(s&&!s.passable)return console.warn(`\u26d4 Tile (${e}, ${t}) contains an impassable resource (${s.type}).`),!1;return!0}(e,t,r,o,n);return a||console.warn(`\u26d4 Movement blocked: Tile (${e}, ${t}) is not passable.`),a}function Vr(e,t,n,r){if(Ur)return void console.warn("Movement in progress, input ignored.");console.log("handleKeyMovement: currentPlayer: ",t);const o={ArrowUp:{dx:0,dy:-1},w:{dx:0,dy:-1},ArrowDown:{dx:0,dy:1},s:{dx:0,dy:1},ArrowLeft:{dx:-1,dy:0},a:{dx:-1,dy:0},ArrowRight:{dx:1,dy:0},d:{dx:1,dy:0}}[e.key];if(!o)return;if(t.iscamping)return void Mt.addFloatingText(32,t.location.x*n,t.location.y*n+25);const a=t._id.toString(),l=t.location.g,s=En.getGridState(l);if(!s||!s.pcs[a])return void console.error("Player not found in gridState.");const i=s.pcs[a].position;console.log("playerPosition from gridState = ",i);const c=Math.round(i.x+o.dx),u=Math.round(i.y+o.dy);Hr(c,u,r)?function(e,t,n,r,o){if(Ur)return;console.log("movePlayerSmoothly:  target: ",t),console.log("movePlayerSmoothly:  playerId: ",e),console.log("gridState before movement:",n);const a=n.pcs[e].position,l=a.x*o,s=a.y*o,i=t.x*o,c=t.y*o,u=10;let d=0;function p(){if(d>=u){Ur=!1,Wr=null;const a={x:Math.round(t.x),y:Math.round(t.y)};return console.log("Final player position (rounded):",a),n.pcs[e].position=a,En.saveGridState(r),void function(e,t){const n=document.querySelector(".homestead");if(!n)return;const r=e.x*t-window.innerWidth/2,o=e.y*t-window.innerHeight/2;n.scrollTo({left:r,top:o,behavior:"smooth"}),console.log(`\ud83d\udcf7 Camera centered on player at (${e.x}, ${e.y})`)}(a,o)}const a=l+(i-l)/u*d,f=s+(c-s)/u*d;n.pcs[e].position={x:a/o,y:f/o},d++,Wr=requestAnimationFrame(p)}p()}(a,{x:c,y:u},s,l,n):console.warn(`\u26d4 Player blocked from moving to (${c}, ${u}).`)}const Qr=(e,t)=>{if(!e||e<=t)return"0d 0h 0m 0s";const n=e-t;return`${Math.floor(n/864e5)}d ${Math.floor(n%864e5/36e5)}h ${Math.floor(n%36e5/6e4)}m ${Math.floor(n%6e4/1e3)}s`};const Kr=function(){var e,t,n,r,a;const[l,s]=(0,o.useState)((()=>localStorage.getItem("gridId")||null)),[i,c]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[p,f]=(0,o.useState)([]),[h,y]=(0,o.useState)([]),[g,m]=(0,o.useState)([]);(0,o.useEffect)((()=>{null!==u&&void 0!==u&&u.length&&(Zt.setTiles(u),console.log("GlobalGridStateTilesAndResources tiles updated:",u))}),[u]),(0,o.useEffect)((()=>{null!==i&&void 0!==i&&i.length&&(Zt.setResources(i),console.log("GlobalGridStateTilesAndResources resources updated:",i))}),[i]);const[v,b]=(0,o.useState)(null),[w,x]=(0,o.useState)({}),[S,k]=(0,o.useState)([]),[C,E]=(0,o.useState)([]),[I,N]=(0,o.useState)(null),[j,P]=(0,o.useState)(!1),T=Bn(),$=(0,o.useContext)(zn),[R,M]=(0,o.useState)({}),[F,_]=(0,o.useState)({}),{updateStatus:O}=(0,o.useContext)(zt),[A]=(0,o.useState)(0),[L,q]=(0,o.useState)(!1),{activeModal:D,setActiveModal:z,openModal:B,closeModal:G}=(0,o.useContext)(Br),[U,W]=(0,o.useState)(!1),[H,V]=(0,o.useState)({title:"",message:"",message2:""}),{activePanel:Q,openPanel:K,closePanel:J}=Ot(),[Y,X]=(0,o.useState)(null),[Z,ee]=(0,o.useState)(null),[te]=(0,o.useState)(!1),[ne,re]=(0,o.useState)(!1),[oe,ae]=(0,o.useState)(null),[le,se]=(0,o.useState)(null),[ie,ce]=(0,o.useState)({x:0,y:0}),[ue,de]=(0,o.useState)(!1),[pe,fe]=(0,o.useState)("close"),he={close:30,far:16}[pe],[ye,ge]=(0,o.useState)((()=>JSON.parse(localStorage.getItem("timers"))||{season:{phase:"",endTime:null,type:""},election:{phase:"",endTime:null},train:{phase:"",endTime:null},taxes:{phase:"",endTime:null},bank:{phase:"",endTime:null}})),[me,ve]=(0,o.useState)({season:"",election:"",train:"",taxes:"",bank:""});(0,o.useEffect)((()=>{if(null===v||void 0===v||!v.settlementId)return;(async()=>{await be(),console.log("\u2705 Timers initialized:",ye)})();const e=setInterval(be,6e4);return()=>clearInterval(e)}),[v]);const be=async()=>{if(console.log("\ud83d\udd04 Fetching initial timers from the server..."),null!==v&&void 0!==v&&v.settlementId&&null!==v&&void 0!==v&&v.frontierId)try{var e,t,n,r,o,a,l,s,i,c,u;const[d,p]=await Promise.all([St.get(`http://localhost:3001/api/get-settlement/${v.settlementId}`),St.get(`http://localhost:3001/api/get-frontier/${v.frontierId}`)]);console.log("frontierResponse = ",p);d.data;const f=p.data,h={seasons:{type:(null===(e=f.seasons)||void 0===e?void 0:e.seasonType)||"Unknown",phase:(null===(t=f.seasons)||void 0===t?void 0:t.phase)||"Unknown",endTime:null!==(n=f.seasons)&&void 0!==n&&n.endTime?new Date(f.seasons.endTime).getTime():null},elections:{phase:(null===(r=f.elections)||void 0===r?void 0:r.phase)||"Unknown",endTime:null!==(o=f.elections)&&void 0!==o&&o.endTime?new Date(f.elections.endTime).getTime():null},train:{phase:(null===(a=f.train)||void 0===a?void 0:a.phase)||"Unknown",endTime:null!==(l=f.train)&&void 0!==l&&l.endTime?new Date(f.train.endTime).getTime():null},taxes:{phase:(null===(s=f.taxes)||void 0===s?void 0:s.phase)||"Unknown",endTime:null!==(i=f.taxes)&&void 0!==i&&i.endTime?new Date(f.taxes.endTime).getTime():null},bank:{phase:(null===(c=f.bank)||void 0===c?void 0:c.phase)||"Unknown",endTime:null!==(u=f.bank)&&void 0!==u&&u.endTime?new Date(f.bank.endTime).getTime():null}};ge(h),localStorage.setItem("timers",JSON.stringify(h)),console.log("\u2705 Timers updated and stored locally:",h),console.log("\u2705 Current Time:",Date.now())}catch(d){console.error("\u274c Error fetching timers data:",d)}};(0,o.useEffect)((()=>{const e=()=>{const e=Date.now();ve({seasons:Qr(ye.seasons.endTime,e),elections:Qr(ye.elections.endTime,e),train:Qr(ye.train.endTime,e),taxes:Qr(ye.taxes.endTime,e),bank:Qr(ye.bank.endTime,e)})};e();const t=setInterval(e,1e3);return()=>clearInterval(t)}),[ye]),(0,o.useEffect)((()=>{const e=setInterval((async()=>{const e=Date.now();let t=!1;ye.seasons.endTime&&e>=ye.seasons.endTime&&(console.log("\ud83c\udf31 Season phase ended. Fetching new season data..."),t=!0),ye.elections.endTime&&e>=ye.elections.endTime&&(console.log("\ud83c\udfdb\ufe0f Election phase ended. Fetching new election data..."),t=!0),ye.train.endTime&&e>=ye.train.endTime&&(console.log("\ud83d\ude82 Train cycle ended. Fetching new train data..."),t=!0),ye.taxes.endTime&&e>=ye.taxes.endTime&&(console.log("\ud83d\udcb0 Tax cycle ended. Fetching new tax data..."),t=!0),ye.bank.endTime&&e>=ye.bank.endTime&&(console.log("\ud83d\udcb0 Bank cycle ended. Fetching new bank timer..."),t=!0),t&&(console.log("\u23f3 A phase has ended! Fetching updated timers..."),await be())}),5e3);return()=>clearInterval(e)}),[ye]);const we=(0,o.useMemo)((()=>p),[p]),xe=(0,o.useMemo)((()=>u),[u]),Se=(0,o.useMemo)((()=>i),[i]);let ke=!1;const[Ce,Ee]=(0,o.useState)(!1);(0,o.useEffect)((()=>{(async()=>{if(console.log("App initialization begun."),ke)console.log("Initialization is already in progress. Skipping.");else{ke=!0;try{var e,t;console.log("Initializing player...");const n=localStorage.getItem("player");if(!n)return console.log("No stored player found, opening login modal."),q(!0),K("LoginPanel"),V({title:Tt[5005],message:Tt[5006],message2:Tt[5007],size:"small"}),void W(!0);const r=JSON.parse(n),o=(await St.get(`http://localhost:3001/api/player/${r.playerId}`)).data;if(!o||!o.playerId)return console.error("Invalid full player data from server:",o),void q(!0);console.log("Merging player data and initializing inventory...");let a={...r,...o};b(a),x(o.inventory||[]),localStorage.setItem("player",JSON.stringify(a)),console.log("Determining local gridId...");const l=(null===r||void 0===r||null===(e=r.location)||void 0===e?void 0:e.g)||localStorage.getItem("gridId");if(!l)return void console.error("No gridId found. Unable to initialize grid.");s(l),localStorage.setItem("gridId",l),console.log("Initializing grid tiles and resources..."),await Tn(he,l,f,c,d,O),console.log("Initializing gridState..."),await En.initializeGridState(l);const i=En.getGridState(l);$(i),console.log("initializedState",i),console.log("Resolving player location...");const u=null===i||void 0===i?void 0:i.pcs[o._id.toString()];if(console.log("gridPlayer = ",u),console.log("fullPlayerData = ",o),u){console.log("\u2705 Player found in local gridState.");const{data:e}=await St.get(`http://localhost:3001/api/load-grid-state/${o.location.g}`),t=(null===e||void 0===e?void 0:e.gridState)||{npcs:{},pcs:{}};t.pcs&&t.pcs[o._id]?console.log("\u2705 Player exists in both local and DB gridState."):(console.warn(`\u26a0\ufe0f Player ${o.username} is missing from DB gridState! Saving state to DB.`),await En.saveGridState(o.location.g))}else console.warn("Player not found in gridState. Adding player at (1,1)."),En.addPC(l,{playerId:o.playerId,username:o.username,position:{x:1,y:1},icon:o.icon,hp:o.hp,maxhp:o.maxhp,armorclass:o.armorclass,attackbonus:o.attackbonus,damage:o.damage,attackrange:o.arrackrange,speed:o.speed,iscamping:o.iscamping}),await En.saveGridState(l);u&&(o.hp=u.hp,o.maxhp=u.maxhp,o.armorclass=u.armorclass,o.attackbonus=u.attackbonus,o.damage=u.damage,o.speed=u.speed,o.attackrange=u.attackrange,o.iscamping=u.iscamping),await St.post("http://localhost:3001/api/update-profile",{playerId:o.playerId,updates:{hp:o.hp,maxhp:o.maxhp,armorclass:o.armorclass,attackbonus:o.attackbonus,damage:o.damage,attackrange:o.attackrange,speed:o.speed,iscamping:o.iscamping}}),console.log("\u2705 Backfilled combat stats to player document:",o),a={...o,location:{...a.location,x:(null===u||void 0===u?void 0:u.position.x)||1,y:(null===u||void 0===u?void 0:u.position.y)||1,g:l}},b(a),localStorage.setItem("player",JSON.stringify(a)),console.log("\u2705 LocalStorage updated with combat stats:",a),console.log("Loading tuning data...");const[p,h]=await Promise.all([Qt(),Kt()]);y(h),m(p),null!==(t=a.settings)&&void 0!==t&&t.hasDied&&(console.log("Player died last session. Showing death modal."),V({title:Tt[5001],message:Tt[5002],message2:Tt[5003],size:"small"}),W(!0),await St.post("http://localhost:3001/api/update-profile",{playerId:a.playerId,updates:{settings:{...a.settings,hasDied:!1}}}),a.settings.hasDied=!1,localStorage.setItem("player",JSON.stringify(a))),console.log("App initialization complete."),Ee(!0)}catch(n){console.error("Error during app initialization:",n),O("ERR_NETWORK"===n.code?1:0)}}})()}),[]);const Ie=async e=>{try{console.log("From App.js: calling fetchGridData for gridId:",e);const t=await jn(e,O);if(t.tiles&&t.resources){const e=t.resources.map((e=>{let{type:t,x:n,y:r,growEnd:o}=e;return{type:t,x:n,y:r,...o&&{growEnd:o}}}));f(t.tiles),c(e),console.log("Slimmed-down resources set:",e)}else console.error("No tiles or resources found in response:",t)}catch(t){console.error("Error fetching grid:",t)}};(0,o.useEffect)((()=>(l&&(rr.initializeFarmState(i),rr.startSeedTimer({gridId:l,setResources:c,activeTileSize:he,currentPlayer:v,setCurrentPlayer:b})),()=>{rr.stopSeedTimer()})),[l,i]),(0,o.useEffect)((()=>{T&&(console.log("\ud83d\udd04 Updating local state for PCs and NPCs from GridState:",T),M({...T.pcs}),_({...T.npcs}))}),[T]),(0,o.useEffect)((()=>{if(!Ce)return void console.warn("App is not fully initialized or no gridId/gridState available. Skipping NPC/PC management.");console.log("Starting NPC/PC manager for gridId:",l);const e=setInterval((async()=>{if(!T)return void console.warn(`Interval loop: No gridState available for gridId: ${l}`);const{npcs:e={},pcs:t={}}=T;Object.values(e).forEach((e=>{const t=Date.now();e.update(t,T,l,he)})),Object.values(t).forEach((async e=>{e.hp<=0&&v&&String(v._id)===e.playerId&&(console.warn(`PC ${e.username} has died.`),await Ne(v))}))}),1e3);return()=>clearInterval(e)}),[Ce,l,T,v,he]);const Ne=async e=>{console.log("Handling player death..."),console.log("currentPlayer = ",e);try{const t=String(e._id),n=e.location.g,r={x:1,y:1,g:e.gridId!==n?e.gridId:n,gtype:"homestead"},o={...e.location,...r};console.log(`Updating profile and clearing backpack for player ${e.username}`),await St.post("http://localhost:3001/api/update-profile",{playerId:e._id,updates:{backpack:[],hp:25,location:o,settings:{...e.settings,hasDied:!0}}}),console.log(`Removing player ${e.username} from gridState.pcs in grid ${n}`);const a=En.getGridState(n);null!==a&&void 0!==a&&a.pcs[t]&&(delete a.pcs[t],await En.saveGridState(n));const l={...e,hp:5,location:o,backpack:[],settings:{...e.settings,hasDied:!0}};b(l),localStorage.setItem("player",JSON.stringify(l)),console.log(`Player ${e.username} teleported to home grid with 5 HP.`),await Nn(l,e.location,o,b,0,s,f,c,d,0,he)}catch(t){console.error("Error during player death handling and teleportation:",t)}};(0,o.useEffect)((()=>{const e=e=>{if(D)return void console.log("\ud83d\uded1 Keyboard input disabled while modal is open.");const t=document.activeElement;(!t||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName)&&(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.preventDefault(),Vr(e,v,he,h))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[v,i,he,T,h,D]);let je=!1,Pe=null;const Te=(0,o.useCallback)(((e,t)=>{var n;if(je)return;je=!0;const r=i.find((n=>n.x===t&&n.y===e));if(console.log("handleTileClick invoked with:",{rowIndex:e,colIndex:t}),console.log("Resource:",r),!l||"string"!==typeof l)return void console.error("Invalid gridId:",l);if(null===v||void 0===v||!v.username||"string"!==typeof v.username)return void console.error("Invalid username:",null===v||void 0===v?void 0:v.username);const o=null===T||void 0===T||null===(n=T.pcs)||void 0===n?void 0:n[String(v._id)],a=(null===o||void 0===o?void 0:o.position)||{x:1,y:1};if(!a||"undefined"===typeof a.x||"undefined"===typeof a.y)return console.error("\u26a0\ufe0f Player position is invalid in gridState:",o),void(je=!1);const p={x:t,y:e};if(r&&"npc"!==r.category){const e=(m=p,(y=a)&&m&&"undefined"!==typeof y.x&&"undefined"!==typeof y.y&&"undefined"!==typeof m.x&&"undefined"!==typeof m.y?Math.abs(y.x-m.x)+Math.abs(y.y-m.y):(console.warn("Skipping distance calculation due to invalid position:",{pos1:y,pos2:m}),1/0)),t=v.range||1;if(console.log(`Checking range: Player at ${a.x},${a.y} | Target at ${p.x},${p.y} | Distance = ${e} | Range = ${t}`),e>t)return Mt.addFloatingText(24,p.x*he,p.y*he),console.log("Target out of range:",p),void(je=!1)}var y,m,C,E;if(r)if("npc"===r.category);else if("training"===r.category)console.log(`App.js: Training station clicked - ${r.type}`),ae({type:r.type,position:{x:t,y:e},gridId:l}),K("SkillsAndUpgradesPanel");else if("crafting"===r.category)console.log("App.js: Crafting station clicked"),ae({type:r.type,position:{x:t,y:e},gridId:l}),K("CraftingStation");else if("trading"===r.category)console.log("App.js: Trading station clicked"),ae({type:r.type,position:{x:t,y:e},gridId:l}),K("TradingStation");else if("stall"===r.category)console.log("App.js: Animal Stall clicked"),ae({type:r.type,position:{x:t,y:e},gridId:l}),K("AnimalStall");else if("station"===r.category)switch(console.log("App.js: Station clicked; resource.type = ",r.type),ae({type:r.type,position:{x:t,y:e},gridId:l}),r.type){case"Courthouse":K("Courthouse");break;case"Trade Stall":K("TradeStall");break;case"Mailbox":B("Mailbox");break;case"Train":K("TrainPanel");break;case"Bank":K("BankPanel");break;case"Farm Hand 1":case"Farm Hand 2":case"Farm Hand 3":K("FarmHandsPanel");break;default:console.warn(`Unhandled station type: ${r.type}`)}else Zn(r,e,t,i,c,x,k,w,S,0,0,0,0,0,0,Mt.addFloatingText,l,he,u,v,b,0,s,f,d,0,O,h,g).finally((()=>{je=!1}));else if(console.log("isTeleportEnabled:",null===v||void 0===v||null===(C=v.settings)||void 0===C?void 0:C.isTeleportEnabled),null!==v&&void 0!==v&&null!==(E=v.settings)&&void 0!==E&&E.isTeleportEnabled){const n={x:t,y:e};N({x:n.x*he,y:n.y*he}),console.log("Player teleported to:",n)}je=!1}),[i,l,w,v,I,he]),$e=(0,o.useCallback)(((e,t,n)=>{const r=i.find((n=>n.x===t&&n.y===e));if(!r)return Re(),se(null),void de(!1);const o=e*he+n.currentTarget.offsetParent.offsetTop,a=t*he+n.currentTarget.offsetParent.offsetLeft;ce({x:a-190,y:o-120}),Pe=setTimeout((()=>{r&&se(r),de(!0)}),500)}),[i,he,null===v||void 0===v||null===(e=v.location)||void 0===e?void 0:e.g]),Re=()=>{clearTimeout(Pe),se(null),de(!1)},[Me,Fe]=(0,o.useState)(!1),_e=(null===T||void 0===T||null===(t=T.pcs)||void 0===t?void 0:t[String(null===v||void 0===v?void 0:v._id)])||{},[Oe,Ae]=(0,o.useState)(!1);return(0,$t.jsxs)("div",{className:"app-container",children:[(0,$t.jsx)(Mt,{}),(0,$t.jsxs)("div",{className:"base-panel",children:[(0,$t.jsx)("h1",{children:"Valley View"}),(0,$t.jsx)("br",{}),(0,$t.jsx)("p",{children:"Logged in as:"}),(0,$t.jsx)("button",{className:"shared-button",onClick:()=>{null!==v&&void 0!==v&&v.username?K("ProfilePanel"):K("LoginPanel")},children:(null===v||void 0===v?void 0:v.username)||"Sign In"}),(0,$t.jsx)("br",{}),(0,$t.jsxs)("h3",{children:["\ud83d\udcb0 Money:"," ",Array.isArray(null===v||void 0===v?void 0:v.inventory)?(0,$t.jsx)($t.Fragment,{children:(0,$t.jsx)("span",{className:"money-value",children:(null===(n=v.inventory.find((e=>"Money"===e.type)))||void 0===n?void 0:n.quantity)||0})}):"..."]}),(0,$t.jsx)("br",{}),(0,$t.jsx)("h4",{children:"Next Tax Collection:"}),(0,$t.jsx)("h2",{children:me.taxes}),(0,$t.jsx)("br",{}),(0,$t.jsx)("br",{}),(0,$t.jsxs)("div",{children:[(0,$t.jsxs)("h3",{children:["\ud83d\ude00 Player Stats:",(0,$t.jsx)("span",{onClick:()=>Fe(!Me),style:{cursor:"pointer",fontSize:"16px",marginLeft:"5px"},children:Me?"\u25bc":"\u25b6"})]}),Me&&(0,$t.jsxs)("div",{className:"combat-stats-panel",children:[(0,$t.jsxs)("h4",{children:["\u2764\ufe0f\u200d\ud83e\ude79 HP: ",_e.hp||0]}),(0,$t.jsxs)("h4",{children:["\u2764\ufe0f\u200d\ud83e\ude79 Max HP: ",_e.maxhp||0]}),(0,$t.jsxs)("h4",{children:["\ud83d\udee1\ufe0f Armor Class: ",_e.armorclass||0]}),(0,$t.jsxs)("h4",{children:["\u2694\ufe0f Attack Bonus: ",_e.attackbonus||0]}),(0,$t.jsxs)("h4",{children:["\u2694\ufe0f Damage: ",_e.damage||0]}),(0,$t.jsxs)("h4",{children:["\ud83d\udd2d Attack Range: ",_e.attackrange||0]}),(0,$t.jsxs)("h4",{children:["\ud83c\udfaf Speed: ",_e.speed||0]}),(0,$t.jsxs)("h4",{children:["\u26fa\ufe0f Is Camping: ",_e.iscamping?"Yes":"No"]})]})]}),(0,$t.jsx)("br",{}),(0,$t.jsxs)("h4",{children:["\ud83d\udcc5 (",ye.seasons.phase,")"]}),(0,$t.jsxs)("h4",{children:["\ud83d\udcc5 ",ye.seasons.type," Season Ends in:"]}),(0,$t.jsx)("h2",{children:me.seasons}),(0,$t.jsx)("br",{}),(0,$t.jsxs)("h3",{children:["\u23f3 Events:",(0,$t.jsx)("span",{onClick:()=>Ae(!Oe),style:{cursor:"pointer",fontSize:"16px",marginLeft:"5px"},children:Oe?"\u25bc":"\u25b6"})]}),Oe&&(0,$t.jsxs)("div",{className:"timers-panel",children:[(0,$t.jsxs)("h4",{children:["\ud83c\udfdb\ufe0f Elections: ",ye.elections.phase]}),(0,$t.jsxs)("p",{children:["Ends: ",me.elections]}),(0,$t.jsxs)("h4",{children:["\ud83d\ude82 Train: ",ye.train.phase]}),(0,$t.jsxs)("p",{children:["Ends: ",me.train]}),(0,$t.jsxs)("h4",{children:["\ud83c\udfe6 Bank: ",ye.bank.phase]}),(0,$t.jsxs)("p",{children:["Ends: ",me.bank]})]}),(0,$t.jsx)("br",{}),(0,$t.jsx)("h3",{children:"Who's here:"}),(0,$t.jsx)("div",{children:0===Object.entries(R).length?(0,$t.jsx)("h4",{style:{color:"white"},children:"No PCs present in the grid."}):(0,$t.jsx)("h4",{style:{color:"white"},children:Object.entries(R).map((e=>{let[t,n]=e;return(0,$t.jsxs)("p",{style:{color:"white"},children:[(0,$t.jsx)("strong",{children:n.username})," - HP: ",n.hp,", (",n.position.x,", ",n.position.y,")"]},t)}))})}),(0,$t.jsx)("br",{}),(0,$t.jsx)("button",{className:"shared-button",onClick:()=>K("HowToPanel"),children:"\ud83d\udd79\ufe0f How to Play"}),(0,$t.jsx)("br",{}),(0,$t.jsx)("button",{className:"panel-button reset-button",onClick:async()=>{try{localStorage.removeItem("timers");(await St.post("http://localhost:3001/api/reset-all-timers")).data.success?(console.log("\u2705 Timers reset successfully from the client."),O("\ud83d\udd04 All timers reset successfully."),await be()):(console.warn("\u26a0\ufe0f Timer reset failed."),O("\u274c Failed to reset timers."))}catch(e){console.error("\u274c Error resetting timers:",e),O("\u274c Timer reset request failed.")}},children:"Reset All Timers"})]}),(0,$t.jsx)("header",{className:"app-header",children:(0,$t.jsxs)("div",{className:"header-controls",children:[(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>B("Store"),children:"\ud83d\uded2 Store"}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>B("Mailbox"),children:"\ud83d\udce8 Inbox"}),(0,$t.jsx)("button",{className:"shared-button",children:"AWSD to Move"}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>{v.iscamping?O(32):"close"===pe?fe("far"):"far"===pe?(fe("settlement"),O(12)):"settlement"===pe&&(fe("frontier"),O(13))},children:"-"}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:async()=>{var e;const t=null===v||void 0===v||null===(e=v.location)||void 0===e?void 0:e.g;if(t)if(v.iscamping)O(32);else if("frontier"===pe)fe("settlement"),O(12);else if("settlement"===pe){fe("far"),console.log("calling fetchHomesteadOwner from zoomIn");const{username:e,gridType:n}=await(async e=>{try{console.log(`Fetching homestead owner for gridId: ${e}`);const t=await St.get(`http://localhost:3001/api/load-grid/${e}`),{ownerId:n=null,gridType:r=null}=t.data;if(console.log("ownerId =",n),!n)return console.log("\ud83c\udfe1 This homestead is unoccupied."),{username:null,gridType:r};const o=await St.get(`http://localhost:3001/api/player/${n._id}`),{username:a=null}=o.data;return a?(console.log(`\ud83c\udfe1 Homestead belongs to: ${a}`),{username:a,gridType:r}):(console.warn("\ud83d\udea8 Owner's player document not found!"),{username:null,gridType:r})}catch(t){return console.error("\u274c Error fetching homestead owner:",t),{username:null,gridType:null}}})(t);"town"===n?O(14):["valley1","valley2","valley3"].includes(n)?O(16):"homestead"===n?e?Pn(n,e,O):O("This homestead is unoccupied."):(console.warn(`Unexpected gridType: ${n}`),O("Unknown location."))}else"far"===pe&&fe("close");else console.warn("No valid gridId found for currentPlayer.")},children:"+"}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("InventoryPanel"),children:" Inventory "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("QuestPanel"),children:" \u2753 Quests "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("BuildPanel"),children:" \u2692\ufe0f Build "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("BuyPanel"),children:" \ud83d\udc2e Animals "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("FarmingPanel"),children:" \ud83d\ude9c Farm "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>{ae(null),K("SkillsAndUpgradesPanel")},children:" \u2699\ufe0f Skills "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("GovPanel"),children:" \ud83c\udfdb\ufe0f Gov "}),(0,$t.jsx)("button",{className:"shared-button",disabled:!v,onClick:()=>K("SeasonPanel"),children:" \ud83c\udf0e Season "}),(0,$t.jsx)("button",{className:"shared-button",onClick:()=>K("DebugPanel"),children:" \ud83d\udc1e "})]})}),(0,$t.jsxs)("div",{className:"status-bar-wrapper",children:[" ",(0,$t.jsx)(Gt,{})," "]}),(0,$t.jsxs)("div",{className:"homestead",children:["far"===pe||"close"===pe?(0,$t.jsxs)($t.Fragment,{children:[(0,$t.jsx)(Kn,{TILE_SIZE:he,setInventory:x,setResources:c,currentPlayer:v,openPanel:K,onNPCClick:e=>{console.log("App.js: Opening QuestGiverPanel for NPC:",e),X(e),K("QuestGiverPanel")},onPCClick:e=>{console.log("App.js: Opening SocialPanel for PC:",e),ee(e),K("SocialPanel")},masterResources:h})," ",(0,$t.jsx)(An,{grid:we,tileTypes:xe,resources:Se,handleTileClick:Te,handleTileHover:$e,handleTileLeave:Re,TILE_SIZE:he}),(0,$t.jsx)(Ln,{toggleVFX:null===v||void 0===v||null===(r=v.settings)||void 0===r?void 0:r.toggleVFX,TILE_SIZE:he}),(0,$t.jsx)(qn,{resource:le,tooltipPosition:ie,isTooltipVisible:ue})]}):null,"settlement"===pe&&(0,$t.jsx)(or,{currentPlayer:v,setZoomLevel:fe,setCurrentPlayer:b,fetchGrid:Ie,setGridId:s,setGrid:f,setResources:c,setTileTypes:d,setGridState:$,TILE_SIZE:he,onClose:()=>fe("far")}),"frontier"===pe&&(0,$t.jsx)(ar,{currentPlayer:v,setZoomLevel:fe,setCurrentPlayer:b,fetchGrid:Ie,setGridId:s,setGrid:f,setResources:c,setTileTypes:d,setGridState:$,TILE_SIZE:he,onClose:()=>fe("settlement")})]}),(0,$t.jsx)(lr,{isOpen:U,onClose:()=>W(!1),title:H.title,message:H.message,message2:H.message2,size:H.size||"standard"}),"Store"===D&&(0,$t.jsx)(Lr,{onClose:G,currentPlayer:v,setCurrentPlayer:b,resources:h,openMailbox:()=>z("Mailbox")}),"Mailbox"===D&&(0,$t.jsx)(Ar,{onClose:G,currentPlayer:v,setCurrentPlayer:b,resources:h}),"ProfilePanel"===Q&&(0,$t.jsx)(sr,{onClose:J,currentPlayer:v,setCurrentPlayer:b,handleLogout:()=>{console.log("Logging out user..."),En.stopGridStateUpdates(),b(null),x({}),N({x:0,y:0}),f([]),c([]),d([]),s(null),localStorage.removeItem("gridId"),localStorage.removeItem("player"),window.location.reload(),console.log("Player has logged out, and state has been reset.")}}),"LoginPanel"===Q&&(0,$t.jsx)(cr,{onClose:J,setCurrentPlayer:e=>{b(e),J()},onLoginSuccess:async(e,t)=>{await(async e=>{console.log("Handling login success for player:",e),localStorage.setItem("player",JSON.stringify(e)),window.location.reload()})(e)}}),"DebugPanel"===Q&&(0,$t.jsx)(ur,{onClose:J,currentPlayer:v,setCurrentPlayer:b,setInventory:x,setResources:c,currentGridId:null===v||void 0===v||null===(a=v.location)||void 0===a?void 0:a.g,updateStatus:O}),"InventoryPanel"===Q&&(0,$t.jsx)(dr,{onClose:J,currentPlayer:v,setCurrentPlayer:b,setInventory:x,updateStatus:O}),"BankPanel"===Q&&(0,$t.jsx)(Er,{onClose:J,currentPlayer:v,setCurrentPlayer:b,setInventory:x,updateStatus:O}),"TrainPanel"===Q&&(0,$t.jsx)(Ir,{onClose:J,currentPlayer:v,setCurrentPlayer:b,setInventory:x,updateStatus:O}),"HowToPanel"===Q&&(0,$t.jsx)(kr,{onOpen:K,onClose:J}),"GovPanel"===Q&&(0,$t.jsx)(Cr,{onClose:J,currentPlayer:v,setCurrentPlayer:b}),"Courthouse"===Q&&(0,$t.jsx)(Nr,{onClose:J,currentPlayer:v,setCurrentPlayer:b}),"SeasonPanel"===Q&&(0,$t.jsx)(qr,{onClose:J,currentPlayer:v,setCurrentPlayer:b}),"QuestPanel"===Q&&(0,$t.jsx)(jr,{onClose:J,currentPlayer:v,setCurrentPlayer:b}),"SkillsAndUpgradesPanel"===Q&&(0,$t.jsx)(vr,{onClose:J,inventory:w,setInventory:x,currentPlayer:v,setCurrentPlayer:b,stationType:null===oe||void 0===oe?void 0:oe.type}),"CraftingStation"===Q&&(0,$t.jsx)(Tr,{onClose:J,inventory:w,setInventory:x,backpack:S,setBackpack:k,currentPlayer:v,setCurrentPlayer:b,setResources:c,stationType:null===oe||void 0===oe?void 0:oe.type,currentStationPosition:null===oe||void 0===oe?void 0:oe.position,gridId:null===oe||void 0===oe?void 0:oe.gridId}),"TradingStation"===Q&&(0,$t.jsx)(Mr,{onClose:J,inventory:w,setInventory:x,backpack:S,setBackpack:k,currentPlayer:v,setCurrentPlayer:b,setResources:c,stationType:null===oe||void 0===oe?void 0:oe.type,currentStationPosition:null===oe||void 0===oe?void 0:oe.position,gridId:null===oe||void 0===oe?void 0:oe.gridId}),"FarmingPanel"===Q&&(0,$t.jsx)(Sr,{onClose:J,username:v.username,TILE_SIZE:he,inventory:w,setInventory:x,resources:i,setResources:c,tiles:p,tileTypes:u,setTileTypes:d,currentPlayer:v,setCurrentPlayer:b,setIsMoving:P,gridId:l}),"BuildPanel"===Q&&(0,$t.jsx)(hr,{onClose:J,TILE_SIZE:he,inventory:w,setInventory:x,resources:i,setResources:c,tiles:p,currentPlayer:v,setCurrentPlayer:b,setIsMoving:P,gridId:l,updateStatus:O}),"BuyPanel"===Q&&(0,$t.jsx)(gr,{onClose:J,TILE_SIZE:he,inventory:w,setInventory:x,playerPosition:I,resources:i,setResources:c,tiles:p,currentPlayer:v,setCurrentPlayer:b,setIsMoving:P,gridId:l,updateStatus:O}),"QuestGiverPanel"===Q&&(0,$t.jsx)(Xt,{onClose:J,npcData:Y,inventory:w,setInventory:x,setBackpack:k,currentPlayer:v,setCurrentPlayer:b,setResources:c}),"SocialPanel"===Q&&(0,$t.jsx)(zr,{onClose:J,pcData:Z,currentPlayer:v,setCurrentPlayer:b,setInventory:x,setBackpack:k}),"AnimalStall"===Q&&(0,$t.jsx)(_r,{onClose:J,inventory:w,setInventory:x,currentPlayer:v,setCurrentPlayer:b,setResources:c,stationType:null===oe||void 0===oe?void 0:oe.type,currentStationPosition:null===oe||void 0===oe?void 0:oe.position,gridId:null===oe||void 0===oe?void 0:oe.gridId}),"TradeStall"===Q&&(0,$t.jsx)(Or,{onClose:J,inventory:w,setInventory:x,currentPlayer:v,setCurrentPlayer:b}),"FarmHandsPanel"===Q&&(0,$t.jsx)($r,{onClose:J,currentPlayer:v,setCurrentPlayer:b})]})},Jr=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:o,getLCP:a,getTTFB:l}=t;n(e),r(e),o(e),a(e),l(e)}))};a.createRoot(document.getElementById("root")).render((0,$t.jsx)(o.StrictMode,{children:(0,$t.jsx)(Gn,{children:(0,$t.jsx)(Bt,{children:(0,$t.jsxs)(_t,{children:[" ",(0,$t.jsx)(Gr,{children:(0,$t.jsx)(Kr,{})})]})})})})),Jr()})();
//# sourceMappingURL=main.f356b610.js.map